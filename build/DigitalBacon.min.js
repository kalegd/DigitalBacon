/*
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */
import*as e from"three";import{Quaternion as t,Loader as i,LoaderUtils as s,FileLoader as n,Color as r,SpotLight as a,PointLight as o,DirectionalLight as l,MeshBasicMaterial as h,sRGBEncoding as c,MeshPhysicalMaterial as d,Vector2 as A,Matrix4 as u,Vector3 as p,InstancedMesh as g,Object3D as m,TextureLoader as _,ImageBitmapLoader as f,BufferAttribute as b,InterleavedBuffer as I,InterleavedBufferAttribute as w,LinearFilter as C,LinearMipmapLinearFilter as y,RepeatWrapping as v,PointsMaterial as B,Material as E,LineBasicMaterial as S,MeshStandardMaterial as M,DoubleSide as x,PropertyBinding as T,BufferGeometry as P,SkinnedMesh as k,Mesh as D,LineSegments as F,Line as Q,LineLoop as R,Points as O,Group as L,PerspectiveCamera as N,MathUtils as U,OrthographicCamera as H,Skeleton as G,InterpolateLinear as j,AnimationClip as z,Bone as V,TriangleFanDrawMode as Y,NearestFilter as X,NearestMipmapNearestFilter as W,LinearMipmapNearestFilter as K,NearestMipmapLinearFilter as Z,ClampToEdgeWrapping as q,MirroredRepeatWrapping as J,InterpolateDiscrete as ee,FrontSide as te,Texture as ie,TriangleStripDrawMode as se,VectorKeyframeTrack as ne,QuaternionKeyframeTrack as re,NumberKeyframeTrack as ae,Box3 as oe,Sphere as le,Interpolant as he,SphereGeometry as ce,EventDispatcher as de,MOUSE as Ae,TOUCH as ue,Spherical as pe,CubeTexture as ge,Raycaster as me,Euler as _e,CylinderGeometry as fe,BoxGeometry as be,Float32BufferAttribute as Ie,OctahedronGeometry as we,TorusGeometry as Ce,PlaneGeometry as ye}from"three";import ve from"three-mesh-ui";let Be={};Be.loadingLocks=new Set;const Ee={MODEL:"MODEL",IMAGE:"IMAGE",SHAPE:"SHAPE",LIGHT:"LIGHT",MATERIAL:"MATERIAL",TEXTURE:"TEXTURE"},Se={jpg:"jpg",jpeg:"jpeg",png:"png"},Me="ASSET_ADDED",xe="AVATAR_UPDATED",Te="BECOME_PARTY_HOST",Pe="BOOT_PEER",ke="HAND_TOOLS_SWITCH",De="INSTANCE_ADDED",Fe="INSTANCE_DELETED",Qe="INSTANCE_UPDATED",Re="INSTANCE_ATTACHED",Oe="INSTANCE_DETACHED",Le="MATERIAL_ADDED",Ne="MATERIAL_DELETED",Ue="MATERIAL_UPDATED",He="MENU_FIELD_FOCUSED",Ge="MENU_NOTIFICATION",je="MENU_PAGE_CHANGED",ze="PARTY_ENDED",Ve="PARTY_STARTED",Ye="PEER_CONNECTED",Xe="PEER_DISCONNECTED",We="PEER_USERNAME_UPDATED",Ke="PROJECT_LOADING",Ze="PROJECT_SAVING",qe="SETTINGS_UPDATED",Je="TEXTURE_ADDED",$e="TEXTURE_DELETED",et="TEXTURE_UPDATED";let tt=new class{constructor(){this._topics={},this._toPublish=[]}subscribe(e,t,i){t in this._topics||(this._topics[t]={}),this._topics[t][e]=i}unsubscribe(e,t){t in this._topics&&(delete this._topics[t][e],0==Object.keys(this._topics[t]).length&&delete this._topics[t])}publish(e,t,i,s){let n=this._splitTopic(t);for(let t of n)!t in this._topics||(s?this._publish(e,t,i):this._toPublish.push((()=>{this._publish(e,t,i)})))}_splitTopic(e){let t=e.split(":"),i=t[0],s=[i];for(let e=1;e<t.length;e++)i+=":"+t[e],s.push(i);return s}_publish(e,t,i){let s=this._topics[t];for(let t in s)t!=e&&s[t](i)}update(){for(let e of this._toPublish)e();this._toPublish=[]}};const it=()=>([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(e=>(e^crypto.getRandomValues(new Uint8Array(1))[0]&15>>e/4).toString(16))),st=(e,t)=>"number"==typeof e?e:t,nt=(e,t)=>e.length==t.length&&e.reduce(((e,i,s)=>e&&t[s]==i),!0),rt=(e,t)=>e.length>t?e.substring(0,t)+"...":e,at=e=>e.charAt(0).toUpperCase()+e.slice(1),ot=(t,i)=>{t.traverse((t=>{(t instanceof e.Mesh||t instanceof e.Line)&&(t.geometry&&t.geometry.dispose(),t.material&&(Array.isArray(t.material)?t.material.forEach((e=>{lt(e,i)})):lt(t.material,i)))}))},lt=(e,t)=>{t&&(e.alphaMap&&e.alphaMap.dispose(),e.aoMap&&e.aoMap.dispose(),e.bumpMap&&e.bumpMap.dispose(),e.displacementMap&&e.displacementMap.dispose(),e.emissiveMap&&e.emissiveMap.dispose(),e.envMap&&e.envMap.dispose(),e.gradientMap&&e.gradientMap.dispose(),e.lightMap&&e.lightMap.dispose(),e.map&&e.map.dispose(),e.metalnessMap&&e.metalnessMap.dispose(),e.normalMap&&e.normalMap.dispose(),e.roughnessMap&&e.roughnessMap.dispose(),e.specularMap&&e.specularMap.dispose()),e.dispose()},ht=(e,t)=>Number(e.toFixed(t));e.Vector3.prototype.roundWithPrecision=function(e){let t=e||9,i=[this.x,this.y,this.z];return this.setX(ht(this.x,t)),this.setY(ht(this.y,t)),this.setZ(ht(this.z,t)),this.x!=i[0]||this.y!=i[1]||this.z!=i[2]},e.Euler.prototype.roundWithPrecision=function(e){let t=e||9,i=[this.x,this.y,this.z];return this.set(ht(this.x,t),ht(this.y,t),ht(this.z,t)),this.x!=i[0]||this.y!=i[1]||this.z!=i[2]};const ct=(e,t)=>[Math.sqrt(e*e+t*t),Math.atan2(t,e)],dt=e=>(e+Math.PI)/(2*Math.PI)*360;function At(e,t,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?e+6*(t-e)*i:i<.5?t:i<2/3?e+(t-e)*(2/3-i)*6:e}const ut=(e,t,i)=>{let s,n,r;if(e/=360,0==t)s=n=r=i;else{let a=i<.5?i*(1+t):i+t-i*t,o=2*i-a;s=At(o,a,e+1/3),n=At(o,a,e),r=At(o,a,e-1/3)}return[Math.round(255*s),Math.round(255*n),Math.round(255*r)]},pt=(e,t,i)=>e<<16^t<<8^i<<0,gt=e=>new Promise(((t,i)=>{e.arrayBuffer().then((e=>{crypto.subtle.digest("SHA-256",e).then((e=>{let i=Array.from(new Uint8Array(e)).map((e=>e.toString(16).padStart(2,"0"))).join("");t(i)}))}))})),mt=e=>{let t=0;for(let i of e)t+=i.byteLength;let i=new Uint8Array(t),s=0;for(let t of e)i.set(new Uint8Array(t),s),s+=t.byteLength;return i.buffer};class Queue{constructor(){this.items={},this.headIndex=0,this.tailIndex=0,this.length=0}enqueue(e){this.items[this.tailIndex]=e,this.tailIndex++,this.length++}dequeue(){const e=this.items[this.headIndex];return delete this.items[this.headIndex],this.headIndex++,this.length--,e}peek(){return this.items[this.headIndex]}}let _t=["audio","checkmark","hamburger","headphones","image","lightbulb","material","microphone","object","pencil","search","shapes","texture","trash","undo","redo","video"],ft={},bt=it();Be.loadingLocks.add(bt);for(let e of _t)ft[e]=it(),Be.loadingLocks.add(ft[e]);const It={audioIcon:(new e.TextureLoader).load("data:image/png;base64,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",(function(e){Be.loadingLocks.delete(ft.audio)})),checkmarkIcon:(new e.TextureLoader).load("data:image/png;base64,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",(function(e){Be.loadingLocks.delete(ft.checkmark)})),hamburgerIcon:(new e.TextureLoader).load("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAQAAAAHUWYVAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA75o43NsAAAAHdElNRQflBwgBKRc7nqR1AAAAAW9yTlQBz6J3mgAAAQpJREFUeNrt3bEKgzAUQNFY/P8f7mBnoVMN9UbO2RN43jE8HAMAAAAAAAAAAAAAAAAAAAAAAACANW2T79uP990j/dc2+Qu+7h6IM0FiBIkRJEaQGEFiBIkRJEaQGEFiBIkRJEaQGEFiBIkRJEaQGEFiZgc57h4IAAAAAAAAACaZvRY9xv7zySvv8Sue/cqe+kX21B9OkBhBYgSJESRGkBhBYgSJESRGkBhBYgSJESRGkBhBYgSJESRGkBhBAAAAAAAAAIAl2FO/yJ76wwkSI0iMIDGCxAgSI0iMIDGCxAgSI0iMIDGCxAgSI0iMIDGCxAgS43/qAAAAAAAAAAAAAAAAAAAAAAAAADDFB0xaDHVXaSV/AAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIxLTA3LTA4VDAxOjQxOjIzKzAwOjAw09nK7wAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMS0wNy0wOFQwMTo0MToyMyswMDowMKKEclMAAAAASUVORK5CYII=",(function(e){Be.loadingLocks.delete(ft.hamburger)})),headphonesIcon:(new e.TextureLoader).load("data:image/png;base64,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",(function(e){Be.loadingLocks.delete(ft.headphones)})),imageIcon:(new e.TextureLoader).load("data:image/png;base64,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",(function(e){Be.loadingLocks.delete(ft.image)})),lightbulbIcon:(new e.TextureLoader).load("data:image/png;base64,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",(function(e){Be.loadingLocks.delete(ft.lightbulb)})),materialIcon:(new e.TextureLoader).load("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAAAAXNSR0IArs4c6QAAErpJREFUeF7tXcl2IzkOHP//R9c8uZ7csiqVBEkEECBiLnMQFyC2ZFJy9df/9L9WCPz58+fPXcNfX19frQBp3qzIbiSAkflfoVAQ9BCGAqABzzPGVwg0EMRLiwqAg/leNf47JDoNnCsSBcCB3HoZX0FwoDjeWlIAHMQxyvgKgoNEogA4j8wo4ysIztOOTgCFOc0yvoKgsGh0AqhPHovxFQT1taQTQCEOWY2vICgkIp0A6pFVxfgKgnra0gmAmLOqxlcQEItKJwB+ciKM//7jnow9+Zk4v0KdAIg4ZjAhQw1ElBxfigKAhGK08WZ/zstWDwlNx5WhAEimlN1o7PUl01d+ewVAEoXVjFWt3iRay22rAAimrLqRqtcfTDf9dgqAIIpOM85p/QTJgG4bBQCYktONcnp/YHmkL68AAFHQzRjd+gXJJnxZBYAz5GgjPMqd/UrPucXb5dD9M/ceibPXXgoAJyTRwmc3/iuMaCwUAk6ifTxM/JbquRJa7JWM/64AJDYKAR+/KQAWcUSK+1nSKSJHYXUKPosSdJmmAJiEESXm1zJOFbY3dqfiNCnJreEKgAn4vAX8vnUXQXvh2AWvCYlOD1UAGCDzEuynrboKeRfXrrgZJGseogC4gWpXoCMWJOC/CK3iLPxGCht/rgC4wGhVkGO4/46QcK+RmsFdGFrVdj9OAfCCz4wAV+CXaG2oWXgQljYsR6MUABtH0BG4z88lVitSv8ddBYGwXMPy4/2T73K1VrM8aXY6klh30POde8d1Z55angBkfF9zsa9m4btrCLQKAIsQdsXcVUi7uKHmWznvyluLALCKYEeEXQW0g1nE3BnuO3J4dADMkL8qxo6iWcUqY96MBjpyeWQAzJC+KsqOYlnFKnPejBY6cnpUAMyQvSrKjiJZxYph3owmOnJ7TADMEL0izI7iWMGJbY5VF135LR8AVoJXhdlVGKt4Mc6zaKQrz2UDwELqjhi7CmIHM+a5+iHQNTvlAkDGZ7ZZr9pO+KlymQCQ8XuZi7lbixarnCDpA8AC9o5YqhC106Pm+iIwo0l2fdEGwAzIK/SyE7PSk+bgEVjVJave6AJgFWAr9axEWOvXuFwEdvXJpj+aANgF1iILNvAtNWsMFwJeOmXRYnoAeAF6JxMWsLmkrGpWEPDWa7Y20wLAG8grMrPBXRGY5nAjgNJtllbDAwAF4KtsssDklq6q80IAqeFo7YYFABK0J7HR4HkJSuvUQwCt5ygthwTAKWDVk6kqRiKA1vWjdnQQQAMADRAaHKR4tPY5CFTWOSQAKgNyjizVSTQCFXXvGgAVAYgWifY7H4FKPnAJgEoNny8/dciCQAVfbAVAhQZZxKA6+iLA7JOlAGBuqK/M1Dk7Aoy+mQoAxgbYSVd9QuAdASYfmQIAXXDE952SoRBgQwDtK8vX5LcBgC5QxmeTpOqJRiDbY5cBkF1UNAnaTwhkI5DluV8BkFVENvjaXwiwIBDtwZ8AQG9seR9hIUF1CIFsBKL8+B0AyM1k/Gwpaf/KCKC9+YXaQMavLDvVzoYAzKfeC8v4bNJRPSch4O5XrwVl/JNkpl7YEXDzrdtCX1+mHxWxA6v6hEAFBNx867XQEzSdBCrIRzVWRcDdr94LKgiqSkt1MyMA86m+BmSmXbV1RwBl/Aeuj9O6fgjUXWHqnxIBpPGf5v/+//fuozamRF1FCYFkBND+ezX/ZQCgXwl0R5CsMG1PiUC08X98eIdGVlGUDKkoIQBAINtjpu/us4sE4K4lhUAqAiyeMgXAEymWolOZ0+ZCYAMBNg9NBYCCYIN5TW2PANr8Kz/CWwqAqCBYaai9ygQAHQKMxjddAlqRZG7Q2oPGCQFvBCr4YusE8A5YhYa9SdZ6QqCyD1wDQK8GMkNnBCo+ACEBoCDobIN+vVc0vusdwIjyygCNetPnfRE4QdfQE0Dld6O+slbnIwROMH7oCUBBMJKUPq+AANr4Dwyiv/oOPQG8knwimBVErBrnEThZq2kBEHVRmJGq8xLTDEYETjZ+6ivAFdkdwGYUuWr6F4FOWkw/AUTfD+hEIMt/QqCT8elOAAoCGTMTAbT5oy/3rFjSnQCig4CVGCuBGreHQFfj058AFAR7wtbsewS6G79cAER9a6ATwdnRIeP/5pf+FSDrwkZBcFYQyPjXfJYNAJ0IzjIoqhsZ/x7Z8gGgIEBZp/a6Mr6Nv/IBgCb6HUa9GtiElTVKephDvmwARBOtIJgTVvRo6WEN8XIBkE20gmBNaKhZ0sMesmUCgI1oBcGe8HZnSw+7CP6dTx8A7EQrCHyEaF1FerAiZRtHGwDViFYQ2AS3Okp6WEXufh5dAEQQ/bzJj9wLQ1+PVdE8vX6zE7kXA3s0AYAG/vt95+vrsl/03vrqcE3qWbyg973T4hpS67PSA4AJbHQtCgKbUFl4QNfBEARpAcAMLro2BcF1ELDijq4rMwjCA6ASmOhaFQR/g6AKzug6M4IgNADQAKIMVbVu24E7b1RVXNF1RwZBSACgAUMZ/90ap/SRZ/laT/wRTifoARoAJwB0JYJT+xoJfvfz03BD9/PEG/mAgwQAGhgkIFaRo3uMPAZae14ddxpWEf1cYY3QvWsAoIFBALAq6uc8dM+Vg+A0bCL6sejR0wcuAYAGxrNhC8CWMeieo54All5nx0RgE6mJiH5mMfZ6MGwFABqYSJKtBKB7ttTBiEvE13leordgHNWPtZa7cTt6WAoAtAl2GvIANOPib6VuFpzQepDxbepY0cNUAJxGtA1W/A9VrHUwvhagNbEi6lU8o3qJ2seCgykA0AVHJ7wFmEpHwAz80Jo40fivukPjZ9XEbQCwFGk1rNe4iL69an1fB20cNDbo+tlMiMZzFAQpfx47KgpljtG6aDIq/915JDYjnnY/R/eyou+smn4FQFYRu4Tuzkf3ffdUy9zbght7fZYenmPQvawY/73+6Bp/AgC9ceTRzioKpp6Zaom4/4jUAxpbD+NHB8ET/+8AQAIUSXRF42cR/wkrpBYQRhlxXr0fZP0Pb36hNpDxR9K8/xzFy3PXd36i99tDZzxb/Ywx+g5kb6BkfBvwllHe3Fj2RIyJ1AQas8herrjw7s8tALKBiQDrao+Ivr1JR5g8C5uoC74Inmd48dLEkQHgBc4dIRmCiOhrRoSfxkZig8YkspcZ7L36dguAT++WM03tjvUChc340ReFqzxEmgXNdWQvM3h79+0eABlB4A1K9nHWKoiIvi21RJoF3XNkLxZs0a84pb8GRIvh+5b0w39MZIY877ERfVtqjsQG3XNkLxZs0cZ/arvsD4E6CgLds1WYkWaJ6DmyHyvG6L5//RAoIm28Xg2igLESFTEO3bO1h0ijRPQc2Y8V4+i+y/wxEBqYrmKwCDMSGzTPnV/rrnik/3NgtCAixW0x22MMumdrHdHYoPuO7seCM7rnUeDR/oMgaGC6isEiymhsxLWFlfkxFh5NARB5RzDf5twMCyhzK+6PRhvg/Snwab9obNB9R/djUQK659ET/73GqQCoHAQSg0WeMWPQJmDkOuLVbqXvpQCoFgQrwCCtgDbA7FMA2evr2ui+2XiO8slO31sBENXgqkB3gFndczSvowk69sz6xHd5BfgkcjTRI3M9P5fxrUhhx6H1wMhzFeP/eAUhATTxn2pmFAQaC/WMUPDamhW5dnkFyD4RyARrgvWeVdEAHhhU7hsaAFF3BEwBUFkMq2ZA96xLzVVmxvNCAqBDEKBNwBRyUXx2NX5k36EBEHFBEgleRD8y/vgpFjUCHfLR2v3eLwq8932qg1m9/lXe0X0r8FaZWZuXFgBVj5FoA2Q8BSzSQfct41tY8B+THgBVggBtABnfX9yrK3bimiYAWIOgkxheDYPum/GJ3/FOhy4AooJgJEC0AfTEX30+Y+ah+R7pDdPVeFXaAMgMgo5i6Nhzxyf+eyTQB0BkEHQ0QceeZfz/YqBMAEQFwfjQND+C8fgn48/zaJnByPVd3eUCoFIQMIoBbXzdbVhigmdM2QBgDgIZn0fg6MBj5HoG/fIBwBQEjGJAG0BP/Bm78Y0tHwARAh/RJuOPEIr7PFoPjNzPoF02AKKJvgKVkfwIXLr2fXuZRvjfkLQEQbkAiBC4BbjnGCYzoLFh6pXp1e9VL4wYHfEtAFrcM6ZnOw2gsWEUNbrnynqYqZ3+BMBO9DvYkWZBYxPZi1W06J6tdVjHMWL468RibSR6XDWiI4+BaGxYRYvuG6lxVkzpTgARJD/JQO/lTXq1er0MFdU3eh/Gr0xpAiATfPTeu0HAXp+X0d/XyeobvS9TEKQHABPY6Fpmg4CtHpTRWYwfXQdDEKQFAFrcO+CiaxsFAXr/HWyQIYDue4T7p97QdWXykRIAaEBXiY5+ArzXicYlU2h3wYHuu4oeMvgJDYAqREcHAfKp+lzbywSetUoP12hGchUSAFWJPiEIIsVkDQfpwYZUBHfQADiF6Fe60D3ZpDEeFSGecRW/R0Rgl9E3ui9kT5AAqAyIVdToHq11vI9DimW1pgisGPpG94no0TUAKgKwKurnPHTP1voQ4rDu3fH2/IRLze9Lx12SH/PRJmAUN8v9ACM2aD1k3Jav+ASNgwf3WwFQocEV4nbmoDHpfKtfxfjRD4edIFgKgAiR7zS1Y2CvuWiM2PDp1u+KThgxmgoAdANVE/6U98FTRL3SR9QcNg+ZAoCt6CiyPPdBYxh9IjitH0+uLWuh8bM+TG8DgKVIC6BVxqAxRQdB9frZdILGcxQElwGQXRQbSYh60Bh7B0G1ehGcIddE4/spCP4JAHQh3sJEkhKxNjve7PVFcBS5Bxrv9yD4CQD0xjL+vYzY8GerJ9KEDHtF4f8dAMjNZPw5OSG5GL0PorVg2X8OrfNHI/Xw8OYXagMZf12cKE5eK9K/RbDOT8ZMlCbcA0DG95MHinS/Cm0rSRM2nCyjvDXhFgAi2ULf2hhv0teqmJ8lTcxjZp3hpQkFgBVxgnFepKNbkfHRCPvd27kFwLNlkV+HfO9Kxb03ov+u5/0QcA8ABQFeBM8dvMWwWrmMv4qcfR6Ka30NaOeAdiRKHKOGZfwRQvufI7n9/how6mkiseyLYbQCUiyve4vLERP7n6O5fHL466fA6E0fsEg8++IYrYDiUdyNkN//HMXdpwDXHwPtc0a7gpeYZHw8xV5c3VV6xaP+HBjPbfoOq+KS8fHUrXIzU9kdj/oHQWaQLD7WKjYZP4ZoKx+r1Vh4NAWALgpXKeCc90l4FsFwdlSrKgbjPxGbCgAFQS2hqVouBJiMvxUACgIuYakabgQYje8SAAoCbuGpulwEmI3vGgAKglyhaXcuBCoYHxIACgIuIaqaWAQqGR8aAAqCWOFpt1wEKho/JAAUBLnC1O5YBNDGf1SP/mp26WvAFVhPAGulb805D4GTtBwWAFGngYjUPE/S6siCwEnGD30FuAL3RDAtItKYegicrNXwE8A7/SeDW0/qqvgVgQ7aTA8AvRrIdIwIoM2PvtyzYkoTAFFBwAK8lSCNi0Wgi/HT7wBGtHYjYoSHPsci0FVvdCeA6DsCnQiwxmJfvavx6U8ACgJ269Sur7vxywWA7ghqG46lehn/NxP0rwCfhCMiWSxVow7p5ZqnsgGgE0EN42VXKePfM1A+ABQE2Rbj3B9t/EfXJ1wgHxMAD0JEOqcZI6uSBubQPioAok4Dp6T/nFS4R8v4a/wcGQAKgjUxVJwl4++xdnQAKAj2xME8W8b3YadFACgIfMTCsgra/Cdc7lm5ahUAUUHQSUBWoXmMk/E9UPy9RssAUBD4Cwm5ooyPQ7d1ACgIcMLyWFnG90Dxfg0FwAs+EhxecJYdxIMFJZ8xCoALHCVAH3HNriLcZxHbH68AuMFQgtwXmGUF4WxBCTNGAWDAVQI1gLQwRLgugOY8RQEwAagEOwFW4snqsbW+irVxpQCw4fQzCh0CJ4tX2E2KLWC4AmARZInZDpywsmMVPVIBsIm4xP0ZQGGzKa6A6QoAJ5Al9v+AFBZOogpYRgHgDHJ38aP71+Wer2AVAL54hl0WshlBxgcJCbysAgAM8OnGOL0/sDzSl1cABFFwmlFO6ydIBnTbKACCKalunOr1B9NNv50CIImiakaqVm8SreW2VQAkU8ZuLPb6kukrv70CgIRCNqOx1UNC03FlKACIKEWb7tHq6OtDhhqIKDm+FAUAIcUZJszYkxD6diUpAIgpjzBlRPujU0dEDdrjGgEFQAFlVA0CGZ9fXAoAfo5+KqwSBDJ+HVEpAOpwRR8EMn49MSkA6nFGFwQyfl0RKQDqcpceBDJ+ffEoAOpzGB4EMv45olEAnMMlPAhk/PPEogA4j1P3IJDxzxWJAuBcbreDQMY/XxwKgPM5XgoCmb+HMBQAPXg2h4CM30sQ/we9EKFPHbDQHQAAAABJRU5ErkJggg==",(function(e){Be.loadingLocks.delete(ft.material)})),microphoneIcon:(new e.TextureLoader).load("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAAAAXNSR0IArs4c6QAADzlJREFUeF7tnOuaWykMBOP3f+jZbzaZJOP4ApySEFD7N9BHtFpljp3N7Yf/benAx8fHB3mw2+12I/XUquGATa3RB6QKeuifFSUMkHaVEBEAJdowXkTW0AuD8R5V3ikAKnfnSW2zh14YLBiaJyULgIV6WXXw7y30FWGdUAmARXq1yvB/2SkE1giWACjep9UG39tA8UDdlScAivZr9cEXBEWDJQDqN2a34fe1oG7mvAEU682uwy8EigXtVzkCoFBfdh9+IVAobAKgTjNOGXy/F6iTud8wrlfSWRWdOvzeBmrk3FeAiX04ffiFwMTw+Qow13yH/7v//sWhOXn0BjDH9x8CQABMit63xwqACV1w+B+b7i0gP4wCINlzh/+14UIgN5ACINFvh7/NbCHQ5hOxSgAQLjZoVBr+ZwO2Qo0NVrukwwEB0GHWlaUzh2v0E3XFmq/06MS9AiCh6zMGaXTon9mxwxkSWr3cIwRAQssyh4ce/Ht7djpLQuvLP0IABLcoa2CiB38WCLLPFRyHcvICILglGQCYNSQ7ny04FmXkBUBgK04YkBPOGBiR6dICIKgF0YMx61N/1peE1c4bFJt0WQEQZHkkAKoOw4lnDopPmqwACLL6xGE48cxB8UmTFQABVp88CCefPSBK4ZICIMDiqCGoevXP+olwlfMHRCpMUgAEWBsBgNXCrwcBwQqQFACwqRHB/yxRAPxs1Go+wPHC5QQAbGkEAFYNvV7A4QqQEwCwqYb+j6F6AYcrQE4AwKbSoV/10//LVv2AAwbLCQDQUDrsO7zz6gkYsAApAQCaatj/NVNPwIAFSAkA0FQ67Ktf/30NAMMVJCUAQGMFwGMz9QUMGSwlAEBDDboAAOOUIiUAQJsFgAAA45QiJQBAmwWAAADjlCIlAECbBYAAAOOUIiUAQJtJAOzyC0DELwG7eQNGsFtKAHRb9nyDANAbME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVLbAuDZMN5ut7AzC4D1ATAjNymT/uQhYcMw61A9Q0jDoOfZ7/yha3v3vOg/r+xNT2279WUrAPQ08ivwZENHnv9s8Mi6ooe7Rb+qNyN17dSbbQAw0kgaAldquB+inUL2ebaK3lypaZf+bAGAK40kIUDUQdbT8smctaaaN0Q9O0BgeQAQjfwcAqKZVC1UPVnD3fKcat5Q9RC5afEvao0A+MvZq82kQiUAXsfdPnE4EAACgEvTC6VKcKxUS4r5Lx4iAARASgYrDV2lWlLM3xUAZCOJazdZz9Vr7uxg3T+/kjdkLURuZvZq6RtAtUaS9QiA52Nx1RuyTwJgIr6q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",(function(e){Be.loadingLocks.delete(ft.microphone)})),objectIcon:(new e.TextureLoader).load("data:image/png;base64,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",(function(e){Be.loadingLocks.delete(ft.object)})),pencilIcon:(new e.TextureLoader).load("data:image/png;base64,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",(function(e){Be.loadingLocks.delete(ft.pencil)})),searchIcon:(new e.TextureLoader).load("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAMAAABrrFhUAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAALxUExURUdwTP///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9wLB8UAAAD6dFJOUwD9+gT7AwL+AfyNlpUFB/aD9RnzCSMR+fL3C63wwzOy7+l4cHlrORX4KApD7VeaG+7O8WjnJsj0CAadQGRZ4xR2ZaXorhi+3srfPt0l0hJFDkbQ5oRvNn4cyysMMBacxUkq2D25il9jjE6Yp6pSItky6johs70dF1rVPxpsgGYTVjxqjtFpppG/xGKLr9O0pHU3ibysIMlLTMfcwh47ECnrz0LhDZNV4NpEclOPLddgzG62NX2HL12Bn2HNeiy3onOhWCSQLp4nsanBd0gxD+zl1sZPHziFf3RKklSrtTS6m6CGceJbl1yUmXx7u8DbR1FBqFCIXuTUTW332z2nAAARCklEQVR42u1dVXgcx9I9PdPdNe3EMjNzDHHMEDAkduwwMzMzMzMzMzPTDdww3OBlZsaf6Tz9D7NSrLs9q5W9PbOyp5702fo0Xae4GgooqaSSSiqppJJKKqmkkhpLibXGxK1kjLXJGsN5bLJ4TWKzeuNgY1v5YdKuw7db9+wxY8/q2bPnLqOfu/yJ+5/aa17lt4xJVk/mEwAwve+feeiQZ2f1cGxP0dxHLtu458HX9U9/ezUDwRoA2OP4Me9cOLeVY1FORylpp6T1X6fs86fLd+8OAMauTtzbl8cM+SplUUfaKWkjtv6gnI5SvdDH7H3wnQCwGuhBYgB03/z67RVJaq1SlukjoYgol6LQ69JFb7bpTtcW/i9e2r+N+SzeV0BBKKK0I6mH/famLq0G1gILZw4jKZGrh/l2IDhNcu6Qw+KuCoFNgDcv2YRkKnp2ir7G4LQfLe2KDtEmwAE3alK7znO/AgZakfd269fVtMBaYIPnU+HXr/k+DFI16PWH94Au5A4NsPOJpGiRVeC+TQ2UJnu837vLQGCAmz4klV4l4bfHQJPTxrbAdgFXkBh0HzuQ0ij2V4Bg/6O6gBIY4LGtyEayX4FAaXLJTUhsk4t/2z+QWjWW/QoEznHgOCBuYucPbLeMyjWe/a/t4MCb0LQ9gxi4gowkCP9tdjD0983qCQz6zaG4UOynCFCTf+7ejGaQAP86I6D4v1YCx+lbNp8OWOAsUrO+rLfSBFAVau0L1OkJIs64FUnSZOrf/ZO61D+tdp2OXPvfFB3V7BW0+wuafBuwTeX+JszpOPanzEet3UDdY+QOy57e/9Flxw0cJK0w1FE5itCRf2omBGLM3oJR7YWnSb0mSRl12WsvfmO7Pe/cdlJL9/nz5w3uf/T3//f864+8qk8KQke9g9QRDDFN4whiDL+XUa01p5WtIxn9z+GLX3gww45O2Wb0kQ+QHdbQqSP4++AmQSDGXXOpa/AvwrS3ce+QmbNNpUm+4l5QklgTp21zDD7gxX0iUmoX0kKJuPzupkAgxuY9avEvQtGKHPizUye02x3xhNLK5sHERctTNajxV8mI9/VvAgRiHF+LfxGKFvK+t08GkNTR10n7wNetfW9tCEQY8b4vCkcgxrF9svlvZf/ntySd2e1JDIAJY46pWVaJMOKcvgXHAoMtj6vBP+kUeeP4zje3rQFaDt6qFgQijPg3oMiMyGLC7Zn8V2r453euiHQltlTixVvU6C2IMOIRRSKQIL4tK/5VCpcLb8HKN7IMMPiHveiylEAomgcVagRH1OBfafYabVathRMD/a7MVgKhOC4urDY02IVasvjX5A2zV7l0T2Jgo1mZnkCoyM0LCgUx/oP+hC3N1KKdGtK+shanLCFdFgKOOywtxAosjh5Kl8W/5lWfN6pciYFxjhEzvhXxhoIaIN+hzliTI69paZxp2gQ7Z1VbIozYswAjMPhPvwNM+f+0sY27GHf/kv68UCjCybkjYPCY3wGIUDM6qtEdGwMcTqX8CDhutm3O2UCCPW73OgARan45vvGRyQIvkhkIRNw7Zz9osDYjP/8Rv7onRGROEozzIyAiirfmagQG/0YlvqUw4rKjA2UmFhuSin4juH1wrkZgtvcZgAg1N7szWGZmshGIeH2OKmCwyBcBRag5q1/AzNRgDJX4vix0L+fmBhKcPNQnCKHj3M+DZuYWO3qzb6Hmz3OzAYO9vQpARX4WtjJJgG960w8Rx8NyMgKLY4XVUhARx3GhK7ME9jI/+o6v56QBFld6liDCiIeHN0ODMzbxO2DNZ3JRAYsDmGGFN9sczDDGNr4cVOj49Px8XOCJPgWg4tzZuUggxg99bTgRzUNyWIDF+CwHcEhurZlhXhE4XmXysIB/935dc0hecdhiYg9PGBZxXDe4CljcM8CjflScsmtuiUiMazNU4Fs55ADdqL32d1GuvcmbPZFARHheYCkk6L8DlQ/7ffItRk/3OiLNXwcGwOByrwJIzq1Zi2/6c5GR64WOxJfS+VKAI/JtSFj06+WPhDsFFYTFy8r3XUa7596R6ebLiB1vC/zZntUWINTcO++mZIL1RnqckZDDg4rCXOWxgAIUICMcieigLXKL46udr4jmxflvzSReL0DH7ZOQqO9IXUT09S/mHZ8KUILawG7VFkDHYSiALM7z5QKabwTLyBJMrG7GpFVQMduzl3nFsWnAFPx8jwUojjqnkEMaBmd6baBPsFwowRHUrNa59Ys5o5Fg16EehVQ8N5hC9n2kKvSKKP64IAtIMMQjkIjvB1qPxfDq7VlR/N1gFEMGz9BVLcjx5mAu4KJqF8DCLABIcMYM+pxA7zBOwGIqoyqNc9yowNOav/QmpvsGEkmynC5Pp1uHTo71hCXN0UEygQTnVDvdorKgVp28y3NwSPOaIBpgcXz11yTiFUWeV35wk+q45Ph6EAsw+EaVBVAU3y30wPbVVYFQFEf2D2GVMXZkVN0NjD4q8KxuxprcsSFsIMHGPrQfaSlQ/gYbeboiij8No5XDqoOA41sF8g+LDzytUc3fBgkDLZtR/bPHjfhQsXc2tp3iW1S3AItKsLCPD+zHi73Ha1+vSoVEc+MAfinBftXn4kTx4UI1IMGSqlRIXJDDwxYHeNIA8q5C7ysYrFWdnjveZ0J86jDfntg6swu9sxNjl+o4qLjZvBAA/NGTB7HPOQUDMK66GlCcskcIAGZWA6A4alKRLhAGr3jFMqHxYokxxof1Fi0FA/Bdn2H2ODkEAJ/6rO207oUCYPGZ77jGOv1CAPCGD4Ct4oIBmOwDYMBHIQD4a1MCsIEXgIkhABjrA+DbRZvAY14T2DIEANf6APhHS8EA7OsDYNAJIQD4P18UWNC34ChwlC8K9Dqj8QAYbOiLuDO+KDQR8repOOPuEACsm1fEXfXsZNak3KzNfV5oMeTtiSnuPz8EADv7Tqfyx4UCYLF+9fag43eCVN5Hr1MNQHFnA1rp+eo+neaIvLpPErFnsR2h7k9Xt8Q0pwZRy+7frvaCmhcX6QQT7NXHt1lzVhipHOjrCu9W7Bsmx4vPLjcMYZcWUz3HETh0YaEbI2f7jq1xmxAmEGO0bxeGpxcYBgwe8uzYc50TQgjF4KeeTEhzp0K94D7VZqn4wLwwDmd37duLLtALJug9kJ4zMgcG+t6k6rsSorispUAL8HSqGfHJULnJgdW7MELuXJgTMDjU45YcLw8DgMFBns9pji3OCSTb+0Si9kSgExKeejDo0dQOA/NTzntur28ol3PCIN+ptEHvFeQGDUZ7z+0NCbaeZLrnmJjmmMLqods8p+Q0rw1lkwY/qXYCudxWzLCAPcWnkbwulFc2eILK98XhhcQBg4M8p8UVl80L9cUEe42k78ZMt2JsYJLnyIrokE8KpTfnWdWB+qp/AW7Q4FTPUemwF6jTGxMeFTi/EBUY5nGBil9OCCeNBCf08N7UutAU4AI3qHZIpOaRIbUxwYGenkAhJ8YtRlRfHQ2+FIPFHruj47P5K8BdvjtjiptsHVYDlk7xXVh1fCVnFUhwtU8BQvVDVwD+177Lw47H5FsUG+zr8QAiwg1CAzDZ92FqLsq5Jlzue0zIcbfwX97Nd0tFccadOaaD6eEw3/MB40KbosFM36epuXF+AFj0nuJ7RkZx1tahU7IEXyzwuUFRPCo3I7C42PuAhuZB4X2xwasZT9gsyCshjrEune8NFfbqF34JCc6Y5mkM5WgEFr1H+QyAmlPzCMYGB3n1Txw3zMkI3sp4z3LAPXmIoPJ6h+8xqUEf5CCBGH/xvqVGzT/nk40Z9PQ/aai5/x7BRRDjVu9reqkHyMUG09ek/C8qfhx63oPB7Bne9xTzfFfW4MzMR2UvCSsEg/7HZL1nOivHk/vJdL8UxPHakGKwsHf431Sl5sz86jGDbfwPS1MJF4dbhwVGZPJ/G3Ikmz5u65948cdQCFjgk4w3dUU4Ps+CPMHS47xPKwsVeXCorTkcSS0ZL2s/mW9DwuBgXzZama4wM8Q8SAMzIot/x0cn5dyYtrgx6319Re7S+GmIMfrf4Z+yIVLEiAmLpZtkTVhQilMbPR85xkfH+OesiLCQRwwqpzPEP12Qly5sJAIWuGVoxkwnoeZutpCdmUMzlyQRF5zeODOIgb8wc6aZYo/9itiYSYBhmQhQk6MbZAbWovdb2SNtRfFhFHJxx2I9vxtoDQYnHd2IWTsxsO5xNUbaiuJLBU2cM9jAP/GiddjUwOc6PWfQE/x7X1N7orMIuxWEQIwN/Y6wbdreHdetEgTWAhd9mT1vr60CKQoBi9/4c5Ov5y1O3XWlIbAW2O5mdjTRuUgEEuCdzInLFSUY+pu9ANP5gGASYPzHNceONgcCI7JnLqeegKN+8D10Ug2sAXDAElK5esaRF4iAhdm0xtTpih0MPPwF1D92NjEA+p67KSm6vqH0xSLQMixjFuCKEHDTQ5YCSGLbEfMGAD74we31s18wAgZ9v1Vz8rqIiBZy2sanngIASezXhMSmzGO/x+9QpHMidbJfOAItf6s9e15ExDmS00b86IW+raKOjTHWWmuNiePWhGnhLS8t1yRrjx5vOgSSJR04axGK0o6kLBixyxP7Da5ep9n6+890+/u0OobPN6MfwOHZyXo7DNITRtGsOUde8MbZ5956/+anb77Nd08986y1TtxqpJCkipx0UvjNgcBfWWsE/dcYiNKRyvh/FznVoexTeKTZ8oEE7w5gxDpEJxQR5XSUckuKUjqKnFJSj9cToVKq+RCAwbFb1JG1tZPjClSvyacTnZtRBxDj7o/rMINVonSi86B3n6RrSh3AIjKScBCI0Ck+uzuwdlMiYIHxp3UYDVZR/LzAoDuwVlMiAIO+l5CRCgCBCOmEW2wHGCRNjAAmn9ZhBb9y/CtN/mSPtKpsXgQSg/mvDqqviu209i8/r63J2LwIwAATl5CucRC0thXOXLGp0MQIJAb4bA6pGwOBiIgmBx06oX2PuYkRgLXA7y/sbEWbXUCQ+sMtq1rszYwADGBemU5Kp8vaqjJakz0+fNPXUmtqBGCA5KiTVra2bRO+Io/rtmVGV7W5EYABMH79aW0YSCe5F+1ITn9uQnZTuckRgEmA3uP2URUM6vQHlaLZkRy1/mTU7Kk3OwKwFsCer06X1laHdNw1aW2bTLvxvxZ22E5vegTSHndy7NhNB6Zv/KSq4DvqKiKiXJRex9jstY32agUQXRuByi4H1jv3/Tl9Kjv6OtKutQMiIqKUczqq3ExX/33lp+P7Akjq2kfoCgi0YoDe+469ZvpQlWkBAxbccMni4YPRiV2UroJA25YH7Na/ePjtC444afsHRs7tsc6AAQMG9Ro46tE5V6/f8+x/eS/tmXe4fdI1EUg3A9pYM/MePOV7syfeM7HfrlsPnt+2QBN3fh81adYOScZyrfHtDdk4tiu7yi6GwAq95Aqt+l/qogg0EMsSgRKBEoESgRKBEoESgRKBEoESgRKBEoESgRKBEoESgRKBEoESgRKBjvYLrljNAegYgZ0KHpFTMAKK7qlCpyQV7gci/mx1N4JaOiASZjBhV0JA86Ji50QV7QcirrW6u8GaCEjIWQRdAQHRvHJNACAbAc1fre5xsBYCIpqPr/5OMBuBgANpugQCQs2TsMZQAqzV7rULoajQD3E3X1bcdrExvYNy6BrEP5AAD5G6cvVWtOInWLMoAUaT1No5rUlegDUiCWiPwPARlQkZcunkNY5/AAbYb6dfjbj6tUXDsUbZfxutcBZzjeQflYPINl5T2S+ppJJKKqmkkkoqqaSSSiqppJJKKqmkkkoqqaSSSiqpJB/9P/XK5tvUI+pHAAAAAElFTkSuQmCC",(function(e){Be.loadingLocks.delete(ft.search)})),shapesIcon:(new e.TextureLoader).load("data:image/png;base64,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",(function(e){Be.loadingLocks.delete(ft.shapes)})),textureIcon:(new e.TextureLoader).load("data:image/png;base64,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",(function(e){Be.loadingLocks.delete(ft.texture)})),trashIcon:(new e.TextureLoader).load("data:image/png;base64,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",(function(e){Be.loadingLocks.delete(ft.trash)})),undoIcon:(new e.TextureLoader).load("data:image/png;base64,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",(function(e){Be.loadingLocks.delete(ft.undo)})),redoIcon:(new e.TextureLoader).load("data:image/png;base64,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",(function(e){Be.loadingLocks.delete(ft.redo)})),videoIcon:(new e.TextureLoader).load("data:image/png;base64,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",(function(e){Be.loadingLocks.delete(ft.video)})),blackPixel:(new e.TextureLoader).load("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAAAAAA6fptVAAAACXBIWXMAAAsTAAALEwEAmpwYAAAACklEQVQIHWNgAAAAAgABz8g15QAAAABJRU5ErkJggg==",(function(e){Be.loadingLocks.delete(bt)}))},wt={defaultMeshMaterial:new e.MeshLambertMaterial({color:65280,side:e.DoubleSide})},Ct={black:new e.Color(0),green:new e.Color(65280),red:new e.Color(16711680),white:new e.Color(16777215),yellow:new e.Color(16776960),defaultIdle:new e.Color(9868950),defaultHovered:new e.Color(4408907),defaultMenuBackground:new e.Color(0),keyboard:new e.Color(8750469),keyboardButtonIdle:new e.Color(3552822),keyboardButtonHovered:new e.Color(1842204),keyboardButtonSelected:new e.Color(1088605)},yt="/fonts/OpenSans-Regular-msdf.json",vt="/fonts/OpenSans-Regular-msdf.png",Bt=.03,Et=.02;const St=[new e.Vector3,new e.Vector3,new e.Vector3],Mt=new e.Vector2,xt=new e.Euler,Tt=new e.Quaternion;let Pt=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),kt=new e.BufferGeometry;kt.setIndex(new e.BufferAttribute(Pt,1)),kt.setAttribute("position",new e.Float32BufferAttribute([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3));const Dt={geometry:kt,material:new e.LineBasicMaterial({color:Ct.yellow,toneMapped:!1})};const Ft=new Set;for(let e of" 1234567890`~!@#$%^&*()-_=+[]{}\\|;:'\",.<>/?qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM")Ft.add(e);function Qt(e,t){for(let i in e)t[e[i]]=i}const Rt={Multiply:e.MultiplyOperation,Mix:e.MixOperation,Add:e.AddOperation},Ot={Reflection:e.CubeReflectionMapping,Refraction:e.CubeRefractionMapping},Lt={Tangent:e.TangentSpaceNormalMap,Object:e.ObjectSpaceNormalMap},Nt={"Front Side":e.FrontSide,"Back Side":e.BackSide,"Both Sides":e.DoubleSide},Ut={Clamp:e.ClampToEdgeWrapping,Repeat:e.RepeatWrapping,Mirrored:e.MirroredRepeatWrapping},Ht={},Gt={},jt={},zt={},Vt={};Qt(Rt,Ht),Qt(Ot,Gt),Qt(Lt,jt),Qt(Nt,zt),Qt(Ut,Vt);class GLTFLoader extends i{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register((function(e){return new GLTFMaterialsClearcoatExtension(e)})),this.register((function(e){return new GLTFTextureBasisUExtension(e)})),this.register((function(e){return new GLTFTextureWebPExtension(e)})),this.register((function(e){return new GLTFMaterialsSheenExtension(e)})),this.register((function(e){return new GLTFMaterialsTransmissionExtension(e)})),this.register((function(e){return new GLTFMaterialsVolumeExtension(e)})),this.register((function(e){return new GLTFMaterialsIorExtension(e)})),this.register((function(e){return new GLTFMaterialsEmissiveStrengthExtension(e)})),this.register((function(e){return new GLTFMaterialsSpecularExtension(e)})),this.register((function(e){return new GLTFMaterialsIridescenceExtension(e)})),this.register((function(e){return new GLTFLightsExtension(e)})),this.register((function(e){return new GLTFMeshoptCompression(e)})),this.register((function(e){return new GLTFMeshGpuInstancing(e)}))}load(e,t,i,r){const a=this;let o;o=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:s.extractUrlBase(e),this.manager.itemStart(e);const l=function(t){r?r(t):console.error(t),a.manager.itemError(e),a.manager.itemEnd(e)},h=new n(this.manager);h.setPath(this.path),h.setResponseType("arraybuffer"),h.setRequestHeader(this.requestHeader),h.setWithCredentials(this.withCredentials),h.load(e,(function(i){try{a.parse(i,o,(function(i){t(i),a.manager.itemEnd(e)}),l)}catch(e){l(e)}}),i,l)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,t,i,n){let r;const a={},o={};if("string"==typeof e)r=JSON.parse(e);else if(e instanceof ArrayBuffer){if(s.decodeText(new Uint8Array(e,0,4))===Wt){try{a[Xt.KHR_BINARY_GLTF]=new GLTFBinaryExtension(e)}catch(e){return void(n&&n(e))}r=JSON.parse(a[Xt.KHR_BINARY_GLTF].content)}else r=JSON.parse(s.decodeText(new Uint8Array(e)))}else r=e;if(void 0===r.asset||r.asset.version[0]<2)return void(n&&n(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const l=new GLTFParser(r,{path:t||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});l.fileLoader.setRequestHeader(this.requestHeader);for(let e=0;e<this.pluginCallbacks.length;e++){const t=this.pluginCallbacks[e](l);o[t.name]=t,a[t.name]=!0}if(r.extensionsUsed)for(let e=0;e<r.extensionsUsed.length;++e){const t=r.extensionsUsed[e],i=r.extensionsRequired||[];switch(t){case Xt.KHR_MATERIALS_UNLIT:a[t]=new GLTFMaterialsUnlitExtension;break;case Xt.KHR_DRACO_MESH_COMPRESSION:a[t]=new GLTFDracoMeshCompressionExtension(r,this.dracoLoader);break;case Xt.KHR_TEXTURE_TRANSFORM:a[t]=new GLTFTextureTransformExtension;break;case Xt.KHR_MESH_QUANTIZATION:a[t]=new GLTFMeshQuantizationExtension;break;default:i.indexOf(t)>=0&&void 0===o[t]&&console.warn('THREE.GLTFLoader: Unknown extension "'+t+'".')}}l.setExtensions(a),l.setPlugins(o),l.parse(i,n)}parseAsync(e,t){const i=this;return new Promise((function(s,n){i.parse(e,t,s,n)}))}}function Yt(){let e={};return{get:function(t){return e[t]},add:function(t,i){e[t]=i},remove:function(t){delete e[t]},removeAll:function(){e={}}}}const Xt={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class GLTFLightsExtension{constructor(e){this.parser=e,this.name=Xt.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const e=this.parser,t=this.parser.json.nodes||[];for(let i=0,s=t.length;i<s;i++){const s=t[i];s.extensions&&s.extensions[this.name]&&void 0!==s.extensions[this.name].light&&e._addNodeRef(this.cache,s.extensions[this.name].light)}}_loadLight(e){const t=this.parser,i="light:"+e;let s=t.cache.get(i);if(s)return s;const n=t.json,h=((n.extensions&&n.extensions[this.name]||{}).lights||[])[e];let c;const d=new r(16777215);void 0!==h.color&&d.fromArray(h.color);const A=void 0!==h.range?h.range:0;switch(h.type){case"directional":c=new l(d),c.target.position.set(0,0,-1),c.add(c.target);break;case"point":c=new o(d),c.distance=A;break;case"spot":c=new a(d),c.distance=A,h.spot=h.spot||{},h.spot.innerConeAngle=void 0!==h.spot.innerConeAngle?h.spot.innerConeAngle:0,h.spot.outerConeAngle=void 0!==h.spot.outerConeAngle?h.spot.outerConeAngle:Math.PI/4,c.angle=h.spot.outerConeAngle,c.penumbra=1-h.spot.innerConeAngle/h.spot.outerConeAngle,c.target.position.set(0,0,-1),c.add(c.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+h.type)}return c.position.set(0,0,0),c.decay=2,ci(c,h),void 0!==h.intensity&&(c.intensity=h.intensity),c.name=t.createUniqueName(h.name||"light_"+e),s=Promise.resolve(c),t.cache.add(i,s),s}getDependency(e,t){if("light"===e)return this._loadLight(t)}createNodeAttachment(e){const t=this,i=this.parser,s=i.json.nodes[e],n=(s.extensions&&s.extensions[this.name]||{}).light;return void 0===n?null:this._loadLight(n).then((function(e){return i._getNodeRef(t.cache,n,e)}))}}class GLTFMaterialsUnlitExtension{constructor(){this.name=Xt.KHR_MATERIALS_UNLIT}getMaterialType(){return h}extendParams(e,t,i){const s=[];e.color=new r(1,1,1),e.opacity=1;const n=t.pbrMetallicRoughness;if(n){if(Array.isArray(n.baseColorFactor)){const t=n.baseColorFactor;e.color.fromArray(t),e.opacity=t[3]}void 0!==n.baseColorTexture&&s.push(i.assignTexture(e,"map",n.baseColorTexture,c))}return Promise.all(s)}}class GLTFMaterialsEmissiveStrengthExtension{constructor(e){this.parser=e,this.name=Xt.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,t){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=i.extensions[this.name].emissiveStrength;return void 0!==s&&(t.emissiveIntensity=s),Promise.resolve()}}class GLTFMaterialsClearcoatExtension{constructor(e){this.parser=e,this.name=Xt.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?d:null}extendMaterialParams(e,t){const i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const n=[],r=s.extensions[this.name];if(void 0!==r.clearcoatFactor&&(t.clearcoat=r.clearcoatFactor),void 0!==r.clearcoatTexture&&n.push(i.assignTexture(t,"clearcoatMap",r.clearcoatTexture)),void 0!==r.clearcoatRoughnessFactor&&(t.clearcoatRoughness=r.clearcoatRoughnessFactor),void 0!==r.clearcoatRoughnessTexture&&n.push(i.assignTexture(t,"clearcoatRoughnessMap",r.clearcoatRoughnessTexture)),void 0!==r.clearcoatNormalTexture&&(n.push(i.assignTexture(t,"clearcoatNormalMap",r.clearcoatNormalTexture)),void 0!==r.clearcoatNormalTexture.scale)){const e=r.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new A(e,e)}return Promise.all(n)}}class GLTFMaterialsIridescenceExtension{constructor(e){this.parser=e,this.name=Xt.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?d:null}extendMaterialParams(e,t){const i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const n=[],r=s.extensions[this.name];return void 0!==r.iridescenceFactor&&(t.iridescence=r.iridescenceFactor),void 0!==r.iridescenceTexture&&n.push(i.assignTexture(t,"iridescenceMap",r.iridescenceTexture)),void 0!==r.iridescenceIor&&(t.iridescenceIOR=r.iridescenceIor),void 0===t.iridescenceThicknessRange&&(t.iridescenceThicknessRange=[100,400]),void 0!==r.iridescenceThicknessMinimum&&(t.iridescenceThicknessRange[0]=r.iridescenceThicknessMinimum),void 0!==r.iridescenceThicknessMaximum&&(t.iridescenceThicknessRange[1]=r.iridescenceThicknessMaximum),void 0!==r.iridescenceThicknessTexture&&n.push(i.assignTexture(t,"iridescenceThicknessMap",r.iridescenceThicknessTexture)),Promise.all(n)}}class GLTFMaterialsSheenExtension{constructor(e){this.parser=e,this.name=Xt.KHR_MATERIALS_SHEEN}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?d:null}extendMaterialParams(e,t){const i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const n=[];t.sheenColor=new r(0,0,0),t.sheenRoughness=0,t.sheen=1;const a=s.extensions[this.name];return void 0!==a.sheenColorFactor&&t.sheenColor.fromArray(a.sheenColorFactor),void 0!==a.sheenRoughnessFactor&&(t.sheenRoughness=a.sheenRoughnessFactor),void 0!==a.sheenColorTexture&&n.push(i.assignTexture(t,"sheenColorMap",a.sheenColorTexture,c)),void 0!==a.sheenRoughnessTexture&&n.push(i.assignTexture(t,"sheenRoughnessMap",a.sheenRoughnessTexture)),Promise.all(n)}}class GLTFMaterialsTransmissionExtension{constructor(e){this.parser=e,this.name=Xt.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?d:null}extendMaterialParams(e,t){const i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const n=[],r=s.extensions[this.name];return void 0!==r.transmissionFactor&&(t.transmission=r.transmissionFactor),void 0!==r.transmissionTexture&&n.push(i.assignTexture(t,"transmissionMap",r.transmissionTexture)),Promise.all(n)}}class GLTFMaterialsVolumeExtension{constructor(e){this.parser=e,this.name=Xt.KHR_MATERIALS_VOLUME}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?d:null}extendMaterialParams(e,t){const i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const n=[],a=s.extensions[this.name];t.thickness=void 0!==a.thicknessFactor?a.thicknessFactor:0,void 0!==a.thicknessTexture&&n.push(i.assignTexture(t,"thicknessMap",a.thicknessTexture)),t.attenuationDistance=a.attenuationDistance||1/0;const o=a.attenuationColor||[1,1,1];return t.attenuationColor=new r(o[0],o[1],o[2]),Promise.all(n)}}class GLTFMaterialsIorExtension{constructor(e){this.parser=e,this.name=Xt.KHR_MATERIALS_IOR}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?d:null}extendMaterialParams(e,t){const i=this.parser.json.materials[e];if(!i.extensions||!i.extensions[this.name])return Promise.resolve();const s=i.extensions[this.name];return t.ior=void 0!==s.ior?s.ior:1.5,Promise.resolve()}}class GLTFMaterialsSpecularExtension{constructor(e){this.parser=e,this.name=Xt.KHR_MATERIALS_SPECULAR}getMaterialType(e){const t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?d:null}extendMaterialParams(e,t){const i=this.parser,s=i.json.materials[e];if(!s.extensions||!s.extensions[this.name])return Promise.resolve();const n=[],a=s.extensions[this.name];t.specularIntensity=void 0!==a.specularFactor?a.specularFactor:1,void 0!==a.specularTexture&&n.push(i.assignTexture(t,"specularIntensityMap",a.specularTexture));const o=a.specularColorFactor||[1,1,1];return t.specularColor=new r(o[0],o[1],o[2]),void 0!==a.specularColorTexture&&n.push(i.assignTexture(t,"specularColorMap",a.specularColorTexture,c)),Promise.all(n)}}class GLTFTextureBasisUExtension{constructor(e){this.parser=e,this.name=Xt.KHR_TEXTURE_BASISU}loadTexture(e){const t=this.parser,i=t.json,s=i.textures[e];if(!s.extensions||!s.extensions[this.name])return null;const n=s.extensions[this.name],r=t.options.ktx2Loader;if(!r){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,n.source,r)}}class GLTFTextureWebPExtension{constructor(e){this.parser=e,this.name=Xt.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){const t=this.name,i=this.parser,s=i.json,n=s.textures[e];if(!n.extensions||!n.extensions[t])return null;const r=n.extensions[t],a=s.images[r.source];let o=i.textureLoader;if(a.uri){const e=i.options.manager.getHandler(a.uri);null!==e&&(o=e)}return this.detectSupport().then((function(n){if(n)return i.loadTextureImage(e,r.source,o);if(s.extensionsRequired&&s.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return i.loadTexture(e)}))}detectSupport(){return this.isSupported||(this.isSupported=new Promise((function(e){const t=new Image;t.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",t.onload=t.onerror=function(){e(1===t.height)}}))),this.isSupported}}class GLTFMeshoptCompression{constructor(e){this.name=Xt.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){const t=this.parser.json,i=t.bufferViews[e];if(i.extensions&&i.extensions[this.name]){const e=i.extensions[this.name],s=this.parser.getDependency("buffer",e.buffer),n=this.parser.options.meshoptDecoder;if(!n||!n.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return s.then((function(t){const i=e.byteOffset||0,s=e.byteLength||0,r=e.count,a=e.byteStride,o=new Uint8Array(t,i,s);return n.decodeGltfBufferAsync?n.decodeGltfBufferAsync(r,a,o,e.mode,e.filter).then((function(e){return e.buffer})):n.ready.then((function(){const t=new ArrayBuffer(r*a);return n.decodeGltfBuffer(new Uint8Array(t),r,a,o,e.mode,e.filter),t}))}))}return null}}class GLTFMeshGpuInstancing{constructor(e){this.name=Xt.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){const i=this.parser.json,s=i.nodes[e];if(!s.extensions||!s.extensions[this.name]||void 0===s.mesh)return null;const n=i.meshes[s.mesh];for(const e of n.primitives)if(e.mode!==Jt.TRIANGLES&&e.mode!==Jt.TRIANGLE_STRIP&&e.mode!==Jt.TRIANGLE_FAN&&void 0!==e.mode)return null;const r=s.extensions[this.name].attributes,a=[],o={};for(const e in r)a.push(this.parser.getDependency("accessor",r[e]).then((t=>(o[e]=t,o[e]))));return a.length<1?null:(a.push(this.parser.createNodeMesh(e)),Promise.all(a).then((e=>{const i=e.pop(),s=i.isGroup?i.children:[i],n=e[0].count,r=[];for(const e of s){const i=new u,s=new p,a=new t,l=new p(1,1,1),h=new g(e.geometry,e.material,n);for(let e=0;e<n;e++)o.TRANSLATION&&s.fromBufferAttribute(o.TRANSLATION,e),o.ROTATION&&a.fromBufferAttribute(o.ROTATION,e),o.SCALE&&l.fromBufferAttribute(o.SCALE,e),h.setMatrixAt(e,i.compose(s,a,l));for(const t in o)"TRANSLATION"!==t&&"ROTATION"!==t&&"SCALE"!==t&&e.geometry.setAttribute(t,o[t]);m.prototype.copy.call(h,e),h.frustumCulled=!1,this.parser.assignFinalMaterial(h),r.push(h)}return i.isGroup?(i.clear(),i.add(...r),i):r[0]})))}}const Wt="glTF",Kt=1313821514,Zt=5130562;class GLTFBinaryExtension{constructor(e){this.name=Xt.KHR_BINARY_GLTF,this.content=null,this.body=null;const t=new DataView(e,0,12);if(this.header={magic:s.decodeText(new Uint8Array(e.slice(0,4))),version:t.getUint32(4,!0),length:t.getUint32(8,!0)},this.header.magic!==Wt)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const i=this.header.length-12,n=new DataView(e,12);let r=0;for(;r<i;){const t=n.getUint32(r,!0);r+=4;const i=n.getUint32(r,!0);if(r+=4,i===Kt){const i=new Uint8Array(e,12+r,t);this.content=s.decodeText(i)}else if(i===Zt){const i=12+r;this.body=e.slice(i,i+t)}r+=t}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class GLTFDracoMeshCompressionExtension{constructor(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Xt.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}decodePrimitive(e,t){const i=this.json,s=this.dracoLoader,n=e.extensions[this.name].bufferView,r=e.extensions[this.name].attributes,a={},o={},l={};for(const e in r){const t=si[e]||e.toLowerCase();a[t]=r[e]}for(const t in e.attributes){const s=si[t]||t.toLowerCase();if(void 0!==r[t]){const n=i.accessors[e.attributes[t]],r=$t[n.componentType];l[s]=r.name,o[s]=!0===n.normalized}}return t.getDependency("bufferView",n).then((function(e){return new Promise((function(t){s.decodeDracoFile(e,(function(e){for(const t in e.attributes){const i=e.attributes[t],s=o[t];void 0!==s&&(i.normalized=s)}t(e)}),a,l)}))}))}}class GLTFTextureTransformExtension{constructor(){this.name=Xt.KHR_TEXTURE_TRANSFORM}extendTexture(e,t){return void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),void 0===t.offset&&void 0===t.rotation&&void 0===t.scale||(e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),e.needsUpdate=!0),e}}class GLTFMeshQuantizationExtension{constructor(){this.name=Xt.KHR_MESH_QUANTIZATION}}class GLTFCubicSplineInterpolant extends he{constructor(e,t,i,s){super(e,t,i,s)}copySampleValue_(e){const t=this.resultBuffer,i=this.sampleValues,s=this.valueSize,n=e*s*3+s;for(let e=0;e!==s;e++)t[e]=i[n+e];return t}interpolate_(e,t,i,s){const n=this.resultBuffer,r=this.sampleValues,a=this.valueSize,o=2*a,l=3*a,h=s-t,c=(i-t)/h,d=c*c,A=d*c,u=e*l,p=u-l,g=-2*A+3*d,m=A-d,_=1-g,f=m-d+c;for(let e=0;e!==a;e++){const t=r[p+e+a],i=r[p+e+o]*h,s=r[u+e+a],l=r[u+e]*h;n[e]=_*t+f*i+g*s+m*l}return n}}const qt=new t;class GLTFCubicSplineQuaternionInterpolant extends GLTFCubicSplineInterpolant{interpolate_(e,t,i,s){const n=super.interpolate_(e,t,i,s);return qt.fromArray(n).normalize().toArray(n),n}}const Jt={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},$t={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},ei={9728:X,9729:C,9984:W,9985:K,9986:Z,9987:y},ti={33071:q,33648:J,10497:v},ii={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},si={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},ni={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},ri={CUBICSPLINE:void 0,LINEAR:j,STEP:ee},ai="OPAQUE",oi="MASK",li="BLEND";function hi(e,t,i){for(const s in i.extensions)void 0===e[s]&&(t.userData.gltfExtensions=t.userData.gltfExtensions||{},t.userData.gltfExtensions[s]=i.extensions[s])}function ci(e,t){void 0!==t.extras&&("object"==typeof t.extras?Object.assign(e.userData,t.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+t.extras))}function di(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(let i=0,s=t.weights.length;i<s;i++)e.morphTargetInfluences[i]=t.weights[i];if(t.extras&&Array.isArray(t.extras.targetNames)){const i=t.extras.targetNames;if(e.morphTargetInfluences.length===i.length){e.morphTargetDictionary={};for(let t=0,s=i.length;t<s;t++)e.morphTargetDictionary[i[t]]=t}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function Ai(e){const t=e.extensions&&e.extensions[Xt.KHR_DRACO_MESH_COMPRESSION];let i;return i=t?"draco:"+t.bufferView+":"+t.indices+":"+ui(t.attributes):e.indices+":"+ui(e.attributes)+":"+e.mode,i}function ui(e){let t="";const i=Object.keys(e).sort();for(let s=0,n=i.length;s<n;s++)t+=i[s]+":"+e[i[s]]+";";return t}function pi(e){switch(e){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}class GLTFParser{constructor(e={},t={}){this.json=e,this.extensions={},this.plugins={},this.options=t,this.cache=new Yt,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let i=!1,s=!1,r=-1;"undefined"!=typeof navigator&&(i=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),s=navigator.userAgent.indexOf("Firefox")>-1,r=s?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),"undefined"==typeof createImageBitmap||i||s&&r<98?this.textureLoader=new _(this.options.manager):this.textureLoader=new f(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new n(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,t){const i=this,s=this.json,n=this.extensions;this.cache.removeAll(),this._invokeAll((function(e){return e._markDefs&&e._markDefs()})),Promise.all(this._invokeAll((function(e){return e.beforeRoot&&e.beforeRoot()}))).then((function(){return Promise.all([i.getDependencies("scene"),i.getDependencies("animation"),i.getDependencies("camera")])})).then((function(t){const r={scene:t[0][s.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:s.asset,parser:i,userData:{}};hi(n,r,s),ci(r,s),Promise.all(i._invokeAll((function(e){return e.afterRoot&&e.afterRoot(r)}))).then((function(){e(r)}))})).catch(t)}_markDefs(){const e=this.json.nodes||[],t=this.json.skins||[],i=this.json.meshes||[];for(let i=0,s=t.length;i<s;i++){const s=t[i].joints;for(let t=0,i=s.length;t<i;t++)e[s[t]].isBone=!0}for(let t=0,s=e.length;t<s;t++){const s=e[t];void 0!==s.mesh&&(this._addNodeRef(this.meshCache,s.mesh),void 0!==s.skin&&(i[s.mesh].isSkinnedMesh=!0)),void 0!==s.camera&&this._addNodeRef(this.cameraCache,s.camera)}}_addNodeRef(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)}_getNodeRef(e,t,i){if(e.refs[t]<=1)return i;const s=i.clone(),n=(e,t)=>{const i=this.associations.get(e);null!=i&&this.associations.set(t,i);for(const[i,s]of e.children.entries())n(s,t.children[i])};return n(i,s),s.name+="_instance_"+e.uses[t]++,s}_invokeOne(e){const t=Object.values(this.plugins);t.push(this);for(let i=0;i<t.length;i++){const s=e(t[i]);if(s)return s}return null}_invokeAll(e){const t=Object.values(this.plugins);t.unshift(this);const i=[];for(let s=0;s<t.length;s++){const n=e(t[s]);n&&i.push(n)}return i}getDependency(e,t){const i=e+":"+t;let s=this.cache.get(i);if(!s){switch(e){case"scene":s=this.loadScene(t);break;case"node":s=this.loadNode(t);break;case"mesh":s=this._invokeOne((function(e){return e.loadMesh&&e.loadMesh(t)}));break;case"accessor":s=this.loadAccessor(t);break;case"bufferView":s=this._invokeOne((function(e){return e.loadBufferView&&e.loadBufferView(t)}));break;case"buffer":s=this.loadBuffer(t);break;case"material":s=this._invokeOne((function(e){return e.loadMaterial&&e.loadMaterial(t)}));break;case"texture":s=this._invokeOne((function(e){return e.loadTexture&&e.loadTexture(t)}));break;case"skin":s=this.loadSkin(t);break;case"animation":s=this._invokeOne((function(e){return e.loadAnimation&&e.loadAnimation(t)}));break;case"camera":s=this.loadCamera(t);break;default:if(s=this._invokeOne((function(i){return i!=this&&i.getDependency&&i.getDependency(e,t)})),!s)throw new Error("Unknown type: "+e)}this.cache.add(i,s)}return s}getDependencies(e){let t=this.cache.get(e);if(!t){const i=this,s=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(s.map((function(t,s){return i.getDependency(e,s)}))),this.cache.add(e,t)}return t}loadBuffer(e){const t=this.json.buffers[e],i=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[Xt.KHR_BINARY_GLTF].body);const n=this.options;return new Promise((function(e,r){i.load(s.resolveURL(t.uri,n.path),e,void 0,(function(){r(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))}))}))}loadBufferView(e){const t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then((function(e){const i=t.byteLength||0,s=t.byteOffset||0;return e.slice(s,s+i)}))}loadAccessor(e){const t=this,i=this.json,s=this.json.accessors[e];if(void 0===s.bufferView&&void 0===s.sparse){const e=ii[s.type],t=$t[s.componentType],i=!0===s.normalized,n=new t(s.count*e);return Promise.resolve(new b(n,e,i))}const n=[];return void 0!==s.bufferView?n.push(this.getDependency("bufferView",s.bufferView)):n.push(null),void 0!==s.sparse&&(n.push(this.getDependency("bufferView",s.sparse.indices.bufferView)),n.push(this.getDependency("bufferView",s.sparse.values.bufferView))),Promise.all(n).then((function(e){const n=e[0],r=ii[s.type],a=$t[s.componentType],o=a.BYTES_PER_ELEMENT,l=o*r,h=s.byteOffset||0,c=void 0!==s.bufferView?i.bufferViews[s.bufferView].byteStride:void 0,d=!0===s.normalized;let A,u;if(c&&c!==l){const e=Math.floor(h/c),i="InterleavedBuffer:"+s.bufferView+":"+s.componentType+":"+e+":"+s.count;let l=t.cache.get(i);l||(A=new a(n,e*c,s.count*c/o),l=new I(A,c/o),t.cache.add(i,l)),u=new w(l,r,h%c/o,d)}else A=null===n?new a(s.count*r):new a(n,h,s.count*r),u=new b(A,r,d);if(void 0!==s.sparse){const t=ii.SCALAR,i=$t[s.sparse.indices.componentType],o=s.sparse.indices.byteOffset||0,l=s.sparse.values.byteOffset||0,h=new i(e[1],o,s.sparse.count*t),c=new a(e[2],l,s.sparse.count*r);null!==n&&(u=new b(u.array.slice(),u.itemSize,u.normalized));for(let e=0,t=h.length;e<t;e++){const t=h[e];if(u.setX(t,c[e*r]),r>=2&&u.setY(t,c[e*r+1]),r>=3&&u.setZ(t,c[e*r+2]),r>=4&&u.setW(t,c[e*r+3]),r>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return u}))}loadTexture(e){const t=this.json,i=this.options,s=t.textures[e].source,n=t.images[s];let r=this.textureLoader;if(n.uri){const e=i.manager.getHandler(n.uri);null!==e&&(r=e)}return this.loadTextureImage(e,s,r)}loadTextureImage(e,t,i){const s=this,n=this.json,r=n.textures[e],a=n.images[t],o=(a.uri||a.bufferView)+":"+r.sampler;if(this.textureCache[o])return this.textureCache[o];const l=this.loadImageSource(t,i).then((function(t){t.flipY=!1,t.name=r.name||a.name||"";const i=(n.samplers||{})[r.sampler]||{};return t.magFilter=ei[i.magFilter]||C,t.minFilter=ei[i.minFilter]||y,t.wrapS=ti[i.wrapS]||v,t.wrapT=ti[i.wrapT]||v,s.associations.set(t,{textures:e}),t})).catch((function(){return null}));return this.textureCache[o]=l,l}loadImageSource(e,t){const i=this,n=this.json,r=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then((e=>e.clone()));const a=n.images[e],o=self.URL||self.webkitURL;let l=a.uri||"",h=!1;if(void 0!==a.bufferView)l=i.getDependency("bufferView",a.bufferView).then((function(e){h=!0;const t=new Blob([e],{type:a.mimeType});return l=o.createObjectURL(t),l}));else if(void 0===a.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");const c=Promise.resolve(l).then((function(e){return new Promise((function(i,n){let a=i;!0===t.isImageBitmapLoader&&(a=function(e){const t=new ie(e);t.needsUpdate=!0,i(t)}),t.load(s.resolveURL(e,r.path),a,void 0,n)}))})).then((function(e){var t;return!0===h&&o.revokeObjectURL(l),e.userData.mimeType=a.mimeType||((t=a.uri).search(/\.jpe?g($|\?)/i)>0||0===t.search(/^data\:image\/jpeg/)?"image/jpeg":t.search(/\.webp($|\?)/i)>0||0===t.search(/^data\:image\/webp/)?"image/webp":"image/png"),e})).catch((function(e){throw console.error("THREE.GLTFLoader: Couldn't load texture",l),e}));return this.sourceCache[e]=c,c}assignTexture(e,t,i,s){const n=this;return this.getDependency("texture",i.index).then((function(r){if(!r)return null;if(void 0===i.texCoord||0==i.texCoord||"aoMap"===t&&1==i.texCoord||console.warn("THREE.GLTFLoader: Custom UV set "+i.texCoord+" for texture "+t+" not yet supported."),n.extensions[Xt.KHR_TEXTURE_TRANSFORM]){const e=void 0!==i.extensions?i.extensions[Xt.KHR_TEXTURE_TRANSFORM]:void 0;if(e){const t=n.associations.get(r);r=n.extensions[Xt.KHR_TEXTURE_TRANSFORM].extendTexture(r,e),n.associations.set(r,t)}}return void 0!==s&&(r.encoding=s),e[t]=r,r}))}assignFinalMaterial(e){const t=e.geometry;let i=e.material;const s=void 0===t.attributes.tangent,n=void 0!==t.attributes.color,r=void 0===t.attributes.normal;if(e.isPoints){const e="PointsMaterial:"+i.uuid;let t=this.cache.get(e);t||(t=new B,E.prototype.copy.call(t,i),t.color.copy(i.color),t.map=i.map,t.sizeAttenuation=!1,this.cache.add(e,t)),i=t}else if(e.isLine){const e="LineBasicMaterial:"+i.uuid;let t=this.cache.get(e);t||(t=new S,E.prototype.copy.call(t,i),t.color.copy(i.color),this.cache.add(e,t)),i=t}if(s||n||r){let e="ClonedMaterial:"+i.uuid+":";s&&(e+="derivative-tangents:"),n&&(e+="vertex-colors:"),r&&(e+="flat-shading:");let t=this.cache.get(e);t||(t=i.clone(),n&&(t.vertexColors=!0),r&&(t.flatShading=!0),s&&(t.normalScale&&(t.normalScale.y*=-1),t.clearcoatNormalScale&&(t.clearcoatNormalScale.y*=-1)),this.cache.add(e,t),this.associations.set(t,this.associations.get(i))),i=t}i.aoMap&&void 0===t.attributes.uv2&&void 0!==t.attributes.uv&&t.setAttribute("uv2",t.attributes.uv),e.material=i}getMaterialType(){return M}loadMaterial(e){const t=this,i=this.json,s=this.extensions,n=i.materials[e];let a;const o={},l=[];if((n.extensions||{})[Xt.KHR_MATERIALS_UNLIT]){const e=s[Xt.KHR_MATERIALS_UNLIT];a=e.getMaterialType(),l.push(e.extendParams(o,n,t))}else{const i=n.pbrMetallicRoughness||{};if(o.color=new r(1,1,1),o.opacity=1,Array.isArray(i.baseColorFactor)){const e=i.baseColorFactor;o.color.fromArray(e),o.opacity=e[3]}void 0!==i.baseColorTexture&&l.push(t.assignTexture(o,"map",i.baseColorTexture,c)),o.metalness=void 0!==i.metallicFactor?i.metallicFactor:1,o.roughness=void 0!==i.roughnessFactor?i.roughnessFactor:1,void 0!==i.metallicRoughnessTexture&&(l.push(t.assignTexture(o,"metalnessMap",i.metallicRoughnessTexture)),l.push(t.assignTexture(o,"roughnessMap",i.metallicRoughnessTexture))),a=this._invokeOne((function(t){return t.getMaterialType&&t.getMaterialType(e)})),l.push(Promise.all(this._invokeAll((function(t){return t.extendMaterialParams&&t.extendMaterialParams(e,o)}))))}!0===n.doubleSided&&(o.side=x);const d=n.alphaMode||ai;if(d===li?(o.transparent=!0,o.depthWrite=!1):(o.transparent=!1,d===oi&&(o.alphaTest=void 0!==n.alphaCutoff?n.alphaCutoff:.5)),void 0!==n.normalTexture&&a!==h&&(l.push(t.assignTexture(o,"normalMap",n.normalTexture)),o.normalScale=new A(1,1),void 0!==n.normalTexture.scale)){const e=n.normalTexture.scale;o.normalScale.set(e,e)}return void 0!==n.occlusionTexture&&a!==h&&(l.push(t.assignTexture(o,"aoMap",n.occlusionTexture)),void 0!==n.occlusionTexture.strength&&(o.aoMapIntensity=n.occlusionTexture.strength)),void 0!==n.emissiveFactor&&a!==h&&(o.emissive=(new r).fromArray(n.emissiveFactor)),void 0!==n.emissiveTexture&&a!==h&&l.push(t.assignTexture(o,"emissiveMap",n.emissiveTexture,c)),Promise.all(l).then((function(){const i=new a(o);return n.name&&(i.name=n.name),ci(i,n),t.associations.set(i,{materials:e}),n.extensions&&hi(s,i,n),i}))}createUniqueName(e){const t=T.sanitizeNodeName(e||"");let i=t;for(let e=1;this.nodeNamesUsed[i];++e)i=t+"_"+e;return this.nodeNamesUsed[i]=!0,i}loadGeometries(e){const t=this,i=this.extensions,s=this.primitiveCache;function n(e){return i[Xt.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then((function(i){return mi(i,e,t)}))}const r=[];for(let i=0,a=e.length;i<a;i++){const a=e[i],o=Ai(a),l=s[o];if(l)r.push(l.promise);else{let e;e=a.extensions&&a.extensions[Xt.KHR_DRACO_MESH_COMPRESSION]?n(a):mi(new P,a,t),s[o]={primitive:a,promise:e},r.push(e)}}return Promise.all(r)}loadMesh(e){const t=this,i=this.json,s=this.extensions,n=i.meshes[e],r=n.primitives,a=[];for(let e=0,t=r.length;e<t;e++){const t=void 0===r[e].material?(void 0===(o=this.cache).DefaultMaterial&&(o.DefaultMaterial=new M({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:te})),o.DefaultMaterial):this.getDependency("material",r[e].material);a.push(t)}var o;return a.push(t.loadGeometries(r)),Promise.all(a).then((function(i){const a=i.slice(0,i.length-1),o=i[i.length-1],l=[];for(let i=0,h=o.length;i<h;i++){const h=o[i],c=r[i];let d;const A=a[i];if(c.mode===Jt.TRIANGLES||c.mode===Jt.TRIANGLE_STRIP||c.mode===Jt.TRIANGLE_FAN||void 0===c.mode)d=!0===n.isSkinnedMesh?new k(h,A):new D(h,A),!0!==d.isSkinnedMesh||d.geometry.attributes.skinWeight.normalized||d.normalizeSkinWeights(),c.mode===Jt.TRIANGLE_STRIP?d.geometry=_i(d.geometry,se):c.mode===Jt.TRIANGLE_FAN&&(d.geometry=_i(d.geometry,Y));else if(c.mode===Jt.LINES)d=new F(h,A);else if(c.mode===Jt.LINE_STRIP)d=new Q(h,A);else if(c.mode===Jt.LINE_LOOP)d=new R(h,A);else{if(c.mode!==Jt.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+c.mode);d=new O(h,A)}Object.keys(d.geometry.morphAttributes).length>0&&di(d,n),d.name=t.createUniqueName(n.name||"mesh_"+e),ci(d,n),c.extensions&&hi(s,d,c),t.assignFinalMaterial(d),l.push(d)}for(let i=0,s=l.length;i<s;i++)t.associations.set(l[i],{meshes:e,primitives:i});if(1===l.length)return l[0];const h=new L;t.associations.set(h,{meshes:e});for(let e=0,t=l.length;e<t;e++)h.add(l[e]);return h}))}loadCamera(e){let t;const i=this.json.cameras[e],s=i[i.type];if(s)return"perspective"===i.type?t=new N(U.radToDeg(s.yfov),s.aspectRatio||1,s.znear||1,s.zfar||2e6):"orthographic"===i.type&&(t=new H(-s.xmag,s.xmag,s.ymag,-s.ymag,s.znear,s.zfar)),i.name&&(t.name=this.createUniqueName(i.name)),ci(t,i),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(e){const t=this.json.skins[e],i=[];for(let e=0,s=t.joints.length;e<s;e++)i.push(this.getDependency("node",t.joints[e]));return void 0!==t.inverseBindMatrices?i.push(this.getDependency("accessor",t.inverseBindMatrices)):i.push(null),Promise.all(i).then((function(e){const i=e.pop(),s=e,n=[],r=[];for(let e=0,a=s.length;e<a;e++){const a=s[e];if(a){n.push(a);const t=new u;null!==i&&t.fromArray(i.array,16*e),r.push(t)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[e])}return new G(n,r)}))}loadAnimation(e){const t=this.json.animations[e],i=[],s=[],n=[],r=[],a=[];for(let e=0,o=t.channels.length;e<o;e++){const o=t.channels[e],l=t.samplers[o.sampler],h=o.target,c=h.node,d=void 0!==t.parameters?t.parameters[l.input]:l.input,A=void 0!==t.parameters?t.parameters[l.output]:l.output;i.push(this.getDependency("node",c)),s.push(this.getDependency("accessor",d)),n.push(this.getDependency("accessor",A)),r.push(l),a.push(h)}return Promise.all([Promise.all(i),Promise.all(s),Promise.all(n),Promise.all(r),Promise.all(a)]).then((function(i){const s=i[0],n=i[1],r=i[2],a=i[3],o=i[4],l=[];for(let e=0,t=s.length;e<t;e++){const t=s[e],i=n[e],h=r[e],c=a[e],d=o[e];if(void 0===t)continue;let A;switch(t.updateMatrix(),ni[d.path]){case ni.weights:A=ae;break;case ni.rotation:A=re;break;default:A=ne}const u=t.name?t.name:t.uuid,p=void 0!==c.interpolation?ri[c.interpolation]:j,g=[];ni[d.path]===ni.weights?t.traverse((function(e){e.morphTargetInfluences&&g.push(e.name?e.name:e.uuid)})):g.push(u);let m=h.array;if(h.normalized){const e=pi(m.constructor),t=new Float32Array(m.length);for(let i=0,s=m.length;i<s;i++)t[i]=m[i]*e;m=t}for(let e=0,t=g.length;e<t;e++){const t=new A(g[e]+"."+ni[d.path],i.array,m,p);"CUBICSPLINE"===c.interpolation&&(t.createInterpolant=function(e){return new(this instanceof re?GLTFCubicSplineQuaternionInterpolant:GLTFCubicSplineInterpolant)(this.times,this.values,this.getValueSize()/3,e)},t.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),l.push(t)}}const h=t.name?t.name:"animation_"+e;return new z(h,void 0,l)}))}createNodeMesh(e){const t=this.json,i=this,s=t.nodes[e];return void 0===s.mesh?null:i.getDependency("mesh",s.mesh).then((function(e){const t=i._getNodeRef(i.meshCache,s.mesh,e);return void 0!==s.weights&&t.traverse((function(e){if(e.isMesh)for(let t=0,i=s.weights.length;t<i;t++)e.morphTargetInfluences[t]=s.weights[t]})),t}))}loadNode(e){const t=this.json,i=this.extensions,s=this,n=t.nodes[e],r=n.name?s.createUniqueName(n.name):"";return function(){const t=[],i=s._invokeOne((function(t){return t.createNodeMesh&&t.createNodeMesh(e)}));return i&&t.push(i),void 0!==n.camera&&t.push(s.getDependency("camera",n.camera).then((function(e){return s._getNodeRef(s.cameraCache,n.camera,e)}))),s._invokeAll((function(t){return t.createNodeAttachment&&t.createNodeAttachment(e)})).forEach((function(e){t.push(e)})),Promise.all(t)}().then((function(t){let a;if(a=!0===n.isBone?new V:t.length>1?new L:1===t.length?t[0]:new m,a!==t[0])for(let e=0,i=t.length;e<i;e++)a.add(t[e]);if(n.name&&(a.userData.name=n.name,a.name=r),ci(a,n),n.extensions&&hi(i,a,n),void 0!==n.matrix){const e=new u;e.fromArray(n.matrix),a.applyMatrix4(e)}else void 0!==n.translation&&a.position.fromArray(n.translation),void 0!==n.rotation&&a.quaternion.fromArray(n.rotation),void 0!==n.scale&&a.scale.fromArray(n.scale);return s.associations.has(a)||s.associations.set(a,{}),s.associations.get(a).nodes=e,a}))}loadScene(e){const t=this.json,i=this.extensions,s=this.json.scenes[e],n=this,r=new L;s.name&&(r.name=n.createUniqueName(s.name)),ci(r,s),s.extensions&&hi(i,r,s);const a=s.nodes||[],o=[];for(let e=0,i=a.length;e<i;e++)o.push(gi(a[e],r,t,n));return Promise.all(o).then((function(){return n.associations=(e=>{const t=new Map;for(const[e,i]of n.associations)(e instanceof E||e instanceof ie)&&t.set(e,i);return e.traverse((e=>{const i=n.associations.get(e);null!=i&&t.set(e,i)})),t})(r),r}))}}function gi(e,t,i,s){const n=i.nodes[e];return s.getDependency("node",e).then((function(e){return void 0===n.skin?e:s.getDependency("skin",n.skin).then((function(t){return e.traverse((function(e){e.isSkinnedMesh&&e.bind(t,e.matrixWorld)})),e}))})).then((function(e){t.add(e);const r=[];if(n.children){const t=n.children;for(let n=0,a=t.length;n<a;n++){const a=t[n];r.push(gi(a,e,i,s))}}return Promise.all(r)}))}function mi(e,t,i){const s=t.attributes,n=[];function r(t,s){return i.getDependency("accessor",t).then((function(t){e.setAttribute(s,t)}))}for(const t in s){const i=si[t]||t.toLowerCase();i in e.attributes||n.push(r(s[t],i))}if(void 0!==t.indices&&!e.index){const s=i.getDependency("accessor",t.indices).then((function(t){e.setIndex(t)}));n.push(s)}return ci(e,t),function(e,t,i){const s=t.attributes,n=new oe;if(void 0===s.POSITION)return;{const e=i.json.accessors[s.POSITION],t=e.min,r=e.max;if(void 0===t||void 0===r)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(n.set(new p(t[0],t[1],t[2]),new p(r[0],r[1],r[2])),e.normalized){const t=pi($t[e.componentType]);n.min.multiplyScalar(t),n.max.multiplyScalar(t)}}const r=t.targets;if(void 0!==r){const e=new p,t=new p;for(let s=0,n=r.length;s<n;s++){const n=r[s];if(void 0!==n.POSITION){const s=i.json.accessors[n.POSITION],r=s.min,a=s.max;if(void 0!==r&&void 0!==a){if(t.setX(Math.max(Math.abs(r[0]),Math.abs(a[0]))),t.setY(Math.max(Math.abs(r[1]),Math.abs(a[1]))),t.setZ(Math.max(Math.abs(r[2]),Math.abs(a[2]))),s.normalized){const e=pi($t[s.componentType]);t.multiplyScalar(e)}e.max(t)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}n.expandByVector(e)}e.boundingBox=n;const a=new le;n.getCenter(a.center),a.radius=n.min.distanceTo(n.max)/2,e.boundingSphere=a}(e,t,i),Promise.all(n).then((function(){return void 0!==t.targets?function(e,t,i){let s=!1,n=!1,r=!1;for(let e=0,i=t.length;e<i;e++){const i=t[e];if(void 0!==i.POSITION&&(s=!0),void 0!==i.NORMAL&&(n=!0),void 0!==i.COLOR_0&&(r=!0),s&&n&&r)break}if(!s&&!n&&!r)return Promise.resolve(e);const a=[],o=[],l=[];for(let h=0,c=t.length;h<c;h++){const c=t[h];if(s){const t=void 0!==c.POSITION?i.getDependency("accessor",c.POSITION):e.attributes.position;a.push(t)}if(n){const t=void 0!==c.NORMAL?i.getDependency("accessor",c.NORMAL):e.attributes.normal;o.push(t)}if(r){const t=void 0!==c.COLOR_0?i.getDependency("accessor",c.COLOR_0):e.attributes.color;l.push(t)}}return Promise.all([Promise.all(a),Promise.all(o),Promise.all(l)]).then((function(t){const i=t[0],a=t[1],o=t[2];return s&&(e.morphAttributes.position=i),n&&(e.morphAttributes.normal=a),r&&(e.morphAttributes.color=o),e.morphTargetsRelative=!0,e}))}(e,t.targets,i):e}))}function _i(e,t){let i=e.getIndex();if(null===i){const t=[],s=e.getAttribute("position");if(void 0===s)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(let e=0;e<s.count;e++)t.push(e);e.setIndex(t),i=e.getIndex()}const s=i.count-2,n=[];if(t===Y)for(let e=1;e<=s;e++)n.push(i.getX(0)),n.push(i.getX(e)),n.push(i.getX(e+1));else for(let e=0;e<s;e++)e%2==0?(n.push(i.getX(e)),n.push(i.getX(e+1)),n.push(i.getX(e+2))):(n.push(i.getX(e+2)),n.push(i.getX(e+1)),n.push(i.getX(e)));n.length/3!==s&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const r=e.clone();return r.setIndex(n),r}function fi(e){const t=new Map,i=new Map,s=e.clone();return bi(e,s,(function(e,s){t.set(s,e),i.set(e,s)})),s.traverse((function(e){if(!e.isSkinnedMesh)return;const s=e,n=t.get(e),r=n.skeleton.bones;s.skeleton=n.skeleton.clone(),s.bindMatrix.copy(n.bindMatrix),s.skeleton.bones=r.map((function(e){return i.get(e)})),s.bind(s.skeleton,s.bindMatrix)})),s}function bi(e,t,i){i(e,t);for(let s=0;s<e.children.length;s++)bi(e.children[s],t.children[s],i)}let Ii=new class{constructor(){this.library={},this._blobHashMap={}}addNewAsset(e,t,i,s){gt(e).then((n=>{if(n in this._blobHashMap)return void(s&&s(this._blobHashMap[n]));let r=it();this._blobHashMap[n]=r,this.library[r]={Blob:e,Name:t,Type:i},this._loadMesh(r,e).then((()=>{s(r)}))}))}load(e,t,i,s){try{let n=[];for(let i in e){let s=e[i];if(s.Type==Ee.SHAPE){this.loadShape(i,s.Name);continue}if(s.Type==Ee.LIGHT){this.loadLight(i,s.Name);continue}let r=s.Filepath,a=t.file(r).async("blob").then((e=>this.loadLibraryAsset(i,s,e)));n.push(a)}Promise.all(n).then(i).catch((e=>{console.log(e),s&&s()}))}catch(e){console.error(e),s&&s()}}loadLibraryAsset(e,t,i){return gt(i).then((s=>{if(!(s in this._blobHashMap))return this._blobHashMap[s]=e,this.library[e]={Blob:i,Name:t.Name,Type:t.Type},this._loadMesh(e,i,!0);console.warn("Unreachable statement reached...")}))}loadAsset(e,t){let i,s=e.split("/").pop(),n=it(),r=s.split(".").pop().toLowerCase();r in Se?i=Ee.IMAGE:"glb"==r&&(i=Ee.MODEL),fetch(e).then((e=>e.blob())).then((e=>{gt(e).then((r=>{r in this._blobHashMap?t&&t(this._blobHashMap[r]):(this._blobHashMap[r]=n,this.library[n]={Blob:e,Name:s,Type:i},this._loadMesh(n,e).then((()=>{t(n)})))}))}))}loadShape(e,t){e in this.library||(this.library[e]={Name:t,Type:Ee.SHAPE})}loadLight(e,t){e in this.library||(this.library[e]={Name:t,Type:Ee.LIGHT})}_loadMesh(e,t,i){return this.library[e].Type==Ee.MODEL?this._loadGLB(e,t,i):this.library[e].Type==Ee.IMAGE?this._loadImage(e,t,i):void 0}_loadGLB(e,t,i){return new Promise(((s,n)=>{let r=URL.createObjectURL(t);(new GLTFLoader).load(r,(t=>{this.library[e].Mesh=t.scene,i||tt.publish(this._id,Me,e),s()}))}))}_loadImage(t,i,s){return new Promise(((n,r)=>{let a=URL.createObjectURL(i);(new e.TextureLoader).load(a,(i=>{let r=i.image.width,a=i.image.height;r>a?(a*=1/r,r=1):(r*=1/a,a=1);let o=new e.PlaneGeometry(r,a),l=new e.MeshBasicMaterial({map:i,side:e.DoubleSide,transparent:!0}),h=new e.Mesh(o,l);this.library[t].Mesh=h,s||tt.publish(this._id,Me,t),n()}))}))}cloneMesh(e){let t=this.library[e];return t.Type==Ee.IMAGE?t.Mesh.clone():t.Type==Ee.MODEL?fi(t.Mesh):void 0}getTexture(e){return this.library[e].Mesh.material.map}cloneTexture(e){return this.library[e].Mesh.material.map.clone()}getImage(e){return this.library[e].Mesh.material.map.image}getLibrary(){return this.library}getType(e){return e in this.library?this.library[e].Type:null}getAssetName(e){return e in this.library?this.library[e].Name:null}reset(){let e={};for(let t in this.library){let i=this.library[t].Type;i!=Ee.LIGHT&&i!=Ee.SHAPE||(e[t]=this.library[t])}this.library=e,this._blobHashMap={}}getLibraryDetails(e){let t={};for(let i of e){let e=this.library[i],s=e.Type;if(t[i]={Name:e.Name,Type:s},s==Ee.MODEL||s==Ee.IMAGE){let s="assets/"+i+"/"+e.Name;t[i].Filepath=s}}return t}};class Entity{constructor(){this._id=it(),this._object=new m}getObject(){return this._object}addToScene(e){e&&e.add(this._object)}removeFromScene(){this._object.parent&&(this._object.parent.remove(this._object),ot(this._object))}}const wi={IDLE:"IDLE",HOVERED:"HOVERED",SELECTED:"SELECTED"},Ci={LEFT:"LEFT",RIGHT:"RIGHT"},yi={EDIT:"EDIT",COPY_PASTE:"COPY_PASTE",DELETE:"DELETE",ACTIVE:"EDIT"};class Box3Helper extends F{constructor(e){super(Dt.geometry,Dt.material),this.box=e,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(e){const t=this.box;t.isEmpty()||(t.getCenter(this.position),t.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(e))}}class Interactable{constructor(e){this._threeObj=e,this._state=wi.IDLE,this.children=new Set,this._hoveredOwners=new Set,this._selectedOwners=new Set}isOnlyGroup(){console.error("Interactable.isOnlyGroup() should be overridden")}getThreeObj(){return this._threeObj}getState(){return this._state}setState(e){this._state!=e&&(this._state=e,this._threeObj.states&&e in this._threeObj.states&&this._threeObj.setState(e))}addHoveredBy(e){console.error("Interactable.addHoveredBy(owner) should be overridden")}removeHoveredBy(e){console.error("Interactable.removeHoveredBy(owner) should be overridden")}addSelectedBy(e){console.error("Interactable.addSelectedBy(owner) should be overridden")}removeSelectedBy(e){console.error("Interactable.removeSelectedBy(owner) should be overridden")}reset(){this._hoveredOwners.clear(),this._selectedOwners.clear(),this.setState(wi.IDLE),this.children.forEach((e=>{e.reset()}))}addChild(e){e.parent&&e.parent.removeChild(e),this.children.add(e),e.parent=this}addChildren(e){e.forEach((e=>{this.addChild(e)}))}removeChild(e){this.children.delete(e),e.parent=null}removeChildren(e){e.forEach((e=>{this.removeChild(e)}))}}class GripInteractable extends Interactable{constructor(e,t,i,s){super(e),this._selectedFunc=t,this._releasedFunc=i,this.specificOption=s,this._createBoundingObject()}isOnlyGroup(){return null==this._selectedFunc&&null==this._releasedFunc}_createBoundingObject(){this._boundingBox=new e.Box3,this._boundingBoxObj=new Box3Helper(this._boundingBox)}_getBoundingObject(){return this._boundingBox.setFromObject(this._threeObj),this._boundingBox}_displayBoundingObject(){Be.scene.add(this._boundingBoxObj)}_hideBoundingObject(){Be.scene.remove(this._boundingBoxObj)}intersectsSphere(e){let t,i=this._getBoundingObject();return t=!!i&&e.intersectsBox(i),t}distanceToSphere(e){return e.distanceToPoint(this._boundingBox.getCenter(St[0]))}_determineAndSetState(){this._selectedOwners.size>0?(this.setState(wi.SELECTED),this._hoveredOwners.size>=this._selectedOwners.size?this._displayBoundingObject():this._hideBoundingObject()):this._hoveredOwners.size>0?(this.setState(wi.HOVERED),this._displayBoundingObject()):(this.setState(wi.IDLE),this._hideBoundingObject())}addHoveredBy(e){this._hoveredOwners.has(e)||(this._hoveredOwners.add(e),0==this._selectedOwners.size&&this.setState(wi.HOVERED),this._displayBoundingObject())}removeHoveredBy(e){this._hoveredOwners.delete(e),this._determineAndSetState()}addSelectedBy(e){null!=this._selectedFunc&&this._selectedFunc(e),this._selectedOwners.add(e),this.setState(wi.SELECTED)}removeSelectedBy(e){null!=this._releasedFunc&&this._releasedFunc(e),this._selectedOwners.delete(e),this._determineAndSetState()}updateAction(e){this._selectedFunc=e}static emptyGroup(){return new GripInteractable}}let vi=new class{init(){this._audioListener||(this._audioListener=new e.AudioListener,this._addEventListeners(),Be.camera.add(this._audioListener))}_addEventListeners(){Be.renderer.xr.addEventListener("sessionstart",(()=>{this._audioListener.context.resume()})),Be.renderer.xr.addEventListener("sessionend",(()=>{this._audioListener.context.suspend()}))}};const Bi={Handedness:Object.freeze({NONE:"none",LEFT:"left",RIGHT:"right"}),ComponentState:Object.freeze({DEFAULT:"default",TOUCHED:"touched",PRESSED:"pressed"}),ComponentProperty:Object.freeze({BUTTON:"button",X_AXIS:"xAxis",Y_AXIS:"yAxis",STATE:"state"}),ComponentType:Object.freeze({TRIGGER:"trigger",SQUEEZE:"squeeze",TOUCHPAD:"touchpad",THUMBSTICK:"thumbstick",BUTTON:"button"}),ButtonTouchThreshold:.05,AxisTouchThreshold:.1,VisualResponseProperty:Object.freeze({TRANSFORM:"transform",VISIBILITY:"visibility"})};async function Ei(e){const t=await fetch(e);if(t.ok)return t.json();throw new Error(t.statusText)}async function Si(e,t,i=null,s=!0){if(!e)throw new Error("No xrInputSource supplied");if(!t)throw new Error("No basePath supplied");const n=await async function(e){if(!e)throw new Error("No basePath supplied");return await Ei(`${e}/profilesList.json`)}(t);let r;if(e.profiles.some((e=>{const i=n[e];return i&&(r={profileId:e,profilePath:`${t}/${i.path}`,deprecated:!!i.deprecated}),!!r})),!r){if(!i)throw new Error("No matching profile name found");const e=n[i];if(!e)throw new Error(`No matching profile name found and default profile "${i}" missing.`);r={profileId:i,profilePath:`${t}/${e.path}`,deprecated:!!e.deprecated}}const a=await Ei(r.profilePath);let o;if(s){let t;if(t="any"===e.handedness?a.layouts[Object.keys(a.layouts)[0]]:a.layouts[e.handedness],!t)throw new Error(`No matching handedness, ${e.handedness}, in profile ${r.profileId}`);t.assetPath&&(o=r.profilePath.replace("profile.json",t.assetPath))}return{profile:a,assetPath:o}}const Mi={xAxis:0,yAxis:0,button:0,state:Bi.ComponentState.DEFAULT};class VisualResponse{constructor(e){this.componentProperty=e.componentProperty,this.states=e.states,this.valueNodeName=e.valueNodeName,this.valueNodeProperty=e.valueNodeProperty,this.valueNodeProperty===Bi.VisualResponseProperty.TRANSFORM&&(this.minNodeName=e.minNodeName,this.maxNodeName=e.maxNodeName),this.value=0,this.updateFromComponent(Mi)}updateFromComponent({xAxis:e,yAxis:t,button:i,state:s}){const{normalizedXAxis:n,normalizedYAxis:r}=function(e=0,t=0){let i=e,s=t;if(Math.sqrt(e*e+t*t)>1){const n=Math.atan2(t,e);i=Math.cos(n),s=Math.sin(n)}return{normalizedXAxis:.5*i+.5,normalizedYAxis:.5*s+.5}}(e,t);switch(this.componentProperty){case Bi.ComponentProperty.X_AXIS:this.value=this.states.includes(s)?n:.5;break;case Bi.ComponentProperty.Y_AXIS:this.value=this.states.includes(s)?r:.5;break;case Bi.ComponentProperty.BUTTON:this.value=this.states.includes(s)?i:0;break;case Bi.ComponentProperty.STATE:this.valueNodeProperty===Bi.VisualResponseProperty.VISIBILITY?this.value=this.states.includes(s):this.value=this.states.includes(s)?1:0;break;default:throw new Error(`Unexpected visualResponse componentProperty ${this.componentProperty}`)}}}class Component{constructor(e,t){if(!(e&&t&&t.visualResponses&&t.gamepadIndices&&0!==Object.keys(t.gamepadIndices).length))throw new Error("Invalid arguments supplied");this.id=e,this.type=t.type,this.rootNodeName=t.rootNodeName,this.touchPointNodeName=t.touchPointNodeName,this.visualResponses={},Object.keys(t.visualResponses).forEach((e=>{const i=new VisualResponse(t.visualResponses[e]);this.visualResponses[e]=i})),this.gamepadIndices=Object.assign({},t.gamepadIndices),this.values={state:Bi.ComponentState.DEFAULT,button:void 0!==this.gamepadIndices.button?0:void 0,xAxis:void 0!==this.gamepadIndices.xAxis?0:void 0,yAxis:void 0!==this.gamepadIndices.yAxis?0:void 0}}get data(){return{id:this.id,...this.values}}updateFromGamepad(e){if(this.values.state=Bi.ComponentState.DEFAULT,void 0!==this.gamepadIndices.button&&e.buttons.length>this.gamepadIndices.button){const t=e.buttons[this.gamepadIndices.button];this.values.button=t.value,this.values.button=this.values.button<0?0:this.values.button,this.values.button=this.values.button>1?1:this.values.button,t.pressed||1===this.values.button?this.values.state=Bi.ComponentState.PRESSED:(t.touched||this.values.button>Bi.ButtonTouchThreshold)&&(this.values.state=Bi.ComponentState.TOUCHED)}void 0!==this.gamepadIndices.xAxis&&e.axes.length>this.gamepadIndices.xAxis&&(this.values.xAxis=e.axes[this.gamepadIndices.xAxis],this.values.xAxis=this.values.xAxis<-1?-1:this.values.xAxis,this.values.xAxis=this.values.xAxis>1?1:this.values.xAxis,this.values.state===Bi.ComponentState.DEFAULT&&Math.abs(this.values.xAxis)>Bi.AxisTouchThreshold&&(this.values.state=Bi.ComponentState.TOUCHED)),void 0!==this.gamepadIndices.yAxis&&e.axes.length>this.gamepadIndices.yAxis&&(this.values.yAxis=e.axes[this.gamepadIndices.yAxis],this.values.yAxis=this.values.yAxis<-1?-1:this.values.yAxis,this.values.yAxis=this.values.yAxis>1?1:this.values.yAxis,this.values.state===Bi.ComponentState.DEFAULT&&Math.abs(this.values.yAxis)>Bi.AxisTouchThreshold&&(this.values.state=Bi.ComponentState.TOUCHED)),Object.values(this.visualResponses).forEach((e=>{e.updateFromComponent(this.values)}))}}class MotionController{constructor(e,t,i){if(!e)throw new Error("No xrInputSource supplied");if(!t)throw new Error("No profile supplied");this.xrInputSource=e,this.assetUrl=i,this.id=t.profileId,this.layoutDescription=t.layouts[e.handedness],this.components={},Object.keys(this.layoutDescription.components).forEach((e=>{const t=this.layoutDescription.components[e];this.components[e]=new Component(e,t)})),this.updateFromGamepad()}get gripSpace(){return this.xrInputSource.gripSpace}get targetRaySpace(){return this.xrInputSource.targetRaySpace}get data(){const e=[];return Object.values(this.components).forEach((t=>{e.push(t.data)})),e}updateFromGamepad(){Object.values(this.components).forEach((e=>{e.updateFromGamepad(this.xrInputSource.gamepad)}))}}class XRControllerModel extends m{constructor(){super(),this.motionController=null,this.envMap=null}setEnvironmentMap(e){return this.envMap==e||(this.envMap=e,this.traverse((e=>{e.isMesh&&(e.material.envMap=this.envMap,e.material.needsUpdate=!0)}))),this}updateMatrixWorld(e){super.updateMatrixWorld(e),this.motionController&&(this.motionController.updateFromGamepad(),Object.values(this.motionController.components).forEach((e=>{Object.values(e.visualResponses).forEach((e=>{const{valueNode:t,minNode:i,maxNode:s,value:n,valueNodeProperty:r}=e;t&&(r===Bi.VisualResponseProperty.VISIBILITY?t.visible=n:r===Bi.VisualResponseProperty.TRANSFORM&&(t.quaternion.slerpQuaternions(i.quaternion,s.quaternion,n),t.position.lerpVectors(i.position,s.position,n)))}))})))}}function xi(e,t){!function(e,t){Object.values(e.components).forEach((e=>{const{type:i,touchPointNodeName:s,visualResponses:n}=e;if(i===Bi.ComponentType.TOUCHPAD)if(e.touchPointNode=t.getObjectByName(s),e.touchPointNode){const t=new ce(.001),i=new h({color:255}),s=new D(t,i);e.touchPointNode.add(s)}else console.warn(`Could not find touch dot, ${e.touchPointNodeName}, in touchpad component ${e.id}`);Object.values(n).forEach((e=>{const{valueNodeName:i,minNodeName:s,maxNodeName:n,valueNodeProperty:r}=e;if(r===Bi.VisualResponseProperty.TRANSFORM){if(e.minNode=t.getObjectByName(s),e.maxNode=t.getObjectByName(n),!e.minNode)return void console.warn(`Could not find ${s} in the model`);if(!e.maxNode)return void console.warn(`Could not find ${n} in the model`)}e.valueNode=t.getObjectByName(i),e.valueNode||console.warn(`Could not find ${i} in the model`)}))}))}(e.motionController,t),e.envMap&&t.traverse((t=>{t.isMesh&&(t.material.envMap=e.envMap,t.material.needsUpdate=!0)})),e.add(t)}const Ti=new class{constructor(e=null){this.gltfLoader=e,this.path="https://cdn.jsdelivr.net/npm/@webxr-input-profiles/assets@1.0/dist/profiles",this._assetCache={},this.gltfLoader||(this.gltfLoader=new GLTFLoader)}createControllerModel(e){const t=new XRControllerModel;let i=null;if("tracked-pointer"===e.targetRayMode&&e.gamepad)return Si(e,this.path,"generic-trigger").then((({profile:s,assetPath:n})=>{t.motionController=new MotionController(e,s,n);const r=this._assetCache[t.motionController.assetUrl];if(r)i=r.scene.clone(),xi(t,i);else{if(!this.gltfLoader)throw new Error("GLTFLoader not set.");this.gltfLoader.setPath(""),this.gltfLoader.load(t.motionController.assetUrl,(e=>{this._assetCache[t.motionController.assetUrl]=e,i=e.scene.clone(),xi(t,i)}),null,(()=>{throw new Error(`Asset ${t.motionController.assetUrl} missing or malformed.`)}))}})).catch((e=>{console.warn(e)})),t}};let Pi=new class{init(e,t,i){this._container=e,this._renderer=t,this._renderer.domElement.tabIndex="1",this._controllerParent=i,this._session,this._leftXRInputSource,this._rightXRInputSource,this._leftXRControllerModel=new m,this._rightXRControllerModel=new m,this._leftXRController={targetRay:new m,grip:new m},this._rightXRController={targetRay:new m,grip:new m},this._pointerPosition=new A,this._pointerPressed=!1,this._keysPressed=new Set,this._keyCodesPressed=new Set,this._screenTouched=!1,this._joystickAngle=0,this._joystickDistance=0,this._addEventListeners()}_addEventListeners(){"XR"==Be.deviceType?(this._renderer.xr.addEventListener("sessionstart",(e=>{this._onXRSessionStart(e)})),this._renderer.xr.addEventListener("sessionend",(e=>{this._onXRSessionEnd(e)}))):"POINTER"==Be.deviceType?(this._renderer.domElement.addEventListener("keydown",(e=>{this._keysPressed.add(e.key),this._keyCodesPressed.add(e.code)})),this._renderer.domElement.addEventListener("keyup",(e=>{this._keysPressed.delete(e.key),this._keyCodesPressed.delete(e.code)})),Be.isChrome&&document.addEventListener("pointerlockchange",(e=>{Be.sessionActive||this._keysPressed.clear(),Be.sessionActive||this._keyCodesPressed.clear()})),this._renderer.domElement.addEventListener("mousedown",(()=>{this._pointerPressed=!0})),this._renderer.domElement.addEventListener("mouseup",(()=>{this._pointerPressed=!1})),this._renderer.domElement.addEventListener("mousemove",(e=>{let t=e.target.getBoundingClientRect();this._pointerPosition.x=(e.clientX-t.left)/this._renderer.domElement.clientWidth*2-1,this._pointerPosition.y=-(e.clientY-t.top)/this._renderer.domElement.clientHeight*2+1})),this._container.addEventListener("mouseup",(()=>{this._renderer.domElement.focus()}))):"MOBILE"==Be.deviceType&&(this._renderer.domElement.addEventListener("touchstart",(()=>{this._screenTouched=!0;let e=event.target.getBoundingClientRect();this._pointerPosition.x=(event.touches[0].clientX-e.left)/this._renderer.domElement.clientWidth*2-1,this._pointerPosition.y=-(event.touches[0].clientY-e.top)/this._renderer.domElement.clientHeight*2+1})),this._renderer.domElement.addEventListener("touchend",(()=>{this._screenTouched=!1})),this._renderer.domElement.addEventListener("touchmove",(e=>{let t=e.target.getBoundingClientRect();this._pointerPosition.x=(e.touches[0].clientX-t.left)/this._renderer.domElement.clientWidth*2-1,this._pointerPosition.y=-(e.touches[0].clientY-t.top)/this._renderer.domElement.clientHeight*2+1})))}createPointerControls(){document.getElementById("mobile-menu-open-button").classList.remove("hidden")}createMobileControls(){let e=document.getElementById("mobile-joystick"),t=document.getElementById("mobile-menu-open-button"),i=document.getElementById("mobile-flying-controls");e.classList.remove("hidden"),t.classList.remove("hidden"),i.classList.remove("hidden");let s={zone:e,mode:"static",position:{left:"50%",top:"50%"}},n=nipplejs.create(s).get(0);n.on("move",((e,t)=>{this._joystickAngle=t.angle.radian,this._joystickDistance=Math.min(t.force,1)})),n.on("end",(()=>{this._joystickDistance=0}))}_onXRSessionStart(e){this._session=this._renderer.xr.getSession(),this._session.oninputsourceschange=e=>{this._onXRInputSourceChange(e)};let t=this._session.inputSources;for(let e=0;e<t.length;e++)"right"==t[e].handedness?(this._rightXRInputSource=t[e],this._controllerParent.add(this._rightXRController.targetRay),this._controllerParent.add(this._rightXRController.grip),0==this._rightXRControllerModel.children.length&&this._rightXRControllerModel.add(Ti.createControllerModel(t[e]))):"left"==t[e].handedness&&(this._leftXRInputSource=t[e],this._controllerParent.add(this._leftXRController.targetRay),this._controllerParent.add(this._leftXRController.grip),0==this._leftXRControllerModel.children.length&&this._leftXRControllerModel.add(Ti.createControllerModel(t[e])))}_onXRSessionEnd(e){this._session.oninputsourcechange=null,this._session=null,this._rightXRInputSource=null,this._leftXRInputSource=null,this._controllerParent.remove(this._rightXRController.targetRay),this._controllerParent.remove(this._rightXRController.grip),this._controllerParent.remove(this._leftXRController.targetRay),this._controllerParent.remove(this._leftXRController.grip)}_onXRInputSourceChange(e){for(let t=0;t<e.removed.length;t++)e.removed[t]==this._rightXRInputSource?(this._rightXRInputSource=null,this._controllerParent.remove(this._rightXRController.targetRay),this._controllerParent.remove(this._rightXRController.grip)):e.removed[t]==this._leftXRInputSource&&(this._leftXRInputSource=null,this._controllerParent.remove(this._leftXRController.targetRay),this._controllerParent.remove(this._leftXRController.grip));for(let t=0;t<e.added.length;t++)null==e.added[t].hand&&("right"==e.added[t].handedness?(this._rightXRInputSource=e.added[t],this._controllerParent.add(this._rightXRController.targetRay),this._controllerParent.add(this._rightXRController.grip),0==this._rightXRControllerModel.children.length&&this._rightXRControllerModel.add(Ti.createControllerModel(e.added[t]))):"left"==e.added[t].handedness&&(this._leftXRInputSource=e.added[t],this._controllerParent.add(this._leftXRController.targetRay),this._controllerParent.add(this._leftXRController.grip),0==this._leftXRControllerModel.children.length&&this._leftXRControllerModel.add(Ti.createControllerModel(e.added[t]))))}getXRGamepad(e){return e==Ci.LEFT?this._leftXRInputSource?this._leftXRInputSource.gamepad:null:e==Ci.RIGHT&&this._rightXRInputSource?this._rightXRInputSource.gamepad:null}getXRController(e,t){return e==Ci.LEFT?this._leftXRController[t]:e==Ci.RIGHT?this._rightXRController[t]:void 0}getXRControllerModel(e){return e==Ci.LEFT?this._leftXRControllerModel:e==Ci.RIGHT?this._rightXRControllerModel:void 0}getPointerPosition(){return this._pointerPosition}isPointerPressed(){return this._pointerPressed}isKeyPressed(e){return this._keysPressed.has(e)}isKeyCodePressed(e){return this._keyCodesPressed.has(e)}isScreenTouched(){return this._screenTouched}getJoystickAngle(){return this._joystickAngle}getJoystickDistance(){return this._joystickDistance}_updateXRController(e,t,i,s){if(i){let n=e.getPose(i.targetRaySpace,t);null!=n&&(s.targetRay.matrix.fromArray(n.transform.matrix),s.targetRay.matrix.decompose(s.targetRay.position,s.targetRay.rotation,s.targetRay.scale));let r=e.getPose(i.gripSpace,t);null!==r&&(s.grip.matrix.fromArray(r.transform.matrix),s.grip.matrix.decompose(s.grip.position,s.grip.rotation,s.grip.scale))}}update(e){if(null==e)return;let t=this._renderer.xr.getReferenceSpace();this._updateXRController(e,t,this._leftXRInputSource,this._leftXRController),this._updateXRController(e,t,this._rightXRInputSource,this._rightXRController)}};class VRButton{static createButton(e){const t=document.createElement("button");function i(){t.style.display="",t.style.cursor="auto",t.style.left="calc(50% - 75px)",t.style.width="150px",t.onmouseenter=null,t.onmouseleave=null,t.onclick=null}function s(e){e.style.position="absolute",e.style.bottom="20px",e.style.padding="12px 6px",e.style.border="1px solid #fff",e.style.borderRadius="4px",e.style.background="rgba(0,0,0,0.1)",e.style.color="#fff",e.style.font="normal 13px sans-serif",e.style.textAlign="center",e.style.opacity="0.5",e.style.outline="none",e.style.zIndex="999"}if("xr"in navigator)return t.id="VRButton",t.style.display="none",s(t),navigator.xr.isSessionSupported("immersive-vr").then((function(s){s?function(){let i=null;async function s(s){s.addEventListener("end",n),await e.xr.setSession(s),t.textContent="EXIT VR",i=s}function n(){i.removeEventListener("end",n),t.textContent="ENTER VR",i=null}t.style.display="",t.style.cursor="pointer",t.style.left="calc(50% - 50px)",t.style.width="100px",t.textContent="ENTER VR",t.onmouseenter=function(){t.style.opacity="1.0"},t.onmouseleave=function(){t.style.opacity="0.5"},t.onclick=function(){if(null===i){const e={optionalFeatures:["local-floor","bounded-floor","hand-tracking","layers"]};navigator.xr.requestSession("immersive-vr",e).then(s)}else i.end()}}():(i(),t.textContent="VR NOT SUPPORTED"),s&&VRButton.xrSessionIsGranted&&t.click()})).catch((function(e){i(),console.warn("Exception when trying to call xr.isSessionSupported",e),t.textContent="VR NOT ALLOWED"})),t;{const e=document.createElement("a");return!1===window.isSecureContext?(e.href=document.location.href.replace(/^http:/,"https:"),e.innerHTML="WEBXR NEEDS HTTPS"):(e.href="https://immersiveweb.dev/",e.innerHTML="WEBXR NOT AVAILABLE"),e.style.left="calc(50% - 90px)",e.style.width="180px",e.style.textDecoration="none",s(e),e}}static xrSessionIsGranted=!1;static registerSessionGrantedListener(){if("xr"in navigator){if(/WebXRViewer\//i.test(navigator.userAgent))return;navigator.xr.addEventListener("sessiongranted",(()=>{VRButton.xrSessionIsGranted=!0}))}}}VRButton.registerSessionGrantedListener();const ki={type:"change"},Di={type:"start"},Fi={type:"end"};class OrbitControls extends de{constructor(e,i){super(),void 0===i&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),i===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=e,this.domElement=i,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new p,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:Ae.ROTATE,MIDDLE:Ae.DOLLY,RIGHT:Ae.PAN},this.touches={ONE:ue.ROTATE,TWO:ue.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.rotateStartTime=0,this.rotateDelay=0,this._domElementKeyEvents=null,this.getPolarAngle=function(){return o.phi},this.getAzimuthalAngle=function(){return o.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(e){e.addEventListener("keydown",Y),this._domElementKeyEvents=e},this.saveState=function(){s.target0.copy(s.target),s.position0.copy(s.object.position),s.zoom0=s.object.zoom},this.reset=function(){s.target.copy(s.target0),s.object.position.copy(s.position0),s.object.zoom=s.zoom0,s.object.updateProjectionMatrix(),s.dispatchEvent(ki),s.update(),r=n.NONE},this.update=function(){const i=new p,A=(new t).setFromUnitVectors(e.up,new p(0,1,0)),u=A.clone().invert(),g=new p,m=new t;var _=new p;const f=2*Math.PI;return function(){const e=s.object.position;i.copy(e).sub(s.target),i.applyQuaternion(A),o.setFromVector3(i),s.autoRotate&&r===n.NONE&&E(2*Math.PI/60/60*s.autoRotateSpeed),s.enableDamping?(o.theta+=l.theta*s.dampingFactor,o.phi+=l.phi*s.dampingFactor):(o.theta+=l.theta,o.phi+=l.phi);let t=s.minAzimuthAngle,p=s.maxAzimuthAngle;return isFinite(t)&&isFinite(p)&&(t<-Math.PI?t+=f:t>Math.PI&&(t-=f),p<-Math.PI?p+=f:p>Math.PI&&(p-=f),o.theta=t<=p?Math.max(t,Math.min(p,o.theta)):o.theta>(t+p)/2?Math.max(t,o.theta):Math.min(p,o.theta)),o.phi=Math.max(s.minPolarAngle,Math.min(s.maxPolarAngle,o.phi)),o.makeSafe(),o.radius*=h,o.radius=Math.max(s.minDistance,Math.min(s.maxDistance,o.radius)),!0===s.enableDamping?s.target.addScaledVector(c,s.dampingFactor):s.target.add(c),i.setFromSpherical(o),i.applyQuaternion(u),e.copy(s.target).add(i),_.copy(s.target),s.object.parent&&s.object.parent.localToWorld(_),s.object.lookAt(_),!0===s.enableDamping?(l.theta*=1-s.dampingFactor,l.phi*=1-s.dampingFactor,c.multiplyScalar(1-s.dampingFactor)):(l.set(0,0,0),c.set(0,0,0)),h=1,!!(d||g.distanceToSquared(s.object.position)>a||8*(1-m.dot(s.object.quaternion))>a)&&(s.dispatchEvent(ki),g.copy(s.object.position),m.copy(s.object.quaternion),d=!1,!0)}}(),this.dispose=function(){s.domElement.removeEventListener("contextmenu",X),s.domElement.removeEventListener("pointerdown",H),s.domElement.removeEventListener("pointercancel",z),s.domElement.removeEventListener("wheel",V),s.domElement.removeEventListener("pointermove",G),s.domElement.removeEventListener("pointerup",j),null!==s._domElementKeyEvents&&s._domElementKeyEvents.removeEventListener("keydown",Y)};const s=this,n={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let r=n.NONE;const a=1e-6,o=new pe,l=new pe;let h=1;const c=new p;let d=!1;const u=new A,g=new A,m=new A,_=new A,f=new A,b=new A,I=new A,w=new A,C=new A,y=[],v={};function B(){return Math.pow(.95,s.zoomSpeed)}function E(e){l.theta-=e}function S(e){l.phi-=e}const M=function(){const e=new p;return function(t,i){e.setFromMatrixColumn(i,0),e.multiplyScalar(-t),c.add(e)}}(),x=function(){const e=new p;return function(t,i){!0===s.screenSpacePanning?e.setFromMatrixColumn(i,1):(e.setFromMatrixColumn(i,0),e.crossVectors(s.object.up,e)),e.multiplyScalar(t),c.add(e)}}(),T=function(){const e=new p;return function(t,i){const n=s.domElement;if(s.object.isPerspectiveCamera){const r=s.object.position;e.copy(r).sub(s.target);let a=e.length();a*=Math.tan(s.object.fov/2*Math.PI/180),M(2*t*a/n.clientHeight,s.object.matrix),x(2*i*a/n.clientHeight,s.object.matrix)}else s.object.isOrthographicCamera?(M(t*(s.object.right-s.object.left)/s.object.zoom/n.clientWidth,s.object.matrix),x(i*(s.object.top-s.object.bottom)/s.object.zoom/n.clientHeight,s.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),s.enablePan=!1)}}();function P(e){s.object.isPerspectiveCamera?h/=e:s.object.isOrthographicCamera?(s.object.zoom=Math.max(s.minZoom,Math.min(s.maxZoom,s.object.zoom*e)),s.object.updateProjectionMatrix(),d=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),s.enableZoom=!1)}function k(e){s.object.isPerspectiveCamera?h*=e:s.object.isOrthographicCamera?(s.object.zoom=Math.max(s.minZoom,Math.min(s.maxZoom,s.object.zoom/e)),s.object.updateProjectionMatrix(),d=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),s.enableZoom=!1)}function D(e){u.set(e.clientX,e.clientY),s.rotateStartTime=Date.now()}function F(e){_.set(e.clientX,e.clientY)}function Q(){if(1===y.length)u.set(y[0].pageX,y[0].pageY);else{const e=.5*(y[0].pageX+y[1].pageX),t=.5*(y[0].pageY+y[1].pageY);u.set(e,t)}}function R(){if(1===y.length)_.set(y[0].pageX,y[0].pageY);else{const e=.5*(y[0].pageX+y[1].pageX),t=.5*(y[0].pageY+y[1].pageY);_.set(e,t)}}function O(){const e=y[0].pageX-y[1].pageX,t=y[0].pageY-y[1].pageY,i=Math.sqrt(e*e+t*t);I.set(0,i)}function L(e){if(1==y.length)g.set(e.pageX,e.pageY);else{const t=Z(e),i=.5*(e.pageX+t.x),s=.5*(e.pageY+t.y);g.set(i,s)}m.subVectors(g,u).multiplyScalar(s.rotateSpeed);const t=s.domElement;E(2*Math.PI*m.x/t.clientHeight),S(2*Math.PI*m.y/t.clientHeight),u.copy(g)}function N(e){if(1===y.length)f.set(e.pageX,e.pageY);else{const t=Z(e),i=.5*(e.pageX+t.x),s=.5*(e.pageY+t.y);f.set(i,s)}b.subVectors(f,_).multiplyScalar(s.panSpeed),T(b.x,b.y),_.copy(f)}function U(e){const t=Z(e),i=e.pageX-t.x,n=e.pageY-t.y,r=Math.sqrt(i*i+n*n);w.set(0,r),C.set(0,Math.pow(w.y/I.y,s.zoomSpeed)),P(C.y),I.copy(w)}function H(e){!1!==s.enabled&&(0===y.length&&(s.domElement.setPointerCapture(e.pointerId),s.domElement.addEventListener("pointermove",G),s.domElement.addEventListener("pointerup",j)),function(e){y.push(e)}(e),"touch"===e.pointerType?function(e){switch(K(e),y.length){case 1:switch(s.touches.ONE){case ue.ROTATE:if(!1===s.enableRotate)return;Q(),r=n.TOUCH_ROTATE;break;case ue.PAN:if(!1===s.enablePan)return;R(),r=n.TOUCH_PAN;break;default:r=n.NONE}break;case 2:switch(s.touches.TWO){case ue.DOLLY_PAN:if(!1===s.enableZoom&&!1===s.enablePan)return;s.enableZoom&&O(),s.enablePan&&R(),r=n.TOUCH_DOLLY_PAN;break;case ue.DOLLY_ROTATE:if(!1===s.enableZoom&&!1===s.enableRotate)return;s.enableZoom&&O(),s.enableRotate&&Q(),r=n.TOUCH_DOLLY_ROTATE;break;default:r=n.NONE}break;default:r=n.NONE}r!==n.NONE&&s.dispatchEvent(Di)}(e):function(e){let t;switch(e.button){case 0:t=s.mouseButtons.LEFT;break;case 1:t=s.mouseButtons.MIDDLE;break;case 2:t=s.mouseButtons.RIGHT;break;default:t=-1}switch(t){case Ae.DOLLY:if(!1===s.enableZoom)return;!function(e){I.set(e.clientX,e.clientY)}(e),r=n.DOLLY;break;case Ae.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===s.enablePan)return;F(e),r=n.PAN}else{if(!1===s.enableRotate)return;D(e),r=n.ROTATE}break;case Ae.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===s.enableRotate)return;D(e),r=n.ROTATE}else{if(!1===s.enablePan)return;F(e),r=n.PAN}break;default:r=n.NONE}r!==n.NONE&&s.dispatchEvent(Di)}(e))}function G(e){!1!==s.enabled&&("touch"===e.pointerType?function(e){switch(K(e),r){case n.TOUCH_ROTATE:if(!1===s.enableRotate)return;L(e),s.update();break;case n.TOUCH_PAN:if(!1===s.enablePan)return;N(e),s.update();break;case n.TOUCH_DOLLY_PAN:if(!1===s.enableZoom&&!1===s.enablePan)return;!function(e){s.enableZoom&&U(e),s.enablePan&&N(e)}(e),s.update();break;case n.TOUCH_DOLLY_ROTATE:if(!1===s.enableZoom&&!1===s.enableRotate)return;!function(e){s.enableZoom&&U(e),s.enableRotate&&L(e)}(e),s.update();break;default:r=n.NONE}}(e):function(e){if(!1===s.enabled)return;switch(r){case n.ROTATE:if(!1===s.enableRotate)return;!function(e){if(s.rotateDelay&&Date.now()-s.rotateStartTime<s.rotateDelay)return;g.set(e.clientX,e.clientY),m.subVectors(g,u).multiplyScalar(s.rotateSpeed);const t=s.domElement;E(2*Math.PI*m.x/t.clientHeight),S(2*Math.PI*m.y/t.clientHeight),u.copy(g),s.update()}(e);break;case n.DOLLY:if(!1===s.enableZoom)return;!function(e){w.set(e.clientX,e.clientY),C.subVectors(w,I),C.y>0?P(B()):C.y<0&&k(B()),I.copy(w),s.update()}(e);break;case n.PAN:if(!1===s.enablePan)return;!function(e){f.set(e.clientX,e.clientY),b.subVectors(f,_).multiplyScalar(s.panSpeed),T(b.x,b.y),_.copy(f),s.update()}(e)}}(e))}function j(e){W(e),0===y.length&&(s.domElement.releasePointerCapture(e.pointerId),s.domElement.removeEventListener("pointermove",G),s.domElement.removeEventListener("pointerup",j)),s.dispatchEvent(Fi),r=n.NONE}function z(e){W(e)}function V(e){!1!==s.enabled&&!1!==s.enableZoom&&r===n.NONE&&(e.preventDefault(),s.dispatchEvent(Di),function(e){e.deltaY<0?k(B()):e.deltaY>0&&P(B()),s.update()}(e),s.dispatchEvent(Fi))}function Y(e){!1!==s.enabled&&!1!==s.enablePan&&function(e){let t=!1;switch(e.code){case s.keys.UP:T(0,s.keyPanSpeed),t=!0;break;case s.keys.BOTTOM:T(0,-s.keyPanSpeed),t=!0;break;case s.keys.LEFT:T(s.keyPanSpeed,0),t=!0;break;case s.keys.RIGHT:T(-s.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),s.update())}(e)}function X(e){!1!==s.enabled&&e.preventDefault()}function W(e){delete v[e.pointerId];for(let t=0;t<y.length;t++)if(y[t].pointerId==e.pointerId)return void y.splice(t,1)}function K(e){let t=v[e.pointerId];void 0===t&&(t=new A,v[e.pointerId]=t),t.set(e.pageX,e.pageY)}function Z(e){const t=e.pointerId===y[0].pointerId?y[1]:y[0];return v[t.pointerId]}s.domElement.addEventListener("contextmenu",X),s.domElement.addEventListener("pointerdown",H),s.domElement.addEventListener("pointercancel",z),s.domElement.addEventListener("wheel",V,{passive:!1}),this.update()}}const Qi="DigitalBacon:MobileOverride";let Ri=new class{init(e,t){this._container=e,null==t&&(t={}),this._orbitControlsTarget=t["Orbit Controls Target"]?t["Orbit Controls Target"]:new p(0,0,0),Be.sessionActive=!1,"XR"==Be.deviceType?this._configureForXR():"POINTER"==Be.deviceType?this._configureForPointer():"MOBILE"==Be.deviceType&&this._configureForMobile()}_configureForXR(){this._div=document.createElement("div"),this._button=VRButton.createButton(Be.renderer),this._button.removeAttribute("style"),this._stylizeElements(),this._button.style.minWidth="150px",this._div.appendChild(this._button),this._div.appendChild(this._createMobileOverrideLink()),Be.renderer.xr.addEventListener("sessionstart",(()=>{Be.sessionActive=!0,vi.init(),Be.renderer.xr.setFoveation(0)})),Be.renderer.xr.addEventListener("sessionend",(()=>{Be.sessionActive=!1}))}_configureForPointer(){this._div=document.createElement("div"),this._button=document.createElement("button"),this._button.innerText="CLICK TO START",this._stylizeElements(),this._div.appendChild(this._button),this._controls=new OrbitControls(Be.camera,Be.renderer.domElement),this._controls.target=this._orbitControlsTarget,this._controls.enableKeys=!1,this._controls.maxPolarAngle=Math.PI-.3,this._controls.minPolarAngle=.3,this._controls.minDistance=.05,this._controls.enablePan=!1,this._controls.enabled=!1,this._controls.rotateDelay=20,this._controlsUpdateNumber=0,this._controls.addEventListener("change",(()=>{this._controlsUpdateNumber++})),this._button.addEventListener("click",(()=>{this._div.style.display="none",this._controls.enabled=!0,Be.sessionActive=!0,vi.init(),Pi.createPointerControls()}))}_configureForMobile(){this._div=document.createElement("div"),this._button=document.createElement("button"),this._button.innerText="TAP TO START",this._stylizeElements(),this._div.appendChild(this._button),localStorage.getItem(Qi)&&this._div.appendChild(this._createVROverrideLink()),this._controls=new OrbitControls(Be.camera,Be.renderer.domElement),this._controls.target=this._orbitControlsTarget,this._controls.maxPolarAngle=Math.PI-.3,this._controls.minPolarAngle=.3,this._controls.minDistance=.05,this._controls.enablePan=!1,this._controls.enabled=!1,this._controls.rotateDelay=20,this._controlsUpdateNumber=0,this._controls.addEventListener("change",(()=>{this._controlsUpdateNumber++})),this._button.addEventListener("click",(()=>{this._div.style.display="none",this._controls.enabled=!0,Be.sessionActive=!0,vi.init(),Pi.createMobileControls()}))}_stylizeElements(){this._div.style.position="absolute",this._div.style.top="75%",this._div.style.transform="translateY(-50%)",this._div.style.width="100%",this._div.style.textAlign="center",this._div.style.backgroundColor="rgba(0,0,0,0.5)",this._div.style.padding="10px 0",this._button.style.padding="12px",this._button.style.border="2px solid #ffc7e5",this._button.style.borderRadius="4px",this._button.style.background="none",this._button.style.color="#ffc7e5",this._button.style.font="normal 18px sans-serif",this._button.style.outline="none",this._button.style.transition="background-color .15s ease-in-out",this._button.onmouseenter=()=>{this._button.style.cursor="pointer",this._button.style.background="rgba(0, 0, 0, 0.5)"},this._button.onmouseleave=()=>{this._button.style.cursor="inherit",this._button.style.background="none"}}_createMobileOverrideLink(){let e=document.createElement("a");return e.innerText="Use Touchscreen Controls",e.href="#",e.style.display="block",e.style.paddingTop="12px",e.style.color="rgb(255, 199, 229)",e.addEventListener("click",(()=>{event.preventDefault(),localStorage.setItem(Qi,!0),window.location.reload()})),e}_createVROverrideLink(){let e=document.createElement("a");return e.innerText="Use VR Controls",e.href="#",e.style.display="block",e.style.paddingTop="12px",e.style.color="rgb(255, 199, 229)",e.addEventListener("click",(()=>{event.preventDefault(),localStorage.removeItem(Qi),window.location.reload()})),e}displayButton(){this._container.appendChild(this._div)}exitXRSession(){this._button.click()}enableOrbit(){this._controls.enableRotate=!0}disableOrbit(){this._controls.enableRotate=!1}getControlsUpdateNumber(){return this._controlsUpdateNumber}getCameraDistance(){if(this._controls)return this._controls.getDistance()}};class PointerInteractable extends Interactable{constructor(e,t,i,s,n,r){super(e),this._actionFunc=t,this._canDisableOrbit="XR"!=Be.deviceType&&0!=i,this.canDisplayPointer="XR"==Be.deviceType&&0!=s,this.specificOption=n,this._draggableActionFunc=r}isOnlyGroup(){return null==this._actionFunc&&!this.canDisplayPointer&&!this._canDisableOrbit}isDraggable(){return null!=this._draggableActionFunc}_determineAndSetState(){this._selectedOwners.size>0?this.setState(wi.SELECTED):this._hoveredOwners.size>0?this.setState(wi.HOVERED):this.setState(wi.IDLE)}addHoveredBy(e,t){this._hoveredOwners.has(e)||(this._selectedOwners.has(e)&&this.triggerAction(t),this._hoveredOwners.add(e),0==this._selectedOwners.size&&this.setState(wi.HOVERED))}removeHoveredBy(e){this._hoveredOwners.delete(e),this._determineAndSetState()}addSelectedBy(e,t){this._selectedOwners.add(e),this.setState(wi.SELECTED),this._canDisableOrbit&&Ri.disableOrbit(),this._draggableActionFunc&&this._draggableActionFunc(t)}removeSelectedBy(e){this._selectedOwners.delete(e),this._determineAndSetState(),this._canDisableOrbit&&Ri.enableOrbit()}triggerAction(e){null!=this._actionFunc&&this._actionFunc(e)}triggerDraggableAction(e){null!=this._draggableActionFunc&&this._draggableActionFunc(e)}updateAction(e){this._actionFunc=e}static emptyGroup(){return new PointerInteractable(null,null,!1,!1)}static createDraggable(e,t,i){return new PointerInteractable(e,t,!0,!0,null,i)}}class Avatar{constructor(t){null==t&&(t={});let i=t["Vertical Offset"]||0,s=t["Focus Camera"]||!1,n=t["Camera Focal Point"]||[0,1.7,0];this._defaultURL="https://d1a370nemizbjq.cloudfront.net/6a141c79-d6e5-4b0d-aa0d-524a8b9b54a4.glb",this._pivotPoint=new e.Object3D,this._pivotPoint.position.setY(i),this._createBoundingBox(t),this._createMesh(t.URL?t.URL:this._defaultURL),s&&Be.cameraFocus.position.fromArray(n)}_createBoundingBox(t){let i=t["Bounding Box Size"]?t["Bounding Box Min"]:[.2,.8,.2],s=t["Bounding Box Center"]?t["Bounding Box Max"]:[0,.4,0],n=t["Bounding Box Quaternion"]?t["Bounding Box Quaternion"]:[0,0,0,0],r=new e.BoxGeometry(i[0],i[1],i[2]),a=new e.MeshBasicMaterial({wireframe:!0});this._boundingBox=new e.Mesh(r,a),this._boundingBox.position.fromArray(s),this._boundingBox.quaternion.fromArray(n)}_createMesh(t){if(/\.glb$/.test(t)){(new GLTFLoader).load(t,(e=>{if(e.scene.rotateY(Math.PI),e.scene.children[0].name.includes("AvatarRoot")){let t=new Set;e.scene.traverse((e=>{e.name.toLowerCase().includes("hand")&&t.add(e)})),t.forEach((e=>{e.parent.remove(e)})),e.scene.position.setY(-.7)}this._pivotPoint.add(e.scene),this._saveOriginalTransparencyStates(),this._dimensions=3}),(()=>{}),(e=>{console.log(e),t!=this._defaultURL?this._createMesh(this._defaultURL):console.error("Can't display default avatar :(")}))}else/\.png$|\.jpg$|\.jpeg$/.test(t)?(new e.TextureLoader).load(t,(t=>{let i=t.image.width,s=t.image.height;if(i>s){let e=.3/i;i=.3,s*=e}else{let e=.3/s;s=.3,i*=e}let n=new e.MeshBasicMaterial({map:t,side:e.DoubleSide,transparent:!0}),r=new e.PlaneGeometry(i,s);r.rotateY(Math.PI);let a=new e.Mesh(r,n);this._pivotPoint.add(a),this._saveOriginalTransparencyStates(),this._dimensions=2}),(()=>{}),(()=>{t!=this._defaultURL?this._createMesh(this._defaultURL):console.error("Can't display default avatar :(")})):t!=this._defaultURL?this._createMesh(this._defaultURL):console.error("Default avatar URL is invalid :(")}_saveOriginalTransparencyStates(){this._pivotPoint.traverse((function(t){if(t instanceof e.Mesh&&t.material)if(Array.isArray(t.material))for(let e=0;e<t.material.length;e++){let i=t.material[e];i.userData.transparent=i.transparent,i.userData.opacity=i.opacity}else{let e=t.material;e.userData.transparent=e.transparent,e.userData.opacity=e.opacity}}))}fade(t){this._isFading=!0,this._pivotPoint.traverse((function(i){if(i instanceof e.Mesh&&i.material)if(Array.isArray(i.material))for(let e=0;e<i.material.length;e++){let s=i.material[e];s.transparent||(s.transparent=!0),s.opacity=s.userData.opacity*t}else{let e=i.material;e.transparent||(e.transparent=!0),e.opacity=e.userData.opacity*t}}))}endFade(){this._isFading&&(this._isFading=!1,this._pivotPoint.traverse((function(t){if(t instanceof e.Mesh&&t.material)if(Array.isArray(t.material))for(let e=0;e<t.material.length;e++){let i=t.material[e];i.transparent=i.userData.transparent,i.opacity=i.userData.opacity}else{let e=t.material;e.transparent=e.userData.transparent,e.opacity=e.userData.opacity}})))}lookAtLocal(e){this._pivotPoint.parent&&(St[0].copy(e),this._pivotPoint.parent.localToWorld(St[0]),this._pivotPoint.lookAt(St[0]))}updateSourceUrl(e){for(;this._pivotPoint.children[0];){let e=this._pivotPoint.children[0];this._pivotPoint.remove(e),ot(e,!0)}this._createMesh(e)}getObject(){return this._pivotPoint}addToScene(e){e.add(this._pivotPoint)}removeFromScene(){this._pivotPoint.parent&&this._pivotPoint.parent.remove(this._pivotPoint)}}const Oi={FRONT:"FRONT",BACK:"BACK",LEFT:"LEFT",RIGHT:"RIGHT",TOP:"TOP",BOTTOM:"BOTTOM"},Li=1024,Ni={};for(let e in Oi){let t=document.createElement("canvas");t.width=Li,t.height=Li,Ni[e]={canvas:t,context:t.getContext("2d")}}let Ui=new class{init(e){this._scene=e,this._scene.background=new ge([Ni[Oi.RIGHT].canvas,Ni[Oi.LEFT].canvas,Ni[Oi.TOP].canvas,Ni[Oi.BOTTOM].canvas,Ni[Oi.FRONT].canvas,Ni[Oi.BACK].canvas])}setSides(e){for(let t in e)this.setSide(t,e[t])}setSide(e,t){let i=t?Ii.getImage(t):null;this._drawImage(e,i),this._scene.background.needsUpdate=!0}deleteSide(e){this._drawImage(e),this._scene.background.needsUpdate=!0}_drawImage(e,t){let i=Ni[e].canvas,s=Ni[e].context;if(s.clearRect(0,0,i.width,i.height),!t)return;let n=Li/Math.max(t.width,t.height),r=(i.width-t.width*n)/2,a=(i.height-t.height*n)/2;s.drawImage(t,0,0,t.width,t.height,r,a,t.width*n,t.height*n)}};let Hi=new class{constructor(){this.settings={Skybox:{},"User Settings":{"Movement Speed":3,"Enable Flying":!0}},this.editorSettings={"Movement Speed":3,"Enable Flying":!0,"Swap Joysticks":!1},this.settings.Skybox[Oi.FRONT]=null,this.settings.Skybox[Oi.BACK]=null,this.settings.Skybox[Oi.LEFT]=null,this.settings.Skybox[Oi.RIGHT]=null,this.settings.Skybox[Oi.TOP]=null,this.settings.Skybox[Oi.BOTTOM]=null}init(e){this._scene=e,Ui.init(e)}load(e){if(e)this.settings=e,this.settings["User Settings"]||(this.settings["User Settings"]={"Movement Speed":3,"Enable Flying":!0});else{for(let e in this.settings.Skybox)this.settings.Skybox[e]=null;this.settings["User Settings"]["Movement Speed"]=3,this.settings["User Settings"]["Enable Flying"]=!0}Ui.setSides(this.settings.Skybox)}reset(){this.load()}getSkyboxTextures(){let e={},t=this.settings.Skybox;for(let i in t)t[i]?e[i]=Ii.getTexture(t[i]):e[i]=It.searchIcon;return e}setSkyboxSide(e,t,i){this.settings.Skybox[e]=t,Ui.setSide(e,t),i||tt.publish(this._id,qe,{settings:this.settings,keys:["Skybox",e]})}getEditorSettings(){return this.editorSettings}setEditorSetting(e,t){e in this.editorSettings&&(this.editorSettings[e]=t)}getUserSettings(){return this.settings["User Settings"]}setUserSetting(e,t,i){e in this.settings["User Settings"]&&(this.settings["User Settings"][e]=t,i||tt.publish(this._id,qe,{settings:this.settings,keys:["User Settings",e]}))}getMovementSpeed(){return Be.isEditor?this.editorSettings["Movement Speed"]:this.settings["User Settings"]["Movement Speed"]}isFlyingEnabled(){return Be.isEditor?this.editorSettings["Enable Flying"]:this.settings["User Settings"]["Enable Flying"]}areJoysticksSwapped(){return!!Be.isEditor&&this.editorSettings["Swap Joysticks"]}getSettings(){return this.settings}};class BasicMovement{constructor(t){null==t&&(t={}),this._avatar=t.Avatar,this._userObj=t["User Object"],this._velocity=new e.Vector3,this._verticalVelocity=0,this._worldVelocity=new e.Vector3,this._snapRotationTriggered=!1}_setupMobileFlyingButtons(){this._mobileUp=!1,this._mobileDown=!1;let e=document.getElementById("mobile-flying-up-button"),t=document.getElementById("mobile-flying-down-button");e.addEventListener("touchstart",(()=>{this._mobileUp=!0})),e.addEventListener("touchend",(()=>{this._mobileUp=!1})),t.addEventListener("touchstart",(()=>{this._mobileDown=!0})),t.addEventListener("touchend",(()=>{this._mobileDown=!1}))}_moveForward(e,t){St[0].setFromMatrixColumn(Be.camera.matrixWorld,0),St[0].crossVectors(this._userObj.up,St[0]),St[0].multiplyScalar(e),this._worldVelocity.add(St[0]),St[0].multiplyScalar(t),this._userObj.position.add(St[0])}_moveRight(e,t){St[0].setFromMatrixColumn(Be.camera.matrixWorld,0),St[0].y=0,St[0].multiplyScalar(e),this._worldVelocity.add(St[0]),St[0].multiplyScalar(t),this._userObj.position.add(St[0])}_moveUp(e,t){this._worldVelocity.setY(e),St[0].fromArray([0,e*t,0]),this._userObj.position.add(St[0])}_snapLeft(){this._userObj.rotateY(Math.PI/8)}_snapRight(){this._userObj.rotateY(-Math.PI/8)}getWorldVelocity(){return this._worldVelocity}update(e){"XR"==Be.deviceType?(this._updatePositionVR(e),this.update=this._updatePositionVR):"POINTER"==Be.deviceType?(this._updatePosition(e),this.update=this._updatePosition):"MOBILE"==Be.deviceType&&(this._setupMobileFlyingButtons(),this._updatePositionMobile(e),this.update=this._updatePositionMobile)}_updatePosition(e){if(this._worldVelocity.set(0,0,0),e>1)return;let t=Hi.getMovementSpeed(),i=Hi.isFlyingEnabled(),s=.88*(1-e);this._velocity.x*=s,i&&(this._verticalVelocity*=s),this._velocity.z*=s,Be.sessionActive&&!Be.keyboardLock&&((Pi.isKeyCodePressed("ArrowUp")||Pi.isKeyCodePressed("KeyW"))&&(this._velocity.z+=t/4),(Pi.isKeyCodePressed("ArrowDown")||Pi.isKeyCodePressed("KeyS"))&&(this._velocity.z-=t/4),(Pi.isKeyCodePressed("ArrowLeft")||Pi.isKeyCodePressed("KeyA"))&&(this._velocity.x-=t/4),(Pi.isKeyCodePressed("ArrowRight")||Pi.isKeyCodePressed("KeyD"))&&(this._velocity.x+=t/4),i&&Pi.isKeyCodePressed("Space")!=Pi.isKeyCodePressed("ShiftLeft")&&(this._verticalVelocity=Pi.isKeyCodePressed("Space")?t:-t)),this._velocity.length()>t&&this._velocity.normalize().multiplyScalar(t),this._avatar?(this._moveRight(this._velocity.x,e),St[1].copy(St[0]),this._moveForward(this._velocity.z,e),St[1].add(St[0]),St[1].length()>.001&&(St[1].multiplyScalar(-2),this._avatar.lookAtLocal(St[1])),i&&this._moveUp(this._verticalVelocity,e)):(this._moveRight(this._velocity.x,e),this._moveForward(this._velocity.z,e)),this._userObj.updateMatrixWorld(!0)}_updatePositionMobile(e){if(this._worldVelocity.set(0,0,0),e>1)return;let t=Hi.getMovementSpeed(),i=Hi.isFlyingEnabled();if(this._velocity.x=0,i&&(this._verticalVelocity*=.88*(1-e)),this._velocity.z=0,Be.sessionActive&&!Be.keyboardLock){let e=Pi.getJoystickAngle(),s=t*Pi.getJoystickDistance();this._velocity.x=s*Math.cos(e),this._velocity.z=s*Math.sin(e),i&&this._mobileUp!=this._mobileDown&&(this._verticalVelocity=this._mobileUp?t:-t)}this._velocity.length()>t&&this._velocity.normalize().multiplyScalar(t),this._avatar?(this._moveRight(this._velocity.x,e),St[1].copy(St[0]),this._moveForward(this._velocity.z,e),St[1].add(St[0]),St[1].length()>.001&&(St[1].multiplyScalar(-2),this._avatar.lookAtLocal(St[1])),i&&this._moveUp(this._verticalVelocity,e)):(this._moveRight(this._velocity.x,e),this._moveForward(this._velocity.z,e)),this._userObj.updateMatrixWorld(!0)}_updatePositionVR(e){if(this._worldVelocity.set(0,0,0),e>1)return;let t,i,s=Hi.getMovementSpeed(),n=Hi.isFlyingEnabled();if(Hi.areJoysticksSwapped()?(t=Pi.getXRGamepad(Ci.RIGHT),i=Pi.getXRGamepad(Ci.LEFT)):(t=Pi.getXRGamepad(Ci.LEFT),i=Pi.getXRGamepad(Ci.RIGHT)),this._velocity.x=0,this._velocity.y=0,this._velocity.z=0,t){let i=t.axes;this._velocity.z=-1*s*i[3],this._velocity.x=s*i[2],this._moveRight(this._velocity.x,e),this._moveForward(this._velocity.z,e)}if(i){let t=i.axes[3],r=i.axes[2];Math.abs(r)>.5?this._snapRotationTriggered||(this._snapRotationTriggered=!0,r>0?this._snapRight():this._snapLeft()):this._snapRotationTriggered=!1,n&&Math.abs(t)>.2&&(this._velocity.y=-1*s*t,this._moveUp(this._velocity.y,e))}else this._snapRotationTriggered=!1;this._userObj.updateMatrixWorld(!0)}}class InteractableHandler{constructor(){this._id=it(),this._interactables=new Set,this._hoveredInteractables={},this._selectedInteractables={},this._toolInteractables={},this._toolInteractables[yi.EDIT]=new Set,this._toolInteractables[yi.COPY_PASTE]=new Set,this._toolInteractables[yi.DELETE]=new Set,this._handTool=yi.EDIT,this._addInteractable=this.addInteractable,this._addInteractables=this.addInteractables,this._removeInteractable=this.removeInteractable,this._removeInteractables=this.removeInteractables,this.addInteractable=()=>{},this.addInteractables=()=>{},this.removeInteractable=()=>{},this.removeInteractables=()=>{}}init(){"XR"==Be.deviceType?(this.update=this._updateForXREdit,this._setupXRSubscription()):"POINTER"==Be.deviceType?this.update=this._updateForPointer:"MOBILE"==Be.deviceType&&(this.update=this._updateForMobile),this.addInteractable=this._addInteractable,this.addInteractables=this._addInteractables,this.removeInteractable=this._removeInteractable,this.removeInteractables=this._removeInteractables}addInteractable(e,t){t?this._toolInteractables[t].add(e):this._interactables.add(e)}addInteractables(e,t){t?e.forEach((e=>{this._toolInteractables[t].add(e)})):e.forEach((e=>{this._interactables.add(e)}))}removeInteractable(e,t){t?(this._toolInteractables[t].delete(e),e.reset()):(this._interactables.delete(e),e.reset())}removeInteractables(e,t){t?e.forEach((e=>{this._toolInteractables[t].delete(e),e.reset()})):e.forEach((e=>{this._interactables.delete(e),e.reset()}))}reset(){this._interactables.forEach((e=>{e.reset()})),this._interactables=new Set,this._hoveredInteractables={},this._selectedInteractables={}}}const Gi={jpg:"jpg",jpeg:"jpeg",png:"png",glb:"glb"},ji={glb:"glb"};let zi=new class{constructor(){this._input=document.createElement("input"),this._input.type="file",this._locks=new Set,this._assetIds=[],this._fileListenerActive=!1,this._triggerUpload=!1,this._addEventListeners()}_addEventListeners(){this._input.addEventListener("change",(()=>{this._upload()})),"XR"!=Be.deviceType&&(this._input.addEventListener("click",(e=>{e.stopPropagation()})),this._eventType="MOBILE"==Be.deviceType?"touchend":"click",this._clickListener=e=>{setTimeout((()=>{this._triggerUpload&&(this._triggerUpload=!1,this._input.click())}),20)})}_uploadProjectFile(){this._input.files.length>0&&this._callback&&this._callback(this._input.files[0])}_uploadAssets(){this.uploadFiles(this._input.files,this._callback)}uploadFiles(e,t){let i=it();this._locks.add(i);for(let i of e){let e=i.name.split(".").pop().toLowerCase();if(e in Gi){let s=it();e in Se?(this._locks.add(s),Ii.addNewAsset(i,i.name,Ee.IMAGE,(e=>{this._libraryCallback(e,s,t)}))):e in ji?(this._locks.add(s),Ii.addNewAsset(i,i.name,Ee.MODEL,(e=>{this._libraryCallback(e,s,t)}))):console.log("TODO: Support other file types")}else console.log("TODO: Tell user invalid filetype, and list valid ones")}this._input.value="",this._locks.delete(i),0==this._locks.size&&(t&&t(this._assetIds),this._assetIds=[])}_libraryCallback(e,t,i){this._assetIds.push(e),this._locks.delete(t),0==this._locks.size&&(i&&i(this._assetIds),this._assetIds=[])}listenForAssets(e,t,i){if(this._fileListenerActive)throw new Error("File listener already in use");this._callback=e,this._fileListenerActive=!0,this._input.multiple=t,this._upload=this._uploadAssets,this._input.accept=i==Ee.IMAGE?"image/*":i==Ee.MODEL?".glb":"",document.addEventListener(this._eventType,this._clickListener)}listenForProjectFile(e){if(this._fileListenerActive)throw new Error("File listener already in use");this._callback=e,this._fileListenerActive=!0,this._input.multiple=!1,this._input.accept=".zip",this._upload=this._uploadProjectFile,document.addEventListener(this._eventType,this._clickListener)}triggerUpload(){"XR"==Be.deviceType?(Ri.exitXRSession(),this._input.click()):this._triggerUpload=!0}stopListening(){this._callback=null,this._fileListenerActive=!1,document.removeEventListener(this._eventType,this._clickListener)}};const Vi=.008,Yi=.01;class ThreeMeshUIHelper{static createTextBlock(e){let t=e.text?e.text:"",i=e.fontSize?e.fontSize:Et,s=e.fontColor?e.fontColor:Ct.white,n=e.backgroundColor?e.backgroundColor:null,r=e.backgroundOpacity?e.backgroundOpacity:0,a=e.justifyContent||"center",o=e.textAlign||"center",l=e.height?e.height:.05,h=e.width?e.width:.7,c=st(e.margin,Yi),d=new ve.Block({height:l,width:h,margin:c,offset:0,justifyContent:a,textAlign:o,backgroundColor:n,backgroundOpacity:r,interLine:0}),A=new ve.Text({content:t,fontColor:s,fontSize:i,offset:0});return e.fontFamily&&e.fontTexture&&A.set({fontFamily:e.fontFamily,fontTexture:e.fontTexture}),d.add(A),d}static createButtonBlock(e){let t=e.text,i=e.backgroundTexture,s=e.backgroundTextureScale?e.backgroundTextureScale:1,n=e.borderRadius?e.borderRadius:.01,r=e.fontSize?e.fontSize:Et,a=e.fontColor?e.fontColor:Ct.white,o=e.idleBackgroundColor||Ct.defaultIdle,l=e.hoveredBackgroundColor||Ct.defaultHovered,h=e.selectedBackgroundColor||Ct.defaultHovered,c=st(e.idleOpacity,.7),d=st(e.hoveredOpacity,.8),A=st(e.selectedOpacity,.8),u=e.height?e.height:.15,p=e.width?e.width:.7,g=st(e.margin,Yi),m=new ve.Block({height:u,width:p,justifyContent:"center",alignItems:"center",margin:g,borderWidth:0,borderRadius:n,interLine:0});if(i){let e=new ve.Block({height:u*s,width:p*s,backgroundTexture:i,offset:1e-4,borderRadius:0});m.add(e)}if(t){let i=new ve.Text({content:t,fontColor:a,fontSize:r,offset:0});e.fontFamily&&e.fontTexture&&i.set({fontFamily:e.fontFamily,fontTexture:e.fontTexture}),m.add(i)}return m.setupState({state:wi.IDLE,attributes:{offset:Vi,backgroundOpacity:c,backgroundColor:o}}),m.setupState({state:wi.HOVERED,attributes:{offset:Vi,backgroundOpacity:d,backgroundColor:l}}),m.setupState({state:wi.SELECTED,attributes:{offset:.004,backgroundOpacity:A,backgroundColor:h}}),m.setState(wi.IDLE),m}static createInputBlock(e){let t=e.text||" ";e.backgroundTexture;let i=e.fontSize?e.fontSize:Et,s=e.fontColor?e.fontColor:Ct.white,n=e.idleBackgroundColor||Ct.defaultIdle,r=e.hoveredBackgroundColor||Ct.defaultHovered,a=e.selectedBackgroundColor||Ct.defaultHovered,o=st(e.idleOpacity,.7),l=st(e.hoveredOpacity,.8),h=st(e.selectedOpacity,.8),c=e.height?e.height:.15,d=e.width?e.width:.7,A=st(e.margin,Yi),u=new ve.Block({height:c,width:d,justifyContent:"center",alignItems:"center",margin:A,borderWidth:.001,interLine:0}),p=new ve.Text({content:t,fontColor:s,fontSize:i,offset:0});return u.add(p),u.setupState({state:wi.IDLE,attributes:{offset:Vi,backgroundOpacity:o,backgroundColor:n}}),u.setupState({state:wi.HOVERED,attributes:{offset:Vi,backgroundOpacity:l,backgroundColor:r}}),u.setupState({state:wi.SELECTED,attributes:{offset:.004,backgroundOpacity:h,backgroundColor:a}}),u.setState(wi.IDLE),u}static createCheckboxBlock(e){let t=e.selectedColor?e.selectedColor:Ct.black,i=e.height?e.height:.15,s=e.width?e.width:.7,n=e.initialValue||0,r=st(e.margin,Yi),a=new ve.Block({height:i,width:s,justifyContent:"center",alignItems:"center",margin:r,offset:.004,borderWidth:0,backgroundColor:Ct.white}),o=new ve.Block({height:.9*i,width:.9*s,backgroundColor:t,backgroundOpacity:.8*n,backgroundTexture:It.checkmarkIcon,offset:.001});return a.add(o),a.setupState({state:wi.IDLE,attributes:{offset:Vi,backgroundOpacity:.7}}),a.setupState({state:wi.HOVERED,attributes:{offset:Vi,backgroundOpacity:.8}}),a.setupState({state:wi.SELECTED,attributes:{offset:.004,backgroundOpacity:.8}}),a.setState(wi.IDLE),a.toggle=()=>.8==o.backgroundOpacity?(o.set({backgroundOpacity:0}),0):(o.set({backgroundOpacity:.8}),1),a.getIsChecked=()=>.8==o.backgroundOpacity,a}static createColorBlock(e){let t=e.selectedColor?e.selectedColor:Ct.yellow,i=e.height?e.height:.15,s=e.width?e.width:.7,n=st(e.margin,Yi),r=new ve.Block({height:i,width:s,margin:n,backgroundColor:t,backgroundOpacity:1,offset:Vi,borderWidth:.001});return r.setupState({state:wi.IDLE,attributes:{offset:Vi,backgroundOpacity:.7}}),r.setupState({state:wi.HOVERED,attributes:{offset:Vi,backgroundOpacity:.8}}),r.setupState({state:wi.SELECTED,attributes:{offset:.004,backgroundOpacity:.8}}),r.setState(wi.IDLE),r}}let Xi=new class{constructor(){this._currentAction={},this._disableOwners=new Set,this._setupButtons()}_setupButtons(){this._undoRedoParent=new ve.Block({height:.12,width:.04,backgroundColor:Ct.defaultMenuBackground,backgroundOpacity:0}),this._undoButton=ThreeMeshUIHelper.createButtonBlock({backgroundTexture:It.undoIcon,backgroundTextureScale:.8,height:.04,width:.04}),this._redoButton=ThreeMeshUIHelper.createButtonBlock({backgroundTexture:It.redoIcon,backgroundTextureScale:.8,height:.04,width:.04}),this._undoButton.visible=!1,this._redoButton.visible=!1,this._undoRedoParent.set({fontFamily:yt,fontTexture:vt}),this._undoRedoParent.position.fromArray([.245,0,-.001]),this._undoRedoParent.add(this._undoButton),this._undoRedoParent.add(this._redoButton),this._containerInteractable=new PointerInteractable(null,null,!1),this._undoInteractable=new PointerInteractable(this._undoButton,(()=>{this._undo()})),this._redoInteractable=new PointerInteractable(this._redoButton,(()=>{this._redo()}))}addButtons(e,t){t.addChild(this._containerInteractable),e.add(this._undoRedoParent)}reset(){this._currentAction={},this._disableUndo(),this._disableRedo()}addAction(e,t){let i={head:this._currentAction,undo:e,redo:t};return this._currentAction.tail=i,this._currentAction=i,0==this._disableOwners.size&&(this._enableUndo(),this._disableRedo()),i}deleteAction(e){e.head&&(e.head.tail=e.tail,e.tail&&(e.tail.head=e.head),this._currentAction==e&&(this._currentAction=e.head),this._currentAction.head||this._disableUndo())}_undo(){this._currentAction.undo&&this._currentAction.undo(),this._currentAction.head&&(this._currentAction=this._currentAction.head,this._enableRedo()),this._currentAction.head||this._disableUndo()}_redo(){this._currentAction.tail&&(this._enableUndo(),this._currentAction=this._currentAction.tail,this._currentAction.redo&&this._currentAction.redo()),this._currentAction.tail||this._disableRedo()}_enableUndo(){this._undoButton.visible=!0,this._containerInteractable.addChild(this._undoInteractable)}_disableUndo(){this._undoButton.visible=!1,this._containerInteractable.removeChild(this._undoInteractable)}_enableRedo(){this._redoButton.visible=!0,this._containerInteractable.addChild(this._redoInteractable)}_disableRedo(){this._redoButton.visible=!1,this._containerInteractable.removeChild(this._redoInteractable)}enable(e){this._disableOwners.delete(e),0==this._disableOwners.size&&(this._currentAction.head&&this._enableUndo(),this._currentAction.tail&&this._enableRedo())}disable(e){this._disableOwners.add(e),this._disableUndo(),this._disableRedo()}};const Wi=new me,Ki=new p,Zi=new p,qi=new t,Ji={X:new p(1,0,0),Y:new p(0,1,0),Z:new p(0,0,1)},$i={type:"change"},es={type:"mouseDown"},ts={type:"mouseUp",mode:null},is={type:"objectChange"};class TransformControls extends m{constructor(e,i){super(),void 0===i&&(console.warn('THREE.TransformControls: The second parameter "domElement" is now mandatory.'),i=document),this.isTransformControls=!0,this.visible=!1,this.domElement=i,this.domElement.style.touchAction="none";const s=new TransformControlsGizmo;this._gizmo=s,this.add(s);const n=new TransformControlsPlane;this._plane=n,this.add(n);const r=this;function a(e,t){let i=t;Object.defineProperty(r,e,{get:function(){return void 0!==i?i:t},set:function(t){i!==t&&(i=t,n[e]=t,s[e]=t,r.dispatchEvent({type:e+"-changed",value:t}),r.dispatchEvent($i))}}),r[e]=t,n[e]=t,s[e]=t}a("camera",e),a("object",void 0),a("enabled",!0),a("axis",null),a("mode","translate"),a("translationSnap",null),a("rotationSnap",null),a("scaleSnap",null),a("space","world"),a("size",1),a("dragging",!1),a("showX",!0),a("showY",!0),a("showZ",!0);const o=new p,l=new p,h=new t,c=new t,d=new p,A=new t,u=new p,g=new p,m=new p,_=new p;a("worldPosition",o),a("worldPositionStart",l),a("worldQuaternion",h),a("worldQuaternionStart",c),a("cameraPosition",d),a("cameraQuaternion",A),a("pointStart",u),a("pointEnd",g),a("rotationAxis",m),a("rotationAngle",0),a("eye",_),this._offset=new p,this._startNorm=new p,this._endNorm=new p,this._cameraScale=new p,this._parentPosition=new p,this._parentQuaternion=new t,this._parentQuaternionInv=new t,this._parentScale=new p,this._worldScaleStart=new p,this._worldQuaternionInv=new t,this._worldScale=new p,this._positionStart=new p,this._quaternionStart=new t,this._scaleStart=new p,this._getPointer=ss.bind(this),this._onPointerDown=rs.bind(this),this._onPointerHover=ns.bind(this),this._onPointerMove=as.bind(this),this._onPointerUp=os.bind(this),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointermove",this._onPointerHover),this.domElement.addEventListener("pointerup",this._onPointerUp)}updateMatrixWorld(){void 0!==this.object&&(this.object.updateMatrixWorld(),null===this.object.parent?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):this.object.parent.matrixWorld.decompose(this._parentPosition,this._parentQuaternion,this._parentScale),this.object.matrixWorld.decompose(this.worldPosition,this.worldQuaternion,this._worldScale),this._parentQuaternionInv.copy(this._parentQuaternion).invert(),this._worldQuaternionInv.copy(this.worldQuaternion).invert()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(this.cameraPosition,this.cameraQuaternion,this._cameraScale),this.camera.isOrthographicCamera?this.camera.getWorldDirection(this.eye).negate():this.eye.copy(this.cameraPosition).sub(this.worldPosition).normalize(),super.updateMatrixWorld(this)}pointerHover(e){if(void 0===this.object||!0===this.dragging)return;Wi.setFromCamera(e,this.camera);const t=ls(this._gizmo.picker[this.mode],Wi);this.axis=t?t.object.name:null}pointerDown(e){if(void 0!==this.object&&!0!==this.dragging&&0===e.button&&null!==this.axis){Wi.setFromCamera(e,this.camera);const t=ls(this._plane,Wi,!0);t&&(this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),this._positionStart.copy(this.object.position),this._quaternionStart.copy(this.object.quaternion),this._scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this._worldScaleStart),this.pointStart.copy(t.point).sub(this.worldPositionStart)),this.dragging=!0,es.mode=this.mode,this.dispatchEvent(es)}}pointerMove(e){const t=this.axis,i=this.mode,s=this.object;let n=this.space;if("scale"===i?n="local":"E"!==t&&"XYZE"!==t&&"XYZ"!==t||(n="world"),void 0===s||null===t||!1===this.dragging||-1!==e.button)return;Wi.setFromCamera(e,this.camera);const r=ls(this._plane,Wi,!0);if(r){if(this.pointEnd.copy(r.point).sub(this.worldPositionStart),"translate"===i)this._offset.copy(this.pointEnd).sub(this.pointStart),"local"===n&&"XYZ"!==t&&this._offset.applyQuaternion(this._worldQuaternionInv),-1===t.indexOf("X")&&(this._offset.x=0),-1===t.indexOf("Y")&&(this._offset.y=0),-1===t.indexOf("Z")&&(this._offset.z=0),"local"===n&&"XYZ"!==t?this._offset.applyQuaternion(this._quaternionStart).divide(this._parentScale):this._offset.applyQuaternion(this._parentQuaternionInv).divide(this._parentScale),s.position.copy(this._offset).add(this._positionStart),this.translationSnap&&("local"===n&&(s.position.applyQuaternion(qi.copy(this._quaternionStart).invert()),-1!==t.search("X")&&(s.position.x=Math.round(s.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(s.position.y=Math.round(s.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(s.position.z=Math.round(s.position.z/this.translationSnap)*this.translationSnap),s.position.applyQuaternion(this._quaternionStart)),"world"===n&&(s.parent&&s.position.add(Ki.setFromMatrixPosition(s.parent.matrixWorld)),-1!==t.search("X")&&(s.position.x=Math.round(s.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(s.position.y=Math.round(s.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(s.position.z=Math.round(s.position.z/this.translationSnap)*this.translationSnap),s.parent&&s.position.sub(Ki.setFromMatrixPosition(s.parent.matrixWorld))));else if("scale"===i){if(-1!==t.search("XYZ")){let e=this.pointEnd.length()/this.pointStart.length();this.pointEnd.dot(this.pointStart)<0&&(e*=-1),Zi.set(e,e,e)}else Ki.copy(this.pointStart),Zi.copy(this.pointEnd),Ki.applyQuaternion(this._worldQuaternionInv),Zi.applyQuaternion(this._worldQuaternionInv),Zi.divide(Ki),-1===t.search("X")&&(Zi.x=1),-1===t.search("Y")&&(Zi.y=1),-1===t.search("Z")&&(Zi.z=1);s.scale.copy(this._scaleStart).multiply(Zi),this.scaleSnap&&(-1!==t.search("X")&&(s.scale.x=Math.round(s.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Y")&&(s.scale.y=Math.round(s.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Z")&&(s.scale.z=Math.round(s.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if("rotate"===i){this._offset.copy(this.pointEnd).sub(this.pointStart);const e=20/this.worldPosition.distanceTo(Ki.setFromMatrixPosition(this.camera.matrixWorld));"E"===t?(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this._startNorm.copy(this.pointStart).normalize(),this._endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=this._endNorm.cross(this._startNorm).dot(this.eye)<0?1:-1):"XYZE"===t?(this.rotationAxis.copy(this._offset).cross(this.eye).normalize(),this.rotationAngle=this._offset.dot(Ki.copy(this.rotationAxis).cross(this.eye))*e):"X"!==t&&"Y"!==t&&"Z"!==t||(this.rotationAxis.copy(Ji[t]),Ki.copy(Ji[t]),"local"===n&&Ki.applyQuaternion(this.worldQuaternion),this.rotationAngle=this._offset.dot(Ki.cross(this.eye).normalize())*e),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),"local"===n&&"E"!==t&&"XYZE"!==t?(s.quaternion.copy(this._quaternionStart),s.quaternion.multiply(qi.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this._parentQuaternionInv),s.quaternion.copy(qi.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),s.quaternion.multiply(this._quaternionStart).normalize())}this.dispatchEvent($i),this.dispatchEvent(is)}}pointerUp(e){0===e.button&&(this.dragging&&null!==this.axis&&(ts.mode=this.mode,this.dispatchEvent(ts)),this.dragging=!1,this.axis=null)}dispose(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerHover),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.traverse((function(e){e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose()}))}attach(e){return this.object=e,this.visible=!0,this}detach(){return this.object=void 0,this.visible=!1,this.axis=null,this}reset(){this.enabled&&this.dragging&&(this.object.position.copy(this._positionStart),this.object.quaternion.copy(this._quaternionStart),this.object.scale.copy(this._scaleStart),this.dispatchEvent($i),this.dispatchEvent(is),this.pointStart.copy(this.pointEnd))}getRaycaster(){return Wi}getMode(){return this.mode}setMode(e){this.mode=e}setTranslationSnap(e){this.translationSnap=e}setRotationSnap(e){this.rotationSnap=e}setScaleSnap(e){this.scaleSnap=e}setSize(e){this.size=e}setSpace(e){this.space=e}}function ss(e){if(this.domElement.ownerDocument.pointerLockElement)return{x:0,y:0,button:e.button};{const t=this.domElement.getBoundingClientRect();return{x:(e.clientX-t.left)/t.width*2-1,y:-(e.clientY-t.top)/t.height*2+1,button:e.button}}}function ns(e){if(this.enabled)switch(e.pointerType){case"mouse":case"pen":this.pointerHover(this._getPointer(e))}}function rs(e){this.enabled&&(document.pointerLockElement||this.domElement.setPointerCapture(e.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.pointerHover(this._getPointer(e)),this.pointerDown(this._getPointer(e)))}function as(e){this.enabled&&this.pointerMove(this._getPointer(e))}function os(e){this.enabled&&(this.domElement.releasePointerCapture(e.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.pointerUp(this._getPointer(e)))}function ls(e,t,i){const s=t.intersectObject(e,!0);for(let e=0;e<s.length;e++)if(s[e].object.visible||i)return s[e];return!1}const hs=new _e,cs=new p(0,1,0),ds=new p(0,0,0),As=new u,us=new t,ps=new t,gs=new p,ms=new u,_s=new p(1,0,0),fs=new p(0,1,0),bs=new p(0,0,1),Is=new p,ws=new p,Cs=new p;class TransformControlsGizmo extends m{constructor(){super(),this.isTransformControlsGizmo=!0,this.type="TransformControlsGizmo";const e=new h({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),t=new S({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),i=e.clone();i.opacity=.15;const s=t.clone();s.opacity=.5;const n=e.clone();n.color.setHex(16711680);const r=e.clone();r.color.setHex(65280);const a=e.clone();a.color.setHex(255);const o=e.clone();o.color.setHex(16711680),o.opacity=.5;const l=e.clone();l.color.setHex(65280),l.opacity=.5;const c=e.clone();c.color.setHex(255),c.opacity=.5;const d=e.clone();d.opacity=.25;const A=e.clone();A.color.setHex(16776960),A.opacity=.25;e.clone().color.setHex(16776960);const u=e.clone();u.color.setHex(7895160);const p=new fe(0,.04,.1,12);p.translate(0,.05,0);const g=new be(.08,.08,.08);g.translate(0,.04,0);const _=new P;_.setAttribute("position",new Ie([0,0,0,1,0,0],3));const f=new fe(.0075,.0075,.5,3);function b(e,t){const i=new Ce(e,.0075,3,64,t*Math.PI*2);return i.rotateY(Math.PI/2),i.rotateX(Math.PI/2),i}f.translate(0,.25,0);const I={X:[[new D(p,n),[.5,0,0],[0,0,-Math.PI/2]],[new D(p,n),[-.5,0,0],[0,0,Math.PI/2]],[new D(f,n),[0,0,0],[0,0,-Math.PI/2]]],Y:[[new D(p,r),[0,.5,0]],[new D(p,r),[0,-.5,0],[Math.PI,0,0]],[new D(f,r)]],Z:[[new D(p,a),[0,0,.5],[Math.PI/2,0,0]],[new D(p,a),[0,0,-.5],[-Math.PI/2,0,0]],[new D(f,a),null,[Math.PI/2,0,0]]],XYZ:[[new D(new we(.1,0),d.clone()),[0,0,0]]],XY:[[new D(new be(.15,.15,.01),c.clone()),[.15,.15,0]]],YZ:[[new D(new be(.15,.15,.01),o.clone()),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new D(new be(.15,.15,.01),l.clone()),[.15,0,.15],[-Math.PI/2,0,0]]]},w={X:[[new D(new fe(.2,0,.6,4),i),[.3,0,0],[0,0,-Math.PI/2]],[new D(new fe(.2,0,.6,4),i),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new D(new fe(.2,0,.6,4),i),[0,.3,0]],[new D(new fe(.2,0,.6,4),i),[0,-.3,0],[0,0,Math.PI]]],Z:[[new D(new fe(.2,0,.6,4),i),[0,0,.3],[Math.PI/2,0,0]],[new D(new fe(.2,0,.6,4),i),[0,0,-.3],[-Math.PI/2,0,0]]],XYZ:[[new D(new we(.2,0),i)]],XY:[[new D(new be(.2,.2,.01),i),[.15,.15,0]]],YZ:[[new D(new be(.2,.2,.01),i),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new D(new be(.2,.2,.01),i),[.15,0,.15],[-Math.PI/2,0,0]]]},C={START:[[new D(new we(.01,2),s),null,null,null,"helper"]],END:[[new D(new we(.01,2),s),null,null,null,"helper"]],DELTA:[[new Q(function(){const e=new P;return e.setAttribute("position",new Ie([0,0,0,1,1,1],3)),e}(),s),null,null,null,"helper"]],X:[[new Q(_,s.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new Q(_,s.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new Q(_,s.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},y={XYZE:[[new D(b(.5,1),u),null,[0,Math.PI/2,0]]],X:[[new D(b(.5,.5),n)]],Y:[[new D(b(.5,.5),r),null,[0,0,-Math.PI/2]]],Z:[[new D(b(.5,.5),a),null,[0,Math.PI/2,0]]],E:[[new D(b(.75,1),A),null,[0,Math.PI/2,0]]]},v={AXIS:[[new Q(_,s.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},B={XYZE:[[new D(new ce(.25,10,8),i)]],X:[[new D(new Ce(.5,.1,4,24),i),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new D(new Ce(.5,.1,4,24),i),[0,0,0],[Math.PI/2,0,0]]],Z:[[new D(new Ce(.5,.1,4,24),i),[0,0,0],[0,0,-Math.PI/2]]],E:[[new D(new Ce(.75,.1,2,24),i)]]},E={X:[[new D(g,n),[.5,0,0],[0,0,-Math.PI/2]],[new D(f,n),[0,0,0],[0,0,-Math.PI/2]],[new D(g,n),[-.5,0,0],[0,0,Math.PI/2]]],Y:[[new D(g,r),[0,.5,0]],[new D(f,r)],[new D(g,r),[0,-.5,0],[0,0,Math.PI]]],Z:[[new D(g,a),[0,0,.5],[Math.PI/2,0,0]],[new D(f,a),[0,0,0],[Math.PI/2,0,0]],[new D(g,a),[0,0,-.5],[-Math.PI/2,0,0]]],XY:[[new D(new be(.15,.15,.01),c),[.15,.15,0]]],YZ:[[new D(new be(.15,.15,.01),o),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new D(new be(.15,.15,.01),l),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new D(new be(.1,.1,.1),d.clone())]]},M={X:[[new D(new fe(.2,0,.6,4),i),[.3,0,0],[0,0,-Math.PI/2]],[new D(new fe(.2,0,.6,4),i),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new D(new fe(.2,0,.6,4),i),[0,.3,0]],[new D(new fe(.2,0,.6,4),i),[0,-.3,0],[0,0,Math.PI]]],Z:[[new D(new fe(.2,0,.6,4),i),[0,0,.3],[Math.PI/2,0,0]],[new D(new fe(.2,0,.6,4),i),[0,0,-.3],[-Math.PI/2,0,0]]],XY:[[new D(new be(.2,.2,.01),i),[.15,.15,0]]],YZ:[[new D(new be(.2,.2,.01),i),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new D(new be(.2,.2,.01),i),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new D(new be(.2,.2,.2),i),[0,0,0]]]},x={X:[[new Q(_,s.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new Q(_,s.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new Q(_,s.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]};function T(e){const t=new m;for(const i in e)for(let s=e[i].length;s--;){const n=e[i][s][0].clone(),r=e[i][s][1],a=e[i][s][2],o=e[i][s][3],l=e[i][s][4];n.name=i,n.tag=l,r&&n.position.set(r[0],r[1],r[2]),a&&n.rotation.set(a[0],a[1],a[2]),o&&n.scale.set(o[0],o[1],o[2]),n.updateMatrix();const h=n.geometry.clone();h.applyMatrix4(n.matrix),n.geometry=h,n.renderOrder=1/0,n.position.set(0,0,0),n.rotation.set(0,0,0),n.scale.set(1,1,1),t.add(n)}return t}this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=T(I)),this.add(this.gizmo.rotate=T(y)),this.add(this.gizmo.scale=T(E)),this.add(this.picker.translate=T(w)),this.add(this.picker.rotate=T(B)),this.add(this.picker.scale=T(M)),this.add(this.helper.translate=T(C)),this.add(this.helper.rotate=T(v)),this.add(this.helper.scale=T(x)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}updateMatrixWorld(e){const t="local"===("scale"===this.mode?"local":this.space)?this.worldQuaternion:ps;this.gizmo.translate.visible="translate"===this.mode,this.gizmo.rotate.visible="rotate"===this.mode,this.gizmo.scale.visible="scale"===this.mode,this.helper.translate.visible="translate"===this.mode,this.helper.rotate.visible="rotate"===this.mode,this.helper.scale.visible="scale"===this.mode;let i=[];i=i.concat(this.picker[this.mode].children),i=i.concat(this.gizmo[this.mode].children),i=i.concat(this.helper[this.mode].children);for(let e=0;e<i.length;e++){const s=i[e];let n;if(s.visible=!0,s.rotation.set(0,0,0),s.position.copy(this.worldPosition),n=this.camera.isOrthographicCamera?(this.camera.top-this.camera.bottom)/this.camera.zoom:this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),s.scale.set(1,1,1).multiplyScalar(n*this.size/4),"helper"!==s.tag){if(s.quaternion.copy(t),"translate"===this.mode||"scale"===this.mode){const e=.99,i=.2;"X"===s.name&&Math.abs(cs.copy(_s).applyQuaternion(t).dot(this.eye))>e&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1),"Y"===s.name&&Math.abs(cs.copy(fs).applyQuaternion(t).dot(this.eye))>e&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1),"Z"===s.name&&Math.abs(cs.copy(bs).applyQuaternion(t).dot(this.eye))>e&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1),"XY"===s.name&&Math.abs(cs.copy(bs).applyQuaternion(t).dot(this.eye))<i&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1),"YZ"===s.name&&Math.abs(cs.copy(_s).applyQuaternion(t).dot(this.eye))<i&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1),"XZ"===s.name&&Math.abs(cs.copy(fs).applyQuaternion(t).dot(this.eye))<i&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1)}else"rotate"===this.mode&&(us.copy(t),cs.copy(this.eye).applyQuaternion(qi.copy(t).invert()),-1!==s.name.search("E")&&s.quaternion.setFromRotationMatrix(As.lookAt(this.eye,ds,fs)),"X"===s.name&&(qi.setFromAxisAngle(_s,Math.atan2(-cs.y,cs.z)),qi.multiplyQuaternions(us,qi),s.quaternion.copy(qi)),"Y"===s.name&&(qi.setFromAxisAngle(fs,Math.atan2(cs.x,cs.z)),qi.multiplyQuaternions(us,qi),s.quaternion.copy(qi)),"Z"===s.name&&(qi.setFromAxisAngle(bs,Math.atan2(cs.y,cs.x)),qi.multiplyQuaternions(us,qi),s.quaternion.copy(qi)));s.visible=s.visible&&(-1===s.name.indexOf("X")||this.showX),s.visible=s.visible&&(-1===s.name.indexOf("Y")||this.showY),s.visible=s.visible&&(-1===s.name.indexOf("Z")||this.showZ),s.visible=s.visible&&(-1===s.name.indexOf("E")||this.showX&&this.showY&&this.showZ),s.material._color=s.material._color||s.material.color.clone(),s.material._opacity=s.material._opacity||s.material.opacity,s.material.color.copy(s.material._color),s.material.opacity=s.material._opacity,this.enabled&&this.axis&&(s.name===this.axis||this.axis.split("").some((function(e){return s.name===e})))&&(s.material.color.setHex(16776960),s.material.opacity=1)}else s.visible=!1,"AXIS"===s.name?(s.position.copy(this.worldPositionStart),s.visible=!!this.axis,"X"===this.axis&&(qi.setFromEuler(hs.set(0,0,0)),s.quaternion.copy(t).multiply(qi),Math.abs(cs.copy(_s).applyQuaternion(t).dot(this.eye))>.9&&(s.visible=!1)),"Y"===this.axis&&(qi.setFromEuler(hs.set(0,0,Math.PI/2)),s.quaternion.copy(t).multiply(qi),Math.abs(cs.copy(fs).applyQuaternion(t).dot(this.eye))>.9&&(s.visible=!1)),"Z"===this.axis&&(qi.setFromEuler(hs.set(0,Math.PI/2,0)),s.quaternion.copy(t).multiply(qi),Math.abs(cs.copy(bs).applyQuaternion(t).dot(this.eye))>.9&&(s.visible=!1)),"XYZE"===this.axis&&(qi.setFromEuler(hs.set(0,Math.PI/2,0)),cs.copy(this.rotationAxis),s.quaternion.setFromRotationMatrix(As.lookAt(ds,cs,fs)),s.quaternion.multiply(qi),s.visible=this.dragging),"E"===this.axis&&(s.visible=!1)):"START"===s.name?(s.position.copy(this.worldPositionStart),s.visible=this.dragging):"END"===s.name?(s.position.copy(this.worldPosition),s.visible=this.dragging):"DELTA"===s.name?(s.position.copy(this.worldPositionStart),s.quaternion.copy(this.worldQuaternionStart),Ki.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),Ki.applyQuaternion(this.worldQuaternionStart.clone().invert()),s.scale.copy(Ki),s.visible=this.dragging):(s.quaternion.copy(t),this.dragging?s.position.copy(this.worldPositionStart):s.position.copy(this.worldPosition),this.axis&&(s.visible=-1!==this.axis.search(s.name)))}super.updateMatrixWorld(e)}}class TransformControlsPlane extends D{constructor(){super(new ye(1e5,1e5,2,2),new h({visible:!1,wireframe:!0,side:x,transparent:!0,opacity:.1,toneMapped:!1})),this.isTransformControlsPlane=!0,this.type="TransformControlsPlane"}updateMatrixWorld(e){let t=this.space;switch(this.position.copy(this.worldPosition),"scale"===this.mode&&(t="local"),Is.copy(_s).applyQuaternion("local"===t?this.worldQuaternion:ps),ws.copy(fs).applyQuaternion("local"===t?this.worldQuaternion:ps),Cs.copy(bs).applyQuaternion("local"===t?this.worldQuaternion:ps),cs.copy(ws),this.mode){case"translate":case"scale":switch(this.axis){case"X":cs.copy(this.eye).cross(Is),gs.copy(Is).cross(cs);break;case"Y":cs.copy(this.eye).cross(ws),gs.copy(ws).cross(cs);break;case"Z":cs.copy(this.eye).cross(Cs),gs.copy(Cs).cross(cs);break;case"XY":gs.copy(Cs);break;case"YZ":gs.copy(Is);break;case"XZ":cs.copy(Cs),gs.copy(ws);break;case"XYZ":case"E":gs.set(0,0,0)}break;default:gs.set(0,0,0)}0===gs.length()?this.quaternion.copy(this.cameraQuaternion):(ms.lookAt(Ki.set(0,0,0),gs,cs),this.quaternion.setFromRotationMatrix(ms)),super.updateMatrixWorld(e)}}const ys=["translate","rotate","scale"];function vs(e,t){return e.distance-t.distance}function Bs(e,t,i,s){if(e.layers.test(t.layers)&&e.raycast(t,i),!0===s){const s=e.children;for(let e=0,n=s.length;e<n;e++)Bs(s[e],t,i,!0)}}let Es=new class{init(e,t,i){this._canvas=e,this._transformControls=new TransformControls(t,this._canvas),this._transformControls.setSize(1.25),this._attachedAssets={},this._placingObject={},this._preTransformStates={},this._id=it(),"XR"!=Be.deviceType&&(i.add(this._transformControls),this._addEventListeners()),tt.subscribe(this._id,ke,(e=>{if(e!=yi.EDIT)for(let e in this._attachedAssets)this.detach(e)})),tt.subscribe(this._id,He,(e=>{if(!e.targetOnlyMenu)for(let e in this._attachedAssets)this.detach(e)})),tt.subscribe(this._id,Fe,(e=>{for(let t in this._attachedAssets)this._attachedAssets[t]==e.instance&&this._detachDeleted(t)}))}_addEventListeners(){this._transformControls.addEventListener("mouseDown",(()=>{Ri.disableOrbit();let e=this._attachedAssets[Be.deviceType];this._preTransformStates[e.getId()]=e.getEditorHelper().getObjectTransformation()})),this._transformControls.addEventListener("mouseUp",(()=>{Ri.enableOrbit();let e=this._attachedAssets[Be.deviceType],t=e.getEditorHelper();t.roundAttributes(!0);let i=this._preTransformStates[e.getId()],s=t.getObjectTransformation();t.setObjectTransformation(i,s)})),this._transformControls.addEventListener("objectChange",(()=>{Be.renderer.info.render.frame%6==0&&this._attachedAssets[Be.deviceType].getEditorHelper().roundAttributes()}));let e=document.getElementById("place-button");e.addEventListener("click",(()=>{this._placingObject[Be.deviceType]=!this._placingObject[Be.deviceType],$("#transform-controls > button").removeClass("selected"),this._placingObject[Be.deviceType]?($(e).addClass("selected"),this._transformControls.detach()):($("#"+this._transformControls.mode+"-button").addClass("selected"),this._transformControls.attach(this._attachedAssets[Be.deviceType].getObject()))})),document.getElementById("clone-button").addEventListener("click",(()=>{this._clone()})),document.getElementById("delete-button").addEventListener("click",(()=>{this._delete()})),document.getElementById("close-button").addEventListener("click",(()=>{this.detach()}));for(let e of ys){let t=document.getElementById(e+"-button");t.addEventListener("click",(()=>{$("#transform-controls > button").removeClass("selected"),$(t).addClass("selected"),this._transformControls.setMode(e),this._placingObject[Be.deviceType]=!1,this._transformControls.attach(this._attachedAssets[Be.deviceType].getObject())}))}window.addEventListener("copy",(e=>{this._copy(e)})),window.addEventListener("paste",(e=>{this._paste(e)})),this._canvas.addEventListener("keydown",(e=>{"Backspace"==e.code&&this._delete()}))}_copy(e){let t=Be.deviceType,i=this._attachedAssets[t];if(i){let t="assetId:"+i.getAssetId()+":instanceId:"+i.getId();e.clipboardData.setData("text/digitalbacon",t),e.preventDefault()}}_paste(e){Be.isEditor&&(e.clipboardData.types.indexOf("Files")>=0&&this._pasteFiles(e.clipboardData.files),e.clipboardData.types.indexOf("text/digitalbacon")>=0&&this._pasteDigitalBaconData(e))}_pasteDigitalBaconData(e){let t=e.clipboardData.getData("text/digitalbacon");if(!t.includes("assetId:")||!t.includes(":instanceId:"))return;let[,i,,s]=t.split(":"),n=Gn.getInstancesForAssetId(i)[s];if(n){let t=n.clone();this._isDragging(n)||this._offsetClone(t),e.preventDefault()}}_pasteFiles(e){zi.uploadFiles(e,(e=>{Be.camera.getWorldPosition(St[0]),Be.camera.getWorldDirection(St[1]),St[1].normalize().multiplyScalar(11/12),St[0].add(St[1]);let t=St[0].toArray();St[0].set(0,0,1),St[1].setY(0).normalize(),Tt.setFromUnitVectors(St[0],St[1]),xt.setFromQuaternion(Tt);let i=xt.toArray();for(let s of e){let e=Ii.getType(s);e==Ee.IMAGE?Gn.addImage({assetId:s,position:t,rotation:i,doubleSided:!0,transparent:!0,visualEdit:!0}):e==Ee.MODEL&&Gn.addGLTF({assetId:s,position:t,rotation:i,visualEdit:!0})}}))}_clone(e){e=e||Be.deviceType;let t=this._attachedAssets[e];if(t){let e=t.clone();this._isDragging(t)||this._offsetClone(e)}}_offsetClone(e){let t=e.getObject();St[0].fromArray([0,1,0]),St[1].setFromMatrixColumn(Be.camera.matrixWorld,0),St[1].y=0,St[1].setLength(.2),St[1].applyAxisAngle(St[0],-Math.PI/4),t.worldToLocal(St[1]),t.position.add(St[1]),e.getEditorHelper().roundAttributes(!0)}_delete(e){e=e||Be.deviceType;let t=this._attachedAssets[e];t&&Gn.deleteAssetInstance(t)}checkPlacement(e){for(let t in e){let i=e[t],s=i.raycaster;s.far=1/0;let n=i.isPressed,r="XR"==Be.deviceType?this._intersectRelevantObjects(s,t):s.intersectObjects(Gn.getObjects(),!0),a=this._attachedAssets[t];if(r.length>0&&(i.closestPoint=r[0].point,n)){"XR"==Be.deviceType?Ps.hands[t].remove(a.getObject()):($("#transform-controls > button").removeClass("selected"),$("#"+this._transformControls.mode+"-button").addClass("selected"),this._transformControls.attach(a.getObject()),this._placingObject[t]=!1);let e=a.getEditorHelper(),i=e.getObjectTransformation();if(e.place(r[0]),"XR"==Be.deviceType)return void this.detach(t);e.roundAttributes(!0);let s=e.getObjectTransformation();e.setObjectTransformation(i,s)}}}scaleWithTwoHands(){let e=Ps.getDistanceBetweenHands()/this._initialScalingDistance;this._attachedAssets[Ci.LEFT].getObject().scale.set(e*this._initialScalingValues.x,e*this._initialScalingValues.y,e*this._initialScalingValues.z),Be.renderer.info.render.frame%6==0&&this._attachedAssets[Ci.LEFT].getEditorHelper()._publish(["scale"])}_intersectRelevantObjects(e,t){let i=[],s=Gn.getObjects(),n=this._attachedAssets[t].getObject();for(let t=0,r=s.length;t<r;t++)s[t]!=n&&Bs(s[t],e,i,!0);return i.sort(vs),i}_getOtherHand(e){return e==Ci.RIGHT?Ci.LEFT:e==Ci.LEFT?Ci.RIGHT:null}attach(e,t){if(t=t||Be.deviceType,tt.publish(this._id,Re,{instance:e,option:t}),this._attachedAssets[t]=e,"XR"==Be.deviceType){this._placingObject[t]=!0;let i=this._getOtherHand(t);e==this._attachedAssets[i]?(Ps.hands[t].remove(e.getObject()),Ps.hands[i].remove(e.getObject()),this._twoHandScaling=!0,this._initialScalingDistance=Ps.getDistanceBetweenHands(),this._initialScalingValues=e.getObject().scale.clone()):(this._preTransformStates[e.getId()]=e.getEditorHelper().getObjectTransformation(),Ps.hands[t].attach(e.getObject()),e.makeTranslucent()),Xi.disable(this._id)}else this._transformControls.attach(e.getObject()),$("#transform-controls").removeClass("hidden"),$("#transform-controls > button").removeClass("selected"),$("#"+this._transformControls.mode+"-button").addClass("selected")}detach(e){e=e||Be.deviceType;let t=this._attachedAssets[e];if(t){if(tt.publish(this._id,Oe,{instance:t,option:e}),"XR"==Be.deviceType){Ps.hands[e].remove(t.getObject());let i=this._getOtherHand(e);if(this._attachedAssets[i]==t)Ps.hands[i].attach(t.getObject()),this._twoHandScaling=!1;else{t.returnTransparency();let e=t.getEditorHelper();e.roundAttributes(!0);let i=this._preTransformStates[t.getId()],s=e.getObjectTransformation();e.setObjectTransformation(i,s)}1==Object.keys(this._attachedAssets).length&&Xi.enable(this._id)}delete this._attachedAssets[e],this._placingObject[e]=!1,this._transformControls.detach(),$("#transform-controls").addClass("hidden")}}_detachDeleted(e){let t=this._attachedAssets[e];if(t){if("XR"==Be.deviceType){let i=this._getOtherHand(e);if(this._attachedAssets[i]==t)this._twoHandScaling=!1;else{t.returnTransparency();let e=this._preTransformStates[t.getId()],i=t.getEditorHelper();for(let i in e)t.getObject()[i].fromArray(e[i]);i._publish(["position","rotation","scale"])}1==Object.keys(this._attachedAssets).length&&Xi.enable(this._id)}else{this._transformControls.detach(),$("#transform-controls").addClass("hidden");let e=this._preTransformStates[Be.deviceType],i=t.getEditorHelper();for(let i in e)t.getObject()[i].fromArray(e[i]);i._publish(["position","rotation","scale"])}delete this._attachedAssets[e],this._placingObject[e]=!1}}_isDragging(e){return e?this._transformControls.dragging&&e.getObject()==this.getObject():this._transformControls.dragging}getObject(){return this._transformControls.object}isPlacingObject(e){return this._placingObject[e||Be.deviceType]}isTwoHandScaling(){return this._twoHandScaling}};let Ss=new class extends InteractableHandler{constructor(){super()}init(){super.init(),this._cursors={}}_setupXRSubscription(){tt.subscribe(this._id,ke,(e=>{e==yi.EDIT?this.update=this._updateForXREdit:e==yi.COPY_PASTE?this.update=this._updateForXRCopyPaste:e==yi.DELETE&&(this.update=this._updateForXRDelete)}))}createXRCursor(t){if(this._cursors[t])return this._cursors[t];let i=document.createElement("canvas");i.width=64,i.height=64;let s=i.getContext("2d");s.beginPath(),s.arc(32,32,29,0,2*Math.PI),s.lineWidth=5,s.stroke(),s.fillStyle="white",s.fill();let n=new e.SpriteMaterial({map:new e.CanvasTexture(i),depthTest:!1,sizeAttenuation:!1});for(let t in Ci){let i=new e.Sprite(n);i.scale.set(.015,.015,.015),i.visible=!1,i.renderOrder=1/0,this._cursors[t]=i}return this._cursors[t]}_getRaycaster(t){if(t==Ci.LEFT||t==Ci.RIGHT){let i=new e.Vector3,s=new e.Vector3,n=Pi.getXRController(t,"targetRay");return n.getWorldPosition(i),n.getWorldDirection(s).negate().normalize(),new e.Raycaster(i,s,.01,50)}if("POINTER"==t){let t=Pi.getPointerPosition(),i=new e.Raycaster;return i.setFromCamera(t,Be.camera),i}if("MOBILE"==t){let t=Pi.getPointerPosition(),i=new e.Raycaster;return i.setFromCamera(t,Be.camera),i}}_isControllerPressed(e){if(e==Ci.LEFT||e==Ci.RIGHT){let t=Pi.getXRGamepad(e);return null!=t&&t.buttons[0].pressed}return"POINTER"==e?Pi.isPointerPressed():"MOBILE"==e?Pi.isScreenTouched():void 0}_raycastInteractables(e,t){let i=e.raycaster;for(let s of t){if(s.specificOption&&s.specificOption!=e.option)continue;let t,n=s.getThreeObj();if(null!=n){if(t=null==i?[]:i.intersectObject(n,!0),0!=t.length){0!=s.children.size&&this._raycastInteractables(e,s.children);let i=t[0].distance;i<e.closestPointDistance&&(e.closestPointDistance=i,e.closestPoint=t[0].point,e.closestInteractable=s)}}else 0!=s.children.size&&this._raycastInteractables(e,s.children)}}_updateInteractables(e){for(let t in e){let i=e[t],s=i.isPressed,n=this._hoveredInteractables[t],r=this._selectedInteractables[t],a=i.closestInteractable;a&&!a.isOnlyGroup()?s?r?r==a&&r.isDraggable()&&r.triggerDraggableAction(i.closestPoint):n==a&&(a.addSelectedBy(t,i.closestPoint),this._selectedInteractables[t]=a,a.removeHoveredBy(t),this._hoveredInteractables[t]=null):(n!=a?(n&&n.removeHoveredBy(t),a.addHoveredBy(t,i.closestPoint),this._hoveredInteractables[t]=a):r&&r.isDraggable()&&r.triggerAction(),r&&(r.removeSelectedBy(t),this._selectedInteractables[t]=null)):s||(n&&(n.removeHoveredBy(t),this._hoveredInteractables[t]=null),r&&(r.removeSelectedBy(t),this._selectedInteractables[t]=null,r.isDraggable()&&r.triggerAction()))}}_updateInteractablesMobile(e){for(let t in e){let i=e[t],s=i.isPressed,n=this._selectedInteractables[t];if(this._mobileWasTouched){if(!n)return void(this._mobileWasTouched=s);s?n.isDraggable()&&this._checkMobileAction(i,n,!0):(this._mobileWasTouched=!1,!this._checkMobileAction(i,n)&&n.isDraggable()&&n.triggerAction(),n.removeSelectedBy(t))}else if(s){this._mobileWasTouched=!0,this._raycastInteractables(i,this._interactables);let e=i.closestInteractable;e&&(e.addSelectedBy(t,i.closestPoint),this._selectedInteractables[t]=e)}}}_checkMobileAction(e,t,i){if(this._raycastInteractables(e,this._interactables),e.closestInteractable==t)return i?t.triggerDraggableAction(e.closestPoint):t.triggerAction(e.closestPoint),!0}_updateCursor(e){let t=e.cursor;t&&(null!=e.closestPoint?(t.position.copy(e.closestPoint),t.visible||(t.visible=!0)):t.visible&&(t.visible=!1))}_updateForXREdit(){if(!Be.sessionActive)return;if(Es.isTwoHandScaling())return void Es.scaleWithTwoHands();let e={},t={},i=[];for(let s in Ci){let n={option:s,raycaster:this._getRaycaster(s),isPressed:this._isControllerPressed(s),closestPoint:null,closestPointDistance:Number.MAX_SAFE_INTEGER,cursor:this._cursors[s]};Es.isPlacingObject(s)?t[s]=n:(e[s]=n,this._raycastInteractables(n,this._interactables),this._raycastInteractables(n,this._toolInteractables[yi.EDIT])),i.push(n)}this._updateInteractables(e),Es.checkPlacement(t);for(let e of i)this._updateCursor(e)}_updateForXRCopyPaste(){if(!Be.sessionActive)return;let e={};for(let t in Ci){let i={option:t,raycaster:this._getRaycaster(t),isPressed:this._isControllerPressed(t),closestPoint:null,closestPointDistance:Number.MAX_SAFE_INTEGER,cursor:this._cursors[t]};e[t]=i,this._raycastInteractables(i,this._interactables),this._raycastInteractables(i,this._toolInteractables[yi.COPY_PASTE])}this._updateInteractables(e),null==e[Ci.RIGHT].closestPoint&&ks.checkPlacement(e[Ci.RIGHT]);for(let t in e)this._updateCursor(e[t])}_updateForXRDelete(){if(!Be.sessionActive)return;let e={};for(let t in Ci){let i={option:t,raycaster:this._getRaycaster(t),isPressed:this._isControllerPressed(t),closestPoint:null,closestPointDistance:Number.MAX_SAFE_INTEGER,cursor:this._cursors[t]};e[t]=i,this._raycastInteractables(i,this._interactables),this._raycastInteractables(i,this._toolInteractables[yi.DELETE])}this._updateInteractables(e);for(let t in e)this._updateCursor(e[t])}_updateForXR(){if(!Be.sessionActive)return;let e={};for(let t in Ci){let i={option:t,raycaster:this._getRaycaster(t),isPressed:this._isControllerPressed(t),closestPoint:null,closestPointDistance:Number.MAX_SAFE_INTEGER,cursor:this._cursors[t]};e[t]=i,this._raycastInteractables(i,this._interactables)}this._updateInteractables(e);for(let t in e)this._updateCursor(e[t])}_updateForPointer(){if(!Be.sessionActive)return;let e={POINTER:{option:"POINTER",raycaster:this._getRaycaster("POINTER"),isPressed:this._isControllerPressed("POINTER"),closestPoint:null,closestPointDistance:Number.MAX_SAFE_INTEGER}};Es.isPlacingObject()?Es.checkPlacement(e):(this._raycastInteractables(e.POINTER,this._interactables),this._updateInteractables(e))}_updateForMobile(){if(!Be.sessionActive)return;let e={MOBILE:{option:"MOBILE",raycaster:this._getRaycaster("MOBILE"),isPressed:this._isControllerPressed("MOBILE"),closestPoint:null,closestPointDistance:Number.MAX_SAFE_INTEGER}};Es.isPlacingObject()?Es.checkPlacement(e):this._updateInteractablesMobile(e)}};class UserHand{constructor(e){if(!e in Ci)throw new Error("constructor for UserXRInputSource must be LEFT or RIGHT");if("XR"!=Be.deviceType)throw new Error("UserXRInputSource is for XR only");this._hand=e,this._isGripPressed=!1,this._vector3=new p,this._setup()}_setup(){this._controller=Pi.getXRController(this._hand,"grip"),this._controllerModel=Pi.getXRControllerModel(this._hand),this._cursor=Ss.createXRCursor(this._hand)}isInScene(){return null!=this._controller.parent}getWorldPosition(){return this._controller.getWorldPosition(this._vector3),this._vector3}getWorldRotation(){return this._controller.getWorldQuaternion(Tt),Tt.normalize(),xt.setFromQuaternion(Tt),xt}add(e){this._controller.add(e)}attach(e){this._controller.attach(e)}remove(e){e.parent==this._controller&&Be.scene.attach(e)}addToScene(e){this._controller.add(this._controllerModel),Be.scene.add(this._cursor)}removeFromScene(){this._controller.remove(this._controllerModel),Be.scene.remove(this._cursor)}}const Ms={AVATAR:1,LEFT_HAND:2,RIGHT_HAND:4,USER_VELOCITY:8,USER_POSITION:16},xs="DigitalBacon:Avatar";let Ts=new class{init(e){null==e&&(e={}),this._dynamicAssets=[],this._userObj=e["User Object"],this._flightEnabled=e["Flight Enabled"]||!1,this._avatarUrl=localStorage.getItem(xs)||"https://d1a370nemizbjq.cloudfront.net/6a141c79-d6e5-4b0d-aa0d-524a8b9b54a4.glb",this._avatarFadeUpdateNumber=0,this._setup()}_setup(){if("XR"!=Be.deviceType)this._avatar=new Avatar({"Focus Camera":!0,URL:this._avatarUrl});else{this.hands={};for(let e of[Ci.RIGHT,Ci.LEFT]){let t=new UserHand(e);this.hands[e]=t}}this._basicMovement=new BasicMovement({"User Object":this._userObj,Avatar:this._avatar}),this._dynamicAssets.push(this._basicMovement)}getAvatarUrl(){return this._avatarUrl}updateAvatar(e){localStorage.setItem(xs,e),this._avatarUrl=e,"XR"!=Be.deviceType&&this._avatar.updateSourceUrl(e),tt.publish(this._id,xe,this._avatarUrl)}getDistanceBetweenHands(){if("XR"!=Be.deviceType)return;let e=this.hands[Ci.LEFT].getWorldPosition(),t=this.hands[Ci.RIGHT].getWorldPosition();return e.distanceTo(t)}_pushXRDataForRTC(e){let t=0;Be.camera.getWorldPosition(St[0]),this._userObj.getWorldPosition(St[1]);let i=St[0].sub(St[1]).toArray();Be.camera.getWorldQuaternion(Tt),Tt.normalize(),xt.setFromQuaternion(Tt);let s=xt.toArray();s.pop(),e.push(...i),e.push(...s),t+=Ms.AVATAR;for(let n of[Ci.LEFT,Ci.RIGHT]){let r=this.hands[n];r.isInScene()&&(i=r.getWorldPosition().sub(St[1]),s=r.getWorldRotation().toArray(),s.pop(),e.push(...i.toArray()),e.push(...s),t+=Ms[n+"_HAND"])}return t}getDataForRTC(){let e=0,t=[];return"XR"==Be.deviceType&&(e+=this._pushXRDataForRTC(t)),this._basicMovement.getWorldVelocity().length()>=1e-5&&(t.push(...this._basicMovement.getWorldVelocity().toArray()),e+=Ms.USER_VELOCITY),Be.renderer.info.render.frame%300==0&&(this._userObj.getWorldPosition(St[0]),t.push(...St[0].toArray()),e+=Ms.USER_POSITION),[new Uint8Array([e]).buffer,Float32Array.from(t).buffer]}addToScene(e){"XR"!=Be.deviceType?this._avatar.addToScene(Be.cameraFocus):(this.hands[Ci.RIGHT].addToScene(e),this.hands[Ci.LEFT].addToScene(e))}removeFromScene(){"XR"!=Be.deviceType?this._avatar.removeFromScene():(this.hands[Ci.RIGHT].removeFromScene(),this.hands[Ci.LEFT].removeFromScene())}_updateAvatar(){let e=Ri.getControlsUpdateNumber();if(this._avatarFadeUpdateNumber==e)return;this._avatarFadeUpdateNumber=e;let t=Ri.getCameraDistance();if(t>1.2)return;let i=t-this._avatarFadeCameraDistance;if(Math.abs(i)<1e-11)return;this._avatarFadeCameraDistance=t;let s=this._avatar.getObject(),n=Math.max(t,.2);n=(n-.2)/.39999999999999997,0!=n?(s.parent||this._avatar.addToScene(Be.cameraFocus),n<1?this._avatar.fade(n):this._avatar.endFade()):s.parent&&this._avatar.removeFromScene()}update(e){this._avatar&&this._updateAvatar();for(let t=0;t<this._dynamicAssets.length;t++)this._dynamicAssets[t].update(e)}};var Ps=Ts;var ks=new class{constructor(){this._id=it(),this._assetAlreadyPastedByTrigger=!1,this._assetAlreadyPastedByGrip=!1,this._copiedAsset,tt.subscribe(this._id,ke,(e=>{this._copiedAsset&&this._clear(),this._assetAlreadyPastedByTrigger=!1,this._assetAlreadyPastedByGrip=!1}))}copy(e){this._copiedAsset&&this._clear(),this._copiedAsset=e,this._previewAsset=e.preview(),Ps.hands[Ci.LEFT].attach(this._previewAsset.getObject()),Ps.hands[Ci.RIGHT].add(this._previewAsset.getObject())}_paste(){this._previewAsset.clone(this._copiedAsset.visualEdit),this._assetAlreadyPastedByGrip=!0}checkPlacement(e){if(!this._copiedAsset)return;let t=e.raycaster;t.far=1/0;let i=e.isPressed,s=t.intersectObjects(Gn.getObjects(),!0);if(this._assetAlreadyPastedByTrigger){if(i)return;this._assetAlreadyPastedByTrigger=!1}if(s.length>0&&(e.closestPoint=s[0].point,i&&this._copiedAsset)){this._copiedAsset.clone().getEditorHelper().place(s[0]),this._assetAlreadyPastedByTrigger=!0}}checkGripPlacement(e){this._copiedAsset&&e!=this._assetAlreadyPastedByGrip&&(e?this._paste():this._assetAlreadyPastedByGrip=!1)}_clear(){this._previewAsset.removeFromScene(),this._copiedAsset=null,this._previewAsset=null}hasCopiedObject(){return this._copiedAsset}};let Ds=new class extends InteractableHandler{constructor(){super()}init(){super.init(),this._spheres={},this._spheres[Ci.LEFT]=new e.Sphere,this._spheres[Ci.RIGHT]=new e.Sphere,this._box3=new e.Box3}_setupXRSubscription(){tt.subscribe(this._id,ke,(e=>{let t=[Ci.LEFT,Ci.RIGHT];for(let e of t){let t=this._hoveredInteractables[e];t&&!this._interactables.has(t)&&(this._hoveredInteractables[e].removeHoveredBy(e),delete this._hoveredInteractables[e]);let i=this._selectedInteractables[e];i&&!this._interactables.has(i)&&(this._selectedInteractables[e].removeSelectedBy(e),delete this._selectedInteractables[e])}e==yi.COPY_PASTE?this.update=this._updateForXRCopyPaste:this.update=this._updateForXREdit,this._handTool=e}))}_getBoundingSphere(e){if(e==Ci.LEFT||e==Ci.RIGHT){let t=Pi.getXRController(e,"grip");return this._box3.setFromObject(t).getBoundingSphere(this._spheres[e]),this._spheres[e]}}_isControllerPressed(e){if(e==Ci.LEFT||e==Ci.RIGHT){let t=Pi.getXRGamepad(e);return null!=t&&t.buttons.length>1&&t.buttons[1].pressed}}_scopeInteractables(e,t){let i=e.boundingSphere;if(null!=i)for(let s of t){if(s.specificOption&&s.specificOption!=e.option)continue;if(null!=s.getThreeObj()){if(s.intersectsSphere(i)){0!=s.children.size&&this._scopeInteractables(e,Array.from(s.children));let t=s.distanceToSphere(i);!s.isOnlyGroup()&&t<e.closestPointDistance&&(e.closestPointDistance=t,e.closestInteractable=s)}}else 0!=s.children.size&&this._scopeInteractables(e,s.children)}}_updateInteractables(e){for(let t in e){let i=e[t],s=i.isPressed;this._scopeInteractables(i,this._interactables),this._scopeInteractables(i,this._toolInteractables[this._handTool]);let n=this._hoveredInteractables[t],r=this._selectedInteractables[t],a=i.closestInteractable;a?s?r||n!=a||(a.addSelectedBy(t),this._selectedInteractables[t]=a,a.removeHoveredBy(t),this._hoveredInteractables[t]=null):(n!=a&&(n&&n.removeHoveredBy(t),a.addHoveredBy(t),this._hoveredInteractables[t]=a),r&&(r.removeSelectedBy(t),this._selectedInteractables[t]=null)):s||(n&&(n.removeHoveredBy(t),this._hoveredInteractables[t]=null),r&&(r.removeSelectedBy(t),this._selectedInteractables[t]=null))}}_updateForXRCopyPaste(){if(!Be.sessionActive)return;let e={};e[Ci.LEFT]={option:Ci.LEFT,boundingSphere:this._getBoundingSphere(Ci.LEFT),isPressed:this._isControllerPressed(Ci.LEFT),closestPointDistance:Number.MAX_SAFE_INTEGER},ks.hasCopiedObject()?ks.checkGripPlacement(this._isControllerPressed(Ci.RIGHT)):e[Ci.RIGHT]={option:Ci.RIGHT,boundingSphere:this._getBoundingSphere(Ci.RIGHT),isPressed:this._isControllerPressed(Ci.RIGHT),closestPointDistance:Number.MAX_SAFE_INTEGER},this._updateInteractables(e)}_updateForXREdit(){if(!Be.sessionActive)return;let e={},t=[Ci.LEFT,Ci.RIGHT];for(let i=0;i<t.length;i++){let s=t[i];e[s]={option:s,boundingSphere:this._getBoundingSphere(s),isPressed:this._isControllerPressed(s),closestPointDistance:Number.MAX_SAFE_INTEGER}}this._updateInteractables(e)}_updateForPointer(){}_updateForMobile(){}};const Fs={iceServers:[{urls:["stun:stun1.l.google.com:19302","stun:stun2.l.google.com:19302","stun:stun3.l.google.com:19302","stun:stun4.l.google.com:19302"]}]};class RTCPeer{constructor(e,t,i,s){this._peerId=e,this._polite=t,this._socket=i,this._onTimeout=s,this._myAudioTrack,this._peerAudioTrack,this._connection=new RTCPeerConnection(Fs),this._audio=function(){let e=document.createElement("audio");return e.autoplay=!0,document.body.appendChild(e),e}(),this._makingOffer=!1,this._ignoreOffer=!1,this._isSettingRemoteAnswerPending=!1,this._hasConnected=!1,this._dataChannel=null,t||(this._timeoutId=setTimeout((()=>this._timeout()),2e4)),this._setupConnection(),this._sendDataQueue=new Queue}_setupConnection(){this._connection.ontrack=e=>{this._peerAudioTrack=e.track,e.track.onunmute=()=>{this._audio.srcObject||(this._audio.srcObject=e.streams[0])}},this._connection.onicecandidate=e=>{this._socket.send({topic:"candidate",to:this._peerId,candidate:e.candidate})},this._connection.onnegotiationneeded=async()=>{try{this._makingOffer=!0,await this._connection.setLocalDescription(),this._socket.send({topic:"description",to:this._peerId,description:this._connection.localDescription})}catch(e){console.error(e)}finally{this._makingOffer=!1}},this._connection.ondatachannel=e=>{this._polite||(this._dataChannel=e.channel,this._dataChannel.bufferedAmountLowThreshold=65536,this._dataChannel.onopen=e=>{this._onSendDataChannelOpen&&this._onSendDataChannelOpen(e)},this._dataChannel.onclose=e=>{this._onSendDataChannelClose&&this._onSendDataChannelClose(e)},this._dataChannel.onmessage=e=>{this._onMessage&&this._onMessage(e.data)})},this._connection.onconnectionstatechange=e=>{let t=this._connection.connectionState;"connected"!=t||this._hasConnected?"disconnected"!=t&&"failed"!=t||(this._polite||clearTimeout(this._timeoutId),this._onDisconnect&&this._onDisconnect()):(this._hasConnected=!0,this._polite&&this._setupDataChannel(),this._polite||clearTimeout(this._timeoutId))}}_setupDataChannel(){this._dataChannel=this._connection.createDataChannel(this._peerId),this._dataChannel.bufferedAmountLowThreshold=65536,this._dataChannel.onopen=e=>{this._onSendDataChannelOpen&&this._onSendDataChannelOpen(e)},this._dataChannel.onclose=e=>{this._onSendDataChannelClose&&this._onSendDataChannelClose(e)},this._dataChannel.onmessage=e=>{this._onMessage&&this._onMessage(e.data)}}_timeout(){this._onTimeout&&this._onTimeout()}toggleMyselfMuted(e){this._myAudioTrack.enabled=!e}togglePeerMuted(e){this._peerAudioTrack.enabled=!e}addAudioTrack(e,t){this._myAudioTrack=e,this._connection.addTrack(e,t)}close(){this._connection.close(),this._audio.srcObject=null,this._audio.parentNode&&document.body.removeChild(this._audio),this._onDisconnect&&this._onDisconnect()}getPeerId(){return this._peerId}handleCandidate(e){try{this._connection.addIceCandidate(e.candidate)}catch(e){this._ignoreOffer||console.error(e)}}async handleDescription(e){let t=e.description;try{let e=!this._makingOffer&&("stable"==this._connection.signalingState||this._isSettingRemoteAnswerPending),i="offer"==t.type&&!e;if(this._ignoreOffer=!this._polite&&i,this._ignoreOffer)return;this._isSettingRemoteAnswerPending="answer"==t.type,await this._connection.setRemoteDescription(t),this._isSettingRemoteAnswerPending=!1,"offer"==t.type&&(await this._connection.setLocalDescription(),this._socket.send({topic:"description",to:this._peerId,description:this._connection.localDescription}))}catch(e){console.error(e)}}isConnected(){return this._hasConnected}sendData(e){this._sendDataQueue.enqueue(e),this._dataChannel.onbufferedamountlow||1==this._sendDataQueue.length&&this._sendData()}_sendData(){let e=this._dataChannel;for(;e.bufferedAmount<=e.bufferedAmountLowThreshold;)if(e.send(this._sendDataQueue.dequeue()),0==this._sendDataQueue.length)return;e.onbufferedamountlow=()=>{e.onbufferedamountlow=null,this._sendData()}}setOnDisconnect(e){this._onDisconnect=e}setOnMessage(e){this._onMessage=e}setOnSendDataChannelOpen(e){this._onSendDataChannelOpen=e}setOnSendDataChannelClose(e){this._onSendDataChannelClose=e}}const Qs={audio:!0,video:!1};let Rs=new class{constructor(){this._peers={},this._userAudio=function(){let e=document.createElement("audio");return e.autoplay=!0,document.body.appendChild(e),e}(),this._userAudio.defaultMuted=!0,this._userAudio.muted=!0,this._pingIntervalId=null}host(e,t,i){this._authToken?(this._socket&&this.disconnect(),this._isHost=!0,this._roomId=e,this._successCallback=t,this._errorCallback=i,this._userAudio.srcObject?this._setupWebSocket():this._setupUserMedia()):this._fetchAuthToken((()=>{this.host(e,t,i)}),i)}join(e,t,i){this._authToken?(this._socket&&this.disconnect(),this._roomId=e,this._successCallback=t,this._errorCallback=i,this._userAudio.srcObject?this._setupWebSocket():this._setupUserMedia()):this._fetchAuthToken((()=>{this.join(e,t,i)}),i)}disconnect(){this._socket&&this._socket.close(),this._pingIntervalId&&(clearInterval(this._pingIntervalId),this._pingIntervalId=null),this._socket=null,this._isHost=!1;for(let e in this._peers)this._peers[e].close();this._peers={},this._onDisconnect&&this._onDisconnect()}bootPeer(e){this._socket.send({topic:"boot-peer",peerId:e})}designateHost(e){this._socket.send({topic:"designate-host",peerId:e})}setOnSetupPeer(e){this._onSetupPeer=e}setOnDisconnect(e){this._onDisconnect=e}_fetchAuthToken(e,t){fetch(Be.authUrl).then((e=>e.json())).then((t=>{this._authToken=t.authToken,e()})).catch((e=>{this.disconnect(),t({topic:"bad-auth"})}))}_setupUserMedia(){navigator.mediaDevices.getUserMedia(Qs).then((e=>{this._userAudio.srcObject=e,this._setupWebSocket()})).catch((e=>{this._userAudio.srcObject=new MediaStream,this._setupWebSocket()}))}_setupWebSocket(){this._socket=new WebSocket(Be.partyUrl),this._socket.onopen=e=>{this._onSocketOpen(e)},this._socket.onclose=e=>{this._onSocketClose(e)},this._socket.onmessage=e=>{this._onSocketMessage(e)},this._socket.onerror=e=>{this._onSocketError(e)},this._socket._send=this._socket.send,this._socket.send=e=>{e.authToken=this._authToken,this._socket._send(JSON.stringify(e))}}_onSocketOpen(e){this._socket.send({topic:"identify",roomId:this._roomId,isHost:this._isHost}),this._pingIntervalId=setInterval((()=>{this._socket.send({topic:"ping"})}),54e4)}_onSocketClose(e){this._socket&&this.disconnect()}_onSocketMessage(e){let t=JSON.parse(e.data),i=t.topic;"initiate"==i?this._setupRTCPeer(t):"candidate"==i?this._peers[t.from].handleCandidate(t):"description"==i?this._peers[t.from].handleDescription(t):"hosting"==i?this._successCallback&&this._successCallback():"designate-host"==i?tt.publish(this._id,Te):"boot-peer"==i?tt.publish(this._id,Pe,t.peerId):"disconnect"==i?this.disconnect():"error"==i&&"boot-peer"==t.requestTopic?tt.publish(this._id,Ge,{text:"Error: Couldn't kick out user"}):"error"==i&&"designate-host"==t.requestTopic?(tt.publish(this._id,Te),tt.publish(this._id,Ge,{text:"Error: Couldn't make user host"})):(this.disconnect(),this._errorCallback&&this._errorCallback(t))}_onSocketError(e){this.disconnect(),this._errorCallback&&this._errorCallback(e)}_onRTCTimeout(){this._socket&&this._onSocketError({topic:"rtc-timeout"})}_setupRTCPeer(e){let t=e.peerId,i=e.polite;this._peers[t]=new RTCPeer(e.peerId,i,this._socket,(()=>this._onRTCTimeout()));let s=this._userAudio.srcObject.clone();this._peers[t].addAudioTrack(s.getAudioTracks()[0],s),this._onSetupPeer&&this._onSetupPeer(this._peers[t])}};class PeerHand extends Entity{constructor(t){if(super(),!t in Ci)throw new Error("constructor for PeerHand must be LEFT or RIGHT");this._hand=t,this._isGripPressed=!1,this._vector3=new e.Vector3,this._setup()}_setup(){let t=new e.SphereGeometry(.05),i=new e.MeshLambertMaterial({color:13011043});this._mesh=new e.Mesh(t,i),this._object.add(this._mesh)}add(e){this._object.add(e)}attach(e){this._object.attach(e)}remove(e){e.parent==this._object&&Be.scene.attach(e)}}class PeerController extends Entity{constructor(t,i,s,n){super(),this._velocity=new e.Vector3,this._positionError=new e.Vector3,this._errorFixFrame=30,this._username=i||"...",this._displayingUsername=s,this._isXR=n,this._setup(t)}_setup(t){if(this._avatar=new Avatar({URL:t,"Vertical Offset":this._isXR?0:1.7}),this._avatar.addToScene(this._object),this._isXR){this.hands={};for(let e of[Ci.RIGHT,Ci.LEFT]){let t=new PeerHand(e);this.hands[e]=t,t.addToScene(this._object)}}let i={text:this._username,fontFamily:yt,fontTexture:vt,fontSize:.06,height:.04,width:.5,offset:0,margin:0};this._usernameBlock=new e.Object3D;let s=ThreeMeshUIHelper.createTextBlock(i),n=ThreeMeshUIHelper.createTextBlock(i);s.rotateY(Math.PI),this._usernameBlock.position.setY(1.85),this._usernameBlock.add(s),this._usernameBlock.add(n),this._displayingUsername&&this._object.add(this._usernameBlock)}_updateAvatarData(e,t){let i=this._avatar.getObject();i.position.fromArray(e,t);let s=e.slice(t+3,t+6);i.rotation.fromArray(s)}_updateHandData(e,t,i){let s=this.hands[i].getObject();s.position.fromArray(e,t);let n=e.slice(t+3,t+6);s.rotation.fromArray(n)}_updateVelocity(e,t,i){if(this._velocity.fromArray(e,t),this._object.position.addScaledVector(this._velocity,i),!this._isXR){if(St[0].copy(this._velocity).setY(0),St[0].length()<.001)return;St[0].multiplyScalar(-1).add(this._object.position),this._object.lookAt(St[0])}}_updatePosition(e,t){this._positionError.fromArray(e,t).sub(this._object.position),this._errorFixFrame=0}updateAvatar(e){this._avatar.updateSourceUrl(e)}setDisplayingUsername(e){this._displayingUsername!=e&&(this._displayingUsername=!this._displayingUsername,this._displayingUsername?this._object.add(this._usernameBlock):this._object.remove(this._usernameBlock))}updateUsername(e){if(this._username==e)return;this._username=e;let t=e=rt(e||"...",17);this._usernameBlock.children.forEach((e=>{e.children[1].set({content:t})}))}update(e,t){t?this._updateWithMessage(e,t):this._updateWithoutMessage(e),this._errorFixFrame<30&&(this._object.position.addScaledVector(this._positionError,.03333333333333333),this._errorFixFrame++)}_updateWithMessage(e,t){let i=new Uint8Array(t.slice(2,3))[0],s=new Float32Array(t.slice(3)),n=0;Ms.AVATAR&i&&(this._updateAvatarData(s,n),n+=6),Ms.LEFT_HAND&i&&(this._updateHandData(s,n,Ci.LEFT),n+=6),Ms.RIGHT_HAND&i&&(this._updateHandData(s,n,Ci.RIGHT),n+=6),Ms.USER_VELOCITY&i?(this._updateVelocity(s,n,e),n+=3):this._velocity.set(0,0,0),Ms.USER_POSITION&i&&(this._updatePosition(s,n),n+=3)}_updateWithoutMessage(e,t){this._object.position.addScaledVector(this._velocity,e)}}let Os=new class{constructor(){this._materials={},this._materialClassMap={},this._sessionMaterials={}}addNewMaterial(e,t,i,s){let n=new this._materialClassMap[e](t);return this.addMaterial(n,i,s),n}addMaterial(e,t,i){this._materials[e.getId()]||(this._materials[e.getId()]=e,this._sessionMaterials[e.getId()]=e,t||Xi.addAction((()=>{this.deleteMaterial(e,!0,i)}),(()=>{this.addMaterial(e,!0,i)})),e.undoDispose(),i||tt.publish(this._id,Le,e))}deleteMaterial(e,t,i){if(!(e.getId()in this._materials))return;let s;t||(s=Xi.addAction((()=>{this.addMaterial(e,!0,i)}),(()=>{this.deleteMaterial(e,!0,i)}))),e.dispose(),delete this._materials[e.getId()],i||tt.publish(this._id,Ne,{material:e,undoRedoAction:s})}load(e){if(e)for(let t in e)if(t in this._materialClassMap)for(let i of e[t])this.addNewMaterial(t,i,!0,!0);else console.error("Unrecognized material found")}registerMaterial(e,t){this._materialClassMap[t]=e}getMaterials(){return this._materials}getMaterial(e){return this._materials[e]}getSessionMaterial(e){return this._sessionMaterials[e]}getType(e){return this._materials[e].getMaterialType()}reset(){this._materials={},this._sessionMaterials={}}getMaterialsAssetIds(){return new Set}getMaterialsDetails(){let e={};for(let t in this._materials){let i=this._materials[t],s=i.getMaterialType(),n=i.exportParams();s in e||(e[s]=[]),e[s].push(n)}return e}};let Ls=new class{constructor(){this._textures={},this._textureClassMap={},this._sessionTextures={}}addNewTexture(e,t,i,s){let n=new this._textureClassMap[e](t);return this.addTexture(n,i,s),n}addTexture(e,t,i){this._textures[e.getId()]||(this._textures[e.getId()]=e,this._sessionTextures[e.getId()]=e,t||Xi.addAction((()=>{this.deleteTexture(e,!0,i)}),(()=>{this.addTexture(e,!0,i)})),i||tt.publish(this._id,Je,e))}deleteTexture(e,t,i){if(!(e.getId()in this._textures))return;let s;t||(s=Xi.addAction((()=>{this.addTexture(e,!0,i)}),(()=>{this.deleteTexture(e,!0,i)}))),e.dispose(),delete this._textures[e.getId()],i||tt.publish(this._id,$e,{texture:e,undoRedoAction:s})}load(e){if(e)for(let t in e)if(t in this._textureClassMap)for(let i of e[t])this.addNewTexture(t,i,!0,!0);else console.error("Unrecognized texture found")}registerTexture(e,t){this._textureClassMap[t]=e}getTextures(){return this._textures}getTexture(e){return this._textures[e]}getSessionTexture(e){return this._sessionTextures[e]}getTextureName(e){return e in this._textures?this._textures[e].getName():null}getType(e){return this._textures[e].getTextureType()}reset(){this._textures={},this._sessionTextures={}}getTexturesAssetIds(){let e=new Set;for(let t in this._textures){let i=this._textures[t].getAssetIds();for(let t of i)e.add(t)}return e}getTexturesDetails(){let e={};for(let t in this._textures){let i=this._textures[t],s=i.getTextureType(),n=i.exportParams();s in e||(e[s]=[]),e[s].push(n)}return e}};const Ns=16384,Us={instance_added:"_handleInstanceAdded",instance_deleted:"_handleInstanceDeleted",instance_updated:"_handleInstanceUpdated",instance_attached:"_handleInstanceAttached",instance_detached:"_handleInstanceDetached",material_added:"_handleMaterialAdded",material_deleted:"_handleMaterialDeleted",material_updated:"_handleMaterialUpdated",settings_updated:"_handleSettingsUpdated",texture_added:"_handleTextureAdded",texture_deleted:"_handleTextureDeleted",texture_updated:"_handleTextureUpdated"};let Hs=new class{constructor(){this._id=it(),this._handlingLocks=new Set,this._handleQueue=new Queue,this._publishQueue=new Queue}init(e){this._partyHandler=e;let t={avatar:(e,t)=>{this._handleAvatar(e,t)},asset_added:(e,t)=>{this._handleAssetAdded(e,t)},username:(e,t)=>{this._handleUsername(e,t)}};for(let e in Us){let i=Us[e];t[e]=(e,t)=>{this._handleBlockable(i,e,t)}}this._partyHandler.addMessageHandlers(t)}_handleAvatar(e,t){e.controller?e.controller.updateAvatar(t.url):(e.controller=new PeerController(t.url,e.username,this._partyHandler.getDisplayingUsernames(),t.isXR),e.controller.addToScene(Be.scene))}_handleAssetAdded(e,t){let i=it();this._handlingLocks.add(i);let s=t.parts,n=t.assetId,r=t.name,a=t.type,o=[];this._partyHandler.setEventBufferHandler(e,((e,t)=>{if(o.push(t),o.length==s){this._partyHandler.setEventBufferHandler(e);let t=new Blob(o),s={Name:r,Type:a};Ii.loadLibraryAsset(n,s,t).then((()=>{tt.publish(this._id,Me,n),this._removeHandlingLock(i)}))}}))}_handleBlockable(e,t,i){this._handlingLocks.size>0?this._handleQueue.enqueue((()=>{this[e](t,i)})):this[e](t,i)}_handleInstanceAdded(e,t){let i=Gn.getSessionInstance(t.instance.id);i?(i.addToScene(Be.scene),Gn.addAsset(i,!0,!0)):i=Gn.addInstance(t.instance,!0,!0),tt.publish(this._id,De,i)}_handleInstanceDeleted(e,t){let i=Gn.getInstancesForAssetId(t.assetId)[t.id];if(i){Gn.deleteAssetInstance(i,!0,!0);let e=Fe+":"+t.id,s={instance:i};tt.publish(this._id,e,s,!0)}else console.error("Instance to delete does not exist")}_handleInstanceUpdated(e,t){let i=t.instance,s=Gn.getSessionInstance(i.id);s&&this._handleAssetUpdate(s,i,Qe)}_handleInstanceAttached(e,t){let i=Gn.getSessionInstance(t.id);if(i){let s=i.getEditorHelper();s&&s.attachToPeer(e,t)}}_handleInstanceDetached(e,t){let i=Gn.getSessionInstance(t.id);if(i){let s=i.getEditorHelper();s&&s.detachFromPeer(e,t)}}_handleMaterialAdded(e,t){let i=Os.getSessionMaterial(t.material.id);i?Os.addMaterial(i,!0,!0):i=Os.addNewMaterial(t.type,t.material,!0,!0),tt.publish(this._id,Le,i)}_handleMaterialDeleted(e,t){let i=Os.getMaterial(t.id);if(i){Os.deleteMaterial(i,!0,!0);let e=Ne+":"+t.id,s={material:i};tt.publish(this._id,e,s,!0)}else console.error("Material to delete does not exist")}_handleMaterialUpdated(e,t){let i=t.material,s=Os.getSessionMaterial(i.id);s&&this._handleAssetUpdate(s,i,Ue)}_handleSettingsUpdated(e,t){let i=t.settings;for(let e in i){let t;if("User Settings"==e)t="setUserSetting";else{if("Skybox"!=e)return void console.error("Unknown setting updated: "+e);t="setSkyboxSide"}for(let s in i[e])Hi[t](s,i[e][s],!0)}tt.publish(this._id,qe,{settings:i})}_handleTextureAdded(e,t){let i=Ls.getSessionTexture(t.texture.id);i?Ls.addTexture(i,!0,!0):i=Ls.addNewTexture(t.type,t.texture,!0,!0),tt.publish(this._id,Je,i)}_handleTextureDeleted(e,t){let i=Ls.getTexture(t.id);if(i){Ls.deleteTexture(i,!0,!0);let e=$e+":"+t.id,s={texture:i};tt.publish(this._id,e,s,!0)}else console.error("Texture to delete does not exist")}_handleTextureUpdated(e,t){let i=t.texture,s=Ls.getSessionTexture(i.id);s&&this._handleAssetUpdate(s,i,et)}_handleAssetUpdate(e,t,i){let s=[];for(let i in t){if("id"==i)continue;s.push(i);let n=at(i);"set"+n in e&&e["set"+n](t[i]),Be.isEditor&&e.getEditorHelper().updateMenuField(i)}let n={asset:e,fields:s};tt.publish(this._id,i,n)}_handleUsername(e,t){let i=t.username;e.username!=i&&(e.username=i,e.controller&&e.controller.updateUsername(i),tt.publish(this._id,We,{peer:e}))}handlePartyStarted(){tt.publish(this._id,Ve)}handlePartyEnded(){tt.publish(this._id,ze)}handlePeerConnected(e){tt.publish(this._id,Ye,{peer:e})}handlePeerDisconnected(e){tt.publish(this._id,Xe,{peer:e})}_removeHandlingLock(e){for(this._handlingLocks.delete(e);this._handleQueue.length>0&&0==this._handlingLocks.size;)this._handleQueue.dequeue()()}_publishAssetAdded(e){return new Promise((t=>{let i=Ii.getLibrary()[e];i.Blob.arrayBuffer().then((s=>{let n=[],r=Math.ceil(s.byteLength/Ns);for(let e=0;e<r;e++){let t=e*Ns,i=(e+1)*Ns;n.push(s.slice(t,i))}this._partyHandler.sendToAllPeers(JSON.stringify({topic:"asset_added",assetId:e,name:i.Name,type:i.Type,parts:n.length}));for(let e of n)this._partyHandler.sendToAllPeers(e);t()}))}))}_publishAvatarUpdated(e){return this._partyHandler.sendToAllPeers(JSON.stringify({topic:"avatar",url:e})),Promise.resolve()}_publishInstanceAdded(e){let t={topic:"instance_added",instance:e.exportParams()};return this._partyHandler.sendToAllPeers(JSON.stringify(t)),Promise.resolve()}_publishInstanceDeleted(e){let t={topic:"instance_deleted",id:e.getId(),assetId:e.getAssetId()};return this._partyHandler.sendToAllPeers(JSON.stringify(t)),Promise.resolve()}_publishInstanceAttached(e){let t={topic:"instance_attached",id:e.instance.getId(),assetId:e.instance.getAssetId(),option:e.option};return"XR"==Be.deviceType&&(t.position=e.instance.getPosition(),t.rotation=e.instance.getRotation(),t.isXR=!0),this._partyHandler.sendToAllPeers(JSON.stringify(t)),Promise.resolve()}_publishInstanceDetached(e){let t={topic:"instance_detached",id:e.instance.getId(),assetId:e.instance.getAssetId(),option:e.option};return"XR"==Be.deviceType&&(t.position=e.instance.getPosition(),t.rotation=e.instance.getRotation(),t.isXR=!0),this._partyHandler.sendToAllPeers(JSON.stringify(t)),Promise.resolve()}_publishMaterialAdded(e){let t={topic:"material_added",material:e.exportParams(),type:e.getMaterialType()};return this._partyHandler.sendToAllPeers(JSON.stringify(t)),Promise.resolve()}_publishMaterialDeleted(e){let t={topic:"material_deleted",id:e.getId()};return this._partyHandler.sendToAllPeers(JSON.stringify(t)),Promise.resolve()}_publishSettingsUpdate(e){let t=e.settings,i=e.keys,s={topic:"settings_updated",settings:{}};return s.settings[i[0]]={},s.settings[i[0]][i[1]]=t[i[0]][i[1]],this._partyHandler.sendToAllPeers(JSON.stringify(s)),Promise.resolve()}_publishTextureAdded(e){let t={topic:"texture_added",texture:e.exportParams(),type:e.getTextureType()};return this._partyHandler.sendToAllPeers(JSON.stringify(t)),Promise.resolve()}_publishTextureDeleted(e){let t={topic:"texture_deleted",id:e.getId()};return this._partyHandler.sendToAllPeers(JSON.stringify(t)),Promise.resolve()}_publishAssetUpdate(e,t){let i={};i.id=e.asset.getId();for(let t of e.fields){let s=at(t);i[t]=e.asset["get"+s]()}let s={topic:t+"_updated"};return s[t]=i,this._partyHandler.sendToAllPeers(JSON.stringify(s,((e,t)=>void 0===t?null:t))),Promise.resolve()}addSubscriptions(){tt.subscribe(this._id,Me,(e=>{this._publishQueue.enqueue((()=>this._publishAssetAdded(e)))})),tt.subscribe(this._id,xe,(e=>{this._publishQueue.enqueue((()=>this._publishAvatarUpdated(e)))})),tt.subscribe(this._id,Te,(()=>{this._partyHandler.setIsHost(!0)})),tt.subscribe(this._id,Pe,(e=>{this._partyHandler.bootPeer(e)})),tt.subscribe(this._id,De,(e=>{this._publishQueue.enqueue((()=>this._publishInstanceAdded(e)))})),tt.subscribe(this._id,Fe,(e=>{this._publishQueue.enqueue((()=>this._publishInstanceDeleted(e.instance)))})),tt.subscribe(this._id,Qe,(e=>{this._publishQueue.enqueue((()=>this._publishAssetUpdate(e,"instance")))})),tt.subscribe(this._id,Re,(e=>{this._publishQueue.enqueue((()=>this._publishInstanceAttached(e)))})),tt.subscribe(this._id,Oe,(e=>{this._publishQueue.enqueue((()=>this._publishInstanceDetached(e)))})),tt.subscribe(this._id,Le,(e=>{this._publishQueue.enqueue((()=>this._publishMaterialAdded(e)))})),tt.subscribe(this._id,Ne,(e=>{this._publishQueue.enqueue((()=>this._publishMaterialDeleted(e.material)))})),tt.subscribe(this._id,Ue,(e=>{this._publishQueue.enqueue((()=>this._publishAssetUpdate(e,"material")))})),tt.subscribe(this._id,qe,(e=>{this._publishQueue.enqueue((()=>this._publishSettingsUpdate(e)))})),tt.subscribe(this._id,Je,(e=>{this._publishQueue.enqueue((()=>this._publishTextureAdded(e)))})),tt.subscribe(this._id,$e,(e=>{this._publishQueue.enqueue((()=>this._publishTextureDeleted(e.texture)))})),tt.subscribe(this._id,et,(e=>{this._publishQueue.enqueue((()=>this._publishAssetUpdate(e,"texture")))}))}removeSubscriptions(){tt.unsubscribe(this._id,Me),tt.unsubscribe(this._id,xe),tt.unsubscribe(this._id,Te),tt.unsubscribe(this._id,Pe),tt.unsubscribe(this._id,De),tt.unsubscribe(this._id,Fe),tt.unsubscribe(this._id,Qe),tt.unsubscribe(this._id,Re),tt.unsubscribe(this._id,Oe),tt.unsubscribe(this._id,Le),tt.unsubscribe(this._id,Ne),tt.unsubscribe(this._id,Ue),tt.unsubscribe(this._id,qe),tt.unsubscribe(this._id,Je),tt.unsubscribe(this._id,$e),tt.unsubscribe(this._id,et)}update(){this._isPublishing||0==this._publishQueue.length||(this._isPublishing=!0,this._publishQueue.dequeue()().then((()=>this._isPublishing=!1)))}};const Gs=16384,js=65536;let zs=new class{constructor(){this._peers={},this._partyActive=!1,this._displayingUsernames=!1,this._username=String.fromCharCode(97+Math.floor(26*Math.random()))+Math.floor(100*Math.random()),this._messageHandlers={project:(e,t)=>{this._handleProject(e,t)}},Hs.init(this),Rs.setOnSetupPeer((e=>{this._registerPeer(e)})),Rs.setOnDisconnect((()=>{this._onDisconnect()}))}_onDisconnect(){this._partyActive=!1,Hs.removeSubscriptions();for(let e in this._peers){let t=this._peers[e];t.rtc&&t.rtc.close(),t.controller&&t.controller.removeFromScene()}this._peers={},Hs.handlePartyEnded()}_registerPeer(e){let t={id:e.getPeerId(),jitterBuffer:new Queue};this._peers[t.id]=t,e.setOnSendDataChannelOpen((()=>{this._successCallback&&this._successCallback(),t.rtc=e,Hs.handlePeerConnected(t),e.sendData(JSON.stringify({topic:"avatar",url:Ps.getAvatarUrl(),isXR:"XR"==Be.deviceType})),e.sendData(JSON.stringify({topic:"username",username:this._username})),this._isHost&&Be.isEditor&&this._sendProject([e])})),e.setOnSendDataChannelClose((()=>{delete t.rtc})),e.setOnDisconnect((()=>{t.controller&&t.controller.removeFromScene(),t.id in this._peers&&(delete this._peers[t.id],Hs.handlePeerDisconnected(t))})),e.setOnMessage((e=>{"string"==typeof e?this._handleJSON(t,JSON.parse(e)):this._handleArrayBuffer(t,e)}))}_handleJSON(e,t){t.topic in this._messageHandlers&&this._messageHandlers[t.topic](e,t)}_handleArrayBuffer(e,t){e.handleEventArrayBuffer?e.handleEventArrayBuffer(e,t):e.jitterBuffer.enqueue(t)}_getNextJitterBufferMessage(e,t){let i=e.peek();if(!i)return null;let s,n=this._getMessageTimestamp(i),r=t-n;if(r=(r%js+js)%js,r<=50)return null;do{if(i=e.dequeue(),s=e.peek(),!s)return i;n=this._getMessageTimestamp(s),r=t-n,r=(r%js+js)%js}while(r>50);return i}_getMessageTimestamp(e){return new Uint16Array(e,0,1)[0]}_sendProject(e,t){if(t){e.forEach((e=>e.sendData(JSON.stringify({topic:"project",parts:t.length}))));for(let i of t)e.forEach((e=>e.sendData(i)))}else{Gn.exportProject().generateAsync({type:"arraybuffer"}).then((t=>{let i=[],s=Math.ceil(t.byteLength/Gs);for(let e=0;e<s;e++){let s=e*Gs,n=(e+1)*Gs;i.push(t.slice(s,n))}this._sendProject(e,i)}))}}_handleProject(e,t){let i=t.parts,s=[];e.handleEventArrayBuffer=(e,t)=>{if(s.push(t),s.length==i){e.handleEventArrayBuffer=null;let t=mt(s);(new JSZip).loadAsync(t).then((e=>{Gn.loadZip(e)}))}}}addMessageHandlers(e){for(let t in e)this._messageHandlers[t]=e[t]}bootPeer(e){let t=this._peers[e];t&&t.rtc?t.rtc.close():console.error("Error: couldn't boot peer. Maybe a race condition?")}getDisplayingUsernames(){return this._displayingUsernames}getPeer(e){return this._peers[e]}getPeers(){return this._peers}getUsername(){return this._username}sendProject(){let e=[];for(let t in this._peers)this._peers[t].rtc&&e.push(this._peers[t].rtc);this._sendProject(e)}setDisplayingUsernames(e){if(this._displayingUsernames!=e){this._displayingUsernames=!this._displayingUsernames;for(let e in this._peers){let t=this._peers[e].controller;t&&t.setDisplayingUsername(this._displayingUsernames)}}}setIsHost(e){this._isHost=e}setUsername(e){this._username=e,this.sendToAllPeers(JSON.stringify({topic:"username",username:e}))}isHost(){return this._isHost}isPartyActive(){return this._partyActive}host(e,t,i){this._isHost=!0,this._successCallback=t,this._errorCallback=i,Rs.host(e,t,i),Hs.addSubscriptions(),this._partyActive=!0,Hs.handlePartyStarted()}join(e,t,i){this._isHost=!1,this._successCallback=t,this._errorCallback=i,Rs.join(e,t,i),Hs.addSubscriptions(),this._partyActive=!0,Hs.handlePartyStarted()}sendToAllPeers(e){for(let t in this._peers){let i=this._peers[t].rtc;i&&i.sendData(e)}}setEventBufferHandler(e,t){e.handleEventArrayBuffer=t}update(e){if(!this._partyActive)return;let t=(new Date).getTime()%js,i=new Uint16Array([t]).buffer;i=mt([i,...Ps.getDataForRTC()]);for(let s in this._peers){let n=this._peers[s];if(n.controller){let i=this._getNextJitterBufferMessage(n.jitterBuffer,t);n.controller.update(e,i)}n.rtc&&n.rtc.sendData(i)}Hs.update()}};class PointerInteractableEntity extends Entity{constructor(){super(),this._pointerInteractable=PointerInteractable.emptyGroup()}setPointerInteractableParent(e){e&&e.addChild(this._pointerInteractable)}removeParentInteractableParent(){this._pointerInteractable.parent&&this._pointerInteractable.parent.removeChild(this._pointerInteractable)}addToScene(e,t){super.addToScene(e),this.setPointerInteractableParent(t)}removeFromScene(){super.removeFromScene(),this.removeParentInteractableParent()}}let Vs=new class{constructor(){this._id=it(),this._pivotPoint=new m,this._interactables=[],this._pageInteractables=[[],[]],this._keyboardPage=0,this._owner=null,this._keysPressed=new Set}init(e){this._scene=e,this._setupKeyboard()}_setupKeyboard(){this._keyboard=new ve.Keyboard({language:"English",fontFamily:yt,fontTexture:vt,fontSize:.035,backgroundColor:Ct.keyboard,backgroundOpacity:1,backspaceTexture:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABF9pVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDIxIDc5LjE1NTc3MiwgMjAxNC8wMS8xMy0xOTo0NDowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOjliMGViMjkzLTQ5YjEtNzk0Ny04ODQ2LTQ5ZmU3OWUzN2VjYiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDoyNTJDRDY5NkEzRTYxMUVBODFDQjk4NTAyMkIzRTQxOCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDoyNTJDRDY5NUEzRTYxMUVBODFDQjk4NTAyMkIzRTQxOCIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxNCBXaW5kb3dzIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6RUVFQjQyNUZBM0UxMTFFQUIwOUNCQUQwM0U4OTg4N0YiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6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",shiftTexture:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABF9pVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDIxIDc5LjE1NTc3MiwgMjAxNC8wMS8xMy0xOTo0NDowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOjliMGViMjkzLTQ5YjEtNzk0Ny04ODQ2LTQ5ZmU3OWUzN2VjYiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo0NzY4M0Y0M0EzRTYxMUVBODc0MkQ2NEU2OUQ0NzMxQSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo0NzY4M0Y0MkEzRTYxMUVBODc0MkQ2NEU2OUQ0NzMxQSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxNCBXaW5kb3dzIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MDYyMjJFRUJBM0UyMTFFQUE1QjVGOThGNjlDRTRBQzgiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6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",enterTexture:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABF9pVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDIxIDc5LjE1NTc3MiwgMjAxNC8wMS8xMy0xOTo0NDowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOjliMGViMjkzLTQ5YjEtNzk0Ny04ODQ2LTQ5ZmU3OWUzN2VjYiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozOEE3NEZCM0EzRTYxMUVBODQ2RTg5N0U1ODk3QTY3MyIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozOEE3NEZCMkEzRTYxMUVBODQ2RTg5N0U1ODk3QTY3MyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxNCBXaW5kb3dzIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6Rjg2REZFNTNBM0UxMTFFQUEyRjRDNThCOUZCMENEMDIiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6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"}),this._keyboard.scale.set(.6,.6,.6);for(let e=0;e<this._keyboard.keys.length;e++)this._setupKey(e);this._pivotPoint.position.setY(-.275),this._pivotPoint.add(this._keyboard)}_setupKey(e){let t,i=this._keyboard.keys[e];i.setupState({state:wi.IDLE,attributes:{offset:0,backgroundColor:Ct.keyboardButtonIdle,backgroundOpacity:1},onSet:()=>{this._keysPressed.delete(i)}}),i.setupState({state:wi.HOVERED,attributes:{offset:0,backgroundColor:Ct.keyboardButtonHovered,backgroundOpacity:1},onSet:()=>{this._keysPressed.delete(i)}}),i.setupState({state:wi.SELECTED,attributes:{offset:0,backgroundColor:Ct.keyboardButtonSelected,backgroundOpacity:1},onSet:()=>{if(this._keysPressed.add(i),i.info.command)switch(i.info.command){case"switch-set":this._keyboard.setNextCharset();break;case"enter":this._owner.handleKey("Enter");break;case"space":this._owner.handleKey(" ");break;case"backspace":this._owner.handleKey("Backspace");break;case"shift":this._keyboard.toggleCase()}else i.info.input&&this._owner.handleKey(i.info.input)}}),t="switch"==i.info.command?new PointerInteractable(i,(()=>{this._switchPanel()})):new PointerInteractable(i),e<=32?this._pageInteractables[0].push(t):this._pageInteractables[1].push(t),this._interactables.push(t)}_switchPanel(){this._keyboard.setNextPanel(),this._owner&&(Ss.removeInteractables(this._pageInteractables[this._keyboardPage]),this._keyboardPage=(this._keyboardPage+1)%2,Ss.addInteractables(this._pageInteractables[this._keyboardPage]))}isKeyPressed(){return 0!=this._keysPressed.size}setOwner(e){this._owner=e,this._scene.add(this._pivotPoint),Ss.addInteractables(this._pageInteractables[this._keyboardPage]),Xi.disable(this._id)}removeOwner(e){this._owner==e&&this._pivotPoint.parent&&(this._owner=null,this._pivotPoint.parent.remove(this._pivotPoint),Ss.removeInteractables(this._interactables),Xi.enable(this._id))}};class TextField extends PointerInteractableEntity{constructor(e){super(),this._onBlur=e.onBlur||null,this._onEnter=e.onEnter||null,this._onUpdate=e.onUpdate||null,this._defaultContent=e.text||"",this._initialContent=e.initialText||"",this._maxLength=e.maxLength||null,this.content="","POINTER"==Be.deviceType&&this._setupEventListeners(),this._object=ThreeMeshUIHelper.createInputBlock(e),this._pointerInteractable=new PointerInteractable(this._object,(()=>{this._activate()})),this._active=!1,this._initialContent&&this.setContent(this._initialContent)}_setupEventListeners(){this._keyListener=e=>{this.handleKey(e.key)},this._clickListener=e=>{Vs.isKeyPressed()||this._pointerInteractable.getState()==wi.SELECTED||this.deactivate()},this._pasteListener=e=>{this._handlePaste(e)}}_addSubscriptions(){tt.subscribe(this._id,He,(e=>{this._id!=e.id&&this.deactivate()})),tt.subscribe(this._id,je,(()=>{this.deactivate()})),"XR"==Be.deviceType&&tt.subscribe(this._id,Re,(()=>{this.deactivate()}))}_removeSubscriptions(){tt.unsubscribe(this._id,He),tt.unsubscribe(this._id,je),"XR"==Be.deviceType&&tt.unsubscribe(this._id,Re)}_handlePaste(e){if(e.clipboardData.types.indexOf("text/plain")<0)return;let t=e.clipboardData.getData("text/plain"),i=!0;for(let e of t)Ft.has(e)||(i=!1);i&&(this.appendToContent(t),e.preventDefault())}handleKey(e){Pi.isKeyCodePressed("ControlLeft")||Pi.isKeyCodePressed("MetaLeft")||(Ft.has(e)?(this.appendToContent(e),this._onUpdate&&this._onUpdate()):"Backspace"==e?(this._removeFromEndOfContent(),this._onUpdate&&this._onUpdate()):"Enter"==e&&(this.deactivate(),this._onEnter&&this._onEnter()))}appendToContent(e){this.content+=e,this._updateDisplayedContentWithCursor()}_removeFromEndOfContent(){this.content.length>0&&(this.content=this.content.slice(0,-1),this._updateDisplayedContentWithCursor())}_updateDisplayedContentWithCursor(){this._updateDisplayedContent(!0)}_updateDisplayedContentWithoutCursor(){this._updateDisplayedContent(!1)}_updateDisplayedContent(e){let t=this.content,i=this._object.children[1];this._maxLength&&t.length>this._maxLength&&(t="..."+t.substring(t.length-this._maxLength)),e&&(t+="|"),i.set({content:t})}_activate(){if("XR"==Be.deviceType){if(this._active)return;this._active=!0,this._updateDisplayedContentWithCursor(),Vs.setOwner(this),this._addSubscriptions()}else if("POINTER"==Be.deviceType){if(this._active)return;this._active=!0,this._updateDisplayedContentWithCursor(),document.addEventListener("keydown",this._keyListener),document.addEventListener("click",this._clickListener),document.addEventListener("paste",this._pasteListener),Be.keyboardLock=!0}else if("MOBILE"==Be.deviceType){let e=prompt("Enter Value",this.content);(e||""==e)&&(this.setContent(e),this._onBlur&&this._onBlur(),this._onEnter&&this._onEnter())}tt.publish(this._id,He,{id:this._id,targetOnlyMenu:!1})}deactivate(){this._active&&(this._active=!1,"XR"==Be.deviceType?(Vs.removeOwner(this),this._updateDisplayedContentWithoutCursor(),ve.update(),this._removeSubscriptions()):"POINTER"==Be.deviceType&&(document.removeEventListener("keydown",this._keyListener),document.removeEventListener("click",this._clickListener),document.removeEventListener("paste",this._pasteListener),Be.keyboardLock=!1,this._updateDisplayedContentWithoutCursor(),ve.update()),this._onBlur&&this._onBlur())}setContent(e){this.content=e;let t=this._object.children[1].content;t!=e&&(t.length>0&&t.endsWith("|")?this._updateDisplayedContentWithCursor():this._updateDisplayedContentWithoutCursor())}setDefaultContent(e){this._defaultContent=e}isBlank(){return""==this.content}reset(){if(this._initialContent)this.setContent(this._initialContent);else{this.content="",this._object.children[1].set({content:this._defaultContent})}}}class NumberField extends TextField{constructor(e){super(e),this._lastValidNumber=e.initialText,this._minValue=st(e.minValue,-1/0),this._maxValue=st(e.maxValue,1/0)}handleKey(e){isFinite(e)||"-"==e||"."==e?(this.appendToContent(e),this._update()):"Backspace"==e?(this._removeFromEndOfContent(),this._update()):"Enter"==e&&(this.deactivate(),this._onEnter&&this._onEnter())}_update(){let e=Number.parseFloat(this.content);isNaN(e)||(e!=this.content&&this.setContent(String(e)),e>=this._minValue&&e<=this._maxValue&&(this._lastValidNumber=String(e))),this._onUpdate&&this._onUpdate()}_updateDisplayedContentWithoutCursor(){let e=Number.parseFloat(this.content);Number.isNaN(e)?this.content=String(this._lastValidNumber):e<this._minValue?this.content=String(this._minValue):e>this._maxValue?this.content=String(this._maxValue):this._lastValidNumber=String(e),this._updateDisplayedContent(!1)}}const Ys=.05;class CheckboxInput extends PointerInteractableEntity{constructor(e){super(),this._onUpdate=e.onUpdate,this._getFromSource=e.getFromSource;let t=e.initialValue||!1,i=e.title||"Missing Field Name...";this._suppressMenuFocusEvent=e.suppressMenuFocusEvent,this._createInputs(t,i)}_createInputs(e,t){this._object=new ve.Block({fontFamily:yt,fontTexture:vt,height:Ys,width:.31,contentDirection:"row",justifyContent:"start",backgroundOpacity:0,offset:0});let i=ThreeMeshUIHelper.createTextBlock({text:t,fontSize:Et,height:Ys,width:.14,margin:0,textAlign:"left"});this._selectBox=ThreeMeshUIHelper.createCheckboxBlock({initialValue:e,height:.04,width:.04,margin:0}),this._object.add(i),this._object.add(this._selectBox);let s=new PointerInteractable(this._selectBox,(()=>{let e=this._selectBox.toggle();this._onUpdate&&this._onUpdate(Boolean(e)),tt.publish(this._id,He,{id:this._id,targetOnlyMenu:this._suppressMenuFocusEvent})}));this._pointerInteractable.addChild(s)}getWidth(){return.31}getHeight(){return Ys}deactivate(){}updateFromSource(){this._getFromSource&&this._getFromSource()!=this._selectBox.getIsChecked()&&this._selectBox.toggle()}}const Xs={ASSET:"ASSET",ASSETS:"ASSETS",ASSET_SELECT:"ASSET_SELECT",COLOR_WHEEL:"COLOR_WHEEL",EDITOR_SETTINGS:"EDITOR_SETTINGS",HANDS:"HANDS",HOST_PARTY:"HOST_PARTY",INSTANCE:"INSTANCE",JOIN_PARTY:"JOIN_PARTY",LIBRARY:"LIBRARY",LIBRARY_SEARCH:"LIBRARY_SEARCH",LOAD_GDRIVE:"LOAD_GDRIVE",MATERIAL:"MATERIAL",MATERIALS:"MATERIALS",NAVIGATION:"NAVIGATION",NEW_MATERIAL:"NEW_MATERIAL",NEW_TEXTURE:"NEW_TEXTURE",PARTY:"PARTY",PEER:"PEER",PROJECT:"PROJECT",SETTINGS:"SETTINGS",SKYBOX:"SKYBOX",TEXTURE:"TEXTURE",TEXTURES:"TEXTURES",TEXT_INPUT:"TEXT_INPUT",UPLOAD:"UPLOAD",USER_SETTINGS:"USER_SETTINGS"},Ws=.05;class ColorInput extends PointerInteractableEntity{constructor(t){super();let i=t.title||"Missing Field Name...";this._lastValue=st(t.initialValue,2800597),this._color=new e.Color(this._lastValue),this._onBlur=t.onBlur,this._onUpdate=t.onUpdate,this._getFromSource=t.getFromSource,this._createInputs(i)}_createInputs(e){this._object=new ve.Block({fontFamily:yt,fontTexture:vt,height:Ws,width:.31,contentDirection:"row",justifyContent:"start",backgroundOpacity:0,offset:0});let t=ThreeMeshUIHelper.createTextBlock({text:e,fontSize:Et,height:Ws,width:.14,margin:0,textAlign:"left"});this._colorBlock=ThreeMeshUIHelper.createColorBlock({height:.04,width:.08,margin:0,selectedColor:this._color}),this._object.add(t),this._object.add(this._colorBlock);let i=new PointerInteractable(this._colorBlock,(()=>{let e=Be.menuController.getPage(Xs.COLOR_WHEEL);e.setContent(this._id,this._color,(e=>{this._color.setHex(e),this._onUpdate&&this._onUpdate(e)}),(()=>{if(e.isDraggingCursors())return;let t=this._lastValue,i=this._color.getHex();this._onBlur&&this._onBlur(t,i),this._lastValue=i,this._color.setHex(this._lastValue)})),Be.menuController.pushPage(Xs.COLOR_WHEEL),tt.publish(this._id,He,{id:this._id,targetOnlyMenu:!0})}));this._pointerInteractable.addChild(i)}getWidth(){return.31}getHeight(){return Ws}deactivate(){}updateFromSource(){if(this._getFromSource){this._lastValue=this._getFromSource(),this._color.setHex(this._lastValue),Be.menuController.getPage(Xs.COLOR_WHEEL).updateColor(this._id,this._color)}}}const Ks=[Oi.TOP,Oi.LEFT,Oi.FRONT,Oi.RIGHT,Oi.BACK,Oi.BOTTOM],Zs={};Zs[Oi.TOP]=0,Zs[Oi.LEFT]=1,Zs[Oi.FRONT]=2,Zs[Oi.RIGHT]=3,Zs[Oi.BACK]=4,Zs[Oi.BOTTOM]=5;class CubeImageInput extends PointerInteractableEntity{constructor(e){if(super(),this._getFromSource=e.getFromSource,this._onUpdate=e.onUpdate,this._lastValues={},e.initialValue)for(let t in e.initialValue)this._lastValues[t]=e.initialValue[t];this._title=e.title||null,this._buttons=[],this._createInputs();for(let e of Ks)this._updateImage(e,this._lastValues[e])}_createInputs(){if(this._object=new ve.Block({fontFamily:yt,fontTexture:vt,height:.2,width:.31,contentDirection:"column",justifyContent:"start",backgroundOpacity:0,offset:0}),this._title){let e=ThreeMeshUIHelper.createTextBlock({text:this._title,fontSize:Et,height:.04,width:.31,margin:0});this._object.add(e)}let e=new ve.Block({height:.064,width:.3,contentDirection:"row",justifyContent:"center",backgroundOpacity:0});for(let t=0;t<Ks.length;t++){let i=ThreeMeshUIHelper.createButtonBlock({backgroundTexture:It.searchIcon,height:.06,width:.06,margin:.002,borderRadius:1e-5}),s=new PointerInteractable(i,(()=>{this._handleInteractable(Ks[t])}));if(this._pointerInteractable.addChild(s),0==t){let e=new ve.Block({height:.064,width:.128,contentDirection:"row",justifyContent:"start",backgroundOpacity:0});e.add(i),this._object.add(e)}else if(t<5)e.add(i);else{this._object.add(e);let t=new ve.Block({height:.064,width:.128,contentDirection:"row",justifyContent:"start",backgroundOpacity:0});t.add(i),this._object.add(t)}this._buttons.push(i)}}_handleInteractable(e){let t=Ii.getLibrary(),i={"null\n":{Name:"Blank"}};for(let e in t){let s=t[e];s.Type==Ee.IMAGE&&(i[e]=s)}Be.menuController.getPage(Xs.ASSET_SELECT).setContent(i,(t=>{"null\n"==t&&(t=null),this._handleAssetSelection(e,t)}),(()=>{this._fileUploadSide=e,zi.triggerUpload()}),(()=>{zi.stopListening()})),Be.menuController.pushPage(Xs.ASSET_SELECT),document.addEventListener(this._eventType,this._clickListener),zi.listenForAssets((e=>{e.length>0&&this._handleAssetSelection(this._fileUploadSide,e[0])}),!1,Ee.IMAGE)}_handleAssetSelection(e,t){"null\n"==t&&(t=null),this._lastValues[e]!=t&&(this._onUpdate&&this._onUpdate(e,t),this._updateImage(e,t)),Be.menuController.back(),tt.publish(this._id,He,{id:this._id,targetOnlyMenu:!0})}_updateImage(e,t){let i=Zs[e];this._lastValues[e]=t,t?this._buttons[i].children[1].set({backgroundTexture:Ii.getTexture(t)}):this._buttons[i].children[1].set({backgroundTexture:It.searchIcon})}getWidth(){return.31}getHeight(){return this._title?.2+.04:.2}deactivate(){}updateFromSource(){if(!this._getFromSource)return;let e=this._getFromSource();for(let t of Ks)this._lastValues[t]!=e[t]&&this._updateImage(t,e[t])}}const qs=.05,Js=.03,$s=.17;class EnumInput extends PointerInteractableEntity{constructor(e){super(),this._getFromSource=e.getFromSource,this._onUpdate=e.onUpdate,this._lastValue=e.initialValue;let t=e.title||"Missing Field Name...",i=e.options||[];this._createInputs(t,i)}_createInputs(e,t){this._object=new ve.Block({fontFamily:yt,fontTexture:vt,height:qs,width:.31,contentDirection:"row",justifyContent:"start",backgroundOpacity:0,offset:0});let i=ThreeMeshUIHelper.createTextBlock({text:e,fontSize:Et,height:qs,width:.13,margin:0,textAlign:"left"});this._optionSelection=ThreeMeshUIHelper.createButtonBlock({text:rt(this._lastValue,13),fontSize:Et,height:Js,width:$s,margin:.01}),this._optionsContainer=new ve.Block({fontFamily:yt,fontTexture:vt,height:Js*t.length,width:$s,backgroundOpacity:0}),this._optionsInteractable=new PointerInteractable(this._optionsContainer);for(let e of t){let t=ThreeMeshUIHelper.createButtonBlock({text:e,fontSize:Et,height:Js,width:$s,margin:0});this._optionsContainer.add(t);let i=new PointerInteractable(t,(()=>{this._handleSelection(e)}));this._optionsInteractable.addChild(i)}this._object.add(i),this._object.add(this._optionSelection),this._selectionInteractable=new PointerInteractable(this._optionSelection,(()=>{0!=t.length&&(this._optionSelection.add(this._optionsContainer),this._selectionInteractable.addChild(this._optionsInteractable))})),this._pointerInteractable.addChild(this._selectionInteractable)}_handleSelection(e){this._lastValue!=e&&(this._onUpdate&&this._onUpdate(e),this._updateOption(e),tt.publish(this._id,He,{id:this._id,targetOnlyMenu:!0})),this.deactivate()}_updateOption(e){this._lastValue=e,e=rt(e,13),this._optionSelection.children[1].set({content:e})}getWidth(){return.31}getHeight(){return qs}deactivate(){this._optionSelection.remove(this._optionsContainer),this._selectionInteractable.removeChild(this._optionsInteractable)}updateFromSource(){if(!this._getFromSource)return;let e=this._getFromSource();e!=this._lastValue&&this._updateOption(e)}}const en=.11,tn=.31,sn=.09,nn=.03,rn=.17,an=.0025;class EulerInput extends PointerInteractableEntity{constructor(e){super(),this._onBlur=e.onBlur,this._onUpdate=e.onUpdate,this._getFromSource=e.getFromSource,this._lastValue=e.initialValue||[0,0,0];let t=e.title||"Missing Field Name...";this._createInputs(t)}_createInputs(e){this._object=new ve.Block({fontFamily:yt,fontTexture:vt,height:en,width:tn,contentDirection:"row",justifyContent:"start",backgroundOpacity:0,margin:0,offset:0});let t=new ve.Block({height:en,width:.22,contentDirection:"column",justifyContent:"center",alignItems:"end",backgroundOpacity:0,margin:0,offset:0}),i=ThreeMeshUIHelper.createTextBlock({text:e,fontSize:Et,height:en,width:sn,margin:0,textAlign:"left"});this._xField=new NumberField({initialText:ln(this._lastValue[0]),fontSize:Et,height:nn,width:rn,margin:an,maxLength:13,onBlur:()=>{this._blur(0)},onUpdate:()=>{this._update(0)}}),this._yField=new NumberField({initialText:ln(this._lastValue[1]),fontSize:Et,height:nn,width:rn,margin:an,maxLength:13,onBlur:()=>{this._blur(1)},onUpdate:()=>{this._update(1)}}),this._zField=new NumberField({initialText:ln(this._lastValue[2]),fontSize:Et,height:nn,width:rn,margin:an,maxLength:13,onBlur:()=>{this._blur(2)},onUpdate:()=>{this._update(2)}});let s=on("X:"),n=on("Y:"),r=on("Z:");this._xField.addToScene(s,this._pointerInteractable),this._yField.addToScene(n,this._pointerInteractable),this._zField.addToScene(r,this._pointerInteractable),this._object.add(i),this._object.add(t),t.add(s),t.add(n),t.add(r)}_update(e){let t=[this.getX(),this.getY(),this.getZ()];isNaN(t[e])||(t.forEach(((e,i)=>t[i]=U.degToRad(e))),this._onUpdate&&this._onUpdate(t))}_blur(e){let t=[this.getX(),this.getY(),this.getZ()];t.forEach(((e,i)=>t[i]=U.degToRad(e))),this._onBlur&&this._onBlur(this._lastValue,t),this._lastValue=t}getX(){return Number.parseFloat(this._xField.content)}getY(){return Number.parseFloat(this._yField.content)}getZ(){return Number.parseFloat(this._zField.content)}getWidth(){return tn}getHeight(){return en}deactivate(){this._xField.deactivate(),this._yField.deactivate(),this._zField.deactivate()}reset(){this._xField.reset(),this._yField.reset(),this._zField.reset()}updateFromSource(){if(!this._getFromSource)return;let e=this._getFromSource();e[0]==this._lastValue[0]&&e[1]==this._lastValue[1]&&e[2]==this._lastValue[2]||(this._lastValue=e,this._xField.setContent(ln(e[0])),this._yField.setContent(ln(e[1])),this._zField.setContent(ln(e[2])))}}function on(e){let t=new ve.Block({height:nn,width:.22,contentDirection:"row",justifyContent:"start",backgroundOpacity:0,margin:an,offset:0}),i=ThreeMeshUIHelper.createTextBlock({text:e,fontSize:Et,height:nn,width:.22-rn,margin:0});return t.add(i),t}function ln(e){return String(ht(U.radToDeg(e),5))}const hn=.05,cn={};cn[wi.IDLE]=Ct.defaultIdle,cn[wi.HOVERED]=Ct.defaultHovered,cn[wi.SELECTED]=Ct.defaultHovered;class ImageInput extends PointerInteractableEntity{constructor(e){super(),this._getFromSource=e.getFromSource,this._onUpdate=e.onUpdate,this._lastValue=e.initialValue;let t=e.title||"Missing Field Name...";this._createInputs(t),this._updateImage(this._lastValue)}_createInputs(e){this._object=new ve.Block({fontFamily:yt,fontTexture:vt,height:hn,width:.31,contentDirection:"row",justifyContent:"start",backgroundOpacity:0,offset:0});let t=ThreeMeshUIHelper.createTextBlock({text:e,fontSize:Et,height:hn,width:.13,margin:0,textAlign:"left"});this._imageSelection=ThreeMeshUIHelper.createButtonBlock({text:" ",fontSize:Et,height:.03,width:.17,margin:.01,idleOpacity:.9,hoveredOpacity:1,selectedOpacity:1}),this._updateImage(),this._object.add(t),this._object.add(this._imageSelection);let i=new PointerInteractable(this._imageSelection,(()=>{let e=Ii.getLibrary(),t={"null\n":{Name:"Blank"}};for(let i in e){let s=e[i];s.Type==Ee.IMAGE&&(t[i]=s)}Be.menuController.getPage(Xs.ASSET_SELECT).setContent(t,(e=>{"null\n"==e&&(e=null),this._handleAssetSelection(e)}),(()=>{zi.triggerUpload()}),(()=>{zi.stopListening()})),Be.menuController.pushPage(Xs.ASSET_SELECT),zi.listenForAssets((e=>{e.length>0&&this._handleAssetSelection(e[0])}),!1,Ee.IMAGE)}));this._pointerInteractable.addChild(i)}_handleAssetSelection(e){"null\n"==e&&(e=null),this._lastValue!=e&&(this._onUpdate&&this._onUpdate(e),this._updateImage(e)),Be.menuController.back(),tt.publish(this._id,He,{id:this._id,targetOnlyMenu:!0})}_updateImage(e){this._lastValue=e;let t=this._lastValue?Ii.getAssetName(this._lastValue):" ";if(t=rt(t,13),this._imageSelection.children[1].set({content:t}),this._lastValue){for(let e in wi){this._imageSelection.states[e].attributes.backgroundColor=Ct.white}this._imageSelection.set({backgroundTexture:Ii.getTexture(this._lastValue),backgroundColor:Ct.white})}else{for(let e in wi){this._imageSelection.states[e].attributes.backgroundColor=cn[e]}this._imageSelection.set({backgroundTexture:null,backgroundColor:Ct.defaultIdle})}}getWidth(){return.31}getHeight(){return hn}deactivate(){}updateFromSource(){if(!this._getFromSource)return;let e=this._getFromSource();this._lastValue!=e&&this._updateImage(e)}}const dn=.05,An={},un={};un[wi.IDLE]=Ct.defaultIdle,un[wi.HOVERED]=Ct.defaultHovered,un[wi.SELECTED]=Ct.defaultHovered;class MaterialInput extends PointerInteractableEntity{constructor(e){super(),this._getFromSource=e.getFromSource,this._onUpdate=e.onUpdate,this._lastValue=e.initialValue;let t=e.title||"Missing Field Name...";this._createInputs(t),this._updateMaterial(this._lastValue)}_createInputs(e){this._object=new ve.Block({fontFamily:yt,fontTexture:vt,height:dn,width:.31,contentDirection:"row",justifyContent:"start",backgroundOpacity:0,offset:0});let t=ThreeMeshUIHelper.createTextBlock({text:e,fontSize:Et,height:dn,width:.13,margin:0,textAlign:"left"});this._materialBlock=ThreeMeshUIHelper.createButtonBlock({text:" ",fontSize:Et,height:.03,width:.13,margin:.01,idleBackgroundColor:Ct.white,hoveredBackgroundColor:Ct.white,selectedBackgroundColor:Ct.white,idleOpacity:.9,hoveredOpacity:1,selectedOpacity:1}),this._editButton=ThreeMeshUIHelper.createButtonBlock({backgroundTexture:It.pencilIcon,height:.03,width:.03,margin:0}),this._object.add(t),this._object.add(this._materialBlock),this._object.add(this._editButton);let i=new PointerInteractable(this._materialBlock,(()=>{let e=Os.getMaterials(),t={"null\n":{Name:"Blank"}};for(let i in e)t[i]={Name:e[i].getName()};Be.menuController.getPage(Xs.ASSET_SELECT).setContent(t,(e=>{"null\n"==e&&(e=null),this._handleMaterialSelection(e)}),(()=>{this._selectNewMaterial()})),Be.menuController.pushPage(Xs.ASSET_SELECT)}));this._editInteractable=new PointerInteractable(this._editButton,(()=>{if(!this._lastValue)return;let e=Os.getMaterial(this._lastValue);Be.menuController.getPage(Xs.MATERIAL).setMaterial(e),Be.menuController.pushPage(Xs.MATERIAL)})),this._pointerInteractable.addChild(i)}_selectNewMaterial(){Be.menuController.getPage(Xs.NEW_MATERIAL).setContent((e=>{this._handleMaterialSelection(e.getId()),Be.menuController.getPage(Xs.MATERIAL).setMaterial(e),Be.menuController.pushPage(Xs.MATERIAL)})),Be.menuController.pushPage(Xs.NEW_MATERIAL)}_handleMaterialSelection(e){"null\n"==e&&(e=null),this._lastValue!=e&&(this._onUpdate&&this._onUpdate(e),this._updateMaterial(e)),Be.menuController.back(),tt.publish(this._id,He,{id:this._id,targetOnlyMenu:!0})}_updateMaterial(e){this._lastValue=e;let t=Os.getMaterial(this._lastValue),i=t?t.getName():" ";if(i=rt(i,9),this._materialBlock.children[1].set({content:i}),t){let e=t.getMaterial().color||Ct.white;for(let t in wi){this._materialBlock.states[t].attributes.backgroundColor=e}this._updateTextureAndColor(t.getSampleTexture(),e),this._pointerInteractable.addChild(this._editInteractable),this._editButton.visible=!0}else{for(let e in wi){this._materialBlock.states[e].attributes.backgroundColor=un[e]}this._updateTextureAndColor(null,Ct.defaultIdle),this._pointerInteractable.removeChild(this._editInteractable),this._editButton.visible=!1}}_updateTextureAndColor(e,t){this._materialBlock.backgroundTexture!=e&&this._materialBlock.set({backgroundTexture:e}),this._materialBlock.backgroundColor!=t&&this._materialBlock.set({backgroundColor:t}),this._materialBlock.backgroundColor.getHSL(An);let i=!e&&An.l>.85?Ct.black:Ct.white;this._materialBlock.children[1].fontColor!=i&&this._materialBlock.children[1].set({fontColor:i})}_addSubscriptions(){tt.subscribe(this._id,Ue,(e=>{this._lastValue==e.asset.getId()&&this.updateFromSource()}))}_removeSubscriptions(){tt.unsubscribe(this._id,Ue)}getWidth(){return.31}getHeight(){return dn}deactivate(){}updateFromSource(){this._getFromSource&&this._updateMaterial(this._getFromSource())}addToScene(e,t){this.updateFromSource(),this._addSubscriptions(),super.addToScene(e,t)}removeFromScene(){this._removeSubscriptions(),super.removeFromScene()}}const pn=.05;class NumberInput extends PointerInteractableEntity{constructor(e){super(),this._onBlur=e.onBlur,this._onUpdate=e.onUpdate,this._getFromSource=e.getFromSource,this._minValue=st(e.minValue,-1/0),this._maxValue=st(e.maxValue,1/0),this._lastValue=e.initialValue||0;let t=e.title||"Missing Field Name...";this._createInput(t)}_createInput(e){this._object=new ve.Block({fontFamily:yt,fontTexture:vt,height:pn,width:.31,contentDirection:"row",justifyContent:"start",backgroundOpacity:0,offset:0});let t=ThreeMeshUIHelper.createTextBlock({text:e,fontSize:Et,height:pn,width:.13,margin:0,textAlign:"left"});this._numberField=new NumberField({initialText:String(this._lastValue),fontSize:Et,height:.03,width:.17,margin:.01,maxLength:13,minValue:this._minValue,maxValue:this._maxValue,onBlur:()=>{this._blur()},onUpdate:()=>{this._update()}}),this._object.add(t),this._numberField.addToScene(this._object,this._pointerInteractable)}_update(){this._onUpdate&&this._validate()&&this._onUpdate(this.getValue())}_blur(){let e=this.getValue();this._onBlur&&this._onBlur(this._lastValue,e),this._lastValue=e}_validate(){let e=this.getValue();return!isNaN(e)&&e<=this._maxValue&&e>=this._minValue}getValue(){return Number.parseFloat(this._numberField.content)}getWidth(){return.31}getHeight(){return pn}deactivate(){this._numberField.deactivate()}reset(){this._numberField.reset()}updateFromSource(){this._getFromSource&&(this._lastValue=this._getFromSource(),this._numberField.setContent(String(this._lastValue)))}}const gn="BASIC",mn="CUBE",_n=.05,fn={};fn[wi.IDLE]=Ct.defaultIdle,fn[wi.HOVERED]=Ct.defaultHovered,fn[wi.SELECTED]=Ct.defaultHovered;class TextureInput extends PointerInteractableEntity{constructor(e){super(),this._getFromSource=e.getFromSource,this._onUpdate=e.onUpdate,this._lastValue=e.initialValue,this._filter=e.filter;let t=e.title||"Missing Field Name...";this._createInputs(t),this._updateTexture(this._lastValue)}_createInputs(e){this._object=new ve.Block({fontFamily:yt,fontTexture:vt,height:_n,width:.31,contentDirection:"row",justifyContent:"start",backgroundOpacity:0,offset:0});let t=ThreeMeshUIHelper.createTextBlock({text:e,fontSize:Et,height:_n,width:.13,margin:0,textAlign:"left"});this._textureSelection=ThreeMeshUIHelper.createButtonBlock({text:" ",fontSize:Et,height:.03,width:.13,margin:.01,idleOpacity:.9,hoveredOpacity:1,selectedOpacity:1}),this._editButton=ThreeMeshUIHelper.createButtonBlock({backgroundTexture:It.pencilIcon,height:.03,width:.03,margin:0}),this._object.add(t),this._object.add(this._textureSelection),this._object.add(this._editButton);let i=new PointerInteractable(this._textureSelection,(()=>{let e=Ls.getTextures(),t={"null\n":{Name:"Blank"}};for(let i in e)this._filter&&this._filter!=e[i].getTextureType()||(t[i]={Name:e[i].getName()});Be.menuController.getPage(Xs.ASSET_SELECT).setContent(t,(e=>{"null\n"==e&&(e=null),this._handleTextureSelection(e)}),(()=>{this._selectNewTexture()})),Be.menuController.pushPage(Xs.ASSET_SELECT)}));this._editInteractable=new PointerInteractable(this._editButton,(()=>{if(!this._lastValue)return;let e=Ls.getTexture(this._lastValue);Be.menuController.getPage(Xs.TEXTURE).setTexture(e),Be.menuController.pushPage(Xs.TEXTURE)})),this._pointerInteractable.addChild(i)}_selectNewTexture(){if(this._filter){let e=Ls.addNewTexture(this._filter);this._handleTextureSelection(e.getId()),Be.menuController.getPage(Xs.TEXTURE).setTexture(e),Be.menuController.pushPage(Xs.TEXTURE)}else{Be.menuController.getPage(Xs.NEW_TEXTURE).setContent((e=>{this._handleTextureSelection(e.getId()),Be.menuController.getPage(Xs.TEXTURE).setTexture(e),Be.menuController.pushPage(Xs.TEXTURE)})),Be.menuController.pushPage(Xs.NEW_TEXTURE)}}_handleTextureSelection(e){"null\n"==e&&(e=null),this._lastValue!=e&&(this._onUpdate&&this._onUpdate(e),this._updateTexture(e)),Be.menuController.back(),tt.publish(this._id,He,{id:this._id,targetOnlyMenu:!0})}_updateTexture(e){this._lastValue=e;let t=Ls.getTexture(this._lastValue),i=t?t.getName():" ";if(i=rt(i,9),this._textureSelection.children[1].set({content:i}),t){for(let e in wi){this._textureSelection.states[e].attributes.backgroundColor=Ct.white}this._updateTextureAndColor(t.getPreviewTexture(),Ct.white),this._pointerInteractable.addChild(this._editInteractable),this._editButton.visible=!0}else{for(let e in wi){this._textureSelection.states[e].attributes.backgroundColor=fn[e]}this._updateTextureAndColor(null,Ct.defaultIdle),this._pointerInteractable.removeChild(this._editInteractable),this._editButton.visible=!1}}_updateTextureAndColor(e,t){this._textureSelection.backgroundTexture!=e&&this._textureSelection.set({backgroundTexture:e}),this._textureSelection.backgroundColor!=t&&this._textureSelection.set({backgroundColor:t})}getWidth(){return.31}getHeight(){return _n}deactivate(){}updateFromSource(){this._getFromSource&&this._updateTexture(this._getFromSource())}}const bn=.085,In=.31,wn=.09,Cn=.03,yn=.17,vn=.0025;class Vector2Input extends PointerInteractableEntity{constructor(e){super(),this._onBlur=e.onBlur,this._onUpdate=e.onUpdate,this._getFromSource=e.getFromSource,this._lastValue=e.initialValue||[0,0];let t=e.title||"Missing Field Name...";this._createInputs(t)}_createInputs(e){this._object=new ve.Block({fontFamily:yt,fontTexture:vt,height:bn,width:In,contentDirection:"row",justifyContent:"start",backgroundOpacity:0,margin:0,offset:0});let t=new ve.Block({height:bn,width:.22,contentDirection:"column",justifyContent:"center",alignItems:"end",backgroundOpacity:0,margin:0,offset:0}),i=ThreeMeshUIHelper.createTextBlock({text:e,fontSize:Et,height:bn,width:wn,margin:0,textAlign:"left"});this._xField=new NumberField({initialText:String(this._lastValue[0]),fontSize:Et,height:Cn,width:yn,margin:vn,maxLength:13,onBlur:()=>{this._blur(0)},onUpdate:()=>{this._update(0)}}),this._yField=new NumberField({initialText:String(this._lastValue[1]),fontSize:Et,height:Cn,width:yn,margin:vn,maxLength:13,onBlur:()=>{this._blur(1)},onUpdate:()=>{this._update(1)}});let s=Bn("X:"),n=Bn("Y:");this._xField.addToScene(s,this._pointerInteractable),this._yField.addToScene(n,this._pointerInteractable),this._object.add(i),this._object.add(t),t.add(s),t.add(n)}_update(e){let t=[this.getX(),this.getY()];isNaN(t[e])||this._onUpdate&&this._onUpdate(t)}_blur(e){let t=[this.getX(),this.getY()];this._onBlur&&this._onBlur(this._lastValue,t),this._lastValue=t}getX(){return Number.parseFloat(this._xField.content)}getY(){return Number.parseFloat(this._yField.content)}getWidth(){return In}getHeight(){return bn}deactivate(){this._xField.deactivate(),this._yField.deactivate()}reset(){this._xField.reset(),this._yField.reset()}updateFromSource(){if(!this._getFromSource)return;let e=this._getFromSource();e[0]==this._lastValue[0]&&e[1]==this._lastValue[1]||(this._lastValue=e,this._xField.setContent(String(e[0])),this._yField.setContent(String(e[1])))}}function Bn(e){let t=new ve.Block({height:Cn,width:.22,contentDirection:"row",justifyContent:"start",backgroundOpacity:0,margin:vn,offset:0}),i=ThreeMeshUIHelper.createTextBlock({text:e,fontSize:Et,height:Cn,width:.22-yn,margin:0});return t.add(i),t}const En=.11,Sn=.31,Mn=.09,xn=.03,Tn=.17,Pn=.0025;class Vector3Input extends PointerInteractableEntity{constructor(e){super(),this._onBlur=e.onBlur,this._onUpdate=e.onUpdate,this._getFromSource=e.getFromSource,this._lastValue=e.initialValue||[0,0,0];let t=e.title||"Missing Field Name...";this._createInputs(t)}_createInputs(e){this._object=new ve.Block({fontFamily:yt,fontTexture:vt,height:En,width:Sn,contentDirection:"row",justifyContent:"start",backgroundOpacity:0,margin:0,offset:0});let t=new ve.Block({height:En,width:.22,contentDirection:"column",justifyContent:"center",alignItems:"end",backgroundOpacity:0,margin:0,offset:0}),i=ThreeMeshUIHelper.createTextBlock({text:e,fontSize:Et,height:En,width:Mn,margin:0,textAlign:"left"});this._xField=new NumberField({initialText:String(this._lastValue[0]),fontSize:Et,height:xn,width:Tn,margin:Pn,maxLength:13,onBlur:()=>{this._blur(0)},onUpdate:()=>{this._update(0)}}),this._yField=new NumberField({initialText:String(this._lastValue[1]),fontSize:Et,height:xn,width:Tn,margin:Pn,maxLength:13,onBlur:()=>{this._blur(1)},onUpdate:()=>{this._update(1)}}),this._zField=new NumberField({initialText:String(this._lastValue[2]),fontSize:Et,height:xn,width:Tn,margin:Pn,maxLength:13,onBlur:()=>{this._blur(2)},onUpdate:()=>{this._update(2)}});let s=kn("X:"),n=kn("Y:"),r=kn("Z:");this._xField.addToScene(s,this._pointerInteractable),this._yField.addToScene(n,this._pointerInteractable),this._zField.addToScene(r,this._pointerInteractable),this._object.add(i),this._object.add(t),t.add(s),t.add(n),t.add(r)}_update(e){let t=[this.getX(),this.getY(),this.getZ()];isNaN(t[e])||this._onUpdate&&this._onUpdate(t)}_blur(e){let t=[this.getX(),this.getY(),this.getZ()];this._onBlur&&this._onBlur(this._lastValue,t),this._lastValue=t}getX(){return Number.parseFloat(this._xField.content)}getY(){return Number.parseFloat(this._yField.content)}getZ(){return Number.parseFloat(this._zField.content)}getWidth(){return Sn}getHeight(){return En}deactivate(){this._xField.deactivate(),this._yField.deactivate(),this._zField.deactivate()}reset(){this._xField.reset(),this._yField.reset(),this._zField.reset()}updateFromSource(){if(!this._getFromSource)return;let e=this._getFromSource();e[0]==this._lastValue[0]&&e[1]==this._lastValue[1]&&e[2]==this._lastValue[2]||(this._lastValue=e,this._xField.setContent(String(e[0])),this._yField.setContent(String(e[1])),this._zField.setContent(String(e[2])))}}function kn(e){let t=new ve.Block({height:xn,width:.22,contentDirection:"row",justifyContent:"start",backgroundOpacity:0,margin:Pn,offset:0}),i=ThreeMeshUIHelper.createTextBlock({text:e,fontSize:Et,height:xn,width:.22-Tn,margin:0});return t.add(i),t}const Dn={CheckboxInput:"_createCheckboxInput",ColorInput:"_createColorInput",CubeImageInput:"_createCubeImageInput",EnumInput:"_createEnumInput",EulerInput:"_createEulerInput",ImageInput:"_createImageInput",MaterialInput:"_createMaterialInput",NumberInput:"_createNumberInput",TextureInput:"_createTextureInput",Vector2Input:"_createVector2Input",Vector3Input:"_createVector3Input"};class EditorHelper{constructor(e,t){this._asset=e,this._id=e.getId(),this._updatedTopic=t}_publish(e){let t={asset:this._asset,fields:e};tt.publish(this._id,this._updatedTopic,t)}_updateCubeImage(e,t,i,s,n,r){let a=at(e),o=this._asset["get"+a]()[t];o!=i&&(this._asset["set"+a](i,t),n||this._publish([e])),r||(r=o),s||r==i||Xi.addAction((()=>{this._updateCubeImage(e,t,r,!0,n),this.updateMenuField(e)}),(()=>{this._updateCubeImage(e,t,i,!0,n),this.updateMenuField(e)}))}_updateEuler(e,t,i,s,n){this._updateVector3(e,t,i,s,n)}_updateVector2(e,t,i,s,n){this._updateVector3(e,t,i,s,n)}_updateVector3(e,t,i,s,n){let r=at(e),a=this._asset["get"+r]();a.reduce(((e,i,s)=>e&&t[s]==i),!0)||(this._asset["set"+r](t),s||this._publish([e])),n||(n=a),i||n.reduce(((e,i,s)=>e&&t[s]==i),!0)||Xi.addAction((()=>{this._updateVector3(e,n,!0,s),this.updateMenuField(e)}),(()=>{this._updateVector3(e,t,!0,s),this.updateMenuField(e)}))}_updateParameter(e,t,i,s,n){let r=at(e),a=this._asset["get"+r]();a!=t&&(this._asset["set"+r](t),s||this._publish([e])),null==n&&(n=a),i||n==t||Xi.addAction((()=>{this._updateParameter(e,n,!0,s),this.updateMenuField(e)}),(()=>{this._updateParameter(e,t,!0,s),this.updateMenuField(e)}))}updateMenuField(e){if(!this._menuFields)return;let t=this._menuFieldsMap[e];t&&t.updateFromSource()}updateName(e,t){let i=this._asset.getName();i!=e&&(this._asset.setName(e),this._publish(["name"]),t||Xi.addAction((()=>{this.updateName(i,!0)}),(()=>{this.updateName(e,!0)})))}getMenuFields(e){if(this._menuFields)return this._menuFields;this._menuFieldsMap=this._getMenuFieldsMap();let t=[];for(let i of e)i.parameter in this._menuFieldsMap&&t.push(this._menuFieldsMap[i.parameter]);return this._menuFields=t,t}_getMenuFieldsMap(){return{}}_createStandardInput(e){if(e.type.name in Dn)return this[Dn[e.type.name]](e)}_createCheckboxInput(e){let t="get"+at(e.parameter);return new CheckboxInput({title:e.name,initialValue:this._asset[t](),suppressMenuFocusEvent:1==e.suppressMenuFocusEvent,getFromSource:()=>this._asset[t](),onUpdate:t=>{this._updateParameter(e.parameter,t)}})}_createColorInput(e){let t="get"+at(e.parameter);return new ColorInput({title:e.name,initialValue:this._asset[t](),getFromSource:()=>this._asset[t](),onBlur:(t,i)=>{this._updateParameter(e.parameter,i,!1,!1,t)},onUpdate:t=>{this._updateParameter(e.parameter,t,!0)}})}_createCubeImageInput(e){let t="get"+at(e.parameter);return new CubeImageInput({title:e.name,initialValue:this._asset[t](),getFromSource:()=>this._asset[t](),onUpdate:(t,i)=>{this._updateCubeImage(e.parameter,t,i)}})}_createEnumInput(e){let t="get"+at(e.parameter);return new EnumInput({title:e.name,initialValue:e.reverseMap[this._asset[t]()],options:e.options,getFromSource:()=>e.reverseMap[this._asset[t]()],onUpdate:t=>{this._updateParameter(e.parameter,e.map[t])}})}_createEulerInput(e){let t="get"+at(e.parameter);return new EulerInput({title:e.name,initialValue:this._asset[t](),getFromSource:()=>this._asset[t](),onBlur:(t,i)=>{this._updateEuler(e.parameter,i,!1,!1,t)},onUpdate:t=>{this._updateEuler(e.parameter,t,!0)}})}_createImageInput(e){let t="get"+at(e.parameter);return new ImageInput({title:e.name,initialValue:this._asset[t](),getFromSource:()=>this._asset[t](),onUpdate:t=>{this._updateParameter(e.parameter,t)}})}_createMaterialInput(e){let t="get"+at(e.parameter);return new MaterialInput({title:e.name,initialValue:this._asset[t](),getFromSource:()=>this._asset[t](),onUpdate:t=>{this._updateParameter(e.parameter,t)}})}_createNumberInput(e){let t="get"+at(e.parameter);return new NumberInput({title:e.name,minValue:e.min,maxValue:e.max,initialValue:this._asset[t](),getFromSource:()=>this._asset[t](),onBlur:(t,i)=>{this._updateParameter(e.parameter,i,!1,!1,t)},onUpdate:t=>{this._updateParameter(e.parameter,t,!0)}})}_createTextureInput(e){let t="get"+at(e.parameter);return new TextureInput({title:e.name,filter:e.filter,initialValue:this._asset[t](),getFromSource:()=>this._asset[t](),onUpdate:t=>{this._updateParameter(e.parameter,t)}})}_createVector2Input(e){let t="get"+at(e.parameter);return new Vector2Input({title:e.name,initialValue:this._asset[t](),getFromSource:()=>this._asset[t](),onBlur:(t,i)=>{this._updateVector2(e.parameter,i,!1,!1,t)},onUpdate:t=>{this._updateVector2(e.parameter,t,!0)}})}_createVector3Input(e){let t="get"+at(e.parameter);return new Vector3Input({title:e.name,initialValue:this._asset[t](),getFromSource:()=>this._asset[t](),onBlur:(t,i)=>{this._updateVector3(e.parameter,i,!1,!1,t)},onUpdate:t=>{this._updateVector3(e.parameter,t,!0)}})}}const Fn="TOOL_AGNOSTIC",Qn=[Fn,yi.EDIT,yi.COPY_PASTE,yi.DELETE],Rn=["position","rotation","scale"],On=[{parameter:"position",name:"Position",type:Vector3Input},{parameter:"rotation",name:"Rotation",type:EulerInput},{parameter:"scale",name:"Scale",type:Vector3Input},{parameter:"visualEdit",name:"Visually Edit",type:CheckboxInput}];class AssetHelper extends EditorHelper{constructor(t){super(t,Qe),this._object=t.getObject(),this._attachedPeers=new Set,this._gripInteractables={},this._pointerInteractables={};for(let e of Qn)this._pointerInteractables[e]=[],this._gripInteractables[e]=[];this._boundingBox=new e.Box3,this._boundingBoxObj=new Box3Helper(this._boundingBox),this._createInteractables()}_createInteractables(){if("XR"==Be.deviceType){let e=new GripInteractable(this._object,(e=>{Es.attach(this._asset,e)}),(e=>{Es.detach(e)}));this._gripInteractables[yi.EDIT].push(e);let t=new GripInteractable(this._object,(e=>{Gn.deleteAssetInstance(this._asset)}),(()=>{}));this._gripInteractables[yi.DELETE].push(t),t=new PointerInteractable(this._object,(e=>{Gn.deleteAssetInstance(this._asset)}),!0,!0),this._pointerInteractables[yi.DELETE].push(t);let i=new GripInteractable(this._object,(e=>{ks.copy(this._asset)}),(()=>{}),Ci.LEFT);this._gripInteractables[yi.COPY_PASTE].push(i),i=new PointerInteractable(this._object,(e=>{ks.copy(this._asset)}),!0,!0,Ci.LEFT),this._pointerInteractables[yi.COPY_PASTE].push(i)}else{this._object.states=wi,this._object.setState=e=>{e==wi.HOVERED&&this._object!=Es.getObject()?(this._boundingBox.setFromObject(this._object),Be.scene.add(this._boundingBoxObj)):Be.scene.remove(this._boundingBoxObj)};let e=new PointerInteractable(this._object,(()=>{Es.attach(this._asset)}),!0,!0);this._pointerInteractables[Fn].push(e)}}_addInteractables(){for(let e of Qn){let t=e!=Fn?e:null;Ds.addInteractables(this._gripInteractables[e],t),Ss.addInteractables(this._pointerInteractables[e],t)}}_removeInteractables(){for(let e of Qn){let t=e!=Fn?e:null;Ds.removeInteractables(this._gripInteractables[e],t),Ss.removeInteractables(this._pointerInteractables[e],t)}}updateVisualEdit(e,t,i){e!=this._asset.visualEdit&&(this._asset.visualEdit=e,e?this._object.parent&&0==this._attachedPeers.size&&this._addInteractables():this._removeInteractables(),i||this._publish(["visualEdit"]),t||Xi.addAction((()=>{this.updateVisualEdit(!e,!0,i),this.updateMenuField("visualEdit")}),(()=>{this.updateVisualEdit(e,!0,i),this.updateMenuField("visualEdit")})))}attachToPeer(e,t){if(this._attachedPeers.add(e.id+":"+t.option),t.isXR){if(1!=this._attachedPeers.size)return Be.scene.attach(this._object),this._asset.setPosition(t.position),void this._asset.setRotation(t.rotation);t.option in Ci&&e.controller&&(e.controller.hands[t.option].attach(this._object),this._asset.setPosition(t.position),this._asset.setRotation(t.rotation))}this._asset.visualEdit&&this._removeInteractables()}detachFromPeer(e,t){if(this._attachedPeers.delete(e.id+":"+t.option),t.isXR){if(0!=this._attachedPeers.size){let e=this._attachedPeers.values().next().value,[i,s]=e.split(":"),n=zs.getPeer(i);return void(s in Ci&&n&&n.controller&&(n.controller.hands[s].attach(this._object),this._asset.setPosition(t.position),this._asset.setRotation(t.rotation)))}Be.scene.attach(this._object),this._asset.setPosition(t.position),this._asset.setRotation(t.rotation)}this._asset.visualEdit&&this._addInteractables()}getObjectTransformation(){return{position:this._object.position.toArray(),rotation:this._object.rotation.toArray(),scale:this._object.scale.toArray()}}setObjectTransformation(e,t,i,s){let n=[];for(let i of Rn){let s=e?e[i]:this._object[i].toArray(),r=t[i];s.reduce(((e,t,i)=>e&&r[i]==t),!0)||(this._object[i].fromArray(r),this.updateMenuField(i),n.push(i))}0!=n.length&&(s||this._publish(n),i||Xi.addAction((()=>{this.setObjectTransformation(null,e,!0,s)}),(()=>{this.setObjectTransformation(null,t,!0,s)})))}roundAttributes(e){let t=[];for(let e of Rn)this._object[e].roundWithPrecision(5)&&(t.push(e),this.updateMenuField(e));0!=t.length&&(e||this._publish(t))}place(e){let t=e.point;this._object.position.copy(t),this.roundAttributes(!0)}_getMenuFieldsMap(){let e=super._getMenuFieldsMap();for(let t of On)if(!(t.parameter in e))if(t.type==CheckboxInput)e[t.parameter]=new CheckboxInput({title:t.name,initialValue:this._asset.visualEdit,getFromSource:()=>this._asset.visualEdit,onUpdate:e=>{this.updateVisualEdit(e)}});else{let i=this._createStandardInput(t);i&&(e[t.parameter]=i)}return e}addToScene(e){!this._asset.visualEdit||this._attachedPeers.size>0||this._addInteractables()}removeFromScene(){Be.scene.remove(this._boundingBoxObj),ot(this._boundingBoxObj),this._removeInteractables()}}class Asset extends Entity{constructor(e={}){super(),this._id=e.id||this._id,this._assetId=e.assetId,this._name="name"in e?e.name:"Object";let t=e.position?e.position:[0,0,0],i=e.rotation?e.rotation:[0,0,0],s=e.scale?e.scale:[1,1,1];this.visualEdit=e.visualEdit||!1,this._object.position.fromArray(t),this._object.rotation.fromArray(i),this._object.scale.fromArray(s),Be.isEditor&&this._createEditorHelper()}_createEditorHelper(){this._editorHelper=new AssetHelper(this)}makeTranslucent(){this._object.traverse((function(t){if(t instanceof e.Mesh&&t.material)if(Array.isArray(t.material))for(let e=0;e<t.material.length;e++){let i=t.material[e],s=i.clone();Ln(s),s.userData.oldMaterial=i,t.material[e]=s}else{let e=t.material.clone();Ln(e),e.userData.oldMaterial=t.material,t.material=e}}))}returnTransparency(){this._object.traverse((function(t){if(t instanceof e.Mesh&&t.material)if(Array.isArray(t.material))for(let e=0;e<t.material.length;e++){let i=t.material[e];t.material[e]=i.userData.oldMaterial,lt(i)}else{let e=t.material;t.material=t.material.userData.oldMaterial,lt(e)}}))}_fetchCloneParams(e){let t=this.exportParams(),i=null!=e?e:this.visualEdit,s=this._object.getWorldPosition(St[0]).toArray(),n=xt.setFromQuaternion(this._object.getWorldQuaternion(Tt)).toArray();return t.visualEdit=i,t.position=s,t.rotation=n,delete t.id,t}preview(){let e=this.exportParams();return e.visualEdit=!1,e.isPreview=!0,delete e.id,new this.constructor(e)}exportParams(){return{id:this._id,name:this._name,assetId:this._assetId,position:this.getPosition(),rotation:this.getRotation(),scale:this.getScale(),visualEdit:this.visualEdit}}getAssetId(){return this._assetId}getEditorHelper(){return this._editorHelper}getId(){return this._id}getName(){return this._name}getPosition(){return this._object.position.toArray()}getRotation(){return this._object.rotation.toArray()}getScale(){return this._object.scale.toArray()}getVisualEdit(){return this.visualEdit}setPosition(e){this._object.position.fromArray(e)}setRotation(e){this._object.rotation.fromArray(e)}setScale(e){this._object.scale.fromArray(e)}setVisualEdit(e){this._editorHelper?this._editorHelper.updateVisualEdit(e,!0,!0):this.visualEdit=e}setName(e){null!=e&&this._name!=e&&(this._name=e)}addToScene(e){super.addToScene(e),Be.isEditor&&this._editorHelper.addToScene()}removeFromScene(){super.removeFromScene(),Be.isEditor&&this._editorHelper.removeFromScene()}}function Ln(e){e.opacity=.5,e.transparent=!0}const Nn=[{parameter:"visualEdit"},{parameter:"doubleSided",name:"Double Sided",suppressMenuFocusEvent:!0,type:CheckboxInput},{parameter:"position"},{parameter:"rotation"},{parameter:"scale"}];class ClampedTexturePlaneHelper extends AssetHelper{constructor(e){super(e)}place(e){let t=e.object,i=e.point;e.face,t.updateMatrixWorld();let s=e.face.normal.clone().transformDirection(t.matrixWorld).clampLength(0,.001);Be.camera.getWorldDirection(St[0]).dot(s)>0&&s.negate(),this._object.position.copy(s).add(i),this._object.lookAt(s.add(this._object.position)),this.roundAttributes(!0)}getMenuFields(){return super.getMenuFields(Nn)}_getMenuFieldsMap(){let e=super._getMenuFieldsMap();return e.doubleSided=this._createCheckboxInput({name:"Double Sided",parameter:"doubleSided",suppressMenuFocusEvent:!0}),e}}class ClampedTexturePlane extends Asset{constructor(e={}){super(e),this._createMesh(e.assetId),this._doubleSided=!(0==e.doubleSided),this._doubleSided||this._updateDoubleSided(!1),this._transparent=0!=e.transparent,this._transparent||this._updateTransparent(!1),e.isPreview&&this.makeTranslucent()}_createEditorHelper(){this._editorHelper=new ClampedTexturePlaneHelper(this)}_createMesh(e){this._mesh=Ii.cloneMesh(e),this._object.add(this._mesh)}_updateTransparent(e){this._materialAlreadyCloned||(this._mesh.material=this._mesh.material.clone(),this._materialAlreadyCloned=!0),this._mesh.material.transparent=e,this._transparent=e}clone(e){let t=this._fetchCloneParams(e);return Gn.addImage(t)}exportParams(){let t=super.exportParams();return t.doubleSided=this._mesh.material.side==e.DoubleSide,t.transparent=this._transparent,t}getDoubleSided(){return this._mesh.material.side==e.DoubleSide}setDoubleSided(t){t!=this._doubleSided&&(this._materialAlreadyCloned||(this._mesh.material=this._mesh.material.clone(),this._materialAlreadyCloned=!0),this._mesh.material.side=t?e.DoubleSide:e.FrontSide,this._doubleSided=t)}}const Un=[{parameter:"visualEdit"},{parameter:"position"},{parameter:"rotation"},{parameter:"scale"}];class GLTFAssetHelper extends AssetHelper{constructor(e){super(e)}getMenuFields(){return super.getMenuFields(Un)}}class GLTFAsset extends Asset{constructor(e={}){super(e),this._createMesh(e.assetId),e.isPreview&&this.makeTranslucent()}_createEditorHelper(){this._editorHelper=new GLTFAssetHelper(this)}_createMesh(e){this._mesh=Ii.cloneMesh(e),this._object.add(this._mesh)}clone(e){let t=this._fetchCloneParams(e);return Gn.addGLTF(t)}}let Hn=new class{constructor(){this._lightClassMap={},this._shapeClassMap={}}init(e){this._scene=e,this._id=it(),this._objects=[],this._sessionInstances={},this.project={},Hi.init(e)}load(e,t,i){JSZipUtils.getBinaryContent(e,((e,s)=>{e?i&&i(e):JSZip.loadAsync(s).then((e=>{this.loadZip(e,(()=>{t&&t()}),(()=>{i&&i()}))}))}))}loadZip(e,t,i){this.reset();let s=it();Be.loadingLocks.add(s),e.file("projectDetails.json").async("string").then((n=>{let r;try{r=JSON.parse(n)}catch(e){return void this._handleLoadingError(i)}Ii.load(r.library,e,(()=>{Be.loadingLocks.delete(s),Hi.load(r.settings),Ls.load(r.textures),Os.load(r.materials);try{for(let e in r.assets){let t=r.assets[e],i=Ii.getType(e);i==Ee.IMAGE?this._addImages(t,!0,!0):i==Ee.MODEL?this._addGLTFs(t,!0,!0):i==Ee.LIGHT?this._addLights(t,e,!0,!0):i==Ee.SHAPE&&this._addShapes(t,e,!0,!0)}}catch(e){return console.error(e),void this._handleLoadingError(i)}tt.publish(this._id,Ke,!0),t&&t()}),(()=>{this._handleLoadingError(i)}))}),(()=>{this._handleLoadingError(i)}))}_handleLoadingError(e){tt.publish(this._id,Ke,!0),e&&e()}addInstance(e,t,i){let s,n=e.assetId,r=Ii.getType(n);return r==Ee.IMAGE?s=this.addImage(e,t,i):r==Ee.MODEL?s=this.addGLTF(e,t,i):r==Ee.LIGHT?s=this.addLight(e,n,t,i):r==Ee.SHAPE&&(s=this.addShape(e,n,t,i)),s}_addImages(e,t,i){for(let s of e)this.addImage(s,t,i)}addImage(e,t,i){let s=new ClampedTexturePlane(e);return s.addToScene(this._scene),this.addAsset(s,t,i),s}_addGLTFs(e,t,i){for(let s of e)this.addGLTF(s,t,i)}addGLTF(e,t,i){let s=new GLTFAsset(e);return s.addToScene(this._scene),this.addAsset(s,t,i),s}_addLights(e,t,i,s){for(let n of e)this.addLight(n,t,i,s)}addLight(e,t,i,s){let n=new this._lightClassMap[t](e);return n.addToScene(this._scene),this.addAsset(n,i,s),n}registerLight(e,t,i){this._lightClassMap[t]=e,Ii.loadLight(t,i)}_addShapes(e,t,i,s){for(let n of e)this.addShape(n,t,i,s)}addShape(e,t,i,s){let n=new this._shapeClassMap[t](e);return n.addToScene(this._scene),this.addAsset(n,i,s),n}registerShape(e,t,i){this._shapeClassMap[t]=e,Ii.loadShape(t,i)}getObjects(){return this._objects}getInstancesForAssetId(e){return this.project[e]||{}}getSessionInstance(e){return this._sessionInstances[e]}deleteAssetInstance(e,t,i){let s;t||(s=Xi.addAction((()=>{e.addToScene(this._scene),this.addAsset(e,!0)}),(()=>{this.deleteAssetInstance(e,!0)})));let n=e.getAssetId(),r=e.getId();if(n in this.project&&r in this.project[n]){for(let t=0;t<this._objects.length;t++)if(e.getObject()==this._objects[t]){this._objects.splice(t,1);break}if(e.getObject().parent!=this._scene&&this._scene.attach(e.getObject()),delete this.project[n][r],e.removeFromScene(),i)return;let t=Fe+":"+e.getId();tt.publish(this._id,t,{instance:e,undoRedoAction:s})}}addAsset(e,t,i){t||Xi.addAction((()=>{this.deleteAssetInstance(e,!0,i)}),(()=>{e.addToScene(this._scene),this.addAsset(e,!0,i)}));let s=e.getAssetId(),n=e.getId();s in this.project||(this.project[s]={}),this.project[s][n]||(this.project[s][n]=e,this._objects.push(e.getObject()),this._sessionInstances[n]=e,i||tt.publish(this._id,De,e))}reset(){this._sessionInstances={};for(let e in this.project){let t=this.project[e];for(let e in t)this.deleteAssetInstance(t[e],!0,!0)}Be.disableImmersion||Xi.reset(),Ii.reset(),Os.reset(),Ls.reset(),Hi.reset()}exportProject(){let e=this._getProjectDetails(),t=new JSZip;t.file("projectDetails.json",JSON.stringify(e));let i=Ii.getLibrary();for(let s in e.library){if(e.library[s].Type!=Ee.PRIMITVE){let n=e.library[s].Filepath;t.file(n,i[s].Blob)}}return t}_getProjectDetails(){let e={};for(let t in this.project){let i=this.project[t],s=[];for(let e in i)s.push(i[e].exportParams());s.length>0&&(e[t]=s)}let t=Object.keys(e),i=Hi.getSettings(),s=Os.getMaterialsDetails(),n=Ls.getTexturesDetails();for(let s in i.Skybox){let n=i.Skybox[s];n&&!e[n]&&t.push(n)}let r=Ls.getTexturesAssetIds();for(let e of r)t.push(e);return{library:Ii.getLibraryDetails(t),assets:e,settings:i,materials:s,textures:n}}};var Gn=Hn;const jn="FADE_IN",zn="SUSTAIN",Vn="FADE_OUT";class NotificationHub extends Entity{constructor(){super(),this._createNotification(),this._addSubscriptions(),this._object.position.setZ(.01),this._notificationHeight=0,this._notifications=[]}_createNotification(){this._container=new ve.Block({height:.04,width:.3,interline:.01,backgroundColor:Ct.defaultMenuBackground,backgroundOpacity:.8,justifyContent:"center"}),this._container.set({fontFamily:yt,fontTexture:vt}),this._textComponent=new ve.Text({content:"Notificaton Placeholder",fontColor:Ct.white,fontSize:Et,fontOpacity:1,offset:0}),this._container.add(this._textComponent),this._object.add(this._container),this._container.visible=!1}setNotificationHeight(e){this._notificationHeight=e}_handleNotification(e){this._notifications.push({state:jn,text:e.text,sustainTime:e.sustainTime||3,fadeTime:e.fadeTime||1,timeInState:0})}_addSubscriptions(){tt.subscribe(this._id,Ge,(e=>{this._handleNotification(e)}))}update(e){if(0==this._notifications.length)return;let t=this._notifications[0];if(t.state==jn){if(0==t.timeInState){this._container.visible=!0;let e=.02*Math.ceil(t.text.length/20)+.02;this._container.set({height:e}),this._textComponent.set({content:t.text}),this._object.position.setY(this._notificationHeight)}t.timeInState=Math.min(t.timeInState+e,t.fadeTime);let i=t.timeInState/t.fadeTime;this._container.set({backgroundOpacity:.8*i}),this._textComponent.set({fontOpacity:1*i}),1==i&&(t.state=zn,t.timeInState=0)}else if(t.state==zn)t.timeInState+=e,t.timeInState>=t.sustainTime&&(t.state=Vn,t.timeInState=0);else if(t.state==Vn){t.timeInState=Math.min(t.timeInState+e,t.fadeTime);let i=1-t.timeInState/t.fadeTime;this._container.set({backgroundOpacity:.8*i}),this._textComponent.set({fontOpacity:1*i}),0==i&&(this._notifications.shift(),this._object.position.setY(0),this._container.visible=!1)}}}class MenuGripInteractable extends GripInteractable{constructor(e,t,i,s,n){super(e,i,s,n),this._border=t}_createBoundingObject(){this._boundingPlane=new e.Plane}_getBoundingObject(){return this._threeObj.getWorldPosition(St[0]),this._threeObj.getWorldQuaternion(Tt),St[1].set(0,0,1).applyQuaternion(Tt),this._boundingPlane.setFromNormalAndCoplanarPoint(St[1],St[0]),this._boundingPlane}_displayBoundingObject(){this._threeObj.add(this._border)}_hideBoundingObject(){this._threeObj.remove(this._border)}intersectsSphere(e){let t,i=this._getBoundingObject();return t=!!i&&(e.intersectsPlane(i)&&e.distanceToPoint(St[0])<.45),t}distanceToSphere(e){return this._boundingPlane.distanceToPoint(e.center)}static emptyGroup(){return new MenuGripInteractable}}class MenuController extends PointerInteractableEntity{constructor(){super(),this._object.position.setZ(-100),this._pages={},this._pageCalls=[],this._gripInteractable=MenuGripInteractable.emptyGroup(),this._gripOwners=new Set,this._eventAlreadyTriggered=!1,this._addEventListeners(),this._setupNotificationHub(),this._createInteractables()}_addEventListeners(){document.getElementById("mobile-menu-open-button").addEventListener("click",(()=>{this._openMenu()}))}_setupNotificationHub(){this._notificationHub=new NotificationHub,this._notificationHub.addToScene(this._object),this._notificationHub.setNotificationHeight(.18)}_getCurrentPage(){return this._pages[this._pageCalls[this._pageCalls.length-1]]}getPage(e){return this._pages[e]}setPage(e){let t=this._getCurrentPage();t.removeFromScene(),this._pageCalls=[e],t=this._getCurrentPage(),t.addToScene(this._object,this._pointerInteractable),tt.publish(this._id,je)}pushPage(e){this._getCurrentPage().removeFromScene(),this._pageCalls.push(e),this._pages[e].addToScene(this._object,this._pointerInteractable),tt.publish(this._id,je)}popPage(){let e=this._getCurrentPage();e.removeFromScene(),this._pageCalls.pop(),e=this._getCurrentPage(),e.addToScene(this._object,this._pointerInteractable),tt.publish(this._id,je)}popPagesPast(e){let t,i;do{i=this._getCurrentPage(),t=this._pageCalls[this._pageCalls.length-1],i.back()}while(t!=e);tt.publish(this._id,je)}back(){this._getCurrentPage().back()}_createBorder(){let t=new Uint16Array([0,1,1,2,2,3,3,0]),i=new e.BufferGeometry;i.setIndex(new e.BufferAttribute(t,1)),i.setAttribute("position",new e.Float32BufferAttribute([.225,.15,0,-.225,.15,0,-.225,-.15,0,.225,-.15,0],3));let s=new e.LineSegments(i);return s.material.color.set(16776960),s}_createInteractables(){if("XR"!=Be.deviceType)return;let e=this._createBorder(),t=new MenuGripInteractable(this._object,e,(e=>{Ps.hands[e].attach(this._object),this._gripOwners.add(e)}),(e=>{Ps.hands[e].remove(this._object),this._gripOwners.delete(e)}));this._gripInteractable.addChild(t),Vs.init(this._object)}getPosition(e){return this._object.getWorldPosition(e)}getPositionArray(){return this._object.getWorldPosition(St[0]).toArray()}getRotationArray(){return xt.setFromQuaternion(this._object.getWorldQuaternion(Tt).normalize()).toArray()}getDirection(e){return this._object.getWorldDirection(e)}update(e){"XR"==Be.deviceType?(this._updateVR(e),this.update=this._updateVR):"POINTER"==Be.deviceType?(this._updatePointer(e),this.update=this._updatePointer):"MOBILE"==Be.deviceType&&(this._updateMobile(e),this.update=this._updateMobile)}_openMenu(){Be.renderer.getSize(Mt);let e=Mt.x/Mt.y,t=e>1.15?1.5:1.5*e;Be.camera.getWorldPosition(St[0]),Be.camera.getWorldDirection(St[1]),St[1].normalize().divideScalar(t),this._object.position.addVectors(St[0],St[1]),this._object.lookAt(St[0]),this.addToScene(this._scene)}closeMenu(){this.removeFromScene()}_updateVR(e){if(Be.sessionActive){let e=Pi.getXRGamepad(Ci.RIGHT),t=Pi.getXRGamepad(Ci.LEFT);e?.buttons[4]?.pressed||t?.buttons[4]?.pressed?this._eventAlreadyTriggered||(this._eventAlreadyTriggered=!0,0==this._gripOwners.size&&this._openMenu()):this._eventAlreadyTriggered=!1}this._notificationHub.update(e)}_updatePointer(e){Be.sessionActive&&!Be.keyboardLock&&(Pi.isKeyPressed("m")||Pi.isKeyPressed("M")?this._eventAlreadyTriggered||(this._eventAlreadyTriggered=!0,this._openMenu()):this._eventAlreadyTriggered=!1),this._notificationHub.update(e)}_updateMobile(e){this._notificationHub.update(e)}addToScene(e){this._object.parent!=e&&(super.addToScene(e),this._scene=e,this._getCurrentPage().addToScene(this._object,this._pointerInteractable),"XR"==Be.deviceType&&Ds.addInteractable(this._gripInteractable),Ss.addInteractable(this._pointerInteractable))}removeFromScene(){super.removeFromScene(),this._getCurrentPage().removeFromScene(),"XR"==Be.deviceType&&Ds.removeInteractable(this._gripInteractable),Ss.removeInteractable(this._pointerInteractable)}}const Yn=yt,Xn=vt,Wn=Ct.defaultMenuBackground;class MenuPage extends PointerInteractableEntity{constructor(e,t,i){super(),this._controller=e,this._createPage(),this._createCloseButton(),t?this._createSideBarButton():i&&this._createBackButton()}_createSideBarButton(){let e=new ve.Block({height:.06,width:.06,backgroundColor:Wn,backgroundOpacity:0}),t=ThreeMeshUIHelper.createButtonBlock({backgroundTexture:It.hamburgerIcon,height:.04,width:.04});e.set({fontFamily:Yn,fontTexture:Xn}),e.position.fromArray([-.225,.15,-.001]),e.add(t);let i=new PointerInteractable(t,(()=>{this._controller.setPage(Xs.NAVIGATION)}));this._pointerInteractable.addChild(i),this._object.add(e)}_createBackButton(){let e=new ve.Block({height:.06,width:.06,backgroundColor:Wn,backgroundOpacity:0}),t=ThreeMeshUIHelper.createButtonBlock({text:"<",fontSize:.03,height:.04,width:.04});e.set({fontFamily:Yn,fontTexture:Xn}),e.position.fromArray([-.225,.15,-.001]),e.add(t);let i=new PointerInteractable(t,(()=>{this.back()}));this._pointerInteractable.addChild(i),this._object.add(e)}_createCloseButton(){let e=new ve.Block({height:.06,width:.06,backgroundColor:Wn,backgroundOpacity:0}),t=ThreeMeshUIHelper.createButtonBlock({text:"X",fontSize:.03,height:.04,width:.04});e.set({fontFamily:Yn,fontTexture:Xn}),e.position.fromArray([.225,.15,-.001]),e.add(t);let i=new PointerInteractable(t,(()=>{this._controller.closeMenu()}));this._pointerInteractable.addChild(i),this._object.add(e)}_createPage(){this._container=new ve.Block({height:.3,width:.45,borderWidth:0,offset:0,backgroundOpacity:0});let e=new ve.Block({height:.3,width:.45,backgroundColor:Wn,backgroundOpacity:.5,borderWidth:.001,borderColor:Ct.white,borderOpacity:.75});this._container.set({fontFamily:Yn,fontTexture:Xn}),this._containerInteractable=new PointerInteractable(this._container.children[0],null,!1),this._pointerInteractable.addChild(this._containerInteractable),e.add(this._container),this._object.add(e)}back(){this._controller.popPage()}}class PaginatedPage extends MenuPage{constructor(e,t,i){super(e,t,i),this._paginatedListButtons=[],this._paginatedListInteractables=[],this._page=0,this._optionsInteractable=PointerInteractable.emptyGroup()}_addList(){this._createPreviousAndNextButtons(),this._optionsContainer=new ve.Block({height:.17,width:.45,contentDirection:"row",justifyContent:"center",backgroundOpacity:0,offset:0}),this._optionsBlock=new ve.Block({height:.17,width:.31,contentDirection:"column",justifyContent:"start",backgroundOpacity:0,offset:0});for(let e=0;e<5;e++){let t=ThreeMeshUIHelper.createButtonBlock({text:" ",fontSize:Et,height:.035,width:.3,margin:.002,fontFamily:yt,fontTexture:vt});this._optionsBlock.add(t),this._paginatedListButtons.push(t);let i=new PointerInteractable(t,(()=>{let t=5*this._page+e;this._items.length>t?this._handleItemInteraction(this._items[t]):console.error("PaginatedPage displaying non existant option")}));this._optionsInteractable.addChild(i),this._paginatedListInteractables.push(i)}this._optionsContainer.add(this._previousButton),this._optionsContainer.add(this._optionsBlock),this._optionsContainer.add(this._nextButton),this._container.add(this._optionsContainer),this._containerInteractable.addChild(this._optionsInteractable)}_createPreviousAndNextButtons(){this._previousButton=ThreeMeshUIHelper.createButtonBlock({text:"<",fontSize:.03,height:.04,width:.04,fontFamily:yt,fontTexture:vt}),this._nextButton=ThreeMeshUIHelper.createButtonBlock({text:">",fontSize:.03,height:.04,width:.04,fontFamily:yt,fontTexture:vt}),this._previousInteractable=new PointerInteractable(this._previousButton,(()=>{this._page-=1,this._updateItemsGUI()})),this._nextInteractable=new PointerInteractable(this._nextButton,(()=>{this._page+=1,this._updateItemsGUI()}))}_updateItemsGUI(){let e=5*this._page;for(let t=0;t<5;t++){let i=this._paginatedListInteractables[t],s=this._paginatedListButtons[t];if(e+t<this._items.length){let n=this._items[e+t];s.children[1].set({content:this._getItemName(n)}),s.visible=!0,this._optionsInteractable.addChild(i)}else s.visible=!1,this._optionsInteractable.removeChild(i)}0==this._page?(this._previousButton.visible=!1,this._optionsInteractable.removeChild(this._previousInteractable)):(this._previousButton.visible=!0,this._optionsInteractable.addChild(this._previousInteractable)),this._items.length>e+5?(this._nextButton.visible=!0,this._optionsInteractable.addChild(this._nextInteractable)):(this._nextButton.visible=!1,this._optionsInteractable.removeChild(this._nextInteractable))}_getItemName(){return console.error("PaginatedPage._getItemName() should be overridden"),""}_handleItemInteraction(){console.error("PaginatedPage._handleItemInteraction() should be overridden")}_refreshItems(){console.error("PaginatedPage._refreshItems() should be overridden")}addToScene(e,t){super.addToScene(e,t),e&&(this._refreshItems(),this._updateItemsGUI())}}class AssetPage extends PaginatedPage{constructor(e){super(e,!1,!0),this._instances={},this._items=Object.keys(this._instances),this._addPageContent(),this._createAddButton()}_addPageContent(){this._titleBlock=ThreeMeshUIHelper.createTextBlock({text:" ",fontSize:Bt,height:.04,width:.4}),this._container.add(this._titleBlock),this._addList()}_createAddButton(){let e=new ve.Block({height:.06,width:.06,backgroundColor:Ct.defaultMenuBackground,backgroundOpacity:0}),t=ThreeMeshUIHelper.createButtonBlock({text:"+",fontSize:.04,height:.04,width:.04});e.set({fontFamily:yt,fontTexture:vt}),e.position.fromArray([.175,.12,-.001]),e.add(t);let i=new PointerInteractable(t,(()=>{this._controller.getPosition(St[0]),this._controller.getDirection(St[1]).normalize().divideScalar(4);let e=St[0].sub(St[1]).toArray();St[0].set(0,0,1),St[1].setY(0).normalize(),Tt.setFromUnitVectors(St[0],St[1]),xt.setFromQuaternion(Tt);let t=xt.toArray(),i={assetId:this._assetId,position:e,rotation:t,visualEdit:!0},s=Ii.getType(this._assetId);s==Ee.IMAGE?(i.doubleSided=!0,i.transparent=!0,Gn.addImage(i)):s==Ee.MODEL?Gn.addGLTF(i):s==Ee.SHAPE?Gn.addShape(i,this._assetId):s==Ee.LIGHT&&Gn.addLight(i,this._assetId)}));this._containerInteractable.addChild(i),this._object.add(e)}_getItemName(e){return this._instances[e].getName()}_handleItemInteraction(e){this._controller.getPage(Xs.INSTANCE).setInstance(this._instances[e]),this._controller.pushPage(Xs.INSTANCE)}_refreshItems(){this._instances=Gn.getInstancesForAssetId(this._assetId),this._items=Object.keys(this._instances)}setAsset(e){let t=Ii.library[e];this._assetId=e,this._titleBlock.children[1].set({content:t.Name}),this._instances=Gn.getInstancesForAssetId(e)}_addSubscriptions(){tt.subscribe(this._id,De,(e=>{e.getAssetId()==this._assetId&&(this._refreshItems(),this._updateItemsGUI())})),tt.subscribe(this._id,Qe,(e=>{e.asset.getAssetId()==this._assetId&&(this._refreshItems(),this._updateItemsGUI())})),tt.subscribe(this._id,Fe,(e=>{e.instance.getAssetId()==this._assetId&&this._items.includes(e.instance.getId())&&(this._refreshItems(),this._updateItemsGUI())})),tt.subscribe(this._id,Ke,(e=>{e&&(this._controller.back(),this._controller.back())}))}_removeSubscriptions(){tt.unsubscribe(this._id,De),tt.unsubscribe(this._id,Qe),tt.unsubscribe(this._id,Fe),tt.unsubscribe(this._id,Ke)}addToScene(e,t){this._addSubscriptions(),super.addToScene(e,t)}removeFromScene(){this._removeSubscriptions(),super.removeFromScene()}}class LightsPage extends PaginatedPage{constructor(e){super(e,!1,!0),this._assets={},this._items=Object.keys(this._assets),this._addPageContent(),this._createAddButton()}_addPageContent(){this._titleBlock=ThreeMeshUIHelper.createTextBlock({text:" ",fontSize:Bt,height:.04,width:.2}),this._container.add(this._titleBlock),this._addList()}_createAddButton(){this._addButtonParent=new ve.Block({height:.06,width:.06,backgroundColor:Ct.defaultMenuBackground,backgroundOpacity:0});let e=ThreeMeshUIHelper.createButtonBlock({text:"+",fontSize:.04,height:.04,width:.04});this._addButtonParent.set({fontFamily:yt,fontTexture:vt}),this._addButtonParent.position.fromArray([.175,.12,-.001]),this._addButtonParent.add(e),this._addInteractable=new PointerInteractable(e,(()=>{this._controller.pushPage(Xs.UPLOAD)})),this._containerInteractable.addChild(this._addInteractable),this._object.add(this._addButtonParent)}_getItemName(e){let t=this._assets[e].Name;return t.length>25&&(t="..."+t.substring(t.length-25)),t}_handleItemInteraction(e){this._controller.getPage(Xs.ASSET).setAsset(e),this._controller.pushPage(Xs.ASSET)}_refreshItems(){let e=Ii.getLibrary();for(let t in e)e[t].Type==this._assetType&&(this._assets[t]=e[t]);this._items=Object.keys(this._assets)}setContent(e,t){this._assets={},this._assetType=e,e==Ee.MODEL||e==Ee.IMAGE?(this._object.add(this._addButtonParent),this._containerInteractable.addChild(this._addInteractable)):(this._object.remove(this._addButtonParent),this._containerInteractable.removeChild(this._addInteractable)),this._titleBlock.children[1].set({content:t})}_addSubscriptions(){tt.subscribe(this._id,Me,(e=>{Ii.getType(e)==this._assetType&&(this._refreshItems(),this._updateItemsGUI())})),tt.subscribe(this._id,Ke,(e=>{e&&(this._refreshItems(),this._updateItemsGUI())}))}_removeSubscriptions(){tt.unsubscribe(this._id,Me),tt.unsubscribe(this._id,Ke)}addToScene(e,t){this._addSubscriptions(),super.addToScene(e,t)}removeFromScene(){this._removeSubscriptions(),super.removeFromScene()}}class AssetSelectPage extends PaginatedPage{constructor(e){super(e,!1,!0),this._assets={},this._items=Object.keys(this._assets),this._addPageContent(),this._createAddButton()}_addPageContent(){this._textField=new TextField({height:.04,width:.3,onBlur:()=>{this._searchUpdated()},onUpdate:()=>{this._searchUpdated()}}),this._textField.addToScene(this._container,this._containerInteractable),this._addList()}_createAddButton(){let e=new ve.Block({height:.06,width:.06,backgroundColor:Ct.defaultMenuBackground,backgroundOpacity:0});this._addButton=ThreeMeshUIHelper.createButtonBlock({text:"+",fontSize:.04,height:.04,width:.04}),e.set({fontFamily:yt,fontTexture:vt}),e.position.fromArray([.175,.12,-.001]),e.add(this._addButton),this._addInteractable=new PointerInteractable(this._addButton,(()=>{this._addAction&&this._addAction()})),this._containerInteractable.addChild(this._addInteractable),this._object.add(e)}_searchUpdated(){this._refreshItems(),this._updateItemsGUI()}_getItemName(e){let t=this._assets[e].Name;return t.length>25&&(t="..."+t.substring(t.length-25)),t}_handleItemInteraction(e){this._action&&this._action(e)}_refreshItems(){this._items=this._getFilteredItems()}_getFilteredItems(){let e=[],t=this._textField.content.toLowerCase();for(let i in this._assets)this._assets[i].Name.toLowerCase().includes(t)&&e.push(i);return e}setContent(e,t,i,s){this._assets=e,this._action=t,this._addAction=i,this._backAction=s,this._addAction?(this._addButton.visible=!0,this._containerInteractable.addChild(this._addInteractable)):(this._addButton.visible=!1,this._containerInteractable.removeChild(this._addInteractable))}back(){this._action=null,this._textField.deactivate(),this._backAction&&this._backAction(),super.back()}}const Kn=256,Zn=128;let qn=new class{constructor(){this._hue=171,this._saturation=.7,this._lightness=.5,this._createTextures()}_createTextures(){let t=document.createElement("canvas"),i=document.createElement("canvas");t.width=256,t.height=256,i.width=1,i.height=Kn,this._colorContext=t.getContext("2d"),this._lightnessContext=i.getContext("2d"),this._updateColorWheel(),this._updateLightnessBar(),this._colorTexture=new e.CanvasTexture(t),this._lightnessTexture=new e.CanvasTexture(i)}_updateColorWheel(){let e=this._colorContext.getImageData(0,0,256,256),t=e.data;this._drawColorWheel(t),this._colorContext.putImageData(e,0,0)}_drawColorWheel(e){let t=this._lightness;for(let i=-128;i<=Zn;i++){let s=i*i,n=Math.ceil(Math.sqrt(16384-s));for(let s=-n;s<=n;s++){let[n,r]=ct(i,s);if(n>Zn)continue;let a=4*(i+Zn+(s+Zn)*256),o=dt(r),l=n/Zn,[h,c,d]=ut(o,l,t);e[a]=h,e[a+1]=c,e[a+2]=d,e[a+3]=255}}}_updateLightnessBar(){let e=this._lightnessContext.getImageData(0,0,1,Kn),t=e.data;for(let e=0;e<1;e++)for(let i=0;i<Kn;i++){let s=4*(e+1*i),n=this._hue,r=this._saturation,a=1-i/Kn,[o,l,h]=ut(n,r,a);t[s]=o,t[s+1]=l,t[s+2]=h,t[s+3]=255}this._lightnessContext.putImageData(e,0,0)}getColorTexture(){return this._colorTexture}getLightnessTexture(){return this._lightnessTexture}getXY(t){return i=this._saturation*t,s=e.MathUtils.degToRad(this._hue+180),[i*Math.cos(s),i*Math.sin(s)];var i,s}getLightness(){return this._lightness}setFromHSL(e){this._hue=360*e.h,this._saturation=e.s,this._lightness=e.l,this._updateColorWheel(),this._updateLightnessBar(),this._colorTexture.needsUpdate=!0,this._lightnessTexture.needsUpdate=!0}selectColorFromXY(e,t,i){let[s,n]=ct(t,i);s>e&&(s=e);let r=dt(-n),a=s/e,o=this._lightness,[l,h,c]=ut(r,a,o);return this._hue=r,this._saturation=a,this._updateLightnessBar(),this._lightnessTexture.needsUpdate=!0,pt(l,h,c)}selectLightnessFromXY(e,t,i){let s=this._hue,n=this._saturation,r=i/e+.5;r<0&&(r=0),r>1&&(r=1);let[a,o,l]=ut(s,n,r);return this._lightness=r,this._updateColorWheel(),this._colorTexture.needsUpdate=!0,pt(a,o,l)}};const Jn=.1,$n={};class ColorWheelPage extends MenuPage{constructor(e){super(e,!1,!0),this._addPageContent(),this._createCursors()}_addPageContent(){this._titleBlock=ThreeMeshUIHelper.createTextBlock({text:"Color Picker",fontSize:Bt,height:.04,width:.4}),this._container.add(this._titleBlock);let e=new ve.Block({height:.2,width:.25,contentDirection:"row",justifyContent:"center",backgroundOpacity:0,offset:0});this._colorBlock=new ve.Block({height:.2,width:.2,backgroundOpacity:1,backgroundTexture:qn.getColorTexture(),margin:.02,borderWidth:0}),this._lightnessBlock=new ve.Block({height:.2,width:.02,backgroundOpacity:1,backgroundTexture:qn.getLightnessTexture(),backgroundSize:"stretch",margin:.02});let t=PointerInteractable.createDraggable(this._colorBlock,(e=>{this._handleColorCursorDrag(e),this._isDraggingColorCursor=!1,this._onEnter&&this._onEnter()}),(e=>{this._handleColorCursorDrag(e)})),i=PointerInteractable.createDraggable(this._lightnessBlock,(e=>{this._handleLightnessCursorDrag(e),this._isDraggingLightnessCursor=!1,this._onEnter&&this._onEnter()}),(e=>{this._handleLightnessCursorDrag(e)}));e.add(this._colorBlock),e.add(this._lightnessBlock),this._container.add(e),this._containerInteractable.addChild(t),this._containerInteractable.addChild(i)}_handleColorCursorDrag(e){if(!e)return;St[0].copy(e),this._colorBlock.worldToLocal(St[0]);let t=qn.selectColorFromXY(Jn,St[0].x,St[0].y);t&&this._onUpdate&&(this._onUpdate(t),this._updateColorCursor(),this._colorCursor.visible||(this._colorCursor.visible=!0)),this._isDraggingColorCursor=!0}_handleLightnessCursorDrag(e){if(!e)return;St[0].copy(e),this._lightnessBlock.worldToLocal(St[0]);let t=qn.selectLightnessFromXY(.2,St[0].x,St[0].y);t&&this._onUpdate&&(this._onUpdate(t),this._updateLightnessCursor(),this._lightnessCursor.visible||(this._lightnessCursor.visible=!0)),this._isDraggingLightnessCursor=!0}_createCursors(){let t=new e.RingGeometry(Jn/12,.01,16),i=new e.MeshBasicMaterial({color:Ct.white,side:e.FrontSide});this._colorCursor=new e.Mesh(t,i),this._colorCursor.position.setZ(.015),this._object.add(this._colorCursor),this._colorCursor.visible=!1,t=new e.RingGeometry(Jn/9,Jn/7.5,4,1,Math.PI/4);let s=t.getAttribute("position");for(let e=0;e<s.count;e++){let t=s.getY(e);t>0&&s.setY(e,t-.005),t<0&&s.setY(e,t+.005)}i=new e.MeshBasicMaterial({color:Ct.white,side:e.FrontSide}),this._lightnessCursor=new e.Mesh(t,i),this._lightnessCursor.position.setZ(.0105),this._object.add(this._lightnessCursor),this._lightnessCursor.visible=!1}_updateColorCursor(){let[e,t]=qn.getXY(Jn);St[0].set(e,-t,0),this._object.worldToLocal(this._colorBlock.localToWorld(St[0])),this._colorCursor.position.setX(St[0].x),this._colorCursor.position.setY(St[0].y)}_updateLightnessCursor(){let e=qn.getLightness(Jn);St[0].set(0,(e-.5)*Jn*2,0),this._object.worldToLocal(this._lightnessBlock.localToWorld(St[0])),this._lightnessCursor.position.setX(St[0].x),this._lightnessCursor.position.setY(St[0].y)}setContent(e,t,i,s){qn.setFromHSL(t.getHSL($n)),this._updateColorCursor(),this._updateLightnessCursor(),this._requesterId=e,this._onUpdate=i,this._onEnter=s}updateColor(e,t){this._object.parent&&this._requesterId==e&&(qn.setFromHSL(t.getHSL($n)),this._updateColorCursor(),this._updateLightnessCursor())}isDraggingCursors(){return this._isDraggingColorCursor||this._isDraggingLightnessCursor}back(){this._onUpdate=null,super.back()}}const er=.22;class DynamicFieldsPage extends MenuPage{constructor(e){super(e,!1,!0),this._firstItemIndex=0,this._lastItemIndex=-1,this._fields=[],this._addPageContent()}_addPageContent(){this._createPreviousAndNextButtons(),this._createTitleBlock();let e=new ve.Block({height:er,width:.45,contentDirection:"row",justifyContent:"center",backgroundOpacity:0,margin:0,offset:0});this._fieldsContainer=new ve.Block({height:er,width:.31,contentDirection:"column",justifyContent:"space-around",backgroundOpacity:0,margin:0,offset:0}),e.add(this._previousButton),e.add(this._fieldsContainer),e.add(this._nextButton),this._container.add(this._titleBlock),this._container.add(e)}_createTitleBlock(){this._titleBlock=ThreeMeshUIHelper.createTextBlock({text:" ",fontSize:Bt,height:.04,width:.4,offset:0})}_createPreviousAndNextButtons(){this._previousButton=ThreeMeshUIHelper.createButtonBlock({text:"<",fontSize:.03,height:.04,width:.04}),this._nextButton=ThreeMeshUIHelper.createButtonBlock({text:">",fontSize:.03,height:.04,width:.04}),this._previousInteractable=new PointerInteractable(this._previousButton,(()=>{this._loadPrevPage()})),this._nextInteractable=new PointerInteractable(this._nextButton,(()=>{this._loadNextPage()}))}_setFields(e){this._removeCurrentFields(),this._firstItemIndex=0,this._lastItemIndex=-1,this._fields=e,this._loadNextPage();for(let t of e)t.updateFromSource()}_removeField(e){let t=this._fields.indexOf(e);e.deactivate(),e.removeFromScene(),this._fields.splice(t,1),t<=this._lastItemIndex?(t<this._firstItemIndex&&this._firstItemIndex--,this._lastItemIndex--,this._firstItemIndex==this._fields.length?this._loadPrevPage():(this._removeCurrentFields(),this._lastItemIndex=this._firstItemIndex-1,this._loadNextPage())):this._fields.length==this._lastItemIndex+1&&this._updateNavButtons()}_loadNextPage(){this._removeCurrentFields(),this._firstItemIndex=this._lastItemIndex+1;let e=er;for(let t=this._firstItemIndex;t<this._fields.length;t++){let i=this._fields[t];if(e-=i.getHeight(),!(e>=0||t==this._firstItemIndex))break;i.addToScene(this._fieldsContainer,this._containerInteractable),this._lastItemIndex=t}this._updateNavButtons(),this._container.update(!0,!0,!1)}_loadPrevPage(){this._removeCurrentFields();let e=er;this._lastItemIndex=this._firstItemIndex-1;let t=[];for(let i=this._lastItemIndex;i>=0;i--){let s=this._fields[i];if(e-=s.getHeight(),!(e>=0||i==this._lastItemIndex))break;t.push(s),this._firstItemIndex=i}for(let e=t.length-1;e>=0;e--)t[e].addToScene(this._fieldsContainer,this._containerInteractable);this._updateNavButtons()}_updateNavButtons(){0==this._firstItemIndex?(this._previousButton.visible=!1,this._containerInteractable.removeChild(this._previousInteractable)):(this._previousButton.visible=!0,this._containerInteractable.addChild(this._previousInteractable)),this._lastItemIndex+1==this._fields.length?(this._nextButton.visible=!1,this._containerInteractable.removeChild(this._nextInteractable)):(this._nextButton.visible=!0,this._containerInteractable.addChild(this._nextInteractable))}_removeCurrentFields(){for(let e=this._firstItemIndex;e<=this._lastItemIndex;e++){let t=this._fields[e];t.deactivate(),t.removeFromScene()}}_unfocusFields(){for(let e=this._firstItemIndex;e<=this._lastItemIndex;e++)this._fields[e].deactivate()}}class EditorSettingsPage extends DynamicFieldsPage{constructor(e){super(e,!1,!0),this._createFields()}_createTitleBlock(){this._titleBlock=ThreeMeshUIHelper.createTextBlock({text:"Editor Settings",fontSize:Bt,height:.04,width:.3})}_createFields(){let e=[];e.push(new NumberInput({title:"Movement Speed",minValue:0,maxValue:1e3,initialValue:4,onBlur:(e,t)=>{Hi.setEditorSetting("Movement Speed",t)},getFromSource:()=>Hi.getEditorSettings()["Movement Speed"]})),e.push(new CheckboxInput({title:"Enable Flying",initialValue:!0,onUpdate:e=>{Hi.setEditorSetting("Enable Flying",e)},getFromSource:()=>Hi.getEditorSettings()["Enable Flying"]})),"XR"==Be.deviceType&&e.push(new CheckboxInput({title:"Swap Joysticks",initialValue:!1,onUpdate:e=>{Hi.setEditorSetting("Swap Joysticks",e)},getFromSource:()=>Hi.getEditorSettings()["Swap Joysticks"]})),this._setFields(e)}addToScene(e,t){for(let e of this._fields)e.updateFromSource();super.addToScene(e,t)}removeFromScene(){super.removeFromScene()}}const tr=[{title:"Edit",type:yi.EDIT},{title:"Copy / Paste",type:yi.COPY_PASTE},{title:"Delete",type:yi.DELETE}];class HandsPage extends MenuPage{constructor(e){super(e,!0),this._addPageContent()}_addPageContent(){let e=ThreeMeshUIHelper.createTextBlock({text:"Hand Tools",fontSize:Bt,height:.04,width:.2});this._container.add(e);let t=new ve.Block({height:.2,width:.45,contentDirection:"column",justifyContent:"start",backgroundOpacity:0});for(let e of tr){let i=ThreeMeshUIHelper.createButtonBlock({text:e.title,fontSize:Et,height:.035,width:.3,margin:.002});t.add(i);let s=new PointerInteractable(i,(()=>{yi.ACTIVE!=e.type&&(yi.ACTIVE=e.type,tt.publish(this._id,ke,e.type))}));this._containerInteractable.addChild(s)}this._container.add(t)}}class HostPartyPage extends MenuPage{constructor(e){super(e,!1,!0),this._addPageContent()}_addPageContent(){let e=ThreeMeshUIHelper.createTextBlock({text:"Host Party",fontSize:Bt,height:.04,width:.2});this._container.add(e),this._contentBlock=new ve.Block({height:.2,width:.45,contentDirection:"column",justifyContent:"start",backgroundOpacity:0}),this._textField=new TextField({height:.03,width:.4,text:"Party Name",onEnter:()=>{this._hostParty()}}),this._textField.addToScene(this._contentBlock,this._containerInteractable);let t=ThreeMeshUIHelper.createButtonBlock({text:"Submit",fontSize:Et,height:.035,width:.2,margin:.002});this._contentBlock.add(t);let i=new PointerInteractable(t,(()=>{this._hostParty()}));this._containerInteractable.addChild(i),this._container.add(this._contentBlock),this._connectingBlock=ThreeMeshUIHelper.createTextBlock({text:"Connecting...",fontSize:.025,height:.04,width:.4,fontFamily:yt,fontTexture:vt})}_hostParty(){let e=this._textField.content;0!=e.length?(this._container.remove(this._contentBlock),this._container.add(this._connectingBlock),this._pointerInteractable.removeChild(this._containerInteractable),this._isConnecting=!0,zs.host(e,(()=>{this._successCallback()}),(e=>{this._errorCallback(e)}))):tt.publish(this._id,Ge,{text:"Missing Party Name"})}_successCallback(){this._isConnecting&&(this._isConnecting=!1,this._pointerInteractable.addChild(this._containerInteractable),this._container.remove(this._connectingBlock),this._container.add(this._contentBlock),this._container.update(!1,!1,!0),this._object.parent&&this._controller.back())}_errorCallback(e){this._isConnecting=!1;let t=e.topic;"409-room"==t?tt.publish(this._id,Ge,{text:"Party Name Already Taken"}):"rtc-timeout"==t?tt.publish(this._id,Ge,{text:"Could not connect to all other users, please try again"}):"bad-auth"==t?tt.publish(this._id,Ge,{text:"Could not authenticate with Server"}):("error"==t||console.error("Unexpected error message topic: "+t),tt.publish(this._id,Ge,{text:"Unexpected Error"})),this._pointerInteractable.addChild(this._containerInteractable),this._container.remove(this._connectingBlock),this._container.add(this._contentBlock),this._container.update(!1,!1,!0)}addToScene(e,t){this._isConnecting&&!zs.isPartyActive()&&(this._pointerInteractable.addChild(this._containerInteractable),this._container.remove(this._connectingBlock),this._container.add(this._contentBlock),this._container.update(!1,!1,!0)),super.addToScene(e,t)}}class InstancePage extends DynamicFieldsPage{constructor(e){super(e,!1,!0)}_createTitleBlock(){this._titleBlock=new ve.Block({height:.04,width:.43,contentDirection:"row",justifyContent:"end",backgroundOpacity:0,margin:.01,offset:0}),this._titleField=new TextField({height:.04,width:.31,fontSize:Bt,margin:0,onBlur:()=>{this._instance.getEditorHelper().updateName(this._titleField.content)}});let e=ThreeMeshUIHelper.createButtonBlock({backgroundTexture:It.trashIcon,backgroundTextureScale:.7,height:.04,width:.04});this._titleBlock.add(this._titleField.getObject()),this._titleBlock.add(e),this._titleField.setPointerInteractableParent(this._containerInteractable);let t=new PointerInteractable(e,(()=>{Gn.deleteAssetInstance(this._instance)}));this._containerInteractable.addChild(t)}setInstance(e){this._instance=e;let t=e.getName();this._titleField.setContent(t),this._setFields(e.getEditorHelper().getMenuFields())}_addSubscriptions(){tt.subscribe(this._id,Fe,(e=>{e.instance==this._instance&&this._controller.popPagesPast(Xs.INSTANCE)})),tt.subscribe(this._id,Qe,(e=>{e.asset==this._instance&&this._titleField.setContent(e.asset.getName())})),tt.subscribe(this._id,Re,(e=>{e.instance.getId()==this._instance.getId()&&this._unfocusFields()})),tt.subscribe(this._id,Ke,(e=>{e&&(this._removeSubscriptions(),this._containerInteractable.removeChild(this._previousInteractable),this._containerInteractable.removeChild(this._nextInteractable),this._controller.setPage(Xs.NAVIGATION))}))}_removeSubscriptions(){tt.unsubscribe(this._id,Fe),tt.unsubscribe(this._id,Qe),tt.unsubscribe(this._id,Re),tt.unsubscribe(this._id,Ke)}back(){this._removeCurrentFields(),this._containerInteractable.removeChild(this._previousInteractable),this._containerInteractable.removeChild(this._nextInteractable),this._removeSubscriptions(),super.back()}addToScene(e,t){this._addSubscriptions(),super.addToScene(e,t)}removeFromScene(){super.removeFromScene()}}class JoinPartyPage extends MenuPage{constructor(e){super(e,!1,!0),this._addPageContent()}_addPageContent(){let e=ThreeMeshUIHelper.createTextBlock({text:"Join Party",fontSize:Bt,height:.04,width:.2});this._container.add(e),this._contentBlock=new ve.Block({height:.2,width:.45,contentDirection:"column",justifyContent:"start",backgroundOpacity:0}),this._textField=new TextField({height:.03,width:.4,text:"Party Name",onEnter:()=>{this._joinParty()}}),this._textField.addToScene(this._contentBlock,this._containerInteractable);let t=ThreeMeshUIHelper.createButtonBlock({text:"Join",fontSize:Et,height:.035,width:.2,margin:.002});this._contentBlock.add(t);let i=new PointerInteractable(t,(()=>{this._joinParty()}));this._containerInteractable.addChild(i),this._container.add(this._contentBlock),this._connectingBlock=ThreeMeshUIHelper.createTextBlock({text:"Connecting...",fontSize:.025,height:.04,width:.4,fontFamily:yt,fontTexture:vt})}_joinParty(){let e=this._textField.content;0!=e.length?(this._container.remove(this._contentBlock),this._container.add(this._connectingBlock),this._pointerInteractable.removeChild(this._containerInteractable),this._isConnecting=!0,zs.join(e,(()=>{this._successCallback()}),(e=>{this._errorCallback(e)}))):tt.publish(this._id,Ge,{text:"Missing Party Name"})}_successCallback(){this._isConnecting&&(this._isConnecting=!1,this._pointerInteractable.addChild(this._containerInteractable),this._container.remove(this._connectingBlock),this._container.add(this._contentBlock),this._container.update(!1,!1,!0),this._object.parent&&this._controller.back())}_errorCallback(e){this._isConnecting=!1;let t=e.topic;"404-room"==t?tt.publish(this._id,Ge,{text:"Party Name Not Found"}):"rtc-timeout"==t?tt.publish(this._id,Ge,{text:"Could not connect to all other users, please try again"}):"bad-auth"==t?tt.publish(this._id,Ge,{text:"Could not authenticate with Server"}):("error"==t||console.error("Unexpected error message topic: "+t),tt.publish(this._id,Ge,{text:"Unexpected Error"})),this._pointerInteractable.addChild(this._containerInteractable),this._container.remove(this._connectingBlock),this._container.add(this._contentBlock),this._container.update(!1,!1,!0)}addToScene(e,t){this._isConnecting&&!zs.isPartyActive()&&(this._pointerInteractable.addChild(this._containerInteractable),this._container.remove(this._connectingBlock),this._container.add(this._contentBlock),this._container.update(!1,!1,!0)),super.addToScene(e,t)}}const ir=["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"];let sr=new class{init(){this._files,this._fileId,this._folderId,this._gapiInitialized=!1,this._gisInitialized=!1,gapi.load("client",(()=>{this._initClient()}))}_initClient(){this._tokenClient=google.accounts.oauth2.initTokenClient({client_id:"791471431939-q3fifjtaq8mhlhce0l5h96k38m8fchn2.apps.googleusercontent.com",scope:"https://www.googleapis.com/auth/drive.file",callback:e=>{this._accessToken=e.access_token,this._gisInitialized=!0,this._initialize(),this._authCallback&&this._authCallback(),this._authCallback=null}}),gapi.client.init({apiKey:"AIzaSyBdadP7BFyNpPCRAlCfV-ikXklXkdJ188s",discoveryDocs:ir}).then((()=>{this._gapiInitialized=!0,this._initialize()}),(function(e){"idpiframe_initialization_failed"==e.error&&e.details.includes("Cookies")&&console.log("TODO: Let user know cookies must be enabled for Google Drive to work"),console.error(JSON.stringify(e,null,2))}))}_initialize(){this._gisInitialized&&this._gapiInitialized&&!this._folderId&&(this._fetchFolder(),this.fetchFiles())}handleAuthButton(e){this._authCallback=e,this._tokenClient.requestAccessToken()}handleSignoutButton(e){gapi.client.setToken(),this._gisInitialized=!1,this._folderId=null,e&&e()}_fetchFolder(){gapi.client.drive.files.list({q:"mimeType = 'application/vnd.google-apps.folder'",spaces:"drive"}).execute((e=>{0==e.files.length?this._createFolder():this._folderId=e.files[0].id}))}_createFolder(){gapi.client.drive.files.create({resource:{name:"Digital Bacon",mimeType:"application/vnd.google-apps.folder"}}).then((e=>{200!=e.status?console.log("TODO: Let user know there was a problem"):this._folderId=e.result.id}))}isSignedIn(){return gapi.client&&null!=gapi.client.getToken()}hasActiveFile(){return null!=this._fileId}clearActiveFile(){this._fileId=null}fetchFiles(e){return gapi.client.drive.files.list({q:"mimeType='application/zip'"}).execute((t=>{this._files=t.files,e&&e(this._files)})),this._files}loadFile(e,t,i){gapi.client.drive.files.get({fileId:e,alt:"media"}).then((i=>{JSZip.loadAsync(i.body).then((i=>{this._fileId=e,t&&t(i)}))}),(function(e){console.error("Failed to get file: "+e),i&&i()}))}save(e,t,i){if(!this.isSignedIn())throw"Not signed into google drive";e.generateAsync({type:"blob"}).then((e=>{this._update(e,t,i)}))}saveAs(e,t,i,s){if(!this.isSignedIn())throw"Not signed into google drive";t.generateAsync({type:"blob"}).then((t=>{this._upload(e,t,i,s)}))}_upload(e,t,i,s){let n={name:e+".zip",mimeType:"application/zip",parents:[this._folderId]},r=JSON.stringify(n),a=this._accessToken;fetch("https://www.googleapis.com/upload/drive/v3/files?uploadType=resumable&supportsAllDrives=true",{method:"POST",headers:new Headers({Authorization:"Bearer "+a,"Content-Type":"application/json; charset=UTF-8","Content-Length":r.length}),body:r}).then((e=>{if(200!=e.status)console.error("Error:",error),s();else{let n=e.headers.get("location");this._resumableUpload(n,t,i,s,!1)}}))}_update(e,t,i){let s=this._accessToken;fetch("https://www.googleapis.com/upload/drive/v3/files/{fileId}?uploadType=resumable".replace("{fileId}",this._fileId),{method:"PUT",headers:new Headers({Authorization:"Bearer "+s,"X-HTTP-Method-Override":"PATCH"})}).then((s=>{if(200!=s.status)console.error("Error:",error),i();else{let n=s.headers.get("location");this._resumableUpload(n,e,t,i,!0)}}))}_resumableUpload(e,t,i,s,n){let r={Authorization:"Bearer "+this._accessToken};n&&(r["X-HTTP-Method-Override"]="PATCH"),fetch(e,{method:"PUT",headers:new Headers(r),body:t}).then((e=>{200==e.status?(i(),e.json().then((e=>{this._fileId=e.id}))):(console.error("Error:",error),s())}))}};class LoadFromGDrivePage extends PaginatedPage{constructor(e){super(e,!1,!0),this._instances={},this._items=Object.keys(this._instances),this._addPageContent(),this._filesLoaded=!1,this._isLoadingSaving=!1,this._addSubscriptions()}_addPageContent(){this._titleBlock=ThreeMeshUIHelper.createTextBlock({text:"Load From Google Drive",fontSize:Bt,height:.04,width:.4}),this._container.add(this._titleBlock),this._loadingSavingBlock=ThreeMeshUIHelper.createTextBlock({text:"Loading...",fontSize:.025,height:.04,width:.4,fontFamily:yt,fontTexture:vt}),this._container.add(this._loadingSavingBlock),this._addList()}_getItemName(e){return this._instances[e].name}_handleItemInteraction(e){this._loadingSavingBlock.children[1].set({content:"Project Loading..."}),this._updateLoadingSaving(!1),tt.publish(this._id,Ke,!1),sr.loadFile(this._instances[e].id,(e=>{this._loadSuccessCallback(e)}),(()=>{this._loadErrorCallback()}))}_loadSuccessCallback(e){Gn.loadZip(e,(()=>{tt.publish(this._id,Ge,{text:"Project Loaded"}),zs.isPartyActive()&&zs.isHost()&&zs.sendProject()}),(()=>{this._loadErrorCallback()}))}_loadErrorCallback(){this._updateLoadingSaving(!0),tt.publish(this._id,Ke,!0),tt.publish(this._id,Ge,{text:"Error Loading Project",sustainTime:5})}_refreshItems(){this._items=Object.keys(this._instances)}loadProjects(){let e=sr.fetchFiles((e=>{this._filesLoaded||(this._filesLoaded=!0,this._isLoadingSaving||(this._container.remove(this._loadingSavingBlock),this._container.add(this._optionsContainer),this._containerInteractable.addChild(this._optionsInteractable))),this._instances=e,this._refreshItems(),this._updateItemsGUI()}));e&&(this._instances=e,this._filesLoaded||(this._filesLoaded=!0,this._isLoadingSaving||(this._container.remove(this._loadingSavingBlock),this._container.add(this._optionsContainer),this._containerInteractable.addChild(this._optionsInteractable))))}_addSubscriptions(){tt.subscribe(this._id,Ke,(e=>{this._loadingSavingBlock.children[1].set({content:"Project Loading..."}),this._updateLoadingSaving(e)})),tt.subscribe(this._id,Ze,(e=>{this._loadingSavingBlock.children[1].set({content:"Project Saving..."}),this._updateLoadingSaving(e)}))}_updateLoadingSaving(e){if(this._isLoadingSaving=!e,e){if(!this._filesLoaded)return void this._loadingSavingBlock.children[1].set({content:"Loading..."});this._container.remove(this._loadingSavingBlock),this._container.add(this._optionsContainer),this._containerInteractable.addChild(this._optionsInteractable),this._container.update(!1,!1,!0)}else this._container.remove(this._optionsContainer),this._container.add(this._loadingSavingBlock),this._containerInteractable.removeChild(this._optionsInteractable)}}class PaginatedIconsPage extends MenuPage{constructor(e,t,i){super(e,t,i),this._paginatedListButtons=[],this._paginatedListInteractables=[],this._page=0,this._optionsInteractable=PointerInteractable.emptyGroup()}_addList(){this._createPreviousAndNextButtons(),this._optionsContainer=new ve.Block({height:.17,width:.45,contentDirection:"row",justifyContent:"center",backgroundOpacity:0,offset:0});let e={height:.17,width:.31,contentDirection:"column",justifyContent:"start",backgroundOpacity:0,offset:0};this._optionsBlock=new ve.Block(e),e.height=.085,e.contentDirection="row",e.justifyContent="center",e.margin=.005,this._rows=[],this._rows.push(new ve.Block(e)),this._rows.push(new ve.Block(e));for(let e=0;e<2;e++){let t=this._rows[e];for(let i=0;i<3;i++){let s=ThreeMeshUIHelper.createButtonBlock({height:.085,width:.1,margin:.002,justifyContent:"start",fontFamily:yt,fontTexture:vt}),n=new ve.Block({height:.04,width:.04,backgroundTexture:It.searchIcon,offset:1e-4,borderRadius:0}),r=ThreeMeshUIHelper.createTextBlock({text:" ",height:.035,width:.1,margin:0});s.add(n),s.add(r),t.add(s),this._paginatedListButtons.push(s);let a=new PointerInteractable(s,(()=>{let t=2*this._page*3+3*e+i;this._items.length>t?this._handleItemInteraction(this._items[t]):console.error("PaginatedIconsPage displaying non existant option")}));this._optionsInteractable.addChild(a),this._paginatedListInteractables.push(a)}}this._optionsBlock.add(this._rows[0]),this._optionsBlock.add(this._rows[1]),this._optionsContainer.add(this._previousButton),this._optionsContainer.add(this._optionsBlock),this._optionsContainer.add(this._nextButton),this._container.add(this._optionsContainer),this._containerInteractable.addChild(this._optionsInteractable)}_createPreviousAndNextButtons(){this._previousButton=ThreeMeshUIHelper.createButtonBlock({text:"<",fontSize:.03,height:.04,width:.04,fontFamily:yt,fontTexture:vt}),this._nextButton=ThreeMeshUIHelper.createButtonBlock({text:">",fontSize:.03,height:.04,width:.04,fontFamily:yt,fontTexture:vt}),this._previousInteractable=new PointerInteractable(this._previousButton,(()=>{this._page-=1,this._updateItemsGUI()})),this._nextInteractable=new PointerInteractable(this._nextButton,(()=>{this._page+=1,this._updateItemsGUI()}))}_updateItemsGUI(){let e=2*this._page*3;for(let t=0;t<6;t++){let i=this._paginatedListInteractables[t],s=this._paginatedListButtons[t];if(e+t<this._items.length){let n=this._items[e+t];s.children[2].children[1].set({content:this._getItemName(n)}),s.children[1].set({backgroundTexture:this._getItemIcon(n)}),s.visible=!0,this._optionsInteractable.addChild(i)}else s.visible=!1,this._optionsInteractable.removeChild(i)}0==this._page?(this._previousButton.visible=!1,this._optionsInteractable.removeChild(this._previousInteractable)):(this._previousButton.visible=!0,this._optionsInteractable.addChild(this._previousInteractable)),this._items.length>e+6?(this._nextButton.visible=!0,this._optionsInteractable.addChild(this._nextInteractable)):(this._nextButton.visible=!1,this._optionsInteractable.removeChild(this._nextInteractable))}_getItemName(){return console.error("PaginatedIconsPage._getItemName() should be overridden"),""}_getItemIcon(){return console.error("PaginatedIconsPage._getItemIcon() should be overridden"),""}_handleItemInteraction(){console.error("PaginatedIconsPage._handleItemInteraction() should be overridden")}_refreshItems(){console.error("PaginatedIconsPage._refreshItems() should be overridden")}addToScene(e,t){super.addToScene(e,t),e&&(this._refreshItems(),this._updateItemsGUI())}}const nr=[{text:"Models",icon:It.objectIcon,page:Xs.ASSETS,assetType:Ee.MODEL},{text:"Images",icon:It.imageIcon,page:Xs.ASSETS,assetType:Ee.IMAGE},{text:"Shapes",icon:It.shapesIcon,page:Xs.ASSETS,assetType:Ee.SHAPE},{text:"Lights",icon:It.lightbulbIcon,page:Xs.ASSETS,assetType:Ee.LIGHT},{text:"Materials",icon:It.materialIcon,page:Xs.MATERIALS},{text:"Textures",icon:It.textureIcon,page:Xs.TEXTURES}];class LibraryPage extends PaginatedIconsPage{constructor(e){super(e,!1,!0),this._assets=Ii.getLibrary(),this._items=Object.keys(nr),this._addPageContent(),this._createSearchButton()}_addPageContent(){let e=ThreeMeshUIHelper.createTextBlock({text:"Assets",fontSize:Bt,height:.04,width:.2});this._container.add(e),this._addList()}_createSearchButton(){let e=new ve.Block({height:.06,width:.06,backgroundColor:Ct.defaultMenuBackground,backgroundOpacity:0}),t=ThreeMeshUIHelper.createButtonBlock({backgroundTexture:It.searchIcon,backgroundTextureScale:.8,height:.04,width:.04,padding:.01});e.set({fontFamily:yt,fontTexture:vt}),e.position.fromArray([-.175,.12,-.001]),e.add(t);let i=new PointerInteractable(t,(()=>{this._controller.pushPage(Xs.LIBRARY_SEARCH)}));this._containerInteractable.addChild(i),this._object.add(e)}_getItemName(e){return nr[e].text}_getItemIcon(e){return nr[e].icon}_handleItemInteraction(e){if(nr[e].assetType){this._controller.getPage(nr[e].page).setContent(nr[e].assetType,nr[e].text)}this._controller.pushPage(nr[e].page)}_refreshItems(){}}class LibrarySearchPage extends PaginatedPage{constructor(e){super(e,!1,!0),this._assets=Ii.getLibrary(),this._items=Object.keys(this._assets),this._addPageContent()}_addPageContent(){this._textField=new TextField({height:.04,width:.4,fontSize:Bt,onBlur:()=>{this._searchUpdated()},onUpdate:()=>{this._searchUpdated()}}),this._textField.addToScene(this._container,this._containerInteractable),this._addList()}_searchUpdated(){this._refreshItems(),this._updateItemsGUI()}_getItemName(e){let t=this._assets[e].Name;return t.length>25&&(t="..."+t.substring(t.length-25)),t}_handleItemInteraction(e){this._controller.getPage(Xs.ASSET).setAsset(e),this._controller.pushPage(Xs.ASSET)}_refreshItems(){this._assets=Ii.getLibrary(),this._items=this._getFilteredItems()}_getFilteredItems(){let e=[],t=this._textField.content.toLowerCase();for(let i in this._assets)if(this._assets[i].Name.toLowerCase().includes(t))e.push(i);else{let s=Gn.getInstancesForAssetId(i);for(let n in s)if(s[n].getName().toLowerCase().includes(t)){e.push(i);break}}return e}back(){this._textField.deactivate(),super.back()}}class MaterialPage extends DynamicFieldsPage{constructor(e){super(e,!1,!0)}_createTitleBlock(){this._titleBlock=new ve.Block({height:.04,width:.43,contentDirection:"row",justifyContent:"end",backgroundOpacity:0,margin:.01,offset:0}),this._titleField=new TextField({height:.04,width:.31,fontSize:Bt,margin:0,onBlur:()=>{this._material.getEditorHelper().updateName(this._titleField.content)}});let e=ThreeMeshUIHelper.createButtonBlock({backgroundTexture:It.trashIcon,backgroundTextureScale:.7,height:.04,width:.04});this._titleBlock.add(this._titleField.getObject()),this._titleBlock.add(e),this._titleField.setPointerInteractableParent(this._containerInteractable);let t=new PointerInteractable(e,(()=>{Os.deleteMaterial(this._material)}));this._containerInteractable.addChild(t)}setMaterial(e){this._material=e;let t=e.getName();this._titleField.setContent(t),this._setFields(e.getEditorHelper().getMenuFields())}_addSubscriptions(){tt.subscribe(this._id,Ne,(e=>{e.material==this._material&&this._controller.popPagesPast(Xs.MATERIAL)})),tt.subscribe(this._id,Ue,(e=>{e.asset==this._material&&this._titleField.setContent(e.asset.getName())})),tt.subscribe(this._id,Ke,(e=>{e&&(this._removeSubscriptions(),this._containerInteractable.removeChild(this._previousInteractable),this._containerInteractable.removeChild(this._nextInteractable),this._controller.setPage(Xs.NAVIGATION))}))}_removeSubscriptions(){tt.unsubscribe(this._id,Ne),tt.unsubscribe(this._id,Ue),tt.unsubscribe(this._id,Ke)}back(){this._removeCurrentFields(),this._containerInteractable.removeChild(this._previousInteractable),this._containerInteractable.removeChild(this._nextInteractable),this._removeSubscriptions(),super.back()}addToScene(e,t){this._addSubscriptions(),super.addToScene(e,t)}removeFromScene(){super.removeFromScene()}}class MaterialsPage extends PaginatedPage{constructor(e){super(e,!1,!0),this._materials=Os.getMaterials(),this._items=Object.keys(this._materials),this._addPageContent(),this._createAddButton()}_addPageContent(){let e=ThreeMeshUIHelper.createTextBlock({text:"Materials",fontSize:Bt,height:.04,width:.2});this._container.add(e),this._addList()}_createAddButton(){let e=new ve.Block({height:.06,width:.06,backgroundColor:Ct.defaultMenuBackground,backgroundOpacity:0}),t=ThreeMeshUIHelper.createButtonBlock({text:"+",fontSize:.04,height:.04,width:.04});e.set({fontFamily:yt,fontTexture:vt}),e.position.fromArray([.175,.12,-.001]),e.add(t);let i=new PointerInteractable(t,(()=>{this._controller.getPage(Xs.NEW_MATERIAL).setContent((e=>{this._handleItemInteraction(e.getId())})),this._controller.pushPage(Xs.NEW_MATERIAL)}));this._containerInteractable.addChild(i),this._object.add(e)}_getItemName(e){let t=this._materials[e].getName();return t.length>25&&(t="..."+t.substring(t.length-25)),t}_handleItemInteraction(e){this._controller.getPage(Xs.MATERIAL).setMaterial(this._materials[e]),this._controller.pushPage(Xs.MATERIAL)}_refreshItems(){this._materials=Os.getMaterials(),this._items=Object.keys(this._materials)}_addSubscriptions(){tt.subscribe(this._id,Le,(e=>{this._refreshItems(),this._updateItemsGUI()})),tt.subscribe(this._id,Ue,(e=>{this._refreshItems(),this._updateItemsGUI()})),tt.subscribe(this._id,Ne,(e=>{this._refreshItems(),this._updateItemsGUI()})),tt.subscribe(this._id,Ke,(e=>{e&&(this._refreshItems(),this._updateItemsGUI())}))}_removeSubscriptions(){tt.unsubscribe(this._id,Le),tt.unsubscribe(this._id,Ue),tt.unsubscribe(this._id,Ne),tt.unsubscribe(this._id,Ke)}addToScene(e,t){this._addSubscriptions(),super.addToScene(e,t)}removeFromScene(){this._removeSubscriptions(),super.removeFromScene()}}const rr=[{title:"Hand Tools",menuPage:Xs.HANDS},{title:"Library",menuPage:Xs.LIBRARY},{title:"Settings",menuPage:Xs.SETTINGS},{title:"Project File",menuPage:Xs.PROJECT},{title:"Connect with Peers",menuPage:Xs.PARTY}];class NavigationPage extends MenuPage{constructor(e){super(e,!1),this._addPageContent()}_addPageContent(){let e=ThreeMeshUIHelper.createTextBlock({text:"Menu",fontSize:Bt,height:.04,width:.2});this._container.add(e);let t=new ve.Block({height:.2,width:.45,contentDirection:"column",justifyContent:"start",backgroundOpacity:0}),i=Be.authUrl&&Be.partyUrl;for(let e of rr){if("XR"!=Be.deviceType&&e.menuPage==Xs.HANDS)continue;if(e.menuPage==Xs.PARTY&&!i)continue;let s=ThreeMeshUIHelper.createButtonBlock({text:e.title,fontSize:Et,height:.035,width:.3,margin:.002});t.add(s);let n=new PointerInteractable(s,(()=>{this._controller.pushPage(e.menuPage)}));this._containerInteractable.addChild(n)}this._container.add(t)}}const ar="BASIC",or="LAMBERT",lr="NORMAL",hr="PHONG",cr="STANDARD",dr="TOON",Ar=[{title:"Basic",materialType:ar},{title:"Lambert",materialType:or},{title:"Normal",materialType:lr},{title:"Phong",materialType:hr},{title:"Standard",materialType:cr},{title:"Toon",materialType:dr}];class NewMaterialPage extends PaginatedPage{constructor(e){super(e,!1,!0),this._items=Ar,this._addPageContent()}_addPageContent(){let e=ThreeMeshUIHelper.createTextBlock({text:"Add New Material",fontSize:Bt,height:.04,width:.3});this._container.add(e),this._addList()}_getItemName(e){return e.title}_handleItemInteraction(e){let t=Os.addNewMaterial(e.materialType);this.back(),this._additionalAction&&this._additionalAction(t)}_refreshItems(){}setContent(e){this._additionalAction=e}}const ur=[{title:"Basic",textureType:gn},{title:"Cube",textureType:mn}];class NewTexturePage extends PaginatedPage{constructor(e){super(e,!1,!0),this._items=ur,this._addPageContent()}_addPageContent(){let e=ThreeMeshUIHelper.createTextBlock({text:"Add New Texture",fontSize:.03,height:.04,width:.3});this._container.add(e),this._addList()}_getItemName(e){return e.title}_handleItemInteraction(e){let t=Ls.addNewTexture(e.textureType);this.back(),this._additionalAction&&this._additionalAction(t)}_refreshItems(){}setContent(e){this._additionalAction=e}}const pr=[{title:"Host Party",menuPage:Xs.HOST_PARTY},{title:"Join Party",menuPage:Xs.JOIN_PARTY}],gr=[{title:"Display Usernames",handler:"_handleDisplayUsernames"},{title:"Update Username",handler:"_handleUpdateUsername"},{title:"Mute Myself",handler:"_handleMuteMyself"},{title:"Mute Friends",handler:"_handleMuteFriends"},{title:"Disconnect",handler:"_handleDisconnect"},{title:"Users",type:"label"}];class PartyPage extends DynamicFieldsPage{constructor(e){super(e),this._connected=!1,this._displayingUsernames=!1,this._mutedMyself=!1,this._mutedPeers=!1,this._fieldsContainer.set({justifyContent:"start"}),this._peerFields={},this._addFields()}_createTitleBlock(){this._titleBlock=ThreeMeshUIHelper.createTextBlock({text:"Party",fontSize:Bt,height:.04,width:.4,offset:0})}_addFields(){this._connectedFields=[],this._disconnectedFields=[];for(let e of pr){let t=new ButtonEntity(e.title,(()=>{this._controller.pushPage(e.menuPage)}));this._disconnectedFields.push(t)}for(let e of gr){let t;e.handler?t=new ButtonEntity(e.title,(()=>{this[e.handler]()})):"label"==e.type&&(t=new TextEntity(e.title)),this._connectedFields.push(t)}this._setFields(this._disconnectedFields)}_handleDisplayUsernames(){this._displayingUsernames=!this._displayingUsernames;let e=this._connectedFields[0].getObject();this._displayingUsernames?e.children[1].set({content:"Hide Usernames"}):e.children[1].set({content:"Display Usernames"}),zs.setDisplayingUsernames(this._displayingUsernames)}_handleUpdateUsername(){let e=this._controller.getPage(Xs.TEXT_INPUT),t=zs.getUsername();e.setContentWithInitialValue("Update Username",t,"Update",(e=>{(e=e.trim())?(zs.setUsername(e),this._controller.back()):tt.publish(this._id,Ge,{text:"Username can't be blank"})})),this._controller.pushPage(Xs.TEXT_INPUT)}_handleDisconnect(){Rs.disconnect(),this._updateFields()}_handleMuteMyself(){this._mutedMyself=!this._mutedMyself;let e=this._connectedFields[2].getObject();this._mutedMyself?e.children[1].set({content:"Unmute Myself"}):e.children[1].set({content:"Mute Myself"});for(let e in this._peerFields)this._peerFields[e].toggleMyselfMuted(this._mutedMyself)}_handleMuteFriends(){this._mutedPeers=!this._mutedPeers;let e=this._connectedFields[3].getObject();this._mutedPeers?e.children[1].set({content:"Unmute Friends"}):e.children[1].set({content:"Mute Friends"});for(let e in this._peerFields)this._peerFields[e].togglePeerMuted(this._mutedPeers)}_updateFields(){if(zs.isPartyActive()){if(!this._checkPeers()&&this._connected)return;this._setFields(this._connectedFields.concat(Object.values(this._peerFields))),this._connected=!0}else{for(let e in this._peerFields)delete this._peerFields[e];this._setFields(this._disconnectedFields),this._connected=!1}}_checkPeers(){let e=!1,t=zs.getPeers();for(let i in t)if(!(i in this._peerFields)&&t[i].rtc){let s=t[i];this._peerFields[i]=new PeerEntity(s,s.username,this._controller,(e=>this._abdicateHost(e))),this._mutedMyself&&this._peerFields[i].toggleMyselfMuted(!0),this._mutedPeers&&this._peerFields[i].togglePeerMuted(!0),e=!0}for(let i in this._peerFields)i in t?this._peerFields[i].setUsername(t[i].username):(this._peerFields[i].removeFromScene(),delete this._peerFields[i],e=!0);return e}_abdicateHost(e){for(let e in this._peerFields)this._peerFields[e].toggleHost(!1)}_handlePeerConnected(e){if(!this._connected)return;let t=e.peer,i=new PeerEntity(t,t.username,this._controller,(e=>this._abdicateHost(e)));this._mutedMyself&&i.toggleMyselfMuted(!0),this._mutedPeers&&i.togglePeerMuted(!0),this._peerFields[t.id]=i,this._fields.push(i),this._fields.length==this._lastItemIndex+2&&(this._removeCurrentFields(),this._lastItemIndex=this._firstItemIndex-1,this._loadNextPage())}_addSubscriptions(){tt.subscribe(this._id,Te,(()=>{for(let e in this._peerFields)this._peerFields[e].toggleHost(!0)})),tt.subscribe(this._id,Ve,(()=>{this._connected||this._updateFields()})),tt.subscribe(this._id,ze,(()=>{this._connected&&this._updateFields()})),tt.subscribe(this._id,Ye,(e=>{this._handlePeerConnected(e)})),tt.subscribe(this._id,Xe,(e=>{if(!this._connected)return;let t=e.peer,i=this._peerFields[t.id];i&&(this._removeField(i),delete this._peerFields[t.id])})),tt.subscribe(this._id,We,(e=>{if(!this._connected)return;let t=e.peer;this._peerFields[t.id].setUsername(t.username)}))}_removeSubscriptions(){tt.unsubscribe(this._id,Ve),tt.unsubscribe(this._id,ze),tt.unsubscribe(this._id,Ye),tt.unsubscribe(this._id,Xe),tt.unsubscribe(this._id,We)}addToScene(e,t){this._updateFields(),this._addSubscriptions(),super.addToScene(e,t)}removeFromScene(){this._removeSubscriptions(),super.removeFromScene()}}class MenuEntity extends PointerInteractableEntity{constructor(){super()}getHeight(){return.039}updateFromSource(){}deactivate(){}}class ButtonEntity extends MenuEntity{constructor(e,t){super(),this._object=ThreeMeshUIHelper.createButtonBlock({text:e,fontFamily:yt,fontTexture:vt,fontSize:Et,height:.035,width:.3,margin:.002}),this._pointerInteractable=new PointerInteractable(this._object,t)}}class TextEntity extends MenuEntity{constructor(e){super(),this._object=ThreeMeshUIHelper.createTextBlock({text:e,fontFamily:yt,fontTexture:vt,fontSize:Et,height:.035,width:.3,offset:0,margin:.002})}getHeight(){return.045}}class PeerEntity extends MenuEntity{constructor(e,t,i,s){super(),this._peer=e,this._controller=i,this._designateHostCallback=s,this._mutedMyself=!1,this._mutedPeer=!1,this._object=new ve.Block({fontFamily:yt,fontTexture:vt,height:.035,width:.31,contentDirection:"row",justifyContent:"start",backgroundOpacity:0,offset:0,margin:.002}),this._addContent(t)}_addContent(e){this._usernameBlock=ThreeMeshUIHelper.createButtonBlock({text:e||"...",fontFamily:yt,fontTexture:vt,fontSize:Et,height:.035,width:.228,offset:0,margin:.002});let t={backgroundTexture:It.microphoneIcon,backgroundTextureScale:.85,height:.035,width:.035,margin:.002};this._muteMyselfButton=ThreeMeshUIHelper.createButtonBlock(t),t.backgroundTexture=It.headphonesIcon,this._mutePeerButton=ThreeMeshUIHelper.createButtonBlock(t),this._muteMyselfButton.children[1].set({backgroundColor:Ct.green}),this._mutePeerButton.children[1].set({backgroundColor:Ct.green}),zs.isHost()||this._usernameBlock.set({backgroundOpacity:0}),this._object.add(this._usernameBlock),this._object.add(this._muteMyselfButton),this._object.add(this._mutePeerButton),this._addInteractables()}_addInteractables(){this._usernameInteractable=new PointerInteractable(this._usernameBlock,(()=>{this._controller.getPage(Xs.PEER).setContent(this._peer,this._designateHostCallback),this._controller.pushPage(Xs.PEER)})),this._muteMyselfInteractable=new PointerInteractable(this._muteMyselfButton,(()=>{this.toggleMyselfMuted()})),this._mutePeerInteractable=new PointerInteractable(this._mutePeerButton,(()=>{this.togglePeerMuted()})),zs.isHost()&&this._pointerInteractable.addChild(this._usernameInteractable),this._pointerInteractable.addChild(this._muteMyselfInteractable),this._pointerInteractable.addChild(this._mutePeerInteractable)}toggleHost(e){e?(this._pointerInteractable.addChild(this._usernameInteractable),this._usernameBlock.set({backgroundOpacity:.7})):(this._pointerInteractable.removeChild(this._usernameInteractable),this._usernameBlock.set({backgroundOpacity:0}))}toggleMyselfMuted(e){if(e==this._mutedMyself)return;let t;this._mutedMyself=!this._mutedMyself,t=this._mutedMyself?Ct.red:Ct.green,this._peer.rtc.toggleMyselfMuted(this._mutedMyself),this._muteMyselfButton.children[1].set({backgroundColor:t})}togglePeerMuted(e){if(e==this._mutedPeer)return;let t;this._mutedPeer=!this._mutedPeer,t=this._mutedPeer?Ct.red:Ct.green,this._peer.rtc.togglePeerMuted(this._mutedPeer),this._mutePeerButton.children[1].set({backgroundColor:t})}setUsername(e){e=rt(e||"...",12),this._usernameBlock.children[1].content!=e&&this._usernameBlock.children[1].set({content:e})}addToScene(e,t){this.setUsername(this._peer.username),super.addToScene(e,t)}}const mr=[{title:"Make Host",handler:"_handleMakeHost"},{title:"Kick Out",handler:"_handleKickOut"}];class PeerPage extends MenuPage{constructor(e){super(e,!1,!0),this._addPageContent()}_addPageContent(){this._titleBlock=ThreeMeshUIHelper.createTextBlock({text:" ",fontSize:Bt,height:.04,width:.4}),this._container.add(this._titleBlock);let e=new ve.Block({height:.2,width:.45,contentDirection:"column",justifyContent:"start",backgroundOpacity:0});for(let t of mr){let i=ThreeMeshUIHelper.createButtonBlock({text:t.title,fontSize:Et,height:.035,width:.3,margin:.002}),s=new PointerInteractable(i,(()=>this[t.handler]()));e.add(i),this._containerInteractable.addChild(s)}this._container.add(e)}_handleMakeHost(){this._designateHostCallback&&this._designateHostCallback(this._peer.id),zs.setIsHost(!1),Rs.designateHost(this._peer.id),this._controller.back()}_handleKickOut(){Rs.bootPeer(this._peer.id),this._controller.back()}setContent(e,t){let i=rt(e.username||"...",12);this._titleBlock.children[1].set({content:i}),this._peer=e,this._designateHostCallback=t}_addSubscriptions(){tt.subscribe(this._id,ze,(()=>{this._controller.back()})),tt.subscribe(this._id,Xe,(e=>{this._peer==e.peer&&this._controller.back()})),tt.subscribe(this._id,We,(e=>{this._peer==e.peer&&this.setContent(this._peer)}))}_removeSubscriptions(){tt.unsubscribe(this._id,ze),tt.unsubscribe(this._id,Xe),tt.unsubscribe(this._id,We)}back(){this._removeSubscriptions(),super.back()}addToScene(e,t){this._addSubscriptions(),super.addToScene(e,t)}}const _r=[{parameter:"visualEdit"},{parameter:"intensity",name:"Intensity",min:0,type:NumberInput},{parameter:"color",name:"Color",type:ColorInput},{parameter:"position"},{parameter:"rotation"},{parameter:"scale"}];class PrimitiveLightHelper extends AssetHelper{constructor(e){super(e),this._createMesh()}_createMesh(){console.error("PrimitiveLightHelper._createMesh() should be overridden")}_updateVisualEdit(e){e?this._object.add(this._mesh):(this._object.remove(this._mesh),ot(this._mesh)),super._updateVisualEdit(e)}_getMenuFieldsMap(){let e=super._getMenuFieldsMap();for(let t of _r)if(!(t.parameter in e)){let i=this._createStandardInput(t);i&&(e[t.parameter]=i)}return e}}class PrimitiveLight extends Asset{constructor(e={}){super(e),this._color=st(e.color,16777215),this._intensity=st(e.intensity,1)}_createEditorHelper(){this._editorHelper=new PrimitiveLightHelper(this)}clone(e){let t=this._fetchCloneParams(e);return Gn.addLight(t,this._assetId)}exportParams(){let e=super.exportParams();return e.color=this._light.color.getHex(),e.intensity=this._intensity,e}getColor(){return this._color}getIntensity(){return this._intensity}setColor(e){this._color!=e&&(this._color=e,this._light.color.setHex(e))}setIntensity(e){this._intensity!=e&&(this._intensity=e,this._light.intensity=e)}}const fr=[{parameter:"visualEdit"},{parameter:"intensity"},{parameter:"color"},{parameter:"position"},{parameter:"rotation"},{parameter:"scale"}];class PrimitiveAmbientLightHelper extends PrimitiveLightHelper{constructor(e){super(e)}_createMesh(){let t=new e.BoxGeometry(.1,.1,.1),i=new e.MeshBasicMaterial({color:Ct.yellow});this._mesh=new e.Mesh(t,i),this._asset.visualEdit&&this._object.add(this._mesh)}getMenuFields(){return super.getMenuFields(fr)}}const br="7605bff2-8ca3-4a47-b6f7-311d745507de";class PrimitiveAmbientLight extends PrimitiveLight{constructor(e={}){super(e),this._assetId=br,this._createLight(),e.isPreview&&this.makeTranslucent()}_createEditorHelper(){this._editorHelper=new PrimitiveAmbientLightHelper(this)}_createLight(){this._light=new e.AmbientLight(this._color,this._intensity),this._object.add(this._light)}}Gn.registerLight(PrimitiveAmbientLight,br,"Ambient Light");let Ir=new class{constructor(){this._triggerDelayedClickEvent=!1,this._addEventListeners()}_addEventListeners(){"XR"!=Be.deviceType&&(this._eventType="MOBILE"==Be.deviceType?"touchend":"click",this._clickListener=e=>{setTimeout((()=>{this._triggerDelayedClickEvent&&(this._triggerDelayedClickEvent=!1,this._callback&&this._callback())}),20)})}triggerEvent(){this._triggerDelayedClickEvent=!0}listenForClick(e){this._callback=e,document.addEventListener(this._eventType,this._clickListener)}stopListening(){this._callback=null,this._fileListenerActive=!1,document.removeEventListener(this._eventType,this._clickListener)}};const wr={"New Project":"_newProject","Load from Device":"_localLoad","Load from Google Drive":"_googleDriveLoad","Save to Device":"_localSave","Save to Google Drive":"_googleDriveSave","Sign out of Google Drive":"_googleDriveSignout"};class ProjectPage extends PaginatedPage{constructor(e){super(e,!1,!0),this._items=Object.keys(wr).slice(0,-1),this._addPageContent(),this._addSubscriptions()}_addPageContent(){let e=ThreeMeshUIHelper.createTextBlock({text:"Project File",fontSize:Bt,height:.04,width:.2});this._container.add(e),this._loadingSavingBlock=ThreeMeshUIHelper.createTextBlock({text:"Project Loading...",fontSize:.025,height:.04,width:.4,fontFamily:yt,fontTexture:vt}),this._addList()}_getItemName(e){return e}_handleItemInteraction(e){this[wr[e]]()}_refreshItems(){sr.isSignedIn()?this._items=Object.keys(wr):this._items=Object.keys(wr).slice(0,-1)}_newProject(){if(zs.isPartyActive()&&!zs.isHost())return void tt.publish(this._id,Ge,{text:"Only Host Can Load Projects"});Gn.reset();let e=new PrimitiveAmbientLight({visualEdit:!1});Gn.addLight(e,e.getAssetId(),!0),sr.clearActiveFile(),zs.isPartyActive()&&zs.isHost()&&zs.sendProject()}_localSave(){this._updateSaving(!1),tt.publish(this._id,Ze,!1),Gn.exportProject().generateAsync({type:"blob"}).then((e=>{this._updateSaving(!0),tt.publish(this._id,Ze,!0),saveAs(e,"Digital Bacon Project.zip")}),(e=>{console.error(e),this._updateSaving(!0),tt.publish(this._id,Ze,!0),tt.publish(this._id,Ge,{text:"Error Saving Project"})}))}_localLoad(){!zs.isPartyActive()||zs.isHost()?zi.triggerUpload():tt.publish(this._id,Ge,{text:"Only Host Can Load Projects"})}_googleDriveSave(){if(sr.isSignedIn()){if(sr.hasActiveFile())return this._updateSaving(!1),tt.publish(this._id,Ze,!1),void sr.save(Gn.exportProject(),(()=>{this._saveSuccessCallback()}),(()=>{this._saveErrorCallback()}));this._controller.getPage(Xs.TEXT_INPUT).setContent("Save Project As","Filename","Save",(e=>{this._updateSaving(!1),tt.publish(this._id,Ze,!1),sr.saveAs(e,Gn.exportProject(),(()=>{this._saveSuccessCallback()}),(()=>{this._saveErrorCallback()})),this._controller.back()})),this._controller.pushPage(Xs.TEXT_INPUT)}else this._googleDriveSignin((()=>this._googleDriveSave()))}_googleDriveLoad(){if(!zs.isPartyActive()||zs.isHost())if(sr.isSignedIn()){this._controller.getPage(Xs.LOAD_GDRIVE).loadProjects(),this._controller.pushPage(Xs.LOAD_GDRIVE)}else this._googleDriveSignin((()=>this._googleDriveLoad()));else tt.publish(this._id,Ge,{text:"Only Host Can Load Projects"})}_googleDriveSignin(e){this._googleSigninCallback=e,"XR"==Be.deviceType?(Ri.exitXRSession(),sr.handleAuthButton((()=>{this._handleGoogleAuthResponse()}))):Ir.triggerEvent()}_handleGoogleAuthResponse(){this._refreshItems(),this._updateItemsGUI(),this._googleSigninCallback&&this._googleSigninCallback()}_googleDriveSignout(){sr.isSignedIn()&&sr.handleSignoutButton(),this._page=0,this._refreshItems(),this._updateItemsGUI()}_handleLocalFile(e){this._updateLoading(!1),tt.publish(this._id,Ze,!1),JSZip.loadAsync(e).then((e=>{sr.clearActiveFile(),Gn.loadZip(e,(()=>{tt.publish(this._id,Ge,{text:"Project Loaded"}),zs.isPartyActive()&&zs.isHost()&&zs.sendProject()}),(()=>{this._loadErrorCallback()}))}))}_loadErrorCallback(){tt.publish(this._id,Ge,{text:"Error Loading Project",sustainTime:5})}_saveSuccessCallback(){this._updateSaving(!0),tt.publish(this._id,Ze,!0),tt.publish(this._id,Ge,{text:"Project Saved"})}_saveErrorCallback(){this._updateSaving(!0),tt.publish(this._id,Ze,!0),tt.publish(this._id,Ge,{text:"Error Saving Project"})}_addSubscriptions(){tt.subscribe(this._id,Ke,(e=>{this._updateLoading(e)})),tt.subscribe(this._id,Ze,(e=>{this._updateSaving(e)}))}_updateLoading(e){this._loadingSavingBlock.children[1].set({content:"Project Loading..."}),this._updateLoadingSaving(e)}_updateSaving(e){this._loadingSavingBlock.children[1].set({content:"Project Saving..."}),this._updateLoadingSaving(e)}_updateLoadingSaving(e){e?(this._container.remove(this._loadingSavingBlock),this._container.add(this._optionsContainer),this._container.update(!1,!1,!0)):(this._container.remove(this._optionsContainer),this._container.add(this._loadingSavingBlock))}addToScene(e,t){Ir.listenForClick((()=>{sr.handleAuthButton((()=>{this._handleGoogleAuthResponse()}))})),zi.listenForProjectFile((e=>{this._handleLocalFile(e)})),super.addToScene(e,t)}removeFromScene(){Ir.stopListening(),zi.stopListening(),super.removeFromScene()}}let Cr=new class{init(e){this._setupIframe(e),this._addEventListeners()}_setupIframe(e){this._iframe=document.createElement("iframe"),this._iframe.id="digital-bacon-rpm-iframe",this._iframe.allow="camera *; microphone *; clipboard-write",this._iframe.src="https://digitalbacon.readyplayer.me/avatar?frameApi",this._iframe.hidden=!0,this._closeButton=document.createElement("button"),this._closeButton.innerHTML="Close Ready Player Me",this._closeButton.id="ready-player-me-close-button",$(this._closeButton).addClass("hidden"),e.append(this._iframe),e.append(this._closeButton)}_addEventListeners(){window.addEventListener("message",(e=>{this._handleMessage(e)})),this._closeButton.addEventListener("click",(()=>{this._close()}))}_handleMessage(e){const t=function(e){try{return JSON.parse(e.data)}catch(e){return null}}(e);t&&"readyplayerme"===t.source&&("v1.frame.ready"===t.eventName&&this._iframe.contentWindow.postMessage(JSON.stringify({target:"readyplayerme",type:"subscribe",eventName:"v1.**"}),"*"),"v1.avatar.exported"===t.eventName&&(Ps.updateAvatar(t.data.url),this._close()),t.eventName)}_close(){$(this._closeButton).addClass("hidden"),this._iframe.hidden=!0}selectAvatar(){$(this._closeButton).removeClass("hidden"),this._iframe.hidden=!1,"XR"==Be.deviceType&&Ri.exitXRSession()}};const yr=[{title:"Backdrop",menuPage:Xs.SKYBOX,isEditorOnly:!0},{title:"User Settings",menuPage:Xs.USER_SETTINGS},{title:"Editor Settings",menuPage:Xs.EDITOR_SETTINGS,isEditorOnly:!0},{title:"Update Avatar"}];class SettingsPage extends MenuPage{constructor(e){super(e,!1,!0),this._addPageContent()}_addPageContent(){let e=ThreeMeshUIHelper.createTextBlock({text:"Settings",fontSize:Bt,height:.04,width:.2});this._container.add(e);let t=new ve.Block({height:.2,width:.45,contentDirection:"column",justifyContent:"start",backgroundOpacity:0});for(let e of yr){if(!Be.isEditor&&e.isEditorOnly)continue;let i=ThreeMeshUIHelper.createButtonBlock({text:e.title,fontSize:Et,height:.035,width:.3,margin:.002});t.add(i);let s=new PointerInteractable(i,(()=>{e.menuPage?this._controller.pushPage(e.menuPage):Cr.selectAvatar()}));this._containerInteractable.addChild(s)}this._container.add(t)}}const vr=[Oi.TOP,Oi.LEFT,Oi.FRONT,Oi.RIGHT,Oi.BACK,Oi.BOTTOM];class SkyboxPage extends MenuPage{constructor(e){super(e,!1,!0),this._buttons=[],this._addPageContent()}_addPageContent(){let e=ThreeMeshUIHelper.createTextBlock({text:"Backdrop",fontSize:Bt,height:.04,width:.2});this._container.add(e);let t=new ve.Block({height:.2,width:.45,contentDirection:"column",justifyContent:"start",backgroundOpacity:0}),i=new ve.Block({height:.064,width:.3,contentDirection:"row",justifyContent:"center",backgroundOpacity:0});for(let e=0;e<vr.length;e++){let s=ThreeMeshUIHelper.createButtonBlock({backgroundTexture:It.searchIcon,height:.06,width:.06,margin:.002,borderRadius:1e-5}),n=new PointerInteractable(s,(()=>{let t=Ii.getLibrary(),i={"null\n":{Name:"Blank"}};for(let e in t){let s=t[e];s.Type==Ee.IMAGE&&(i[e]=s)}this._controller.getPage(Xs.ASSET_SELECT).setContent(i,(t=>{"null\n"==t&&(t=null),Hi.setSkyboxSide(vr[e],t),this._controller.back()}),(()=>{this._fileUploadSide=vr[e],zi.triggerUpload()}),(()=>{zi.stopListening()})),this._controller.pushPage(Xs.ASSET_SELECT),zi.listenForAssets((e=>{e.length>0&&(Hi.setSkyboxSide(this._fileUploadSide,e[0]),this._controller.back())}),!1,Ee.IMAGE)}));if(this._containerInteractable.addChild(n),0==e){let e=new ve.Block({height:.064,width:.128,contentDirection:"row",justifyContent:"start",backgroundOpacity:0});e.add(s),t.add(e)}else if(e<5)i.add(s);else{t.add(i);let e=new ve.Block({height:.064,width:.128,contentDirection:"row",justifyContent:"start",backgroundOpacity:0});e.add(s),t.add(e)}this._buttons.push(s)}this._container.add(t)}_setTextures(){let e=Hi.getSkyboxTextures();for(let t=0;t<vr.length;t++)this._buttons[t].children[1].backgroundTexture!=e[vr[t]]&&this._buttons[t].children[1].set({backgroundTexture:e[vr[t]]})}_addSubscriptions(){tt.subscribe(this._id,qe,(e=>{this._setTextures()}))}_removeSubscriptions(){tt.unsubscribe(this._id,qe)}addToScene(e,t){super.addToScene(e,t),this._setTextures(),this._addSubscriptions()}removeFromScene(){super.removeFromScene(),this._removeSubscriptions()}}class TexturePage extends DynamicFieldsPage{constructor(e){super(e,!1,!0)}_createTitleBlock(){this._titleBlock=new ve.Block({height:.04,width:.43,contentDirection:"row",justifyContent:"end",backgroundOpacity:0,margin:.01,offset:0}),this._titleField=new TextField({height:.04,width:.31,fontSize:Bt,margin:0,onBlur:()=>{this._texture.getEditorHelper().updateName(this._titleField.content)}});let e=ThreeMeshUIHelper.createButtonBlock({backgroundTexture:It.trashIcon,backgroundTextureScale:.7,height:.04,width:.04});this._titleBlock.add(this._titleField.getObject()),this._titleBlock.add(e),this._titleField.setPointerInteractableParent(this._containerInteractable);let t=new PointerInteractable(e,(()=>{Ls.deleteTexture(this._texture)}));this._containerInteractable.addChild(t)}setTexture(e){this._texture=e;let t=e.getName();this._titleField.setContent(t),this._setFields(e.getEditorHelper().getMenuFields())}_addSubscriptions(){tt.subscribe(this._id,$e,(e=>{e.texture==this._texture&&this._controller.popPagesPast(Xs.TEXTURE)})),tt.subscribe(this._id,et,(e=>{e.asset==this._texture&&this._titleField.setContent(e.asset.getName())})),tt.subscribe(this._id,Ke,(e=>{e&&(this._removeSubscriptions(),this._containerInteractable.removeChild(this._previousInteractable),this._containerInteractable.removeChild(this._nextInteractable),this._controller.setPage(Xs.NAVIGATION))}))}_removeSubscriptions(){tt.unsubscribe(this._id,$e),tt.unsubscribe(this._id,et),tt.unsubscribe(this._id,Ke)}back(){this._removeCurrentFields(),this._containerInteractable.removeChild(this._previousInteractable),this._containerInteractable.removeChild(this._nextInteractable),this._removeSubscriptions(),super.back()}addToScene(e,t){this._addSubscriptions(),super.addToScene(e,t)}removeFromScene(){super.removeFromScene()}}class TexturesPage extends PaginatedPage{constructor(e){super(e,!1,!0),this._textures=Ls.getTextures(),this._items=Object.keys(this._textures),this._addPageContent(),this._createAddButton()}_addPageContent(){let e=ThreeMeshUIHelper.createTextBlock({text:"Textures",fontSize:Bt,height:.04,width:.2});this._container.add(e),this._addList()}_createAddButton(){let e=new ve.Block({height:.06,width:.06,backgroundColor:Ct.defaultMenuBackground,backgroundOpacity:0}),t=ThreeMeshUIHelper.createButtonBlock({text:"+",fontSize:.04,height:.04,width:.04});e.set({fontFamily:yt,fontTexture:vt}),e.position.fromArray([.175,.12,-.001]),e.add(t);let i=new PointerInteractable(t,(()=>{this._controller.getPage(Xs.NEW_TEXTURE).setContent((e=>{this._handleItemInteraction(e.getId())})),this._controller.pushPage(Xs.NEW_TEXTURE)}));this._containerInteractable.addChild(i),this._object.add(e)}_getItemName(e){let t=this._textures[e].getName();return t.length>25&&(t="..."+t.substring(t.length-25)),t}_handleItemInteraction(e){this._controller.getPage(Xs.TEXTURE).setTexture(this._textures[e]),this._controller.pushPage(Xs.TEXTURE)}_refreshItems(){this._textures=Ls.getTextures(),this._items=Object.keys(this._textures)}_addSubscriptions(){tt.subscribe(this._id,Je,(e=>{this._refreshItems(),this._updateItemsGUI()})),tt.subscribe(this._id,et,(e=>{this._refreshItems(),this._updateItemsGUI()})),tt.subscribe(this._id,$e,(e=>{this._refreshItems(),this._updateItemsGUI()})),tt.subscribe(this._id,Ke,(e=>{e&&(this._refreshItems(),this._updateItemsGUI())}))}_removeSubscriptions(){tt.unsubscribe(this._id,Je),tt.unsubscribe(this._id,et),tt.unsubscribe(this._id,$e),tt.unsubscribe(this._id,Ke)}addToScene(e,t){this._addSubscriptions(),super.addToScene(e,t)}removeFromScene(){this._removeSubscriptions(),super.removeFromScene()}}class TextInputPage extends MenuPage{constructor(e){super(e,!1,!0),this._addPageContent()}_addPageContent(){this._titleBlock=ThreeMeshUIHelper.createTextBlock({text:" ",fontSize:Bt,height:.04,width:.4}),this._container.add(this._titleBlock);let e=new ve.Block({height:.2,width:.45,contentDirection:"column",justifyContent:"start",backgroundOpacity:0});this._textField=new TextField({height:.04,width:.4,onEnter:()=>{this._inputConfirmed()}}),this._button=ThreeMeshUIHelper.createButtonBlock({text:" ",fontSize:Et,height:.04,width:.25,margin:.002});let t=new PointerInteractable(this._button,(()=>{this._inputConfirmed()}));this._textField.addToScene(e,this._containerInteractable),e.add(this._button),this._container.add(e),this._containerInteractable.addChild(t)}_inputConfirmed(){this._textField.deactivate(),this._action&&this._action(this._textField.content)}setContent(e,t,i,s){this._titleBlock.children[1].set({content:e}),this._button.children[1].set({content:i}),this._action=s,this._textField.setDefaultContent(t),this._textField.reset()}setContentWithInitialValue(e,t,i,s){this._titleBlock.children[1].set({content:e}),this._button.children[1].set({content:i}),this._action=s,this._textField.setContent(t)}back(){this._textField.deactivate(),super.back()}}class UploadPage extends MenuPage{constructor(e){super(e,!1,!0),this._addPageContent()}_addPageContent(){let e=ThreeMeshUIHelper.createTextBlock({text:"Upload Asset",fontSize:Bt,height:.04,width:.2});this._container.add(e);let t=new ve.Block({height:.2,width:.45,contentDirection:"column",justifyContent:"start",backgroundOpacity:0}),i=ThreeMeshUIHelper.createButtonBlock({text:"Select File",fontSize:Et,height:.035,width:.3});t.add(i);let s=new PointerInteractable(i,(()=>{zi.triggerUpload()}));this._containerInteractable.addChild(s),this._container.add(t)}_uploadCallback(e){this._controller.getPosition(St[0]),this._controller.getDirection(St[1]).normalize().divideScalar(4);let t=St[0].sub(St[1]).toArray();St[0].set(0,0,1),St[1].setY(0).normalize(),Tt.setFromUnitVectors(St[0],St[1]),xt.setFromQuaternion(Tt);let i=xt.toArray();for(let s of e){let e=Ii.getType(s);e==Ee.IMAGE?Gn.addImage({assetId:s,position:t,rotation:i,doubleSided:!0,transparent:!0,visualEdit:!0}):e==Ee.MODEL&&Gn.addGLTF({assetId:s,position:t,rotation:i,visualEdit:!0})}}addToScene(e,t){zi.listenForAssets((e=>{this._uploadCallback(e)}),!0),super.addToScene(e,t)}removeFromScene(){zi.stopListening(),super.removeFromScene()}}class UserSettingsPage extends DynamicFieldsPage{constructor(e){super(e,!1,!0),this._createFields()}_createTitleBlock(){this._titleBlock=ThreeMeshUIHelper.createTextBlock({text:"User Settings",fontSize:Bt,height:.04,width:.3})}_createFields(){let e=[];e.push(new NumberInput({title:"Movement Speed",minValue:0,maxValue:1e3,initialValue:4,onBlur:(e,t)=>{Hi.setUserSetting("Movement Speed",t)},getFromSource:()=>Hi.getUserSettings()["Movement Speed"]})),e.push(new CheckboxInput({title:"Enable Flying",initialValue:!0,onUpdate:e=>{Hi.setUserSetting("Enable Flying",e)},getFromSource:()=>Hi.getUserSettings()["Enable Flying"]})),this._setFields(e)}_addSubscriptions(){tt.subscribe(this._id,qe,(e=>{for(let e of this._fields)e.updateFromSource()}))}_removeSubscriptions(){tt.unsubscribe(this._id,qe)}addToScene(e,t){this._addSubscriptions();for(let e of this._fields)e.updateFromSource();super.addToScene(e,t)}removeFromScene(){this._removeSubscriptions(),super.removeFromScene()}}class EditorMenuController extends MenuController{constructor(){super(),this._pages[Xs.ASSET]=new AssetPage(this),this._pages[Xs.ASSETS]=new LightsPage(this),this._pages[Xs.ASSET_SELECT]=new AssetSelectPage(this),this._pages[Xs.COLOR_WHEEL]=new ColorWheelPage(this),this._pages[Xs.EDITOR_SETTINGS]=new EditorSettingsPage(this),this._pages[Xs.HOST_PARTY]=new HostPartyPage(this),this._pages[Xs.INSTANCE]=new InstancePage(this),this._pages[Xs.JOIN_PARTY]=new JoinPartyPage(this),this._pages[Xs.LIBRARY]=new LibraryPage(this),this._pages[Xs.LIBRARY_SEARCH]=new LibrarySearchPage(this),this._pages[Xs.LOAD_GDRIVE]=new LoadFromGDrivePage(this),this._pages[Xs.MATERIAL]=new MaterialPage(this),this._pages[Xs.MATERIALS]=new MaterialsPage(this),this._pages[Xs.NAVIGATION]=new NavigationPage(this),this._pages[Xs.NEW_MATERIAL]=new NewMaterialPage(this),this._pages[Xs.NEW_TEXTURE]=new NewTexturePage(this),this._pages[Xs.PARTY]=new PartyPage(this),this._pages[Xs.PEER]=new PeerPage(this),this._pages[Xs.PROJECT]=new ProjectPage(this),this._pages[Xs.SETTINGS]=new SettingsPage(this),this._pages[Xs.SKYBOX]=new SkyboxPage(this),this._pages[Xs.TEXTURE]=new TexturePage(this),this._pages[Xs.TEXTURES]=new TexturesPage(this),this._pages[Xs.TEXT_INPUT]=new TextInputPage(this),this._pages[Xs.UPLOAD]=new UploadPage(this),this._pages[Xs.USER_SETTINGS]=new UserSettingsPage(this),this._pageCalls.push(Xs.NAVIGATION),"XR"==Be.deviceType&&(this._pages[Xs.HANDS]=new HandsPage(this))}_createInteractables(){super._createInteractables(),Xi.addButtons(this._object,this._pointerInteractable)}}const Br=[{title:"Settings",menuPage:Xs.SETTINGS},{title:"Connect with Peers",menuPage:Xs.PARTY}];class HomePage extends MenuPage{constructor(e){super(e,!1),this._addPageContent()}_addPageContent(){let e=ThreeMeshUIHelper.createTextBlock({text:"Home",fontSize:Bt,height:.04,width:.2});this._container.add(e);let t=new ve.Block({height:.2,width:.45,contentDirection:"column",justifyContent:"start",backgroundOpacity:0}),i=Be.authUrl&&Be.partyUrl;for(let e of Br){if(e.menuPage==Xs.PARTY&&!i)continue;let s=ThreeMeshUIHelper.createButtonBlock({text:e.title,fontSize:Et,height:.035,width:.3,margin:.002});t.add(s);let n=new PointerInteractable(s,(()=>{this._controller.pushPage(e.menuPage)}));this._containerInteractable.addChild(n)}this._container.add(t)}}class LiveMenuController extends MenuController{constructor(){super(),this._pages[Xs.HOME]=new HomePage(this),this._pages[Xs.HOST_PARTY]=new HostPartyPage(this),this._pages[Xs.JOIN_PARTY]=new JoinPartyPage(this),this._pages[Xs.PARTY]=new PartyPage(this),this._pages[Xs.PEER]=new PeerPage(this),this._pages[Xs.SETTINGS]=new SettingsPage(this),this._pages[Xs.USER_SETTINGS]=new UserSettingsPage(this),this._pageCalls.push(Xs.HOME)}}var Er=function(){var e=0,t=document.createElement("div");function i(e){return t.appendChild(e.dom),e}function s(i){for(var s=0;s<t.children.length;s++)t.children[s].style.display=s===i?"block":"none";e=i}t.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",t.addEventListener("click",(function(i){i.preventDefault(),s(++e%t.children.length)}),!1);var n=(performance||Date).now(),r=n,a=0,o=i(new Er.Panel("FPS","#0ff","#002")),l=i(new Er.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var h=i(new Er.Panel("MB","#f08","#201"));return s(0),{REVISION:16,dom:t,addPanel:i,showPanel:s,begin:function(){n=(performance||Date).now()},end:function(){a++;var e=(performance||Date).now();if(l.update(e-n,200),e>=r+1e3&&(o.update(1e3*a/(e-r),100),r=e,a=0,h)){var t=performance.memory;h.update(t.usedJSHeapSize/1048576,t.jsHeapSizeLimit/1048576)}return e},update:function(){n=this.end()},domElement:t,setMode:s}};Er.Panel=function(e,t,i){var s=1/0,n=0,r=Math.round,a=r(window.devicePixelRatio||1),o=80*a,l=48*a,h=3*a,c=2*a,d=3*a,A=15*a,u=74*a,p=30*a,g=document.createElement("canvas");g.width=o,g.height=l,g.style.cssText="width:80px;height:48px";var m=g.getContext("2d");return m.font="bold "+9*a+"px Helvetica,Arial,sans-serif",m.textBaseline="top",m.fillStyle=i,m.fillRect(0,0,o,l),m.fillStyle=t,m.fillText(e,h,c),m.fillRect(d,A,u,p),m.fillStyle=i,m.globalAlpha=.9,m.fillRect(d,A,u,p),{dom:g,update:function(l,_){s=Math.min(s,l),n=Math.max(n,l),m.fillStyle=i,m.globalAlpha=1,m.fillRect(0,0,o,A),m.fillStyle=t,m.fillText(r(l)+" "+e+" ("+r(s)+"-"+r(n)+")",h,c),m.drawImage(g,d+a,A,u-a,p,d,A,u-a,p),m.fillRect(d+u-a,A,a,p),m.fillStyle=i,m.globalAlpha=.9,m.fillRect(d+u-a,A,a,r((1-l/_)*p))}}};class Main{constructor(t,i,s){this._renderer,this._scene,this._camera,this._clock=new e.Clock,this._container=document.getElementById(i),this._loadingMessage=document.querySelector("#digital-bacon-loading"),this._errorMessage=document.querySelector("#digital-bacon-error"),this._dynamicAssets=[],this._callback=t,this._createRenderer(),this._createScene(),this._createCamera(),this._createUser(),this._createHandlers(),this._createClients(),this._createAssets(s),this._addEventListeners(),this._onResize(),this._enableStats(),this._renderer.setAnimationLoop((()=>{this._loading()}))}_createRenderer(){this._renderer=new e.WebGLRenderer({antialias:!0}),this._container.appendChild(this._renderer.domElement),"XR"==Be.deviceType&&(this._renderer.xr.enabled=!0),Be.renderer=this._renderer}_createScene(){this._scene=new e.Scene,Be.scene=this._scene}_createCamera(){this._camera=new e.PerspectiveCamera(45,this._container.clientWidth/this._container.clientHeight,.1,1e3),Be.camera=this._camera,this._scene.add(this._camera)}_createUser(){Be.disableImmersion||(this._userObj=new e.Object3D,this._cameraFocus=new e.Object3D,"XR"!=Be.deviceType&&(this._camera.position.setY(.5),this._camera.position.setZ(1.9)),this._cameraFocus.add(this._camera),this._userObj.add(this._cameraFocus),this._scene.add(this._userObj),Be.cameraFocus=this._cameraFocus)}_createHandlers(){Gn.init(this._scene),Be.disableImmersion||(Ri.init(this._container),Pi.init(this._container,this._renderer,this._userObj),Ss.init(),"XR"==Be.deviceType&&Ds.init(),Es.init(this._renderer.domElement,this._camera,this._scene))}_createClients(){Be.disableImmersion||(Be.isEditor&&sr.init(),Cr.init(this._container))}_createAssets(e){if(Be.disableImmersion||(this._menuController=Be.isEditor?new EditorMenuController:new LiveMenuController,this._menuController.addToScene(this._scene),Be.menuController=this._menuController,Ps.init({"User Object":this._userObj,"Flight Enabled":!0}),Ps.addToScene(this._userObj)),e){let t=it();Be.loadingLocks.add(t),Gn.load(e,(()=>{Be.loadingLocks.delete(t)}),(e=>{if($(this._loadingMessage).removeClass("loading"),$(this._errorMessage).addClass("error"),e)throw e}))}else{let e=new PrimitiveAmbientLight({visualEdit:!1});Gn.addLight(e,e.getAssetId(),!0)}}_addEventListeners(){window.addEventListener("resize",(()=>{this._onResize()})),Be.disableImmersion||this._container.addEventListener("wheel",(function(e){e.preventDefault()}),{passive:!1,capture:!0})}_onResize(){this._renderer.setSize(this._container.clientWidth,this._container.clientHeight),this._camera.aspect=this._container.clientWidth/this._container.clientHeight,this._camera.updateProjectionMatrix()}_enableStats(){this._stats=new Er,this._stats.showPanel(0),this._stats.dom.style.top="",this._stats.dom.style.left="",Be.isEditor&&this._container.insertBefore(this._stats.dom,this._container.firstChild)}_loading(){if(0==Be.loadingLocks.size){if(setTimeout((()=>{$(this._loadingMessage.children[0]).html("&nbsp;"),$(this._loadingMessage).addClass("ending"),setTimeout((()=>{$(this._loadingMessage).removeClass("loading"),Be.disableImmersion||Ri.displayButton()}),1e3)}),50),Be.disableImmersion)return this._renderer.setAnimationLoop((()=>{this._update()})),void(this._callback&&this._callback(this));"XR"==Be.deviceType?(this._dynamicAssets.push(Ds),this._renderer.setAnimationLoop(((e,t)=>{Pi.update(t),this._update()}))):("POINTER"==Be.deviceType||"MOBILE"==Be.deviceType)&&this._renderer.setAnimationLoop((()=>{this._update()})),this._dynamicAssets.push(this._menuController),this._dynamicAssets.push(Ps),this._dynamicAssets.push(Ss),this._dynamicAssets.push(tt),this._dynamicAssets.push(ve),this._dynamicAssets.push(zs),this._callback&&this._callback(this)}else $(this._loadingMessage.children[0]).html("Loading "+Be.loadingLocks.size+" more asset(s)")}_update(){this._stats.begin();let e=this._clock.getDelta();for(let t of this._dynamicAssets)t.update(e);this._renderer.render(this._scene,this._camera),this._stats.end()}getCamera(){return this._camera}getRenderer(){return this._renderer}getScene(){return this._scene}}class PrimitiveMeshHelper extends AssetHelper{constructor(e){super(e)}_getMenuFieldsMap(){let e=super._getMenuFieldsMap();return e.material=this._createMaterialInput({parameter:"material",name:"Material"}),e}_addSubscriptions(){tt.subscribe(this._id,Ne,(e=>{if(this._asset.getMaterial()==e.material.getId()&&(this._updateParameter("material",null,!0),this.updateMenuField("material"),e.undoRedoAction)){let t=e.undoRedoAction.undo;e.undoRedoAction.undo=()=>{t(),this._updateParameter("material",e.material.getId(),!0),this.updateMenuField("material")}}}))}_removeSubscriptions(){tt.unsubscribe(this._id,Ne)}addToScene(e){super.addToScene(e),this._addSubscriptions()}removeFromScene(){super.removeFromScene(),this._removeSubscriptions()}}class PrimitiveMesh extends Asset{constructor(e={}){super(e),this._material=e.material}_createEditorHelper(){this._editorHelper=new PrimitiveMeshHelper(this)}_updateGeometry(){console.error("PrimitiveMesh._updateGeometry() should be overridden")}_getMaterial(){return this._material?Os.getMaterial(this._material).getMaterial():wt.defaultMeshMaterial}clone(e){let t=this._fetchCloneParams(e);return Gn.addShape(t,this._assetId)}exportParams(){let e=super.exportParams();return e.material=this._material,e}getMaterial(){return this._material}setMaterial(e){if(e==this._material)return;let t=this._mesh.material.userData.oldMaterial;t&&this.returnTransparency(),this._material=e;let i=this._mesh.material,s=this._getMaterial();this._mesh.material=s,i.dispose(),t&&this.makeTranslucent()}}const Sr=[{parameter:"visualEdit"},{parameter:"material"},{parameter:"width",name:"Width",min:0,type:NumberInput},{parameter:"height",name:"Height",min:0,type:NumberInput},{parameter:"depth",name:"Depth",min:0,type:NumberInput},{parameter:"widthSegments",name:"Width Segments",min:1,type:NumberInput},{parameter:"heightSegments",name:"Height Segments",min:1,type:NumberInput},{parameter:"depthSegments",name:"Depth Segments",min:1,type:NumberInput},{parameter:"position"},{parameter:"rotation"},{parameter:"scale"}];class PrimitiveBoxHelper extends PrimitiveMeshHelper{constructor(e){super(e)}getMenuFields(){return super.getMenuFields(Sr)}_getMenuFieldsMap(){let e=super._getMenuFieldsMap();for(let t of Sr)if(!(t.parameter in e)){let i=this._createStandardInput(t);i&&(e[t.parameter]=i)}return e}}const Mr="a6ffffc9-2cd0-4fb7-a7b1-7f334930af51";Gn.registerShape(class extends PrimitiveMesh{constructor(e={}){super(e),this._assetId=Mr,this._width=st(e.width,.1),this._height=st(e.height,.1),this._depth=st(e.depth,.1),this._widthSegments=e.widthSegments||1,this._heightSegments=e.heightSegments||1,this._depthSegments=e.depthSegments||1,this._createMesh(),e.isPreview&&this.makeTranslucent()}_createEditorHelper(){this._editorHelper=new PrimitiveBoxHelper(this)}_createMesh(){let t=new e.BoxGeometry(this._width,this._height,this._depth,this._widthSegments,this._heightSegments,this._depthSegments);this._mesh=new e.Mesh(t,this._getMaterial()),this._object.add(this._mesh)}_updateGeometry(){let t=this._mesh.geometry,i=new e.BoxGeometry(this._width,this._height,this._depth,this._widthSegments,this._heightSegments,this._depthSegments);this._mesh.geometry=i,t.dispose()}exportParams(){let e=super.exportParams();return e.width=this._width,e.height=this._height,e.depth=this._depth,e.widthSegments=this._widthSegments,e.heightSegments=this._heightSegments,e.depthSegments=this._depthSegments,e}getDepth(){return this._depth}getHeight(){return this._height}getWidth(){return this._width}getDepthSegments(){return this._depthSegments}getHeightSegments(){return this._heightSegments}getWidthSegments(){return this._widthSegments}setDepth(e){this._depth!=e&&(this._depth=e,this._updateGeometry())}setHeight(e){this._height!=e&&(this._height=e,this._updateGeometry())}setWidth(e){this._width!=e&&(this._width=e,this._updateGeometry())}setDepthSegments(e){this._depthSegments!=e&&(this._depthSegments=e,this._updateGeometry())}setHeightSegments(e){this._heightSegments!=e&&(this._heightSegments=e,this._updateGeometry())}setWidthSegments(e){this._widthSegments!=e&&(this._widthSegments=e,this._updateGeometry())}},Mr,"Box");const xr=[{parameter:"visualEdit"},{parameter:"material"},{parameter:"radius",name:"Radius",min:0,type:NumberInput},{parameter:"segments",name:"Sides",min:3,type:NumberInput},{parameter:"thetaLength",name:"Degrees",min:0,max:360,type:NumberInput},{parameter:"position"},{parameter:"rotation"},{parameter:"scale"}];class PrimitiveCircleHelper extends PrimitiveMeshHelper{constructor(e){super(e)}place(e){let t=e.object,i=e.point;e.face,t.updateMatrixWorld();let s=e.face.normal.clone().transformDirection(t.matrixWorld).clampLength(0,.001);global.camera.getWorldDirection(vector3s[0]).dot(s)>0&&s.negate(),this._object.position.copy(s).add(i),this._object.lookAt(s.add(this._object.position)),this.roundAttributes(!0)}getMenuFields(){return super.getMenuFields(xr)}_getMenuFieldsMap(){let e=super._getMenuFieldsMap();for(let t of xr)if(!(t.parameter in e)){let i=this._createStandardInput(t);i&&(e[t.parameter]=i)}return e}}const Tr="0a0c7c21-d834-4a88-9234-0d9b5cf705f6";Gn.registerShape(class extends PrimitiveMesh{constructor(e={}){super(e),this._assetId=Tr,this._radius=st(e.radius,.1),this._segments=e.segments||32,this._thetaLength=st(e.thetaLength,360),this._createMesh(),e.isPreview&&this.makeTranslucent()}_createEditorHelper(){this._editorHelper=new PrimitiveCircleHelper(this)}_createMesh(){let t=this._thetaLength*Math.PI/180,i=new e.CircleGeometry(this._radius,this._segments,0,t);this._mesh=new e.Mesh(i,this._getMaterial()),this._object.add(this._mesh)}_updateGeometry(){let t=this._thetaLength*Math.PI/180,i=this._mesh.geometry,s=new e.CircleGeometry(this._radius,this._segments,0,t);this._mesh.geometry=s,i.dispose()}exportParams(){let e=super.exportParams();return e.radius=this._radius,e.segments=this._segments,e.thetaLength=this._thetaLength,e}getRadius(){return this._radius}getSegments(){return this._segments}getThetaLength(){return this._thetaLength}setRadius(e){this._radius!=e&&(this._radius=e,this._updateGeometry())}setSegments(e){this._segments!=e&&(this._segments=e,this._updateGeometry())}setThetaLength(e){this._thetaLength!=e&&(this._thetaLength=e,this._updateGeometry())}},Tr,"Circle");const Pr=[{parameter:"visualEdit"},{parameter:"material"},{parameter:"height",name:"Height",min:0,type:NumberInput},{parameter:"radius",name:"Radius",min:0,type:NumberInput},{parameter:"radialSegments",name:"Sides",min:3,type:NumberInput},{parameter:"heightSegments",name:"Height Segments",min:1,type:NumberInput},{parameter:"thetaLength",name:"Degrees",min:0,max:360,type:NumberInput},{parameter:"openEnded",name:"Open Ended",type:CheckboxInput},{parameter:"position"},{parameter:"rotation"},{parameter:"scale"}];class PrimitiveConeHelper extends PrimitiveMeshHelper{constructor(e){super(e)}getMenuFields(){return super.getMenuFields(Pr)}_getMenuFieldsMap(){let e=super._getMenuFieldsMap();for(let t of Pr)if(!(t.parameter in e)){let i=this._createStandardInput(t);i&&(e[t.parameter]=i)}return e}}const kr="42779f01-e2cc-495a-a4b3-b286197fa762";Gn.registerShape(class extends PrimitiveMesh{constructor(e={}){super(e),this._assetId=kr,this._height=st(e.height,.2),this._radius=st(e.radius,.1),this._radialSegments=e.radialSegments||32,this._heightSegments=e.heightSegments||1,this._thetaLength=st(e.thetaLength,360),this._openEnded=e.openEnded||!1,this._createMesh(),e.isPreview&&this.makeTranslucent()}_createEditorHelper(){this._editorHelper=new PrimitiveConeHelper(this)}_createMesh(){let t=this._thetaLength*Math.PI/180,i=new e.ConeGeometry(this._radius,this._height,this._radialSegments,this._heightSegments,this._openEnded,0,t);this._mesh=new e.Mesh(i,this._getMaterial()),this._object.add(this._mesh)}_updateGeometry(){let t=this._thetaLength*Math.PI/180,i=this._mesh.geometry,s=new e.ConeGeometry(this._radius,this._height,this._radialSegments,this._heightSegments,this._openEnded,0,t);this._mesh.geometry=s,i.dispose()}exportParams(){let e=super.exportParams();return e.height=this._height,e.radius=this._radius,e.radialSegments=this._radialSegments,e.heightSegments=this._heightSegments,e.thetaLength=this._thetaLength,e.openEnded=this._openEnded,e}getHeight(){return this._height}getRadius(){return this._radius}getRadialSegments(){return this._radialSegments}getHeightSegments(){return this._heightSegments}getThetaLength(){return this._thetaLength}getOpenEnded(){return this._openEnded}setHeight(e){this._height!=e&&(this._height=e,this._updateGeometry())}setRadius(e){this._radius!=e&&(this._radius=e,this._updateGeometry())}setRadialSegments(e){this._radialSegments!=e&&(this._radialSegments=e,this._updateGeometry())}setHeightSegments(e){this._heightSegments!=e&&(this._heightSegments=e,this._updateGeometry())}setThetaLength(e){this._thetaLength!=e&&(this._thetaLength=e,this._updateGeometry())}setOpenEnded(e){this._openEnded!=e&&(this._openEnded=e,this._updateGeometry())}},kr,"Cone");const Dr=[{parameter:"visualEdit"},{parameter:"material"},{parameter:"height",name:"Height",min:0,type:NumberInput},{parameter:"radiusTop",name:"Top Radius",min:0,type:NumberInput},{parameter:"radiusBottom",name:"Bottom Radius",min:0,type:NumberInput},{parameter:"radialSegments",name:"Sides",min:3,type:NumberInput},{parameter:"heightSegments",name:"Height Segments",min:1,type:NumberInput},{parameter:"thetaLength",name:"Degrees",min:0,max:360,type:NumberInput},{parameter:"openEnded",name:"Open Ended",type:CheckboxInput},{parameter:"position"},{parameter:"rotation"},{parameter:"scale"}];class PrimitiveCylinderHelper extends PrimitiveMeshHelper{constructor(e){super(e)}getMenuFields(){return super.getMenuFields(Dr)}_getMenuFieldsMap(){let e=super._getMenuFieldsMap();for(let t of Dr)if(!(t.parameter in e)){let i=this._createStandardInput(t);i&&(e[t.parameter]=i)}return e}}const Fr="f4efc996-0d50-48fe-9313-3c7b1a5c1754";Gn.registerShape(class extends PrimitiveMesh{constructor(e={}){super(e),this._assetId=Fr,this._height=st(e.height,.2),this._radiusTop=st(e.radiusTop,.1),this._radiusBottom=st(e.radiusBottom,.1),this._radialSegments=e.radialSegments||32,this._heightSegments=e.heightSegments||1,this._thetaLength=st(e.thetaLength,360),this._openEnded=e.openEnded||!1,this._createMesh(),e.isPreview&&this.makeTranslucent()}_createEditorHelper(){this._editorHelper=new PrimitiveCylinderHelper(this)}_createMesh(){let t=this._thetaLength*Math.PI/180,i=new e.CylinderGeometry(this._radiusTop,this._radiusBottom,this._height,this._radialSegments,this._heightSegments,this._openEnded,0,t);this._mesh=new e.Mesh(i,this._getMaterial()),this._object.add(this._mesh)}_updateGeometry(){let t=this._thetaLength*Math.PI/180,i=this._mesh.geometry,s=new e.CylinderGeometry(this._radiusTop,this._radiusBottom,this._height,this._radialSegments,this._heightSegments,this._openEnded,0,t);this._mesh.geometry=s,i.dispose()}exportParams(){let e=super.exportParams();return e.height=this._height,e.radiusTop=this._radiusTop,e.radiusBottom=this._radiusBottom,e.radialSegments=this._radialSegments,e.heightSegments=this._heightSegments,e.thetaLength=this._thetaLength,e.openEnded=this._openEnded,e}getHeight(){return this._height}getRadiusTop(){return this._radiusTop}getRadiusBottom(){return this._radiusBottom}getRadialSegments(){return this._radialSegments}getHeightSegments(){return this._heightSegments}getThetaLength(){return this._thetaLength}getOpenEnded(){return this._openEnded}setHeight(e){this._height!=e&&(this._height=e,this._updateGeometry())}setRadiusTop(e){this._radiusTop!=e&&(this._radiusTop=e,this._updateGeometry())}setRadiusBottom(e){this._radiusBottom!=e&&(this._radiusBottom=e,this._updateGeometry())}setRadialSegments(e){this._radialSegments!=e&&(this._radialSegments=e,this._updateGeometry())}setHeightSegments(e){this._heightSegments!=e&&(this._heightSegments=e,this._updateGeometry())}setThetaLength(e){this._thetaLength!=e&&(this._thetaLength=e,this._updateGeometry())}setOpenEnded(e){this._openEnded!=e&&(this._openEnded=e,this._updateGeometry())}},Fr,"Cylinder");const Qr=[{parameter:"visualEdit"},{parameter:"material"},{parameter:"width",name:"Width",min:0,type:NumberInput},{parameter:"height",name:"Height",min:0,type:NumberInput},{parameter:"widthSegments",name:"Width Segments",min:1,type:NumberInput},{parameter:"heightSegments",name:"Height Segments",min:1,type:NumberInput},{parameter:"position"},{parameter:"rotation"},{parameter:"scale"}];class PrimitivePlaneHelper extends PrimitiveMeshHelper{constructor(e){super(e)}place(e){let t=e.object,i=e.point;e.face,t.updateMatrixWorld();let s=e.face.normal.clone().transformDirection(t.matrixWorld).clampLength(0,.001);global.camera.getWorldDirection(vector3s[0]).dot(s)>0&&s.negate(),this._object.position.copy(s).add(i),this._object.lookAt(s.add(this._object.position)),this.roundAttributes(!0)}getMenuFields(){return super.getMenuFields(Qr)}_getMenuFieldsMap(){let e=super._getMenuFieldsMap();for(let t of Qr)if(!(t.parameter in e)){let i=this._createStandardInput(t);i&&(e[t.parameter]=i)}return e}}const Rr="936bd538-9cb8-44f5-b21f-6b4a7eccfff4";Gn.registerShape(class extends PrimitiveMesh{constructor(e={}){super(e),this._assetId=Rr,this._width=st(e.width,.1),this._height=st(e.height,.1),this._widthSegments=e.widthSegments||1,this._heightSegments=e.heightSegments||1,this._createMesh(),e.isPreview&&this.makeTranslucent()}_createEditorHelper(){this._editorHelper=new PrimitivePlaneHelper(this)}_createMesh(){let t=new e.PlaneGeometry(this._width,this._height,this._widthSegments,this._heightSegments);this._mesh=new e.Mesh(t,this._getMaterial()),this._object.add(this._mesh)}_updateGeometry(){let t=this._mesh.geometry,i=new e.PlaneGeometry(this._width,this._height,this._widthSegments,this._heightSegments);this._mesh.geometry=i,t.dispose()}exportParams(){let e=super.exportParams();return e.width=this._width,e.height=this._height,e.widthSegments=this._widthSegments,e.heightSegments=this._heightSegments,e}getHeight(){return this._height}getWidth(){return this._width}getHeightSegments(){return this._heightSegments}getWidthSegments(){return this._widthSegments}setHeight(e){this._height!=e&&(this._height=e,this._updateGeometry())}setWidth(e){this._width!=e&&(this._width=e,this._updateGeometry())}setHeightSegments(e){this._heightSegments!=e&&(this._heightSegments=e,this._updateGeometry())}setWidthSegments(e){this._widthSegments!=e&&(this._widthSegments=e,this._updateGeometry())}},Rr,"Plane");const Or=[{parameter:"visualEdit"},{parameter:"color"},{parameter:"intensity"},{parameter:"distance",name:"Distance",min:0,type:NumberInput},{parameter:"decay",name:"Decay",min:0,type:NumberInput},{parameter:"position"},{parameter:"rotation"},{parameter:"scale"}];class PrimitivePointLightHelper extends PrimitiveLightHelper{constructor(e){super(e)}_createMesh(){let t=new e.SphereGeometry(.07),i=new e.MeshBasicMaterial({color:Ct.yellow});this._mesh=new e.Mesh(t,i),this._asset.visualEdit&&this._object.add(this._mesh)}getMenuFields(){return super.getMenuFields(Or)}_getMenuFieldsMap(){let e=super._getMenuFieldsMap();for(let t of Or)if(!(t.parameter in e)){let i=this._createStandardInput(t);i&&(e[t.parameter]=i)}return e}}const Lr="944a6b29-05d2-47d9-9b33-60e7a3e18b7d";Gn.registerLight(class extends PrimitiveLight{constructor(e={}){super(e),this._assetId=Lr,this._distance=st(e.distance,0),this._decay=st(e.decay,2),this._createLight(),e.isPreview&&this.makeTranslucent()}_createEditorHelper(){this._editorHelper=new PrimitivePointLightHelper(this)}_createLight(){this._light=new e.PointLight(this._color,this._intensity,this._distance,this._decay),this._object.add(this._light)}_updateLight(){super._updateLight(),this._light.distance=this._distance,this._light.decay=this._decay}exportParams(){let e=super.exportParams();return e.distance=this._distance,e.decay=this._decay,e}getDistance(){return this._distance}getDecay(){return this._decay}setDistance(e){this._distance!=e&&(this._distance=e,this._light.distance=e)}setDecay(e){this._decay!=e&&(this._decay=e,this._light.decay=e)}},Lr,"Basic Light");const Nr=[{parameter:"visualEdit"},{parameter:"material"},{parameter:"innerRadius",name:"Inner Radius",min:0,type:NumberInput},{parameter:"outerRadius",name:"Outer Radius",min:0,type:NumberInput},{parameter:"thetaSegments",name:"Sides",min:3,type:NumberInput},{parameter:"phiSegments",name:"Radius Segments",min:1,type:NumberInput},{parameter:"thetaLength",name:"Degrees",min:0,max:360,type:NumberInput},{parameter:"position"},{parameter:"rotation"},{parameter:"scale"}];class PrimitiveRingHelper extends PrimitiveMeshHelper{constructor(e){super(e)}place(e){let t=e.object,i=e.point;e.face,t.updateMatrixWorld();let s=e.face.normal.clone().transformDirection(t.matrixWorld).clampLength(0,.001);global.camera.getWorldDirection(vector3s[0]).dot(s)>0&&s.negate(),this._object.position.copy(s).add(i),this._object.lookAt(s.add(this._object.position)),this.roundAttributes(!0)}getMenuFields(){return super.getMenuFields(Nr)}_getMenuFieldsMap(){let e=super._getMenuFieldsMap();for(let t of Nr)if(!(t.parameter in e)){let i=this._createStandardInput(t);i&&(e[t.parameter]=i)}return e}}const Ur="534f29c3-1e85-4510-bb84-459011de6722";Gn.registerShape(class extends PrimitiveMesh{constructor(e={}){super(e),this._assetId=Ur,this._innerRadius=st(e.innerRadius,.05),this._outerRadius=st(e.outerRadius,.1),this._thetaSegments=e.thetaSegments||32,this._phiSegments=e.phiSegments||1,this._thetaLength=st(e.thetaLength,360),this._createMesh(),e.isPreview&&this.makeTranslucent()}_createEditorHelper(){this._editorHelper=new PrimitiveRingHelper(this)}_createMesh(){let t=this._thetaLength*Math.PI/180,i=new e.RingGeometry(this._innerRadius,this._outerRadius,this._thetaSegments,this._phiSegments,0,t);this._mesh=new e.Mesh(i,this._getMaterial()),this._object.add(this._mesh)}_updateGeometry(){let t=this._thetaLength*Math.PI/180,i=this._mesh.geometry,s=new e.RingGeometry(this._innerRadius,this._outerRadius,this._thetaSegments,this._phiSegments,0,t);this._mesh.geometry=s,i.dispose()}exportParams(){let e=super.exportParams();return e.innerRadius=this._innerRadius,e.outerRadius=this._outerRadius,e.thetaSegments=this._thetaSegments,e.phiSegments=this._phiSegments,e.thetaLength=this._thetaLength,e}getInnerRadius(){return this._innerRadius}getOuterRadius(){return this._outerRadius}getThetaSegments(){return this._thetaSegments}getPhiSegments(){return this._phiSegments}getThetaLength(){return this._thetaLength}setInnerRadius(e){this._innerRadius!=e&&(this._innerRadius=e,this._updateGeometry())}setOuterRadius(e){this._outerRadius!=e&&(this._outerRadius=e,this._updateGeometry())}setThetaSegments(e){this._thetaSegments!=e&&(this._thetaSegments=e,this._updateGeometry())}setPhiSegments(e){this._phiSegments!=e&&(this._phiSegments=e,this._updateGeometry())}setThetaLength(e){this._thetaLength!=e&&(this._thetaLength=e,this._updateGeometry())}},Ur,"Ring");const Hr=[{parameter:"visualEdit"},{parameter:"material"},{parameter:"radius",name:"Radius",min:0,type:NumberInput},{parameter:"widthSegments",name:"Horizontal Sides",min:3,type:NumberInput},{parameter:"heightSegments",name:"Vertical Sides",min:2,type:NumberInput},{parameter:"phiLength",name:"Horizontal Degrees",min:0,max:360,type:NumberInput},{parameter:"thetaLength",name:"Vertical Degrees",min:0,max:180,type:NumberInput},{parameter:"position"},{parameter:"rotation"},{parameter:"scale"}];class PrimitiveSphereHelper extends PrimitiveMeshHelper{constructor(e){super(e)}getMenuFields(){return super.getMenuFields(Hr)}_getMenuFieldsMap(){let e=super._getMenuFieldsMap();for(let t of Hr)if(!(t.parameter in e)){let i=this._createStandardInput(t);i&&(e[t.parameter]=i)}return e}}const Gr="423c9506-52f4-4725-b848-69913cce2b00";Gn.registerShape(class extends PrimitiveMesh{constructor(e={}){super(e),this._assetId=Gr,this._radius=st(e.radius,.1),this._widthSegments=e.widthSegments||32,this._heightSegments=e.heightSegments||16,this._phiLength=st(e.phiLength,360),this._thetaLength=st(e.thetaLength,180),this._createMesh(),e.isPreview&&this.makeTranslucent()}_createEditorHelper(){this._editorHelper=new PrimitiveSphereHelper(this)}_createMesh(){let t=this._phiLength*Math.PI/180,i=this._thetaLength*Math.PI/180,s=new e.SphereGeometry(this._radius,this._widthSegments,this._heightSegments,0,t,0,i);this._mesh=new e.Mesh(s,this._getMaterial()),this._object.add(this._mesh)}_updateGeometry(){let t=this._phiLength*Math.PI/180,i=this._thetaLength*Math.PI/180,s=this._mesh.geometry,n=new e.SphereGeometry(this._radius,this._widthSegments,this._heightSegments,0,t,0,i);this._mesh.geometry=n,s.dispose()}exportParams(){let e=super.exportParams();return e.radius=this._radius,e.widthSegments=this._widthSegments,e.heightSegments=this._heightSegments,e.phiLength=this._phiLength,e.thetaLength=this._thetaLength,e}getRadius(){return this._radius}getWidthSegments(){return this._widthSegments}getHeightSegments(){return this._heightSegments}getPhiLength(){return this._phiLength}getThetaLength(){return this._thetaLength}setRadius(e){this._radius!=e&&(this._radius=e,this._updateGeometry())}setWidthSegments(e){this._widthSegments!=e&&(this._widthSegments=e,this._updateGeometry())}setHeightSegments(e){this._heightSegments!=e&&(this._heightSegments=e,this._updateGeometry())}setPhiLength(e){this._phiLength!=e&&(this._phiLength=e,this._updateGeometry())}setThetaLength(e){this._thetaLength!=e&&(this._thetaLength=e,this._updateGeometry())}},Gr,"Sphere");const jr=[{parameter:"visualEdit"},{parameter:"material"},{parameter:"radius",name:"Radius",min:0,type:NumberInput},{parameter:"tube",name:"Tube Radius",min:0,type:NumberInput},{parameter:"radialSegments",name:"Radial Sides",min:2,type:NumberInput},{parameter:"tubularSegments",name:"Tubular Sides",min:3,type:NumberInput},{parameter:"arc",name:"Degrees",min:0,max:360,type:NumberInput},{parameter:"position"},{parameter:"rotation"},{parameter:"scale"}];class PrimitiveTorusHelper extends PrimitiveMeshHelper{constructor(e){super(e)}getMenuFields(){return super.getMenuFields(jr)}_getMenuFieldsMap(){let e=super._getMenuFieldsMap();for(let t of jr)if(!(t.parameter in e)){let i=this._createStandardInput(t);i&&(e[t.parameter]=i)}return e}}const zr="6b8bcbf1-49b0-42ce-9d60-9a7db6e425bf";Gn.registerShape(class extends PrimitiveMesh{constructor(e={}){super(e),this._assetId=zr,this._radius=st(e.radius,.1),this._tube=st(e.tube,.05),this._radialSegments=e.radialSegments||16,this._tubularSegments=e.tubularSegments||32,this._arc=st(e.arc,360),this._createMesh(),e.isPreview&&this.makeTranslucent()}_createEditorHelper(){this._editorHelper=new PrimitiveTorusHelper(this)}_createMesh(){let t=this._arc*Math.PI/180,i=new e.TorusGeometry(this._radius,this._tube,this._radialSegments,this._tubularSegments,t);this._mesh=new e.Mesh(i,this._getMaterial()),this._object.add(this._mesh)}_updateGeometry(){let t=this._arc*Math.PI/180,i=this._mesh.geometry,s=new e.TorusGeometry(this._radius,this._tube,this._radialSegments,this._tubularSegments,t);this._mesh.geometry=s,i.dispose()}exportParams(){let e=super.exportParams();return e.radius=this._radius,e.tube=this._tube,e.radialSegments=this._radialSegments,e.tubularSegments=this._tubularSegments,e.arc=this._arc,e}getRadius(){return this._radius}getTube(){return this._tube}getRadialSegments(){return this._radialSegments}getTubularSegments(){return this._tubularSegments}getArc(){return this._arc}setRadius(e){this._radius!=e&&(this._radius=e,this._updateGeometry())}setTube(e){this._tube!=e&&(this._tube=e,this._updateGeometry())}setRadialSegments(e){this._radialSegments!=e&&(this._radialSegments=e,this._updateGeometry())}setTubularSegments(e){this._tubularSegments!=e&&(this._tubularSegments=e,this._updateGeometry())}setArc(e){this._arc!=e&&(this._arc=e,this._updateGeometry())}},zr,"Torus");const Vr=[{parameter:"transparent",name:"Transparent",type:CheckboxInput},{parameter:"opacity",name:"Opacity",min:0,max:1,type:NumberInput},{parameter:"side",name:"Display",type:EnumInput,options:["Front Side","Back Side","Both Sides"],map:Nt,reverseMap:zt}];class MaterialHelper extends EditorHelper{constructor(e){super(e,Ue)}_getMenuFieldsMap(){let e=super._getMenuFieldsMap();for(let t of Vr)if(!(t.parameter in e)){let i=this._createStandardInput(t);i&&(e[t.parameter]=i)}return e}_addSubscriptions(){let e=this._asset.getMaps();tt.subscribe(this._id,$e,(t=>{let i=[];for(let s of e){let e=at(s);this._asset["get"+e]()==t.texture.getId()&&(this._updateParameter(s,null,!0),this.updateMenuField(s),i.push(s))}if(t.undoRedoAction&&i.length>0){let e=t.undoRedoAction.undo;t.undoRedoAction.undo=()=>{e();for(let e of i)this._updateParameter(e,t.texture.getId(),!0),this.updateMenuField(e)}}})),tt.subscribe(this._id,et,(t=>{let i=t.asset.getId();for(let t of e){let e=at(t);this._asset["get"+e]()==i&&(this._asset._setTexture(t,i),this.updateMenuField(t))}}))}_removeSubscriptions(){tt.unsubscribe(this._id,$e),tt.unsubscribe(this._id,et)}dispose(){this._removeSubscriptions()}undoDispose(){this._addSubscriptions()}}class Material{constructor(t={}){this._id=t.id||it(),this._name="name"in t?t.name:this._getDefaultName(),this._opacity=st(t.opacity,1),this._side=t.side||e.FrontSide,this._transparent=t.transparent||!1,Be.isEditor&&this._createEditorHelper()}_createEditorHelper(){this._editorHelper=new MaterialHelper(this)}_getDefaultName(){console.error("Material._getDefaultName() should be overridden")}_createMaterial(){console.error("Material._createMaterial() should be overridden")}_setTexture(e,t){this["_"+e]=t;let i=Ls.getTexture(t);this._material[e]=i?i.getTexture():null,this._material.needsUpdate=!0}exportParams(){return{id:this._id,name:this._name,opacity:this._material.opacity,side:this._material.side,transparent:this._material.transparent}}_updateMaterialParamsWithMaps(e,t){for(let i of t)if(this["_"+i]){let t=Ls.getTexture(this["_"+i]);t&&(e[i]=t.getTexture())}}dispose(){lt(this._material),Be.isEditor&&this._editorHelper.dispose()}undoDispose(){Be.isEditor&&this._editorHelper.undoDispose()}getMaps(){console.error("Material.getMaps() should be overridden")}getMaterial(){return this._material}getMaterialType(){console.error("Material.getMaterialType() should be overridden")}getSampleTexture(){console.error("Material.getSampleTexture() should be overridden")}getId(){return this._id}getEditorHelper(){return this._editorHelper}getName(){return this._name}getOpacity(){return this._opacity}getSide(){return this._side}getTransparent(){return this._transparent}setName(e){null!=e&&this._name!=e&&(this._name=e)}setOpacity(e){this._opacity!=e&&(this._opacity=e,this._material.opacity=e)}setSide(e){this._side!=e&&(this._side=e,this._material.side=e,this._material.needsUpdate=!0)}setTransparent(e){this._transparent!=e&&(this._transparent=e,this._material.transparent=e,this._material.needsUpdate=!0)}}const Yr=[{parameter:"color",name:"Color",type:ColorInput},{parameter:"map",name:"Texture Map",filter:gn,type:TextureInput},{parameter:"side"},{parameter:"transparent"},{parameter:"opacity"},{parameter:"alphaMap",name:"Alpha Map",filter:gn,type:TextureInput},{parameter:"wireframe",name:"Wireframe",type:CheckboxInput},{parameter:"envMap",name:"Environment Map",filter:mn,type:TextureInput},{parameter:"combine",name:"Color & Environment Blend",options:["Multiply","Mix","Add"],map:Rt,reverseMap:Ht,type:EnumInput},{parameter:"reflectivity",name:"Reflectivity",min:0,max:1,type:NumberInput},{parameter:"refractionRatio",name:"Refraction Ratio",min:0,max:1,type:NumberInput}];let Xr=class extends MaterialHelper{constructor(e){super(e)}getMenuFields(){return super.getMenuFields(Yr)}_getMenuFieldsMap(){let e=super._getMenuFieldsMap();for(let t of Yr)if(!(t.parameter in e)){let i=this._createStandardInput(t);i&&(e[t.parameter]=i)}return e}};const Wr=["map","alphaMap","envMap"];Os.registerMaterial(class extends Material{constructor(t={}){super(t),this._alphaMap=t.alphaMap,this._color=st(t.color,4036976),this._combine=t.combine||e.MultiplyOperation,this._envMap=t.envMap,this._map=t.map,this._reflectivity=st(t.reflectivity,1),this._refractionRatio=st(t.refractionRatio,.98),this._wireframe=t.wireframe||!1,this._createMaterial()}_createEditorHelper(){this._editorHelper=new Xr(this)}_getDefaultName(){return"Basic Material"}_createMaterial(){let t={color:this._color,combine:this._combine,reflectivity:this._reflectivity,refractionRatio:this._refractionRatio,side:this._side,transparent:this._transparent,opacity:this._opacity,wireframe:this._wireframe};this._updateMaterialParamsWithMaps(t,Wr),this._material=new e.MeshBasicMaterial(t)}getMaps(){return Wr}getMaterialType(){return ar}getSampleTexture(){return this._material.map}exportParams(){let e=super.exportParams();return e.alphaMap=this._alphaMap,e.color=this._color,e.combine=this._combine,e.envMap=this._envMap,e.map=this._map,e.reflectivity=this._reflectivity,e.refractionRatio=this._refractionRatio,e.wireframe=this._wireframe,e}getAlphaMap(){return this._alphaMap}getColor(){return this._color}getCombine(){return this._combine}getEnvMap(){return this._envMap}getMap(){return this._map}getReflectivity(){return this._reflectivity}getRefractionRatio(){return this._refractionRatio}getWireframe(){return this._wireframe}setAlphaMap(e){this._alphaMap!=e&&this._setTexture("alphaMap",e)}setColor(e){this._color!=e&&(this._color=e,this._material.color.setHex(e))}setCombine(e){this._combine!=e&&(this._combine=e,this._material.combine=e,this._material.needsUpdate=!0)}setEnvMap(e){this._envMap!=e&&this._setTexture("envMap",e)}setMap(e){this._map!=e&&this._setTexture("map",e)}setReflectivity(e){this._reflectivity!=e&&(this._reflectivity=e,this._material.reflectivity=e)}setRefractionRatio(e){this._refractionRatio!=e&&(this._refractionRatio=e,this._material.refractionRatio=e)}setWireframe(e){this._wireframe!=e&&(this._wireframe=e,this._material.wireframe=e,this._material.needsUpdate=!0)}},ar);const Kr=[{parameter:"color",name:"Color",type:ColorInput},{parameter:"map",name:"Texture Map",filter:gn,type:TextureInput},{parameter:"side"},{parameter:"transparent"},{parameter:"opacity"},{parameter:"alphaMap",name:"Alpha Map",filter:gn,type:TextureInput},{parameter:"wireframe",name:"Wireframe",type:CheckboxInput},{parameter:"emissive",name:"Emissive Color",type:ColorInput},{parameter:"emissiveMap",name:"Emissive Map",filter:gn,type:TextureInput},{parameter:"emissiveIntensity",name:"Emissive Intensity",min:0,type:NumberInput},{parameter:"envMap",name:"Environment Map",filter:mn,type:TextureInput},{parameter:"combine",name:"Color & Environment Blend",options:["Multiply","Mix","Add"],map:Rt,reverseMap:Ht,type:EnumInput},{parameter:"reflectivity",name:"Reflectivity",min:0,max:1,type:NumberInput},{parameter:"refractionRatio",name:"Refraction Ratio",min:0,max:1,type:NumberInput}];class LambertMaterialHelper extends MaterialHelper{constructor(e){super(e)}getMenuFields(){return super.getMenuFields(Kr)}_getMenuFieldsMap(){let e=super._getMenuFieldsMap();for(let t of Kr)if(!(t.parameter in e)){let i=this._createStandardInput(t);i&&(e[t.parameter]=i)}return e}}const Zr=["map","alphaMap","emissiveMap","envMap"];Os.registerMaterial(class extends Material{constructor(t={}){super(t),this._alphaMap=t.alphaMap,this._color=st(t.color,4036976),this._combine=t.combine||e.MultiplyOperation,this._emissive=t.emissive||0,this._emissiveIntensity=st(t.emissiveIntensity,1),this._emissiveMap=t.emissiveMap,this._envMap=t.envMap,this._map=t.map,this._reflectivity=st(t.reflectivity,1),this._refractionRatio=st(t.refractionRatio,.98),this._wireframe=t.wireframe||!1,this._createMaterial()}_createEditorHelper(){this._editorHelper=new LambertMaterialHelper(this)}_getDefaultName(){return"Lambert Material"}_createMaterial(){let t={color:this._color,combine:this._combine,emissive:this._emissive,emissiveIntensity:this._emissiveIntensity,opacity:this._opacity,reflectivity:this._reflectivity,refractionRatio:this._refractionRatio,side:this._side,transparent:this._transparent,wireframe:this._wireframe};this._updateMaterialParamsWithMaps(t,Zr),this._material=new e.MeshLambertMaterial(t)}getMaps(){return Zr}getMaterialType(){return or}getSampleTexture(){return this._material.map}exportParams(){let e=super.exportParams();return e.alphaMap=this._alphaMap,e.color=this._color,e.combine=this._combine,e.emissive=this._emissive,e.emissiveIntensity=this._emissiveIntensity,e.emissiveMap=this._emissiveMap,e.envMap=this._envMap,e.map=this._map,e.reflectivity=this._reflectivity,e.refractionRatio=this._refractionRatio,e.wireframe=this._wireframe,e}getAlphaMap(){return this._alphaMap}getColor(){return this._color}getCombine(){return this._combine}getEmissive(){return this._emissive}getEmissiveIntensity(){return this._emissiveIntensity}getEmissiveMap(){return this._emissiveMap}getEnvMap(){return this._envMap}getMap(){return this._map}getReflectivity(){return this._reflectivity}getRefractionRatio(){return this._refractionRatio}getWireframe(){return this._wireframe}setAlphaMap(e){this._alphaMap!=e&&this._setTexture("alphaMap",e)}setColor(e){this._color!=e&&(this._color=e,this._material.color.setHex(e))}setCombine(e){this._combine!=e&&(this._combine=e,this._material.combine=e,this._material.needsUpdate=!0)}setEmissive(e){this._emissive!=e&&(this._emissive=e,this._material.emissive.setHex(e))}setEmissiveIntensity(e){this._emissiveIntensity!=e&&(this._emissiveIntensity=e,this._material.emissiveIntensity=e)}setEmissiveMap(e){this._emissiveMap!=e&&this._setTexture("emissiveMap",e)}setEnvMap(e){this._envMap!=e&&this._setTexture("envMap",e)}setMap(e){this._map!=e&&this._setTexture("map",e)}setReflectivity(e){this._reflectivity!=e&&(this._reflectivity=e,this._material.reflectivity=e)}setRefractionRatio(e){this._refractionRatio!=e&&(this._refractionRatio=e,this._material.refractionRatio=e)}setWireframe(e){this._wireframe!=e&&(this._wireframe=e,this._material.wireframe=e,this._material.needsUpdate=!0)}},or);const qr=[{parameter:"side"},{parameter:"transparent"},{parameter:"opacity"},{parameter:"flatShading",name:"Flat Shading",type:CheckboxInput},{parameter:"wireframe",name:"Wireframe",type:CheckboxInput},{parameter:"bumpMap",name:"Bump Map",filter:gn,type:TextureInput},{parameter:"bumpScale",name:"Bump Scale",min:0,max:1,type:NumberInput},{parameter:"displacementMap",name:"Displacement Map",filter:gn,type:TextureInput},{parameter:"displacementScale",name:"Displacement Scale",type:NumberInput},{parameter:"displacementBias",name:"Displacement Bias",type:NumberInput},{parameter:"normalMap",name:"Normal Map",filter:gn,type:TextureInput},{parameter:"normalMapType",name:"Normal Type",options:["Tangent","Object"],map:Lt,reverseMap:jt,type:EnumInput},{parameter:"normalScale",name:"Normal Scale",min:0,max:1,type:Vector2Input}];class NormalMaterialHelper extends MaterialHelper{constructor(e){super(e)}getMenuFields(){return super.getMenuFields(qr)}_getMenuFieldsMap(){let e=super._getMenuFieldsMap();for(let t of qr)if(!(t.parameter in e)){let i=this._createStandardInput(t);i&&(e[t.parameter]=i)}return e}}const Jr=["bumpMap","displacementMap","normalMap"];Os.registerMaterial(class extends Material{constructor(t={}){super(t),this._bumpMap=t.bumpMap,this._bumpScale=st(t.bumpScale,1),this._displacementMap=t.displacementMap,this._displacementScale=st(t.displacementScale,1),this._displacementBias=st(t.displacementBias,0),this._flatShading=t.flatShading||!1,this._normalMap=t.normalMap,this._normalMapType=t.normalMapType||e.TangentSpaceNormalMap,this._normalScale=t.normalScale||[1,1],this._wireframe=t.wireframe||!1,this._createMaterial()}_createEditorHelper(){this._editorHelper=new NormalMaterialHelper(this)}_getDefaultName(){return"Normal Material"}_createMaterial(){let t={bumpScale:this._bumpScale,displacementScale:this._displacementScale,displacementBias:this._displacementBias,flatShading:this._flatShading,normalMapType:this._normalMapType,normalScale:(new e.Vector2).fromArray(this._normalScale),opacity:this._opacity,side:this._side,transparent:this._transparent,wireframe:this._wireframe};this._updateMaterialParamsWithMaps(t,Jr),this._material=new e.MeshNormalMaterial(t)}getMaps(){return Jr}getMaterialType(){return lr}getSampleTexture(){return this._material.map}exportParams(){let e=super.exportParams();return e.bumpMap=this._bumpMap,e.bumpScale=this._bumpScale,e.displacementBias=this._displacementBias,e.displacementMap=this._displacementMap,e.displacementScale=this._displacementScale,e.flatShading=this._flatShading,e.normalMap=this._normalMap,e.normalMapType=this._normalMapType,e.normalScale=this._normalScale,e.wireframe=this._wireframe,e}getBumpMap(){return this._bumpMap}getBumpScale(){return this._bumpScale}getDisplacementBias(){return this._displacementBias}getDisplacementMap(){return this._displacementMap}getDisplacementScale(){return this._displacementScale}getFlatShading(){return this._flatShading}getNormalMap(){return this._normalMap}getNormalMapType(){return this._normalMapType}getNormalScale(){return this._normalScale}getWireframe(){return this._wireframe}setBumpMap(e){this._bumpMap!=e&&this._setTexture("bumpMap",e)}setBumpScale(e){this._bumpScale!=e&&(this._bumpScale=e,this._material.bumpScale=e)}setDisplacementBias(e){this._displacementBias!=e&&(this._displacementBias=e,this._material.displacementBias=e)}setDisplacementMap(e){this._displacementMap!=e&&this._setTexture("displacementMap",e)}setDisplacementScale(e){this._displacementScale!=e&&(this._displacementScale=e,this._material.displacementScale=e)}setFlatShading(e){this._flatShading!=e&&(this._flatShading=e,this._material.flatShading=e,this._material.needsUpdate=!0)}setNormalMap(e){this._normalMap!=e&&this._setTexture("normalMap",e)}setNormalMapType(e){this._normalMapType!=e&&(this._normalMapType=e,this._material.normalMapType=e,this._material.needsUpdate=!0)}setNormalScale(e){this._normalScale!=e&&(this._normalScale=e,this._material.normalScale.fromArray(e))}setWireframe(e){this._wireframe!=e&&(this._wireframe=e,this._material.wireframe=e,this._material.needsUpdate=!0)}},lr);const $r=[{parameter:"color",name:"Color",type:ColorInput},{parameter:"map",name:"Texture Map",filter:gn,type:TextureInput},{parameter:"side"},{parameter:"transparent"},{parameter:"opacity"},{parameter:"alphaMap",name:"Alpha Map",filter:gn,type:TextureInput},{parameter:"flatShading",name:"Flat Shading",type:CheckboxInput},{parameter:"wireframe",name:"Wireframe",type:CheckboxInput},{parameter:"bumpMap",name:"Bump Map",filter:gn,type:TextureInput},{parameter:"bumpScale",name:"Bump Scale",min:0,max:1,type:NumberInput},{parameter:"displacementMap",name:"Displacement Map",filter:gn,type:TextureInput},{parameter:"displacementScale",name:"Displacement Scale",type:NumberInput},{parameter:"displacementBias",name:"Displacement Bias",type:NumberInput},{parameter:"emissive",name:"Emissive Color",type:ColorInput},{parameter:"emissiveMap",name:"Emissive Map",filter:gn,type:TextureInput},{parameter:"emissiveIntensity",name:"Emissive Intensity",min:0,type:NumberInput},{parameter:"envMap",name:"Environment Map",filter:mn,type:TextureInput},{parameter:"combine",name:"Environment-Color Blend",options:["Multiply","Mix","Add"],map:Rt,reverseMap:Ht,type:EnumInput},{parameter:"reflectivity",name:"Reflectivity",min:0,max:1,type:NumberInput},{parameter:"refractionRatio",name:"Refraction Ratio",min:0,max:1,type:NumberInput},{parameter:"normalMap",name:"Normal Map",filter:gn,type:TextureInput},{parameter:"normalMapType",name:"Normal Type",options:["Tangent","Object"],map:Lt,reverseMap:jt,type:EnumInput},{parameter:"normalScale",name:"Normal Scale",min:0,max:1,type:Vector2Input},{parameter:"shininess",name:"Shininess",min:0,type:NumberInput},{parameter:"specular",name:"Specular Color",type:ColorInput},{parameter:"specularMap",name:"Specular Map",filter:gn,type:TextureInput}];class PhongMaterialHelper extends MaterialHelper{constructor(e){super(e)}getMenuFields(){return super.getMenuFields($r)}_getMenuFieldsMap(){let e=super._getMenuFieldsMap();for(let t of $r)if(!(t.parameter in e)){let i=this._createStandardInput(t);i&&(e[t.parameter]=i)}return e}}const ea=["map","alphaMap","bumpMap","displacementMap","emissiveMap","envMap","normalMap","specularMap"];Os.registerMaterial(class extends Material{constructor(t={}){super(t),this._alphaMap=t.alphaMap,this._bumpMap=t.bumpMap,this._bumpScale=st(t.bumpScale,1),this._color=st(t.color,4036976),this._combine=t.combine||e.MultiplyOperation,this._displacementMap=t.displacementMap,this._displacementScale=st(t.displacementScale,1),this._displacementBias=st(t.displacementBias,0),this._emissive=t.emissive||0,this._emissiveIntensity=st(t.emissiveIntensity,1),this._emissiveMap=t.emissiveMap,this._envMap=t.envMap,this._flatShading=t.flatShading||!1,this._map=t.map,this._normalMap=t.normalMap,this._normalMapType=t.normalMapType||e.TangentSpaceNormalMap,this._normalScale=t.normalScale||[1,1],this._reflectivity=st(t.reflectivity,1),this._refractionRatio=st(t.refractionRatio,.98),this._shininess=st(t.shininess,30),this._specular=st(t.specular,1118481),this._specularMap=t.specularMap,this._wireframe=t.wireframe||!1,this._createMaterial()}_createEditorHelper(){this._editorHelper=new PhongMaterialHelper(this)}_getDefaultName(){return"Phong Material"}_createMaterial(){let t={color:this._color,bumpScale:this._bumpScale,combine:this._combine,displacementScale:this._displacementScale,displacementBias:this._displacementBias,emissive:this._emissive,emissiveIntensity:this._emissiveIntensity,flatShading:this._flatShading,normalMapType:this._normalMapType,normalScale:this._normalScale,opacity:this._opacity,side:this._side,transparent:this._transparent,reflectivity:this._reflectivity,refractionRatio:this._refractionRatio,shininess:this._shininess,specular:this._specular,wireframe:this._wireframe};this._updateMaterialParamsWithMaps(t,ea),this._material=new e.MeshPhongMaterial(t)}getMaps(){return ea}getMaterialType(){return hr}getSampleTexture(){return this._material.map}exportParams(){let e=super.exportParams();return e.alphaMap=this._alphaMap,e.bumpMap=this._bumpMap,e.bumpScale=this._bumpScale,e.color=this._color,e.combine=this._combine,e.displacementMap=this._displacementMap,e.displacementScale=this._displacementScale,e.displacementBias=this._displacementBias,e.emissive=this._emissive,e.emissiveIntensity=this._emissiveIntensity,e.emissiveMap=this._emissiveMap,e.envMap=this._envMap,e.flatShading=this._flatShading,e.map=this._map,e.normalMap=this._normalMap,e.normalMapType=this._normalMapType,e.normalScale=this._normalScale,e.reflectivity=this._reflectivity,e.refractionRatio=this._refractionRatio,e.shininess=this._shininess,e.specular=this._specular,e.specularMap=this._specularMap,e.wireframe=this._wireframe,e}getAlphaMap(){return this._alphaMap}getBumpMap(){return this._bumpMap}getBumpScale(){return this._bumpScale}getColor(){return this._color}getCombine(){return this._combine}getDisplacementBias(){return this._displacementBias}getDisplacementMap(){return this._displacementMap}getDisplacementScale(){return this._displacementScale}getEmissive(){return this._emissive}getEmissiveIntensity(){return this._emissiveIntensity}getEmissiveMap(){return this._emissiveMap}getEnvMap(){return this._envMap}getFlatShading(){return this._flatShading}getMap(){return this._map}getNormalMap(){return this._normalMap}getNormalMapType(){return this._normalMapType}getNormalScale(){return this._normalScale}getReflectivity(){return this._reflectivity}getRefractionRatio(){return this._refractionRatio}getShininess(){return this._shininess}getSpecular(){return this._specular}getSpecularMap(){return this._specularMap}getWireframe(){return this._wireframe}setAlphaMap(e){this._alphaMap!=e&&this._setTexture("alphaMap",e)}setBumpMap(e){this._bumpMap!=e&&this._setTexture("bumpMap",e)}setBumpScale(e){this._bumpScale!=e&&(this._bumpScale=e,this._material.bumpScale=e)}setColor(e){this._color!=e&&(this._color=e,this._material.color.setHex(e))}setCombine(e){this._combine!=e&&(this._combine=e,this._material.combine=e,this._material.needsUpdate=!0)}setDisplacementBias(e){this._displacementBias!=e&&(this._displacementBias=e,this._material.displacementBias=e)}setDisplacementMap(e){this._displacementMap!=e&&this._setTexture("displacementMap",e)}setDisplacementScale(e){this._displacementScale!=e&&(this._displacementScale=e,this._material.displacementScale=e)}setEmissive(e){this._emissive!=e&&(this._emissive=e,this._material.emissive.setHex(e))}setEmissiveIntensity(e){this._emissiveIntensity!=e&&(this._emissiveIntensity=e,this._material.emissiveIntensity=e)}setEmissiveMap(e){this._emissiveMap!=e&&this._setTexture("emissiveMap",e)}setEnvMap(e){this._envMap!=e&&this._setTexture("envMap",e)}setFlatShading(e){this._flatShading!=e&&(this._flatShading=e,this._material.flatShading=e,this._material.needsUpdate=!0)}setMap(e){this._map!=e&&this._setTexture("map",e)}setNormalMap(e){this._normalMap!=e&&this._setTexture("normalMap",e)}setNormalMapType(e){this._normalMapType!=e&&(this._normalMapType=e,this._material.normalMapType=e,this._material.needsUpdate=!0)}setNormalScale(e){this._normalScale!=e&&(this._normalScale=e,this._material.normalScale=e)}setReflectivity(e){this._reflectivity!=e&&(this._reflectivity=e,this._material.reflectivity=e)}setRefractionRatio(e){this._refractionRatio!=e&&(this._refractionRatio=e,this._material.refractionRatio=e)}setShininess(e){this._shininess!=e&&(this._shininess=e,this._material.shininess=e)}setSpecular(e){this._specular!=e&&(this._specular=e,this._material.specular.setHex(e))}setSpecularMap(e){this._specularMap!=e&&this._setTexture("specularMap",e)}setWireframe(e){this._wireframe!=e&&(this._wireframe=e,this._material.wireframe=e,this._material.needsUpdate=!0)}},hr);const ta=[{parameter:"color",name:"Color",type:ColorInput},{parameter:"map",name:"Texture Map",filter:gn,type:TextureInput},{parameter:"side"},{parameter:"transparent"},{parameter:"opacity"},{parameter:"alphaMap",name:"Alpha Map",filter:gn,type:TextureInput},{parameter:"flatShading",name:"Flat Shading",type:CheckboxInput},{parameter:"wireframe",name:"Wireframe",type:CheckboxInput},{parameter:"bumpMap",name:"Bump Map",filter:gn,type:TextureInput},{parameter:"bumpScale",name:"Bump Scale",min:0,max:1,type:NumberInput},{parameter:"displacementMap",name:"Displacement Map",filter:gn,type:TextureInput},{parameter:"displacementScale",name:"Displacement Scale",type:NumberInput},{parameter:"displacementBias",name:"Displacement Bias",type:NumberInput},{parameter:"emissive",name:"Emissive Color",type:ColorInput},{parameter:"emissiveMap",name:"Emissive Map",filter:gn,type:TextureInput},{parameter:"emissiveIntensity",name:"Emissive Intensity",min:0,type:NumberInput},{parameter:"envMap",name:"Environment Map",filter:mn,type:TextureInput},{parameter:"envMapIntensity",name:"Environment Intensity",min:0,type:NumberInput},{parameter:"metalness",name:"Metalness",min:0,max:1,type:NumberInput},{parameter:"metalnessMap",name:"Metalness Map",filter:gn,type:TextureInput},{parameter:"normalMap",name:"Normal Map",filter:gn,type:TextureInput},{parameter:"normalMapType",name:"Normal Type",options:["Tangent","Object"],map:Lt,reverseMap:jt,type:EnumInput},{parameter:"normalScale",name:"Normal Scale",min:0,max:1,type:Vector2Input},{parameter:"roughness",name:"Roughness",min:0,max:1,type:NumberInput},{parameter:"roughnessMap",name:"Roughness Map",filter:gn,type:TextureInput}];class StandardMaterialHelper extends MaterialHelper{constructor(e){super(e)}getMenuFields(){return super.getMenuFields(ta)}_getMenuFieldsMap(){let e=super._getMenuFieldsMap();for(let t of ta)if(!(t.parameter in e)){let i=this._createStandardInput(t);i&&(e[t.parameter]=i)}return e}}const ia=["map","alphaMap","bumpMap","displacementMap","emissiveMap","envMap","metalnessMap","normalMap","roughnessMap"];Os.registerMaterial(class extends Material{constructor(t={}){super(t),this._color=st(t.color,4036976),this._alphaMap=t.alphaMap,this._bumpMap=t.bumpMap,this._bumpScale=st(t.bumpScale,1),this._displacementMap=t.displacementMap,this._displacementScale=st(t.displacementScale,1),this._displacementBias=st(t.displacementBias,0),this._emissive=t.emissive||0,this._emissiveMap=t.emissiveMap,this._emissiveIntensity=st(t.emissiveIntensity,1),this._envMap=t.envMap,this._envMapIntensity=st(t.envMapIntensity,1),this._flatShading=t.flatShading||!1,this._map=t.map,this._metalness=st(t.metalness,0),this._metalnessMap=t.metalnessMap,this._normalMap=t.normalMap,this._normalMapType=t.normalMapType||e.TangentSpaceNormalMap,this._normalScale=t.normalScale||[1,1],this._roughness=st(t.roughness,1),this._roughnessMap=t.roughnessMap,this._wireframe=t.wireframe||!1,this._createMaterial()}_createEditorHelper(){this._editorHelper=new StandardMaterialHelper(this)}_getDefaultName(){return"Standard Material"}_createMaterial(){let t={color:this._color,bumpScale:this._bumpScale,displacementScale:this._displacementScale,displacementBias:this._displacementBias,emissive:this._emissive,emissiveIntensity:this._emissiveIntensity,envMapIntensity:this._envMapIntensity,flatShading:this._flatShading,metalness:this._metalness,normalMapType:this._normalMapType,normalScale:this._normalScale,opacity:this._opacity,side:this._side,transparent:this._transparent,roughness:this._roughness,wireframe:this._wireframe};this._updateMaterialParamsWithMaps(t,ia),this._material=new e.MeshStandardMaterial(t)}getMaps(){return ia}getMaterialType(){return cr}getSampleTexture(){return this._material.map}exportParams(){let e=super.exportParams();return e.alphaMap=this._alphaMap,e.bumpMap=this._bumpMap,e.bumpScale=this._bumpScale,e.color=this._material.color.getHex(),e.displacementMap=this._displacementMap,e.displacementScale=this._displacementScale,e.displacementBias=this._displacementBias,e.emissive=this._material.emissive.getHex(),e.emissiveMap=this._emissiveMap,e.emissiveIntensity=this._emissiveIntensity,e.envMap=this._envMap,e.envMapIntensity=this._envMapIntensity,e.flatShading=this._flatShading,e.map=this._map,e.metalness=this._metalness,e.metalnessMap=this._metalnessMap,e.normalMap=this._normalMap,e.normalMapType=this._normalMapType,e.normalScale=this._normalScale,e.roughness=this._roughness,e.roughnessMap=this._roughnessMap,e.wireframe=this._wireframe,e}getAlphaMap(){return this._alphaMap}getBumpMap(){return this._bumpMap}getBumpScale(){return this._bumpScale}getColor(){return this._color}getDisplacementBias(){return this._displacementBias}getDisplacementMap(){return this._displacementMap}getDisplacementScale(){return this._displacementScale}getEmissive(){return this._emissive}getEmissiveIntensity(){return this._emissiveIntensity}getEmissiveMap(){return this._emissiveMap}getEnvMap(){return this._envMap}getEnvMapIntensity(){return this._envMapIntensity}getFlatShading(){return this._flatShading}getMap(){return this._map}getMetalness(){return this._metalness}getMetalnessMap(){return this._metalnessMap}getNormalMap(){return this._normalMap}getNormalMapType(){return this._normalMapType}getNormalScale(){return this._normalScale}getRoughness(){return this._roughness}getRoughnessMap(){return this._roughnessMap}getWireframe(){return this._wireframe}setAlphaMap(e){this._alphaMap!=e&&this._setTexture("alphaMap",e)}setBumpMap(e){this._bumpMap!=e&&this._setTexture("bumpMap",e)}setBumpScale(e){this._bumpScale!=e&&(this._bumpScale=e,this._material.bumpScale=e)}setColor(e){this._color!=e&&(this._color=e,this._material.color.setHex(e))}setDisplacementBias(e){this._displacementBias!=e&&(this._displacementBias=e,this._material.displacementBias=e)}setDisplacementMap(e){this._displacementMap!=e&&this._setTexture("displacementMap",e)}setDisplacementScale(e){this._displacementScale!=e&&(this._displacementScale=e,this._material.displacementScale=e)}setEmissive(e){this._emissive!=e&&(this._emissive=e,this._material.emissive.setHex(e))}setEmissiveIntensity(e){this._emissiveIntensity!=e&&(this._emissiveIntensity=e,this._material.emissiveIntensity=e)}setEmissiveMap(e){this._emissiveMap!=e&&this._setTexture("emissiveMap",e)}setEnvMap(e){this._envMap!=e&&this._setTexture("envMap",e)}setEnvMapIntensity(e){this._envMapIntensity!=e&&(this._envMapIntensity=e,this._material.envMapIntensity=e)}setFlatShading(e){this._flatShading!=e&&(this._flatShading=e,this._material.flatShading=e,this._material.needsUpdate=!0)}setMap(e){this._map!=e&&this._setTexture("map",e)}setMetalness(e){this._metalness!=e&&(this._metalness=e,this._material.metalness=e)}setMetalnessMap(e){this._metalnessMap!=e&&this._setTexture("metalnessMap",e)}setNormalMap(e){this._normalMap!=e&&this._setTexture("normalMap",e)}setNormalMapType(e){this._normalMapType!=e&&(this._normalMapType=e,this._material.normalMapType=e,this._material.needsUpdate=!0)}setNormalScale(e){this._normalScale!=e&&(this._normalScale=e,this._material.normalScale=e)}setRoughness(e){this._roughness!=e&&(this._roughness=e,this._material.roughness=e)}setRoughnessMap(e){this._roughnessMap!=e&&this._setTexture("roughnessMap",e)}setWireframe(e){this._wireframe!=e&&(this._wireframe=e,this._material.wireframe=e,this._material.needsUpdate=!0)}},cr);const sa=[{parameter:"color",name:"Color",type:ColorInput},{parameter:"map",name:"Texture Map",filter:gn,type:TextureInput},{parameter:"side"},{parameter:"transparent"},{parameter:"opacity"},{parameter:"alphaMap",name:"Alpha Map",filter:gn,type:TextureInput},{parameter:"wireframe",name:"Wireframe",type:CheckboxInput},{parameter:"bumpMap",name:"Bump Map",filter:gn,type:TextureInput},{parameter:"bumpScale",name:"Bump Scale",min:0,max:1,type:NumberInput},{parameter:"displacementMap",name:"Displacement Map",filter:gn,type:TextureInput},{parameter:"displacementScale",name:"Displacement Scale",type:NumberInput},{parameter:"displacementBias",name:"Displacement Bias",type:NumberInput},{parameter:"emissive",name:"Emissive Color",type:ColorInput},{parameter:"emissiveMap",name:"Emissive Map",filter:gn,type:TextureInput},{parameter:"emissiveIntensity",name:"Emissive Intensity",min:0,type:NumberInput},{parameter:"normalMap",name:"Normal Map",filter:gn,type:TextureInput},{parameter:"normalMapType",name:"Normal Type",options:["Tangent","Object"],map:Lt,reverseMap:jt,type:EnumInput},{parameter:"normalScale",name:"Normal Scale",min:0,max:1,type:Vector2Input}];class BasicMaterialHelper extends MaterialHelper{constructor(e){super(e)}getMenuFields(){return super.getMenuFields(sa)}_getMenuFieldsMap(){let e=super._getMenuFieldsMap();for(let t of sa)if(!(t.parameter in e)){let i=this._createStandardInput(t);i&&(e[t.parameter]=i)}return e}}const na=["map","alphaMap","bumpMap","displacementMap","emissiveMap","normalMap"];Os.registerMaterial(class extends Material{constructor(t={}){super(t),this._alphaMap=t.alphaMap,this._color=st(t.color,4036976),this._bumpMap=t.bumpMap,this._bumpScale=st(t.bumpScale,1),this._displacementMap=t.displacementMap,this._displacementScale=st(t.displacementScale,1),this._displacementBias=st(t.displacementBias,0),this._emissive=t.emissive||0,this._emissiveMap=t.emissiveMap,this._emissiveIntensity=st(t.emissiveIntensity,1),this._map=t.map,this._normalMap=t.normalMap,this._normalMapType=t.normalMapType||e.TangentSpaceNormalMap,this._normalScale=t.normalScale||[1,1],this._wireframe=t.wireframe||!1,this._createMaterial()}_createEditorHelper(){this._editorHelper=new BasicMaterialHelper(this)}_getDefaultName(){return"Toon Material"}_createMaterial(){let t={bumpScale:this._bumpScale,color:this._color,displacementScale:this._displacementScale,displacementBias:this._displacementBias,emissive:this._emissive,emissiveIntensity:this._emissiveIntensity,normalMapType:this._normalMapType,normalScale:this._normalScale,opacity:this._opacity,side:this._side,transparent:this._transparent,wireframe:this._wireframe};this._updateMaterialParamsWithMaps(t,na),this._material=new e.MeshToonMaterial(t)}getMaps(){return na}getMaterialType(){return dr}getSampleTexture(){return this._material.map}exportParams(){let e=super.exportParams();return e.alphaMap=this._alphaMap,e.bumpMap=this._bumpMap,e.bumpScale=this._bumpScale,e.color=this._material.color.getHex(),e.displacementMap=this._displacementMap,e.displacementScale=this._displacementScale,e.displacementBias=this._displacementBias,e.emissive=this._material.emissive.getHex(),e.emissiveMap=this._emissiveMap,e.emissiveIntensity=this._emissiveIntensity,e.map=this._map,e.normalMap=this._normalMap,e.normalMapType=this._normalMapType,e.normalScale=this._normalScale,e.wireframe=this._wireframe,e}getAlphaMap(){return this._alphaMap}getBumpMap(){return this._bumpMap}getBumpScale(){return this._bumpScale}getColor(){return this._color}getDisplacementBias(){return this._displacementBias}getDisplacementMap(){return this._displacementMap}getDisplacementScale(){return this._displacementScale}getEmissive(){return this._emissive}getEmissiveIntensity(){return this._emissiveIntensity}getEmissiveMap(){return this._emissiveMap}getMap(){return this._map}getNormalMap(){return this._normalMap}getNormalMapType(){return this._normalMapType}getNormalScale(){return this._normalScale}getWireframe(){return this._wireframe}setAlphaMap(e){this._alphaMap!=e&&this._setTexture("alphaMap",e)}setBumpMap(e){this._bumpMap!=e&&this._setTexture("bumpMap",e)}setBumpScale(e){this._bumpScale!=e&&(this._bumpScale=e,this._material.bumpScale=e)}setColor(e){this._color!=e&&(this._color=e,this._material.color.setHex(e))}setDisplacementBias(e){this._displacementBias!=e&&(this._displacementBias=e,this._material.displacementBias=e)}setDisplacementMap(e){this._displacementMap!=e&&this._setTexture("displacementMap",e)}setDisplacementScale(e){this._displacementScale!=e&&(this._displacementScale=e,this._material.displacementScale=e)}setEmissive(e){this._emissive!=e&&(this._emissive=e,this._material.emissive.setHex(e))}setEmissiveIntensity(e){this._emissiveIntensity!=e&&(this._emissiveIntensity=e,this._material.emissiveIntensity=e)}setEmissiveMap(e){this._emissiveMap!=e&&this._setTexture("emissiveMap",e)}setMap(e){this._map!=e&&this._setTexture("map",e)}setNormalMap(e){this._normalMap!=e&&this._setTexture("normalMap",e)}setNormalMapType(e){this._normalMapType!=e&&(this._normalMapType=e,this._material.normalMapType=e,this._material.needsUpdate=!0)}setNormalScale(e){this._normalScale!=e&&(this._normalScale=e,this._material.normalScale=e)}setWireframe(e){this._wireframe!=e&&(this._wireframe=e,this._material.wireframe=e,this._material.needsUpdate=!0)}},dr);class Texture{constructor(e={}){this._id=e.id||it(),this._name="name"in e?e.name:this._getDefaultName(),Be.isEditor&&this._createEditorHelper()}_createEditorHelper(){console.error("Texture._createEditorHelper() should be overridden")}_getDefaultName(){console.error("Texture._getDefaultName() should be overridden")}_createTexture(){console.error("Texture._createTexture() should be overridden")}exportParams(){return{id:this._id,name:this._name}}setFromParams(e){console.warn("Unexpectedly trying to setFromParams() for Texture...")}_updateTexture(){let e=this._texture;this._createTexture(),setTimeout((()=>{e.dispose()}),20)}dispose(){setTimeout((()=>{this._texture.dispose()}),20)}getTexture(){return this._texture}getPreviewTexture(){return this._texture}getAssetIds(){console.error("Texture.getAssetIds() should be overridden")}getTextureType(){console.error("Texture.getTextureType() should be overridden")}getId(){return this._id}getEditorHelper(){return this._editorHelper}getName(){return this._name}setName(e){null!=e&&this._name!=e&&(this._name=e)}}const ra=[{parameter:"image",name:"Image",type:ImageInput},{parameter:"wrapS",name:"Horizontal Wrapping",type:EnumInput,options:["Clamp","Repeat","Mirrored"],map:Ut,reverseMap:Vt},{parameter:"wrapT",name:"Vertical Wrapping",type:EnumInput,options:["Clamp","Repeat","Mirrored"],map:Ut,reverseMap:Vt},{parameter:"repeat",name:"Repeat",type:Vector2Input},{parameter:"offset",name:"Offset",type:Vector2Input}];class BasicTextureHelper extends EditorHelper{constructor(e){super(e,et)}getMenuFields(){return super.getMenuFields(ra)}_getMenuFieldsMap(){let e=super._getMenuFieldsMap();for(let t of ra)if(!(t.parameter in e)){let i=this._createStandardInput(t);i&&(e[t.parameter]=i)}return e}}Ls.registerTexture(class extends Texture{constructor(t={}){super(t),this._image=t.image,this._wrapS=t.wrapS||e.ClampToEdgeWrapping,this._wrapT=t.wrapT||e.ClampToEdgeWrapping,this._repeat=t.repeat||[1,1],this._offset=t.offset||[0,0],this._createTexture()}_createEditorHelper(){this._editorHelper=new BasicTextureHelper(this)}_getDefaultName(){return"Texture"}_createTexture(){this._image?this._texture=Ii.cloneTexture(this._image):this._texture=It.blackPixel.clone(),this._texture.wrapS=this._wrapS,this._texture.wrapT=this._wrapT,this._texture.repeat.fromArray(this._repeat),this._texture.offset.fromArray(this._offset),this._texture.needsUpdate=!0}getAssetIds(){return this._image?[this._image]:[]}getTextureType(){return gn}exportParams(){let e=super.exportParams();return e.image=this._image,e.wrapS=this._texture.wrapS,e.wrapT=this._texture.wrapT,e.repeat=this._texture.repeat.toArray(),e.offset=this._texture.offset.toArray(),e}getImage(){return this._image}getOffset(){return this._offset}getRepeat(){return this._repeat}getWrapS(){return this._wrapS}getWrapT(){return this._wrapT}setImage(e){this._image!=e&&(this._image=e,this._updateTexture())}setOffset(e){nt(this._offset,e)||(this._offset=e,this._updateTexture())}setRepeat(e){nt(this._repeat,e)||(this._repeat=e,this._updateTexture())}setWrapS(e){this._wrapS!=e&&(this._wrapS=e,this._updateTexture())}setWrapT(e){this._wrapT!=e&&(this._wrapT=e,this._updateTexture())}},gn);const aa=[{parameter:"images",name:"Images",type:CubeImageInput},{parameter:"mapping",name:"Mapping",type:EnumInput,options:["Reflection","Refraction"],map:Ot,reverseMap:Gt}];class CubeTextureHelper extends EditorHelper{constructor(e){super(e,et)}getMenuFields(){return super.getMenuFields(aa)}_getMenuFieldsMap(){let e=super._getMenuFieldsMap();for(let t of aa)if(!(t.parameter in e)){let i=this._createStandardInput(t);i&&(e[t.parameter]=i)}return e}}Ls.registerTexture(class extends Texture{constructor(t={}){super(t),this._images=t.images||{},this._mapping=t.mapping||e.CubeReflectionMapping,this._createTexture()}_createEditorHelper(){this._editorHelper=new CubeTextureHelper(this)}_getDefaultName(){return"Cube Texture"}_createTexture(){let t=[this._getImageFromSide(Oi.RIGHT),this._getImageFromSide(Oi.LEFT),this._getImageFromSide(Oi.TOP),this._getImageFromSide(Oi.BOTTOM),this._getImageFromSide(Oi.FRONT),this._getImageFromSide(Oi.BACK)];this._validateImageList(t)||(t=Array(6).fill(It.blackPixel.image)),this._texture=new e.CubeTexture(t,this._mapping),this._texture.needsUpdate=!0}_getImageFromSide(e){return this._images[e]?Ii.getImage(this._images[e]):It.blackPixel.image}_validateImageList(e){let t,i=!0;for(let n of e)if(n!=It.blackPixel.image){if(n.width!=n.height)return PubSub.publish(this._id,PubSubTopics.MENU_NOTIFICATION,{text:"Images must be of same width and height",sustainTime:3}),!1;if(!(s=n.width)||s&s-1)return PubSub.publish(this._id,PubSubTopics.MENU_NOTIFICATION,{text:"Image lengths must be a power of 2",sustainTime:3}),!1;if(t&&n.width!=t)return PubSub.publish(this._id,PubSubTopics.MENU_NOTIFICATION,{text:"All images must be the same size",sustainTime:3}),!1;t=n.width}else i=!1;var s;return i}getPreviewTexture(){let e=this._images[Oi.FRONT];return e?Ii.getTexture(e):It.blackPixel}getAssetIds(){let e=[];for(let t in Oi)this._images[t]&&e.push(this._images[t]);return e}getTextureType(){return mn}exportParams(){let e=super.exportParams();return e.images=this._images,e.mapping=this._texture.mapping,e}getImages(){return this._images}getMapping(){return this._mapping}setImages(e,t){if(t){if(this._images[t]==e)return;this._images[t]=e,this._updateTexture()}else{let t=!1;for(let i in this._images)this._images[i]!=e[i]&&(this._images[i]=e[i],t=!0);t&&this._updateTexture()}}setMapping(e){this._mapping!=e&&(this._mapping=e,this._updateTexture())}},mn);var oa="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0;function la(e,t,i){var s=new XMLHttpRequest;s.open("GET",e),s.responseType="blob",s.onload=function(){ga(s.response,t,i)},s.onerror=function(){console.error("could not download file")},s.send()}function ha(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return t.status>=200&&t.status<=299}function ca(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(i){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var da,Aa,ua,pa=oa.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),ga=oa.saveAs||("object"!=typeof window||window!==oa?function(){}:"download"in HTMLAnchorElement.prototype&&!pa?function(e,t,i){var s=oa.URL||oa.webkitURL,n=document.createElement("a");t=t||e.name||"download",n.download=t,n.rel="noopener","string"==typeof e?(n.href=e,n.origin!==location.origin?ha(n.href)?la(e,t,i):ca(n,n.target="_blank"):ca(n)):(n.href=s.createObjectURL(e),setTimeout((function(){s.revokeObjectURL(n.href)}),4e4),setTimeout((function(){ca(n)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,t,i){if(t=t||e.name||"download","string"==typeof e)if(ha(e))la(e,t,i);else{var s=document.createElement("a");s.href=e,s.target="_blank",setTimeout((function(){ca(s)}))}else navigator.msSaveOrOpenBlob(function(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e}(e,i),t)}:function(e,t,i,s){if((s=s||open("","_blank"))&&(s.document.title=s.document.body.innerText="downloading..."),"string"==typeof e)return la(e,t,i);var n="application/octet-stream"===e.type,r=/constructor/i.test(oa.HTMLElement)||oa.safari,a=/CriOS\/[\d]+/.test(navigator.userAgent);if((a||n&&r||pa)&&"undefined"!=typeof FileReader){var o=new FileReader;o.onloadend=function(){var e=o.result;e=a?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),s?s.location.href=e:location=e,s=null},o.readAsDataURL(e)}else{var l=oa.URL||oa.webkitURL,h=l.createObjectURL(e);s?s.location=h:location.href=h,s=null,setTimeout((function(){l.revokeObjectURL(h)}),4e4)}});function ma(e,t,i){!function(e){let t=document.createElement("style");t.type="text/css",t.innerHTML="\n#digital-bacon-loading.loading, #digital-bacon-error.error {\n    position: absolute;\n    height: 100%;\n    width: 100%;\n    z-index: 100;\n    color: #4723D9;\n    display: block;\n    justify-content: center;\n    align-items: center;\n}\n\n#digital-bacon-loading, #digital-bacon-error {\n    display: none;\n}\n\n@keyframes animatedOpacity {\n    from { opacity: 1; }\n    to { opacity: 0; }\n}\n\n#digital-bacon-loading.loading.ending {\n    animation: animatedOpacity 1s linear 1 forwards;\n}\n\n@keyframes animatedScale {\n    0% { transform: scale(1.0); }\n    100% { transform: scale(1.1); }\n}\n\n#digital-bacon-loading.loading > img {\n    width: 25%;\n    animation: animatedScale 1s ease-in-out alternate infinite;\n}\n\n#mobile-joystick {\n    position: absolute;\n    width: 100px;\n    height: 100px;\n    left: 10px;\n    bottom: 10px;\n}\n\n#mobile-menu-open-button {\n    position: absolute;\n    top: 10px;\n    right: 10px;\n}\n\n#mobile-flying-controls {\n    position: absolute;\n    bottom: 10px;\n    right: 10px;\n}\n\n#mobile-flying-controls > button, #mobile-menu-open-button {\n    border-width: 1px;\n    border-style: solid;\n    border-color: #fff;\n    border-radius: 4px;\n    background: rgba(0,0,0,0.5);\n    padding: 12px;\n    color: #fff;\n    font: normal 13px sans-serif;\n    opacity: 0.75;\n}\n\n#mobile-flying-controls > button {\n    width: 70px;\n}\n\n#container button:hover {\n    opacity: 1;\n}\n\n#transform-controls {\n    position: absolute;\n    top: 50px;\n}\n\n#transform-controls > button, #ready-player-me-close-button {\n    border-width: 1px;\n    border-style: solid;\n    border-color: #fff;\n    border-radius: 4px;\n    background: rgba(0,0,0,0.5);\n    padding: 12px;\n    color: #fff;\n    font: normal 13px sans-serif;\n    opacity: 0.7;\n    width: 95px;\n    margin: 2px;\n    display: block;\n    text-align: left;\n}\n\n#transform-controls > button:hover, #transform-controls > button.selected {\n    opacity: 1;\n    font-weight: bold;\n    background-color: black;\n}\n\n#transform-controls > button > i {\n    font-size: 18px;\n    width: 25px;\n}\n\n#ready-player-me-close-button {\n    position: absolute;\n    top: 10%;\n    z-index: 1001;\n    transform: translateX(-50%);\n    width: fit-content;\n    display: inline;\n}\n\n#digital-bacon-rpm-iframe {\n    position: absolute;\n    top: 10%;\n    left: 0;\n    width: 100%;\n    height: 80%;\n    z-index: 1000;\n    border: none;\n}\n\n#container .hidden {\n    display: none;\n}\n\n#container > canvas {\n    outline: none;\n}\n    ".replaceAll("container",e),"MOBILE"==Be.deviceType&&(t.innerHTML+="\n@media screen and (max-height: 500px) {\n    #transform-controls {\n        max-height: calc(100% - 169px);\n        overflow: scroll;\n    }\n}\n        ");document.getElementsByTagName("head")[0].appendChild(t);let i=document.createElement("link");i.rel="stylesheet",i.href="https://maxst.icons8.com/vue-static/landings/line-awesome/line-awesome/1.3.0/css/line-awesome.min.css",document.getElementsByTagName("head")[0].appendChild(i);let s=document.getElementById(e);s.innerHTML='\n      <div id="digital-bacon-loading" class="loading">\n        <h1>Loading...</h1>\n        <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABAAAAAQACAMAAABIw9uxAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAL6UExURQAAAG0bVQAAAAAAAEASMW4bVmYaT0dwTG4cVj4ANAAAAAAAAAAAAG0bVQAAAAYBBW4cVgAAAG4cVgAAAEQRNW4cViIIGg4DDG8cVUkSOSoKIXAdVz0PMAAAAAAAAGMYTW4cVhcFEmgaUWobUzUNKkcVN24cVm4bVW4bVl0XSU8TPW4cVm4cVm4cVm4cVm4cVm4cVlUVQm4cVm4bVm4cVgAAAAAAAG8dVmYaUAAAAG4cVm8cVmAYS24cVgAAAG4cVlsXRwAAAG8eVgAAAFkWRWQZTm4bVm4cVW4cVm4cVm8cVW8cVv2W624cVv3LzNKWqP7q6/9pgv///9NSdf+ltG8dV/zKy3IgWXMiWnAeWNOXqf3Oz/7p6vnGydGVp3UkW9aaq3coXv7o6f7n6PvJy+Kqtoc7a9ecrOy2voQ5auCotH4wZPXBxo1Bb/S/xPG7wtuhsP3S04o+bf3Q0fbDx8+Tpt2jsZtRevjEyPK+w4M2aOixutmfrv7U1e+5wHkpX/rIyt+ls8GBmn4zZ3wtYuqzvOauueSst5dOeLFtjcOEnJBFcv7a29idrZJIdIEzZv7d3aJbgcmLobt6lXkrYJ1VfbNwj6pliHssYf7X2J9Yfq5qi7Zzkf7i46Rdgr18l8iJoOu1vcuNotCUp6hjhv7k5XYlXf7g4NSZqqZghL9+mIZAcM6Rpfvm6O24v7h2k/Tc4ZRKdsyPo5JQfJxgiKxnicmftrKBoOJZecaascaHnubH0opEc/zo6cSGnfrk57iForB7m+pde/jg5I9LeLp4lPNifs2QpKFli6dvk4YoXdpVd86kufHW3dOsv5dYgfz6+6Y6Z6Rqj9exwruNqKx1lsGUreLCzu3R2f2istGpvH4kW/pmgMZLcd27yZkzY9rF1LZCbP5ogs9PdOC+zPGXq/Lq8I8tYP+NoP9yif9/leHQ3P9thrhhhv+brNq2xvTt8semvYxHds6RpNqCnMdwkOnc5ffy9e7l7OSLo9O5y9GWqQAaAP8AAMG9VswAAAD+dFJOU1TzUQoE+woA/QEQTkT3SlfrGds9j7hqXByYcRKGITfUQ2Ll7X0WpSWBxKJey8I7m+Su1EppMi4z3ymSb8yMJa6+Hisrt9p6dlVZT1L///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9UYRtC9wAAanxJREFUeNrs3c3PFIUdwHFJHh55DiSEhORJuHApkABqqomJpDHhgGgzM3t5eH0MWmxtINZS0KhUg2IUGyLY+kYb+mJjMUVbUg2N2hYabOQgJSmtJRw8eSfpX9DngQDPzM7szuzO7s7sfj7Hpg+7O+vvu/M+t9wKjKxbLAIQAEAAAAEABAAQAEAAAAEABAAQAEAAAAEABAAQAEAAAAEABAAQAEAAAAEABAAQAEAAAAEABAAQAEAAAAEABAAQAEAAAAEABAAQAEAAAAEABAAEABAAQAAAAQAEABAAQAAAAQAEABAAQAAAAQAEABAAQAAAAQAEABAAQAAAAQAEABAAQAAAAQAEABAAQAAAAQAEABAAQAAAAQAEABAAQAAAAQAEAAQAEABAAAABAAQAEABAAAABAAQAEABAAAABAAQAEABAAAABAAQAEABAAAABAAQAEABAAAABAAQAEABAAAABAAQAEABAAAABAAQAEABAAAABAAQABAAQAEAAAAEABAAQAEAAAAEABAAQAEAAAAEABAAQAEAAAAEABAAQAEAAAAEABAAQAEAAAAEABAAQAEAAAAEABAAQAEAAAAEABAAQAEAAAAEABAAEABAAQAAAAQAEABAAQAAAAQAEABAAQAAAAQAEABAAQAAAAQAEABAAQAAAAQAEABAAQAAAAQAEABAArplcuXphcN2iJeu/YZEgAKPhrsVBmjvWWjQIwJBbHrSy2gJCAIbW+LygrSUWEwIwjO5cEOQyb6llhQAM269/zvGftWCd5YUADJP5QTHWAhCAofFAUNy4xYYADIVFQSfmWXAIQP2NBZ2638JDAGpuadC5+ROWHwJQZ5NBVzZYgghAfY0HXVpsGSIAtZU11ye+PN+47tMzB1olYMxSRABqsLG/dk38aP+ie1elj/THjWZfZBdgmWWL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">\n      </div>\n      <div id="digital-bacon-error">\n        <h1>Error Loading Default Environment</h1>\n      </div>\n      <div id="transform-controls" class="hidden">\n        <button id="place-button"><i class="las la-map-pin"></i>Place</button>\n        <button id="translate-button" class="selected"><i class="las la-arrows-alt"></i>Move</button>\n        <button id="rotate-button"><i class="las la-sync"></i>Rotate</button>\n        <button id="scale-button"><i class="las la-expand"></i>Scale</button>\n        <button id="clone-button"><i class="las la-copy"></i>Clone</button>\n        <button id="delete-button"><i class="las la-trash"></i>Delete</button>\n        <button id="close-button"><i class="las la-times-circle"></i>Close</button>\n      </div>\n      <div id="mobile-joystick" class="hidden"></div>\n      <button id="mobile-menu-open-button" class="hidden">OPEN MENU</button>\n      <div id="mobile-flying-controls" class="hidden">\n        <button id="mobile-flying-up-button">UP</button>\n        <button id="mobile-flying-down-button">DOWN</button>\n      </div>',s.style.position="relative"}(t),window.main=new Main(e,t,i)}function _a(){("pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document)&&![/Android/i,/webOS/i,/iPhone/i,/iPad/i,/iPod/i,/BlackBerry/i,/Windows Phone/i].some((e=>navigator.userAgent.match(e)))&&(Be.deviceType="POINTER")}function fa(e,t,i,s){return Be.isEditor=!0,ba(e,t,i,s)}function ba(e,t,i,s){return Be.authUrl=i,Be.partyUrl=s,new Promise((i=>{localStorage.getItem("DigitalBacon:MobileOverride")?ma(i,e,t):"xr"in navigator?navigator.xr.isSessionSupported("immersive-vr").then((function(e){e?Be.deviceType="XR":_a()})).catch((function(){_a()})).finally((function(){ma(i,e,t)})):(_a(),ma(i,e,t))}))}
/*!
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */oa.saveAs=ga.saveAs=ga,"undefined"!=typeof module&&(module.exports=ga)
/*!

JSZip v3.9.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/master/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/master/LICENSE
*/,function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).JSZip=e()}}((function(){return function e(t,i,s){function n(a,o){if(!i[a]){if(!t[a]){var l="function"==typeof require&&require;if(!o&&l)return l(a,!0);if(r)return r(a,!0);var h=new Error("Cannot find module '"+a+"'");throw h.code="MODULE_NOT_FOUND",h}var c=i[a]={exports:{}};t[a][0].call(c.exports,(function(e){var i=t[a][1][e];return n(i||e)}),c,c.exports,e,t,i,s)}return i[a].exports}for(var r="function"==typeof require&&require,a=0;a<s.length;a++)n(s[a]);return n}({1:[function(e,t,i){var s=e("./utils"),n=e("./support"),r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(e){for(var t,i,n,a,o,l,h,c=[],d=0,A=e.length,u=A,p="string"!==s.getTypeOf(e);d<e.length;)u=A-d,p?(t=e[d++],i=d<A?e[d++]:0,n=d<A?e[d++]:0):(t=e.charCodeAt(d++),i=d<A?e.charCodeAt(d++):0,n=d<A?e.charCodeAt(d++):0),a=t>>2,o=(3&t)<<4|i>>4,l=u>1?(15&i)<<2|n>>6:64,h=u>2?63&n:64,c.push(r.charAt(a)+r.charAt(o)+r.charAt(l)+r.charAt(h));return c.join("")},i.decode=function(e){var t,i,s,a,o,l,h=0,c=0,d="data:";if(e.substr(0,d.length)===d)throw new Error("Invalid base64 input, it looks like a data url.");var A,u=3*(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length/4;if(e.charAt(e.length-1)===r.charAt(64)&&u--,e.charAt(e.length-2)===r.charAt(64)&&u--,u%1!=0)throw new Error("Invalid base64 input, bad content length.");for(A=n.uint8array?new Uint8Array(0|u):new Array(0|u);h<e.length;)t=r.indexOf(e.charAt(h++))<<2|(a=r.indexOf(e.charAt(h++)))>>4,i=(15&a)<<4|(o=r.indexOf(e.charAt(h++)))>>2,s=(3&o)<<6|(l=r.indexOf(e.charAt(h++))),A[c++]=t,64!==o&&(A[c++]=i),64!==l&&(A[c++]=s);return A}},{"./support":30,"./utils":32}],2:[function(e,t,i){var s=e("./external"),n=e("./stream/DataWorker"),r=e("./stream/Crc32Probe"),a=e("./stream/DataLengthProbe");function o(e,t,i,s,n){this.compressedSize=e,this.uncompressedSize=t,this.crc32=i,this.compression=s,this.compressedContent=n}o.prototype={getContentWorker:function(){var e=new n(s.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new a("data_length")),t=this;return e.on("end",(function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")})),e},getCompressedWorker:function(){return new n(s.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},o.createWorkerFrom=function(e,t,i){return e.pipe(new r).pipe(new a("uncompressedSize")).pipe(t.compressWorker(i)).pipe(new a("compressedSize")).withStreamInfo("compression",t)},t.exports=o},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,t,i){var s=e("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(e){return new s("STORE compression")},uncompressWorker:function(){return new s("STORE decompression")}},i.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,t,i){var s=e("./utils");var n=function(){for(var e,t=[],i=0;i<256;i++){e=i;for(var s=0;s<8;s++)e=1&e?3988292384^e>>>1:e>>>1;t[i]=e}return t}();t.exports=function(e,t){return void 0!==e&&e.length?"string"!==s.getTypeOf(e)?function(e,t,i,s){var r=n,a=s+i;e^=-1;for(var o=s;o<a;o++)e=e>>>8^r[255&(e^t[o])];return-1^e}(0|t,e,e.length,0):function(e,t,i,s){var r=n,a=s+i;e^=-1;for(var o=s;o<a;o++)e=e>>>8^r[255&(e^t.charCodeAt(o))];return-1^e}(0|t,e,e.length,0):0}},{"./utils":32}],5:[function(e,t,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(e,t,i){var s=null;s="undefined"!=typeof Promise?Promise:e("lie"),t.exports={Promise:s}},{lie:37}],7:[function(e,t,i){var s="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,n=e("pako"),r=e("./utils"),a=e("./stream/GenericWorker"),o=s?"uint8array":"array";function l(e,t){a.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=t,this.meta={}}i.magic="\b\0",r.inherits(l,a),l.prototype.processChunk=function(e){this.meta=e.meta,null===this._pako&&this._createPako(),this._pako.push(r.transformTo(o,e.data),!1)},l.prototype.flush=function(){a.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},l.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this._pako=null},l.prototype._createPako=function(){this._pako=new n[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(t){e.push({data:t,meta:e.meta})}},i.compressWorker=function(e){return new l("Deflate",e)},i.uncompressWorker=function(){return new l("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,t,i){var s=e("../utils"),n=e("../stream/GenericWorker"),r=e("../utf8"),a=e("../crc32"),o=e("../signature"),l=function(e,t){var i,s="";for(i=0;i<t;i++)s+=String.fromCharCode(255&e),e>>>=8;return s},h=function(e,t,i,n,h,c){var d,A,u=e.file,p=e.compression,g=c!==r.utf8encode,m=s.transformTo("string",c(u.name)),_=s.transformTo("string",r.utf8encode(u.name)),f=u.comment,b=s.transformTo("string",c(f)),I=s.transformTo("string",r.utf8encode(f)),w=_.length!==u.name.length,C=I.length!==f.length,y="",v="",B="",E=u.dir,S=u.date,M={crc32:0,compressedSize:0,uncompressedSize:0};t&&!i||(M.crc32=e.crc32,M.compressedSize=e.compressedSize,M.uncompressedSize=e.uncompressedSize);var x=0;t&&(x|=8),g||!w&&!C||(x|=2048);var T,P,k,D=0,F=0;E&&(D|=16),"UNIX"===h?(F=798,D|=(T=u.unixPermissions,P=E,k=T,T||(k=P?16893:33204),(65535&k)<<16)):(F=20,D|=63&(u.dosPermissions||0)),d=S.getUTCHours(),d<<=6,d|=S.getUTCMinutes(),d<<=5,d|=S.getUTCSeconds()/2,A=S.getUTCFullYear()-1980,A<<=4,A|=S.getUTCMonth()+1,A<<=5,A|=S.getUTCDate(),w&&(v=l(1,1)+l(a(m),4)+_,y+="up"+l(v.length,2)+v),C&&(B=l(1,1)+l(a(b),4)+I,y+="uc"+l(B.length,2)+B);var Q="";return Q+="\n\0",Q+=l(x,2),Q+=p.magic,Q+=l(d,2),Q+=l(A,2),Q+=l(M.crc32,4),Q+=l(M.compressedSize,4),Q+=l(M.uncompressedSize,4),Q+=l(m.length,2),Q+=l(y.length,2),{fileRecord:o.LOCAL_FILE_HEADER+Q+m+y,dirRecord:o.CENTRAL_FILE_HEADER+l(F,2)+Q+l(b.length,2)+"\0\0\0\0"+l(D,4)+l(n,4)+m+y+b}},c=function(e){return o.DATA_DESCRIPTOR+l(e.crc32,4)+l(e.compressedSize,4)+l(e.uncompressedSize,4)};function d(e,t,i,s){n.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=i,this.encodeFileName=s,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}s.inherits(d,n),d.prototype.push=function(e){var t=e.meta.percent||0,i=this.entriesCount,s=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,n.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:i?(t+100*(i-s-1))/i:100}}))},d.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var t=this.streamFiles&&!e.file.dir;if(t){var i=h(e,t,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:i.fileRecord,meta:{percent:0}})}else this.accumulate=!0},d.prototype.closedSource=function(e){this.accumulate=!1;var t=this.streamFiles&&!e.file.dir,i=h(e,t,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(i.dirRecord),t)this.push({data:c(e),meta:{percent:100}});else for(this.push({data:i.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},d.prototype.flush=function(){for(var e=this.bytesWritten,t=0;t<this.dirRecords.length;t++)this.push({data:this.dirRecords[t],meta:{percent:100}});var i=this.bytesWritten-e,n=function(e,t,i,n,r){var a=s.transformTo("string",r(n));return o.CENTRAL_DIRECTORY_END+"\0\0\0\0"+l(e,2)+l(e,2)+l(t,4)+l(i,4)+l(a.length,2)+a}(this.dirRecords.length,i,e,this.zipComment,this.encodeFileName);this.push({data:n,meta:{percent:100}})},d.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},d.prototype.registerPrevious=function(e){this._sources.push(e);var t=this;return e.on("data",(function(e){t.processChunk(e)})),e.on("end",(function(){t.closedSource(t.previous.streamInfo),t._sources.length?t.prepareNextSource():t.end()})),e.on("error",(function(e){t.error(e)})),this},d.prototype.resume=function(){return!!n.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},d.prototype.error=function(e){var t=this._sources;if(!n.prototype.error.call(this,e))return!1;for(var i=0;i<t.length;i++)try{t[i].error(e)}catch(e){}return!0},d.prototype.lock=function(){n.prototype.lock.call(this);for(var e=this._sources,t=0;t<e.length;t++)e[t].lock()},t.exports=d},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,t,i){var s=e("../compressions"),n=e("./ZipFileWorker");i.generateWorker=function(e,t,i){var r=new n(t.streamFiles,i,t.platform,t.encodeFileName),a=0;try{e.forEach((function(e,i){a++;var n=function(e,t){var i=e||t,n=s[i];if(!n)throw new Error(i+" is not a valid compression method !");return n}(i.options.compression,t.compression),o=i.options.compressionOptions||t.compressionOptions||{},l=i.dir,h=i.date;i._compressWorker(n,o).withStreamInfo("file",{name:e,dir:l,date:h,comment:i.comment||"",unixPermissions:i.unixPermissions,dosPermissions:i.dosPermissions}).pipe(r)})),r.entriesCount=a}catch(e){r.error(e)}return r}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,t,i){function s(){if(!(this instanceof s))return new s;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var e=new s;for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e}}s.prototype=e("./object"),s.prototype.loadAsync=e("./load"),s.support=e("./support"),s.defaults=e("./defaults"),s.version="3.9.1",s.loadAsync=function(e,t){return(new s).loadAsync(e,t)},s.external=e("./external"),t.exports=s},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,t,i){var s=e("./utils"),n=e("./external"),r=e("./utf8"),a=e("./zipEntries"),o=e("./stream/Crc32Probe"),l=e("./nodejsUtils");function h(e){return new n.Promise((function(t,i){var s=e.decompressed.getContentWorker().pipe(new o);s.on("error",(function(e){i(e)})).on("end",(function(){s.streamInfo.crc32!==e.decompressed.crc32?i(new Error("Corrupted zip : CRC32 mismatch")):t()})).resume()}))}t.exports=function(e,t){var i=this;return t=s.extend(t||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:r.utf8decode}),l.isNode&&l.isStream(e)?n.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):s.prepareContent("the loaded zip file",e,!0,t.optimizedBinaryString,t.base64).then((function(e){var i=new a(t);return i.load(e),i})).then((function(e){var i=[n.Promise.resolve(e)],s=e.files;if(t.checkCRC32)for(var r=0;r<s.length;r++)i.push(h(s[r]));return n.Promise.all(i)})).then((function(e){for(var n=e.shift(),r=n.files,a=0;a<r.length;a++){var o=r[a],l=o.fileNameStr,h=s.resolve(o.fileNameStr);i.file(h,o.decompressed,{binary:!0,optimizedBinaryString:!0,date:o.date,dir:o.dir,comment:o.fileCommentStr.length?o.fileCommentStr:null,unixPermissions:o.unixPermissions,dosPermissions:o.dosPermissions,createFolders:t.createFolders}),o.dir||(i.file(h).unsafeOriginalName=l)}return n.zipComment.length&&(i.comment=n.zipComment),i}))}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,t,i){var s=e("../utils"),n=e("../stream/GenericWorker");function r(e,t){n.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(t)}s.inherits(r,n),r.prototype._bindStream=function(e){var t=this;this._stream=e,e.pause(),e.on("data",(function(e){t.push({data:e,meta:{percent:0}})})).on("error",(function(e){t.isPaused?this.generatedError=e:t.error(e)})).on("end",(function(){t.isPaused?t._upstreamEnded=!0:t.end()}))},r.prototype.pause=function(){return!!n.prototype.pause.call(this)&&(this._stream.pause(),!0)},r.prototype.resume=function(){return!!n.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},t.exports=r},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,t,i){var s=e("readable-stream").Readable;function n(e,t,i){s.call(this,t),this._helper=e;var n=this;e.on("data",(function(e,t){n.push(e)||n._helper.pause(),i&&i(t)})).on("error",(function(e){n.emit("error",e)})).on("end",(function(){n.push(null)}))}e("../utils").inherits(n,s),n.prototype._read=function(){this._helper.resume()},t.exports=n},{"../utils":32,"readable-stream":16}],14:[function(e,t,i){t.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(e,t){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(e,t);if("number"==typeof e)throw new Error('The "data" argument must not be a number');return new Buffer(e,t)},allocBuffer:function(e){if(Buffer.alloc)return Buffer.alloc(e);var t=new Buffer(e);return t.fill(0),t},isBuffer:function(e){return Buffer.isBuffer(e)},isStream:function(e){return e&&"function"==typeof e.on&&"function"==typeof e.pause&&"function"==typeof e.resume}}},{}],15:[function(e,t,i){var s=e("./utf8"),n=e("./utils"),r=e("./stream/GenericWorker"),a=e("./stream/StreamHelper"),o=e("./defaults"),l=e("./compressedObject"),h=e("./zipObject"),c=e("./generate"),d=e("./nodejsUtils"),A=e("./nodejs/NodejsStreamInputAdapter"),u=function(e,t,i){var s,a=n.getTypeOf(t),c=n.extend(i||{},o);c.date=c.date||new Date,null!==c.compression&&(c.compression=c.compression.toUpperCase()),"string"==typeof c.unixPermissions&&(c.unixPermissions=parseInt(c.unixPermissions,8)),c.unixPermissions&&16384&c.unixPermissions&&(c.dir=!0),c.dosPermissions&&16&c.dosPermissions&&(c.dir=!0),c.dir&&(e=g(e)),c.createFolders&&(s=p(e))&&m.call(this,s,!0);var u="string"===a&&!1===c.binary&&!1===c.base64;i&&void 0!==i.binary||(c.binary=!u),(t instanceof l&&0===t.uncompressedSize||c.dir||!t||0===t.length)&&(c.base64=!1,c.binary=!0,t="",c.compression="STORE",a="string");var _=null;_=t instanceof l||t instanceof r?t:d.isNode&&d.isStream(t)?new A(e,t):n.prepareContent(e,t,c.binary,c.optimizedBinaryString,c.base64);var f=new h(e,_,c);this.files[e]=f},p=function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return t>0?e.substring(0,t):""},g=function(e){return"/"!==e.slice(-1)&&(e+="/"),e},m=function(e,t){return t=void 0!==t?t:o.createFolders,e=g(e),this.files[e]||u.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]};function _(e){return"[object RegExp]"===Object.prototype.toString.call(e)}var f={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var t,i,s;for(t in this.files)s=this.files[t],(i=t.slice(this.root.length,t.length))&&t.slice(0,this.root.length)===this.root&&e(i,s)},filter:function(e){var t=[];return this.forEach((function(i,s){e(i,s)&&t.push(s)})),t},file:function(e,t,i){if(1===arguments.length){if(_(e)){var s=e;return this.filter((function(e,t){return!t.dir&&s.test(e)}))}var n=this.files[this.root+e];return n&&!n.dir?n:null}return e=this.root+e,u.call(this,e,t,i),this},folder:function(e){if(!e)return this;if(_(e))return this.filter((function(t,i){return i.dir&&e.test(t)}));var t=this.root+e,i=m.call(this,t),s=this.clone();return s.root=i.name,s},remove:function(e){e=this.root+e;var t=this.files[e];if(t||("/"!==e.slice(-1)&&(e+="/"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var i=this.filter((function(t,i){return i.name.slice(0,e.length)===e})),s=0;s<i.length;s++)delete this.files[i[s].name];return this},generate:function(e){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var t,i={};try{if((i=n.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:s.utf8encode})).type=i.type.toLowerCase(),i.compression=i.compression.toUpperCase(),"binarystring"===i.type&&(i.type="string"),!i.type)throw new Error("No output type specified.");n.checkSupport(i.type),"darwin"!==i.platform&&"freebsd"!==i.platform&&"linux"!==i.platform&&"sunos"!==i.platform||(i.platform="UNIX"),"win32"===i.platform&&(i.platform="DOS");var o=i.comment||this.comment||"";t=c.generateWorker(this,i,o)}catch(e){(t=new r("error")).error(e)}return new a(t,i.type||"string",i.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return(e=e||{}).type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(t)}};t.exports=f},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,t,i){t.exports=e("stream")},{stream:void 0}],17:[function(e,t,i){var s=e("./DataReader");function n(e){s.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=255&e[t]}e("../utils").inherits(n,s),n.prototype.byteAt=function(e){return this.data[this.zero+e]},n.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),i=e.charCodeAt(1),s=e.charCodeAt(2),n=e.charCodeAt(3),r=this.length-4;r>=0;--r)if(this.data[r]===t&&this.data[r+1]===i&&this.data[r+2]===s&&this.data[r+3]===n)return r-this.zero;return-1},n.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),i=e.charCodeAt(1),s=e.charCodeAt(2),n=e.charCodeAt(3),r=this.readData(4);return t===r[0]&&i===r[1]&&s===r[2]&&n===r[3]},n.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=n},{"../utils":32,"./DataReader":18}],18:[function(e,t,i){var s=e("../utils");function n(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}n.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(e){},readInt:function(e){var t,i=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)i=(i<<8)+this.byteAt(t);return this.index+=e,i},readString:function(e){return s.transformTo("string",this.readData(e))},readData:function(e){},lastIndexOfSignature:function(e){},readAndCheckSignature:function(e){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}},t.exports=n},{"../utils":32}],19:[function(e,t,i){var s=e("./Uint8ArrayReader");function n(e){s.call(this,e)}e("../utils").inherits(n,s),n.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=n},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,t,i){var s=e("./DataReader");function n(e){s.call(this,e)}e("../utils").inherits(n,s),n.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},n.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},n.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},n.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=n},{"../utils":32,"./DataReader":18}],21:[function(e,t,i){var s=e("./ArrayReader");function n(e){s.call(this,e)}e("../utils").inherits(n,s),n.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=n},{"../utils":32,"./ArrayReader":17}],22:[function(e,t,i){var s=e("../utils"),n=e("../support"),r=e("./ArrayReader"),a=e("./StringReader"),o=e("./NodeBufferReader"),l=e("./Uint8ArrayReader");t.exports=function(e){var t=s.getTypeOf(e);return s.checkSupport(t),"string"!==t||n.uint8array?"nodebuffer"===t?new o(e):n.uint8array?new l(s.transformTo("uint8array",e)):new r(s.transformTo("array",e)):new a(e)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,t,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\b"},{}],24:[function(e,t,i){var s=e("./GenericWorker"),n=e("../utils");function r(e){s.call(this,"ConvertWorker to "+e),this.destType=e}n.inherits(r,s),r.prototype.processChunk=function(e){this.push({data:n.transformTo(this.destType,e.data),meta:e.meta})},t.exports=r},{"../utils":32,"./GenericWorker":28}],25:[function(e,t,i){var s=e("./GenericWorker"),n=e("../crc32");function r(){s.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(r,s),r.prototype.processChunk=function(e){this.streamInfo.crc32=n(e.data,this.streamInfo.crc32||0),this.push(e)},t.exports=r},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,t,i){var s=e("../utils"),n=e("./GenericWorker");function r(e){n.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}s.inherits(r,n),r.prototype.processChunk=function(e){if(e){var t=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=t+e.data.length}n.prototype.processChunk.call(this,e)},t.exports=r},{"../utils":32,"./GenericWorker":28}],27:[function(e,t,i){var s=e("../utils"),n=e("./GenericWorker");function r(e){n.call(this,"DataWorker");var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then((function(e){t.dataIsReady=!0,t.data=e,t.max=e&&e.length||0,t.type=s.getTypeOf(e),t.isPaused||t._tickAndRepeat()}),(function(e){t.error(e)}))}s.inherits(r,n),r.prototype.cleanUp=function(){n.prototype.cleanUp.call(this),this.data=null},r.prototype.resume=function(){return!!n.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,s.delay(this._tickAndRepeat,[],this)),!0)},r.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(s.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},r.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,t=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,t);break;case"uint8array":e=this.data.subarray(this.index,t);break;case"array":case"nodebuffer":e=this.data.slice(this.index,t)}return this.index=t,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})},t.exports=r},{"../utils":32,"./GenericWorker":28}],28:[function(e,t,i){function s(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}s.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,t){return this._listeners[e].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,t){if(this._listeners[e])for(var i=0;i<this._listeners[e].length;i++)this._listeners[e][i].call(this,t)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on("data",(function(e){t.processChunk(e)})),e.on("end",(function(){t.end()})),e.on("error",(function(e){t.error(e)})),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var e=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)this.extraStreamInfo.hasOwnProperty(e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}},t.exports=s},{}],29:[function(e,t,i){var s=e("../utils"),n=e("./ConvertWorker"),r=e("./GenericWorker"),a=e("../base64"),o=e("../support"),l=e("../external"),h=null;if(o.nodestream)try{h=e("../nodejs/NodejsStreamOutputAdapter")}catch(e){}function c(e,t){return new l.Promise((function(i,n){var r=[],o=e._internalType,l=e._outputType,h=e._mimeType;e.on("data",(function(e,i){r.push(e),t&&t(i)})).on("error",(function(e){r=[],n(e)})).on("end",(function(){try{var e=function(e,t,i){switch(e){case"blob":return s.newBlob(s.transformTo("arraybuffer",t),i);case"base64":return a.encode(t);default:return s.transformTo(e,t)}}(l,function(e,t){var i,s=0,n=null,r=0;for(i=0;i<t.length;i++)r+=t[i].length;switch(e){case"string":return t.join("");case"array":return Array.prototype.concat.apply([],t);case"uint8array":for(n=new Uint8Array(r),i=0;i<t.length;i++)n.set(t[i],s),s+=t[i].length;return n;case"nodebuffer":return Buffer.concat(t);default:throw new Error("concat : unsupported type '"+e+"'")}}(o,r),h);i(e)}catch(e){n(e)}r=[]})).resume()}))}function d(e,t,i){var a=t;switch(t){case"blob":case"arraybuffer":a="uint8array";break;case"base64":a="string"}try{this._internalType=a,this._outputType=t,this._mimeType=i,s.checkSupport(a),this._worker=e.pipe(new n(a)),e.lock()}catch(e){this._worker=new r("error"),this._worker.error(e)}}d.prototype={accumulate:function(e){return c(this,e)},on:function(e,t){var i=this;return"data"===e?this._worker.on(e,(function(e){t.call(i,e.data,e.meta)})):this._worker.on(e,(function(){s.delay(t,arguments,i)})),this},resume:function(){return s.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(s.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new h(this,{objectMode:"nodebuffer"!==this._outputType},e)}},t.exports=d},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,t,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,i.nodebuffer="undefined"!=typeof Buffer,i.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)i.blob=!1;else{var s=new ArrayBuffer(0);try{i.blob=0===new Blob([s],{type:"application/zip"}).size}catch(e){try{var n=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);n.append(s),i.blob=0===n.getBlob("application/zip").size}catch(e){i.blob=!1}}}try{i.nodestream=!!e("readable-stream").Readable}catch(e){i.nodestream=!1}},{"readable-stream":16}],31:[function(e,t,i){for(var s=e("./utils"),n=e("./support"),r=e("./nodejsUtils"),a=e("./stream/GenericWorker"),o=new Array(256),l=0;l<256;l++)o[l]=l>=252?6:l>=248?5:l>=240?4:l>=224?3:l>=192?2:1;o[254]=o[254]=1;function h(){a.call(this,"utf-8 decode"),this.leftOver=null}function c(){a.call(this,"utf-8 encode")}i.utf8encode=function(e){return n.nodebuffer?r.newBufferFrom(e,"utf-8"):function(e){var t,i,s,r,a,o=e.length,l=0;for(r=0;r<o;r++)55296==(64512&(i=e.charCodeAt(r)))&&r+1<o&&56320==(64512&(s=e.charCodeAt(r+1)))&&(i=65536+(i-55296<<10)+(s-56320),r++),l+=i<128?1:i<2048?2:i<65536?3:4;for(t=n.uint8array?new Uint8Array(l):new Array(l),a=0,r=0;a<l;r++)55296==(64512&(i=e.charCodeAt(r)))&&r+1<o&&56320==(64512&(s=e.charCodeAt(r+1)))&&(i=65536+(i-55296<<10)+(s-56320),r++),i<128?t[a++]=i:i<2048?(t[a++]=192|i>>>6,t[a++]=128|63&i):i<65536?(t[a++]=224|i>>>12,t[a++]=128|i>>>6&63,t[a++]=128|63&i):(t[a++]=240|i>>>18,t[a++]=128|i>>>12&63,t[a++]=128|i>>>6&63,t[a++]=128|63&i);return t}(e)},i.utf8decode=function(e){return n.nodebuffer?s.transformTo("nodebuffer",e).toString("utf-8"):function(e){var t,i,n,r,a=e.length,l=new Array(2*a);for(i=0,t=0;t<a;)if((n=e[t++])<128)l[i++]=n;else if((r=o[n])>4)l[i++]=65533,t+=r-1;else{for(n&=2===r?31:3===r?15:7;r>1&&t<a;)n=n<<6|63&e[t++],r--;r>1?l[i++]=65533:n<65536?l[i++]=n:(n-=65536,l[i++]=55296|n>>10&1023,l[i++]=56320|1023&n)}return l.length!==i&&(l.subarray?l=l.subarray(0,i):l.length=i),s.applyFromCharCode(l)}(e=s.transformTo(n.uint8array?"uint8array":"array",e))},s.inherits(h,a),h.prototype.processChunk=function(e){var t=s.transformTo(n.uint8array?"uint8array":"array",e.data);if(this.leftOver&&this.leftOver.length){if(n.uint8array){var r=t;(t=new Uint8Array(r.length+this.leftOver.length)).set(this.leftOver,0),t.set(r,this.leftOver.length)}else t=this.leftOver.concat(t);this.leftOver=null}var a=function(e,t){var i;for((t=t||e.length)>e.length&&(t=e.length),i=t-1;i>=0&&128==(192&e[i]);)i--;return i<0||0===i?t:i+o[e[i]]>t?i:t}(t),l=t;a!==t.length&&(n.uint8array?(l=t.subarray(0,a),this.leftOver=t.subarray(a,t.length)):(l=t.slice(0,a),this.leftOver=t.slice(a,t.length))),this.push({data:i.utf8decode(l),meta:e.meta})},h.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=h,s.inherits(c,a),c.prototype.processChunk=function(e){this.push({data:i.utf8encode(e.data),meta:e.meta})},i.Utf8EncodeWorker=c},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,t,i){var s=e("./support"),n=e("./base64"),r=e("./nodejsUtils"),a=e("set-immediate-shim"),o=e("./external");function l(e){return e}function h(e,t){for(var i=0;i<e.length;++i)t[i]=255&e.charCodeAt(i);return t}i.newBlob=function(e,t){i.checkSupport("blob");try{return new Blob([e],{type:t})}catch(i){try{var s=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return s.append(e),s.getBlob(t)}catch(e){throw new Error("Bug : can't construct the Blob.")}}};var c={stringifyByChunk:function(e,t,i){var s=[],n=0,r=e.length;if(r<=i)return String.fromCharCode.apply(null,e);for(;n<r;)"array"===t||"nodebuffer"===t?s.push(String.fromCharCode.apply(null,e.slice(n,Math.min(n+i,r)))):s.push(String.fromCharCode.apply(null,e.subarray(n,Math.min(n+i,r)))),n+=i;return s.join("")},stringifyByChar:function(e){for(var t="",i=0;i<e.length;i++)t+=String.fromCharCode(e[i]);return t},applyCanBeUsed:{uint8array:function(){try{return s.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(e){return!1}}(),nodebuffer:function(){try{return s.nodebuffer&&1===String.fromCharCode.apply(null,r.allocBuffer(1)).length}catch(e){return!1}}()}};function d(e){var t=65536,s=i.getTypeOf(e),n=!0;if("uint8array"===s?n=c.applyCanBeUsed.uint8array:"nodebuffer"===s&&(n=c.applyCanBeUsed.nodebuffer),n)for(;t>1;)try{return c.stringifyByChunk(e,s,t)}catch(e){t=Math.floor(t/2)}return c.stringifyByChar(e)}function A(e,t){for(var i=0;i<e.length;i++)t[i]=e[i];return t}i.applyFromCharCode=d;var u={};u.string={string:l,array:function(e){return h(e,new Array(e.length))},arraybuffer:function(e){return u.string.uint8array(e).buffer},uint8array:function(e){return h(e,new Uint8Array(e.length))},nodebuffer:function(e){return h(e,r.allocBuffer(e.length))}},u.array={string:d,array:l,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return r.newBufferFrom(e)}},u.arraybuffer={string:function(e){return d(new Uint8Array(e))},array:function(e){return A(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:l,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return r.newBufferFrom(new Uint8Array(e))}},u.uint8array={string:d,array:function(e){return A(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:l,nodebuffer:function(e){return r.newBufferFrom(e)}},u.nodebuffer={string:d,array:function(e){return A(e,new Array(e.length))},arraybuffer:function(e){return u.nodebuffer.uint8array(e).buffer},uint8array:function(e){return A(e,new Uint8Array(e.length))},nodebuffer:l},i.transformTo=function(e,t){if(t||(t=""),!e)return t;i.checkSupport(e);var s=i.getTypeOf(t);return u[s][e](t)},i.resolve=function(e){for(var t=e.split("/"),i=[],s=0;s<t.length;s++){var n=t[s];"."===n||""===n&&0!==s&&s!==t.length-1||(".."===n?i.pop():i.push(n))}return i.join("/")},i.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":s.nodebuffer&&r.isBuffer(e)?"nodebuffer":s.uint8array&&e instanceof Uint8Array?"uint8array":s.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},i.checkSupport=function(e){if(!s[e.toLowerCase()])throw new Error(e+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(e){var t,i,s="";for(i=0;i<(e||"").length;i++)s+="\\x"+((t=e.charCodeAt(i))<16?"0":"")+t.toString(16).toUpperCase();return s},i.delay=function(e,t,i){a((function(){e.apply(i||null,t||[])}))},i.inherits=function(e,t){var i=function(){};i.prototype=t.prototype,e.prototype=new i},i.extend=function(){var e,t,i={};for(e=0;e<arguments.length;e++)for(t in arguments[e])arguments[e].hasOwnProperty(t)&&void 0===i[t]&&(i[t]=arguments[e][t]);return i},i.prepareContent=function(e,t,r,a,l){return o.Promise.resolve(t).then((function(e){return s.blob&&(e instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(e)))&&"undefined"!=typeof FileReader?new o.Promise((function(t,i){var s=new FileReader;s.onload=function(e){t(e.target.result)},s.onerror=function(e){i(e.target.error)},s.readAsArrayBuffer(e)})):e})).then((function(t){var c,d=i.getTypeOf(t);return d?("arraybuffer"===d?t=i.transformTo("uint8array",t):"string"===d&&(l?t=n.decode(t):r&&!0!==a&&(t=h(c=t,s.uint8array?new Uint8Array(c.length):new Array(c.length)))),t):o.Promise.reject(new Error("Can't read the data of '"+e+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))}))}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,"set-immediate-shim":54}],33:[function(e,t,i){var s=e("./reader/readerFor"),n=e("./utils"),r=e("./signature"),a=e("./zipEntry");e("./utf8");var o=e("./support");function l(e){this.files=[],this.loadOptions=e}l.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var t=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+n.pretty(t)+", expected "+n.pretty(e)+")")}},isSignature:function(e,t){var i=this.reader.index;this.reader.setIndex(e);var s=this.reader.readString(4)===t;return this.reader.setIndex(i),s},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=o.uint8array?"uint8array":"array",i=n.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(i)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,i,s=this.zip64EndOfCentralSize-44;0<s;)e=this.reader.readInt(2),t=this.reader.readInt(4),i=this.reader.readData(t),this.zip64ExtensibleData[e]={id:e,length:t,value:i}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(r.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(r.CENTRAL_FILE_HEADER);)(e=new a({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(r.CENTRAL_DIRECTORY_END);if(e<0)throw!this.isSignature(0,r.LOCAL_FILE_HEADER)?new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip: can't find end of central directory");this.reader.setIndex(e);var t=e;if(this.checkSignature(r.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===n.MAX_VALUE_16BITS||this.diskWithCentralDirStart===n.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===n.MAX_VALUE_16BITS||this.centralDirRecords===n.MAX_VALUE_16BITS||this.centralDirSize===n.MAX_VALUE_32BITS||this.centralDirOffset===n.MAX_VALUE_32BITS){if(this.zip64=!0,(e=this.reader.lastIndexOfSignature(r.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(r.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,r.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(r.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(r.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var i=this.centralDirOffset+this.centralDirSize;this.zip64&&(i+=20,i+=12+this.zip64EndOfCentralSize);var s=t-i;if(s>0)this.isSignature(t,r.CENTRAL_FILE_HEADER)||(this.reader.zero=s);else if(s<0)throw new Error("Corrupted zip: missing "+Math.abs(s)+" bytes.")},prepareReader:function(e){this.reader=s(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=l},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utf8":31,"./utils":32,"./zipEntry":34}],34:[function(e,t,i){var s=e("./reader/readerFor"),n=e("./utils"),r=e("./compressedObject"),a=e("./crc32"),o=e("./utf8"),l=e("./compressions"),h=e("./support");function c(e,t){this.options=e,this.loadOptions=t}c.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(e){var t,i;if(e.skip(22),this.fileNameLength=e.readInt(2),i=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(i),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(t=function(e){for(var t in l)if(l.hasOwnProperty(t)&&l[t].magic===e)return l[t];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+n.pretty(this.compressionMethod)+" unknown (inner file : "+n.transformTo("string",this.fileName)+")");this.decompressed=new r(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0===e&&(this.dosPermissions=63&this.externalFileAttributes),3===e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(e){if(this.extraFields[1]){var t=s(this.extraFields[1].value);this.uncompressedSize===n.MAX_VALUE_32BITS&&(this.uncompressedSize=t.readInt(8)),this.compressedSize===n.MAX_VALUE_32BITS&&(this.compressedSize=t.readInt(8)),this.localHeaderOffset===n.MAX_VALUE_32BITS&&(this.localHeaderOffset=t.readInt(8)),this.diskNumberStart===n.MAX_VALUE_32BITS&&(this.diskNumberStart=t.readInt(4))}},readExtraFields:function(e){var t,i,s,n=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index+4<n;)t=e.readInt(2),i=e.readInt(2),s=e.readData(i),this.extraFields[t]={id:t,length:i,value:s};e.setIndex(n)},handleUTF8:function(){var e=h.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=o.utf8decode(this.fileName),this.fileCommentStr=o.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(null!==t)this.fileNameStr=t;else{var i=n.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(i)}var s=this.findExtraFieldUnicodeComment();if(null!==s)this.fileCommentStr=s;else{var r=n.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(r)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=s(e.value);return 1!==t.readInt(1)||a(this.fileName)!==t.readInt(4)?null:o.utf8decode(t.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=s(e.value);return 1!==t.readInt(1)||a(this.fileComment)!==t.readInt(4)?null:o.utf8decode(t.readData(e.length-5))}return null}},t.exports=c},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,t,i){var s=e("./stream/StreamHelper"),n=e("./stream/DataWorker"),r=e("./utf8"),a=e("./compressedObject"),o=e("./stream/GenericWorker"),l=function(e,t,i){this.name=e,this.dir=i.dir,this.date=i.date,this.comment=i.comment,this.unixPermissions=i.unixPermissions,this.dosPermissions=i.dosPermissions,this._data=t,this._dataBinary=i.binary,this.options={compression:i.compression,compressionOptions:i.compressionOptions}};l.prototype={internalStream:function(e){var t=null,i="string";try{if(!e)throw new Error("No output type specified.");var n="string"===(i=e.toLowerCase())||"text"===i;"binarystring"!==i&&"text"!==i||(i="string"),t=this._decompressWorker();var a=!this._dataBinary;a&&!n&&(t=t.pipe(new r.Utf8EncodeWorker)),!a&&n&&(t=t.pipe(new r.Utf8DecodeWorker))}catch(e){(t=new o("error")).error(e)}return new s(t,i,"")},async:function(e,t){return this.internalStream(e).accumulate(t)},nodeStream:function(e,t){return this.internalStream(e||"nodebuffer").toNodejsStream(t)},_compressWorker:function(e,t){if(this._data instanceof a&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var i=this._decompressWorker();return this._dataBinary||(i=i.pipe(new r.Utf8EncodeWorker)),a.createWorkerFrom(i,e,t)},_decompressWorker:function(){return this._data instanceof a?this._data.getContentWorker():this._data instanceof o?this._data:new n(this._data)}};for(var h=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],c=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},d=0;d<h.length;d++)l.prototype[h[d]]=c;t.exports=l},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,t,i){(function(e){var i,s,n=e.MutationObserver||e.WebKitMutationObserver;if(n){var r=0,a=new n(c),o=e.document.createTextNode("");a.observe(o,{characterData:!0}),i=function(){o.data=r=++r%2}}else if(e.setImmediate||void 0===e.MessageChannel)i="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){c(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(c,0)};else{var l=new e.MessageChannel;l.port1.onmessage=c,i=function(){l.port2.postMessage(0)}}var h=[];function c(){var e,t;s=!0;for(var i=h.length;i;){for(t=h,h=[],e=-1;++e<i;)t[e]();i=h.length}s=!1}t.exports=function(e){1!==h.push(e)||s||i()}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(e,t,i){var s=e("immediate");function n(){}var r={},a=["REJECTED"],o=["FULFILLED"],l=["PENDING"];function h(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,e!==n&&u(this,e)}function c(e,t,i){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof i&&(this.onRejected=i,this.callRejected=this.otherCallRejected)}function d(e,t,i){s((function(){var s;try{s=t(i)}catch(t){return r.reject(e,t)}s===e?r.reject(e,new TypeError("Cannot resolve promise with itself")):r.resolve(e,s)}))}function A(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function u(e,t){var i=!1;function s(t){i||(i=!0,r.reject(e,t))}function n(t){i||(i=!0,r.resolve(e,t))}var a=p((function(){t(n,s)}));"error"===a.status&&s(a.value)}function p(e,t){var i={};try{i.value=e(t),i.status="success"}catch(e){i.status="error",i.value=e}return i}t.exports=h,h.prototype.finally=function(e){if("function"!=typeof e)return this;var t=this.constructor;return this.then((function(i){return t.resolve(e()).then((function(){return i}))}),(function(i){return t.resolve(e()).then((function(){throw i}))}))},h.prototype.catch=function(e){return this.then(null,e)},h.prototype.then=function(e,t){if("function"!=typeof e&&this.state===o||"function"!=typeof t&&this.state===a)return this;var i=new this.constructor(n);this.state!==l?d(i,this.state===o?e:t,this.outcome):this.queue.push(new c(i,e,t));return i},c.prototype.callFulfilled=function(e){r.resolve(this.promise,e)},c.prototype.otherCallFulfilled=function(e){d(this.promise,this.onFulfilled,e)},c.prototype.callRejected=function(e){r.reject(this.promise,e)},c.prototype.otherCallRejected=function(e){d(this.promise,this.onRejected,e)},r.resolve=function(e,t){var i=p(A,t);if("error"===i.status)return r.reject(e,i.value);var s=i.value;if(s)u(e,s);else{e.state=o,e.outcome=t;for(var n=-1,a=e.queue.length;++n<a;)e.queue[n].callFulfilled(t)}return e},r.reject=function(e,t){e.state=a,e.outcome=t;for(var i=-1,s=e.queue.length;++i<s;)e.queue[i].callRejected(t);return e},h.resolve=function(e){if(e instanceof this)return e;return r.resolve(new this(n),e)},h.reject=function(e){var t=new this(n);return r.reject(t,e)},h.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var i=e.length,s=!1;if(!i)return this.resolve([]);var a=new Array(i),o=0,l=-1,h=new this(n);for(;++l<i;)c(e[l],l);return h;function c(e,n){t.resolve(e).then((function(e){a[n]=e,++o!==i||s||(s=!0,r.resolve(h,a))}),(function(e){s||(s=!0,r.reject(h,e))}))}},h.race=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var i=e.length,s=!1;if(!i)return this.resolve([]);var a=-1,o=new this(n);for(;++a<i;)l=e[a],t.resolve(l).then((function(e){s||(s=!0,r.resolve(o,e))}),(function(e){s||(s=!0,r.reject(o,e))}));var l;return o}},{immediate:36}],38:[function(e,t,i){var s={};(0,e("./lib/utils/common").assign)(s,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),t.exports=s},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,t,i){var s=e("./zlib/deflate"),n=e("./utils/common"),r=e("./utils/strings"),a=e("./zlib/messages"),o=e("./zlib/zstream"),l=Object.prototype.toString;function h(e){if(!(this instanceof h))return new h(e);this.options=n.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new o,this.strm.avail_out=0;var i=s.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(0!==i)throw new Error(a[i]);if(t.header&&s.deflateSetHeader(this.strm,t.header),t.dictionary){var c;if(c="string"==typeof t.dictionary?r.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,0!==(i=s.deflateSetDictionary(this.strm,c)))throw new Error(a[i]);this._dict_set=!0}}function c(e,t){var i=new h(t);if(i.push(e,!0),i.err)throw i.msg||a[i.err];return i.result}h.prototype.push=function(e,t){var i,a,o=this.strm,h=this.options.chunkSize;if(this.ended)return!1;a=t===~~t?t:!0===t?4:0,"string"==typeof e?o.input=r.string2buf(e):"[object ArrayBuffer]"===l.call(e)?o.input=new Uint8Array(e):o.input=e,o.next_in=0,o.avail_in=o.input.length;do{if(0===o.avail_out&&(o.output=new n.Buf8(h),o.next_out=0,o.avail_out=h),1!==(i=s.deflate(o,a))&&0!==i)return this.onEnd(i),this.ended=!0,!1;0!==o.avail_out&&(0!==o.avail_in||4!==a&&2!==a)||("string"===this.options.to?this.onData(r.buf2binstring(n.shrinkBuf(o.output,o.next_out))):this.onData(n.shrinkBuf(o.output,o.next_out)))}while((o.avail_in>0||0===o.avail_out)&&1!==i);return 4===a?(i=s.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,0===i):2!==a||(this.onEnd(0),o.avail_out=0,!0)},h.prototype.onData=function(e){this.chunks.push(e)},h.prototype.onEnd=function(e){0===e&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},i.Deflate=h,i.deflate=c,i.deflateRaw=function(e,t){return(t=t||{}).raw=!0,c(e,t)},i.gzip=function(e,t){return(t=t||{}).gzip=!0,c(e,t)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,t,i){var s=e("./zlib/inflate"),n=e("./utils/common"),r=e("./utils/strings"),a=e("./zlib/constants"),o=e("./zlib/messages"),l=e("./zlib/zstream"),h=e("./zlib/gzheader"),c=Object.prototype.toString;function d(e){if(!(this instanceof d))return new d(e);this.options=n.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var i=s.inflateInit2(this.strm,t.windowBits);if(i!==a.Z_OK)throw new Error(o[i]);this.header=new h,s.inflateGetHeader(this.strm,this.header)}function A(e,t){var i=new d(t);if(i.push(e,!0),i.err)throw i.msg||o[i.err];return i.result}d.prototype.push=function(e,t){var i,o,l,h,d,A,u=this.strm,p=this.options.chunkSize,g=this.options.dictionary,m=!1;if(this.ended)return!1;o=t===~~t?t:!0===t?a.Z_FINISH:a.Z_NO_FLUSH,"string"==typeof e?u.input=r.binstring2buf(e):"[object ArrayBuffer]"===c.call(e)?u.input=new Uint8Array(e):u.input=e,u.next_in=0,u.avail_in=u.input.length;do{if(0===u.avail_out&&(u.output=new n.Buf8(p),u.next_out=0,u.avail_out=p),(i=s.inflate(u,a.Z_NO_FLUSH))===a.Z_NEED_DICT&&g&&(A="string"==typeof g?r.string2buf(g):"[object ArrayBuffer]"===c.call(g)?new Uint8Array(g):g,i=s.inflateSetDictionary(this.strm,A)),i===a.Z_BUF_ERROR&&!0===m&&(i=a.Z_OK,m=!1),i!==a.Z_STREAM_END&&i!==a.Z_OK)return this.onEnd(i),this.ended=!0,!1;u.next_out&&(0!==u.avail_out&&i!==a.Z_STREAM_END&&(0!==u.avail_in||o!==a.Z_FINISH&&o!==a.Z_SYNC_FLUSH)||("string"===this.options.to?(l=r.utf8border(u.output,u.next_out),h=u.next_out-l,d=r.buf2string(u.output,l),u.next_out=h,u.avail_out=p-h,h&&n.arraySet(u.output,u.output,l,h,0),this.onData(d)):this.onData(n.shrinkBuf(u.output,u.next_out)))),0===u.avail_in&&0===u.avail_out&&(m=!0)}while((u.avail_in>0||0===u.avail_out)&&i!==a.Z_STREAM_END);return i===a.Z_STREAM_END&&(o=a.Z_FINISH),o===a.Z_FINISH?(i=s.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===a.Z_OK):o!==a.Z_SYNC_FLUSH||(this.onEnd(a.Z_OK),u.avail_out=0,!0)},d.prototype.onData=function(e){this.chunks.push(e)},d.prototype.onEnd=function(e){e===a.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},i.Inflate=d,i.inflate=A,i.inflateRaw=function(e,t){return(t=t||{}).raw=!0,A(e,t)},i.ungzip=A},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,t,i){var s="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;i.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var i=t.shift();if(i){if("object"!=typeof i)throw new TypeError(i+"must be non-object");for(var s in i)i.hasOwnProperty(s)&&(e[s]=i[s])}}return e},i.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var n={arraySet:function(e,t,i,s,n){if(t.subarray&&e.subarray)e.set(t.subarray(i,i+s),n);else for(var r=0;r<s;r++)e[n+r]=t[i+r]},flattenChunks:function(e){var t,i,s,n,r,a;for(s=0,t=0,i=e.length;t<i;t++)s+=e[t].length;for(a=new Uint8Array(s),n=0,t=0,i=e.length;t<i;t++)r=e[t],a.set(r,n),n+=r.length;return a}},r={arraySet:function(e,t,i,s,n){for(var r=0;r<s;r++)e[n+r]=t[i+r]},flattenChunks:function(e){return[].concat.apply([],e)}};i.setTyped=function(e){e?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,n)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,r))},i.setTyped(s)},{}],42:[function(e,t,i){var s=e("./common"),n=!0,r=!0;try{String.fromCharCode.apply(null,[0])}catch(e){n=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){r=!1}for(var a=new s.Buf8(256),o=0;o<256;o++)a[o]=o>=252?6:o>=248?5:o>=240?4:o>=224?3:o>=192?2:1;function l(e,t){if(t<65537&&(e.subarray&&r||!e.subarray&&n))return String.fromCharCode.apply(null,s.shrinkBuf(e,t));for(var i="",a=0;a<t;a++)i+=String.fromCharCode(e[a]);return i}a[254]=a[254]=1,i.string2buf=function(e){var t,i,n,r,a,o=e.length,l=0;for(r=0;r<o;r++)55296==(64512&(i=e.charCodeAt(r)))&&r+1<o&&56320==(64512&(n=e.charCodeAt(r+1)))&&(i=65536+(i-55296<<10)+(n-56320),r++),l+=i<128?1:i<2048?2:i<65536?3:4;for(t=new s.Buf8(l),a=0,r=0;a<l;r++)55296==(64512&(i=e.charCodeAt(r)))&&r+1<o&&56320==(64512&(n=e.charCodeAt(r+1)))&&(i=65536+(i-55296<<10)+(n-56320),r++),i<128?t[a++]=i:i<2048?(t[a++]=192|i>>>6,t[a++]=128|63&i):i<65536?(t[a++]=224|i>>>12,t[a++]=128|i>>>6&63,t[a++]=128|63&i):(t[a++]=240|i>>>18,t[a++]=128|i>>>12&63,t[a++]=128|i>>>6&63,t[a++]=128|63&i);return t},i.buf2binstring=function(e){return l(e,e.length)},i.binstring2buf=function(e){for(var t=new s.Buf8(e.length),i=0,n=t.length;i<n;i++)t[i]=e.charCodeAt(i);return t},i.buf2string=function(e,t){var i,s,n,r,o=t||e.length,h=new Array(2*o);for(s=0,i=0;i<o;)if((n=e[i++])<128)h[s++]=n;else if((r=a[n])>4)h[s++]=65533,i+=r-1;else{for(n&=2===r?31:3===r?15:7;r>1&&i<o;)n=n<<6|63&e[i++],r--;r>1?h[s++]=65533:n<65536?h[s++]=n:(n-=65536,h[s++]=55296|n>>10&1023,h[s++]=56320|1023&n)}return l(h,s)},i.utf8border=function(e,t){var i;for((t=t||e.length)>e.length&&(t=e.length),i=t-1;i>=0&&128==(192&e[i]);)i--;return i<0||0===i?t:i+a[e[i]]>t?i:t}},{"./common":41}],43:[function(e,t,i){t.exports=function(e,t,i,s){for(var n=65535&e|0,r=e>>>16&65535|0,a=0;0!==i;){i-=a=i>2e3?2e3:i;do{r=r+(n=n+t[s++]|0)|0}while(--a);n%=65521,r%=65521}return n|r<<16|0}},{}],44:[function(e,t,i){t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,t,i){var s=function(){for(var e,t=[],i=0;i<256;i++){e=i;for(var s=0;s<8;s++)e=1&e?3988292384^e>>>1:e>>>1;t[i]=e}return t}();t.exports=function(e,t,i,n){var r=s,a=n+i;e^=-1;for(var o=n;o<a;o++)e=e>>>8^r[255&(e^t[o])];return-1^e}},{}],46:[function(e,t,i){var s,n=e("../utils/common"),r=e("./trees"),a=e("./adler32"),o=e("./crc32"),l=e("./messages"),h=-2,c=258,d=262,A=103,u=113,p=666;function g(e,t){return e.msg=l[t],t}function m(e){return(e<<1)-(e>4?9:0)}function _(e){for(var t=e.length;--t>=0;)e[t]=0}function f(e){var t=e.state,i=t.pending;i>e.avail_out&&(i=e.avail_out),0!==i&&(n.arraySet(e.output,t.pending_buf,t.pending_out,i,e.next_out),e.next_out+=i,t.pending_out+=i,e.total_out+=i,e.avail_out-=i,t.pending-=i,0===t.pending&&(t.pending_out=0))}function b(e,t){r._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,f(e.strm)}function I(e,t){e.pending_buf[e.pending++]=t}function w(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function C(e,t,i,s){var r=e.avail_in;return r>s&&(r=s),0===r?0:(e.avail_in-=r,n.arraySet(t,e.input,e.next_in,r,i),1===e.state.wrap?e.adler=a(e.adler,t,r,i):2===e.state.wrap&&(e.adler=o(e.adler,t,r,i)),e.next_in+=r,e.total_in+=r,r)}function y(e,t){var i,s,n=e.max_chain_length,r=e.strstart,a=e.prev_length,o=e.nice_match,l=e.strstart>e.w_size-d?e.strstart-(e.w_size-d):0,h=e.window,A=e.w_mask,u=e.prev,p=e.strstart+c,g=h[r+a-1],m=h[r+a];e.prev_length>=e.good_match&&(n>>=2),o>e.lookahead&&(o=e.lookahead);do{if(h[(i=t)+a]===m&&h[i+a-1]===g&&h[i]===h[r]&&h[++i]===h[r+1]){r+=2,i++;do{}while(h[++r]===h[++i]&&h[++r]===h[++i]&&h[++r]===h[++i]&&h[++r]===h[++i]&&h[++r]===h[++i]&&h[++r]===h[++i]&&h[++r]===h[++i]&&h[++r]===h[++i]&&r<p);if(s=c-(p-r),r=p-c,s>a){if(e.match_start=t,a=s,s>=o)break;g=h[r+a-1],m=h[r+a]}}}while((t=u[t&A])>l&&0!=--n);return a<=e.lookahead?a:e.lookahead}function v(e){var t,i,s,r,a,o=e.w_size;do{if(r=e.window_size-e.lookahead-e.strstart,e.strstart>=o+(o-d)){n.arraySet(e.window,e.window,o,o,0),e.match_start-=o,e.strstart-=o,e.block_start-=o,t=i=e.hash_size;do{s=e.head[--t],e.head[t]=s>=o?s-o:0}while(--i);t=i=o;do{s=e.prev[--t],e.prev[t]=s>=o?s-o:0}while(--i);r+=o}if(0===e.strm.avail_in)break;if(i=C(e.strm,e.window,e.strstart+e.lookahead,r),e.lookahead+=i,e.lookahead+e.insert>=3)for(a=e.strstart-e.insert,e.ins_h=e.window[a],e.ins_h=(e.ins_h<<e.hash_shift^e.window[a+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[a+3-1])&e.hash_mask,e.prev[a&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=a,a++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<d&&0!==e.strm.avail_in)}function B(e,t){for(var i,s;;){if(e.lookahead<d){if(v(e),e.lookahead<d&&0===t)return 1;if(0===e.lookahead)break}if(i=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==i&&e.strstart-i<=e.w_size-d&&(e.match_length=y(e,i)),e.match_length>=3)if(s=r._tr_tally(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else s=r._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(s&&(b(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,4===t?(b(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(b(e,!1),0===e.strm.avail_out)?1:2}function E(e,t){for(var i,s,n;;){if(e.lookahead<d){if(v(e),e.lookahead<d&&0===t)return 1;if(0===e.lookahead)break}if(i=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==i&&e.prev_length<e.max_lazy_match&&e.strstart-i<=e.w_size-d&&(e.match_length=y(e,i),e.match_length<=5&&(1===e.strategy||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){n=e.strstart+e.lookahead-3,s=r._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=n&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,s&&(b(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((s=r._tr_tally(e,0,e.window[e.strstart-1]))&&b(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(s=r._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,4===t?(b(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(b(e,!1),0===e.strm.avail_out)?1:2}function S(e,t,i,s,n){this.good_length=e,this.max_lazy=t,this.nice_length=i,this.max_chain=s,this.func=n}function M(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new n.Buf16(1146),this.dyn_dtree=new n.Buf16(122),this.bl_tree=new n.Buf16(78),_(this.dyn_ltree),_(this.dyn_dtree),_(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new n.Buf16(16),this.heap=new n.Buf16(573),_(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new n.Buf16(573),_(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function x(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=2,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:u,e.adler=2===t.wrap?0:1,t.last_flush=0,r._tr_init(t),0):g(e,h)}function T(e){var t,i=x(e);return 0===i&&((t=e.state).window_size=2*t.w_size,_(t.head),t.max_lazy_match=s[t.level].max_lazy,t.good_match=s[t.level].good_length,t.nice_match=s[t.level].nice_length,t.max_chain_length=s[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0),i}function P(e,t,i,s,r,a){if(!e)return h;var o=1;if(-1===t&&(t=6),s<0?(o=0,s=-s):s>15&&(o=2,s-=16),r<1||r>9||8!==i||s<8||s>15||t<0||t>9||a<0||a>4)return g(e,h);8===s&&(s=9);var l=new M;return e.state=l,l.strm=e,l.wrap=o,l.gzhead=null,l.w_bits=s,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=r+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+3-1)/3),l.window=new n.Buf8(2*l.w_size),l.head=new n.Buf16(l.hash_size),l.prev=new n.Buf16(l.w_size),l.lit_bufsize=1<<r+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new n.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=t,l.strategy=a,l.method=i,T(e)}s=[new S(0,0,0,0,(function(e,t){var i=65535;for(i>e.pending_buf_size-5&&(i=e.pending_buf_size-5);;){if(e.lookahead<=1){if(v(e),0===e.lookahead&&0===t)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var s=e.block_start+i;if((0===e.strstart||e.strstart>=s)&&(e.lookahead=e.strstart-s,e.strstart=s,b(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-d&&(b(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(b(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(b(e,!1),e.strm.avail_out),1)})),new S(4,4,8,4,B),new S(4,5,16,8,B),new S(4,6,32,32,B),new S(4,4,16,16,E),new S(8,16,32,32,E),new S(8,16,128,128,E),new S(8,32,128,256,E),new S(32,128,258,1024,E),new S(32,258,258,4096,E)],i.deflateInit=function(e,t){return P(e,t,8,15,8,0)},i.deflateInit2=P,i.deflateReset=T,i.deflateResetKeep=x,i.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?h:(e.state.gzhead=t,0):h},i.deflate=function(e,t){var i,n,a,l;if(!e||!e.state||t>5||t<0)return e?g(e,h):h;if(n=e.state,!e.output||!e.input&&0!==e.avail_in||n.status===p&&4!==t)return g(e,0===e.avail_out?-5:h);if(n.strm=e,i=n.last_flush,n.last_flush=t,42===n.status)if(2===n.wrap)e.adler=0,I(n,31),I(n,139),I(n,8),n.gzhead?(I(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),I(n,255&n.gzhead.time),I(n,n.gzhead.time>>8&255),I(n,n.gzhead.time>>16&255),I(n,n.gzhead.time>>24&255),I(n,9===n.level?2:n.strategy>=2||n.level<2?4:0),I(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(I(n,255&n.gzhead.extra.length),I(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=o(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69):(I(n,0),I(n,0),I(n,0),I(n,0),I(n,0),I(n,9===n.level?2:n.strategy>=2||n.level<2?4:0),I(n,3),n.status=u);else{var d=8+(n.w_bits-8<<4)<<8;d|=(n.strategy>=2||n.level<2?0:n.level<6?1:6===n.level?2:3)<<6,0!==n.strstart&&(d|=32),d+=31-d%31,n.status=u,w(n,d),0!==n.strstart&&(w(n,e.adler>>>16),w(n,65535&e.adler)),e.adler=1}if(69===n.status)if(n.gzhead.extra){for(a=n.pending;n.gzindex<(65535&n.gzhead.extra.length)&&(n.pending!==n.pending_buf_size||(n.gzhead.hcrc&&n.pending>a&&(e.adler=o(e.adler,n.pending_buf,n.pending-a,a)),f(e),a=n.pending,n.pending!==n.pending_buf_size));)I(n,255&n.gzhead.extra[n.gzindex]),n.gzindex++;n.gzhead.hcrc&&n.pending>a&&(e.adler=o(e.adler,n.pending_buf,n.pending-a,a)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=73)}else n.status=73;if(73===n.status)if(n.gzhead.name){a=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>a&&(e.adler=o(e.adler,n.pending_buf,n.pending-a,a)),f(e),a=n.pending,n.pending===n.pending_buf_size)){l=1;break}l=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,I(n,l)}while(0!==l);n.gzhead.hcrc&&n.pending>a&&(e.adler=o(e.adler,n.pending_buf,n.pending-a,a)),0===l&&(n.gzindex=0,n.status=91)}else n.status=91;if(91===n.status)if(n.gzhead.comment){a=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>a&&(e.adler=o(e.adler,n.pending_buf,n.pending-a,a)),f(e),a=n.pending,n.pending===n.pending_buf_size)){l=1;break}l=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,I(n,l)}while(0!==l);n.gzhead.hcrc&&n.pending>a&&(e.adler=o(e.adler,n.pending_buf,n.pending-a,a)),0===l&&(n.status=A)}else n.status=A;if(n.status===A&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&f(e),n.pending+2<=n.pending_buf_size&&(I(n,255&e.adler),I(n,e.adler>>8&255),e.adler=0,n.status=u)):n.status=u),0!==n.pending){if(f(e),0===e.avail_out)return n.last_flush=-1,0}else if(0===e.avail_in&&m(t)<=m(i)&&4!==t)return g(e,-5);if(n.status===p&&0!==e.avail_in)return g(e,-5);if(0!==e.avail_in||0!==n.lookahead||0!==t&&n.status!==p){var C=2===n.strategy?function(e,t){for(var i;;){if(0===e.lookahead&&(v(e),0===e.lookahead)){if(0===t)return 1;break}if(e.match_length=0,i=r._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,i&&(b(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(b(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(b(e,!1),0===e.strm.avail_out)?1:2}(n,t):3===n.strategy?function(e,t){for(var i,s,n,a,o=e.window;;){if(e.lookahead<=c){if(v(e),e.lookahead<=c&&0===t)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(s=o[n=e.strstart-1])===o[++n]&&s===o[++n]&&s===o[++n]){a=e.strstart+c;do{}while(s===o[++n]&&s===o[++n]&&s===o[++n]&&s===o[++n]&&s===o[++n]&&s===o[++n]&&s===o[++n]&&s===o[++n]&&n<a);e.match_length=c-(a-n),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(i=r._tr_tally(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(i=r._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),i&&(b(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(b(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(b(e,!1),0===e.strm.avail_out)?1:2}(n,t):s[n.level].func(n,t);if(3!==C&&4!==C||(n.status=p),1===C||3===C)return 0===e.avail_out&&(n.last_flush=-1),0;if(2===C&&(1===t?r._tr_align(n):5!==t&&(r._tr_stored_block(n,0,0,!1),3===t&&(_(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),f(e),0===e.avail_out))return n.last_flush=-1,0}return 4!==t?0:n.wrap<=0?1:(2===n.wrap?(I(n,255&e.adler),I(n,e.adler>>8&255),I(n,e.adler>>16&255),I(n,e.adler>>24&255),I(n,255&e.total_in),I(n,e.total_in>>8&255),I(n,e.total_in>>16&255),I(n,e.total_in>>24&255)):(w(n,e.adler>>>16),w(n,65535&e.adler)),f(e),n.wrap>0&&(n.wrap=-n.wrap),0!==n.pending?0:1)},i.deflateEnd=function(e){var t;return e&&e.state?42!==(t=e.state.status)&&69!==t&&73!==t&&91!==t&&t!==A&&t!==u&&t!==p?g(e,h):(e.state=null,t===u?g(e,-3):0):h},i.deflateSetDictionary=function(e,t){var i,s,r,o,l,c,d,A,u=t.length;if(!e||!e.state)return h;if(2===(o=(i=e.state).wrap)||1===o&&42!==i.status||i.lookahead)return h;for(1===o&&(e.adler=a(e.adler,t,u,0)),i.wrap=0,u>=i.w_size&&(0===o&&(_(i.head),i.strstart=0,i.block_start=0,i.insert=0),A=new n.Buf8(i.w_size),n.arraySet(A,t,u-i.w_size,i.w_size,0),t=A,u=i.w_size),l=e.avail_in,c=e.next_in,d=e.input,e.avail_in=u,e.next_in=0,e.input=t,v(i);i.lookahead>=3;){s=i.strstart,r=i.lookahead-2;do{i.ins_h=(i.ins_h<<i.hash_shift^i.window[s+3-1])&i.hash_mask,i.prev[s&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=s,s++}while(--r);i.strstart=s,i.lookahead=2,v(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=2,i.match_available=0,e.next_in=c,e.input=d,e.avail_in=l,i.wrap=o,0},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,t,i){t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,t,i){t.exports=function(e,t){var i,s,n,r,a,o,l,h,c,d,A,u,p,g,m,_,f,b,I,w,C,y,v,B,E;i=e.state,s=e.next_in,B=e.input,n=s+(e.avail_in-5),r=e.next_out,E=e.output,a=r-(t-e.avail_out),o=r+(e.avail_out-257),l=i.dmax,h=i.wsize,c=i.whave,d=i.wnext,A=i.window,u=i.hold,p=i.bits,g=i.lencode,m=i.distcode,_=(1<<i.lenbits)-1,f=(1<<i.distbits)-1;e:do{p<15&&(u+=B[s++]<<p,p+=8,u+=B[s++]<<p,p+=8),b=g[u&_];t:for(;;){if(u>>>=I=b>>>24,p-=I,0===(I=b>>>16&255))E[r++]=65535&b;else{if(!(16&I)){if(0==(64&I)){b=g[(65535&b)+(u&(1<<I)-1)];continue t}if(32&I){i.mode=12;break e}e.msg="invalid literal/length code",i.mode=30;break e}w=65535&b,(I&=15)&&(p<I&&(u+=B[s++]<<p,p+=8),w+=u&(1<<I)-1,u>>>=I,p-=I),p<15&&(u+=B[s++]<<p,p+=8,u+=B[s++]<<p,p+=8),b=m[u&f];i:for(;;){if(u>>>=I=b>>>24,p-=I,!(16&(I=b>>>16&255))){if(0==(64&I)){b=m[(65535&b)+(u&(1<<I)-1)];continue i}e.msg="invalid distance code",i.mode=30;break e}if(C=65535&b,p<(I&=15)&&(u+=B[s++]<<p,(p+=8)<I&&(u+=B[s++]<<p,p+=8)),(C+=u&(1<<I)-1)>l){e.msg="invalid distance too far back",i.mode=30;break e}if(u>>>=I,p-=I,C>(I=r-a)){if((I=C-I)>c&&i.sane){e.msg="invalid distance too far back",i.mode=30;break e}if(y=0,v=A,0===d){if(y+=h-I,I<w){w-=I;do{E[r++]=A[y++]}while(--I);y=r-C,v=E}}else if(d<I){if(y+=h+d-I,(I-=d)<w){w-=I;do{E[r++]=A[y++]}while(--I);if(y=0,d<w){w-=I=d;do{E[r++]=A[y++]}while(--I);y=r-C,v=E}}}else if(y+=d-I,I<w){w-=I;do{E[r++]=A[y++]}while(--I);y=r-C,v=E}for(;w>2;)E[r++]=v[y++],E[r++]=v[y++],E[r++]=v[y++],w-=3;w&&(E[r++]=v[y++],w>1&&(E[r++]=v[y++]))}else{y=r-C;do{E[r++]=E[y++],E[r++]=E[y++],E[r++]=E[y++],w-=3}while(w>2);w&&(E[r++]=E[y++],w>1&&(E[r++]=E[y++]))}break}}break}}while(s<n&&r<o);s-=w=p>>3,u&=(1<<(p-=w<<3))-1,e.next_in=s,e.next_out=r,e.avail_in=s<n?n-s+5:5-(s-n),e.avail_out=r<o?o-r+257:257-(r-o),i.hold=u,i.bits=p}},{}],49:[function(e,t,i){var s=e("../utils/common"),n=e("./adler32"),r=e("./crc32"),a=e("./inffast"),o=e("./inftrees"),l=-2,h=12,c=30;function d(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function A(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function u(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new s.Buf32(852),t.distcode=t.distdyn=new s.Buf32(592),t.sane=1,t.back=-1,0):l}function p(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,u(e)):l}function g(e,t){var i,s;return e&&e.state?(s=e.state,t<0?(i=0,t=-t):(i=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?l:(null!==s.window&&s.wbits!==t&&(s.window=null),s.wrap=i,s.wbits=t,p(e))):l}function m(e,t){var i,s;return e?(s=new A,e.state=s,s.window=null,0!==(i=g(e,t))&&(e.state=null),i):l}var _,f,b=!0;function I(e){if(b){var t;for(_=new s.Buf32(512),f=new s.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(o(1,e.lens,0,288,_,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;o(2,e.lens,0,32,f,0,e.work,{bits:5}),b=!1}e.lencode=_,e.lenbits=9,e.distcode=f,e.distbits=5}function w(e,t,i,n){var r,a=e.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new s.Buf8(a.wsize)),n>=a.wsize?(s.arraySet(a.window,t,i-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):((r=a.wsize-a.wnext)>n&&(r=n),s.arraySet(a.window,t,i-n,r,a.wnext),(n-=r)?(s.arraySet(a.window,t,i-n,n,0),a.wnext=n,a.whave=a.wsize):(a.wnext+=r,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=r))),0}i.inflateReset=p,i.inflateReset2=g,i.inflateResetKeep=u,i.inflateInit=function(e){return m(e,15)},i.inflateInit2=m,i.inflate=function(e,t){var i,A,u,p,g,m,_,f,b,C,y,v,B,E,S,M,x,T,P,k,D,F,Q,R,O=0,L=new s.Buf8(4),N=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return l;(i=e.state).mode===h&&(i.mode=13),g=e.next_out,u=e.output,_=e.avail_out,p=e.next_in,A=e.input,m=e.avail_in,f=i.hold,b=i.bits,C=m,y=_,F=0;e:for(;;)switch(i.mode){case 1:if(0===i.wrap){i.mode=13;break}for(;b<16;){if(0===m)break e;m--,f+=A[p++]<<b,b+=8}if(2&i.wrap&&35615===f){i.check=0,L[0]=255&f,L[1]=f>>>8&255,i.check=r(i.check,L,2,0),f=0,b=0,i.mode=2;break}if(i.flags=0,i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&f)<<8)+(f>>8))%31){e.msg="incorrect header check",i.mode=c;break}if(8!=(15&f)){e.msg="unknown compression method",i.mode=c;break}if(b-=4,D=8+(15&(f>>>=4)),0===i.wbits)i.wbits=D;else if(D>i.wbits){e.msg="invalid window size",i.mode=c;break}i.dmax=1<<D,e.adler=i.check=1,i.mode=512&f?10:h,f=0,b=0;break;case 2:for(;b<16;){if(0===m)break e;m--,f+=A[p++]<<b,b+=8}if(i.flags=f,8!=(255&i.flags)){e.msg="unknown compression method",i.mode=c;break}if(57344&i.flags){e.msg="unknown header flags set",i.mode=c;break}i.head&&(i.head.text=f>>8&1),512&i.flags&&(L[0]=255&f,L[1]=f>>>8&255,i.check=r(i.check,L,2,0)),f=0,b=0,i.mode=3;case 3:for(;b<32;){if(0===m)break e;m--,f+=A[p++]<<b,b+=8}i.head&&(i.head.time=f),512&i.flags&&(L[0]=255&f,L[1]=f>>>8&255,L[2]=f>>>16&255,L[3]=f>>>24&255,i.check=r(i.check,L,4,0)),f=0,b=0,i.mode=4;case 4:for(;b<16;){if(0===m)break e;m--,f+=A[p++]<<b,b+=8}i.head&&(i.head.xflags=255&f,i.head.os=f>>8),512&i.flags&&(L[0]=255&f,L[1]=f>>>8&255,i.check=r(i.check,L,2,0)),f=0,b=0,i.mode=5;case 5:if(1024&i.flags){for(;b<16;){if(0===m)break e;m--,f+=A[p++]<<b,b+=8}i.length=f,i.head&&(i.head.extra_len=f),512&i.flags&&(L[0]=255&f,L[1]=f>>>8&255,i.check=r(i.check,L,2,0)),f=0,b=0}else i.head&&(i.head.extra=null);i.mode=6;case 6:if(1024&i.flags&&((v=i.length)>m&&(v=m),v&&(i.head&&(D=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Array(i.head.extra_len)),s.arraySet(i.head.extra,A,p,v,D)),512&i.flags&&(i.check=r(i.check,A,v,p)),m-=v,p+=v,i.length-=v),i.length))break e;i.length=0,i.mode=7;case 7:if(2048&i.flags){if(0===m)break e;v=0;do{D=A[p+v++],i.head&&D&&i.length<65536&&(i.head.name+=String.fromCharCode(D))}while(D&&v<m);if(512&i.flags&&(i.check=r(i.check,A,v,p)),m-=v,p+=v,D)break e}else i.head&&(i.head.name=null);i.length=0,i.mode=8;case 8:if(4096&i.flags){if(0===m)break e;v=0;do{D=A[p+v++],i.head&&D&&i.length<65536&&(i.head.comment+=String.fromCharCode(D))}while(D&&v<m);if(512&i.flags&&(i.check=r(i.check,A,v,p)),m-=v,p+=v,D)break e}else i.head&&(i.head.comment=null);i.mode=9;case 9:if(512&i.flags){for(;b<16;){if(0===m)break e;m--,f+=A[p++]<<b,b+=8}if(f!==(65535&i.check)){e.msg="header crc mismatch",i.mode=c;break}f=0,b=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),e.adler=i.check=0,i.mode=h;break;case 10:for(;b<32;){if(0===m)break e;m--,f+=A[p++]<<b,b+=8}e.adler=i.check=d(f),f=0,b=0,i.mode=11;case 11:if(0===i.havedict)return e.next_out=g,e.avail_out=_,e.next_in=p,e.avail_in=m,i.hold=f,i.bits=b,2;e.adler=i.check=1,i.mode=h;case h:if(5===t||6===t)break e;case 13:if(i.last){f>>>=7&b,b-=7&b,i.mode=27;break}for(;b<3;){if(0===m)break e;m--,f+=A[p++]<<b,b+=8}switch(i.last=1&f,b-=1,3&(f>>>=1)){case 0:i.mode=14;break;case 1:if(I(i),i.mode=20,6===t){f>>>=2,b-=2;break e}break;case 2:i.mode=17;break;case 3:e.msg="invalid block type",i.mode=c}f>>>=2,b-=2;break;case 14:for(f>>>=7&b,b-=7&b;b<32;){if(0===m)break e;m--,f+=A[p++]<<b,b+=8}if((65535&f)!=(f>>>16^65535)){e.msg="invalid stored block lengths",i.mode=c;break}if(i.length=65535&f,f=0,b=0,i.mode=15,6===t)break e;case 15:i.mode=16;case 16:if(v=i.length){if(v>m&&(v=m),v>_&&(v=_),0===v)break e;s.arraySet(u,A,p,v,g),m-=v,p+=v,_-=v,g+=v,i.length-=v;break}i.mode=h;break;case 17:for(;b<14;){if(0===m)break e;m--,f+=A[p++]<<b,b+=8}if(i.nlen=257+(31&f),f>>>=5,b-=5,i.ndist=1+(31&f),f>>>=5,b-=5,i.ncode=4+(15&f),f>>>=4,b-=4,i.nlen>286||i.ndist>30){e.msg="too many length or distance symbols",i.mode=c;break}i.have=0,i.mode=18;case 18:for(;i.have<i.ncode;){for(;b<3;){if(0===m)break e;m--,f+=A[p++]<<b,b+=8}i.lens[N[i.have++]]=7&f,f>>>=3,b-=3}for(;i.have<19;)i.lens[N[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,Q={bits:i.lenbits},F=o(0,i.lens,0,19,i.lencode,0,i.work,Q),i.lenbits=Q.bits,F){e.msg="invalid code lengths set",i.mode=c;break}i.have=0,i.mode=19;case 19:for(;i.have<i.nlen+i.ndist;){for(;M=(O=i.lencode[f&(1<<i.lenbits)-1])>>>16&255,x=65535&O,!((S=O>>>24)<=b);){if(0===m)break e;m--,f+=A[p++]<<b,b+=8}if(x<16)f>>>=S,b-=S,i.lens[i.have++]=x;else{if(16===x){for(R=S+2;b<R;){if(0===m)break e;m--,f+=A[p++]<<b,b+=8}if(f>>>=S,b-=S,0===i.have){e.msg="invalid bit length repeat",i.mode=c;break}D=i.lens[i.have-1],v=3+(3&f),f>>>=2,b-=2}else if(17===x){for(R=S+3;b<R;){if(0===m)break e;m--,f+=A[p++]<<b,b+=8}b-=S,D=0,v=3+(7&(f>>>=S)),f>>>=3,b-=3}else{for(R=S+7;b<R;){if(0===m)break e;m--,f+=A[p++]<<b,b+=8}b-=S,D=0,v=11+(127&(f>>>=S)),f>>>=7,b-=7}if(i.have+v>i.nlen+i.ndist){e.msg="invalid bit length repeat",i.mode=c;break}for(;v--;)i.lens[i.have++]=D}}if(i.mode===c)break;if(0===i.lens[256]){e.msg="invalid code -- missing end-of-block",i.mode=c;break}if(i.lenbits=9,Q={bits:i.lenbits},F=o(1,i.lens,0,i.nlen,i.lencode,0,i.work,Q),i.lenbits=Q.bits,F){e.msg="invalid literal/lengths set",i.mode=c;break}if(i.distbits=6,i.distcode=i.distdyn,Q={bits:i.distbits},F=o(2,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,Q),i.distbits=Q.bits,F){e.msg="invalid distances set",i.mode=c;break}if(i.mode=20,6===t)break e;case 20:i.mode=21;case 21:if(m>=6&&_>=258){e.next_out=g,e.avail_out=_,e.next_in=p,e.avail_in=m,i.hold=f,i.bits=b,a(e,y),g=e.next_out,u=e.output,_=e.avail_out,p=e.next_in,A=e.input,m=e.avail_in,f=i.hold,b=i.bits,i.mode===h&&(i.back=-1);break}for(i.back=0;M=(O=i.lencode[f&(1<<i.lenbits)-1])>>>16&255,x=65535&O,!((S=O>>>24)<=b);){if(0===m)break e;m--,f+=A[p++]<<b,b+=8}if(M&&0==(240&M)){for(T=S,P=M,k=x;M=(O=i.lencode[k+((f&(1<<T+P)-1)>>T)])>>>16&255,x=65535&O,!(T+(S=O>>>24)<=b);){if(0===m)break e;m--,f+=A[p++]<<b,b+=8}f>>>=T,b-=T,i.back+=T}if(f>>>=S,b-=S,i.back+=S,i.length=x,0===M){i.mode=26;break}if(32&M){i.back=-1,i.mode=h;break}if(64&M){e.msg="invalid literal/length code",i.mode=c;break}i.extra=15&M,i.mode=22;case 22:if(i.extra){for(R=i.extra;b<R;){if(0===m)break e;m--,f+=A[p++]<<b,b+=8}i.length+=f&(1<<i.extra)-1,f>>>=i.extra,b-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=23;case 23:for(;M=(O=i.distcode[f&(1<<i.distbits)-1])>>>16&255,x=65535&O,!((S=O>>>24)<=b);){if(0===m)break e;m--,f+=A[p++]<<b,b+=8}if(0==(240&M)){for(T=S,P=M,k=x;M=(O=i.distcode[k+((f&(1<<T+P)-1)>>T)])>>>16&255,x=65535&O,!(T+(S=O>>>24)<=b);){if(0===m)break e;m--,f+=A[p++]<<b,b+=8}f>>>=T,b-=T,i.back+=T}if(f>>>=S,b-=S,i.back+=S,64&M){e.msg="invalid distance code",i.mode=c;break}i.offset=x,i.extra=15&M,i.mode=24;case 24:if(i.extra){for(R=i.extra;b<R;){if(0===m)break e;m--,f+=A[p++]<<b,b+=8}i.offset+=f&(1<<i.extra)-1,f>>>=i.extra,b-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){e.msg="invalid distance too far back",i.mode=c;break}i.mode=25;case 25:if(0===_)break e;if(v=y-_,i.offset>v){if((v=i.offset-v)>i.whave&&i.sane){e.msg="invalid distance too far back",i.mode=c;break}v>i.wnext?(v-=i.wnext,B=i.wsize-v):B=i.wnext-v,v>i.length&&(v=i.length),E=i.window}else E=u,B=g-i.offset,v=i.length;v>_&&(v=_),_-=v,i.length-=v;do{u[g++]=E[B++]}while(--v);0===i.length&&(i.mode=21);break;case 26:if(0===_)break e;u[g++]=i.length,_--,i.mode=21;break;case 27:if(i.wrap){for(;b<32;){if(0===m)break e;m--,f|=A[p++]<<b,b+=8}if(y-=_,e.total_out+=y,i.total+=y,y&&(e.adler=i.check=i.flags?r(i.check,u,y,g-y):n(i.check,u,y,g-y)),y=_,(i.flags?f:d(f))!==i.check){e.msg="incorrect data check",i.mode=c;break}f=0,b=0}i.mode=28;case 28:if(i.wrap&&i.flags){for(;b<32;){if(0===m)break e;m--,f+=A[p++]<<b,b+=8}if(f!==(4294967295&i.total)){e.msg="incorrect length check",i.mode=c;break}f=0,b=0}i.mode=29;case 29:F=1;break e;case c:F=-3;break e;case 31:return-4;default:return l}return e.next_out=g,e.avail_out=_,e.next_in=p,e.avail_in=m,i.hold=f,i.bits=b,(i.wsize||y!==e.avail_out&&i.mode<c&&(i.mode<27||4!==t))&&w(e,e.output,e.next_out,y-e.avail_out),C-=e.avail_in,y-=e.avail_out,e.total_in+=C,e.total_out+=y,i.total+=y,i.wrap&&y&&(e.adler=i.check=i.flags?r(i.check,u,y,e.next_out-y):n(i.check,u,y,e.next_out-y)),e.data_type=i.bits+(i.last?64:0)+(i.mode===h?128:0)+(20===i.mode||15===i.mode?256:0),(0===C&&0===y||4===t)&&0===F&&(F=-5),F},i.inflateEnd=function(e){if(!e||!e.state)return l;var t=e.state;return t.window&&(t.window=null),e.state=null,0},i.inflateGetHeader=function(e,t){var i;return e&&e.state?0==(2&(i=e.state).wrap)?l:(i.head=t,t.done=!1,0):l},i.inflateSetDictionary=function(e,t){var i,s=t.length;return e&&e.state?0!==(i=e.state).wrap&&11!==i.mode?l:11===i.mode&&n(1,t,s,0)!==i.check?-3:w(e,t,s,s)?(i.mode=31,-4):(i.havedict=1,0):l},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,t,i){var s=e("../utils/common"),n=15,r=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],l=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,i,h,c,d,A,u){var p,g,m,_,f,b,I,w,C,y=u.bits,v=0,B=0,E=0,S=0,M=0,x=0,T=0,P=0,k=0,D=0,F=null,Q=0,R=new s.Buf16(16),O=new s.Buf16(16),L=null,N=0;for(v=0;v<=n;v++)R[v]=0;for(B=0;B<h;B++)R[t[i+B]]++;for(M=y,S=n;S>=1&&0===R[S];S--);if(M>S&&(M=S),0===S)return c[d++]=20971520,c[d++]=20971520,u.bits=1,0;for(E=1;E<S&&0===R[E];E++);for(M<E&&(M=E),P=1,v=1;v<=n;v++)if(P<<=1,(P-=R[v])<0)return-1;if(P>0&&(0===e||1!==S))return-1;for(O[1]=0,v=1;v<n;v++)O[v+1]=O[v]+R[v];for(B=0;B<h;B++)0!==t[i+B]&&(A[O[t[i+B]]++]=B);if(0===e?(F=L=A,b=19):1===e?(F=r,Q-=257,L=a,N-=257,b=256):(F=o,L=l,b=-1),D=0,B=0,v=E,f=d,x=M,T=0,m=-1,_=(k=1<<M)-1,1===e&&k>852||2===e&&k>592)return 1;for(;;){I=v-T,A[B]<b?(w=0,C=A[B]):A[B]>b?(w=L[N+A[B]],C=F[Q+A[B]]):(w=96,C=0),p=1<<v-T,E=g=1<<x;do{c[f+(D>>T)+(g-=p)]=I<<24|w<<16|C|0}while(0!==g);for(p=1<<v-1;D&p;)p>>=1;if(0!==p?(D&=p-1,D+=p):D=0,B++,0==--R[v]){if(v===S)break;v=t[i+A[B]]}if(v>M&&(D&_)!==m){for(0===T&&(T=M),f+=E,P=1<<(x=v-T);x+T<S&&!((P-=R[x+T])<=0);)x++,P<<=1;if(k+=1<<x,1===e&&k>852||2===e&&k>592)return 1;c[m=D&_]=M<<24|x<<16|f-d|0}}return 0!==D&&(c[f+D]=v-T<<24|64<<16|0),u.bits=M,0}},{"../utils/common":41}],51:[function(e,t,i){t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,t,i){var s=e("../utils/common");function n(e){for(var t=e.length;--t>=0;)e[t]=0}var r=256,a=286,o=30,l=15,h=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],c=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],d=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],A=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],u=new Array(576);n(u);var p=new Array(60);n(p);var g=new Array(512);n(g);var m=new Array(256);n(m);var _=new Array(29);n(_);var f,b,I,w=new Array(o);function C(e,t,i,s,n){this.static_tree=e,this.extra_bits=t,this.extra_base=i,this.elems=s,this.max_length=n,this.has_stree=e&&e.length}function y(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function v(e){return e<256?g[e]:g[256+(e>>>7)]}function B(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function E(e,t,i){e.bi_valid>16-i?(e.bi_buf|=t<<e.bi_valid&65535,B(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=i-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=i)}function S(e,t,i){E(e,i[2*t],i[2*t+1])}function M(e,t){var i=0;do{i|=1&e,e>>>=1,i<<=1}while(--t>0);return i>>>1}function x(e,t,i){var s,n,r=new Array(16),a=0;for(s=1;s<=l;s++)r[s]=a=a+i[s-1]<<1;for(n=0;n<=t;n++){var o=e[2*n+1];0!==o&&(e[2*n]=M(r[o]++,o))}}function T(e){var t;for(t=0;t<a;t++)e.dyn_ltree[2*t]=0;for(t=0;t<o;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function P(e){e.bi_valid>8?B(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function k(e,t,i,s){var n=2*t,r=2*i;return e[n]<e[r]||e[n]===e[r]&&s[t]<=s[i]}function D(e,t,i){for(var s=e.heap[i],n=i<<1;n<=e.heap_len&&(n<e.heap_len&&k(t,e.heap[n+1],e.heap[n],e.depth)&&n++,!k(t,s,e.heap[n],e.depth));)e.heap[i]=e.heap[n],i=n,n<<=1;e.heap[i]=s}function F(e,t,i){var s,n,a,o,l=0;if(0!==e.last_lit)do{s=e.pending_buf[e.d_buf+2*l]<<8|e.pending_buf[e.d_buf+2*l+1],n=e.pending_buf[e.l_buf+l],l++,0===s?S(e,n,t):(S(e,(a=m[n])+r+1,t),0!==(o=h[a])&&E(e,n-=_[a],o),S(e,a=v(--s),i),0!==(o=c[a])&&E(e,s-=w[a],o))}while(l<e.last_lit);S(e,256,t)}function Q(e,t){var i,s,n,r=t.dyn_tree,a=t.stat_desc.static_tree,o=t.stat_desc.has_stree,h=t.stat_desc.elems,c=-1;for(e.heap_len=0,e.heap_max=573,i=0;i<h;i++)0!==r[2*i]?(e.heap[++e.heap_len]=c=i,e.depth[i]=0):r[2*i+1]=0;for(;e.heap_len<2;)r[2*(n=e.heap[++e.heap_len]=c<2?++c:0)]=1,e.depth[n]=0,e.opt_len--,o&&(e.static_len-=a[2*n+1]);for(t.max_code=c,i=e.heap_len>>1;i>=1;i--)D(e,r,i);n=h;do{i=e.heap[1],e.heap[1]=e.heap[e.heap_len--],D(e,r,1),s=e.heap[1],e.heap[--e.heap_max]=i,e.heap[--e.heap_max]=s,r[2*n]=r[2*i]+r[2*s],e.depth[n]=(e.depth[i]>=e.depth[s]?e.depth[i]:e.depth[s])+1,r[2*i+1]=r[2*s+1]=n,e.heap[1]=n++,D(e,r,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var i,s,n,r,a,o,h=t.dyn_tree,c=t.max_code,d=t.stat_desc.static_tree,A=t.stat_desc.has_stree,u=t.stat_desc.extra_bits,p=t.stat_desc.extra_base,g=t.stat_desc.max_length,m=0;for(r=0;r<=l;r++)e.bl_count[r]=0;for(h[2*e.heap[e.heap_max]+1]=0,i=e.heap_max+1;i<573;i++)(r=h[2*h[2*(s=e.heap[i])+1]+1]+1)>g&&(r=g,m++),h[2*s+1]=r,s>c||(e.bl_count[r]++,a=0,s>=p&&(a=u[s-p]),o=h[2*s],e.opt_len+=o*(r+a),A&&(e.static_len+=o*(d[2*s+1]+a)));if(0!==m){do{for(r=g-1;0===e.bl_count[r];)r--;e.bl_count[r]--,e.bl_count[r+1]+=2,e.bl_count[g]--,m-=2}while(m>0);for(r=g;0!==r;r--)for(s=e.bl_count[r];0!==s;)(n=e.heap[--i])>c||(h[2*n+1]!==r&&(e.opt_len+=(r-h[2*n+1])*h[2*n],h[2*n+1]=r),s--)}}(e,t),x(r,c,e.bl_count)}function R(e,t,i){var s,n,r=-1,a=t[1],o=0,l=7,h=4;for(0===a&&(l=138,h=3),t[2*(i+1)+1]=65535,s=0;s<=i;s++)n=a,a=t[2*(s+1)+1],++o<l&&n===a||(o<h?e.bl_tree[2*n]+=o:0!==n?(n!==r&&e.bl_tree[2*n]++,e.bl_tree[32]++):o<=10?e.bl_tree[34]++:e.bl_tree[36]++,o=0,r=n,0===a?(l=138,h=3):n===a?(l=6,h=3):(l=7,h=4))}function O(e,t,i){var s,n,r=-1,a=t[1],o=0,l=7,h=4;for(0===a&&(l=138,h=3),s=0;s<=i;s++)if(n=a,a=t[2*(s+1)+1],!(++o<l&&n===a)){if(o<h)do{S(e,n,e.bl_tree)}while(0!=--o);else 0!==n?(n!==r&&(S(e,n,e.bl_tree),o--),S(e,16,e.bl_tree),E(e,o-3,2)):o<=10?(S(e,17,e.bl_tree),E(e,o-3,3)):(S(e,18,e.bl_tree),E(e,o-11,7));o=0,r=n,0===a?(l=138,h=3):n===a?(l=6,h=3):(l=7,h=4)}}n(w);var L=!1;function N(e,t,i,n){E(e,0+(n?1:0),3),function(e,t,i,n){P(e),n&&(B(e,i),B(e,~i)),s.arraySet(e.pending_buf,e.window,t,i,e.pending),e.pending+=i}(e,t,i,!0)}i._tr_init=function(e){L||(!function(){var e,t,i,s,n,r=new Array(16);for(i=0,s=0;s<28;s++)for(_[s]=i,e=0;e<1<<h[s];e++)m[i++]=s;for(m[i-1]=s,n=0,s=0;s<16;s++)for(w[s]=n,e=0;e<1<<c[s];e++)g[n++]=s;for(n>>=7;s<o;s++)for(w[s]=n<<7,e=0;e<1<<c[s]-7;e++)g[256+n++]=s;for(t=0;t<=l;t++)r[t]=0;for(e=0;e<=143;)u[2*e+1]=8,e++,r[8]++;for(;e<=255;)u[2*e+1]=9,e++,r[9]++;for(;e<=279;)u[2*e+1]=7,e++,r[7]++;for(;e<=287;)u[2*e+1]=8,e++,r[8]++;for(x(u,287,r),e=0;e<o;e++)p[2*e+1]=5,p[2*e]=M(e,5);f=new C(u,h,257,a,l),b=new C(p,c,0,o,l),I=new C(new Array(0),d,0,19,7)}(),L=!0),e.l_desc=new y(e.dyn_ltree,f),e.d_desc=new y(e.dyn_dtree,b),e.bl_desc=new y(e.bl_tree,I),e.bi_buf=0,e.bi_valid=0,T(e)},i._tr_stored_block=N,i._tr_flush_block=function(e,t,i,s){var n,a,o=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,i=4093624447;for(t=0;t<=31;t++,i>>>=1)if(1&i&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<r;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),Q(e,e.l_desc),Q(e,e.d_desc),o=function(e){var t;for(R(e,e.dyn_ltree,e.l_desc.max_code),R(e,e.dyn_dtree,e.d_desc.max_code),Q(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*A[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),n=e.opt_len+3+7>>>3,(a=e.static_len+3+7>>>3)<=n&&(n=a)):n=a=i+5,i+4<=n&&-1!==t?N(e,t,i,s):4===e.strategy||a===n?(E(e,2+(s?1:0),3),F(e,u,p)):(E(e,4+(s?1:0),3),function(e,t,i,s){var n;for(E(e,t-257,5),E(e,i-1,5),E(e,s-4,4),n=0;n<s;n++)E(e,e.bl_tree[2*A[n]+1],3);O(e,e.dyn_ltree,t-1),O(e,e.dyn_dtree,i-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,o+1),F(e,e.dyn_ltree,e.dyn_dtree)),T(e),s&&P(e)},i._tr_tally=function(e,t,i){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&i,e.last_lit++,0===t?e.dyn_ltree[2*i]++:(e.matches++,t--,e.dyn_ltree[2*(m[i]+r+1)]++,e.dyn_dtree[2*v(t)]++),e.last_lit===e.lit_bufsize-1},i._tr_align=function(e){E(e,2,3),S(e,256,u),function(e){16===e.bi_valid?(B(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},{"../utils/common":41}],53:[function(e,t,i){t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,t,i){t.exports="function"==typeof setImmediate?setImmediate:function(){var e=[].slice.apply(arguments);e.splice(1,0,0),setTimeout.apply(null,e)}},{}]},{},[10])(10)})),da=function(){return function e(t,i,s){function n(a,o){if(!i[a]){if(!t[a]){var l="function"==typeof require&&require;if(!o&&l)return l(a,!0);if(r)return r(a,!0);throw new Error("Cannot find module '"+a+"'")}var h=i[a]={exports:{}};t[a][0].call(h.exports,(function(e){var i=t[a][1][e];return n(i||e)}),h,h.exports,e,t,i,s)}return i[a].exports}for(var r="function"==typeof require&&require,a=0;a<s.length;a++)n(s[a]);return n}({1:[function(e,t,i){var s={};function n(){try{return new window.XMLHttpRequest}catch(e){}}s._getBinaryFromXHR=function(e){return e.response||e.responseText};var r="undefined"!=typeof window&&window.ActiveXObject?function(){return n()||function(){try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}()}:n;s.getBinaryContent=function(e,t){var i,n,a,o;t||(t={}),"function"==typeof t?(o=t,t={}):"function"==typeof t.callback&&(o=t.callback),o||"undefined"==typeof Promise?(n=function(e){o(null,e)},a=function(e){o(e,null)}):i=new Promise((function(e,t){n=e,a=t}));try{var l=r();l.open("GET",e,!0),"responseType"in l&&(l.responseType="arraybuffer"),l.overrideMimeType&&l.overrideMimeType("text/plain; charset=x-user-defined"),l.onreadystatechange=function(t){if(4===l.readyState)if(200===l.status||0===l.status)try{n(s._getBinaryFromXHR(l))}catch(e){a(new Error(e))}else a(new Error("Ajax error for "+e+" : "+this.status+" "+this.statusText))},t.progress&&(l.onprogress=function(i){t.progress({path:e,originalEvent:i,percent:i.loaded/i.total*100,loaded:i.loaded,total:i.total})}),l.send()}catch(e){a(new Error(e),null)}return i},t.exports=s},{}]},{},[1])(1)},"object"==typeof exports?module.exports=da():"function"==typeof define&&define.amd?define(da):"undefined"!=typeof window?window.JSZipUtils=da():"undefined"!=typeof global?global.JSZipUtils=da():"undefined"!=typeof self&&(self.JSZipUtils=da()),Aa=window,ua=function(){return function(e){var t={};function i(s){if(t[s])return t[s].exports;var n=t[s]={i:s,l:!1,exports:{}};return e[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=e,i.c=t,i.d=function(e,t,s){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(s,n,function(t){return e[t]}.bind(null,n));return s},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=0)}([function(e,t,i){i.r(t);var s,n=function(e,t){var i=t.x-e.x,s=t.y-e.y;return Math.sqrt(i*i+s*s)},r=function(e){return e*(Math.PI/180)},a=new Map,o=function(e){a.has(e)&&clearTimeout(a.get(e)),a.set(e,setTimeout(e,100))},l=function(e,t,i){for(var s,n=t.split(/[ ,]+/g),r=0;r<n.length;r+=1)s=n[r],e.addEventListener?e.addEventListener(s,i,!1):e.attachEvent&&e.attachEvent(s,i)},h=function(e,t,i){for(var s,n=t.split(/[ ,]+/g),r=0;r<n.length;r+=1)s=n[r],e.removeEventListener?e.removeEventListener(s,i):e.detachEvent&&e.detachEvent(s,i)},c=function(e){return e.preventDefault(),e.type.match(/^touch/)?e.changedTouches:e},d=function(){return{x:void 0!==window.pageXOffset?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,y:void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop}},A=function(e,t){t.top||t.right||t.bottom||t.left?(e.style.top=t.top,e.style.right=t.right,e.style.bottom=t.bottom,e.style.left=t.left):(e.style.left=t.x+"px",e.style.top=t.y+"px")},u=function(e,t,i){var s=p(e);for(var n in s)if(s.hasOwnProperty(n))if("string"==typeof t)s[n]=t+" "+i;else{for(var r="",a=0,o=t.length;a<o;a+=1)r+=t[a]+" "+i+", ";s[n]=r.slice(0,-2)}return s},p=function(e){var t={};return t[e]="",["webkit","Moz","o"].forEach((function(i){t[i+e.charAt(0).toUpperCase()+e.slice(1)]=""})),t},g=function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e},m=function(e,t){if(e.length)for(var i=0,s=e.length;i<s;i+=1)t(e[i]);else t(e)},_=!!("ontouchstart"in window),f=!!window.PointerEvent,b=!!window.MSPointerEvent,I={start:"mousedown",move:"mousemove",end:"mouseup"},w={};function C(){}f?s={start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"}:b?s={start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:_?(s={start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},w=I):s=I,C.prototype.on=function(e,t){var i,s=e.split(/[ ,]+/g);this._handlers_=this._handlers_||{};for(var n=0;n<s.length;n+=1)i=s[n],this._handlers_[i]=this._handlers_[i]||[],this._handlers_[i].push(t);return this},C.prototype.off=function(e,t){return this._handlers_=this._handlers_||{},void 0===e?this._handlers_={}:void 0===t?this._handlers_[e]=null:this._handlers_[e]&&this._handlers_[e].indexOf(t)>=0&&this._handlers_[e].splice(this._handlers_[e].indexOf(t),1),this},C.prototype.trigger=function(e,t){var i,s=this,n=e.split(/[ ,]+/g);s._handlers_=s._handlers_||{};for(var r=0;r<n.length;r+=1)i=n[r],s._handlers_[i]&&s._handlers_[i].length&&s._handlers_[i].forEach((function(e){e.call(s,{type:i,target:s},t)}))},C.prototype.config=function(e){this.options=this.defaults||{},e&&(this.options=function(e,t){var i={};for(var s in e)e.hasOwnProperty(s)&&t.hasOwnProperty(s)?i[s]=t[s]:e.hasOwnProperty(s)&&(i[s]=e[s]);return i}(this.options,e))},C.prototype.bindEvt=function(e,t){var i=this;return i._domHandlers_=i._domHandlers_||{},i._domHandlers_[t]=function(){"function"==typeof i["on"+t]?i["on"+t].apply(i,arguments):console.warn('[WARNING] : Missing "on'+t+'" handler.')},l(e,s[t],i._domHandlers_[t]),w[t]&&l(e,w[t],i._domHandlers_[t]),i},C.prototype.unbindEvt=function(e,t){return this._domHandlers_=this._domHandlers_||{},h(e,s[t],this._domHandlers_[t]),w[t]&&h(e,w[t],this._domHandlers_[t]),delete this._domHandlers_[t],this};var y=C;function v(e,t){return this.identifier=t.identifier,this.position=t.position,this.frontPosition=t.frontPosition,this.collection=e,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1,shape:"circle"},this.config(t),"dynamic"===this.options.mode&&(this.options.restOpacity=0),this.id=v.id,v.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}v.prototype=new y,v.constructor=v,v.id=0,v.prototype.buildEl=function(e){return this.ui={},this.options.dataOnly||(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front)),this},v.prototype.stylize=function(){if(this.options.dataOnly)return this;var e=this.options.fadeTime+"ms",t=function(e,t){var i=p("borderRadius");for(var s in i)i.hasOwnProperty(s)&&(i[s]="50%");return i}(),i=u("transition","opacity",e),s={};return s.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:999},s.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:this.options.color,opacity:".5"},s.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:this.options.color,opacity:".5"},g(s.el,i),"circle"===this.options.shape&&g(s.back,t),g(s.front,t),this.applyStyles(s),this},v.prototype.applyStyles=function(e){for(var t in this.ui)if(this.ui.hasOwnProperty(t))for(var i in e[t])this.ui[t].style[i]=e[t][i];return this},v.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)||this.options.zone.appendChild(this.ui.el),this},v.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)||this.options.zone.removeChild(this.ui.el),this},v.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()},v.prototype.show=function(e){var t=this;return t.options.dataOnly||(clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.addToDom(),t.restCallback(),setTimeout((function(){t.ui.el.style.opacity=1}),0),t.showTimeout=setTimeout((function(){t.trigger("shown",t.instance),"function"==typeof e&&e.call(this)}),t.options.fadeTime)),t},v.prototype.hide=function(e){var t=this;if(t.options.dataOnly)return t;if(t.ui.el.style.opacity=t.options.restOpacity,clearTimeout(t.removeTimeout),clearTimeout(t.showTimeout),clearTimeout(t.restTimeout),t.removeTimeout=setTimeout((function(){var i="dynamic"===t.options.mode?"none":"block";t.ui.el.style.display=i,"function"==typeof e&&e.call(t),t.trigger("hidden",t.instance)}),t.options.fadeTime),t.options.restJoystick){var i=t.options.restJoystick,s={};s.x=!0===i||!1!==i.x?0:t.instance.frontPosition.x,s.y=!0===i||!1!==i.y?0:t.instance.frontPosition.y,t.setPosition(e,s)}return t},v.prototype.setPosition=function(e,t){var i=this;i.frontPosition={x:t.x,y:t.y};var s=i.options.fadeTime+"ms",n={};n.front=u("transition",["top","left"],s);var r={front:{}};r.front={left:i.frontPosition.x+"px",top:i.frontPosition.y+"px"},i.applyStyles(n),i.applyStyles(r),i.restTimeout=setTimeout((function(){"function"==typeof e&&e.call(i),i.restCallback()}),i.options.fadeTime)},v.prototype.restCallback=function(){var e={};e.front=u("transition","none",""),this.applyStyles(e),this.trigger("rested",this.instance)},v.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}},v.prototype.computeDirection=function(e){var t,i,s,n=e.angle.radian,r=Math.PI/4,a=Math.PI/2;if(n>r&&n<3*r&&!e.lockX?t="up":n>-r&&n<=r&&!e.lockY?t="left":n>3*-r&&n<=-r&&!e.lockX?t="down":e.lockY||(t="right"),e.lockY||(i=n>-a&&n<a?"left":"right"),e.lockX||(s=n>0?"up":"down"),e.force>this.options.threshold){var o,l={};for(o in this.direction)this.direction.hasOwnProperty(o)&&(l[o]=this.direction[o]);var h={};for(o in this.direction={x:i,y:s,angle:t},e.direction=this.direction,l)l[o]===this.direction[o]&&(h[o]=!0);if(h.x&&h.y&&h.angle)return e;h.x&&h.y||this.trigger("plain",e),h.x||this.trigger("plain:"+i,e),h.y||this.trigger("plain:"+s,e),h.angle||this.trigger("dir dir:"+t,e)}else this.resetDirection();return e};var B=v;function E(e,t){this.nipples=[],this.idles=[],this.actives=[],this.ids=[],this.pressureIntervals={},this.manager=e,this.id=E.id,E.id+=1,this.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,lockX:!1,lockY:!1,shape:"circle",dynamicPage:!1,follow:!1},this.config(t),"static"!==this.options.mode&&"semi"!==this.options.mode||(this.options.multitouch=!1),this.options.multitouch||(this.options.maxNumberOfNipples=1);var i=getComputedStyle(this.options.zone.parentElement);return i&&"flex"===i.display&&(this.parentIsFlex=!0),this.updateBox(),this.prepareNipples(),this.bindings(),this.begin(),this.nipples}E.prototype=new y,E.constructor=E,E.id=0,E.prototype.prepareNipples=function(){var e=this.nipples;e.on=this.on.bind(this),e.off=this.off.bind(this),e.options=this.options,e.destroy=this.destroy.bind(this),e.ids=this.ids,e.id=this.id,e.processOnMove=this.processOnMove.bind(this),e.processOnEnd=this.processOnEnd.bind(this),e.get=function(t){if(void 0===t)return e[0];for(var i=0,s=e.length;i<s;i+=1)if(e[i].identifier===t)return e[i];return!1}},E.prototype.bindings=function(){this.bindEvt(this.options.zone,"start"),this.options.zone.style.touchAction="none",this.options.zone.style.msTouchAction="none"},E.prototype.begin=function(){var e=this.options;if("static"===e.mode){var t=this.createNipple(e.position,this.manager.getIdentifier());t.add(),this.idles.push(t)}},E.prototype.createNipple=function(e,t){var i=this.manager.scroll,s={},n=this.options,r=this.parentIsFlex?i.x:i.x+this.box.left,a=this.parentIsFlex?i.y:i.y+this.box.top;if(e.x&&e.y)s={x:e.x-r,y:e.y-a};else if(e.top||e.right||e.bottom||e.left){var o=document.createElement("DIV");o.style.display="hidden",o.style.top=e.top,o.style.right=e.right,o.style.bottom=e.bottom,o.style.left=e.left,o.style.position="absolute",n.zone.appendChild(o);var l=o.getBoundingClientRect();n.zone.removeChild(o),s=e,e={x:l.left+i.x,y:l.top+i.y}}var h=new B(this,{color:n.color,size:n.size,threshold:n.threshold,fadeTime:n.fadeTime,dataOnly:n.dataOnly,restJoystick:n.restJoystick,restOpacity:n.restOpacity,mode:n.mode,identifier:t,position:e,zone:n.zone,frontPosition:{x:0,y:0},shape:n.shape});return n.dataOnly||(A(h.ui.el,s),A(h.ui.front,h.frontPosition)),this.nipples.push(h),this.trigger("added "+h.identifier+":added",h),this.manager.trigger("added "+h.identifier+":added",h),this.bindNipple(h),h},E.prototype.updateBox=function(){this.box=this.options.zone.getBoundingClientRect()},E.prototype.bindNipple=function(e){var t,i=this,s=function(e,s){t=e.type+" "+s.id+":"+e.type,i.trigger(t,s)};e.on("destroyed",i.onDestroyed.bind(i)),e.on("shown hidden rested dir plain",s),e.on("dir:up dir:right dir:down dir:left",s),e.on("plain:up plain:right plain:down plain:left",s)},E.prototype.pressureFn=function(e,t,i){var s=this,n=0;clearInterval(s.pressureIntervals[i]),s.pressureIntervals[i]=setInterval(function(){var i=e.force||e.pressure||e.webkitForce||0;i!==n&&(t.trigger("pressure",i),s.trigger("pressure "+t.identifier+":pressure",i),n=i)}.bind(s),100)},E.prototype.onstart=function(e){var t=this,i=t.options,s=e;return e=c(e),t.updateBox(),m(e,(function(n){t.actives.length<i.maxNumberOfNipples?t.processOnStart(n):s.type.match(/^touch/)&&(Object.keys(t.manager.ids).forEach((function(i){if(Object.values(s.touches).findIndex((function(e){return e.identifier===i}))<0){var n=[e[0]];n.identifier=i,t.processOnEnd(n)}})),t.actives.length<i.maxNumberOfNipples&&t.processOnStart(n))})),t.manager.bindDocument(),!1},E.prototype.processOnStart=function(e){var t,i=this,s=i.options,r=i.manager.getIdentifier(e),a=e.force||e.pressure||e.webkitForce||0,o={x:e.pageX,y:e.pageY},l=i.getOrCreate(r,o);l.identifier!==r&&i.manager.removeIdentifier(l.identifier),l.identifier=r;var h=function(t){t.trigger("start",t),i.trigger("start "+t.id+":start",t),t.show(),a>0&&i.pressureFn(e,t,t.identifier),i.processOnMove(e)};if((t=i.idles.indexOf(l))>=0&&i.idles.splice(t,1),i.actives.push(l),i.ids.push(l.identifier),"semi"!==s.mode)h(l);else{if(!(n(o,l.position)<=s.catchDistance))return l.destroy(),void i.processOnStart(e);h(l)}return l},E.prototype.getOrCreate=function(e,t){var i,s=this.options;return/(semi|static)/.test(s.mode)?(i=this.idles[0])?(this.idles.splice(0,1),i):"semi"===s.mode?this.createNipple(t,e):(console.warn("Coudln't find the needed nipple."),!1):i=this.createNipple(t,e)},E.prototype.processOnMove=function(e){var t=this.options,i=this.manager.getIdentifier(e),s=this.nipples.get(i),a=this.manager.scroll;if(function(e){return isNaN(e.buttons)?0!==e.pressure:0!==e.buttons}(e)){if(!s)return console.error("Found zombie joystick with ID "+i),void this.manager.removeIdentifier(i);if(t.dynamicPage){var o=s.el.getBoundingClientRect();s.position={x:a.x+o.left,y:a.y+o.top}}s.identifier=i;var l=s.options.size/2,h={x:e.pageX,y:e.pageY};t.lockX&&(h.y=s.position.y),t.lockY&&(h.x=s.position.x);var c,d,u,p,g,m,_,f,b,I,w=n(h,s.position),C=(c=h,u=(d=s.position).x-c.x,p=d.y-c.y,function(e){return e*(180/Math.PI)}(Math.atan2(p,u))),y=r(C),v=w/l,B={distance:w,position:h};if("circle"===s.options.shape?(g=Math.min(w,l),_=s.position,f=g,I={x:0,y:0},b=r(b=C),I.x=_.x-f*Math.cos(b),I.y=_.y-f*Math.sin(b),m=I):(m=function(e,t,i){return{x:Math.min(Math.max(e.x,t.x-i),t.x+i),y:Math.min(Math.max(e.y,t.y-i),t.y+i)}}(h,s.position,l),g=n(m,s.position)),t.follow){if(w>l){var E=h.x-m.x,S=h.y-m.y;s.position.x+=E,s.position.y+=S,s.el.style.top=s.position.y-(this.box.top+a.y)+"px",s.el.style.left=s.position.x-(this.box.left+a.x)+"px",w=n(h,s.position)}}else h=m,w=g;var M=h.x-s.position.x,x=h.y-s.position.y;s.frontPosition={x:M,y:x},t.dataOnly||A(s.ui.front,s.frontPosition);var T={identifier:s.identifier,position:h,force:v,pressure:e.force||e.pressure||e.webkitForce||0,distance:w,angle:{radian:y,degree:C},vector:{x:M/l,y:-x/l},raw:B,instance:s,lockX:t.lockX,lockY:t.lockY};(T=s.computeDirection(T)).angle={radian:r(180-C),degree:180-C},s.trigger("move",T),this.trigger("move "+s.id+":move",T)}else this.processOnEnd(e)},E.prototype.processOnEnd=function(e){var t=this,i=t.options,s=t.manager.getIdentifier(e),n=t.nipples.get(s),r=t.manager.removeIdentifier(n.identifier);n&&(i.dataOnly||n.hide((function(){"dynamic"===i.mode&&(n.trigger("removed",n),t.trigger("removed "+n.id+":removed",n),t.manager.trigger("removed "+n.id+":removed",n),n.destroy())})),clearInterval(t.pressureIntervals[n.identifier]),n.resetDirection(),n.trigger("end",n),t.trigger("end "+n.id+":end",n),t.ids.indexOf(n.identifier)>=0&&t.ids.splice(t.ids.indexOf(n.identifier),1),t.actives.indexOf(n)>=0&&t.actives.splice(t.actives.indexOf(n),1),/(semi|static)/.test(i.mode)?t.idles.push(n):t.nipples.indexOf(n)>=0&&t.nipples.splice(t.nipples.indexOf(n),1),t.manager.unbindDocument(),/(semi|static)/.test(i.mode)&&(t.manager.ids[r.id]=r.identifier))},E.prototype.onDestroyed=function(e,t){this.nipples.indexOf(t)>=0&&this.nipples.splice(this.nipples.indexOf(t),1),this.actives.indexOf(t)>=0&&this.actives.splice(this.actives.indexOf(t),1),this.idles.indexOf(t)>=0&&this.idles.splice(this.idles.indexOf(t),1),this.ids.indexOf(t.identifier)>=0&&this.ids.splice(this.ids.indexOf(t.identifier),1),this.manager.removeIdentifier(t.identifier),this.manager.unbindDocument()},E.prototype.destroy=function(){for(var e in this.unbindEvt(this.options.zone,"start"),this.nipples.forEach((function(e){e.destroy()})),this.pressureIntervals)this.pressureIntervals.hasOwnProperty(e)&&clearInterval(this.pressureIntervals[e]);this.trigger("destroyed",this.nipples),this.manager.unbindDocument(),this.off()};var S=E;function M(e){var t=this;t.ids={},t.index=0,t.collections=[],t.scroll=d(),t.config(e),t.prepareCollections();var i=function(){var e;t.collections.forEach((function(i){i.forEach((function(i){e=i.el.getBoundingClientRect(),i.position={x:t.scroll.x+e.left,y:t.scroll.y+e.top}}))}))};l(window,"resize",(function(){o(i)}));var s=function(){t.scroll=d()};return l(window,"scroll",(function(){o(s)})),t.collections}M.prototype=new y,M.constructor=M,M.prototype.prepareCollections=function(){var e=this;e.collections.create=e.create.bind(e),e.collections.on=e.on.bind(e),e.collections.off=e.off.bind(e),e.collections.destroy=e.destroy.bind(e),e.collections.get=function(t){var i;return e.collections.every((function(e){return!(i=e.get(t))})),i}},M.prototype.create=function(e){return this.createCollection(e)},M.prototype.createCollection=function(e){var t=new S(this,e);return this.bindCollection(t),this.collections.push(t),t},M.prototype.bindCollection=function(e){var t,i=this,s=function(e,s){t=e.type+" "+s.id+":"+e.type,i.trigger(t,s)};e.on("destroyed",i.onDestroyed.bind(i)),e.on("shown hidden rested dir plain",s),e.on("dir:up dir:right dir:down dir:left",s),e.on("plain:up plain:right plain:down plain:left",s)},M.prototype.bindDocument=function(){this.binded||(this.bindEvt(document,"move").bindEvt(document,"end"),this.binded=!0)},M.prototype.unbindDocument=function(e){Object.keys(this.ids).length&&!0!==e||(this.unbindEvt(document,"move").unbindEvt(document,"end"),this.binded=!1)},M.prototype.getIdentifier=function(e){var t;return e?void 0===(t=void 0===e.identifier?e.pointerId:e.identifier)&&(t=this.latest||0):t=this.index,void 0===this.ids[t]&&(this.ids[t]=this.index,this.index+=1),this.latest=t,this.ids[t]},M.prototype.removeIdentifier=function(e){var t={};for(var i in this.ids)if(this.ids[i]===e){t.id=i,t.identifier=this.ids[i],delete this.ids[i];break}return t},M.prototype.onmove=function(e){return this.onAny("move",e),!1},M.prototype.onend=function(e){return this.onAny("end",e),!1},M.prototype.oncancel=function(e){return this.onAny("end",e),!1},M.prototype.onAny=function(e,t){var i,s=this,n="processOn"+e.charAt(0).toUpperCase()+e.slice(1);return t=c(t),m(t,(function(e){i=s.getIdentifier(e),m(s.collections,function(e,t,i){i.ids.indexOf(t)>=0&&(i[n](e),e._found_=!0)}.bind(null,e,i)),e._found_||s.removeIdentifier(i)})),!1},M.prototype.destroy=function(){this.unbindDocument(!0),this.ids={},this.index=0,this.collections.forEach((function(e){e.destroy()})),this.off()},M.prototype.onDestroyed=function(e,t){if(this.collections.indexOf(t)<0)return!1;this.collections.splice(this.collections.indexOf(t),1)};var x=new M;t.default={create:function(e){return x.create(e)},factory:x}}]).default},"object"==typeof exports&&"object"==typeof module?module.exports=ua():"function"==typeof define&&define.amd?define("nipplejs",[],ua):"object"==typeof exports?exports.nipplejs=ua():Aa.nipplejs=ua(),Be.deviceType="MOBILE",Be.isChrome=-1!==navigator.userAgent.indexOf("Chrome");const Ia="0.0.4";function wa(){return Be.deviceType}function Ca(){Be.disableImmersion=!0}export{Ii as LibraryHandler,Gn as ProjectHandler,Ca as disableImmersion,wa as getDeviceType,ba as setup,fa as setupEditor,Ia as version};
