/*
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */
import*as t from"three";import{TrianglesDrawMode as i,TriangleFanDrawMode as r,TriangleStripDrawMode as d,Quaternion as A,Matrix4 as g,Loader as b,LoaderUtils as I,FileLoader as w,Color as C,SpotLight as B,PointLight as S,DirectionalLight as T,MeshBasicMaterial as x,sRGBEncoding as M,MeshPhysicalMaterial as P,Vector2 as D,Vector3 as Q,InstancedMesh as F,Object3D as R,TextureLoader as L,ImageBitmapLoader as O,BufferAttribute as U,InterleavedBuffer as N,InterleavedBufferAttribute as H,LinearFilter as G,LinearMipmapLinearFilter as j,RepeatWrapping as V,PointsMaterial as Y,Material as W,LineBasicMaterial as X,MeshStandardMaterial as K,DoubleSide as Z,PropertyBinding as q,BufferGeometry as J,SkinnedMesh as ee,Mesh as te,LineSegments as ie,Line as se,LineLoop as ne,Points as re,Group as ae,PerspectiveCamera as oe,MathUtils as le,OrthographicCamera as he,Skeleton as de,InterpolateLinear as ce,AnimationClip as Ae,Bone as ue,NearestFilter as pe,NearestMipmapNearestFilter as ge,LinearMipmapNearestFilter as me,NearestMipmapLinearFilter as _e,ClampToEdgeWrapping as fe,MirroredRepeatWrapping as be,InterpolateDiscrete as Ie,FrontSide as we,Texture as ye,VectorKeyframeTrack as Ce,QuaternionKeyframeTrack as Be,NumberKeyframeTrack as ve,Box3 as Ee,Sphere as Se,Interpolant as Te,SphereGeometry as xe,CubeTexture as Me,EventDispatcher as Pe,MOUSE as ke,TOUCH as De,Spherical as Qe,Raycaster as Fe,Euler as Re,CylinderGeometry as Le,BoxGeometry as Oe,Float32BufferAttribute as Ue,OctahedronGeometry as Ne,TorusGeometry as He,PlaneGeometry as Ge}from"three";import je from"three-mesh-ui";let ze={};ze.loadingLocks=new Set;const Ve={MODEL:"MODEL",IMAGE:"IMAGE",SHAPE:"SHAPE",LIGHT:"LIGHT",MATERIAL:"MATERIAL",TEXTURE:"TEXTURE"},Ye={jpg:"jpg",jpeg:"jpeg",png:"png"},We="ASSET_ADDED",Xe="AVATAR_UPDATED",Ke="BECOME_PARTY_HOST",Ze="BOOT_PEER",qe="HAND_TOOLS_SWITCH",Je="INSTANCE_ADDED",$e="INSTANCE_DELETED",et="INSTANCE_UPDATED",tt="INSTANCE_ATTACHED",it="INSTANCE_DETACHED",st="MATERIAL_ADDED",nt="MATERIAL_DELETED",rt="MATERIAL_UPDATED",at="MENU_FIELD_FOCUSED",ot="MENU_NOTIFICATION",lt="MENU_PAGE_CHANGED",ht="PARTY_ENDED",dt="PARTY_STARTED",ct="PEER_CONNECTED",At="PEER_DISCONNECTED",ut="PEER_USERNAME_UPDATED",pt="PROJECT_LOADING",gt="PROJECT_SAVING",mt="SETTINGS_UPDATED",_t="TEXTURE_ADDED",ft="TEXTURE_DELETED",bt="TEXTURE_UPDATED",It="USER_SCALE_UPDATED";let wt=new class{constructor(){this._topics={},this._toPublish=[]}subscribe(t,i,r){i in this._topics||(this._topics[i]={}),this._topics[i][t]=r}unsubscribe(t,i){i in this._topics&&(delete this._topics[i][t],0==Object.keys(this._topics[i]).length&&delete this._topics[i])}publish(t,i,r,d){let A=this._splitTopic(i);for(let i of A)!i in this._topics||(d?this._publish(t,i,r):this._toPublish.push((()=>{this._publish(t,i,r)})))}_splitTopic(t){let i=t.split(":"),r=i[0],d=[r];for(let t=1;t<i.length;t++)r+=":"+i[t],d.push(r);return d}_publish(t,i,r){let d=this._topics[i];for(let i in d)i!=t&&d[i](r)}update(){for(let t of this._toPublish)t();this._toPublish=[]}};const uuidv4=()=>([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(t=>(t^crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16))),numberOr=(t,i)=>"number"==typeof t?t:i,compareLists=(t,i)=>t.length==i.length&&t.reduce(((t,r,d)=>t&&i[d]==r),!0),stringWithMaxLength=(t,i)=>t.length>i?t.substring(0,i)+"...":t,capitalizeFirstLetter=t=>t.charAt(0).toUpperCase()+t.slice(1),fullDispose=(i,r)=>{i.traverse((i=>{(i instanceof t.Mesh||i instanceof t.Line)&&(i.geometry&&i.geometry.dispose(),i.material&&(Array.isArray(i.material)?i.material.forEach((t=>{disposeMaterial(t,r)})):disposeMaterial(i.material,r)))}))},disposeMaterial=(t,i)=>{i&&(t.alphaMap&&t.alphaMap.dispose(),t.aoMap&&t.aoMap.dispose(),t.bumpMap&&t.bumpMap.dispose(),t.displacementMap&&t.displacementMap.dispose(),t.emissiveMap&&t.emissiveMap.dispose(),t.envMap&&t.envMap.dispose(),t.gradientMap&&t.gradientMap.dispose(),t.lightMap&&t.lightMap.dispose(),t.map&&t.map.dispose(),t.metalnessMap&&t.metalnessMap.dispose(),t.normalMap&&t.normalMap.dispose(),t.roughnessMap&&t.roughnessMap.dispose(),t.specularMap&&t.specularMap.dispose()),t.dispose()},roundWithPrecision=(t,i)=>Number(t.toFixed(i));t.Vector3.prototype.roundWithPrecision=function(t){let i=t||9,r=[this.x,this.y,this.z];return this.setX(roundWithPrecision(this.x,i)),this.setY(roundWithPrecision(this.y,i)),this.setZ(roundWithPrecision(this.z,i)),this.x!=r[0]||this.y!=r[1]||this.z!=r[2]},t.Euler.prototype.roundWithPrecision=function(t){let i=t||9,r=[this.x,this.y,this.z];return this.set(roundWithPrecision(this.x,i),roundWithPrecision(this.y,i),roundWithPrecision(this.z,i)),this.x!=r[0]||this.y!=r[1]||this.z!=r[2]},t.Cache.enabled=!0;const cartesianToPolar=(t,i)=>[Math.sqrt(t*t+i*i),Math.atan2(i,t)],radiansToDegrees=t=>(t+Math.PI)/(2*Math.PI)*360;function hueToRGB(t,i,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+6*(i-t)*r:r<.5?i:r<2/3?t+(i-t)*(2/3-r)*6:t}const hslToRGB=(t,i,r)=>{let d,A,g;if(t/=360,0==i)d=A=g=r;else{let b=r<.5?r*(1+i):r+i-r*i,I=2*r-b;d=hueToRGB(I,b,t+1/3),A=hueToRGB(I,b,t),g=hueToRGB(I,b,t-1/3)}return[Math.round(255*d),Math.round(255*A),Math.round(255*g)]},rgbToHex=(t,i,r)=>t<<16^i<<8^r<<0,blobToHash=t=>new Promise(((i,r)=>{t.arrayBuffer().then((t=>{crypto.subtle.digest("SHA-256",t).then((t=>{let r=Array.from(new Uint8Array(t)).map((t=>t.toString(16).padStart(2,"0"))).join("");i(r)}))}))})),concatenateArrayBuffers=t=>{let i=0;for(let r of t)i+=r.byteLength;let r=new Uint8Array(i),d=0;for(let i of t)r.set(new Uint8Array(i),d),d+=i.byteLength;return r.buffer};class Queue{constructor(){this.items={},this.headIndex=0,this.tailIndex=0,this.length=0}enqueue(t){this.items[this.tailIndex]=t,this.tailIndex++,this.length++}dequeue(){const t=this.items[this.headIndex];return delete this.items[this.headIndex],this.headIndex++,this.length--,t}peek(){return this.items[this.headIndex]}}let yt=["audio","checkmark","ellipsis","hamburger","headphones","image","lightbulb","material","microphone","object","pencil","search","shapes","texture","trash","undo","redo","video"],Ct={},Bt=uuidv4();ze.loadingLocks.add(Bt);for(let t of yt)Ct[t]=uuidv4(),ze.loadingLocks.add(Ct[t]);const vt={audioIcon:(new t.TextureLoader).load("data:image/png;base64,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",(function(t){ze.loadingLocks.delete(Ct.audio)})),checkmarkIcon:(new t.TextureLoader).load("data:image/png;base64,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",(function(t){ze.loadingLocks.delete(Ct.checkmark)})),ellipsisIcon:(new t.TextureLoader).load("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAAAAXNSR0IArs4c6QAACTtJREFUeF7t3NFuG0cQRFHr/z9agZAoMQw7FFs73Jmq41erCdSt7qslZevthz8IIFBL4K02ueAIIPCDACwBAsUECKC4fNERIAA7gEAxAQIoLl90BAjADiBQTIAAissXHQECsAMIFBMggOLyRUeAAOwAAsUECKC4fNERIAA7gEAxAQIoLl90BAjADiBQTIAAissXHQECsAMIFBMggOLyRUeAAOwAAsUECKC4fNERIAA7gEAxAQIoLl90BAjADiBQTIAAissXHQECsAMIFBMggOLyRUeAAOwAAsUECKC4fNERIAA7gEAxAQIoLl90BAjADiBQTIAAissXHQECsAMIFBMggOLyRUeAAOwAAsUECKC4fNERIAA7gEAxAQIoLl90BAjADiBQTIAAissXHQECsAMIFBMggOLyRUeAAOwAAsUECKC4fNERIAA7gEAxAQIoLl90BAjADiBQTIAAissXHQECsAMIFBMggOLyRUeAAOwAAsUECKC4fNERIAA7gEAxAQIoLl90BAjADiBQTIAAissXHQECsAMIFBMggOLyRUeAAOwAAsUECKC4fNERIAA7gEAxAQIoLl90BAjADiBQTIAAissXHQECsAMIFBMggOLyRUeAAOwAAsUECKC4fNERIAA7gEAxAQIoLl90BAjADiBQTIAAissXHQECsAMIFBMggOLyRUeAAOwAAsUECKC4fNERIAA7gEAxAQIoLl90BAjADiBQTIAAissXHQECsAMIFBMggOLyRUeAAOwAAsUECKC4fNERIAA7gEAxAQIoLl90BAjADiBQTIAAissXHQECsAMIFBMggOLyRUeAAOwAAsUECKC4fNERIAA7gEAxAQIoLl90BAjADiBQTIAAissXHQECsAMIFBMggOLyRUeAAOwAAsUECKC4fNERIAA7gEAxAQIoLl90BAjADiBQTIAAissXHQECsAMIFBMggOLyRUegRgDv7+/vz9T99vYWxUb+7v7/tPtRS/67kM8u/q+vcboI5H/u8NP6f/RNL1IA3136P9rykKcC+b939Kf3/+jof/77OAGsWv5PaLs/Eci/5vhP6f+Z4//42hgBrF783R8N5V97+Lv3/+zh/yu06eBOc69e/t2+G8j/2uPfrf/v3OLxTwB3Lf8uSyD/Pce/S//fOf7j3wLcvfx3L4H89x7/3f1/9/iPFsAuy3/XEsi/x/Hf1f8Vx08AV1H8+DT1xT8iJAACuGJ9j/wMYLflf/V3Afn3Ov5X93/F4R/7U4Bdl/9VSyD/nsf/qv6vPP4j3wI4gO4DaO+fAJ78Tz1XA3v0eqs/C2g/gPb8j/bv2b8/6jOA3ctf/Rgo/95PP6v7f/a4v/L1BPAVSk9+zaqnAAIggCdX8eGXHyOAU5Z/1XcB+c84/lX9P7zk4RcQwBDco7GrnwIIgAAe7dzk7wlgQu0LMwRw7W9UahfgF1Zu9CUEMML2eIgACODxltz/FQSwqAMCIIBFq3XpyxLApTj/ezECIIBFq3XpyxLApTgJYNWn4D4DWLOoBLCG6+X/O7D9ANrzL1rTc34nYPsCyO/HgCsk4AlgBdUFvx+AAAhgxaoSwAqqBOAt0It/Qcx0jQlgSu7BnJ8C+CnAotW69GWPEcBH6lMeg68+/s/G5T/jbcCq/i+9/H9ejAAWUF21AARAAFev61ECOOEpYNXxn/IUIP+1b32uPvhfX48ALibsANYewO5PQav7v3hdz/l3AL4D/k2g/QDa89cLYOcjeJX9dz0C+dc+/Vx9/B+vd9xbgF2fBF61/PLv+ST06v6vkgEBXETy1Quw21OA/Od99z/6CWCntwKvXv7dngLkP/P4jxfADhK4a/l3kYD85x5/hADulMDdy3+3BOQ/+/hjBHCHBHZZ/rskIP/5xx8lgFcdwm6L/+tnmKs/HJQ/4/A/9+bYnwL834f3q45g9+VfLUH5s44/8gng6u+Ipyz9n4T4XRnKn3f0P+9K5BPA747h2UM4ffG/K0L5sw8/+i3ARf+2x8sgEE+g5gkgvkkBERgQIIABNCMIpBAggJQm5UBgQIAABtCMIJBCgABSmpQDgQEBAhhAM4JACgECSGlSDgQGBAhgAM0IAikECCClSTkQGBAggAE0IwikECCAlCblQGBAgAAG0IwgkEKAAFKalAOBAQECGEAzgkAKAQJIaVIOBAYECGAAzQgCKQQIIKVJORAYECCAATQjCKQQIICUJuVAYECAAAbQjCCQQoAAUpqUA4EBAQIYQDOCQAoBAkhpUg4EBgQIYADNCAIpBAggpUk5EBgQIIABNCMIpBAggJQm5UBgQIAABtCMIJBCgABSmpQDgQEBAhhAM4JACgECSGlSDgQGBAhgAM0IAikECCClSTkQGBAggAE0IwikECCAlCblQGBAgAAG0IwgkEKAAFKalAOBAQECGEAzgkAKAQJIaVIOBAYECGAAzQgCKQQIIKVJORAYECCAATQjCKQQIICUJuVAYECAAAbQjCCQQoAAUpqUA4EBAQIYQDOCQAoBAkhpUg4EBgQIYADNCAIpBAggpUk5EBgQIIABNCMIpBAggJQm5UBgQIAABtCMIJBCgABSmpQDgQEBAhhAM4JACgECSGlSDgQGBAhgAM0IAikECCClSTkQGBAggAE0IwikECCAlCblQGBAgAAG0IwgkEKAAFKalAOBAQECGEAzgkAKAQJIaVIOBAYECGAAzQgCKQQIIKVJORAYECCAATQjCKQQIICUJuVAYECAAAbQjCCQQoAAUpqUA4EBAQIYQDOCQAoBAkhpUg4EBgQIYADNCAIpBAggpUk5EBgQIIABNCMIpBAggJQm5UBgQIAABtCMIJBCgABSmpQDgQEBAhhAM4JACgECSGlSDgQGBAhgAM0IAikECCClSTkQGBAggAE0IwikECCAlCblQGBAgAAG0IwgkEKAAFKalAOBAQECGEAzgkAKAQJIaVIOBAYECGAAzQgCKQQIIKVJORAYECCAATQjCKQQIICUJuVAYECAAAbQjCCQQoAAUpqUA4EBAQIYQDOCQAoBAkhpUg4EBgQIYADNCAIpBAggpUk5EBgQIIABNCMIpBAggJQm5UBgQIAABtCMIJBCgABSmpQDgQEBAhhAM4JACgECSGlSDgQGBAhgAM0IAikECCClSTkQGBD4C9goER8tauZoAAAAAElFTkSuQmCC",(function(t){ze.loadingLocks.delete(Ct.ellipsis)})),hamburgerIcon:(new t.TextureLoader).load("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAQAAAAHUWYVAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA75o43NsAAAAHdElNRQflBwgBKRc7nqR1AAAAAW9yTlQBz6J3mgAAAQpJREFUeNrt3bEKgzAUQNFY/P8f7mBnoVMN9UbO2RN43jE8HAMAAAAAAAAAAAAAAAAAAAAAAACANW2T79uP990j/dc2+Qu+7h6IM0FiBIkRJEaQGEFiBIkRJEaQGEFiBIkRJEaQGEFiBIkRJEaQGEFiZgc57h4IAAAAAAAAACaZvRY9xv7zySvv8Sue/cqe+kX21B9OkBhBYgSJESRGkBhBYgSJESRGkBhBYgSJESRGkBhBYgSJESRGkBhBAAAAAAAAAIAl2FO/yJ76wwkSI0iMIDGCxAgSI0iMIDGCxAgSI0iMIDGCxAgSI0iMIDGCxAgS43/qAAAAAAAAAAAAAAAAAAAAAAAAADDFB0xaDHVXaSV/AAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIxLTA3LTA4VDAxOjQxOjIzKzAwOjAw09nK7wAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMS0wNy0wOFQwMTo0MToyMyswMDowMKKEclMAAAAASUVORK5CYII=",(function(t){ze.loadingLocks.delete(Ct.hamburger)})),headphonesIcon:(new t.TextureLoader).load("data:image/png;base64,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",(function(t){ze.loadingLocks.delete(Ct.headphones)})),imageIcon:(new t.TextureLoader).load("data:image/png;base64,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",(function(t){ze.loadingLocks.delete(Ct.image)})),lightbulbIcon:(new t.TextureLoader).load("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAAAAXNSR0IArs4c6QAAEwdJREFUeF7tneF6GykMRdv3f+jdz2mcJu6MkdAVCDj7NwKJo6trZpxmf//iv20I/Pfff/+NOMzv379/j8hDjnwCNDKfsTTDqCHvKRpj6KE2dw0GMJe/KXvloX93AAzB1N6pQRjAVPzXyVcdeMygoJgaJWEARXq249BjCEXE9aYMDGBij04b+jvUPCrMEyEGMIE9g38NHSMYL0YMYCBzBt8GGyOwcVJEYQAKim/2YOj7AWME/eysKzEAKylnHIPvBNZ6W80vH2mBfu6GAYixMvhioN+240agZ4sBCJky/EKY77664jYgA40BCFAy+AKIHVtwI+iA9rIEAwgwZPAD8IRLMYJ+mBhAJzuGvxNc0jJMoA8sBuDkxuA7gQ0MxwT8sDEAB7NVhj9rEE4/v0Mqy4RiAIZWVRV+1qAbkHyFwMZDq14sBtDoSTWBVxj6d8jgVW/I31WEAbyhU0HM1Qe+JXcYtgjN/TkGcMN/pnBXH/orpDN5PurZkanCOjCAC4qzxHqKSOGrGF3NHhjAC8cZ4jxl8F8lC2vNEEd2wQA+6SHGiIxia0ezP9Vwr7qEAfz69WukABHfvVmM7APvBf704XgDGCk6ht92U6AnNk6KqKMNYJTQGPw+qdKfPm6eVccaAOLyyGReLH3KZX+kAYwQFZ/6WuFm9+zUfmEAWp3+ebHCX6xJoJr/svbEvh1nAJmfJCsIKHL+CueL1G9xpQpntNSpijnKADLFs4Jw1OefeWb1Wb4P1MxzqQbbus8xBnC6YDLP/xTb6MHJPNPos1gHVh13hAGcLpTM898JctQAZZ5t1BnUQ+3Zb3sDQCD5L8/eCW7EENFjz8j/jN3aALKEMULU/S39uTKLgbe+bGZZ58yu28tRHY8BOImuJoiswXBi+wrP5pdx3uyae1kq1m1rAAjhjzwyOEiEl/i7Ehln3tUEtjQABPB3RDNYKAwg+5sD9bmPNYBXkCuAoPnrGECWEag18KhzRe23ar68AVjgtTZWfkp49rLU7tlvlca/O1MGEy9DS7xaUxnnVtdo4WKJsZz1qvZ/DMCy0feCKgHx1m4BW+l8lnqvYjK49NbSWqfmnXF2dY0tJkpzf639hwH0wqoCpLf+O8BVzhURyHOtmo2ipnd7KNmrz66sLcKx91zf65cYQIVrci+ME4YfE9B/GzLbBCJ6vzSAyIZZL3I87qiov8I5PGfuiVVy6snvXaMcNOXZlXV5mSjO8az/6wag2HTWTUBV+6z6vQJQxivZKevKes+kPO8ME1DVn2YAo4dIBeSET//eAVUz7qlDNWzKs6hqsvLIqF1+Axg9SBlQrA05MU7J28tPNXDKM6hqarFQ1vz9QzrNAEbcBJRQRjWy1eiVfq7kbz23qk/K2lU13TFQ1vr6AZ1qANkmoAST3USrwFeNU/aixUDRK2W9inpGDv+wG0D244CqiZkNbIl5t5+retLiouiZslZFPa9nVtb3uvc/LwEfASMSthpr/bmq1ozGWc+wc5yqP+8YKXqnqlNRy/ezquq64nf7i0CZJlAVkLqunYfae7ZMEatul6oa1TpS1XX3yf/Fb8a1wyukrBrVTYuea9f1WWJWvWNS1afSk6qe1qf/B7+roJEF9IheUZ+qWT31n7hG0bM7btFeqmqL1pF5A78zy9s/CKKC0rqCeIdBVZeiWd7aic97zxTtZxVdqeqwzt3bvwiUUcwujWKY+wlk6Cr6OKCqqYq+v3fnXU3NPwmmAqN4aaOqJdqkfumz8klA1Uur0C3kVTVF9KWqwTpvTQNQP5dUgBOpwSIkYmwE1GLf4RagZGLRuckAlCZgKepOPgo4kfw2WRPlIaDoabVbQERjKh7WGswGoDIBa2GvIhoNxiNiYmMEVL21XnvfVauqZabOPbldBhA1AU9hGQYQyR+TOKtbBFSDF30MiGp8tgl5Ne42gAggb3HfRaMQSCR/S8D8PE5A0ePZAzgzf4++uwygxwR6invCVAgjkj8ubXawEFD0eeYAvp4xojkvi95c3QbgGc7e4jw5WgKL1tDan59rCHiF/y5rpOeKOiL5rR+y0RxhA7gb0mhhXP81A7XiLorhi74LUNSQOQOqvWUGkCm0aDNUsDLPyN4/CUR7XuFRYAXdlTcAhRBWaAQGsJ8BRG8hIzSBAYygTI4uAgrzjwyhIn/1Dx8MoEuaLBpBQDGAGMD7Tm1vANUdeMQgrZxDYQIRDUTzR3KP6FtpA4jCj7j/CPjkaBNQaCCiA0X+yiaAAbQ1SMRkAjOHcGbuEdi3NoDKzjuiubvkmD2E0fyVdYgB7DIlG58jOoCRR4DH2mh+DKBTnDuD70Ry7LKoFiImEM2NAXTKdmfwnUiOXRbVAgZwLZ2yjwAzG37slBU++Ew9zMyd3RIMIJsw+8sIRAex9yoezRu5fcjg3Wy0rQH0NjsbOPv3E5g5iNHcVfWIAfTrkZWDCUSHMPJJHM2NATjFsitwJwbCXwjM0sWsvNkC4AaQTZj9pQRmDeKsvFJ4F5thANmE2V9KYNYgzsorhYcBZONk/2wCswZxVt5sntwAsgmzv5TArEGclVcKjxtANk72zyYwaxBn5c3myQ0gmzD7SwnMGsRZeaXwuAFk42T/bAKzBnFW3mye3ACyCbO/lMCsQZyVVwrPcgOIHvSuYO9vQkXr8ObLBs3+OgIRbfTqIpLzcXJv3mg+6xx+3QCyEr4WYgURrceaRydLdhpFIKKNXl1EcnoMIJrH2oMnhw8DGJX0WZylCdGaLDmssIirRSCijV5dRHJaDSCaw9ulBwsMwEuN+OkEIoOCAfxt34cBRGBGlNBqRLSu1v6R2lk7n0CPPiKa6Mn3nVIrd3T/3o5gAL3kWDedgGdoWgPYOown19VerfzR/Vv1374UnJb48/HjrrBoXS3gvcBYV4uARScKLVjyvCPTqiG6f29XuAH0kmNdKQJXA9QaOs8BogPaqiW6v+csPx5NpiXmBtDbM9ZNIBCdEwzgpWnZQFr7T9AQKRcmgAGIm9ca0Gzg4uOw3eYEsvUY3b8X/7a/B/AA0jKZXmisO49AdEAtWozm8HZl618EwgC8ciA+6xspqxanGcCjwFHJLU6oqseaC+lD4B2B6Gx4dBjNZe3kj38L8H1RVgEeCM96orX05LQCJO4cAjN0GM15153XmSj79wAUtwAM4JwhzTxpdBgr6xADyFQOe29BAAOY1MYoeOvLl0nHI+0CBHbX4NY3AAxggQkrXiIGMLlB0QZUfv6ajJb0BgK766/0DUDxIpBbgEHlhFwSiA7/CtrDABA/BG4IYAAFpHFCEwpgpoQLAidor/wNgMcAZnMWgagBrPD+CQOYpS7yliYQHf4Vnv8/aizdhc/iTmnGCr04pcZTNLeEASgeA1a4jp0yXNXPqRh+bgDiLiuaggmIm7Lpdidp7ZgbwCqOvOlMLXUsDKBguxRNwQQKNrZYSafpbJkbgOI9AAZQbNoKlqMwgJUeNY8zAEyg4NQVKUkx/KvpCwMoIj7KmE8AA5jfg2YFJzapCYWAMIFTdbXUDUD1HmC1a1pY3WzQJIABNBHVCTi1WXU6sFclJ+tpuRsAt4C9hq/CaTCACl1w1nBy05yoCH9D4HQdLXkDUN4CeB9wtj9gAKL+v4Ic8csQpzdP1Lpjt1HpZ8SHSNZ8hW8AFohZZmDJbVV3Vo3W/MSNJbCCdiw1RnXbbQCW4r63NFronTy8ddztk1XfWFmTzUqgum689fXqt8sAvMU9m9Jb5Lum9tZytWdGfVZBEjeOQHXN9NbXo1+3AfQWl/mcFKnpVXY9EMdJl0xRAitoJVKjV78uA4gUtsotINOoouJlfYyAQr/Zj7WKGj0mYDYARWGZw6WqL7PGmHxZHSWwgkZUNVpNwGQAqqIyh0tZY2adURGzvo/AKvpQ1mkxgaYBKAvKHqyVau2TMat6CKyki9G1vjUAdTHZBvDYX12zxUV7RMmaMQRW04O63tbM3RpARiGtYhSSyKgbE1B0ZvweK2oho+Z3c3dpAFlFjDAAbgHjB61qRrWOR3wQqGtufWvxjwGMLiBDPBlnGNH8DBan7qnWwMj+q2t/ZwLDDGAkwIxbwKjby6kDqzx3xgDtoN8rDf8wgAxwz8aOBogJKEdqnb0yNLyLdq9m8csAMsDNHP5nbvW5ZohhnfGbX+lO/Vaf5epRIN0AKgyMGmSFM80ftXoVqPtc4bEv40zfz5VqAFUGJQNilbPVG8M5Fe3c48yzpRlAtQHJhDhH8mTNesyr8Mn/2l21fp/zmWIA1YY/SyhVz3maNWQNRzWOynOmGUD1oVBCrPhJUU202fWc1k/VeVMMoPrwZ9wEVjlz9iDO2l81EBW+sbIyVJz5HwOIfm++0iAoAF59pWJtIHEaAif3MXL277Mq+UWglYafW4Bm+CrsEhmC1/pP0vCtAfTcAlYEhwlUGN9YDacPf6+GX+e1+18Drjz4vfBakt2BSeuMVX6OAfzshIXHlT7dfxFoN5FbwFlFvxsb67lHx9Gze+KvbFqabBrA6ObOyIegZlDvy0mv+rjdrcIAPsmohNVyXG37ztuNPml7jgGIDeCxHSagFWnGOxt69IcqBvBNq3y65Ayualf6oyL5dx8MAAPQqyppRwxADxYDeGGKyPQiU+xIXxQU/90DA8AAcpQl3hUDEAP93A4DuOCqEBsvmbSCpSdans/dMIAkA+DbAJ1gFcNPP677gQHc6FQhOm4BGhOgFxqOV7tgAIkGwKdOXLiK4acP933AAN5oVCE+bgExE6AHMX6t1RgABtDSyNSfYwC5+DGABl8EmCvAd7vDPp89BoAB5KusMwMG0AnOsQwDwAAcchkbigHk88YAMIB8lXVmwAA6wTmWYQAGWFEh8k2AAfJFCNz7uHlWYQAGWlEhPlJgAgbQLyFR7jBvM8cA2ox+RYWIARggi4cf5jbmGICNU9gE+DQygv4Mi5ouvG28MQAbJwzAyEkVhgGoSL7fBwMwckaQRlCiMHiLQDa2wQCMnBGkEZQoDN4ikBiABmRUkJoq2MVKgHcANlLcAGycwu8AjGkIExHAAGwgMQAbJwzAyKlKGAZg6wQGYOP0EcVjgAPWxFCG3w4fA7CzwgAcrGaGYgB2+hiAnRUG4GA1MxQDsNPHAOysMAAHq5mhGICdPgZgZ4UBOFjNDMUA7PQxADsrDMDBamYoBmCnjwHYWWEADlYzQzEAO30MwM4KA3CwmhmKAdjpYwB2VhiAg9XMUAzATh8DsLPCABysZoZiAHb6GICdFQbgYDUzFAOw08cA7KwwAAermaEYgJ0+BmBnhQE4WM0MxQDs9DEAO6uwASBMG+zoP7qCs43zIwoDsLPCABysIqEYQISeby0G4OCFMB2wAqFwDsBzLsUAHMAQpgNWIBTOAXjOpRiAAxjCdMAKhMI5AM+5FANwAEOYDliBUDgH4DmXYgAOYAjTASsQCucAPOdSDMABDGE6YAVC4RyA51yKATiAIUwHrEAonAPwnEsxAAewqDAfqfgllffAYewQpCAUA3BARJwOWJ2hMO4E17kMA3CAU4iTW8A9cPg6xCgKxQCcIBGpE5gxHK5GUOIwDMAJVCXUZ9rT3wnA0ylAcTgG4ASqFqwzPeENAqcbqlcgGICXGP+PwA5iY5Yw/H7OGICfWfifBXekZImBAAZggPQSggH4mWEAHcxGLMEA/JQxAD+zjxW8C+gEl7SM4e8DiwH0ccMEAtzUSxn+fqIYQD87bgEBdsqlGEA/TQygnx23gCA7xXKGP0YRA4jxwwQE/Hq3YPh7yf1dhwHEGWICIoaebRh+D637WAxAwxETEHJsbcXwtwjZf44B2FmZIvl60ISpO4jh70Z3uRAD0PL82g0j0IJl8LU8n7thADlceSQQcmX4hTBftsIA8tj+2JkbgQ80Q+/j1RuNAfSS61iHCdigMfw2ToooDEBB0biHwgCqD8cJZzS2e4kwDGBgm04YjhPOOFAy6akwgHTEPxPsPCA7n22wTIalwwCGof6TaOch2flsg2UyLB0GMAy1zgAeO1V7F6AY/ornGiyP4ekwgMHIVYNSaVh2PNNgWUxLhwFMQL/TwOx0lglSmJ4SA5jQgp2GZqezTJDC9JQYwKQWKAdnxuPA6vVPanu5tBjApJaoB2ikCaxc+6R2l02LAUxszYqDtGLNE1tcPjUGMLFFGcP0PI76a8KVap3Y0uVSYwCTW5Y5WIrHgur1TW7f8ukxgAItzB6yHiOoWFOBVm1XAgZQoKUjhq3AMf8pQf2YUvGM1WvCAIp06DQTYPhrCA8DqNGHjypOMQGGv47oMIA6vTjCBBj+WoLDAGr1Y2sTYPjriQ0DqNeTbR8FMIB6YsMA6vVky1sAw19TaBhAzb58VbX6i0EGv7bAMIDa/Vn6NsDw1xcXBlC/R0uaAMO/hrAwgDX6tMwjAYO/lqAwgLX6Vfo2wPCvJyYMYL2elbsNMPjriggDWLd3042AwV9fPBjA+j38cYLsrw0Z+r0EgwHs1c9/ThM1BAZ+b4H8D+i0OXuj4vN5AAAAAElFTkSuQmCC",(function(t){ze.loadingLocks.delete(Ct.lightbulb)})),materialIcon:(new t.TextureLoader).load("data:image/png;base64,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",(function(t){ze.loadingLocks.delete(Ct.material)})),microphoneIcon:(new t.TextureLoader).load("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAAAAXNSR0IArs4c6QAADzlJREFUeF7tnOuaWykMBOP3f+jZbzaZJOP4ApySEFD7N9BHtFpljp3N7Yf/benAx8fHB3mw2+12I/XUquGATa3RB6QKeuifFSUMkHaVEBEAJdowXkTW0AuD8R5V3ikAKnfnSW2zh14YLBiaJyULgIV6WXXw7y30FWGdUAmARXq1yvB/2SkE1giWACjep9UG39tA8UDdlScAivZr9cEXBEWDJQDqN2a34fe1oG7mvAEU682uwy8EigXtVzkCoFBfdh9+IVAobAKgTjNOGXy/F6iTud8wrlfSWRWdOvzeBmrk3FeAiX04ffiFwMTw+Qow13yH/7v//sWhOXn0BjDH9x8CQABMit63xwqACV1w+B+b7i0gP4wCINlzh/+14UIgN5ACINFvh7/NbCHQ5hOxSgAQLjZoVBr+ZwO2Qo0NVrukwwEB0GHWlaUzh2v0E3XFmq/06MS9AiCh6zMGaXTon9mxwxkSWr3cIwRAQssyh4ce/Ht7djpLQuvLP0IABLcoa2CiB38WCLLPFRyHcvICILglGQCYNSQ7ny04FmXkBUBgK04YkBPOGBiR6dICIKgF0YMx61N/1peE1c4bFJt0WQEQZHkkAKoOw4lnDopPmqwACLL6xGE48cxB8UmTFQABVp88CCefPSBK4ZICIMDiqCGoevXP+olwlfMHRCpMUgAEWBsBgNXCrwcBwQqQFACwqRHB/yxRAPxs1Go+wPHC5QQAbGkEAFYNvV7A4QqQEwCwqYb+j6F6AYcrQE4AwKbSoV/10//LVv2AAwbLCQDQUDrsO7zz6gkYsAApAQCaatj/NVNPwIAFSAkA0FQ67Ktf/30NAMMVJCUAQGMFwGMz9QUMGSwlAEBDDboAAOOUIiUAQJsFgAAA45QiJQBAmwWAAADjlCIlAECbBYAAAOOUIiUAQJtJAOzyC0DELwG7eQNGsFtKAHRb9nyDANAbME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVLbAuDZMN5ut7AzC4D1ATAjNymT/uQhYcMw61A9Q0jDoOfZ7/yha3v3vOg/r+xNT2279WUrAPQ08ivwZENHnv9s8Mi6ooe7Rb+qNyN17dSbbQAw0kgaAldquB+inUL2ebaK3lypaZf+bAGAK40kIUDUQdbT8smctaaaN0Q9O0BgeQAQjfwcAqKZVC1UPVnD3fKcat5Q9RC5afEvao0A+MvZq82kQiUAXsfdPnE4EAACgEvTC6VKcKxUS4r5Lx4iAARASgYrDV2lWlLM3xUAZCOJazdZz9Vr7uxg3T+/kjdkLURuZvZq6RtAtUaS9QiA52Nx1RuyTwJgIr6qNZKs52rIJ7bl4aMreUPWIgAmJq1aI8l6BIA3gIzR8hXALwEzclbqbwKSoPYGkBKfxw+p1kiyHm8A3gAyRssbgDeAjJx5A0hxuf8hAkAA9KdmYEel2xFZi68AA2GgtlRrZLV6KJ8JHdKbq69HZC0CgEjHBQ2ymQbrQiNebCV7RAwcWc/VzMQ43q669CvA5zErNZOshQh6ewxiV1bzhaxHAMRm5616pWaStQiANX4FEABvRzR2ATl0V5tJ1iIABEDs5PxU9xWg6K8AAkAACIAGByp96tK17ACBap7Q9Vy9NTZEPHSJN4A7e680lA6XAHic/Uo9ulJL6GQ3igsAEAD0rxIC4N8UXx04GtJX62mc07BlAqA4AFaGAD1shBd0TQIgjE1twtUaStdDhL7NSX5VRS/omgQAn5suxYoNpWtaEQIRHhA+0HUJgK5x5RdXbChdExF83vnXilU9oOsSANnJevC8ak2l6/k68iphq3p+uq5V+vFqRJf/ErDiN+900P5uYPXQVT47XVv1XrR8NguABy4RjaXDtgIEqp+Zro/IScuQRq4RAAsCoOp3AvSA0dCj6xMAkWjq0KYbSw1YRF30UHTY/HJp9bNG1CcAqPQAOnSDiebSNT2yiajziv2rnJGuc7bvV3r27UOEEpqtU7XBdF2VILDS2ehaBcDsib97Pt3gVV4DZv1EGOF3FNwiahUAAqDZgYgAPnt4dDBXPEtEzdE+N4fr4sItfgX48qBqoyPqetd3OqCrniGibtrbd72M/HMB8MZdqtkRQWwNxugZVqz53pOIM4z62dqvzHUC4AAAvHtdiBiSqyGmhizibFRtVz0i9guABhephkeEsaH85ZZU95uqr0JjtgLAp6ERQ0Y2PKK+CkGiaqjuNVkf5dkVHQHQ6B7ZeCHw2PQVPCZrbIxe6LLtALDCLSCqxtCkBIvTgxUBWbrGYEub5AVAk00/F5EBiAhox1HKLV3BW7LGKg0QAB2doAMgBHiwRt6u6P53RC9s6ZYAWCkEp0OAHqooP+k6wya6U1gAdBpGvwpEwmrgaKlb6KGKGv6Inqca/eJh2wIgcrDo4H71JzLAVQIXOUxR/kX1u0JPBMBgF6JCERXiwWPi21b0Lapm3NwBwa0BEHkLWPGTbCAf6JaoQYqEZlTNqLEXxATAFfNutzD/IkN94cjDWyMHKdKryLqHzQQ3hgUYrPGy1MoBiaz9srENAtEDFOlPdO0N9oUvEQCAxRlBiQw6YME/Ejt4knGGCO97NI8AQPR3AZHfB9w3szoIsoYm2oesc/QMa8RaAQC6mhma6AHotWW3s2eep9drcv0xAMi4BWTeBL5CMBsE2YOScd7sM5ED3aslAHoda1g/M0DRA7Lz2b5aO/OMDfFClxwFgF1vAa8SQQChykAQZ3k3PVXO+q5O6s+PA0AWBGa8DlChqKaTMfin9ksABKf9tE8U2s6s4RcAdOeK6xms4g0K+vcdn536VFAfeQOY8Q36qQEbxYyAHnWub9/RAMj8PuDUK2ZfHH+udvhHXBvbIwA+Pj7GrBvf5W3gsXeZg/9Vwem9OB4A2Z84Bs/hH//o4HcKgF+ezvj08bUg97r/9/ic/sn/+4OIZ8q6ikIgt3f6nev3o6d5A7hzZVYoT7oN6PH8wfcG8KQHM8O5+/cDeltn8AXAi15UCOpONwL9rDf4AuBNT6qEdmUQ6GHdwRcADb2pFOBVXg/0rCFYhZb4JeBCN4H7Uqv8lFVx6FcB5mwWCICGDlQO+IzftvWjITSLLBEAHY1aJfgkFE48c0ckll8qADpbuOJAdB5x6eVVXotWMVEADHRKCAyYlrDF4e83WQD0e/b/DiEwaFzQNod/zFgBMOabELjgG73V4R93VACMe/d7p7cBwMQBCQd/wLS7LQLguofeBiAPe2Qc/h63nq8VAIyP3gZgH5/JOfis0QKA9dPbQICfX5IOP2+uAOA99TYAe+rgw4b+JScA4rwVBBe9dfAvGtiwXQA0mEQs8ZeCPhcd/j6/RlcLgFHnBvcJgtfGOfiDwRrcJgAGjbu6TRB8d9DBv5qosf0CYMw3dNepMHDo0RgNiQmAIdtiNp0CAgc/Jj8jqgJgxLWEPbvBwKFPCM3AIwTAgGnZW1aFgUOfnZT+5wmAfs+m76gKBAd+ejS6CxAA3ZbV3JANBYe9Zg56qxIAvY4tsp4GggO/SOM7yxQAnYatslwArNKpuXUKgLn+hz1dAIRZu5WwANiqnX8OIwA2bSx8LAEAG1pFTgBU6UTtOgRA7f4MVycAhq07aqMA2LTdAmDTxsLHEgCwoVXkBECVTtSuQwDU7s9wdQJg2LqjNgqATdstADZtLHwsAQAbWkVOAFTpRO06BEDt/gxXJwCGrTtqowDYtN0CYNPGwscSALChVeQEQJVO1K5DANTuz3B1AmDYuqM2CoBN2y0ANm0sfCwBABtaRU4AVOlE7ToEQO3+DFcnAIatO2qjANi03QJg08bCxxIAsKFV5ARAlU7UrkMA1O7PcHUCYNi6ozYKgE3bLQA2bSx8LAEAG1pFTgBU6UTtOgRAsf7Qg1vseD/858VrdUQAFOnH7oN/b7MgqBE8ATC5D6cNviCYHLi7xwuAyf0QADczODGDmj/R/NOH/8t6XwfmhVAATPLe4f9uvBCYE0QBMMf3HwJAAEyK3rfHCoBJXRAAAmBS9ARABeMFgACokENvAJO6IAAEwKToeQOoYLwAEAAVcugNYFIXBIAAmBQ9bwAVjBcAAqBCDr0BTOqCABAAk6LnDaCC8Z81CIGfnfAvAc1LpDeAed7//+TTIeDwzw2gAJjrvwC4+T8DzYygAJjp/q9nn3oL8NN/fvgEwPwe/K7gFBA4+HVC9x8v4V15xA50xwAAAABJRU5ErkJggg==",(function(t){ze.loadingLocks.delete(Ct.microphone)})),objectIcon:(new t.TextureLoader).load("data:image/png;base64,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",(function(t){ze.loadingLocks.delete(Ct.object)})),pencilIcon:(new t.TextureLoader).load("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIACAYAAAD0eNT6AAAAAXNSR0IArs4c6QAAIABJREFUeF7t3dt2HbeOBVD7/z86PeLEpxNHsupCgAAx+zV7F4EJqrCknIz+/s3/ESBAgAABAuMEvo/rWMMECBAgQIDANwHAJSBAgAABAgMFBICBQ9cyAQIECBAQANwBAgQIECAwUEAAGDh0LRMgQIAAAQHAHSBAgAABAgMFBICBQ9cyAQIECBAQANwBAgQIECAwUEAAGDh0LRMgQIAAAQHAHSBAgAABAgMFBICBQ9cyAQIECBAQANwBAgQIECAwUEAAGDh0LRMgQIAAAQHAHSBAgAABAgMFBICBQ9cyAQIECBAQANwBAgQIECAwUEAAGDh0LRMgQIAAAQHAHSBAgAABAgMFBICBQ9cyAQIECBAQANwBAgQIECAwUEAAGDh0LRMgQIAAAQHAHSBAgAABAgMFBICBQ9cyAQIECBAQANwBAgQIECAwUEAAGDh0LRMgQIAAAQHAHSBAgAABAgMFBICBQ9cyAQIECBAQANwBAgQIECAwUEAAGDh0LRMgQIAAAQHAHSBAgAABAgMFBICBQ9cyAQIECBAQANwBAgQIECAwUEAAGDh0LRMgQIAAAQHAHSBAgAABAgMFBICBQ9cyAQIECBAQANwBAgQIECAwUEAAGDh0LRMgQIAAAQHAHSBAgAABAgMFBICBQ9cyAQIECBAQANwBAgQIECAwUEAAGDh0LRMgQIAAAQHAHSBAgAABAgMFBICBQ9cyAQIECBAQANwBAgQIECAwUEAAGDh0LRMgQIAAAQHAHSBAgAABAgMFBICBQ9cyAQIECBAQANwBAgQIECAwUEAAGDh0LRMgQIAAAQHAHSBAgAABAgMFBICBQ9cyAQIECBAQANwBAgQIECAwUEAAGDh0LRMgQIAAAQHAHSBAgAABAgMFBICBQ9cyAQIECBAQANwBAgQIHCbwxx9//PG2pe/fv9sPbxGLf9+Aiw9IeQQIELgisGLpf3aOMHBlAv0+IwD0m5mKCRAg8EMgcukLA+dfMgHg/BnrkACBwwR2LP5fCf1VoP+lEgD6z1AHBAgMEqiw/P/JLQj0vXwCQN/ZqZwAgUEC1Ra/END/8gkA/WeoAwIEDheovPx/0vtLQL9LKAD0m5mKCRAYJNBh+ftrQM8LKQD0nJuqCRA4XKDb4hcC+l1IAaDfzFRMgMDhAp2Xv38l0OdyCgB9ZqVSAgQGCJyw/IWAHhdVAOgxJ1USIDBA4KTlLwTUv7ACQP0ZqZAAgQECJy5/IaD2xRUAas9HdQQIDBA4efkLAXUvsABQdzYqI0BggMCE5S8E1LzIAkDNuaiKAIEBApOWvxBQ70ILAPVmoiICBAYITFz+QkCtiy0A1JqHaggQGCAwefkLAXUuuABQZxYqIUBggIDl//9D9v8/YO+FFwD2+judAIFBApb/f4ctBOz7ARAA9tk7mQCBQQKW/+fDFgL2/CAIAHvcnUqAwCABy//rYQsBXxut/oQAsFrU8wgQIPAPAcv/+nUQAq5brfikALBC0TMIECDwgYDlf/9aCAH3zZ5+QwB4Kud7BAgQ+I2A5f/8eggBz+3ufFMAuKPlswQIELggYPlfQPriI0LAe8OvniAAfCXknxMgQOCGgOV/A0sIWIf14EkCwAM0XyFAgMBHApb/+nvhLwHrTX8+UQCIs/VkAgQGCVj+ccMWAmJsBYAYV08lQGCQgOUfP2whYL2xALDe1BMJEBgkYPnnDVsIWGstAKz19DQCBAYJWP75wxYC1pkLAOssPYkAgWECAsCegQsBa9wFgDWOnkKAwDABy3/vwIWA9/4CwHtDTyBAYKiAELB38ELAO38B4J2fbxMgMFxACNh7AYSA5/4CwHM73yRAgMAPASFg70UQAp75CwDP3HyLAAEC/xIQAvZeCCHgvr8AcN/MNwgQIPChgBCw92IIAff8BYB7Xj5NgACB3woIAXsviBBw3V8AuG7lkwQIELgkIARcYgr7kBBwjVYAuObkUwQIELglIATc4lr+YSHga1IB4GsjnyBAgMAjASHgEduyLwkBv6cUAJZdNQ8iQIDAfwWEgL23Qgj43F8A2Hs3nU6AQBGBn4s6YmEIAXuHHDHTvR2tOV0AWOPoKQQINBb4dUFHLAwhYO8FiZjp3o7eny4AvDf0BAIEGgt8tpgjFoYQsPeiRMx0b0fvThcA3vn5NgECjQW+WsgRC+OrMxtztig9YqYtGv+gSAGg6+TUTYDAK4GrizhiYVw9+1WDvvypQMRMO3ILAB2npmYCBF4J3F3AEQvjbg2vGvbl/whEzLQbswDQbWLqJUDglcDTxRuxMJ7W8grAl/8nEDHTTrwCQKdpqZUAgVcCbxduxMJ4W9MrEF/+FjHTLqwCQJdJqZMAgVcCqxZtxMJYVdsroKFfjphnF0oBoMuk1EmAwGOB1Qs2YmmsrvEx1sAvRsyzA6MA0GFKaiRA4LFA1GKNWBpRtT7GG/TFiHlW5xMAqk9IfQQIPBaIXqgRSyO65seYA74YMc/KbAJA5emojQCBxwJZizRiaWTV/hj30C9GzLIylQBQeTpqI0DgkUDmAo1aGpk9PEI+9EtR86zIJQBUnIqaCBB4LJC5OKOXRWYvj8EP+2L0TCtxCQCVpqEWAgReCWQuzKxFkdnTK/yDvpw1291kAsDuCTifAIElApmLMntBZPa2ZBjNH5I9311cAsAueecSILBMIHNB7loOmT0uG0zTB+2acTaXAJAt7jwCBJYKZC7G3Yshs9elQ2r4sN2zziATADKUnUGAQIhA5kKsshAyew4ZWpOHVpl3JJcAEKnr2QQIhAlkLsJqyyCz97ABFn9wtZlHcAkAEaqeSYBAqEDmAqy6CDINQodZ+OFVZ7+KTABYJek5BAikCGQuvuoLINMiZbjFDqk+/7dcAsBbQd8nQCBNIHPhdXn5Z5qkDbrIQV3uwFMuAeCpnO8RIJAqkLnour34M21Sh775sG734C6XAHBXzOcJEEgXyFxwkS/9n31EnJFplH4BNh0YMadNrXx4rABQaRpqIUDgPwKZiy3yhf9rHxFnZVpNuKoRM6rkJgBUmoZaCBD4l0DmQot82X/WR8SZmWanX9eI+VQyEwAqTUMtBAj8TyBzkUW+6L/qI+Lsr850za4JRMzm2sk5nxIAcpydQoDADYHMBRb5kr/aR0QNV8++MZZxH42YSyVEAaDSNNRCgMC3zMUV+YK/20dELXdrcP3+LRAxk0rGAkClaaiFwHCBzIUV+XJ/2kdETU9rGX4Vf7QfMY9KrgJApWmohcBggcxFFflif9tHRG1va5p6LSNmUclSAKg0DbUQGCqQuaAiX+qr+oiocVVtk65oxBwq+QkAlaahFgIDBTIXU+QLfXUfEbWurvH06xoxg0pmAkClaaiFwDCBzIUU+TKP6iOi5qhaT7y6Ef6VnASAStNQC4FBApmLKPJFHt1HRO3RNZ9yjSPsK9kIAJWmoRYCQwQyF1DkSzyrj4gesmrvfKUj3Ct5CACVpqEWAgMEMhdP5As8s48/r0VEL9k9dLreEd7V+hcAqk1EPQQOFshcOJEv8Mw+/nkdInra1Uv1ax5hXa1nAaDaRNRD4FCBzEUT+fLO7OOjqxDR2+6eKl75COdqfQoA1SaiHgIHCmQumMgXd2Yfv7sGET1W6a3C9Y/wrdDXrzUIABWnoiYCBwlkLpbIF3dmH1fGH9FrtR6vOER8JsI2os63zxQA3gr6PgECnwpkLpTIl3ZmH3euU0TPVXu94/L2sxGub2uK+L4AEKHqmQQIjP3/6pc9+ohlNTkERHhm34mr5wkAV6V8jgCBywKZCyTyhZ3Zx2XcDz4YYdCl9zduH303wnJ1jaueJwCskvQcAgR+CGQujsiXdWYfK65OhEU3g7eOEYZva4r8vgAQqevZBIYJZC6MyJd1Zh8rr0iESVeLu64RdndryP68AJAt7jwChwpkLorIl3VmHxFXIcKmu8kV5wi3K+fu/IwAsFPf2QQOEchcEJEv6sw+IkcfYXSKzUfuEV6R8131bAFglaTnEBgqkLkYIl/UmX1kXJUIq9OM/pxDhFPGfFecIQCsUPQMAkMFMhdC5Is6s4/MqxJhdpJVhE/mfN+eJQC8FfR9AkMFMhdB5Is6s48dVyXC7hSzCJsdM356pgDwVM73CAwWyFwAkS/pzD52XpcIw+52ESY7Z/zkbAHgiZrvEBgskPnij3xJZ/ZR4bpEWHY1jLCoMOO7NQgAd8V8nsBggcwXfuRLOrOPStclwrSbZYRBpRnfqUUAuKPlswQGC2S+6CNf0pl9VLwuEbZdTCN6rzjjqzUJAFelfI7AYIHMF3zkSzqzj8rXJcK4um1Ez5VnfKU2AeCKks8QGCyQ+WKPfEln9tHhukRYVzWO6LXDjL+qUQD4Ssg/JzBYIPOFHvmSzuyj03WJMK9mHdFjpxn/rlYB4JRJ6oPAYoHMF3nkSzqzj8UjSHlchH0V84jeUoaSdIgAkATtGAKdBDJf4JEv6cw+Os3311ojZrDbPqKnzjP+qHYB4LSJ6ofAS4HMF3fkSzqzj5fkJb4eMYtdM4jopcSQFhchACwG9TgCnQUyX9iRL+nMPjrP+8S/BETeq5Nm/WcvAsBpE9UPgYcCmUsz8iWd2cdD6tJfi5hN1kwiai89rJfFCQAvAX2dwAkCWS/oH791fP8e9t7J7OOEuX/WQ8SMomcTUfPJM/YXgNOnqz8CFwSiX8z/LCHyJZ3ZxwXW9h+JmFXUjCJqbT/ACw2EJfELZ/sIAQKbBaJeyB+1FfmSzuxj88hSj4+Y2epZRdSYirzxMAFgI76jCewUWP0i/l0vkS/pzD52zmvX2RGzWzWziNp2Oe84VwDYoe5MApsFVr2Ar7QR+ZLO7ONKr6d+JmKGb2cXUdOp8/usLwFg2sT1O17g7Yv3DmDkSzqzjzs9n/rZiFk+nWFELafO7bd/mZvYtJ4JTBV4+sJ94hX5ks7s40nvp34nYqZ3ZxlRw6nz+qovfwH4Ssg/J3CIwN0X7Zu2I1/SmX28MTj1uxGzvTrTiLNPndOVvgSAK0o+Q6C5wNUX7Io2I1/SmX2ssDj1GREz/mq2EWeeOp+rfQkAV6V8jkBTga9erCvbinxJZ/ax0uTUZ0XM+rMZR5x16lzu9CUA3NHyWQLNBDKXZuRLOrOPZiPeWm7EzH+ddcQZW9EKHS4AFBqGUgisFMhcmpEv6cw+VvpPeVbE7P+cecRzp8zkap8CwFUpnyPQSCBzaUa+qDP7aDTecqVG3oFyzR5UkABw0DC1QuBPgcylGfniz+zDzXkvEHkX3lfnCR8JCADuBYGDBDKXZuQLP7OPg8a/vZXIO7G9uQMLEAAOHKqWZgpkLs3IF31mHzNvSmzXkXcjtvJ5TxcA5s1cxwcKZC7NyBd8Zh8HXoMyLUXekTJNHlCIAHDAELUwWyBzaUa+2DP7mH1jcrqPvCs5HZx/igBw/ox1eLBA5tKMfKFn9nHwdSjXWuSdKddsw4IEgIZDUzKBPwUyl2bkizyzDzcnXyDy7uR3c9aJAsBZ89TNEIHMpRn5As/sY8jVKNlm5B0q2XCTogSAJoNSJoGfAplLM/LFndmH27NfIPIu7e+uZwUCQM+5qXqoQObSjHxhZ/Yx9KqUbDvyTpVsuHhRAkDxASmPgN/83YFTBASAWpMUAGrNQzUEPhTI/I058iWd2YerVEsg8l7V6rRPNQJAn1mpdKhA5tKMfEln9jH0qpRtO/JelW26QWECQIMhKXGuQObSjHxJZ/Yx97bU7DzyXtXsuE9VAkCfWal0mEDm0ox8SWf2MeyKlG838l6Vb75BgQJAgyEpcZ5A5tKMfEln9jHvltTuOPJe1e68T3UCQJ9ZqXSIQObSjHxJZ/Yx5Gq0aTPyXrVBaFCoANBgSEqcI5C5NCNf0pl9zLkdPTqNvFc9BPpUKQD0mZVKDxfIXJqRL+nMPg6/Eu3ai7xX7TAaFCwANBiSEs8XyFyakS/pzD7OvxW9Ooy8V70k+lQrAPSZlUoPFchcmpEv6cw+Dr0KbduKvFdtURoULgA0GJISzxXIXJqRL+nMPs69DT07i7xXPUX6VC0A9JmVSg8TyFyakS/pzD4OuwLt24m8V+1xGjQgADQYkhLPE8hcmpEv6cw+zrsFvTuKvFe9ZfpULwD0mZVKDxHIXJqRL+nMPg4Z/TFtRN6rY5AaNCIANBiSEs8RyFyakS/pzD7Omf4ZnUTeqzOE+nQhAPSZlUqbC2QuzciXdGYfzUd+XPmR9+o4rAYNCQANhqTE/gKZSzPyJZ3ZR/+pn9VB5L06S6pPNwJAn1mptKlA5tKMfEln9tF01MeWHXmvjkVr0JgA0GBISuwrkLk0I1/SmX30nfaZlUfeqzPF+nQlAPSZlUqbCWQuzciXdGYfzUZ8fLmR9+p4vAYNCgANhqTEfgKZSzPyJZ3ZR78pn11x5L06W65PdwJAn1mptIlA5tKMfEln9tFktGPKjLxXYxAbNCoANBiSEvsIZC7NyJd0Zh99pjuj0sh7NUOwT5cCQJ9ZqbS4QObSjHxJZ/ZRfKTjyou8V+MwGzQsADQYkhLrC2QuzciXdGYf9ac6q8LIezVLsk+3AkCfWam0qEDm0ox8SWf2UXSUY8uKvFdjURs0LgA0GJIS6wpkLs3Il3RmH3WnObOyyHs1U7RP1wJAn1mptJhA5tKMfEln9lFshOPLibxX43EbAAgADYakxHoCmUsz8iWd2Ue9Kc6uKPJezZbt070A0GdWKi0ikLk0I1/SmX0UGZ0y/haIvFeQ+wgIAH1mpdICAplLM/IlndlHgbEp4R8CkfcKdC8BAaDXvFS7USBzaUa+pDP72DguR38gEHmvgPcTEAD6zUzFGwQyl2bkSzqzjw1jcuRvBCLvFfieAgJAz7mpOlEgc2lGvqQz+0gcj6MuCETeqwvH+0hRAQGg6GCUVUMgc2lGvqQz+6gxOVX8FIi8V5R7CwgAveen+kCBzKUZ+ZLO7CNwHB79QCDyXj0ox1eKCQgAxQainBoCmUsz8iWd2UeNyanCb/7uwFUBAeCqlM+NEchcmpb/mGuV2mjkvUptxGGhAgJAKK+HdxOw/LtNTL2/Clj+7sRVAQHgqpTPHS9g+R8/4uMbtPyPH/HSBgWApZwe1lXA8u86OXX7d/7uwFMBAeCpnO8dI2D5HzPKsY34zX/s6F81LgC84vPl7gKWf/cJqt/ydweeCggAT+V8r72A5d9+hOMbsPzHX4FXAALAKz5f7ipg+XednLr9O393YJWAALBK0nPaCFj+bUal0E8E/ObvaqwQEABWKHpGGwHLv82oFGr5uwPBAgJAMLDH1xGw/OvMQiXPBPzm/8zNtz4WEADcjBEClv+IMR/dpOV/9Hi3NCcAbGF3aKaA5Z+p7awIAcs/QtUzBQB34GgBy//o8Y5ozvIfMeYtTQoAW9gdmiFg+WcoOyNSwPKP1PVsAcAdOFLA8j9yrKOasvxHjXtLswLAFnaHRgpY/pG6np0hYPlnKDtDAHAHjhKw/I8a58hmLP+RY9/StACwhd2hEQKWf4SqZ2YKWP6Z2s4SANyBIwQs/yPGOLoJy3/0+Lc0LwBsYXfoSgHLf6WmZ+0QsPx3qDtTAHAHWgtY/q3Hp/hv375Z/q7BLgEBYJe8c18LWP6vCT1gs4Dlv3kAw48XAIZfgK7tW/5dJ6funwKWv7uwW0AA2D0B598WsPxvk/lCMQHLv9hAhpYjAAwdfNe2Lf+uk1O33/zdgWoCAkC1iajnUwHL3+XoLuA3/+4TPKt+AeCseR7bjeV/7GjHNGb5jxl1m0YFgDajmluo5T939qd0bvmfMsmz+hAAzprncd1Y/seNdFxDlv+4kbdpWABoM6p5hVr+82Z+WseW/2kTPasfAeCseR7TjeV/zCjHNmL5jx19m8YFgDajmlOo5T9n1qd2avmfOtmz+hIAzppn+24s//YjHN+A5T/+CrQBEADajOr8Qi3/82d8eoeW/+kTPqs/AeCsebbtxvJvOzqF/y1g+bsK3QQEgG4TO7Bey//AoQ5ryfIfNvBD2hUADhlk1zYs/66TU/dPAcvfXegqIAB0ndwBdVv+BwxxeAuW//AL0Lx9AaD5ALuWb/l3nZy6/ebvDpwiIACcMslGfVj+jYal1A8F/ObvYpwgIACcMMVGPVj+jYalVMvfHThaQAA4ery1mrP8a81DNfcF/OZ/38w36goIAHVnc1Rllv9R4xzZjOU/cuxHNy0AHD3eGs1Z/jXmoIrnApb/czvfrCsgANSdzRGVWf5HjHF0E5b/6PEf3bwAcPR49zZn+e/1d/p7Acv/vaEn1BUQAOrOpnVlln/r8Sn+27dvlr9rcLqAAHD6hDf0Z/lvQHfkUgHLfymnhxUVEACKDqZrWZZ/18mp+6eA5e8uTBEQAKZMOqFPyz8B2RGhApZ/KK+HFxMQAIoNpGs5ln/Xyanbb/7uwFQBAWDq5Bf2bfkvxPSoLQJ+89/C7tDNAgLA5gF0P97y7z5B9Vv+7sBUAQFg6uQX9G35L0D0iK0Clv9WfodvFhAANg+g6/GWf9fJqdu/83cHCPwlIAC4CbcFLP/bZL5QTMBv/sUGopwtAgLAFva+h1r+fWen8r9/6/n+3XvPZSDgLwDuwB0By/+Ols9WFPCbf8WpqGmXgCS8S77ZuZZ/s4Ep9z8Clr9LQeDfAgKAG/GlgOX/JZEPFBew/IsPSHlbBASALex9DrX8+8xKpR8LWP5uBoFPfjbAEPhMwPJ3N7oLWP7dJ6j+SAF/AYjUbfxsy7/x8JT+Q8DydxEI/F5AAHBD/iNg+bsU3QUs/+4TVH+GgACQodzoDMu/0bCU+qGA5e9iELgmIABccxrxKct/xJiPbtLyP3q8mlssIAAsBu36OMu/6+TU/VPA8ncXCNwTEADueR35acv/yLGOasryHzVuzS4SEAAWQXZ9jOXfdXLq9pu/O0DgnYAA8M6v9bct/9bjU7z/1M8dIPBKQAB4xdf3y5Z/39mp/C8Bf/Z3Ewi8ExAA3vm1/Lbl33Jsiv6HgOXvOhB4LyAAvDds9QTLv9W4FPuBgOXvWhBYIyAArHFs8RTLv8WYFPkbAcvf9SCwTkAAWGdZ+kmWf+nxKO6CgOV/AclHCNwQEABuYHX9qOXfdXLq/ilg+bsLBNYLCADrTUs90fIvNQ7FPBCw/B+g+QqBCwICwAWkrh+x/LtOTt1+83cHCMQLCADxxltOsPy3sDt0oYDf/BdiehSBDwQEgAOvheV/4FCHtWT5Dxu4drcICABb2OMOtfzjbD05R8Dyz3F2CgEB4KA7YPkfNMyhrVj+Qwev7S0CAsAW9vWHWv7rTT0xV8Dyz/V2GgEB4IA7YPkfMMThLVj+wy+A9rcICABb2Ncdavmvs/SkPQKW/x53pxIQABrfAcu/8fCU/kPA8ncRCOwTEAD22b862fJ/xefLBQQs/wJDUMJoAQGg4fgt/4ZDU/K/BCx/F4LAfgEBYP8MblVg+d/i8uGCApZ/waEoaaSAANBo7JZ/o2Ep9UMBy9/FIFBHQACoM4vfVmL5NxmUMj8VsPxdDgK1BASAWvP4sBrLv8GQlPhbAcvfBSFQT0AAqDeTf1Vk+RcfkPK+FLD8vyTyAQJbBASALezXDrX8rzn5VF0By7/ubFRGQAAoegcs/6KDUdZlAcv/MpUPEtgiIABsYf/9oZZ/waEo6ZaA5X+Ly4cJbBEQALawf36o5V9sIMq5LWD53ybzBQJbBASALewfH2r5FxqGUh4JWP6P2HyJwBYBAWAL+38PtfyLDEIZjwUs/8d0vkhgi4AAsIX934da/gWGoIRXApb/Kz5fJrBFQADYwv7/h1r+mwfg+NcClv9rQg8gsEVAANjC/tehlv9GfEcvEbD8lzB6CIEtAgLAFnbLfxO7YxcKWP4LMT2KwAYBAWADut/8N6A7cqmA5b+U08MIbBEQAJLZLf9kcMctF7D8l5N6IIEtAgJAIrvln4jtqBAByz+E1UMJbBEQAJLYLf8kaMeECVj+YbQeTGCLgACQwG75JyA7IlTA8g/l9XACWwQEgGB2yz8Y2OPDBSz/cGIHENgiIAAEslv+gbgenSJg+acwO4TAFgEBIIjd8g+C9dg0Acs/jdpBBLYICAAB7JZ/AKpHpgpY/qncDiOwRUAAWMxu+S8G9bh0Acs/ndyBBLYICAAL2S3/hZgetUXA8t/C7lACWwQEgEXslv8iSI/ZJmD5b6N3MIEtAgLAAnbLfwGiR2wVsPy38jucwBYBAWAB+wkBILOHBeQesVDA8l+I6VEEGgkIAIuGlblAV7+wM2tfxO0xiwRW36VFZXkMAQIJAgLAQuTMRbrqxZ1Z80Jqj1ogsOoOLSjFIwgQ2CAgACxGz1yob1/gmbUuZva4lwJv787L432dAIECAgJAwBAyF+vTF3lmjQHEHvlC4OmdeXGkrxIgUFBAAAgaSuaCvftCz6wtiNdjHwrcvSsPj/E1AgQaCAgAgUPKXLRXX+yZNQXSevQDgat35MGjfYUAgYYCAkDw0DIX7lcv+Mxaglk9/qbAV3fj5uN8nACBAwQEgIQhZi7ez170mTUkkDrihoDlfwPLRwkMEhAAkoaduYB/feFnnp3E6ZiLApb/RSgfIzBQQABIHHrmIv754s88M5HSURcELP8LSD5CYLCAAPCb4f+5PFe/RC3kwT9tia2vvreJpTuKAIEkAQHgiwDw5z9e/TIVApJu99BjVt/XoYzaJnC8gADwyYh/XdKrX6pCwPE/W1saXH1PtzThUAIEUgQEgIsBwF8CUu6jQ14IWP4v8HyVwEABAeBGABACBv6ENGnZ8m8yKGUSKCQgANwMAEJAodurlB8Clr+LQIDAEwEB4EEAiHjp+t8EPLm+vmP5uwMECDwVEAAeBgAh4OmV871VApb/KknPITBTQAB4EQCEgJk/NBW6tvwrTEENBHoLCAAfzO/un+NXv4zvnt/7Cqr+rsDq+3b3fJ8nQOCqvOJBAAAKXklEQVQMAQFgQQDwl4Azfhg6dGH5d5iSGgn0EBAAFgUAIaDHhe9cpeXfeXpqJ1BPQABYGACEgHoX/JSKLP9TJqkPAnUEBIDFAUAIqHO5T6nE8j9lkvogUEtAAAgIAEJArUveuRrLv/P01E6gtoAAEBQAhIDaF79DdZZ/hympkUBfAQHgl9mt/k/wVr/EV9fX9+qeXfnqe3O2lu4IEHgiIAAEBwB/CXhyLWd/x/KfPX/dE8gSEAASAoAQkHWd+59j+fefoQ4IdBEQAJICgBDQ5UdiX52W/z57JxOYKCAAJAYAIWDij9i1ni3/a04+RYDAOgEBIDkACAHrLu8pT7L8T5mkPgj0EhAA/jGvzP+F/eqXfmbtva547WpX34Pa3aqOAIFKAgLApgDgLwGVfgz21GL573F3KgECfwkIABsDgBAw98fQ8p87e50TqCIgAGwOAEJAlR+FvDos/zxrJxEg8LmAAFAgAAgBc35ELf85s9YpgeoCAkCRACAEVP9ReV+f5f/e0BMIEFgnIAAUCgBCwLqLXe1Jln+1iaiHAAEB4O87UOk/o1u9LCr1NvFHbvU8JxrqmQCB9QICQMEA4C8B6y/6rida/rvknUuAwFcCAkDRACAEfHV16/9zy7/+jFRIYLKAAFA4AAgBfX80Lf++s1M5gSkCAkDxACAE9PtRtPz7zUzFBCYKCAANAoAQ0OdH0/LvMyuVEpguIAB8+/aty/9KfvVy6dJ3lx/S1fPp0rc6CRDoKSAANAoA/hJQ94fM8q87G5URIPCxgADQLAAIAfV+lC3/ejNREQECXwsIAA0DgBDw9cXO+oTlnyXtHAIEVgsIAE0DgBCw+kfh/vMs//tmvkGAQB0BAaBxABAC9v0gWf777J1MgMAaAQGgeQAQAtb8INx5iuV/R8tnCRCoKjA+AJzyn8KtXkqnuKz+wVvtvLo+zyNAgMBVAQHgjz/+uIpV/XOrl5MQ8O+Jr/atfp/UR4DA2QICwEEBwL8OiPthtfzjbD2ZAIE9AgLAYQFACFj/g2T5rzf1RAIE9gsIAAcGACFg3Q+W5b/O0pMIEKglIAAcGgCEgPc/aJb/e0NPIECgroAAcHAAEAKe/+BZ/s/tfJMAgR4CowPAlP+V++pldrrbaq8erwJVEiAwTUAAGDLx1Uvt1BCw2mnI9dImAQINBQSAhkN7WvLq5XZaCFjt83ROvkeAAIEMAQEgQ7nQGauX3CkhYLVLoZErhQABAh8KCAADL8bqZdc9BKz2GHiltEyAQEMBAaDh0FaUvHrpdQ0Bqx1WzMYzCBAgkCEwNgB0XVgrL8Xq5dfNdHX/K2fjWQQIEIgWEACihYs/f/US7BICVvddfMzKI0CAwH8EBACX4tvqZVg9BKzu1xUiQIBARwEBoOPUAmpevRSrhoDVfQaMwiMJECCQIiAApDD3OGT1cqwWAlb312OqqiRAgMDHAgKAm/EvgdVLskoIWN2Xa0OAAIHuAgJA9wkG1L96We4OAav7CSD3SAIECKQLjAwAuxdS+pQfHLh6ae4yX93HA0pfIUCAQEkBAaDkWGoUtXp5ZoeA1fXXmIoqCBAgsEZAAFjjeOxTVi/RrBCwuu5jB6wxAgTGCggAY0d/vfHVyzQ6BKyu97qUTxIgQKCPgADQZ1ZbK129VKNCwOo6t6I7nAABAoECAkAg7mmPXr1cV4eA1fWdNj/9ECBA4J8C4wLA6qUz7TqtXrKr5rG6rmlz1S8BAvMEBIB5M3/d8epl+zYErK7nNZAHECBAoIGAANBgSBVLXL10n4aA1XVUtFYTAQIEIgQEgAjVIc9cvXzvhoDV5w8ZmzYJECDwQ0AAcBFeCaxewldDwOpzXyH4MgECBBoKCAANh1at5NXL+KsQsPq8ap7qIUCAQIaAAJChPOCM1Uv5sxCw+pwBo9EiAQIEPhQYFQC++s3SHXknsHo5/zqv1c9/161vEyBAoLeAANB7fuWqX72kf4aA1c8tB6cgAgQIJAsIAMngE46zrCdMWY8ECHQXEAC6T7Bo/UJA0cEoiwABAn8LCACuQpiAEBBG68EECBB4LSAAvCb0gN8JCAHuBwECBGoKCAA153JUVULAUePUDAEChwiMCQD+E8C9N1YI2OvvdAIECPwqIAC4E2kCQkAatYMIECDwpYAA8CWRD6wUEAJWanoWAQIEngsIAM/tfPOhgBDwEM7XCBAgsFBAAFiI6VHXBYSA61Y+SYAAgQgBASBC1TM/FbD4XQ4CBAjUEBgRAPwXALmXzZLP9XYaAQIEnggIAE/UfOebJe8SECBAoLeAANB7fuHVW/ThxA4gQIDAFgEBYAt7rUMt+VrzUA0BAgQyBASADOUiZ1j0RQahDAIECBQQEAAKDGFlCZb8Sk3PIkCAwLkCAkDD2VryDYemZAIECBQTOD4AdP5PAC36Yj8tyiFAgMBBAgLA5mFa8psH4HgCBAgMFRAAkgZv0SdBO4YAAQIELgkIAJeYrn3Ikr/m5FMECBAgsF9AALg5A0v+JpiPEyBAgEBJAQHgk7FY9CXvq6IIECBAYJHA6ABgyS+6RR5DgAABAu0Ejg8A7SaiYAIECBAgkCAgACQgO4IAAQIECFQTEACqTUQ9BAgQIEAgQUAASEB2BAECBAgQqCYgAFSbiHoIECBAgECCgACQgOwIAgQIECBQTUAAqDYR9RAgQIAAgQQBASAB2REECBAgQKCagABQbSLqIUCAAAECCQICQAKyIwgQIECAQDUBAaDaRNRDgAABAgQSBASABGRHECBAgACBagICQLWJqIcAAQIECCQICAAJyI4gQIAAAQLVBASAahNRDwECBAgQSBAQABKQHUGAAAECBKoJCADVJqIeAgQIECCQICAAJCA7ggABAgQIVBMQAKpNRD0ECBAgQCBBQABIQHYEAQIECBCoJiAAVJuIeggQIECAQIKAAJCA7AgCBAgQIFBNQACoNhH1ECBAgACBBAEBIAHZEQQIECBAoJqAAFBtIuohQIAAAQIJAgJAArIjCBAgQIBANQEBoNpE1EOAAAECBBIEBIAEZEcQIECAAIFqAgJAtYmohwABAgQIJAgIAAnIjiBAgAABAtUEBIBqE1EPAQIECBBIEBAAEpAdQYAAAQIEqgkIANUmoh4CBAgQIJAgIAAkIDuCAAECBAhUExAAqk1EPQQIECBAIEFAAEhAdgQBAgQIEKgmIABUm4h6CBAgQIBAgoAAkIDsCAIECBAgUE1AAKg2EfUQIECAAIEEAQEgAdkRBAgQIECgmoAAUG0i6iFAgAABAgkCAkACsiMIECBAgEA1AQGg2kTUQ4AAAQIEEgQEgARkRxAgQIAAgWoCAkC1iaiHAAECBAgkCAgACciOIECAAAEC1QQEgGoTUQ8BAgQIEEgQEAASkB1BgAABAgSqCQgA1SaiHgIECBAgkCAgACQgO4IAAQIECFQTEACqTUQ9BAgQIEAgQUAASEB2BAECBAgQqCYgAFSbiHoIECBAgECCgACQgOwIAgQIECBQTUAAqDYR9RAgQIAAgQQBASAB2REECBAgQKCawP8BbrM+tdU1LWEAAAAASUVORK5CYII=",(function(t){ze.loadingLocks.delete(Ct.pencil)})),searchIcon:(new t.TextureLoader).load("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAMAAABrrFhUAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAALxUExURUdwTP///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9wLB8UAAAD6dFJOUwD9+gT7AwL+AfyNlpUFB/aD9RnzCSMR+fL3C63wwzOy7+l4cHlrORX4KApD7VeaG+7O8WjnJsj0CAadQGRZ4xR2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",(function(t){ze.loadingLocks.delete(Ct.search)})),shapesIcon:(new t.TextureLoader).load("data:image/png;base64,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",(function(t){ze.loadingLocks.delete(Ct.shapes)})),textureIcon:(new t.TextureLoader).load("data:image/png;base64,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",(function(t){ze.loadingLocks.delete(Ct.texture)})),trashIcon:(new t.TextureLoader).load("data:image/png;base64,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",(function(t){ze.loadingLocks.delete(Ct.trash)})),undoIcon:(new t.TextureLoader).load("data:image/png;base64,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",(function(t){ze.loadingLocks.delete(Ct.undo)})),redoIcon:(new t.TextureLoader).load("data:image/png;base64,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",(function(t){ze.loadingLocks.delete(Ct.redo)})),videoIcon:(new t.TextureLoader).load("data:image/png;base64,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",(function(t){ze.loadingLocks.delete(Ct.video)})),blackPixel:(new t.TextureLoader).load("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAAAAAA6fptVAAAACXBIWXMAAAsTAAALEwEAmpwYAAAACklEQVQIHWNgAAAAAgABz8g15QAAAABJRU5ErkJggg==",(function(t){ze.loadingLocks.delete(Bt)}))},Et={defaultMeshMaterial:new t.MeshLambertMaterial({color:65280,side:t.DoubleSide})},St={black:new t.Color(0),green:new t.Color(65280),red:new t.Color(16711680),white:new t.Color(16777215),yellow:new t.Color(16776960),defaultIdle:new t.Color(9868950),defaultHovered:new t.Color(4408907),defaultMenuBackground:new t.Color(0),keyboard:new t.Color(8750469),keyboardButtonIdle:new t.Color(3552822),keyboardButtonHovered:new t.Color(1842204),keyboardButtonSelected:new t.Color(1088605)},Tt="https://cdn.jsdelivr.net/npm/msdf-fonts/build/custom/digitalbacon-OpenSans-Regular-msdf.json",xt="https://cdn.jsdelivr.net/npm/msdf-fonts/build/custom/digitalbacon-OpenSans-Regular-msdf.png",Mt={header:.03,body:.02};const Pt=[new t.Vector3,new t.Vector3,new t.Vector3],kt=new t.Vector2,Dt=new t.Euler,Qt=new t.Quaternion;let Ft=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),Rt=new t.BufferGeometry;Rt.setIndex(new t.BufferAttribute(Ft,1)),Rt.setAttribute("position",new t.Float32BufferAttribute([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3));const Lt={geometry:Rt,material:new t.LineBasicMaterial({color:St.yellow,toneMapped:!1})};const Ot=new Set;for(let t of" 1234567890`~!@#$%^&*()-_=+[]{}\\|;:'\",.<>/?qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM")Ot.add(t);function fillReverseMap(t,i){for(let r in t)i[t[r]]=r}const Ut={Multiply:t.MultiplyOperation,Mix:t.MixOperation,Add:t.AddOperation},Nt={Reflection:t.CubeReflectionMapping,Refraction:t.CubeRefractionMapping},Ht={Tangent:t.TangentSpaceNormalMap,Object:t.ObjectSpaceNormalMap},Gt={"Front Side":t.FrontSide,"Back Side":t.BackSide,"Both Sides":t.DoubleSide},jt={Clamp:t.ClampToEdgeWrapping,Repeat:t.RepeatWrapping,Mirrored:t.MirroredRepeatWrapping},zt={},Vt={},Yt={},Wt={},Xt={};function toTrianglesDrawMode(t,A){if(A===i)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),t;if(A===r||A===d){let i=t.getIndex();if(null===i){const r=[],d=t.getAttribute("position");if(void 0===d)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),t;for(let t=0;t<d.count;t++)r.push(t);t.setIndex(r),i=t.getIndex()}const d=i.count-2,g=[];if(A===r)for(let t=1;t<=d;t++)g.push(i.getX(0)),g.push(i.getX(t)),g.push(i.getX(t+1));else for(let t=0;t<d;t++)t%2==0?(g.push(i.getX(t)),g.push(i.getX(t+1)),g.push(i.getX(t+2))):(g.push(i.getX(t+2)),g.push(i.getX(t+1)),g.push(i.getX(t)));g.length/3!==d&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const b=t.clone();return b.setIndex(g),b.clearGroups(),b}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",A),t}fillReverseMap(Ut,zt),fillReverseMap(Nt,Vt),fillReverseMap(Ht,Yt),fillReverseMap(Gt,Wt),fillReverseMap(jt,Xt);class GLTFLoader extends b{constructor(t){super(t),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register((function(t){return new GLTFMaterialsClearcoatExtension(t)})),this.register((function(t){return new GLTFTextureBasisUExtension(t)})),this.register((function(t){return new GLTFTextureWebPExtension(t)})),this.register((function(t){return new GLTFTextureAVIFExtension(t)})),this.register((function(t){return new GLTFMaterialsSheenExtension(t)})),this.register((function(t){return new GLTFMaterialsTransmissionExtension(t)})),this.register((function(t){return new GLTFMaterialsVolumeExtension(t)})),this.register((function(t){return new GLTFMaterialsIorExtension(t)})),this.register((function(t){return new GLTFMaterialsEmissiveStrengthExtension(t)})),this.register((function(t){return new GLTFMaterialsSpecularExtension(t)})),this.register((function(t){return new GLTFMaterialsIridescenceExtension(t)})),this.register((function(t){return new GLTFLightsExtension(t)})),this.register((function(t){return new GLTFMeshoptCompression(t)})),this.register((function(t){return new GLTFMeshGpuInstancing(t)}))}load(t,i,r,d){const A=this;let g;g=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:I.extractUrlBase(t),this.manager.itemStart(t);const _onError=function(i){d?d(i):console.error(i),A.manager.itemError(t),A.manager.itemEnd(t)},b=new w(this.manager);b.setPath(this.path),b.setResponseType("arraybuffer"),b.setRequestHeader(this.requestHeader),b.setWithCredentials(this.withCredentials),b.load(t,(function(r){try{A.parse(r,g,(function(r){i(r),A.manager.itemEnd(t)}),_onError)}catch(t){_onError(t)}}),r,_onError)}setDRACOLoader(t){return this.dracoLoader=t,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(t){return this.ktx2Loader=t,this}setMeshoptDecoder(t){return this.meshoptDecoder=t,this}register(t){return-1===this.pluginCallbacks.indexOf(t)&&this.pluginCallbacks.push(t),this}unregister(t){return-1!==this.pluginCallbacks.indexOf(t)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(t),1),this}parse(t,i,r,d){let A;const g={},b={},I=new TextDecoder;if("string"==typeof t)A=JSON.parse(t);else if(t instanceof ArrayBuffer){if(I.decode(new Uint8Array(t,0,4))===Zt){try{g[Kt.KHR_BINARY_GLTF]=new GLTFBinaryExtension(t)}catch(t){return void(d&&d(t))}A=JSON.parse(g[Kt.KHR_BINARY_GLTF].content)}else A=JSON.parse(I.decode(t))}else A=t;if(void 0===A.asset||A.asset.version[0]<2)return void(d&&d(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const w=new GLTFParser(A,{path:i||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});w.fileLoader.setRequestHeader(this.requestHeader);for(let t=0;t<this.pluginCallbacks.length;t++){const i=this.pluginCallbacks[t](w);b[i.name]=i,g[i.name]=!0}if(A.extensionsUsed)for(let t=0;t<A.extensionsUsed.length;++t){const i=A.extensionsUsed[t],r=A.extensionsRequired||[];switch(i){case Kt.KHR_MATERIALS_UNLIT:g[i]=new GLTFMaterialsUnlitExtension;break;case Kt.KHR_DRACO_MESH_COMPRESSION:g[i]=new GLTFDracoMeshCompressionExtension(A,this.dracoLoader);break;case Kt.KHR_TEXTURE_TRANSFORM:g[i]=new GLTFTextureTransformExtension;break;case Kt.KHR_MESH_QUANTIZATION:g[i]=new GLTFMeshQuantizationExtension;break;default:r.indexOf(i)>=0&&void 0===b[i]&&console.warn('THREE.GLTFLoader: Unknown extension "'+i+'".')}}w.setExtensions(g),w.setPlugins(b),w.parse(r,d)}parseAsync(t,i){const r=this;return new Promise((function(d,A){r.parse(t,i,d,A)}))}}function GLTFRegistry(){let t={};return{get:function(i){return t[i]},add:function(i,r){t[i]=r},remove:function(i){delete t[i]},removeAll:function(){t={}}}}const Kt={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class GLTFLightsExtension{constructor(t){this.parser=t,this.name=Kt.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const t=this.parser,i=this.parser.json.nodes||[];for(let r=0,d=i.length;r<d;r++){const d=i[r];d.extensions&&d.extensions[this.name]&&void 0!==d.extensions[this.name].light&&t._addNodeRef(this.cache,d.extensions[this.name].light)}}_loadLight(t){const i=this.parser,r="light:"+t;let d=i.cache.get(r);if(d)return d;const A=i.json,g=((A.extensions&&A.extensions[this.name]||{}).lights||[])[t];let b;const I=new C(16777215);void 0!==g.color&&I.fromArray(g.color);const w=void 0!==g.range?g.range:0;switch(g.type){case"directional":b=new T(I),b.target.position.set(0,0,-1),b.add(b.target);break;case"point":b=new S(I),b.distance=w;break;case"spot":b=new B(I),b.distance=w,g.spot=g.spot||{},g.spot.innerConeAngle=void 0!==g.spot.innerConeAngle?g.spot.innerConeAngle:0,g.spot.outerConeAngle=void 0!==g.spot.outerConeAngle?g.spot.outerConeAngle:Math.PI/4,b.angle=g.spot.outerConeAngle,b.penumbra=1-g.spot.innerConeAngle/g.spot.outerConeAngle,b.target.position.set(0,0,-1),b.add(b.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+g.type)}return b.position.set(0,0,0),b.decay=2,assignExtrasToUserData(b,g),void 0!==g.intensity&&(b.intensity=g.intensity),b.name=i.createUniqueName(g.name||"light_"+t),d=Promise.resolve(b),i.cache.add(r,d),d}getDependency(t,i){if("light"===t)return this._loadLight(i)}createNodeAttachment(t){const i=this,r=this.parser,d=r.json.nodes[t],A=(d.extensions&&d.extensions[this.name]||{}).light;return void 0===A?null:this._loadLight(A).then((function(t){return r._getNodeRef(i.cache,A,t)}))}}class GLTFMaterialsUnlitExtension{constructor(){this.name=Kt.KHR_MATERIALS_UNLIT}getMaterialType(){return x}extendParams(t,i,r){const d=[];t.color=new C(1,1,1),t.opacity=1;const A=i.pbrMetallicRoughness;if(A){if(Array.isArray(A.baseColorFactor)){const i=A.baseColorFactor;t.color.fromArray(i),t.opacity=i[3]}void 0!==A.baseColorTexture&&d.push(r.assignTexture(t,"map",A.baseColorTexture,M))}return Promise.all(d)}}class GLTFMaterialsEmissiveStrengthExtension{constructor(t){this.parser=t,this.name=Kt.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(t,i){const r=this.parser.json.materials[t];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const d=r.extensions[this.name].emissiveStrength;return void 0!==d&&(i.emissiveIntensity=d),Promise.resolve()}}class GLTFMaterialsClearcoatExtension{constructor(t){this.parser=t,this.name=Kt.KHR_MATERIALS_CLEARCOAT}getMaterialType(t){const i=this.parser.json.materials[t];return i.extensions&&i.extensions[this.name]?P:null}extendMaterialParams(t,i){const r=this.parser,d=r.json.materials[t];if(!d.extensions||!d.extensions[this.name])return Promise.resolve();const A=[],g=d.extensions[this.name];if(void 0!==g.clearcoatFactor&&(i.clearcoat=g.clearcoatFactor),void 0!==g.clearcoatTexture&&A.push(r.assignTexture(i,"clearcoatMap",g.clearcoatTexture)),void 0!==g.clearcoatRoughnessFactor&&(i.clearcoatRoughness=g.clearcoatRoughnessFactor),void 0!==g.clearcoatRoughnessTexture&&A.push(r.assignTexture(i,"clearcoatRoughnessMap",g.clearcoatRoughnessTexture)),void 0!==g.clearcoatNormalTexture&&(A.push(r.assignTexture(i,"clearcoatNormalMap",g.clearcoatNormalTexture)),void 0!==g.clearcoatNormalTexture.scale)){const t=g.clearcoatNormalTexture.scale;i.clearcoatNormalScale=new D(t,t)}return Promise.all(A)}}class GLTFMaterialsIridescenceExtension{constructor(t){this.parser=t,this.name=Kt.KHR_MATERIALS_IRIDESCENCE}getMaterialType(t){const i=this.parser.json.materials[t];return i.extensions&&i.extensions[this.name]?P:null}extendMaterialParams(t,i){const r=this.parser,d=r.json.materials[t];if(!d.extensions||!d.extensions[this.name])return Promise.resolve();const A=[],g=d.extensions[this.name];return void 0!==g.iridescenceFactor&&(i.iridescence=g.iridescenceFactor),void 0!==g.iridescenceTexture&&A.push(r.assignTexture(i,"iridescenceMap",g.iridescenceTexture)),void 0!==g.iridescenceIor&&(i.iridescenceIOR=g.iridescenceIor),void 0===i.iridescenceThicknessRange&&(i.iridescenceThicknessRange=[100,400]),void 0!==g.iridescenceThicknessMinimum&&(i.iridescenceThicknessRange[0]=g.iridescenceThicknessMinimum),void 0!==g.iridescenceThicknessMaximum&&(i.iridescenceThicknessRange[1]=g.iridescenceThicknessMaximum),void 0!==g.iridescenceThicknessTexture&&A.push(r.assignTexture(i,"iridescenceThicknessMap",g.iridescenceThicknessTexture)),Promise.all(A)}}class GLTFMaterialsSheenExtension{constructor(t){this.parser=t,this.name=Kt.KHR_MATERIALS_SHEEN}getMaterialType(t){const i=this.parser.json.materials[t];return i.extensions&&i.extensions[this.name]?P:null}extendMaterialParams(t,i){const r=this.parser,d=r.json.materials[t];if(!d.extensions||!d.extensions[this.name])return Promise.resolve();const A=[];i.sheenColor=new C(0,0,0),i.sheenRoughness=0,i.sheen=1;const g=d.extensions[this.name];return void 0!==g.sheenColorFactor&&i.sheenColor.fromArray(g.sheenColorFactor),void 0!==g.sheenRoughnessFactor&&(i.sheenRoughness=g.sheenRoughnessFactor),void 0!==g.sheenColorTexture&&A.push(r.assignTexture(i,"sheenColorMap",g.sheenColorTexture,M)),void 0!==g.sheenRoughnessTexture&&A.push(r.assignTexture(i,"sheenRoughnessMap",g.sheenRoughnessTexture)),Promise.all(A)}}class GLTFMaterialsTransmissionExtension{constructor(t){this.parser=t,this.name=Kt.KHR_MATERIALS_TRANSMISSION}getMaterialType(t){const i=this.parser.json.materials[t];return i.extensions&&i.extensions[this.name]?P:null}extendMaterialParams(t,i){const r=this.parser,d=r.json.materials[t];if(!d.extensions||!d.extensions[this.name])return Promise.resolve();const A=[],g=d.extensions[this.name];return void 0!==g.transmissionFactor&&(i.transmission=g.transmissionFactor),void 0!==g.transmissionTexture&&A.push(r.assignTexture(i,"transmissionMap",g.transmissionTexture)),Promise.all(A)}}class GLTFMaterialsVolumeExtension{constructor(t){this.parser=t,this.name=Kt.KHR_MATERIALS_VOLUME}getMaterialType(t){const i=this.parser.json.materials[t];return i.extensions&&i.extensions[this.name]?P:null}extendMaterialParams(t,i){const r=this.parser,d=r.json.materials[t];if(!d.extensions||!d.extensions[this.name])return Promise.resolve();const A=[],g=d.extensions[this.name];i.thickness=void 0!==g.thicknessFactor?g.thicknessFactor:0,void 0!==g.thicknessTexture&&A.push(r.assignTexture(i,"thicknessMap",g.thicknessTexture)),i.attenuationDistance=g.attenuationDistance||1/0;const b=g.attenuationColor||[1,1,1];return i.attenuationColor=new C(b[0],b[1],b[2]),Promise.all(A)}}class GLTFMaterialsIorExtension{constructor(t){this.parser=t,this.name=Kt.KHR_MATERIALS_IOR}getMaterialType(t){const i=this.parser.json.materials[t];return i.extensions&&i.extensions[this.name]?P:null}extendMaterialParams(t,i){const r=this.parser.json.materials[t];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();const d=r.extensions[this.name];return i.ior=void 0!==d.ior?d.ior:1.5,Promise.resolve()}}class GLTFMaterialsSpecularExtension{constructor(t){this.parser=t,this.name=Kt.KHR_MATERIALS_SPECULAR}getMaterialType(t){const i=this.parser.json.materials[t];return i.extensions&&i.extensions[this.name]?P:null}extendMaterialParams(t,i){const r=this.parser,d=r.json.materials[t];if(!d.extensions||!d.extensions[this.name])return Promise.resolve();const A=[],g=d.extensions[this.name];i.specularIntensity=void 0!==g.specularFactor?g.specularFactor:1,void 0!==g.specularTexture&&A.push(r.assignTexture(i,"specularIntensityMap",g.specularTexture));const b=g.specularColorFactor||[1,1,1];return i.specularColor=new C(b[0],b[1],b[2]),void 0!==g.specularColorTexture&&A.push(r.assignTexture(i,"specularColorMap",g.specularColorTexture,M)),Promise.all(A)}}class GLTFTextureBasisUExtension{constructor(t){this.parser=t,this.name=Kt.KHR_TEXTURE_BASISU}loadTexture(t){const i=this.parser,r=i.json,d=r.textures[t];if(!d.extensions||!d.extensions[this.name])return null;const A=d.extensions[this.name],g=i.options.ktx2Loader;if(!g){if(r.extensionsRequired&&r.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return i.loadTextureImage(t,A.source,g)}}class GLTFTextureWebPExtension{constructor(t){this.parser=t,this.name=Kt.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(t){const i=this.name,r=this.parser,d=r.json,A=d.textures[t];if(!A.extensions||!A.extensions[i])return null;const g=A.extensions[i],b=d.images[g.source];let I=r.textureLoader;if(b.uri){const t=r.options.manager.getHandler(b.uri);null!==t&&(I=t)}return this.detectSupport().then((function(A){if(A)return r.loadTextureImage(t,g.source,I);if(d.extensionsRequired&&d.extensionsRequired.indexOf(i)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return r.loadTexture(t)}))}detectSupport(){return this.isSupported||(this.isSupported=new Promise((function(t){const i=new Image;i.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",i.onload=i.onerror=function(){t(1===i.height)}}))),this.isSupported}}class GLTFTextureAVIFExtension{constructor(t){this.parser=t,this.name=Kt.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(t){const i=this.name,r=this.parser,d=r.json,A=d.textures[t];if(!A.extensions||!A.extensions[i])return null;const g=A.extensions[i],b=d.images[g.source];let I=r.textureLoader;if(b.uri){const t=r.options.manager.getHandler(b.uri);null!==t&&(I=t)}return this.detectSupport().then((function(A){if(A)return r.loadTextureImage(t,g.source,I);if(d.extensionsRequired&&d.extensionsRequired.indexOf(i)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return r.loadTexture(t)}))}detectSupport(){return this.isSupported||(this.isSupported=new Promise((function(t){const i=new Image;i.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",i.onload=i.onerror=function(){t(1===i.height)}}))),this.isSupported}}class GLTFMeshoptCompression{constructor(t){this.name=Kt.EXT_MESHOPT_COMPRESSION,this.parser=t}loadBufferView(t){const i=this.parser.json,r=i.bufferViews[t];if(r.extensions&&r.extensions[this.name]){const t=r.extensions[this.name],d=this.parser.getDependency("buffer",t.buffer),A=this.parser.options.meshoptDecoder;if(!A||!A.supported){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return d.then((function(i){const r=t.byteOffset||0,d=t.byteLength||0,g=t.count,b=t.byteStride,I=new Uint8Array(i,r,d);return A.decodeGltfBufferAsync?A.decodeGltfBufferAsync(g,b,I,t.mode,t.filter).then((function(t){return t.buffer})):A.ready.then((function(){const i=new ArrayBuffer(g*b);return A.decodeGltfBuffer(new Uint8Array(i),g,b,I,t.mode,t.filter),i}))}))}return null}}class GLTFMeshGpuInstancing{constructor(t){this.name=Kt.EXT_MESH_GPU_INSTANCING,this.parser=t}createNodeMesh(t){const i=this.parser.json,r=i.nodes[t];if(!r.extensions||!r.extensions[this.name]||void 0===r.mesh)return null;const d=i.meshes[r.mesh];for(const t of d.primitives)if(t.mode!==ei.TRIANGLES&&t.mode!==ei.TRIANGLE_STRIP&&t.mode!==ei.TRIANGLE_FAN&&void 0!==t.mode)return null;const b=r.extensions[this.name].attributes,I=[],w={};for(const t in b)I.push(this.parser.getDependency("accessor",b[t]).then((i=>(w[t]=i,w[t]))));return I.length<1?null:(I.push(this.parser.createNodeMesh(t)),Promise.all(I).then((t=>{const i=t.pop(),r=i.isGroup?i.children:[i],d=t[0].count,b=[];for(const t of r){const i=new g,r=new Q,I=new A,C=new Q(1,1,1),B=new F(t.geometry,t.material,d);for(let t=0;t<d;t++)w.TRANSLATION&&r.fromBufferAttribute(w.TRANSLATION,t),w.ROTATION&&I.fromBufferAttribute(w.ROTATION,t),w.SCALE&&C.fromBufferAttribute(w.SCALE,t),B.setMatrixAt(t,i.compose(r,I,C));for(const i in w)"TRANSLATION"!==i&&"ROTATION"!==i&&"SCALE"!==i&&t.geometry.setAttribute(i,w[i]);R.prototype.copy.call(B,t),this.parser.assignFinalMaterial(B),b.push(B)}return i.isGroup?(i.clear(),i.add(...b),i):b[0]})))}}const Zt="glTF",qt=1313821514,Jt=5130562;class GLTFBinaryExtension{constructor(t){this.name=Kt.KHR_BINARY_GLTF,this.content=null,this.body=null;const i=new DataView(t,0,12),r=new TextDecoder;if(this.header={magic:r.decode(new Uint8Array(t.slice(0,4))),version:i.getUint32(4,!0),length:i.getUint32(8,!0)},this.header.magic!==Zt)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const d=this.header.length-12,A=new DataView(t,12);let g=0;for(;g<d;){const i=A.getUint32(g,!0);g+=4;const d=A.getUint32(g,!0);if(g+=4,d===qt){const d=new Uint8Array(t,12+g,i);this.content=r.decode(d)}else if(d===Jt){const r=12+g;this.body=t.slice(r,r+i)}g+=i}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class GLTFDracoMeshCompressionExtension{constructor(t,i){if(!i)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Kt.KHR_DRACO_MESH_COMPRESSION,this.json=t,this.dracoLoader=i,this.dracoLoader.preload()}decodePrimitive(t,i){const r=this.json,d=this.dracoLoader,A=t.extensions[this.name].bufferView,g=t.extensions[this.name].attributes,b={},I={},w={};for(const t in g){const i=ri[t]||t.toLowerCase();b[i]=g[t]}for(const i in t.attributes){const d=ri[i]||i.toLowerCase();if(void 0!==g[i]){const A=r.accessors[t.attributes[i]],g=ti[A.componentType];w[d]=g.name,I[d]=!0===A.normalized}}return i.getDependency("bufferView",A).then((function(t){return new Promise((function(i){d.decodeDracoFile(t,(function(t){for(const i in t.attributes){const r=t.attributes[i],d=I[i];void 0!==d&&(r.normalized=d)}i(t)}),b,w)}))}))}}class GLTFTextureTransformExtension{constructor(){this.name=Kt.KHR_TEXTURE_TRANSFORM}extendTexture(t,i){return void 0!==i.texCoord&&i.texCoord!==t.channel||void 0!==i.offset||void 0!==i.rotation||void 0!==i.scale?(t=t.clone(),void 0!==i.texCoord&&(t.channel=i.texCoord),void 0!==i.offset&&t.offset.fromArray(i.offset),void 0!==i.rotation&&(t.rotation=i.rotation),void 0!==i.scale&&t.repeat.fromArray(i.scale),t.needsUpdate=!0,t):t}}class GLTFMeshQuantizationExtension{constructor(){this.name=Kt.KHR_MESH_QUANTIZATION}}class GLTFCubicSplineInterpolant extends Te{constructor(t,i,r,d){super(t,i,r,d)}copySampleValue_(t){const i=this.resultBuffer,r=this.sampleValues,d=this.valueSize,A=t*d*3+d;for(let t=0;t!==d;t++)i[t]=r[A+t];return i}interpolate_(t,i,r,d){const A=this.resultBuffer,g=this.sampleValues,b=this.valueSize,I=2*b,w=3*b,C=d-i,B=(r-i)/C,S=B*B,T=S*B,x=t*w,M=x-w,P=-2*T+3*S,D=T-S,Q=1-P,F=D-S+B;for(let t=0;t!==b;t++){const i=g[M+t+b],r=g[M+t+I]*C,d=g[x+t+b],w=g[x+t]*C;A[t]=Q*i+F*r+P*d+D*w}return A}}const $t=new A;class GLTFCubicSplineQuaternionInterpolant extends GLTFCubicSplineInterpolant{interpolate_(t,i,r,d){const A=super.interpolate_(t,i,r,d);return $t.fromArray(A).normalize().toArray(A),A}}const ei={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},ti={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},ii={9728:pe,9729:G,9984:ge,9985:me,9986:_e,9987:j},si={33071:fe,33648:be,10497:V},ni={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},ri={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},ai={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},oi={CUBICSPLINE:void 0,LINEAR:ce,STEP:Ie},li="OPAQUE",hi="MASK",di="BLEND";function addUnknownExtensionsToUserData(t,i,r){for(const d in r.extensions)void 0===t[d]&&(i.userData.gltfExtensions=i.userData.gltfExtensions||{},i.userData.gltfExtensions[d]=r.extensions[d])}function assignExtrasToUserData(t,i){void 0!==i.extras&&("object"==typeof i.extras?Object.assign(t.userData,i.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+i.extras))}function updateMorphTargets(t,i){if(t.updateMorphTargets(),void 0!==i.weights)for(let r=0,d=i.weights.length;r<d;r++)t.morphTargetInfluences[r]=i.weights[r];if(i.extras&&Array.isArray(i.extras.targetNames)){const r=i.extras.targetNames;if(t.morphTargetInfluences.length===r.length){t.morphTargetDictionary={};for(let i=0,d=r.length;i<d;i++)t.morphTargetDictionary[r[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function createPrimitiveKey(t){const i=t.extensions&&t.extensions[Kt.KHR_DRACO_MESH_COMPRESSION];let r;return r=i?"draco:"+i.bufferView+":"+i.indices+":"+createAttributesKey(i.attributes):t.indices+":"+createAttributesKey(t.attributes)+":"+t.mode,r}function createAttributesKey(t){let i="";const r=Object.keys(t).sort();for(let d=0,A=r.length;d<A;d++)i+=r[d]+":"+t[r[d]]+";";return i}function getNormalizedComponentScale(t){switch(t){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}const ci=new g;class GLTFParser{constructor(t={},i={}){this.json=t,this.extensions={},this.plugins={},this.options=i,this.cache=new GLTFRegistry,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let r=!1,d=!1,A=-1;"undefined"!=typeof navigator&&(r=!0===/^((?!chrome|android).)*safari/i.test(navigator.userAgent),d=navigator.userAgent.indexOf("Firefox")>-1,A=d?navigator.userAgent.match(/Firefox\/([0-9]+)\./)[1]:-1),"undefined"==typeof createImageBitmap||r||d&&A<98?this.textureLoader=new L(this.options.manager):this.textureLoader=new O(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new w(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(t){this.extensions=t}setPlugins(t){this.plugins=t}parse(t,i){const r=this,d=this.json,A=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll((function(t){return t._markDefs&&t._markDefs()})),Promise.all(this._invokeAll((function(t){return t.beforeRoot&&t.beforeRoot()}))).then((function(){return Promise.all([r.getDependencies("scene"),r.getDependencies("animation"),r.getDependencies("camera")])})).then((function(i){const g={scene:i[0][d.scene||0],scenes:i[0],animations:i[1],cameras:i[2],asset:d.asset,parser:r,userData:{}};addUnknownExtensionsToUserData(A,g,d),assignExtrasToUserData(g,d),Promise.all(r._invokeAll((function(t){return t.afterRoot&&t.afterRoot(g)}))).then((function(){t(g)}))})).catch(i)}_markDefs(){const t=this.json.nodes||[],i=this.json.skins||[],r=this.json.meshes||[];for(let r=0,d=i.length;r<d;r++){const d=i[r].joints;for(let i=0,r=d.length;i<r;i++)t[d[i]].isBone=!0}for(let i=0,d=t.length;i<d;i++){const d=t[i];void 0!==d.mesh&&(this._addNodeRef(this.meshCache,d.mesh),void 0!==d.skin&&(r[d.mesh].isSkinnedMesh=!0)),void 0!==d.camera&&this._addNodeRef(this.cameraCache,d.camera)}}_addNodeRef(t,i){void 0!==i&&(void 0===t.refs[i]&&(t.refs[i]=t.uses[i]=0),t.refs[i]++)}_getNodeRef(t,i,r){if(t.refs[i]<=1)return r;const d=r.clone(),updateMappings=(t,i)=>{const r=this.associations.get(t);null!=r&&this.associations.set(i,r);for(const[r,d]of t.children.entries())updateMappings(d,i.children[r])};return updateMappings(r,d),d.name+="_instance_"+t.uses[i]++,d}_invokeOne(t){const i=Object.values(this.plugins);i.push(this);for(let r=0;r<i.length;r++){const d=t(i[r]);if(d)return d}return null}_invokeAll(t){const i=Object.values(this.plugins);i.unshift(this);const r=[];for(let d=0;d<i.length;d++){const A=t(i[d]);A&&r.push(A)}return r}getDependency(t,i){const r=t+":"+i;let d=this.cache.get(r);if(!d){switch(t){case"scene":d=this.loadScene(i);break;case"node":d=this._invokeOne((function(t){return t.loadNode&&t.loadNode(i)}));break;case"mesh":d=this._invokeOne((function(t){return t.loadMesh&&t.loadMesh(i)}));break;case"accessor":d=this.loadAccessor(i);break;case"bufferView":d=this._invokeOne((function(t){return t.loadBufferView&&t.loadBufferView(i)}));break;case"buffer":d=this.loadBuffer(i);break;case"material":d=this._invokeOne((function(t){return t.loadMaterial&&t.loadMaterial(i)}));break;case"texture":d=this._invokeOne((function(t){return t.loadTexture&&t.loadTexture(i)}));break;case"skin":d=this.loadSkin(i);break;case"animation":d=this._invokeOne((function(t){return t.loadAnimation&&t.loadAnimation(i)}));break;case"camera":d=this.loadCamera(i);break;default:if(d=this._invokeOne((function(r){return r!=this&&r.getDependency&&r.getDependency(t,i)})),!d)throw new Error("Unknown type: "+t)}this.cache.add(r,d)}return d}getDependencies(t){let i=this.cache.get(t);if(!i){const r=this,d=this.json[t+("mesh"===t?"es":"s")]||[];i=Promise.all(d.map((function(i,d){return r.getDependency(t,d)}))),this.cache.add(t,i)}return i}loadBuffer(t){const i=this.json.buffers[t],r=this.fileLoader;if(i.type&&"arraybuffer"!==i.type)throw new Error("THREE.GLTFLoader: "+i.type+" buffer type is not supported.");if(void 0===i.uri&&0===t)return Promise.resolve(this.extensions[Kt.KHR_BINARY_GLTF].body);const d=this.options;return new Promise((function(t,A){r.load(I.resolveURL(i.uri,d.path),t,void 0,(function(){A(new Error('THREE.GLTFLoader: Failed to load buffer "'+i.uri+'".'))}))}))}loadBufferView(t){const i=this.json.bufferViews[t];return this.getDependency("buffer",i.buffer).then((function(t){const r=i.byteLength||0,d=i.byteOffset||0;return t.slice(d,d+r)}))}loadAccessor(t){const i=this,r=this.json,d=this.json.accessors[t];if(void 0===d.bufferView&&void 0===d.sparse){const t=ni[d.type],i=ti[d.componentType],r=!0===d.normalized,A=new i(d.count*t);return Promise.resolve(new U(A,t,r))}const A=[];return void 0!==d.bufferView?A.push(this.getDependency("bufferView",d.bufferView)):A.push(null),void 0!==d.sparse&&(A.push(this.getDependency("bufferView",d.sparse.indices.bufferView)),A.push(this.getDependency("bufferView",d.sparse.values.bufferView))),Promise.all(A).then((function(t){const A=t[0],g=ni[d.type],b=ti[d.componentType],I=b.BYTES_PER_ELEMENT,w=I*g,C=d.byteOffset||0,B=void 0!==d.bufferView?r.bufferViews[d.bufferView].byteStride:void 0,S=!0===d.normalized;let T,x;if(B&&B!==w){const t=Math.floor(C/B),r="InterleavedBuffer:"+d.bufferView+":"+d.componentType+":"+t+":"+d.count;let w=i.cache.get(r);w||(T=new b(A,t*B,d.count*B/I),w=new N(T,B/I),i.cache.add(r,w)),x=new H(w,g,C%B/I,S)}else T=null===A?new b(d.count*g):new b(A,C,d.count*g),x=new U(T,g,S);if(void 0!==d.sparse){const i=ni.SCALAR,r=ti[d.sparse.indices.componentType],I=d.sparse.indices.byteOffset||0,w=d.sparse.values.byteOffset||0,C=new r(t[1],I,d.sparse.count*i),B=new b(t[2],w,d.sparse.count*g);null!==A&&(x=new U(x.array.slice(),x.itemSize,x.normalized));for(let t=0,i=C.length;t<i;t++){const i=C[t];if(x.setX(i,B[t*g]),g>=2&&x.setY(i,B[t*g+1]),g>=3&&x.setZ(i,B[t*g+2]),g>=4&&x.setW(i,B[t*g+3]),g>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return x}))}loadTexture(t){const i=this.json,r=this.options,d=i.textures[t].source,A=i.images[d];let g=this.textureLoader;if(A.uri){const t=r.manager.getHandler(A.uri);null!==t&&(g=t)}return this.loadTextureImage(t,d,g)}loadTextureImage(t,i,r){const d=this,A=this.json,g=A.textures[t],b=A.images[i],I=(b.uri||b.bufferView)+":"+g.sampler;if(this.textureCache[I])return this.textureCache[I];const w=this.loadImageSource(i,r).then((function(i){i.flipY=!1,i.name=g.name||b.name||"",""===i.name&&"string"==typeof b.uri&&!1===b.uri.startsWith("data:image/")&&(i.name=b.uri);const r=(A.samplers||{})[g.sampler]||{};return i.magFilter=ii[r.magFilter]||G,i.minFilter=ii[r.minFilter]||j,i.wrapS=si[r.wrapS]||V,i.wrapT=si[r.wrapT]||V,d.associations.set(i,{textures:t}),i})).catch((function(){return null}));return this.textureCache[I]=w,w}loadImageSource(t,i){const r=this,d=this.json,A=this.options;if(void 0!==this.sourceCache[t])return this.sourceCache[t].then((t=>t.clone()));const g=d.images[t],b=self.URL||self.webkitURL;let w=g.uri||"",C=!1;if(void 0!==g.bufferView)w=r.getDependency("bufferView",g.bufferView).then((function(t){C=!0;const i=new Blob([t],{type:g.mimeType});return w=b.createObjectURL(i),w}));else if(void 0===g.uri)throw new Error("THREE.GLTFLoader: Image "+t+" is missing URI and bufferView");const B=Promise.resolve(w).then((function(t){return new Promise((function(r,d){let g=r;!0===i.isImageBitmapLoader&&(g=function(t){const i=new ye(t);i.needsUpdate=!0,r(i)}),i.load(I.resolveURL(t,A.path),g,void 0,d)}))})).then((function(t){var i;return!0===C&&b.revokeObjectURL(w),t.userData.mimeType=g.mimeType||((i=g.uri).search(/\.jpe?g($|\?)/i)>0||0===i.search(/^data\:image\/jpeg/)?"image/jpeg":i.search(/\.webp($|\?)/i)>0||0===i.search(/^data\:image\/webp/)?"image/webp":"image/png"),t})).catch((function(t){throw console.error("THREE.GLTFLoader: Couldn't load texture",w),t}));return this.sourceCache[t]=B,B}assignTexture(t,i,r,d){const A=this;return this.getDependency("texture",r.index).then((function(g){if(!g)return null;if(void 0!==r.texCoord&&r.texCoord>0&&((g=g.clone()).channel=r.texCoord),A.extensions[Kt.KHR_TEXTURE_TRANSFORM]){const t=void 0!==r.extensions?r.extensions[Kt.KHR_TEXTURE_TRANSFORM]:void 0;if(t){const i=A.associations.get(g);g=A.extensions[Kt.KHR_TEXTURE_TRANSFORM].extendTexture(g,t),A.associations.set(g,i)}}return void 0!==d&&(g.encoding=d),t[i]=g,g}))}assignFinalMaterial(t){const i=t.geometry;let r=t.material;const d=void 0===i.attributes.tangent,A=void 0!==i.attributes.color,g=void 0===i.attributes.normal;if(t.isPoints){const t="PointsMaterial:"+r.uuid;let i=this.cache.get(t);i||(i=new Y,W.prototype.copy.call(i,r),i.color.copy(r.color),i.map=r.map,i.sizeAttenuation=!1,this.cache.add(t,i)),r=i}else if(t.isLine){const t="LineBasicMaterial:"+r.uuid;let i=this.cache.get(t);i||(i=new X,W.prototype.copy.call(i,r),i.color.copy(r.color),i.map=r.map,this.cache.add(t,i)),r=i}if(d||A||g){let t="ClonedMaterial:"+r.uuid+":";d&&(t+="derivative-tangents:"),A&&(t+="vertex-colors:"),g&&(t+="flat-shading:");let i=this.cache.get(t);i||(i=r.clone(),A&&(i.vertexColors=!0),g&&(i.flatShading=!0),d&&(i.normalScale&&(i.normalScale.y*=-1),i.clearcoatNormalScale&&(i.clearcoatNormalScale.y*=-1)),this.cache.add(t,i),this.associations.set(i,this.associations.get(r))),r=i}t.material=r}getMaterialType(){return K}loadMaterial(t){const i=this,r=this.json,d=this.extensions,A=r.materials[t];let g;const b={},I=[];if((A.extensions||{})[Kt.KHR_MATERIALS_UNLIT]){const t=d[Kt.KHR_MATERIALS_UNLIT];g=t.getMaterialType(),I.push(t.extendParams(b,A,i))}else{const r=A.pbrMetallicRoughness||{};if(b.color=new C(1,1,1),b.opacity=1,Array.isArray(r.baseColorFactor)){const t=r.baseColorFactor;b.color.fromArray(t),b.opacity=t[3]}void 0!==r.baseColorTexture&&I.push(i.assignTexture(b,"map",r.baseColorTexture,M)),b.metalness=void 0!==r.metallicFactor?r.metallicFactor:1,b.roughness=void 0!==r.roughnessFactor?r.roughnessFactor:1,void 0!==r.metallicRoughnessTexture&&(I.push(i.assignTexture(b,"metalnessMap",r.metallicRoughnessTexture)),I.push(i.assignTexture(b,"roughnessMap",r.metallicRoughnessTexture))),g=this._invokeOne((function(i){return i.getMaterialType&&i.getMaterialType(t)})),I.push(Promise.all(this._invokeAll((function(i){return i.extendMaterialParams&&i.extendMaterialParams(t,b)}))))}!0===A.doubleSided&&(b.side=Z);const w=A.alphaMode||li;if(w===di?(b.transparent=!0,b.depthWrite=!1):(b.transparent=!1,w===hi&&(b.alphaTest=void 0!==A.alphaCutoff?A.alphaCutoff:.5)),void 0!==A.normalTexture&&g!==x&&(I.push(i.assignTexture(b,"normalMap",A.normalTexture)),b.normalScale=new D(1,1),void 0!==A.normalTexture.scale)){const t=A.normalTexture.scale;b.normalScale.set(t,t)}return void 0!==A.occlusionTexture&&g!==x&&(I.push(i.assignTexture(b,"aoMap",A.occlusionTexture)),void 0!==A.occlusionTexture.strength&&(b.aoMapIntensity=A.occlusionTexture.strength)),void 0!==A.emissiveFactor&&g!==x&&(b.emissive=(new C).fromArray(A.emissiveFactor)),void 0!==A.emissiveTexture&&g!==x&&I.push(i.assignTexture(b,"emissiveMap",A.emissiveTexture,M)),Promise.all(I).then((function(){const r=new g(b);return A.name&&(r.name=A.name),assignExtrasToUserData(r,A),i.associations.set(r,{materials:t}),A.extensions&&addUnknownExtensionsToUserData(d,r,A),r}))}createUniqueName(t){const i=q.sanitizeNodeName(t||"");let r=i;for(let t=1;this.nodeNamesUsed[r];++t)r=i+"_"+t;return this.nodeNamesUsed[r]=!0,r}loadGeometries(t){const i=this,r=this.extensions,d=this.primitiveCache;function createDracoPrimitive(t){return r[Kt.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(t,i).then((function(r){return addPrimitiveAttributes(r,t,i)}))}const A=[];for(let r=0,g=t.length;r<g;r++){const g=t[r],b=createPrimitiveKey(g),I=d[b];if(I)A.push(I.promise);else{let t;t=g.extensions&&g.extensions[Kt.KHR_DRACO_MESH_COMPRESSION]?createDracoPrimitive(g):addPrimitiveAttributes(new J,g,i),d[b]={primitive:g,promise:t},A.push(t)}}return Promise.all(A)}loadMesh(t){const i=this,A=this.json,g=this.extensions,b=A.meshes[t],I=b.primitives,w=[];for(let t=0,i=I.length;t<i;t++){const i=void 0===I[t].material?(void 0===(C=this.cache).DefaultMaterial&&(C.DefaultMaterial=new K({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:we})),C.DefaultMaterial):this.getDependency("material",I[t].material);w.push(i)}var C;return w.push(i.loadGeometries(I)),Promise.all(w).then((function(A){const w=A.slice(0,A.length-1),C=A[A.length-1],B=[];for(let A=0,S=C.length;A<S;A++){const S=C[A],T=I[A];let x;const M=w[A];if(T.mode===ei.TRIANGLES||T.mode===ei.TRIANGLE_STRIP||T.mode===ei.TRIANGLE_FAN||void 0===T.mode)x=!0===b.isSkinnedMesh?new ee(S,M):new te(S,M),!0===x.isSkinnedMesh&&x.normalizeSkinWeights(),T.mode===ei.TRIANGLE_STRIP?x.geometry=toTrianglesDrawMode(x.geometry,d):T.mode===ei.TRIANGLE_FAN&&(x.geometry=toTrianglesDrawMode(x.geometry,r));else if(T.mode===ei.LINES)x=new ie(S,M);else if(T.mode===ei.LINE_STRIP)x=new se(S,M);else if(T.mode===ei.LINE_LOOP)x=new ne(S,M);else{if(T.mode!==ei.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+T.mode);x=new re(S,M)}Object.keys(x.geometry.morphAttributes).length>0&&updateMorphTargets(x,b),x.name=i.createUniqueName(b.name||"mesh_"+t),assignExtrasToUserData(x,b),T.extensions&&addUnknownExtensionsToUserData(g,x,T),i.assignFinalMaterial(x),B.push(x)}for(let r=0,d=B.length;r<d;r++)i.associations.set(B[r],{meshes:t,primitives:r});if(1===B.length)return B[0];const S=new ae;i.associations.set(S,{meshes:t});for(let t=0,i=B.length;t<i;t++)S.add(B[t]);return S}))}loadCamera(t){let i;const r=this.json.cameras[t],d=r[r.type];if(d)return"perspective"===r.type?i=new oe(le.radToDeg(d.yfov),d.aspectRatio||1,d.znear||1,d.zfar||2e6):"orthographic"===r.type&&(i=new he(-d.xmag,d.xmag,d.ymag,-d.ymag,d.znear,d.zfar)),r.name&&(i.name=this.createUniqueName(r.name)),assignExtrasToUserData(i,r),Promise.resolve(i);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(t){const i=this.json.skins[t],r=[];for(let t=0,d=i.joints.length;t<d;t++)r.push(this._loadNodeShallow(i.joints[t]));return void 0!==i.inverseBindMatrices?r.push(this.getDependency("accessor",i.inverseBindMatrices)):r.push(null),Promise.all(r).then((function(t){const r=t.pop(),d=t,A=[],b=[];for(let t=0,I=d.length;t<I;t++){const I=d[t];if(I){A.push(I);const i=new g;null!==r&&i.fromArray(r.array,16*t),b.push(i)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',i.joints[t])}return new de(A,b)}))}loadAnimation(t){const i=this.json.animations[t],r=i.name?i.name:"animation_"+t,d=[],A=[],g=[],b=[],I=[];for(let t=0,r=i.channels.length;t<r;t++){const r=i.channels[t],w=i.samplers[r.sampler],C=r.target,B=C.node,S=void 0!==i.parameters?i.parameters[w.input]:w.input,T=void 0!==i.parameters?i.parameters[w.output]:w.output;void 0!==C.node&&(d.push(this.getDependency("node",B)),A.push(this.getDependency("accessor",S)),g.push(this.getDependency("accessor",T)),b.push(w),I.push(C))}return Promise.all([Promise.all(d),Promise.all(A),Promise.all(g),Promise.all(b),Promise.all(I)]).then((function(t){const i=t[0],d=t[1],A=t[2],g=t[3],b=t[4],I=[];for(let t=0,r=i.length;t<r;t++){const r=i[t],w=d[t],C=A[t],B=g[t],S=b[t];if(void 0===r)continue;let T;switch(r.updateMatrix(),ai[S.path]){case ai.weights:T=ve;break;case ai.rotation:T=Be;break;default:T=Ce}const x=r.name?r.name:r.uuid,M=void 0!==B.interpolation?oi[B.interpolation]:ce,P=[];ai[S.path]===ai.weights?r.traverse((function(t){t.morphTargetInfluences&&P.push(t.name?t.name:t.uuid)})):P.push(x);let D=C.array;if(C.normalized){const t=getNormalizedComponentScale(D.constructor),i=new Float32Array(D.length);for(let r=0,d=D.length;r<d;r++)i[r]=D[r]*t;D=i}for(let t=0,i=P.length;t<i;t++){const i=new T(P[t]+"."+ai[S.path],w.array,D,M);"CUBICSPLINE"===B.interpolation&&(i.createInterpolant=function(t){return new(this instanceof Be?GLTFCubicSplineQuaternionInterpolant:GLTFCubicSplineInterpolant)(this.times,this.values,this.getValueSize()/3,t)},i.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),I.push(i)}}return new Ae(r,void 0,I)}))}createNodeMesh(t){const i=this.json,r=this,d=i.nodes[t];return void 0===d.mesh?null:r.getDependency("mesh",d.mesh).then((function(t){const i=r._getNodeRef(r.meshCache,d.mesh,t);return void 0!==d.weights&&i.traverse((function(t){if(t.isMesh)for(let i=0,r=d.weights.length;i<r;i++)t.morphTargetInfluences[i]=d.weights[i]})),i}))}loadNode(t){const i=this,r=this.json.nodes[t],d=i._loadNodeShallow(t),A=[],g=r.children||[];for(let t=0,r=g.length;t<r;t++)A.push(i.getDependency("node",g[t]));const b=void 0===r.skin?Promise.resolve(null):i.getDependency("skin",r.skin);return Promise.all([d,Promise.all(A),b]).then((function(t){const i=t[0],r=t[1],d=t[2];null!==d&&i.traverse((function(t){t.isSkinnedMesh&&t.bind(d,ci)}));for(let t=0,d=r.length;t<d;t++)i.add(r[t]);return i}))}_loadNodeShallow(t){const i=this.json,r=this.extensions,d=this;if(void 0!==this.nodeCache[t])return this.nodeCache[t];const A=i.nodes[t],b=A.name?d.createUniqueName(A.name):"",I=[],w=d._invokeOne((function(i){return i.createNodeMesh&&i.createNodeMesh(t)}));return w&&I.push(w),void 0!==A.camera&&I.push(d.getDependency("camera",A.camera).then((function(t){return d._getNodeRef(d.cameraCache,A.camera,t)}))),d._invokeAll((function(i){return i.createNodeAttachment&&i.createNodeAttachment(t)})).forEach((function(t){I.push(t)})),this.nodeCache[t]=Promise.all(I).then((function(i){let I;if(I=!0===A.isBone?new ue:i.length>1?new ae:1===i.length?i[0]:new R,I!==i[0])for(let t=0,r=i.length;t<r;t++)I.add(i[t]);if(A.name&&(I.userData.name=A.name,I.name=b),assignExtrasToUserData(I,A),A.extensions&&addUnknownExtensionsToUserData(r,I,A),void 0!==A.matrix){const t=new g;t.fromArray(A.matrix),I.applyMatrix4(t)}else void 0!==A.translation&&I.position.fromArray(A.translation),void 0!==A.rotation&&I.quaternion.fromArray(A.rotation),void 0!==A.scale&&I.scale.fromArray(A.scale);return d.associations.has(I)||d.associations.set(I,{}),d.associations.get(I).nodes=t,I})),this.nodeCache[t]}loadScene(t){const i=this.extensions,r=this.json.scenes[t],d=this,A=new ae;r.name&&(A.name=d.createUniqueName(r.name)),assignExtrasToUserData(A,r),r.extensions&&addUnknownExtensionsToUserData(i,A,r);const g=r.nodes||[],b=[];for(let t=0,i=g.length;t<i;t++)b.push(d.getDependency("node",g[t]));return Promise.all(b).then((function(t){for(let i=0,r=t.length;i<r;i++)A.add(t[i]);return d.associations=(t=>{const i=new Map;for(const[t,r]of d.associations)(t instanceof W||t instanceof ye)&&i.set(t,r);return t.traverse((t=>{const r=d.associations.get(t);null!=r&&i.set(t,r)})),i})(A),A}))}}function addPrimitiveAttributes(t,i,r){const d=i.attributes,A=[];function assignAttributeAccessor(i,d){return r.getDependency("accessor",i).then((function(i){t.setAttribute(d,i)}))}for(const i in d){const r=ri[i]||i.toLowerCase();r in t.attributes||A.push(assignAttributeAccessor(d[i],r))}if(void 0!==i.indices&&!t.index){const d=r.getDependency("accessor",i.indices).then((function(i){t.setIndex(i)}));A.push(d)}return assignExtrasToUserData(t,i),function(t,i,r){const d=i.attributes,A=new Ee;if(void 0===d.POSITION)return;{const t=r.json.accessors[d.POSITION],i=t.min,g=t.max;if(void 0===i||void 0===g)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(A.set(new Q(i[0],i[1],i[2]),new Q(g[0],g[1],g[2])),t.normalized){const i=getNormalizedComponentScale(ti[t.componentType]);A.min.multiplyScalar(i),A.max.multiplyScalar(i)}}const g=i.targets;if(void 0!==g){const t=new Q,i=new Q;for(let d=0,A=g.length;d<A;d++){const A=g[d];if(void 0!==A.POSITION){const d=r.json.accessors[A.POSITION],g=d.min,b=d.max;if(void 0!==g&&void 0!==b){if(i.setX(Math.max(Math.abs(g[0]),Math.abs(b[0]))),i.setY(Math.max(Math.abs(g[1]),Math.abs(b[1]))),i.setZ(Math.max(Math.abs(g[2]),Math.abs(b[2]))),d.normalized){const t=getNormalizedComponentScale(ti[d.componentType]);i.multiplyScalar(t)}t.max(i)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}A.expandByVector(t)}t.boundingBox=A;const b=new Se;A.getCenter(b.center),b.radius=A.min.distanceTo(A.max)/2,t.boundingSphere=b}(t,i,r),Promise.all(A).then((function(){return void 0!==i.targets?function(t,i,r){let d=!1,A=!1,g=!1;for(let t=0,r=i.length;t<r;t++){const r=i[t];if(void 0!==r.POSITION&&(d=!0),void 0!==r.NORMAL&&(A=!0),void 0!==r.COLOR_0&&(g=!0),d&&A&&g)break}if(!d&&!A&&!g)return Promise.resolve(t);const b=[],I=[],w=[];for(let C=0,B=i.length;C<B;C++){const B=i[C];if(d){const i=void 0!==B.POSITION?r.getDependency("accessor",B.POSITION):t.attributes.position;b.push(i)}if(A){const i=void 0!==B.NORMAL?r.getDependency("accessor",B.NORMAL):t.attributes.normal;I.push(i)}if(g){const i=void 0!==B.COLOR_0?r.getDependency("accessor",B.COLOR_0):t.attributes.color;w.push(i)}}return Promise.all([Promise.all(b),Promise.all(I),Promise.all(w)]).then((function(i){const r=i[0],b=i[1],I=i[2];return d&&(t.morphAttributes.position=r),A&&(t.morphAttributes.normal=b),g&&(t.morphAttributes.color=I),t.morphTargetsRelative=!0,t}))}(t,i.targets,r):t}))}function clone(t){const i=new Map,r=new Map,d=t.clone();return parallelTraverse(t,d,(function(t,d){i.set(d,t),r.set(t,d)})),d.traverse((function(t){if(!t.isSkinnedMesh)return;const d=t,A=i.get(t),g=A.skeleton.bones;d.skeleton=A.skeleton.clone(),d.bindMatrix.copy(A.bindMatrix),d.skeleton.bones=g.map((function(t){return r.get(t)})),d.bind(d.skeleton,d.bindMatrix)})),d}function parallelTraverse(t,i,r){r(t,i);for(let d=0;d<t.children.length;d++)parallelTraverse(t.children[d],i.children[d],r)}const Ai=["License","Author","Preview Image URL","Sketchfab Link"];let ui=new class{constructor(){this.library={},this._blobHashMap={}}addNewAsset(t,i,r,d){blobToHash(t).then((A=>{if(A in this._blobHashMap)return void(d&&d(this._blobHashMap[A]));let g=uuidv4();this._blobHashMap[A]=g,this.library[g]={Blob:t,Name:i,Type:r},this._loadMesh(g,t).then((()=>{d(g)}))}))}load(t,i,r,d){try{let A=[];for(let r in t){let d=t[r];if(d.Type==Ve.SHAPE){this.loadShape(r,d.Name);continue}if(d.Type==Ve.LIGHT){this.loadLight(r,d.Name);continue}let g=d.Filepath,b=i.file(g).async("blob").then((t=>this.loadLibraryAsset(r,d,t)));A.push(b)}Promise.all(A).then(r).catch((t=>{console.log(t),d&&d()}))}catch(t){console.error(t),d&&d()}}loadLibraryAsset(t,i,r){return blobToHash(r).then((d=>{if(!(d in this._blobHashMap)){this._blobHashMap[d]=t,this.library[t]={Blob:r,Name:i.Name,Type:i.Type};for(let r of Ai)i[r]&&(this.library[t][r]=i[r]);return this._loadMesh(t,r,!0)}console.warn("Unreachable statement reached...")}))}loadAsset(t,i){let r,d=t.split("/").pop(),A=uuidv4(),g=d.split(".").pop().toLowerCase();g in Ye?r=Ve.IMAGE:"glb"==g&&(r=Ve.MODEL),fetch(t).then((t=>t.blob())).then((t=>{blobToHash(t).then((g=>{g in this._blobHashMap?i&&i(this._blobHashMap[g]):(this._blobHashMap[g]=A,this.library[A]={Blob:t,Name:d,Type:r},this._loadMesh(A,t).then((()=>{i(A)})))}))}))}loadShape(t,i){t in this.library||(this.library[t]={Name:i,Type:Ve.SHAPE})}loadLight(t,i){t in this.library||(this.library[t]={Name:i,Type:Ve.LIGHT})}_loadMesh(t,i,r){return this.library[t].Type==Ve.MODEL?this._loadGLB(t,i,r):this.library[t].Type==Ve.IMAGE?this._loadImage(t,i,r):void 0}_loadGLB(t,i,r){return new Promise(((d,A)=>{let g=URL.createObjectURL(i);(new GLTFLoader).load(g,(i=>{this.library[t].Mesh=i.scene,r||wt.publish(this._id,We,t),d()}))}))}_loadImage(i,r,d){return new Promise(((A,g)=>{let b=URL.createObjectURL(r);(new t.TextureLoader).load(b,(r=>{let g=r.image.width,b=r.image.height;g>b?(b*=1/g,g=1):(g*=1/b,b=1);let I=new t.PlaneGeometry(g,b),w=new t.MeshBasicMaterial({map:r,side:t.DoubleSide,transparent:!0}),C=new t.Mesh(I,w);this.library[i].Mesh=C,d||wt.publish(this._id,We,i),A()}))}))}cloneMesh(t){let i=this.library[t];return i.Type==Ve.IMAGE?i.Mesh.clone():i.Type==Ve.MODEL?clone(i.Mesh):void 0}getTexture(t){return this.library[t].Mesh.material.map}cloneTexture(t){return this.library[t].Mesh.material.map.clone()}getImage(t){return this.library[t].Mesh.material.map.image}getLibrary(){return this.library}getType(t){return t in this.library?this.library[t].Type:null}getAssetName(t){return t in this.library?this.library[t].Name:null}setSketchfabDetails(t,i){let r=this.library[t];r?(i.previewUrl&&(r["Preview Image URL"]=i.previewUrl),i.license&&(r.License=i.license.label),i.user&&i.user.username&&(r.Author="Sketchfab User "+i.user.username),i.viewerUrl&&(r["Sketchfab Link"]=i.viewerUrl),i.previewTexture&&(r.previewTexture=i.previewTexture)):console.error("Asset ID not found when setting Sketchfab Details")}reset(){let t={};for(let i in this.library){let r=this.library[i].Type;r!=Ve.LIGHT&&r!=Ve.SHAPE||(t[i]=this.library[i])}this.library=t,this._blobHashMap={}}getLibraryDetails(t){let i={};for(let r of t){let t=this.library[r],d=t.Type;i[r]={Name:t.Name,Type:d};for(let d of Ai)t[d]&&(i[r][d]=t[d]);if(d==Ve.MODEL||d==Ve.IMAGE){let d="assets/"+r+"/"+t.Name;i[r].Filepath=d}}return i}};class Entity{constructor(){this._id=uuidv4(),this._object=new R}getId(){return this._id}getObject(){return this._object}addToScene(t){t&&t.add(this._object)}removeFromScene(){this._object.parent&&(this._object.parent.remove(this._object),fullDispose(this._object))}}class Avatar{constructor(i){null==i&&(i={});let r=i["Vertical Offset"]||0,d=i["Focus Camera"]||!1,A=i["Camera Focal Point"]||[0,1.7,0];this._defaultURL="https://d1a370nemizbjq.cloudfront.net/6a141c79-d6e5-4b0d-aa0d-524a8b9b54a4.glb",this._pivotPoint=new t.Object3D,this._pivotPoint.position.setY(r),this._createBoundingBox(i),this._createMesh(i.URL?i.URL:this._defaultURL),d&&ze.cameraFocus.position.fromArray(A)}_createBoundingBox(i){let r=i["Bounding Box Size"]?i["Bounding Box Min"]:[.2,.8,.2],d=i["Bounding Box Center"]?i["Bounding Box Max"]:[0,.4,0],A=i["Bounding Box Quaternion"]?i["Bounding Box Quaternion"]:[0,0,0,0],g=new t.BoxGeometry(r[0],r[1],r[2]),b=new t.MeshBasicMaterial({wireframe:!0});this._boundingBox=new t.Mesh(g,b),this._boundingBox.position.fromArray(d),this._boundingBox.quaternion.fromArray(A)}_createMesh(i){if(/\.glb/.test(i)){(new GLTFLoader).load(i,(t=>{if(t.scene.rotateY(Math.PI),t.scene.children[0].name.includes("AvatarRoot")){let i=new Set;t.scene.traverse((t=>{t.name.toLowerCase().includes("hand")&&i.add(t)})),i.forEach((t=>{t.parent.remove(t)})),t.scene.position.setY(-.7)}this._pivotPoint.add(t.scene),this._saveOriginalTransparencyStates(),this._dimensions=3}),(()=>{}),(t=>{console.log(t),i!=this._defaultURL?this._createMesh(this._defaultURL):console.error("Can't display default avatar :(")}))}else/\.png$|\.jpg$|\.jpeg$/.test(i)?(new t.TextureLoader).load(i,(i=>{let r=i.image.width,d=i.image.height;if(r>d){let t=.3/r;r=.3,d*=t}else{let t=.3/d;d=.3,r*=t}let A=new t.MeshBasicMaterial({map:i,side:t.DoubleSide,transparent:!0}),g=new t.PlaneGeometry(r,d);g.rotateY(Math.PI);let b=new t.Mesh(g,A);this._pivotPoint.add(b),this._saveOriginalTransparencyStates(),this._dimensions=2}),(()=>{}),(()=>{i!=this._defaultURL?this._createMesh(this._defaultURL):console.error("Can't display default avatar :(")})):i!=this._defaultURL?this._createMesh(this._defaultURL):console.error("Default avatar URL is invalid :(")}_saveOriginalTransparencyStates(){this._pivotPoint.traverse((function(i){if(i instanceof t.Mesh&&i.material)if(Array.isArray(i.material))for(let t=0;t<i.material.length;t++){let r=i.material[t];r.userData.transparent=r.transparent,r.userData.opacity=r.opacity}else{let t=i.material;t.userData.transparent=t.transparent,t.userData.opacity=t.opacity}}))}fade(i){this._isFading=!0,this._pivotPoint.traverse((function(r){if(r instanceof t.Mesh&&r.material)if(Array.isArray(r.material))for(let t=0;t<r.material.length;t++){let d=r.material[t];d.transparent||(d.transparent=!0,d.needsUpdate=!0),d.opacity=d.userData.opacity*i}else{let t=r.material;t.transparent||(t.transparent=!0,t.needsUpdate=!0),t.opacity=t.userData.opacity*i}}))}endFade(){this._isFading&&(this._isFading=!1,this._pivotPoint.traverse((function(i){if(i instanceof t.Mesh&&i.material)if(Array.isArray(i.material))for(let t=0;t<i.material.length;t++){let r=i.material[t];r.transparent!=r.userData.transparent&&(r.transparent=r.userData.transparent,r.needsUpdate=!0),r.opacity=r.userData.opacity}else{let t=i.material;t.transparent!=t.userData.transparent&&(t.transparent=t.userData.transparent,t.needsUpdate=!0),t.opacity=t.userData.opacity}})))}lookAtLocal(t){this._pivotPoint.parent&&(Pt[0].copy(t),this._pivotPoint.parent.localToWorld(Pt[0]),this._pivotPoint.lookAt(Pt[0]))}updateSourceUrl(t){for(;this._pivotPoint.children[0];){let t=this._pivotPoint.children[0];this._pivotPoint.remove(t),fullDispose(t,!0)}this._createMesh(t)}getObject(){return this._pivotPoint}addToScene(t){t.add(this._pivotPoint)}removeFromScene(){this._pivotPoint.parent&&this._pivotPoint.parent.remove(this._pivotPoint)}}const pi={LEFT:"LEFT",RIGHT:"RIGHT",otherHand:t=>t==pi.LEFT?pi.RIGHT:t==pi.RIGHT?pi.LEFT:void console.error("ERROR: Unexpected hand provided to Hands.otherHand")},gi={Handedness:Object.freeze({NONE:"none",LEFT:"left",RIGHT:"right"}),ComponentState:Object.freeze({DEFAULT:"default",TOUCHED:"touched",PRESSED:"pressed"}),ComponentProperty:Object.freeze({BUTTON:"button",X_AXIS:"xAxis",Y_AXIS:"yAxis",STATE:"state"}),ComponentType:Object.freeze({TRIGGER:"trigger",SQUEEZE:"squeeze",TOUCHPAD:"touchpad",THUMBSTICK:"thumbstick",BUTTON:"button"}),ButtonTouchThreshold:.05,AxisTouchThreshold:.1,VisualResponseProperty:Object.freeze({TRANSFORM:"transform",VISIBILITY:"visibility"})};async function fetchJsonFile(t){const i=await fetch(t);if(i.ok)return i.json();throw new Error(i.statusText)}async function fetchProfile(t,i,r=null,d=!0){if(!t)throw new Error("No xrInputSource supplied");if(!i)throw new Error("No basePath supplied");const A=await async function(t){if(!t)throw new Error("No basePath supplied");return await fetchJsonFile(`${t}/profilesList.json`)}(i);let g;if(t.profiles.some((t=>{const r=A[t];return r&&(g={profileId:t,profilePath:`${i}/${r.path}`,deprecated:!!r.deprecated}),!!g})),!g){if(!r)throw new Error("No matching profile name found");const t=A[r];if(!t)throw new Error(`No matching profile name found and default profile "${r}" missing.`);g={profileId:r,profilePath:`${i}/${t.path}`,deprecated:!!t.deprecated}}const b=await fetchJsonFile(g.profilePath);let I;if(d){let i;if(i="any"===t.handedness?b.layouts[Object.keys(b.layouts)[0]]:b.layouts[t.handedness],!i)throw new Error(`No matching handedness, ${t.handedness}, in profile ${g.profileId}`);i.assetPath&&(I=g.profilePath.replace("profile.json",i.assetPath))}return{profile:b,assetPath:I}}const mi={xAxis:0,yAxis:0,button:0,state:gi.ComponentState.DEFAULT};class VisualResponse{constructor(t){this.componentProperty=t.componentProperty,this.states=t.states,this.valueNodeName=t.valueNodeName,this.valueNodeProperty=t.valueNodeProperty,this.valueNodeProperty===gi.VisualResponseProperty.TRANSFORM&&(this.minNodeName=t.minNodeName,this.maxNodeName=t.maxNodeName),this.value=0,this.updateFromComponent(mi)}updateFromComponent({xAxis:t,yAxis:i,button:r,state:d}){const{normalizedXAxis:A,normalizedYAxis:g}=function(t=0,i=0){let r=t,d=i;if(Math.sqrt(t*t+i*i)>1){const A=Math.atan2(i,t);r=Math.cos(A),d=Math.sin(A)}return{normalizedXAxis:.5*r+.5,normalizedYAxis:.5*d+.5}}(t,i);switch(this.componentProperty){case gi.ComponentProperty.X_AXIS:this.value=this.states.includes(d)?A:.5;break;case gi.ComponentProperty.Y_AXIS:this.value=this.states.includes(d)?g:.5;break;case gi.ComponentProperty.BUTTON:this.value=this.states.includes(d)?r:0;break;case gi.ComponentProperty.STATE:this.valueNodeProperty===gi.VisualResponseProperty.VISIBILITY?this.value=this.states.includes(d):this.value=this.states.includes(d)?1:0;break;default:throw new Error(`Unexpected visualResponse componentProperty ${this.componentProperty}`)}}}class Component{constructor(t,i){if(!(t&&i&&i.visualResponses&&i.gamepadIndices&&0!==Object.keys(i.gamepadIndices).length))throw new Error("Invalid arguments supplied");this.id=t,this.type=i.type,this.rootNodeName=i.rootNodeName,this.touchPointNodeName=i.touchPointNodeName,this.visualResponses={},Object.keys(i.visualResponses).forEach((t=>{const r=new VisualResponse(i.visualResponses[t]);this.visualResponses[t]=r})),this.gamepadIndices=Object.assign({},i.gamepadIndices),this.values={state:gi.ComponentState.DEFAULT,button:void 0!==this.gamepadIndices.button?0:void 0,xAxis:void 0!==this.gamepadIndices.xAxis?0:void 0,yAxis:void 0!==this.gamepadIndices.yAxis?0:void 0}}get data(){return{id:this.id,...this.values}}updateFromGamepad(t){if(this.values.state=gi.ComponentState.DEFAULT,void 0!==this.gamepadIndices.button&&t.buttons.length>this.gamepadIndices.button){const i=t.buttons[this.gamepadIndices.button];this.values.button=i.value,this.values.button=this.values.button<0?0:this.values.button,this.values.button=this.values.button>1?1:this.values.button,i.pressed||1===this.values.button?this.values.state=gi.ComponentState.PRESSED:(i.touched||this.values.button>gi.ButtonTouchThreshold)&&(this.values.state=gi.ComponentState.TOUCHED)}void 0!==this.gamepadIndices.xAxis&&t.axes.length>this.gamepadIndices.xAxis&&(this.values.xAxis=t.axes[this.gamepadIndices.xAxis],this.values.xAxis=this.values.xAxis<-1?-1:this.values.xAxis,this.values.xAxis=this.values.xAxis>1?1:this.values.xAxis,this.values.state===gi.ComponentState.DEFAULT&&Math.abs(this.values.xAxis)>gi.AxisTouchThreshold&&(this.values.state=gi.ComponentState.TOUCHED)),void 0!==this.gamepadIndices.yAxis&&t.axes.length>this.gamepadIndices.yAxis&&(this.values.yAxis=t.axes[this.gamepadIndices.yAxis],this.values.yAxis=this.values.yAxis<-1?-1:this.values.yAxis,this.values.yAxis=this.values.yAxis>1?1:this.values.yAxis,this.values.state===gi.ComponentState.DEFAULT&&Math.abs(this.values.yAxis)>gi.AxisTouchThreshold&&(this.values.state=gi.ComponentState.TOUCHED)),Object.values(this.visualResponses).forEach((t=>{t.updateFromComponent(this.values)}))}}class MotionController{constructor(t,i,r){if(!t)throw new Error("No xrInputSource supplied");if(!i)throw new Error("No profile supplied");this.xrInputSource=t,this.assetUrl=r,this.id=i.profileId,this.layoutDescription=i.layouts[t.handedness],this.components={},Object.keys(this.layoutDescription.components).forEach((t=>{const i=this.layoutDescription.components[t];this.components[t]=new Component(t,i)})),this.updateFromGamepad()}get gripSpace(){return this.xrInputSource.gripSpace}get targetRaySpace(){return this.xrInputSource.targetRaySpace}get data(){const t=[];return Object.values(this.components).forEach((i=>{t.push(i.data)})),t}updateFromGamepad(){Object.values(this.components).forEach((t=>{t.updateFromGamepad(this.xrInputSource.gamepad)}))}}class XRControllerModel extends R{constructor(){super(),this.motionController=null,this.envMap=null}setEnvironmentMap(t){return this.envMap==t||(this.envMap=t,this.traverse((t=>{t.isMesh&&(t.material.envMap=this.envMap,t.material.needsUpdate=!0)}))),this}updateMatrixWorld(t){super.updateMatrixWorld(t),this.motionController&&(this.motionController.updateFromGamepad(),Object.values(this.motionController.components).forEach((t=>{Object.values(t.visualResponses).forEach((t=>{const{valueNode:i,minNode:r,maxNode:d,value:A,valueNodeProperty:g}=t;i&&(g===gi.VisualResponseProperty.VISIBILITY?i.visible=A:g===gi.VisualResponseProperty.TRANSFORM&&(i.quaternion.slerpQuaternions(r.quaternion,d.quaternion,A),i.position.lerpVectors(r.position,d.position,A)))}))})))}}function addAssetSceneToControllerModel(t,i){!function(t,i){Object.values(t.components).forEach((t=>{const{type:r,touchPointNodeName:d,visualResponses:A}=t;if(r===gi.ComponentType.TOUCHPAD)if(t.touchPointNode=i.getObjectByName(d),t.touchPointNode){const i=new xe(.001),r=new x({color:255}),d=new te(i,r);t.touchPointNode.add(d)}else console.warn(`Could not find touch dot, ${t.touchPointNodeName}, in touchpad component ${t.id}`);Object.values(A).forEach((t=>{const{valueNodeName:r,minNodeName:d,maxNodeName:A,valueNodeProperty:g}=t;if(g===gi.VisualResponseProperty.TRANSFORM){if(t.minNode=i.getObjectByName(d),t.maxNode=i.getObjectByName(A),!t.minNode)return void console.warn(`Could not find ${d} in the model`);if(!t.maxNode)return void console.warn(`Could not find ${A} in the model`)}t.valueNode=i.getObjectByName(r),t.valueNode||console.warn(`Could not find ${r} in the model`)}))}))}(t.motionController,i),t.envMap&&i.traverse((i=>{i.isMesh&&(i.material.envMap=t.envMap,i.material.needsUpdate=!0)})),t.add(i)}const _i=new class{constructor(t=null){this.gltfLoader=t,this.path="https://cdn.jsdelivr.net/npm/@webxr-input-profiles/assets@1.0/dist/profiles",this._assetCache={},this.gltfLoader||(this.gltfLoader=new GLTFLoader)}createControllerModel(t){const i=new XRControllerModel;let r=null;if("tracked-pointer"===t.targetRayMode&&t.gamepad)return fetchProfile(t,this.path,"generic-trigger").then((({profile:d,assetPath:A})=>{i.motionController=new MotionController(t,d,A);const g=this._assetCache[i.motionController.assetUrl];if(g)r=g.scene.clone(),addAssetSceneToControllerModel(i,r);else{if(!this.gltfLoader)throw new Error("GLTFLoader not set.");this.gltfLoader.setPath(""),this.gltfLoader.load(i.motionController.assetUrl,(t=>{this._assetCache[i.motionController.assetUrl]=t,r=t.scene.clone(),addAssetSceneToControllerModel(i,r)}),null,(()=>{throw new Error(`Asset ${i.motionController.assetUrl} missing or malformed.`)}))}})).catch((t=>{console.warn(t)})),i}};let fi=new class{init(t,i,r){this._container=t,this._renderer=i,this._renderer.domElement.tabIndex="1",this._controllerParent=r,this._session,this._leftXRInputSource,this._rightXRInputSource,this._leftXRControllerModel=new R,this._rightXRControllerModel=new R,this._leftXRController={targetRay:new R,grip:new R},this._rightXRController={targetRay:new R,grip:new R},this._pointerPosition=new D,this._pointerPressed=!1,this._keysPressed=new Set,this._keyCodesPressed=new Set,this._screenTouched=!1,this._joystickAngle=0,this._joystickDistance=0,this._addEventListeners()}_addEventListeners(){"XR"==ze.deviceType?(this._renderer.xr.addEventListener("sessionstart",(t=>{this._onXRSessionStart(t)})),this._renderer.xr.addEventListener("sessionend",(t=>{this._onXRSessionEnd(t)}))):"POINTER"==ze.deviceType?(this._renderer.domElement.addEventListener("keydown",(t=>{this._keysPressed.add(t.key),this._keyCodesPressed.add(t.code)})),this._renderer.domElement.addEventListener("keyup",(t=>{this._keysPressed.delete(t.key),this._keyCodesPressed.delete(t.code)})),ze.isChrome&&document.addEventListener("pointerlockchange",(t=>{ze.sessionActive||this._keysPressed.clear(),ze.sessionActive||this._keyCodesPressed.clear()})),this._renderer.domElement.addEventListener("mousedown",(()=>{this._pointerPressed=!0})),this._renderer.domElement.addEventListener("mouseup",(()=>{this._pointerPressed=!1})),this._renderer.domElement.addEventListener("mousemove",(t=>{let i=t.target.getBoundingClientRect();this._pointerPosition.x=(t.clientX-i.left)/this._renderer.domElement.clientWidth*2-1,this._pointerPosition.y=-(t.clientY-i.top)/this._renderer.domElement.clientHeight*2+1})),this._container.addEventListener("mouseup",(()=>{this._renderer.domElement.focus()}))):"MOBILE"==ze.deviceType&&(this._renderer.domElement.addEventListener("touchstart",(()=>{this._screenTouched=!0;let t=event.target.getBoundingClientRect();this._pointerPosition.x=(event.touches[0].clientX-t.left)/this._renderer.domElement.clientWidth*2-1,this._pointerPosition.y=-(event.touches[0].clientY-t.top)/this._renderer.domElement.clientHeight*2+1})),this._renderer.domElement.addEventListener("touchend",(()=>{this._screenTouched=!1})),this._renderer.domElement.addEventListener("touchmove",(t=>{let i=t.target.getBoundingClientRect();this._pointerPosition.x=(t.touches[0].clientX-i.left)/this._renderer.domElement.clientWidth*2-1,this._pointerPosition.y=-(t.touches[0].clientY-i.top)/this._renderer.domElement.clientHeight*2+1})))}createPointerControls(){document.getElementById("mobile-menu-open-button").classList.remove("hidden")}createMobileControls(){let t=document.getElementById("mobile-joystick"),i=document.getElementById("mobile-menu-open-button"),r=document.getElementById("mobile-flying-controls");t.classList.remove("hidden"),i.classList.remove("hidden"),r.classList.remove("hidden");let d={zone:t,mode:"static",position:{left:"50%",top:"50%"}},A=nipplejs.create(d).get(0);A.on("move",((t,i)=>{this._joystickAngle=i.angle.radian,this._joystickDistance=Math.min(i.force,1)})),A.on("end",(()=>{this._joystickDistance=0}))}_onXRSessionStart(t){this._session=this._renderer.xr.getSession(),this._session.oninputsourceschange=t=>{this._onXRInputSourceChange(t)};let i=this._session.inputSources;for(let t=0;t<i.length;t++)"right"==i[t].handedness?(this._rightXRInputSource=i[t],this._controllerParent.add(this._rightXRController.targetRay),this._controllerParent.add(this._rightXRController.grip),0==this._rightXRControllerModel.children.length&&this._rightXRControllerModel.add(_i.createControllerModel(i[t]))):"left"==i[t].handedness&&(this._leftXRInputSource=i[t],this._controllerParent.add(this._leftXRController.targetRay),this._controllerParent.add(this._leftXRController.grip),0==this._leftXRControllerModel.children.length&&this._leftXRControllerModel.add(_i.createControllerModel(i[t])))}_onXRSessionEnd(t){this._session.oninputsourcechange=null,this._session=null,this._rightXRInputSource=null,this._leftXRInputSource=null,this._controllerParent.remove(this._rightXRController.targetRay),this._controllerParent.remove(this._rightXRController.grip),this._controllerParent.remove(this._leftXRController.targetRay),this._controllerParent.remove(this._leftXRController.grip)}_onXRInputSourceChange(t){for(let i=0;i<t.removed.length;i++)t.removed[i]==this._rightXRInputSource?(this._rightXRInputSource=null,this._controllerParent.remove(this._rightXRController.targetRay),this._controllerParent.remove(this._rightXRController.grip)):t.removed[i]==this._leftXRInputSource&&(this._leftXRInputSource=null,this._controllerParent.remove(this._leftXRController.targetRay),this._controllerParent.remove(this._leftXRController.grip));for(let i=0;i<t.added.length;i++)null==t.added[i].hand&&("right"==t.added[i].handedness?(this._rightXRInputSource=t.added[i],this._controllerParent.add(this._rightXRController.targetRay),this._controllerParent.add(this._rightXRController.grip),0==this._rightXRControllerModel.children.length&&this._rightXRControllerModel.add(_i.createControllerModel(t.added[i]))):"left"==t.added[i].handedness&&(this._leftXRInputSource=t.added[i],this._controllerParent.add(this._leftXRController.targetRay),this._controllerParent.add(this._leftXRController.grip),0==this._leftXRControllerModel.children.length&&this._leftXRControllerModel.add(_i.createControllerModel(t.added[i]))))}getXRGamepad(t){return t==pi.LEFT?this._leftXRInputSource?this._leftXRInputSource.gamepad:null:t==pi.RIGHT&&this._rightXRInputSource?this._rightXRInputSource.gamepad:null}getXRController(t,i){return t==pi.LEFT?this._leftXRController[i]:t==pi.RIGHT?this._rightXRController[i]:void 0}getXRControllerModel(t){return t==pi.LEFT?this._leftXRControllerModel:t==pi.RIGHT?this._rightXRControllerModel:void 0}getPointerPosition(){return this._pointerPosition}isPointerPressed(){return this._pointerPressed}isKeyPressed(t){return this._keysPressed.has(t)}isKeyCodePressed(t){return this._keyCodesPressed.has(t)}isScreenTouched(){return this._screenTouched}getJoystickAngle(){return this._joystickAngle}getJoystickDistance(){return this._joystickDistance}_updateXRController(t,i,r,d){if(r){let A=t.getPose(r.targetRaySpace,i);null!=A&&(d.targetRay.matrix.fromArray(A.transform.matrix),d.targetRay.matrix.decompose(d.targetRay.position,d.targetRay.rotation,d.targetRay.scale));let g=t.getPose(r.gripSpace,i);null!==g&&(d.grip.matrix.fromArray(g.transform.matrix),d.grip.matrix.decompose(d.grip.position,d.grip.rotation,d.grip.scale))}}update(t){if(null==t)return;let i=this._renderer.xr.getReferenceSpace();this._updateXRController(t,i,this._leftXRInputSource,this._leftXRController),this._updateXRController(t,i,this._rightXRInputSource,this._rightXRController)}};const bi={FRONT:"FRONT",BACK:"BACK",LEFT:"LEFT",RIGHT:"RIGHT",TOP:"TOP",BOTTOM:"BOTTOM"},Ii=1024,wi={};for(let t in bi){let i=document.createElement("canvas");i.width=Ii,i.height=Ii,wi[t]={canvas:i,context:i.getContext("2d")}}let yi=new class{init(t){this._scene=t,this._scene.background=new Me([wi[bi.RIGHT].canvas,wi[bi.LEFT].canvas,wi[bi.TOP].canvas,wi[bi.BOTTOM].canvas,wi[bi.FRONT].canvas,wi[bi.BACK].canvas])}setSides(t){for(let i in t)this.setSide(i,t[i])}setSide(t,i){let r=i?ui.getImage(i):null;this._drawImage(t,r),this._scene.background.needsUpdate=!0}deleteSide(t){this._drawImage(t),this._scene.background.needsUpdate=!0}_drawImage(t,i){let r=wi[t].canvas,d=wi[t].context;if(d.clearRect(0,0,r.width,r.height),!i)return;let A=Ii/Math.max(i.width,i.height),g=(r.width-i.width*A)/2,b=(r.height-i.height*A)/2;d.drawImage(i,0,0,i.width,i.height,g,b,i.width*A,i.height*A)}};let Ci=new class{constructor(){this.settings={Skybox:{},"User Settings":{"Movement Speed":3,"Enable Flying":!0}},this.editorSettings={"Movement Speed":3,"User Scale":1,"Enable Flying":!0,"Swap Joysticks":!1},this.settings.Skybox[bi.FRONT]=null,this.settings.Skybox[bi.BACK]=null,this.settings.Skybox[bi.LEFT]=null,this.settings.Skybox[bi.RIGHT]=null,this.settings.Skybox[bi.TOP]=null,this.settings.Skybox[bi.BOTTOM]=null}init(t){this._scene=t,yi.init(t)}load(t){if(t)this.settings=t,this.settings["User Settings"]||(this.settings["User Settings"]={"Movement Speed":3,"Enable Flying":!0});else{for(let t in this.settings.Skybox)this.settings.Skybox[t]=null;this.settings["User Settings"]["Movement Speed"]=3,this.settings["User Settings"]["Enable Flying"]=!0}yi.setSides(this.settings.Skybox)}reset(){this.load()}getSkyboxTextures(){let t={},i=this.settings.Skybox;for(let r in i)i[r]?t[r]=ui.getTexture(i[r]):t[r]=vt.searchIcon;return t}setSkyboxSide(t,i,r){this.settings.Skybox[t]=i,yi.setSide(t,i),r||wt.publish(this._id,mt,{settings:this.settings,keys:["Skybox",t]})}getEditorSettings(){return this.editorSettings}setEditorSetting(t,i){t in this.editorSettings&&(this.editorSettings[t]=i)}getUserSettings(){return this.settings["User Settings"]}setUserSetting(t,i,r){t in this.settings["User Settings"]&&(this.settings["User Settings"][t]=i,r||wt.publish(this._id,mt,{settings:this.settings,keys:["User Settings",t]}))}getMovementSpeed(){return ze.isEditor?this.editorSettings["Movement Speed"]:this.settings["User Settings"]["Movement Speed"]}getUserScale(){return ze.isEditor?this.editorSettings["User Scale"]:1}isFlyingEnabled(){return ze.isEditor?this.editorSettings["Enable Flying"]:this.settings["User Settings"]["Enable Flying"]}areJoysticksSwapped(){return!!ze.isEditor&&this.editorSettings["Swap Joysticks"]}getSettings(){return this.settings}};class BasicMovement{constructor(i){null==i&&(i={}),this._avatar=i.Avatar,this._userObj=i["User Object"],this._velocity=new t.Vector3,this._verticalVelocity=0,this._worldVelocity=new t.Vector3,this._snapRotationTriggered=!1}_setupMobileFlyingButtons(){this._mobileUp=!1,this._mobileDown=!1;let t=document.getElementById("mobile-flying-up-button"),i=document.getElementById("mobile-flying-down-button");t.addEventListener("touchstart",(()=>{this._mobileUp=!0})),t.addEventListener("touchend",(()=>{this._mobileUp=!1})),i.addEventListener("touchstart",(()=>{this._mobileDown=!0})),i.addEventListener("touchend",(()=>{this._mobileDown=!1}))}_moveForward(t,i){Pt[0].setFromMatrixColumn(ze.camera.matrixWorld,0),Pt[0].crossVectors(this._userObj.up,Pt[0]),Pt[0].multiplyScalar(t),this._worldVelocity.add(Pt[0]),Pt[0].multiplyScalar(i),this._userObj.position.add(Pt[0])}_moveRight(t,i){Pt[0].setFromMatrixColumn(ze.camera.matrixWorld,0),Pt[0].y=0,Pt[0].multiplyScalar(t),this._worldVelocity.add(Pt[0]),Pt[0].multiplyScalar(i),this._userObj.position.add(Pt[0])}_moveUp(t,i){t=this._userObj.scale.y*t,this._worldVelocity.setY(t),Pt[0].fromArray([0,t*i,0]),this._userObj.position.add(Pt[0])}_snapLeft(){this._userObj.rotateY(Math.PI/8)}_snapRight(){this._userObj.rotateY(-Math.PI/8)}getWorldVelocity(){return this._worldVelocity}update(t){"XR"==ze.deviceType?(this._updatePositionVR(t),this.update=this._updatePositionVR):"POINTER"==ze.deviceType?(this._updatePosition(t),this.update=this._updatePosition):"MOBILE"==ze.deviceType&&(this._setupMobileFlyingButtons(),this._updatePositionMobile(t),this.update=this._updatePositionMobile)}_updatePosition(t){if(this._worldVelocity.set(0,0,0),t>1)return;let i=Ci.getMovementSpeed(),r=Ci.isFlyingEnabled(),d=.88*(1-t);this._velocity.x*=d,r&&(this._verticalVelocity*=d),this._velocity.z*=d,ze.sessionActive&&!ze.keyboardLock&&((fi.isKeyCodePressed("ArrowUp")||fi.isKeyCodePressed("KeyW"))&&(this._velocity.z+=i/4),(fi.isKeyCodePressed("ArrowDown")||fi.isKeyCodePressed("KeyS"))&&(this._velocity.z-=i/4),(fi.isKeyCodePressed("ArrowLeft")||fi.isKeyCodePressed("KeyA"))&&(this._velocity.x-=i/4),(fi.isKeyCodePressed("ArrowRight")||fi.isKeyCodePressed("KeyD"))&&(this._velocity.x+=i/4),r&&fi.isKeyCodePressed("Space")!=fi.isKeyCodePressed("ShiftLeft")&&(this._verticalVelocity=fi.isKeyCodePressed("Space")?i:-i)),this._velocity.length()>i&&this._velocity.normalize().multiplyScalar(i),this._avatar?(this._moveRight(this._velocity.x,t),Pt[1].copy(Pt[0]),this._moveForward(this._velocity.z,t),Pt[1].add(Pt[0]),Pt[1].length()>.001*Ci.getUserScale()&&(Pt[1].multiplyScalar(-2),this._avatar.lookAtLocal(Pt[1])),r&&this._moveUp(this._verticalVelocity,t)):(this._moveRight(this._velocity.x,t),this._moveForward(this._velocity.z,t)),this._userObj.updateMatrixWorld(!0)}_updatePositionMobile(t){if(this._worldVelocity.set(0,0,0),t>1)return;let i=Ci.getMovementSpeed(),r=Ci.isFlyingEnabled();if(this._velocity.x=0,r&&(this._verticalVelocity*=.88*(1-t)),this._velocity.z=0,ze.sessionActive&&!ze.keyboardLock){let t=fi.getJoystickAngle(),d=i*fi.getJoystickDistance();this._velocity.x=d*Math.cos(t),this._velocity.z=d*Math.sin(t),r&&this._mobileUp!=this._mobileDown&&(this._verticalVelocity=this._mobileUp?i:-i)}this._velocity.length()>i&&this._velocity.normalize().multiplyScalar(i),this._avatar?(this._moveRight(this._velocity.x,t),Pt[1].copy(Pt[0]),this._moveForward(this._velocity.z,t),Pt[1].add(Pt[0]),Pt[1].length()>.001*Ci.getUserScale()&&(Pt[1].multiplyScalar(-2),this._avatar.lookAtLocal(Pt[1])),r&&this._moveUp(this._verticalVelocity,t)):(this._moveRight(this._velocity.x,t),this._moveForward(this._velocity.z,t)),this._userObj.updateMatrixWorld(!0)}_updatePositionVR(t){if(this._worldVelocity.set(0,0,0),t>1)return;let i,r,d=Ci.getMovementSpeed(),A=Ci.isFlyingEnabled();if(Ci.areJoysticksSwapped()?(i=fi.getXRGamepad(pi.RIGHT),r=fi.getXRGamepad(pi.LEFT)):(i=fi.getXRGamepad(pi.LEFT),r=fi.getXRGamepad(pi.RIGHT)),this._velocity.x=0,this._velocity.y=0,this._velocity.z=0,i){let r=i.axes;this._velocity.z=-1*d*r[3],this._velocity.x=d*r[2],this._moveRight(this._velocity.x,t),this._moveForward(this._velocity.z,t)}if(r){let i=r.axes[3],g=r.axes[2];Math.abs(g)>.5?this._snapRotationTriggered||(this._snapRotationTriggered=!0,g>0?this._snapRight():this._snapLeft()):this._snapRotationTriggered=!1,A&&Math.abs(i)>.2&&(this._velocity.y=-1*d*i,this._moveUp(this._velocity.y,t))}else this._snapRotationTriggered=!1;this._userObj.updateMatrixWorld(!0)}}const Bi={IDLE:"IDLE",HOVERED:"HOVERED",SELECTED:"SELECTED"},vi={ACTIVE:"EDIT",COPY_PASTE:"COPY_PASTE",DELETE:"DELETE",EDIT:"EDIT",ROTATE:"ROTATE",SCALE:"SCALE",TRANSLATE:"TRANSLATE"};let Ei=new class{constructor(){this._id=uuidv4(),this._assetAlreadyPastedByTrigger=!1,this._assetAlreadyPastedByGrip=!1,this._copiedAsset,wt.subscribe(this._id,qe,(t=>{this._copiedAsset&&this._clear(),this._assetAlreadyPastedByTrigger=!1,this._assetAlreadyPastedByGrip=!1})),wt.subscribe(this._id,pt,(t=>{this._copiedAsset&&this._clear(),this._assetAlreadyPastedByTrigger=!1,this._assetAlreadyPastedByGrip=!1}))}copy(t){this._copiedAsset&&this._clear(),this._copiedAsset=t,this._previewAsset=t.preview(),ps.hands[pi.LEFT].attach(this._previewAsset.getObject()),ps.hands[pi.RIGHT].add(this._previewAsset.getObject())}_paste(){this._previewAsset.clone(this._copiedAsset.visualEdit),this._assetAlreadyPastedByGrip=!0}checkPlacement(t){if(!this._copiedAsset)return;let i=t.raycaster;i.far=1/0;let r=t.isPressed,d=i.intersectObjects(yn.getObjects(),!0);if(this._assetAlreadyPastedByTrigger){if(r)return;this._assetAlreadyPastedByTrigger=!1}if(d.length>0&&(t.closestPoint=d[0].point,r&&this._copiedAsset)){this._copiedAsset.clone().getEditorHelper().place(d[0]),this._assetAlreadyPastedByTrigger=!0}}checkGripPlacement(t){this._copiedAsset&&t!=this._assetAlreadyPastedByGrip&&(t?this._paste():this._assetAlreadyPastedByGrip=!1)}_clear(){this._previewAsset.removeFromScene(),this._copiedAsset=null,this._previewAsset=null}hasCopiedObject(){return this._copiedAsset}};class InteractableHandler{constructor(){this._id=uuidv4(),this._interactables=new Set,this._hoveredInteractables={},this._selectedInteractables={},this._toolInteractables={},this._toolInteractables[vi.EDIT]=new Set,this._toolInteractables[vi.COPY_PASTE]=new Set,this._toolInteractables[vi.DELETE]=new Set,this._toolInteractables[vi.TRANSLATE]=new Set,this._toolInteractables[vi.ROTATE]=new Set,this._toolInteractables[vi.SCALE]=new Set,this._handTool=vi.EDIT,this._addInteractable=this.addInteractable,this._addInteractables=this.addInteractables,this._removeInteractable=this.removeInteractable,this._removeInteractables=this.removeInteractables,this.addInteractable=()=>{},this.addInteractables=()=>{},this.removeInteractable=()=>{},this.removeInteractables=()=>{}}init(){"XR"==ze.deviceType?(this.update=this._updateForXREdit,this._setupXRSubscription()):"POINTER"==ze.deviceType?this.update=this._updateForPointer:"MOBILE"==ze.deviceType&&(this.update=this._updateForMobile),this.addInteractable=this._addInteractable,this.addInteractables=this._addInteractables,this.removeInteractable=this._removeInteractable,this.removeInteractables=this._removeInteractables}addInteractable(t,i){i?this._toolInteractables[i].add(t):this._interactables.add(t)}addInteractables(t,i){i?t.forEach((t=>{this._toolInteractables[i].add(t)})):t.forEach((t=>{this._interactables.add(t)}))}removeInteractable(t,i){i?(this._toolInteractables[i].delete(t),t.reset()):(this._interactables.delete(t),t.reset())}removeInteractables(t,i){i?t.forEach((t=>{this._toolInteractables[i].delete(t),t.reset()})):t.forEach((t=>{this._interactables.delete(t),t.reset()}))}reset(){this._interactables.forEach((t=>{t.reset()})),this._interactables=new Set,this._hoveredInteractables={},this._selectedInteractables={}}}let Si=new class{init(){this._audioListener||(this._audioListener=new t.AudioListener,this._addEventListeners(),ze.camera.add(this._audioListener))}_addEventListeners(){ze.renderer.xr.addEventListener("sessionstart",(()=>{this._audioListener.context.resume()})),ze.renderer.xr.addEventListener("sessionend",(()=>{this._audioListener.context.suspend()}))}};class VRButton{static createButton(t){const i=document.createElement("button");function disableButton(){i.style.display="",i.style.cursor="auto",i.style.left="calc(50% - 75px)",i.style.width="150px",i.onmouseenter=null,i.onmouseleave=null,i.onclick=null}function stylizeElement(t){t.style.position="absolute",t.style.bottom="20px",t.style.padding="12px 6px",t.style.border="1px solid #fff",t.style.borderRadius="4px",t.style.background="rgba(0,0,0,0.1)",t.style.color="#fff",t.style.font="normal 13px sans-serif",t.style.textAlign="center",t.style.opacity="0.5",t.style.outline="none",t.style.zIndex="999"}if("xr"in navigator)return i.id="VRButton",i.style.display="none",stylizeElement(i),navigator.xr.isSessionSupported("immersive-vr").then((function(r){r?function(){let r=null;async function onSessionStarted(d){d.addEventListener("end",onSessionEnded),await t.xr.setSession(d),i.textContent="EXIT VR",r=d}function onSessionEnded(){r.removeEventListener("end",onSessionEnded),i.textContent="ENTER VR",r=null}i.style.display="",i.style.cursor="pointer",i.style.left="calc(50% - 50px)",i.style.width="100px",i.textContent="ENTER VR",i.onmouseenter=function(){i.style.opacity="1.0"},i.onmouseleave=function(){i.style.opacity="0.5"},i.onclick=function(){if(null===r){const t={optionalFeatures:["local-floor","bounded-floor","hand-tracking","layers"]};navigator.xr.requestSession("immersive-vr",t).then(onSessionStarted)}else r.end()}}():(disableButton(),i.textContent="VR NOT SUPPORTED"),r&&VRButton.xrSessionIsGranted&&i.click()})).catch((function(t){disableButton(),console.warn("Exception when trying to call xr.isSessionSupported",t),i.textContent="VR NOT ALLOWED"})),i;{const t=document.createElement("a");return!1===window.isSecureContext?(t.href=document.location.href.replace(/^http:/,"https:"),t.innerHTML="WEBXR NEEDS HTTPS"):(t.href="https://immersiveweb.dev/",t.innerHTML="WEBXR NOT AVAILABLE"),t.style.left="calc(50% - 90px)",t.style.width="180px",t.style.textDecoration="none",stylizeElement(t),t}}static registerSessionGrantedListener(){if("xr"in navigator){if(/WebXRViewer\//i.test(navigator.userAgent))return;navigator.xr.addEventListener("sessiongranted",(()=>{VRButton.xrSessionIsGranted=!0}))}}}VRButton.xrSessionIsGranted=!1,VRButton.registerSessionGrantedListener();const Ti={type:"change"},xi={type:"start"},Mi={type:"end"};class OrbitControls extends Pe{constructor(t,i){super(),void 0===i&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),i===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=t,this.domElement=i,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new Q,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:ke.ROTATE,MIDDLE:ke.DOLLY,RIGHT:ke.PAN},this.touches={ONE:De.ROTATE,TWO:De.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.rotateStartTime=0,this.rotateDelay=0,this._domElementKeyEvents=null,this.getPolarAngle=function(){return I.phi},this.getAzimuthalAngle=function(){return I.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(t){t.addEventListener("keydown",onKeyDown),this._domElementKeyEvents=t},this.saveState=function(){r.target0.copy(r.target),r.position0.copy(r.object.position),r.zoom0=r.object.zoom},this.reset=function(){r.target.copy(r.target0),r.object.position.copy(r.position0),r.object.zoom=r.zoom0,r.object.updateProjectionMatrix(),r.dispatchEvent(Ti),r.update(),g=d.NONE},this.update=function(){const i=new Q,T=(new A).setFromUnitVectors(t.up,new Q(0,1,0)),x=T.clone().invert(),M=new Q,P=new A;var D=new Q;const F=2*Math.PI;return function(){const t=r.object.position;i.copy(t).sub(r.target),i.applyQuaternion(T),I.setFromVector3(i),r.autoRotate&&g===d.NONE&&rotateLeft(2*Math.PI/60/60*r.autoRotateSpeed),r.enableDamping?(I.theta+=w.theta*r.dampingFactor,I.phi+=w.phi*r.dampingFactor):(I.theta+=w.theta,I.phi+=w.phi);let A=r.minAzimuthAngle,Q=r.maxAzimuthAngle;return isFinite(A)&&isFinite(Q)&&(A<-Math.PI?A+=F:A>Math.PI&&(A-=F),Q<-Math.PI?Q+=F:Q>Math.PI&&(Q-=F),I.theta=A<=Q?Math.max(A,Math.min(Q,I.theta)):I.theta>(A+Q)/2?Math.max(A,I.theta):Math.min(Q,I.theta)),I.phi=Math.max(r.minPolarAngle,Math.min(r.maxPolarAngle,I.phi)),I.makeSafe(),I.radius*=C,I.radius=Math.max(r.minDistance,Math.min(r.maxDistance,I.radius)),!0===r.enableDamping?r.target.addScaledVector(B,r.dampingFactor):r.target.add(B),i.setFromSpherical(I),i.applyQuaternion(x),t.copy(r.target).add(i),D.copy(r.target),r.object.parent&&r.object.parent.localToWorld(D),r.object.lookAt(D),!0===r.enableDamping?(w.theta*=1-r.dampingFactor,w.phi*=1-r.dampingFactor,B.multiplyScalar(1-r.dampingFactor)):(w.set(0,0,0),B.set(0,0,0)),C=1,!!(S||M.distanceToSquared(r.object.position)>b||8*(1-P.dot(r.object.quaternion))>b)&&(r.dispatchEvent(Ti),M.copy(r.object.position),P.copy(r.object.quaternion),S=!1,!0)}}(),this.dispose=function(){r.domElement.removeEventListener("contextmenu",onContextMenu),r.domElement.removeEventListener("pointerdown",onPointerDown),r.domElement.removeEventListener("pointercancel",onPointerCancel),r.domElement.removeEventListener("wheel",onMouseWheel),r.domElement.removeEventListener("pointermove",onPointerMove),r.domElement.removeEventListener("pointerup",onPointerUp),null!==r._domElementKeyEvents&&r._domElementKeyEvents.removeEventListener("keydown",onKeyDown)};const r=this,d={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let g=d.NONE;const b=1e-6,I=new Qe,w=new Qe;let C=1;const B=new Q;let S=!1;const T=new D,x=new D,M=new D,P=new D,F=new D,R=new D,L=new D,O=new D,U=new D,N=[],H={};function getZoomScale(){return Math.pow(.95,r.zoomSpeed)}function rotateLeft(t){w.theta-=t}function rotateUp(t){w.phi-=t}const G=function(){const t=new Q;return function(i,r){t.setFromMatrixColumn(r,0),t.multiplyScalar(-i),B.add(t)}}(),j=function(){const t=new Q;return function(i,d){!0===r.screenSpacePanning?t.setFromMatrixColumn(d,1):(t.setFromMatrixColumn(d,0),t.crossVectors(r.object.up,t)),t.multiplyScalar(i),B.add(t)}}(),V=function(){const t=new Q;return function(i,d){const A=r.domElement;if(r.object.isPerspectiveCamera){const g=r.object.position;t.copy(g).sub(r.target);let b=t.length();b*=Math.tan(r.object.fov/2*Math.PI/180),G(2*i*b/A.clientHeight,r.object.matrix),j(2*d*b/A.clientHeight,r.object.matrix)}else r.object.isOrthographicCamera?(G(i*(r.object.right-r.object.left)/r.object.zoom/A.clientWidth,r.object.matrix),j(d*(r.object.top-r.object.bottom)/r.object.zoom/A.clientHeight,r.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),r.enablePan=!1)}}();function dollyOut(t){r.object.isPerspectiveCamera?C/=t:r.object.isOrthographicCamera?(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom*t)),r.object.updateProjectionMatrix(),S=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function dollyIn(t){r.object.isPerspectiveCamera?C*=t:r.object.isOrthographicCamera?(r.object.zoom=Math.max(r.minZoom,Math.min(r.maxZoom,r.object.zoom/t)),r.object.updateProjectionMatrix(),S=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),r.enableZoom=!1)}function handleMouseDownRotate(t){T.set(t.clientX,t.clientY),r.rotateStartTime=Date.now()}function handleMouseDownPan(t){P.set(t.clientX,t.clientY)}function handleTouchStartRotate(){if(1===N.length)T.set(N[0].pageX,N[0].pageY);else{const t=.5*(N[0].pageX+N[1].pageX),i=.5*(N[0].pageY+N[1].pageY);T.set(t,i)}}function handleTouchStartPan(){if(1===N.length)P.set(N[0].pageX,N[0].pageY);else{const t=.5*(N[0].pageX+N[1].pageX),i=.5*(N[0].pageY+N[1].pageY);P.set(t,i)}}function handleTouchStartDolly(){const t=N[0].pageX-N[1].pageX,i=N[0].pageY-N[1].pageY,r=Math.sqrt(t*t+i*i);L.set(0,r)}function handleTouchMoveRotate(t){if(1==N.length)x.set(t.pageX,t.pageY);else{const i=getSecondPointerPosition(t),r=.5*(t.pageX+i.x),d=.5*(t.pageY+i.y);x.set(r,d)}M.subVectors(x,T).multiplyScalar(r.rotateSpeed);const i=r.domElement;rotateLeft(2*Math.PI*M.x/i.clientHeight),rotateUp(2*Math.PI*M.y/i.clientHeight),T.copy(x)}function handleTouchMovePan(t){if(1===N.length)F.set(t.pageX,t.pageY);else{const i=getSecondPointerPosition(t),r=.5*(t.pageX+i.x),d=.5*(t.pageY+i.y);F.set(r,d)}R.subVectors(F,P).multiplyScalar(r.panSpeed),V(R.x,R.y),P.copy(F)}function handleTouchMoveDolly(t){const i=getSecondPointerPosition(t),d=t.pageX-i.x,A=t.pageY-i.y,g=Math.sqrt(d*d+A*A);O.set(0,g),U.set(0,Math.pow(O.y/L.y,r.zoomSpeed)),dollyOut(U.y),L.copy(O)}function onPointerDown(t){!1!==r.enabled&&(0===N.length&&(r.domElement.setPointerCapture(t.pointerId),r.domElement.addEventListener("pointermove",onPointerMove),r.domElement.addEventListener("pointerup",onPointerUp)),function(t){N.push(t)}(t),"touch"===t.pointerType?function(t){switch(trackPointer(t),N.length){case 1:switch(r.touches.ONE){case De.ROTATE:if(!1===r.enableRotate)return;handleTouchStartRotate(),g=d.TOUCH_ROTATE;break;case De.PAN:if(!1===r.enablePan)return;handleTouchStartPan(),g=d.TOUCH_PAN;break;default:g=d.NONE}break;case 2:switch(r.touches.TWO){case De.DOLLY_PAN:if(!1===r.enableZoom&&!1===r.enablePan)return;r.enableZoom&&handleTouchStartDolly(),r.enablePan&&handleTouchStartPan(),g=d.TOUCH_DOLLY_PAN;break;case De.DOLLY_ROTATE:if(!1===r.enableZoom&&!1===r.enableRotate)return;r.enableZoom&&handleTouchStartDolly(),r.enableRotate&&handleTouchStartRotate(),g=d.TOUCH_DOLLY_ROTATE;break;default:g=d.NONE}break;default:g=d.NONE}g!==d.NONE&&r.dispatchEvent(xi)}(t):function(t){let i;switch(t.button){case 0:i=r.mouseButtons.LEFT;break;case 1:i=r.mouseButtons.MIDDLE;break;case 2:i=r.mouseButtons.RIGHT;break;default:i=-1}switch(i){case ke.DOLLY:if(!1===r.enableZoom)return;!function(t){L.set(t.clientX,t.clientY)}(t),g=d.DOLLY;break;case ke.ROTATE:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===r.enablePan)return;handleMouseDownPan(t),g=d.PAN}else{if(!1===r.enableRotate)return;handleMouseDownRotate(t),g=d.ROTATE}break;case ke.PAN:if(t.ctrlKey||t.metaKey||t.shiftKey){if(!1===r.enableRotate)return;handleMouseDownRotate(t),g=d.ROTATE}else{if(!1===r.enablePan)return;handleMouseDownPan(t),g=d.PAN}break;default:g=d.NONE}g!==d.NONE&&r.dispatchEvent(xi)}(t))}function onPointerMove(t){!1!==r.enabled&&("touch"===t.pointerType?function(t){switch(trackPointer(t),g){case d.TOUCH_ROTATE:if(!1===r.enableRotate)return;handleTouchMoveRotate(t),r.update();break;case d.TOUCH_PAN:if(!1===r.enablePan)return;handleTouchMovePan(t),r.update();break;case d.TOUCH_DOLLY_PAN:if(!1===r.enableZoom&&!1===r.enablePan)return;!function(t){r.enableZoom&&handleTouchMoveDolly(t),r.enablePan&&handleTouchMovePan(t)}(t),r.update();break;case d.TOUCH_DOLLY_ROTATE:if(!1===r.enableZoom&&!1===r.enableRotate)return;!function(t){r.enableZoom&&handleTouchMoveDolly(t),r.enableRotate&&handleTouchMoveRotate(t)}(t),r.update();break;default:g=d.NONE}}(t):function(t){if(!1===r.enabled)return;switch(g){case d.ROTATE:if(!1===r.enableRotate)return;!function(t){if(r.rotateDelay&&Date.now()-r.rotateStartTime<r.rotateDelay)return;x.set(t.clientX,t.clientY),M.subVectors(x,T).multiplyScalar(r.rotateSpeed);const i=r.domElement;rotateLeft(2*Math.PI*M.x/i.clientHeight),rotateUp(2*Math.PI*M.y/i.clientHeight),T.copy(x),r.update()}(t);break;case d.DOLLY:if(!1===r.enableZoom)return;!function(t){O.set(t.clientX,t.clientY),U.subVectors(O,L),U.y>0?dollyOut(getZoomScale()):U.y<0&&dollyIn(getZoomScale()),L.copy(O),r.update()}(t);break;case d.PAN:if(!1===r.enablePan)return;!function(t){F.set(t.clientX,t.clientY),R.subVectors(F,P).multiplyScalar(r.panSpeed),V(R.x,R.y),P.copy(F),r.update()}(t)}}(t))}function onPointerUp(t){removePointer(t),0===N.length&&(r.domElement.releasePointerCapture(t.pointerId),r.domElement.removeEventListener("pointermove",onPointerMove),r.domElement.removeEventListener("pointerup",onPointerUp)),r.dispatchEvent(Mi),g=d.NONE}function onPointerCancel(t){removePointer(t)}function onMouseWheel(t){!1!==r.enabled&&!1!==r.enableZoom&&g===d.NONE&&(t.preventDefault(),r.dispatchEvent(xi),function(t){t.deltaY<0?dollyIn(getZoomScale()):t.deltaY>0&&dollyOut(getZoomScale()),r.update()}(t),r.dispatchEvent(Mi))}function onKeyDown(t){!1!==r.enabled&&!1!==r.enablePan&&function(t){let i=!1;switch(t.code){case r.keys.UP:V(0,r.keyPanSpeed),i=!0;break;case r.keys.BOTTOM:V(0,-r.keyPanSpeed),i=!0;break;case r.keys.LEFT:V(r.keyPanSpeed,0),i=!0;break;case r.keys.RIGHT:V(-r.keyPanSpeed,0),i=!0}i&&(t.preventDefault(),r.update())}(t)}function onContextMenu(t){!1!==r.enabled&&t.preventDefault()}function removePointer(t){delete H[t.pointerId];for(let i=0;i<N.length;i++)if(N[i].pointerId==t.pointerId)return void N.splice(i,1)}function trackPointer(t){let i=H[t.pointerId];void 0===i&&(i=new D,H[t.pointerId]=i),i.set(t.pageX,t.pageY)}function getSecondPointerPosition(t){const i=t.pointerId===N[0].pointerId?N[1]:N[0];return H[i.pointerId]}r.domElement.addEventListener("contextmenu",onContextMenu),r.domElement.addEventListener("pointerdown",onPointerDown),r.domElement.addEventListener("pointercancel",onPointerCancel),r.domElement.addEventListener("wheel",onMouseWheel,{passive:!1}),this.update()}}const Pi="DigitalBacon:MobileOverride";let ki=new class{init(t,i){this._container=t,null==i&&(i={}),this._orbitControlsTarget=i["Orbit Controls Target"]?i["Orbit Controls Target"]:new Q(0,0,0),ze.sessionActive=!1,"XR"==ze.deviceType?this._configureForXR():"POINTER"==ze.deviceType?this._configureForPointer():"MOBILE"==ze.deviceType&&this._configureForMobile()}_configureForXR(){this._div=document.createElement("div"),this._button=VRButton.createButton(ze.renderer),this._button.removeAttribute("style"),this._stylizeElements(),this._button.style.minWidth="150px",this._div.appendChild(this._button),this._div.appendChild(this._createMobileOverrideLink()),ze.renderer.xr.addEventListener("sessionstart",(()=>{ze.sessionActive=!0,Si.init(),ze.renderer.xr.setFoveation(0)})),ze.renderer.xr.addEventListener("sessionend",(()=>{ze.sessionActive=!1}))}_configureForPointer(){this._div=document.createElement("div"),this._button=document.createElement("button"),this._button.innerText="CLICK TO START",this._stylizeElements(),this._div.appendChild(this._button),this._controls=new OrbitControls(ze.camera,ze.renderer.domElement),this._controls.target=this._orbitControlsTarget,this._controls.enableKeys=!1,this._controls.maxPolarAngle=Math.PI-.3,this._controls.minPolarAngle=.3,this._controls.minDistance=.05,this._controls.enablePan=!1,this._controls.enabled=!1,this._controls.rotateDelay=20,this._controlsUpdateNumber=0,this._controls.addEventListener("change",(()=>{this._controlsUpdateNumber++})),this._button.addEventListener("click",(()=>{this._div.style.display="none",this._controls.enabled=!0,ze.sessionActive=!0,Si.init(),fi.createPointerControls()}))}_configureForMobile(){this._div=document.createElement("div"),this._button=document.createElement("button"),this._button.innerText="TAP TO START",this._stylizeElements(),this._div.appendChild(this._button),localStorage.getItem(Pi)&&this._div.appendChild(this._createVROverrideLink()),this._controls=new OrbitControls(ze.camera,ze.renderer.domElement),this._controls.target=this._orbitControlsTarget,this._controls.maxPolarAngle=Math.PI-.3,this._controls.minPolarAngle=.3,this._controls.minDistance=.05,this._controls.enablePan=!1,this._controls.enabled=!1,this._controls.rotateDelay=20,this._controlsUpdateNumber=0,this._controls.addEventListener("change",(()=>{this._controlsUpdateNumber++})),this._button.addEventListener("click",(()=>{this._div.style.display="none",this._controls.enabled=!0,ze.sessionActive=!0,Si.init(),fi.createMobileControls()}))}_stylizeElements(){this._div.style.position="absolute",this._div.style.top="75%",this._div.style.transform="translateY(-50%)",this._div.style.width="100%",this._div.style.textAlign="center",this._div.style.backgroundColor="rgba(0,0,0,0.5)",this._div.style.padding="10px 0",this._button.style.padding="12px",this._button.style.border="2px solid #ffc7e5",this._button.style.borderRadius="4px",this._button.style.background="none",this._button.style.color="#ffc7e5",this._button.style.font="normal 18px sans-serif",this._button.style.outline="none",this._button.style.transition="background-color .15s ease-in-out",this._button.onmouseenter=()=>{this._button.style.cursor="pointer",this._button.style.background="rgba(0, 0, 0, 0.5)"},this._button.onmouseleave=()=>{this._button.style.cursor="inherit",this._button.style.background="none"}}_createMobileOverrideLink(){let t=document.createElement("a");return t.innerText="Use Touchscreen Controls",t.href="#",t.style.display="block",t.style.paddingTop="12px",t.style.color="rgb(255, 199, 229)",t.addEventListener("click",(()=>{event.preventDefault(),localStorage.setItem(Pi,!0),window.location.reload()})),t}_createVROverrideLink(){let t=document.createElement("a");return t.innerText="Use VR Controls",t.href="#",t.style.display="block",t.style.paddingTop="12px",t.style.color="rgb(255, 199, 229)",t.addEventListener("click",(()=>{event.preventDefault(),localStorage.removeItem(Pi),window.location.reload()})),t}displayButton(){this._container.appendChild(this._div)}exitXRSession(){this._button.click()}enableOrbit(){this._controls&&(this._controls.enableRotate=!0)}disableOrbit(){this._controls&&(this._controls.enableRotate=!1)}getControlsUpdateNumber(){return this._controlsUpdateNumber}getCameraDistance(){if(this._controls)return this._controls.getDistance()}};const Di={jpg:"jpg",jpeg:"jpeg",png:"png",glb:"glb"},Qi={glb:"glb"};let Fi=new class{constructor(){this._input=document.createElement("input"),this._input.type="file",this._locks=new Set,this._assetIds=[],this._fileListenerActive=!1,this._triggerUpload=!1,this._addEventListeners()}_addEventListeners(){this._input.addEventListener("change",(()=>{this._upload()})),"XR"!=ze.deviceType&&(this._input.addEventListener("click",(t=>{t.stopPropagation()})),this._eventType="MOBILE"==ze.deviceType?"touchend":"click",this._clickListener=t=>{setTimeout((()=>{this._triggerUpload&&(this._triggerUpload=!1,this._input.click())}),20)})}_uploadProjectFile(){this._input.files.length>0&&this._callback&&this._callback(this._input.files[0])}_uploadAssets(){this.uploadFiles(this._input.files,this._callback)}uploadFiles(t,i){let r=uuidv4();this._locks.add(r);for(let r of t){let t=r.name.split(".").pop().toLowerCase();if(t in Di){let d=uuidv4();t in Ye?(this._locks.add(d),ui.addNewAsset(r,r.name,Ve.IMAGE,(t=>{this._libraryCallback(t,d,i)}))):t in Qi?(this._locks.add(d),ui.addNewAsset(r,r.name,Ve.MODEL,(t=>{this._libraryCallback(t,d,i)}))):console.log("TODO: Support other file types")}else console.log("TODO: Tell user invalid filetype, and list valid ones")}this._input.value="",this._locks.delete(r),0==this._locks.size&&(i&&i(this._assetIds),this._assetIds=[])}_libraryCallback(t,i,r){this._assetIds.push(t),this._locks.delete(i),0==this._locks.size&&(r&&r(this._assetIds),this._assetIds=[])}listenForAssets(t,i,r){if(this._fileListenerActive)throw new Error("File listener already in use");this._callback=t,this._fileListenerActive=!0,this._input.multiple=i,this._upload=this._uploadAssets,this._input.accept=r==Ve.IMAGE?"image/*":r==Ve.MODEL?".glb":"",document.addEventListener(this._eventType,this._clickListener)}listenForProjectFile(t){if(this._fileListenerActive)throw new Error("File listener already in use");this._callback=t,this._fileListenerActive=!0,this._input.multiple=!1,this._input.accept=".zip",this._upload=this._uploadProjectFile,document.addEventListener(this._eventType,this._clickListener)}triggerUpload(){"XR"==ze.deviceType?(ki.exitXRSession(),this._input.click()):this._triggerUpload=!0}stopListening(){this._callback=null,this._fileListenerActive=!1,document.removeEventListener(this._eventType,this._clickListener)}};class Interactable{constructor(t){this._threeObj=t,this._state=Bi.IDLE,this.children=new Set,this._hoveredOwners=new Set,this._selectedOwners=new Set}isOnlyGroup(){console.error("Interactable.isOnlyGroup() should be overridden")}getThreeObj(){return this._threeObj}getState(){return this._state}setState(t){this._state!=t&&(this._state=t,this._threeObj.states&&t in this._threeObj.states&&this._threeObj.setState(t))}addHoveredBy(t){console.error("Interactable.addHoveredBy(owner) should be overridden")}removeHoveredBy(t){console.error("Interactable.removeHoveredBy(owner) should be overridden")}addSelectedBy(t){console.error("Interactable.addSelectedBy(owner) should be overridden")}removeSelectedBy(t){console.error("Interactable.removeSelectedBy(owner) should be overridden")}reset(){this._hoveredOwners.clear(),this._selectedOwners.clear(),this.setState(Bi.IDLE),this.children.forEach((t=>{t.reset()}))}addChild(t){t.parent&&t.parent.removeChild(t),this.children.add(t),t.parent=this}addChildren(t){t.forEach((t=>{this.addChild(t)}))}removeChild(t){this.children.delete(t),t.parent=null}removeChildren(t){t.forEach((t=>{this.removeChild(t)}))}}class PointerInteractable extends Interactable{constructor(t,i,r,d,A,g){super(t),this._actionFunc=i,this._canDisableOrbit="XR"!=ze.deviceType&&0!=r,this.canDisplayPointer="XR"==ze.deviceType&&0!=d,this.specificOption=A,this._draggableActionFunc=g}isOnlyGroup(){return null==this._actionFunc&&!this.canDisplayPointer&&!this._canDisableOrbit}isDraggable(){return null!=this._draggableActionFunc}_determineAndSetState(){this._selectedOwners.size>0?this.setState(Bi.SELECTED):this._hoveredOwners.size>0?this.setState(Bi.HOVERED):this.setState(Bi.IDLE)}addHoveredBy(t,i){this._hoveredOwners.has(t)||(this._selectedOwners.has(t)&&this.triggerAction(i),this._hoveredOwners.add(t),0==this._selectedOwners.size&&this.setState(Bi.HOVERED))}removeHoveredBy(t){this._hoveredOwners.delete(t),this._determineAndSetState()}addSelectedBy(t,i){this._selectedOwners.add(t),this.setState(Bi.SELECTED),this._canDisableOrbit&&ki.disableOrbit(),this._draggableActionFunc&&this._draggableActionFunc(i)}removeSelectedBy(t){this._selectedOwners.delete(t),this._determineAndSetState(),this._canDisableOrbit&&ki.enableOrbit()}triggerAction(t){null!=this._actionFunc&&this._actionFunc(t)}triggerDraggableAction(t){null!=this._draggableActionFunc&&this._draggableActionFunc(t)}updateAction(t){this._actionFunc=t}static emptyGroup(){return new PointerInteractable(null,null,!1,!1)}static createDraggable(t,i,r){return new PointerInteractable(t,i,!0,!0,null,r)}}const Ri=.008,Li=.01;class ThreeMeshUIHelper{static createTextBlock(t){let i=t.text?t.text:"",r=t.fontSize?t.fontSize:Mt.body,d=t.fontColor?t.fontColor:St.white,A=t.backgroundColor?t.backgroundColor:null,g=t.backgroundOpacity?t.backgroundOpacity:0,b=t.justifyContent||"center",I=t.textAlign||"center",w=t.height?t.height:.05,C=t.width?t.width:.7,B=numberOr(t.margin,Li),S=new je.Block({height:w,width:C,margin:B,offset:0,justifyContent:b,textAlign:I,backgroundColor:A,backgroundOpacity:g,interLine:0}),T=new je.Text({content:i,fontColor:d,fontSize:r,offset:0});return t.fontFamily&&t.fontTexture&&T.set({fontFamily:t.fontFamily,fontTexture:t.fontTexture}),S.add(T),S}static createButtonBlock(t){let i=t.text,r=t.backgroundTexture,d=t.backgroundTextureScale?t.backgroundTextureScale:1,A=t.borderRadius?t.borderRadius:.01,g=t.fontSize?t.fontSize:Mt.body,b=t.fontColor?t.fontColor:St.white,I=t.idleBackgroundColor||St.defaultIdle,w=t.hoveredBackgroundColor||St.defaultHovered,C=t.selectedBackgroundColor||St.defaultHovered,B=numberOr(t.idleOpacity,.7),S=numberOr(t.hoveredOpacity,.8),T=numberOr(t.selectedOpacity,.8),x=t.height?t.height:.15,M=t.width?t.width:.7,P=numberOr(t.margin,Li),D=new je.Block({height:x,width:M,justifyContent:"center",alignItems:"center",margin:P,borderWidth:0,borderRadius:A,interLine:0});if(r){let t=new je.Block({height:x*d,width:M*d,backgroundTexture:r,offset:1e-4,borderRadius:0});D.add(t)}if(i){let r=new je.Text({content:i,fontColor:b,fontSize:g,offset:0});t.fontFamily&&t.fontTexture&&r.set({fontFamily:t.fontFamily,fontTexture:t.fontTexture}),D.add(r)}return D.setupState({state:Bi.IDLE,attributes:{offset:Ri,backgroundOpacity:B,backgroundColor:I}}),D.setupState({state:Bi.HOVERED,attributes:{offset:Ri,backgroundOpacity:S,backgroundColor:w}}),D.setupState({state:Bi.SELECTED,attributes:{offset:.004,backgroundOpacity:T,backgroundColor:C}}),D.setState(Bi.IDLE),D}static createInputBlock(t){let i=t.text||" ";t.backgroundTexture;let r=t.fontSize?t.fontSize:Mt.body,d=t.fontColor?t.fontColor:St.white,A=t.idleBackgroundColor||St.defaultIdle,g=t.hoveredBackgroundColor||St.defaultHovered,b=t.selectedBackgroundColor||St.defaultHovered,I=numberOr(t.idleOpacity,.7),w=numberOr(t.hoveredOpacity,.8),C=numberOr(t.selectedOpacity,.8),B=t.height?t.height:.15,S=t.width?t.width:.7,T=numberOr(t.margin,Li),x=new je.Block({height:B,width:S,justifyContent:"center",alignItems:"center",margin:T,borderWidth:.001,interLine:0}),M=new je.Text({content:i,fontColor:d,fontSize:r,offset:0});return x.add(M),x.setupState({state:Bi.IDLE,attributes:{offset:Ri,backgroundOpacity:I,backgroundColor:A}}),x.setupState({state:Bi.HOVERED,attributes:{offset:Ri,backgroundOpacity:w,backgroundColor:g}}),x.setupState({state:Bi.SELECTED,attributes:{offset:.004,backgroundOpacity:C,backgroundColor:b}}),x.setState(Bi.IDLE),x}static createCheckboxBlock(t){let i=t.selectedColor?t.selectedColor:St.black,r=t.height?t.height:.15,d=t.width?t.width:.7,A=t.initialValue||0,g=numberOr(t.margin,Li),b=new je.Block({height:r,width:d,justifyContent:"center",alignItems:"center",margin:g,offset:.004,borderWidth:0,backgroundColor:St.white}),I=new je.Block({height:.9*r,width:.9*d,backgroundColor:i,backgroundOpacity:.8*A,backgroundTexture:vt.checkmarkIcon,offset:.001});return b.add(I),b.setupState({state:Bi.IDLE,attributes:{offset:Ri,backgroundOpacity:.7}}),b.setupState({state:Bi.HOVERED,attributes:{offset:Ri,backgroundOpacity:.8}}),b.setupState({state:Bi.SELECTED,attributes:{offset:.004,backgroundOpacity:.8}}),b.setState(Bi.IDLE),b.toggle=()=>.8==I.backgroundOpacity?(I.set({backgroundOpacity:0}),0):(I.set({backgroundOpacity:.8}),1),b.getIsChecked=()=>.8==I.backgroundOpacity,b}static createColorBlock(t){let i=t.selectedColor?t.selectedColor:St.yellow,r=t.height?t.height:.15,d=t.width?t.width:.7,A=numberOr(t.margin,Li),g=new je.Block({height:r,width:d,margin:A,backgroundColor:i,backgroundOpacity:1,offset:Ri,borderWidth:.001});return g.setupState({state:Bi.IDLE,attributes:{offset:Ri,backgroundOpacity:.7}}),g.setupState({state:Bi.HOVERED,attributes:{offset:Ri,backgroundOpacity:.8}}),g.setupState({state:Bi.SELECTED,attributes:{offset:.004,backgroundOpacity:.8}}),g.setState(Bi.IDLE),g}}let Oi=new class{init(){this._currentAction={},this._disableOwners=new Set,this._setupButtons()}_setupButtons(){this._undoRedoParent=new je.Block({height:.12,width:.04,backgroundColor:St.defaultMenuBackground,backgroundOpacity:0}),this._undoButton=ThreeMeshUIHelper.createButtonBlock({backgroundTexture:vt.undoIcon,backgroundTextureScale:.8,height:.04,width:.04}),this._redoButton=ThreeMeshUIHelper.createButtonBlock({backgroundTexture:vt.redoIcon,backgroundTextureScale:.8,height:.04,width:.04}),this._undoButton.visible=!1,this._redoButton.visible=!1,this._undoRedoParent.set({fontFamily:Tt,fontTexture:xt}),this._undoRedoParent.position.fromArray([.245,0,-.001]),this._undoRedoParent.add(this._undoButton),this._undoRedoParent.add(this._redoButton),this._containerInteractable=new PointerInteractable(null,null,!1),this._undoInteractable=new PointerInteractable(this._undoButton,(()=>{this._undo()})),this._redoInteractable=new PointerInteractable(this._redoButton,(()=>{this._redo()}))}addButtons(t,i){i.addChild(this._containerInteractable),t.add(this._undoRedoParent)}reset(){this._currentAction={},this._disableUndo(),this._disableRedo()}addAction(t,i){let r={head:this._currentAction,undo:t,redo:i};return this._currentAction.tail=r,this._currentAction=r,0==this._disableOwners.size&&(this._enableUndo(),this._disableRedo()),r}deleteAction(t){t.head&&(t.head.tail=t.tail,t.tail&&(t.tail.head=t.head),this._currentAction==t&&(this._currentAction=t.head),this._currentAction.head||this._disableUndo())}_undo(){this._currentAction.undo&&this._currentAction.undo(),this._currentAction.head&&(this._currentAction=this._currentAction.head,this._enableRedo()),this._currentAction.head||this._disableUndo()}_redo(){this._currentAction.tail&&(this._enableUndo(),this._currentAction=this._currentAction.tail,this._currentAction.redo&&this._currentAction.redo()),this._currentAction.tail||this._disableRedo()}_enableUndo(){this._undoButton.visible=!0,this._containerInteractable.addChild(this._undoInteractable)}_disableUndo(){this._undoButton.visible=!1,this._containerInteractable.removeChild(this._undoInteractable)}_enableRedo(){this._redoButton.visible=!0,this._containerInteractable.addChild(this._redoInteractable)}_disableRedo(){this._redoButton.visible=!1,this._containerInteractable.removeChild(this._redoInteractable)}enable(t){this._disableOwners.delete(t),0==this._disableOwners.size&&(this._currentAction.head&&this._enableUndo(),this._currentAction.tail&&this._enableRedo())}disable(t){this._disableOwners.add(t),this._disableUndo(),this._disableRedo()}};const Ui=new Fe,Ni=new Q,Hi=new Q,Gi=new A,ji={X:new Q(1,0,0),Y:new Q(0,1,0),Z:new Q(0,0,1)},zi={type:"change"},Vi={type:"mouseDown"},Yi={type:"mouseUp",mode:null},Wi={type:"objectChange"};class TransformControls extends R{constructor(t,i){super(),void 0===i&&(console.warn('THREE.TransformControls: The second parameter "domElement" is now mandatory.'),i=document),this.isTransformControls=!0,this.visible=!1,this.domElement=i,this.domElement.style.touchAction="none";const r=new TransformControlsGizmo;this._gizmo=r,this.add(r);const d=new TransformControlsPlane;this._plane=d,this.add(d);const g=this;function defineProperty(t,i){let A=i;Object.defineProperty(g,t,{get:function(){return void 0!==A?A:i},set:function(i){A!==i&&(A=i,d[t]=i,r[t]=i,g.dispatchEvent({type:t+"-changed",value:i}),g.dispatchEvent(zi))}}),g[t]=i,d[t]=i,r[t]=i}defineProperty("camera",t),defineProperty("object",void 0),defineProperty("enabled",!0),defineProperty("axis",null),defineProperty("mode","translate"),defineProperty("translationSnap",null),defineProperty("rotationSnap",null),defineProperty("scaleSnap",null),defineProperty("space","world"),defineProperty("size",1),defineProperty("dragging",!1),defineProperty("showX",!0),defineProperty("showY",!0),defineProperty("showZ",!0);const b=new Q,I=new Q,w=new A,C=new A,B=new Q,S=new A,T=new Q,x=new Q,M=new Q,P=new Q;defineProperty("worldPosition",b),defineProperty("worldPositionStart",I),defineProperty("worldQuaternion",w),defineProperty("worldQuaternionStart",C),defineProperty("cameraPosition",B),defineProperty("cameraQuaternion",S),defineProperty("pointStart",T),defineProperty("pointEnd",x),defineProperty("rotationAxis",M),defineProperty("rotationAngle",0),defineProperty("eye",P),this._offset=new Q,this._startNorm=new Q,this._endNorm=new Q,this._cameraScale=new Q,this._parentPosition=new Q,this._parentQuaternion=new A,this._parentQuaternionInv=new A,this._parentScale=new Q,this._worldScaleStart=new Q,this._worldQuaternionInv=new A,this._worldScale=new Q,this._positionStart=new Q,this._quaternionStart=new A,this._scaleStart=new Q,this._getPointer=getPointer.bind(this),this._onPointerDown=onPointerDown.bind(this),this._onPointerHover=onPointerHover.bind(this),this._onPointerMove=onPointerMove.bind(this),this._onPointerUp=onPointerUp.bind(this),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointermove",this._onPointerHover),this.domElement.addEventListener("pointerup",this._onPointerUp)}updateMatrixWorld(){void 0!==this.object&&(this.object.updateMatrixWorld(),null===this.object.parent?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):this.object.parent.matrixWorld.decompose(this._parentPosition,this._parentQuaternion,this._parentScale),this.object.matrixWorld.decompose(this.worldPosition,this.worldQuaternion,this._worldScale),this._parentQuaternionInv.copy(this._parentQuaternion).invert(),this._worldQuaternionInv.copy(this.worldQuaternion).invert()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(this.cameraPosition,this.cameraQuaternion,this._cameraScale),this.camera.isOrthographicCamera?this.camera.getWorldDirection(this.eye).negate():this.eye.copy(this.cameraPosition).sub(this.worldPosition).normalize(),super.updateMatrixWorld(this)}pointerHover(t){if(void 0===this.object||!0===this.dragging)return;Ui.setFromCamera(t,this.camera);const i=intersectObjectWithRay(this._gizmo.picker[this.mode],Ui);this.axis=i?i.object.name:null}pointerDown(t){if(void 0!==this.object&&!0!==this.dragging&&0===t.button&&null!==this.axis){Ui.setFromCamera(t,this.camera);const i=intersectObjectWithRay(this._plane,Ui,!0);i&&(this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),this._positionStart.copy(this.object.position),this._quaternionStart.copy(this.object.quaternion),this._scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this._worldScaleStart),this.pointStart.copy(i.point).sub(this.worldPositionStart)),this.dragging=!0,Vi.mode=this.mode,this.dispatchEvent(Vi)}}pointerMove(t){const i=this.axis,r=this.mode,d=this.object;let A=this.space;if("scale"===r?A="local":"E"!==i&&"XYZE"!==i&&"XYZ"!==i||(A="world"),void 0===d||null===i||!1===this.dragging||-1!==t.button)return;Ui.setFromCamera(t,this.camera);const g=intersectObjectWithRay(this._plane,Ui,!0);if(g){if(this.pointEnd.copy(g.point).sub(this.worldPositionStart),"translate"===r)this._offset.copy(this.pointEnd).sub(this.pointStart),"local"===A&&"XYZ"!==i&&this._offset.applyQuaternion(this._worldQuaternionInv),-1===i.indexOf("X")&&(this._offset.x=0),-1===i.indexOf("Y")&&(this._offset.y=0),-1===i.indexOf("Z")&&(this._offset.z=0),"local"===A&&"XYZ"!==i?this._offset.applyQuaternion(this._quaternionStart).divide(this._parentScale):this._offset.applyQuaternion(this._parentQuaternionInv).divide(this._parentScale),d.position.copy(this._offset).add(this._positionStart),this.translationSnap&&("local"===A&&(d.position.applyQuaternion(Gi.copy(this._quaternionStart).invert()),-1!==i.search("X")&&(d.position.x=Math.round(d.position.x/this.translationSnap)*this.translationSnap),-1!==i.search("Y")&&(d.position.y=Math.round(d.position.y/this.translationSnap)*this.translationSnap),-1!==i.search("Z")&&(d.position.z=Math.round(d.position.z/this.translationSnap)*this.translationSnap),d.position.applyQuaternion(this._quaternionStart)),"world"===A&&(d.parent&&d.position.add(Ni.setFromMatrixPosition(d.parent.matrixWorld)),-1!==i.search("X")&&(d.position.x=Math.round(d.position.x/this.translationSnap)*this.translationSnap),-1!==i.search("Y")&&(d.position.y=Math.round(d.position.y/this.translationSnap)*this.translationSnap),-1!==i.search("Z")&&(d.position.z=Math.round(d.position.z/this.translationSnap)*this.translationSnap),d.parent&&d.position.sub(Ni.setFromMatrixPosition(d.parent.matrixWorld))));else if("scale"===r){if(-1!==i.search("XYZ")){let t=this.pointEnd.length()/this.pointStart.length();this.pointEnd.dot(this.pointStart)<0&&(t*=-1),Hi.set(t,t,t)}else Ni.copy(this.pointStart),Hi.copy(this.pointEnd),Ni.applyQuaternion(this._worldQuaternionInv),Hi.applyQuaternion(this._worldQuaternionInv),Hi.divide(Ni),-1===i.search("X")&&(Hi.x=1),-1===i.search("Y")&&(Hi.y=1),-1===i.search("Z")&&(Hi.z=1);d.scale.copy(this._scaleStart).multiply(Hi),this.scaleSnap&&(-1!==i.search("X")&&(d.scale.x=Math.round(d.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==i.search("Y")&&(d.scale.y=Math.round(d.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==i.search("Z")&&(d.scale.z=Math.round(d.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if("rotate"===r){this._offset.copy(this.pointEnd).sub(this.pointStart);const t=20/this.worldPosition.distanceTo(Ni.setFromMatrixPosition(this.camera.matrixWorld));"E"===i?(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this._startNorm.copy(this.pointStart).normalize(),this._endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=this._endNorm.cross(this._startNorm).dot(this.eye)<0?1:-1):"XYZE"===i?(this.rotationAxis.copy(this._offset).cross(this.eye).normalize(),this.rotationAngle=this._offset.dot(Ni.copy(this.rotationAxis).cross(this.eye))*t):"X"!==i&&"Y"!==i&&"Z"!==i||(this.rotationAxis.copy(ji[i]),Ni.copy(ji[i]),"local"===A&&Ni.applyQuaternion(this.worldQuaternion),this.rotationAngle=this._offset.dot(Ni.cross(this.eye).normalize())*t),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),"local"===A&&"E"!==i&&"XYZE"!==i?(d.quaternion.copy(this._quaternionStart),d.quaternion.multiply(Gi.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this._parentQuaternionInv),d.quaternion.copy(Gi.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),d.quaternion.multiply(this._quaternionStart).normalize())}this.dispatchEvent(zi),this.dispatchEvent(Wi)}}pointerUp(t){0===t.button&&(this.dragging&&null!==this.axis&&(Yi.mode=this.mode,this.dispatchEvent(Yi)),this.dragging=!1,this.axis=null)}dispose(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerHover),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.traverse((function(t){t.geometry&&t.geometry.dispose(),t.material&&t.material.dispose()}))}attach(t){return this.object=t,this.visible=!0,this}detach(){return this.object=void 0,this.visible=!1,this.axis=null,this}reset(){this.enabled&&this.dragging&&(this.object.position.copy(this._positionStart),this.object.quaternion.copy(this._quaternionStart),this.object.scale.copy(this._scaleStart),this.dispatchEvent(zi),this.dispatchEvent(Wi),this.pointStart.copy(this.pointEnd))}getRaycaster(){return Ui}getMode(){return this.mode}setMode(t){this.mode=t}setTranslationSnap(t){this.translationSnap=t}setRotationSnap(t){this.rotationSnap=t}setScaleSnap(t){this.scaleSnap=t}setSize(t){this.size=t}setSpace(t){this.space=t}}function getPointer(t){if(this.domElement.ownerDocument.pointerLockElement)return{x:0,y:0,button:t.button};{const i=this.domElement.getBoundingClientRect();return{x:(t.clientX-i.left)/i.width*2-1,y:-(t.clientY-i.top)/i.height*2+1,button:t.button}}}function onPointerHover(t){if(this.enabled)switch(t.pointerType){case"mouse":case"pen":this.pointerHover(this._getPointer(t))}}function onPointerDown(t){this.enabled&&(document.pointerLockElement||this.domElement.setPointerCapture(t.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.pointerHover(this._getPointer(t)),this.pointerDown(this._getPointer(t)))}function onPointerMove(t){this.enabled&&this.pointerMove(this._getPointer(t))}function onPointerUp(t){this.enabled&&(this.domElement.releasePointerCapture(t.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.pointerUp(this._getPointer(t)))}function intersectObjectWithRay(t,i,r){const d=i.intersectObject(t,!0);for(let t=0;t<d.length;t++)if(d[t].object.visible||r)return d[t];return!1}const Xi=new Re,Ki=new Q(0,1,0),Zi=new Q(0,0,0),qi=new g,Ji=new A,$i=new A,es=new Q,ts=new g,is=new Q(1,0,0),ss=new Q(0,1,0),ns=new Q(0,0,1),rs=new Q,as=new Q,os=new Q;class TransformControlsGizmo extends R{constructor(){super(),this.isTransformControlsGizmo=!0,this.type="TransformControlsGizmo";const t=new x({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),i=new X({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),r=t.clone();r.opacity=.15;const d=i.clone();d.opacity=.5;const A=t.clone();A.color.setHex(16711680);const g=t.clone();g.color.setHex(65280);const b=t.clone();b.color.setHex(255);const I=t.clone();I.color.setHex(16711680),I.opacity=.5;const w=t.clone();w.color.setHex(65280),w.opacity=.5;const C=t.clone();C.color.setHex(255),C.opacity=.5;const B=t.clone();B.opacity=.25;const S=t.clone();S.color.setHex(16776960),S.opacity=.25;t.clone().color.setHex(16776960);const T=t.clone();T.color.setHex(7895160);const M=new Le(0,.04,.1,12);M.translate(0,.05,0);const P=new Oe(.08,.08,.08);P.translate(0,.04,0);const D=new J;D.setAttribute("position",new Ue([0,0,0,1,0,0],3));const Q=new Le(.0075,.0075,.5,3);function CircleGeometry(t,i){const r=new He(t,.0075,3,64,i*Math.PI*2);return r.rotateY(Math.PI/2),r.rotateX(Math.PI/2),r}Q.translate(0,.25,0);const F={X:[[new te(M,A),[.5,0,0],[0,0,-Math.PI/2]],[new te(M,A),[-.5,0,0],[0,0,Math.PI/2]],[new te(Q,A),[0,0,0],[0,0,-Math.PI/2]]],Y:[[new te(M,g),[0,.5,0]],[new te(M,g),[0,-.5,0],[Math.PI,0,0]],[new te(Q,g)]],Z:[[new te(M,b),[0,0,.5],[Math.PI/2,0,0]],[new te(M,b),[0,0,-.5],[-Math.PI/2,0,0]],[new te(Q,b),null,[Math.PI/2,0,0]]],XYZ:[[new te(new Ne(.1,0),B.clone()),[0,0,0]]],XY:[[new te(new Oe(.15,.15,.01),C.clone()),[.15,.15,0]]],YZ:[[new te(new Oe(.15,.15,.01),I.clone()),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new te(new Oe(.15,.15,.01),w.clone()),[.15,0,.15],[-Math.PI/2,0,0]]]},L={X:[[new te(new Le(.2,0,.6,4),r),[.3,0,0],[0,0,-Math.PI/2]],[new te(new Le(.2,0,.6,4),r),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new te(new Le(.2,0,.6,4),r),[0,.3,0]],[new te(new Le(.2,0,.6,4),r),[0,-.3,0],[0,0,Math.PI]]],Z:[[new te(new Le(.2,0,.6,4),r),[0,0,.3],[Math.PI/2,0,0]],[new te(new Le(.2,0,.6,4),r),[0,0,-.3],[-Math.PI/2,0,0]]],XYZ:[[new te(new Ne(.2,0),r)]],XY:[[new te(new Oe(.2,.2,.01),r),[.15,.15,0]]],YZ:[[new te(new Oe(.2,.2,.01),r),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new te(new Oe(.2,.2,.01),r),[.15,0,.15],[-Math.PI/2,0,0]]]},O={START:[[new te(new Ne(.01,2),d),null,null,null,"helper"]],END:[[new te(new Ne(.01,2),d),null,null,null,"helper"]],DELTA:[[new se(function(){const t=new J;return t.setAttribute("position",new Ue([0,0,0,1,1,1],3)),t}(),d),null,null,null,"helper"]],X:[[new se(D,d.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new se(D,d.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new se(D,d.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},U={XYZE:[[new te(CircleGeometry(.5,1),T),null,[0,Math.PI/2,0]]],X:[[new te(CircleGeometry(.5,.5),A)]],Y:[[new te(CircleGeometry(.5,.5),g),null,[0,0,-Math.PI/2]]],Z:[[new te(CircleGeometry(.5,.5),b),null,[0,Math.PI/2,0]]],E:[[new te(CircleGeometry(.75,1),S),null,[0,Math.PI/2,0]]]},N={AXIS:[[new se(D,d.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},H={XYZE:[[new te(new xe(.25,10,8),r)]],X:[[new te(new He(.5,.1,4,24),r),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new te(new He(.5,.1,4,24),r),[0,0,0],[Math.PI/2,0,0]]],Z:[[new te(new He(.5,.1,4,24),r),[0,0,0],[0,0,-Math.PI/2]]],E:[[new te(new He(.75,.1,2,24),r)]]},G={X:[[new te(P,A),[.5,0,0],[0,0,-Math.PI/2]],[new te(Q,A),[0,0,0],[0,0,-Math.PI/2]],[new te(P,A),[-.5,0,0],[0,0,Math.PI/2]]],Y:[[new te(P,g),[0,.5,0]],[new te(Q,g)],[new te(P,g),[0,-.5,0],[0,0,Math.PI]]],Z:[[new te(P,b),[0,0,.5],[Math.PI/2,0,0]],[new te(Q,b),[0,0,0],[Math.PI/2,0,0]],[new te(P,b),[0,0,-.5],[-Math.PI/2,0,0]]],XY:[[new te(new Oe(.15,.15,.01),C),[.15,.15,0]]],YZ:[[new te(new Oe(.15,.15,.01),I),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new te(new Oe(.15,.15,.01),w),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new te(new Oe(.1,.1,.1),B.clone())]]},j={X:[[new te(new Le(.2,0,.6,4),r),[.3,0,0],[0,0,-Math.PI/2]],[new te(new Le(.2,0,.6,4),r),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new te(new Le(.2,0,.6,4),r),[0,.3,0]],[new te(new Le(.2,0,.6,4),r),[0,-.3,0],[0,0,Math.PI]]],Z:[[new te(new Le(.2,0,.6,4),r),[0,0,.3],[Math.PI/2,0,0]],[new te(new Le(.2,0,.6,4),r),[0,0,-.3],[-Math.PI/2,0,0]]],XY:[[new te(new Oe(.2,.2,.01),r),[.15,.15,0]]],YZ:[[new te(new Oe(.2,.2,.01),r),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new te(new Oe(.2,.2,.01),r),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new te(new Oe(.2,.2,.2),r),[0,0,0]]]},V={X:[[new se(D,d.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new se(D,d.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new se(D,d.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]};function setupGizmo(t){const i=new R;for(const r in t)for(let d=t[r].length;d--;){const A=t[r][d][0].clone(),g=t[r][d][1],b=t[r][d][2],I=t[r][d][3],w=t[r][d][4];A.name=r,A.tag=w,g&&A.position.set(g[0],g[1],g[2]),b&&A.rotation.set(b[0],b[1],b[2]),I&&A.scale.set(I[0],I[1],I[2]),A.updateMatrix();const C=A.geometry.clone();C.applyMatrix4(A.matrix),A.geometry=C,A.renderOrder=1/0,A.position.set(0,0,0),A.rotation.set(0,0,0),A.scale.set(1,1,1),i.add(A)}return i}this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=setupGizmo(F)),this.add(this.gizmo.rotate=setupGizmo(U)),this.add(this.gizmo.scale=setupGizmo(G)),this.add(this.picker.translate=setupGizmo(L)),this.add(this.picker.rotate=setupGizmo(H)),this.add(this.picker.scale=setupGizmo(j)),this.add(this.helper.translate=setupGizmo(O)),this.add(this.helper.rotate=setupGizmo(N)),this.add(this.helper.scale=setupGizmo(V)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}updateMatrixWorld(t){const i="local"===("scale"===this.mode?"local":this.space)?this.worldQuaternion:$i;this.gizmo.translate.visible="translate"===this.mode,this.gizmo.rotate.visible="rotate"===this.mode,this.gizmo.scale.visible="scale"===this.mode,this.helper.translate.visible="translate"===this.mode,this.helper.rotate.visible="rotate"===this.mode,this.helper.scale.visible="scale"===this.mode;let r=[];r=r.concat(this.picker[this.mode].children),r=r.concat(this.gizmo[this.mode].children),r=r.concat(this.helper[this.mode].children);for(let t=0;t<r.length;t++){const d=r[t];let A;if(d.visible=!0,d.rotation.set(0,0,0),d.position.copy(this.worldPosition),A=this.camera.isOrthographicCamera?(this.camera.top-this.camera.bottom)/this.camera.zoom:this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),d.scale.set(1,1,1).multiplyScalar(A*this.size/4),"helper"!==d.tag){if(d.quaternion.copy(i),"translate"===this.mode||"scale"===this.mode){const t=.99,r=.2;"X"===d.name&&Math.abs(Ki.copy(is).applyQuaternion(i).dot(this.eye))>t&&(d.scale.set(1e-10,1e-10,1e-10),d.visible=!1),"Y"===d.name&&Math.abs(Ki.copy(ss).applyQuaternion(i).dot(this.eye))>t&&(d.scale.set(1e-10,1e-10,1e-10),d.visible=!1),"Z"===d.name&&Math.abs(Ki.copy(ns).applyQuaternion(i).dot(this.eye))>t&&(d.scale.set(1e-10,1e-10,1e-10),d.visible=!1),"XY"===d.name&&Math.abs(Ki.copy(ns).applyQuaternion(i).dot(this.eye))<r&&(d.scale.set(1e-10,1e-10,1e-10),d.visible=!1),"YZ"===d.name&&Math.abs(Ki.copy(is).applyQuaternion(i).dot(this.eye))<r&&(d.scale.set(1e-10,1e-10,1e-10),d.visible=!1),"XZ"===d.name&&Math.abs(Ki.copy(ss).applyQuaternion(i).dot(this.eye))<r&&(d.scale.set(1e-10,1e-10,1e-10),d.visible=!1)}else"rotate"===this.mode&&(Ji.copy(i),Ki.copy(this.eye).applyQuaternion(Gi.copy(i).invert()),-1!==d.name.search("E")&&d.quaternion.setFromRotationMatrix(qi.lookAt(this.eye,Zi,ss)),"X"===d.name&&(Gi.setFromAxisAngle(is,Math.atan2(-Ki.y,Ki.z)),Gi.multiplyQuaternions(Ji,Gi),d.quaternion.copy(Gi)),"Y"===d.name&&(Gi.setFromAxisAngle(ss,Math.atan2(Ki.x,Ki.z)),Gi.multiplyQuaternions(Ji,Gi),d.quaternion.copy(Gi)),"Z"===d.name&&(Gi.setFromAxisAngle(ns,Math.atan2(Ki.y,Ki.x)),Gi.multiplyQuaternions(Ji,Gi),d.quaternion.copy(Gi)));d.visible=d.visible&&(-1===d.name.indexOf("X")||this.showX),d.visible=d.visible&&(-1===d.name.indexOf("Y")||this.showY),d.visible=d.visible&&(-1===d.name.indexOf("Z")||this.showZ),d.visible=d.visible&&(-1===d.name.indexOf("E")||this.showX&&this.showY&&this.showZ),d.material._color=d.material._color||d.material.color.clone(),d.material._opacity=d.material._opacity||d.material.opacity,d.material.color.copy(d.material._color),d.material.opacity=d.material._opacity,this.enabled&&this.axis&&(d.name===this.axis||this.axis.split("").some((function(t){return d.name===t})))&&(d.material.color.setHex(16776960),d.material.opacity=1)}else d.visible=!1,"AXIS"===d.name?(d.visible=!!this.axis,"X"===this.axis&&(Gi.setFromEuler(Xi.set(0,0,0)),d.quaternion.copy(i).multiply(Gi),Math.abs(Ki.copy(is).applyQuaternion(i).dot(this.eye))>.9&&(d.visible=!1)),"Y"===this.axis&&(Gi.setFromEuler(Xi.set(0,0,Math.PI/2)),d.quaternion.copy(i).multiply(Gi),Math.abs(Ki.copy(ss).applyQuaternion(i).dot(this.eye))>.9&&(d.visible=!1)),"Z"===this.axis&&(Gi.setFromEuler(Xi.set(0,Math.PI/2,0)),d.quaternion.copy(i).multiply(Gi),Math.abs(Ki.copy(ns).applyQuaternion(i).dot(this.eye))>.9&&(d.visible=!1)),"XYZE"===this.axis&&(Gi.setFromEuler(Xi.set(0,Math.PI/2,0)),Ki.copy(this.rotationAxis),d.quaternion.setFromRotationMatrix(qi.lookAt(Zi,Ki,ss)),d.quaternion.multiply(Gi),d.visible=this.dragging),"E"===this.axis&&(d.visible=!1)):"START"===d.name?(d.position.copy(this.worldPositionStart),d.visible=this.dragging):"END"===d.name?(d.position.copy(this.worldPosition),d.visible=this.dragging):"DELTA"===d.name?(d.position.copy(this.worldPositionStart),d.quaternion.copy(this.worldQuaternionStart),Ni.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),Ni.applyQuaternion(this.worldQuaternionStart.clone().invert()),d.scale.copy(Ni),d.visible=this.dragging):(d.quaternion.copy(i),this.dragging?d.position.copy(this.worldPositionStart):d.position.copy(this.worldPosition),this.axis&&(d.visible=-1!==this.axis.search(d.name)))}super.updateMatrixWorld(t)}}class TransformControlsPlane extends te{constructor(){super(new Ge(1e5,1e5,2,2),new x({visible:!1,wireframe:!0,side:Z,transparent:!0,opacity:.1,toneMapped:!1})),this.isTransformControlsPlane=!0,this.type="TransformControlsPlane"}updateMatrixWorld(t){let i=this.space;switch(this.position.copy(this.worldPosition),"scale"===this.mode&&(i="local"),rs.copy(is).applyQuaternion("local"===i?this.worldQuaternion:$i),as.copy(ss).applyQuaternion("local"===i?this.worldQuaternion:$i),os.copy(ns).applyQuaternion("local"===i?this.worldQuaternion:$i),Ki.copy(as),this.mode){case"translate":case"scale":switch(this.axis){case"X":Ki.copy(this.eye).cross(rs),es.copy(rs).cross(Ki);break;case"Y":Ki.copy(this.eye).cross(as),es.copy(as).cross(Ki);break;case"Z":Ki.copy(this.eye).cross(os),es.copy(os).cross(Ki);break;case"XY":es.copy(os);break;case"YZ":es.copy(rs);break;case"XZ":Ki.copy(os),es.copy(as);break;case"XYZ":case"E":es.set(0,0,0)}break;default:es.set(0,0,0)}0===es.length()?this.quaternion.copy(this.cameraQuaternion):(ts.lookAt(Ni.set(0,0,0),es,Ki),this.quaternion.setFromRotationMatrix(ts)),super.updateMatrixWorld(t)}}const ls=["translate","rotate","scale"];function ascSort(t,i){return t.distance-i.distance}function intersectObject(t,i,r,d){if(t.layers.test(i.layers)&&t.raycast(i,r),!0===d){const d=t.children;for(let t=0,A=d.length;t<A;t++)intersectObject(d[t],i,r,!0)}}let hs=new class{init(t,i,r){this._canvas=t,this._transformControls=new TransformControls(i,this._canvas),this._transformControls.setSize(1.25),this._attachedAssets={},this._placingObject={},this._preTransformStates={},this._id=uuidv4(),"XR"!=ze.deviceType&&(r.add(this._transformControls),this._addEventListeners()),wt.subscribe(this._id,qe,(t=>{if(t!=vi.EDIT)for(let t in this._attachedAssets)this.detach(t)})),wt.subscribe(this._id,at,(t=>{if(!t.targetOnlyMenu)for(let t in this._attachedAssets)this.detach(t)})),wt.subscribe(this._id,$e,(t=>{for(let i in this._attachedAssets)this._attachedAssets[i]==t.instance&&this._detachDeleted(i)})),wt.subscribe(this._id,pt,(t=>{for(let t in this._attachedAssets)this._detachDeleted(t)}))}_addEventListeners(){this._transformControls.addEventListener("mouseDown",(()=>{ki.disableOrbit();let t=this._attachedAssets[ze.deviceType];this._preTransformStates[t.getId()]=t.getEditorHelper().getObjectTransformation()})),this._transformControls.addEventListener("mouseUp",(()=>{ki.enableOrbit();let t=this._attachedAssets[ze.deviceType],i=t.getEditorHelper();i.roundAttributes(!0);let r=this._preTransformStates[t.getId()],d=i.getObjectTransformation();i.setObjectTransformation(r,d)})),this._transformControls.addEventListener("objectChange",(()=>{ze.renderer.info.render.frame%6==0&&this._attachedAssets[ze.deviceType].getEditorHelper().roundAttributes()}));let t=document.getElementById("place-button");t.addEventListener("click",(()=>{this._placingObject[ze.deviceType]=!this._placingObject[ze.deviceType],$("#transform-controls > button").removeClass("selected"),this._placingObject[ze.deviceType]?($(t).addClass("selected"),this._transformControls.detach()):($("#"+this._transformControls.mode+"-button").addClass("selected"),this._transformControls.attach(this._attachedAssets[ze.deviceType].getObject()))})),document.getElementById("clone-button").addEventListener("click",(()=>{this._clone()})),document.getElementById("delete-button").addEventListener("click",(()=>{this._delete()})),document.getElementById("close-button").addEventListener("click",(()=>{this.detach()}));for(let t of ls){let i=document.getElementById(t+"-button");i.addEventListener("click",(()=>{$("#transform-controls > button").removeClass("selected"),$(i).addClass("selected"),this._transformControls.setMode(t),this._placingObject[ze.deviceType]=!1,this._transformControls.attach(this._attachedAssets[ze.deviceType].getObject())}))}window.addEventListener("copy",(t=>{this._copy(t)})),window.addEventListener("paste",(t=>{this._paste(t)})),this._canvas.addEventListener("keydown",(t=>{"Backspace"==t.code&&this._delete()}))}_copy(t){let i=ze.deviceType,r=this._attachedAssets[i];if(r){let i="assetId:"+r.getAssetId()+":instanceId:"+r.getId();t.clipboardData.setData("text/digitalbacon",i),t.preventDefault()}}_paste(t){ze.isEditor&&(t.clipboardData.types.indexOf("Files")>=0&&this._pasteFiles(t.clipboardData.files),t.clipboardData.types.indexOf("text/digitalbacon")>=0&&this._pasteDigitalBaconData(t))}_pasteDigitalBaconData(t){let i=t.clipboardData.getData("text/digitalbacon");if(!i.includes("assetId:")||!i.includes(":instanceId:"))return;let[,r,,d]=i.split(":"),A=yn.getInstancesForAssetId(r)[d];if(A){let i=A.clone();this._isDragging(A)||this._offsetClone(i),t.preventDefault()}}_pasteFiles(t){Fi.uploadFiles(t,(t=>{ze.camera.getWorldPosition(Pt[0]),ze.camera.getWorldDirection(Pt[1]),Pt[1].normalize().multiplyScalar(11/12),Pt[0].add(Pt[1]);let i=Pt[0].toArray();Pt[0].set(0,0,1),Pt[1].setY(0).normalize(),Qt.setFromUnitVectors(Pt[0],Pt[1]),Dt.setFromQuaternion(Qt);let r=Dt.toArray();for(let d of t){let t=ui.getType(d);t==Ve.IMAGE?yn.addImage({assetId:d,position:i,rotation:r,doubleSided:!0,transparent:!0,visualEdit:!0}):t==Ve.MODEL&&yn.addGLTF({assetId:d,position:i,rotation:r,visualEdit:!0})}}))}_clone(t){t=t||ze.deviceType;let i=this._attachedAssets[t];if(i){let t=i.clone();this._isDragging(i)||this._offsetClone(t)}}_offsetClone(t){let i=t.getObject();Pt[0].fromArray([0,1,0]),Pt[1].setFromMatrixColumn(ze.camera.matrixWorld,0),Pt[1].y=0,Pt[1].setLength(.2),Pt[1].applyAxisAngle(Pt[0],-Math.PI/4),i.position.add(Pt[1]),t.getEditorHelper().roundAttributes(!0)}_delete(t){t=t||ze.deviceType;let i=this._attachedAssets[t];i&&yn.deleteAssetInstance(i)}checkPlacement(t){for(let i in t){let r=t[i],d=r.raycaster;d.far=1/0;let A=r.isPressed,g="XR"==ze.deviceType?this._intersectRelevantObjects(d,i):d.intersectObjects(yn.getObjects(),!0),b=this._attachedAssets[i];if(g.length>0&&(r.closestPoint=g[0].point,A)){"XR"==ze.deviceType?ps.hands[i].remove(b.getObject()):($("#transform-controls > button").removeClass("selected"),$("#"+this._transformControls.mode+"-button").addClass("selected"),this._transformControls.attach(b.getObject()),this._placingObject[i]=!1);let t=b.getEditorHelper(),r=t.getObjectTransformation();if(t.place(g[0]),"XR"==ze.deviceType)return void this.detach(i);t.roundAttributes(!0);let d=t.getObjectTransformation();t.setObjectTransformation(r,d)}}}scaleWithTwoHands(){let t=ps.getDistanceBetweenHands()/this._initialScalingDistance;this._attachedAssets[pi.LEFT].getObject().scale.set(t*this._initialScalingValues.x,t*this._initialScalingValues.y,t*this._initialScalingValues.z),ze.renderer.info.render.frame%6==0&&this._attachedAssets[pi.LEFT].getEditorHelper()._publish(["scale"])}_intersectRelevantObjects(t,i){let r=[],d=yn.getObjects(),A=this._attachedAssets[i].getObject();for(let i=0,g=d.length;i<g;i++)d[i]!=A&&intersectObject(d[i],t,r,!0);return r.sort(ascSort),r}_getOtherHand(t){return t==pi.RIGHT?pi.LEFT:t==pi.LEFT?pi.RIGHT:null}attach(t,i){let r={instance:t,option:i=i||ze.deviceType};if(this._attachedAssets[i]=t,"XR"==ze.deviceType){this._placingObject[i]=!0;let d=this._getOtherHand(i);t==this._attachedAssets[d]?(ps.hands[i].remove(t.getObject()),ps.hands[d].remove(t.getObject()),r.twoHandScaling=!0,this._twoHandScaling=!0,this._initialScalingDistance=ps.getDistanceBetweenHands(),this._initialScalingValues=t.getObject().scale.clone()):(this._preTransformStates[t.getId()]=t.getEditorHelper().getObjectTransformation(),ps.hands[i].attach(t.getObject()),t.makeTranslucent()),r.position=t.getPosition(),r.rotation=t.getRotation(),Oi.disable(this._id)}else this._transformControls.attach(t.getObject()),$("#transform-controls").removeClass("hidden"),$("#transform-controls > button").removeClass("selected"),$("#"+this._transformControls.mode+"-button").addClass("selected");wt.publish(this._id,tt,r)}detach(t){let i,r,d;t=t||ze.deviceType;let A=this._attachedAssets[t];if(!A)return;let g={instance:A,option:t};if("XR"==ze.deviceType){ps.hands[t].remove(A.getObject());let b=this._getOtherHand(t);this._attachedAssets[b]==A?(ps.hands[b].attach(A.getObject()),g.twoHandScaling=!0,this._twoHandScaling=!1):(A.returnTransparency(),i=A.getEditorHelper(),i.roundAttributes(!0),r=this._preTransformStates[A.getId()],d=i.getObjectTransformation()),g.position=A.getPosition(),g.rotation=A.getRotation(),1==Object.keys(this._attachedAssets).length&&Oi.enable(this._id)}delete this._attachedAssets[t],this._placingObject[t]=!1,this._transformControls.detach(),$("#transform-controls").addClass("hidden"),wt.publish(this._id,it,g),i&&r&&d&&i.setObjectTransformation(r,d)}_detachDeleted(t){let i=this._attachedAssets[t];if(i){if("XR"==ze.deviceType){let r=this._getOtherHand(t);if(this._attachedAssets[r]==i)this._twoHandScaling=!1;else{i.returnTransparency();let t=this._preTransformStates[i.getId()],r=i.getEditorHelper();for(let r in t)i.getObject()[r].fromArray(t[r]);r._publish(["position","rotation","scale"])}1==Object.keys(this._attachedAssets).length&&Oi.enable(this._id)}else{this._transformControls.detach(),$("#transform-controls").addClass("hidden");let t=this._preTransformStates[ze.deviceType],r=i.getEditorHelper();for(let r in t)i.getObject()[r].fromArray(t[r]);r._publish(["position","rotation","scale"])}delete this._attachedAssets[t],this._placingObject[t]=!1}}_isDragging(t){return t?this._transformControls.dragging&&t.getObject()==this.getObject():this._transformControls.dragging}getObject(){return this._transformControls.object}isPlacingObject(t){return this._placingObject[t||ze.deviceType]}isTwoHandScaling(){return this._twoHandScaling}};let ds=new class extends InteractableHandler{constructor(){super()}init(){super.init(),this._cursors={}}_setupXRSubscription(){wt.subscribe(this._id,qe,(t=>{t==vi.EDIT?this.update=this._updateForXREdit:t==vi.COPY_PASTE?this.update=this._updateForXRCopyPaste:t==vi.DELETE?this.update=this._updateForXRDelete:this.update=this._updateForXR}))}createXRCursor(i){if(this._cursors[i])return this._cursors[i];let r=document.createElement("canvas");r.width=64,r.height=64;let d=r.getContext("2d");d.beginPath(),d.arc(32,32,29,0,2*Math.PI),d.lineWidth=5,d.stroke(),d.fillStyle="white",d.fill();let A=new t.SpriteMaterial({map:new t.CanvasTexture(r),depthTest:!1,sizeAttenuation:!1});for(let i in pi){let r=new t.Sprite(A);r.scale.set(.015,.015,.015),r.visible=!1,r.renderOrder=1/0,this._cursors[i]=r}return this._cursors[i]}_getRaycaster(i){if(i==pi.LEFT||i==pi.RIGHT){let r=new t.Vector3,d=new t.Vector3,A=fi.getXRController(i,"targetRay");return A.getWorldPosition(r),A.getWorldDirection(d).negate().normalize(),new t.Raycaster(r,d,.01,50)}if("POINTER"==i){let i=fi.getPointerPosition(),r=new t.Raycaster;return r.setFromCamera(i,ze.camera),r}if("MOBILE"==i){let i=fi.getPointerPosition(),r=new t.Raycaster;return r.setFromCamera(i,ze.camera),r}}_isControllerPressed(t){if(t==pi.LEFT||t==pi.RIGHT){let i=fi.getXRGamepad(t);return null!=i&&i.buttons[0].pressed}return"POINTER"==t?fi.isPointerPressed():"MOBILE"==t?fi.isScreenTouched():void 0}_raycastInteractables(t,i){let r=t.raycaster;for(let d of i){if(d.specificOption&&d.specificOption!=t.option)continue;let i,A=d.getThreeObj();if(null!=A){if(i=null==r?[]:r.intersectObject(A,!0),0!=i.length){0!=d.children.size&&this._raycastInteractables(t,d.children);let r=i[0].distance;r<t.closestPointDistance&&(t.closestPointDistance=r,t.closestPoint=i[0].point,t.closestInteractable=d)}}else 0!=d.children.size&&this._raycastInteractables(t,d.children)}}_updateInteractables(t){for(let i in t){let r=t[i],d=r.isPressed,A=this._hoveredInteractables[i],g=this._selectedInteractables[i],b=r.closestInteractable;b&&!b.isOnlyGroup()?d?g?g==b&&g.isDraggable()&&g.triggerDraggableAction(r.closestPoint):A==b&&(b.addSelectedBy(i,r.closestPoint),this._selectedInteractables[i]=b,b.removeHoveredBy(i),this._hoveredInteractables[i]=null):(A!=b?(A&&A.removeHoveredBy(i),b.addHoveredBy(i,r.closestPoint),this._hoveredInteractables[i]=b):g&&g.isDraggable()&&g.triggerAction(),g&&(g.removeSelectedBy(i),this._selectedInteractables[i]=null)):d||(A&&(A.removeHoveredBy(i),this._hoveredInteractables[i]=null),g&&(g.removeSelectedBy(i),this._selectedInteractables[i]=null,g.isDraggable()&&g.triggerAction()))}}_updateInteractablesMobile(t){for(let i in t){let r=t[i],d=r.isPressed,A=this._selectedInteractables[i];if(this._mobileWasTouched){if(!A)return void(this._mobileWasTouched=d);d?A.isDraggable()&&this._checkMobileAction(r,A,!0):(this._mobileWasTouched=!1,!this._checkMobileAction(r,A)&&A.isDraggable()&&A.triggerAction(),A.removeSelectedBy(i))}else if(d){this._mobileWasTouched=!0,this._raycastInteractables(r,this._interactables);let t=r.closestInteractable;t&&(t.addSelectedBy(i,r.closestPoint),this._selectedInteractables[i]=t)}}}_checkMobileAction(t,i,r){if(this._raycastInteractables(t,this._interactables),t.closestInteractable==i)return r?i.triggerDraggableAction(t.closestPoint):i.triggerAction(t.closestPoint),!0}_updateCursor(t){let i=t.cursor;i&&(null!=t.closestPoint?(i.position.copy(t.closestPoint),i.visible||(i.visible=!0)):i.visible&&(i.visible=!1))}_updateForXREdit(){if(!ze.sessionActive)return;if(hs.isTwoHandScaling())return void hs.scaleWithTwoHands();let t={},i={},r=[];for(let d in pi){let A={option:d,raycaster:this._getRaycaster(d),isPressed:this._isControllerPressed(d),closestPoint:null,closestPointDistance:Number.MAX_SAFE_INTEGER,cursor:this._cursors[d]};hs.isPlacingObject(d)?i[d]=A:(t[d]=A,this._raycastInteractables(A,this._interactables),this._raycastInteractables(A,this._toolInteractables[vi.EDIT])),r.push(A)}this._updateInteractables(t),hs.checkPlacement(i);for(let t of r)this._updateCursor(t)}_updateForXRCopyPaste(){if(!ze.sessionActive)return;let t={};for(let i in pi){let r={option:i,raycaster:this._getRaycaster(i),isPressed:this._isControllerPressed(i),closestPoint:null,closestPointDistance:Number.MAX_SAFE_INTEGER,cursor:this._cursors[i]};t[i]=r,this._raycastInteractables(r,this._interactables),this._raycastInteractables(r,this._toolInteractables[vi.COPY_PASTE])}this._updateInteractables(t),null==t[pi.RIGHT].closestPoint&&Ei.checkPlacement(t[pi.RIGHT]);for(let i in t)this._updateCursor(t[i])}_updateForXRDelete(){if(!ze.sessionActive)return;let t={};for(let i in pi){let r={option:i,raycaster:this._getRaycaster(i),isPressed:this._isControllerPressed(i),closestPoint:null,closestPointDistance:Number.MAX_SAFE_INTEGER,cursor:this._cursors[i]};t[i]=r,this._raycastInteractables(r,this._interactables),this._raycastInteractables(r,this._toolInteractables[vi.DELETE])}this._updateInteractables(t);for(let i in t)this._updateCursor(t[i])}_updateForXR(){if(!ze.sessionActive)return;let t={};for(let i in pi){let r={option:i,raycaster:this._getRaycaster(i),isPressed:this._isControllerPressed(i),closestPoint:null,closestPointDistance:Number.MAX_SAFE_INTEGER,cursor:this._cursors[i]};t[i]=r,this._raycastInteractables(r,this._interactables)}this._updateInteractables(t);for(let i in t)this._updateCursor(t[i])}_updateForPointer(){if(!ze.sessionActive)return;let t={POINTER:{option:"POINTER",raycaster:this._getRaycaster("POINTER"),isPressed:this._isControllerPressed("POINTER"),closestPoint:null,closestPointDistance:Number.MAX_SAFE_INTEGER}};hs.isPlacingObject()?hs.checkPlacement(t):(this._raycastInteractables(t.POINTER,this._interactables),this._updateInteractables(t))}_updateForMobile(){if(!ze.sessionActive)return;let t={MOBILE:{option:"MOBILE",raycaster:this._getRaycaster("MOBILE"),isPressed:this._isControllerPressed("MOBILE"),closestPoint:null,closestPointDistance:Number.MAX_SAFE_INTEGER}};hs.isPlacingObject()?hs.checkPlacement(t):this._updateInteractablesMobile(t)}};class UserHand{constructor(t){if(!t in pi)throw new Error("constructor for UserXRInputSource must be LEFT or RIGHT");if("XR"!=ze.deviceType)throw new Error("UserXRInputSource is for XR only");this._hand=t,this._isGripPressed=!1,this._vector3=new Q,this._euler=new Re,this._quaternion=new A,this._setup()}_setup(){this._controller=fi.getXRController(this._hand,"grip"),this._controllerModel=fi.getXRControllerModel(this._hand),this._cursor=ds.createXRCursor(this._hand)}isInScene(){return null!=this._controller.parent}getWorldPosition(){return this._controller.getWorldPosition(this._vector3),this._vector3}getWorldRotation(){return this._controller.getWorldQuaternion(this._quaternion),this._quaternion.normalize(),this._euler.setFromQuaternion(this._quaternion),this._euler}getWorldQuaternion(){return this._controller.getWorldQuaternion(this._quaternion),this._quaternion}add(t){this._controller.add(t)}attach(t){this._controller.attach(t)}remove(t){t.parent==this._controller&&ze.scene.attach(t)}addToScene(t){this._controller.add(this._controllerModel),ze.scene.add(this._cursor)}removeFromScene(){this._controller.remove(this._controllerModel),ze.scene.remove(this._cursor)}}const cs={AVATAR:1,LEFT_HAND:2,RIGHT_HAND:4,USER_VELOCITY:8,USER_POSITION:16},As="DigitalBacon:Avatar";let us=new class{init(t){null==t&&(t={}),this._id=uuidv4(),this._dynamicAssets=[],this._userObj=t["User Object"],this._flightEnabled=t["Flight Enabled"]||!1,this._avatarUrl=localStorage.getItem(As)||"https://d1a370nemizbjq.cloudfront.net/6a141c79-d6e5-4b0d-aa0d-524a8b9b54a4.glb",this._avatarFadeUpdateNumber=0,this._setup(),this._addSubscriptions()}_setup(){if("XR"!=ze.deviceType)this._avatar=new Avatar({"Focus Camera":!0,URL:this._avatarUrl});else{this.hands={};for(let t of[pi.RIGHT,pi.LEFT]){let i=new UserHand(t);this.hands[t]=i}}this._basicMovement=new BasicMovement({"User Object":this._userObj,Avatar:this._avatar}),this._dynamicAssets.push(this._basicMovement)}_addSubscriptions(){wt.subscribe(this._id,It,(t=>{this._userObj.scale.set(t,t,t)}))}getId(){return this._id}getAvatarUrl(){return this._avatarUrl}updateAvatar(t){localStorage.setItem(As,t),this._avatarUrl=t,"XR"!=ze.deviceType&&this._avatar.updateSourceUrl(t),wt.publish(this._id,Xe,this._avatarUrl)}getDistanceBetweenHands(){if("XR"!=ze.deviceType)return;let t=this.hands[pi.LEFT].getWorldPosition(),i=this.hands[pi.RIGHT].getWorldPosition();return t.distanceTo(i)}_pushXRDataForRTC(t){let i=0,r=Ci.getUserScale();ze.camera.getWorldPosition(Pt[0]),this._userObj.getWorldPosition(Pt[1]);let d=Pt[0].sub(Pt[1]).divideScalar(r).toArray();ze.camera.getWorldQuaternion(Qt),Qt.normalize(),Dt.setFromQuaternion(Qt);let A=Dt.toArray();A.pop(),t.push(...d),t.push(...A),i+=cs.AVATAR;for(let g of[pi.LEFT,pi.RIGHT]){let b=this.hands[g];b.isInScene()&&(d=b.getWorldPosition().sub(Pt[1]).divideScalar(r),A=b.getWorldRotation().toArray(),A.pop(),t.push(...d.toArray()),t.push(...A),i+=cs[g+"_HAND"])}return i}getDataForRTC(){let t=0,i=[];return"XR"==ze.deviceType&&(t+=this._pushXRDataForRTC(i)),this._basicMovement.getWorldVelocity().length()>=1e-5&&(i.push(...this._basicMovement.getWorldVelocity().toArray()),t+=cs.USER_VELOCITY),ze.renderer.info.render.frame%300==0&&(this._userObj.getWorldPosition(Pt[0]),i.push(...Pt[0].toArray()),t+=cs.USER_POSITION),[new Uint8Array([t]).buffer,Float32Array.from(i).buffer]}addToScene(t){"XR"!=ze.deviceType?this._avatar.addToScene(ze.cameraFocus):(this.hands[pi.RIGHT].addToScene(t),this.hands[pi.LEFT].addToScene(t))}removeFromScene(){"XR"!=ze.deviceType?this._avatar.removeFromScene():(this.hands[pi.RIGHT].removeFromScene(),this.hands[pi.LEFT].removeFromScene())}_updateAvatar(){let t=ki.getControlsUpdateNumber();if(this._avatarFadeUpdateNumber==t)return;this._avatarFadeUpdateNumber=t;let i=ki.getCameraDistance();if(i>1.2)return;let r=i-this._avatarFadeCameraDistance;if(Math.abs(r)<1e-11)return;this._avatarFadeCameraDistance=i;let d=this._avatar.getObject(),A=Math.max(i,.2);A=(A-.2)/.39999999999999997,0!=A?(d.parent||this._avatar.addToScene(ze.cameraFocus),A<1?this._avatar.fade(A):this._avatar.endFade()):d.parent&&this._avatar.removeFromScene()}update(t){this._avatar&&this._updateAvatar();for(let i=0;i<this._dynamicAssets.length;i++)this._dynamicAssets[i].update(t)}};var ps=us;class Box3Helper extends ie{constructor(t){super(Lt.geometry,Lt.material),this.box=t,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(t){const i=this.box;i.isEmpty()||(i.getCenter(this.position),i.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(t))}}class GripInteractable extends Interactable{constructor(t,i,r,d,A){super(t),this._selectedFunc=i,this._releasedFunc=r,this._draggedFunc=d,this.specificOption=A,this._createBoundingObject()}isOnlyGroup(){return null==this._selectedFunc&&null==this._releasedFunc&&null==this._draggedFunc}isDraggable(){return null!=this._draggedFunc}_createBoundingObject(){this._boundingBox=new t.Box3,this._boundingBoxObj=new Box3Helper(this._boundingBox)}_getBoundingObject(){return this._boundingBox.setFromObject(this._threeObj),this._boundingBox}_displayBoundingObject(){ze.scene.add(this._boundingBoxObj)}_hideBoundingObject(){ze.scene.remove(this._boundingBoxObj)}intersectsSphere(t){let i,r=this._getBoundingObject();return i=!!r&&t.intersectsBox(r),i}distanceToSphere(t){return t.distanceToPoint(this._boundingBox.getCenter(Pt[0]))}_determineAndSetState(){this._selectedOwners.size>0?(this.setState(Bi.SELECTED),this._hoveredOwners.size>=this._selectedOwners.size?this._displayBoundingObject():this._hideBoundingObject()):this._hoveredOwners.size>0?(this.setState(Bi.HOVERED),this._displayBoundingObject()):(this.setState(Bi.IDLE),this._hideBoundingObject())}addHoveredBy(t){this._hoveredOwners.has(t)||(this._hoveredOwners.add(t),0==this._selectedOwners.size&&this.setState(Bi.HOVERED),this._displayBoundingObject())}removeHoveredBy(t){this._hoveredOwners.delete(t),this._determineAndSetState()}addSelectedBy(t){null!=this._selectedFunc&&this._selectedFunc(t),this._selectedOwners.add(t),this.setState(Bi.SELECTED)}removeSelectedBy(t){null!=this._releasedFunc&&this._releasedFunc(t),this._selectedOwners.delete(t),this._determineAndSetState()}triggerDragged(t){null!=this._draggedFunc&&this._draggedFunc(t)}updateAction(t){this._selectedFunc=t}static emptyGroup(){return new GripInteractable}}let gs=new class extends InteractableHandler{constructor(){super()}init(){super.init(),this._spheres={},this._spheres[pi.LEFT]=new t.Sphere,this._spheres[pi.RIGHT]=new t.Sphere,this._box3=new t.Box3}_setupXRSubscription(){wt.subscribe(this._id,qe,(t=>{let i=[pi.LEFT,pi.RIGHT];for(let t of i){let i=this._hoveredInteractables[t];i&&!this._interactables.has(i)&&(this._hoveredInteractables[t].removeHoveredBy(t),delete this._hoveredInteractables[t]);let r=this._selectedInteractables[t];r&&!this._interactables.has(r)&&(this._selectedInteractables[t].removeSelectedBy(t),delete this._selectedInteractables[t])}t==vi.COPY_PASTE?this.update=this._updateForXRCopyPaste:this.update=this._updateForXREdit,this._handTool=t}))}_getBoundingSphere(t){if(t==pi.LEFT||t==pi.RIGHT){let i=fi.getXRController(t,"grip");return this._box3.setFromObject(i).getBoundingSphere(this._spheres[t]),this._spheres[t]}}_isControllerPressed(t){if(t==pi.LEFT||t==pi.RIGHT){let i=fi.getXRGamepad(t);return null!=i&&i.buttons.length>1&&i.buttons[1].pressed}}_scopeInteractables(t,i){let r=t.boundingSphere;if(null!=r)for(let d of i){if(d.specificOption&&d.specificOption!=t.option)continue;if(null!=d.getThreeObj()){if(d.intersectsSphere(r)){0!=d.children.size&&this._scopeInteractables(t,Array.from(d.children));let i=d.distanceToSphere(r);!d.isOnlyGroup()&&i<t.closestPointDistance&&(t.closestPointDistance=i,t.closestInteractable=d)}}else 0!=d.children.size&&this._scopeInteractables(t,d.children)}}_updateInteractables(t){for(let i in t){let r=t[i],d=r.isPressed;this._scopeInteractables(r,this._interactables),this._scopeInteractables(r,this._toolInteractables[this._handTool]);let A=this._hoveredInteractables[i],g=this._selectedInteractables[i],b=r.closestInteractable;b?d?g?g==b&&g.isDraggable()&&g.triggerDraggableAction(i):A==b&&(b.addSelectedBy(i),this._selectedInteractables[i]=b,b.removeHoveredBy(i),this._hoveredInteractables[i]=null):(A!=b&&(A&&A.removeHoveredBy(i),b.addHoveredBy(i),this._hoveredInteractables[i]=b),g&&(g.removeSelectedBy(i),this._selectedInteractables[i]=null)):d||(A&&(A.removeHoveredBy(i),this._hoveredInteractables[i]=null),g&&(g.removeSelectedBy(i),this._selectedInteractables[i]=null))}}_updateForXRCopyPaste(){if(!ze.sessionActive)return;let t={};t[pi.LEFT]={option:pi.LEFT,boundingSphere:this._getBoundingSphere(pi.LEFT),isPressed:this._isControllerPressed(pi.LEFT),closestPointDistance:Number.MAX_SAFE_INTEGER},Ei.hasCopiedObject()?Ei.checkGripPlacement(this._isControllerPressed(pi.RIGHT)):t[pi.RIGHT]={option:pi.RIGHT,boundingSphere:this._getBoundingSphere(pi.RIGHT),isPressed:this._isControllerPressed(pi.RIGHT),closestPointDistance:Number.MAX_SAFE_INTEGER},this._updateInteractables(t)}_updateForXREdit(){if(!ze.sessionActive)return;let t={},i=[pi.LEFT,pi.RIGHT];for(let r=0;r<i.length;r++){let d=i[r];t[d]={option:d,boundingSphere:this._getBoundingSphere(d),isPressed:this._isControllerPressed(d),closestPointDistance:Number.MAX_SAFE_INTEGER}}this._updateInteractables(t)}_updateForPointer(){}_updateForMobile(){}};let ms=new class{constructor(){this._id=uuidv4(),this._heldAssets={},this._quaternion=new A,this._euler1=new Re,this._euler2=new Re,wt.subscribe(this._id,qe,(t=>{for(let t in this._heldAssets){let i=this._heldAssets[t];i.preTransformState&&this.detach(i.controller,i.hand)}})),wt.subscribe(this._id,at,(t=>{if(!t.targetOnlyMenu)for(let t in this._heldAssets){let i=this._heldAssets[t];i.preTransformState&&this.detach(i.controller,i.hand)}})),wt.subscribe(this._id,$e,(t=>{for(let i in this._heldAssets){let r=this._heldAssets[i];if(r.asset==t.instance){let t=r.asset.getEditorHelper(),d=r.asset.getObject();r.preTransformState&&(d.quaternion.fromArray(r.preTransformState),d.rotation.setFromQuaternion(d.quaternion),t._publish(["rotation"])),delete this._heldAssets[i]}}})),wt.subscribe(this._id,pt,(t=>{for(let t in this._heldAssets)delete this._heldAssets[t]}))}attach(t,i,r,d){let A=t.getId(),g=pi.otherHand(i),b=this._heldAssets[A+":"+g];if(b&&b.asset==r)this._swapToHand(t,i,g,d);else{let g={asset:r,controller:t,hand:i};if(d)g.rotationDifference=d;else{let d=r.getWorldQuaternion();g.preTransformState=d.toArray(),g.rotationDifference=t.hands[i].getWorldQuaternion().conjugate().multiply(d).toArray()}this._heldAssets[A+":"+i]=g}if(!d){let t=this._heldAssets[A+":"+i];wt.publish(this._id,tt,{instance:r,option:i,type:"rotate",rotation:t.rotationDifference})}}detach(t,i,r){let d=t.getId(),A=this._heldAssets[d+":"+i];if(A)if(delete this._heldAssets[d+":"+i],r)A.asset.setRotationFromQuaternion(r);else{r=this._update(A);let t=A.asset.getEditorHelper();this._quaternion.fromArray(A.preTransformState),this._euler1.setFromQuaternion(this._quaternion),this._quaternion.fromArray(r),this._euler2.setFromQuaternion(this._quaternion);let d=this._euler1.toArray(),g=this._euler2.toArray();t._updateEuler("rotation",g,!1,!0,d),t._publish(["rotation"]),wt.publish(this._id,it,{instance:A.asset,option:i,type:"rotate",rotation:r})}}update(){for(let t in this._heldAssets){let i=this._heldAssets[t];this._update(i)}}_update(t){if(!t)return;let i=t.controller.hands[t.hand].getWorldQuaternion();this._quaternion.fromArray(t.rotationDifference);let r=i.multiply(this._quaternion).toArray();return t.asset.setRotationFromQuaternion(r),r}_swapToHand(t,i,r,d){let A=t.getId(),g=this._heldAssets[A+":"+r];if(g.hand=i,this._heldAssets[A+":"+i]=g,delete this._heldAssets[A+":"+r],d)g.rotationDifference=d;else{let t=g.asset.getWorldQuaternion();g.rotationDifference=g.controller.hands[g.hand].getWorldQuaternion().conjugate().multiply(t).toArray()}}};let _s=new class{constructor(){this._id=uuidv4(),this._heldAssets={},wt.subscribe(this._id,qe,(t=>{for(let t in this._heldAssets){let i=this._heldAssets[t];i.preTransformState&&this.detach(i.controller,i.hand)}})),wt.subscribe(this._id,at,(t=>{if(!t.targetOnlyMenu)for(let t in this._heldAssets){let i=this._heldAssets[t];i.preTransformState&&this.detach(i.controller,i.hand)}})),wt.subscribe(this._id,$e,(t=>{for(let i in this._heldAssets){let r=this._heldAssets[i];if(r.asset==t.instance){let t=r.asset.getEditorHelper(),d=r.asset.getObject();r.preTransformState&&(d.scale.fromArray(r.preTransformState),t._publish(["scale"])),delete this._heldAssets[i]}}})),wt.subscribe(this._id,pt,(t=>{for(let t in this._heldAssets)delete this._heldAssets[t]}))}attach(t,i,r,d){let A=t.getId(),g=pi.otherHand(i),b=this._heldAssets[A+":"+g];if(b&&b.asset==r)this._swapToHand(t,i,g,d);else{let g={asset:r,controller:t,hand:i};if(d)g.scaleIdentity=d;else{let d=t.hands[i].getWorldPosition().distanceTo(r.getWorldPosition()),A=r.getWorldScale();g.preTransformState=A.toArray(),g.scaleIdentity=A.divideScalar(d).toArray()}this._heldAssets[A+":"+i]=g}if(!d){let t=this._heldAssets[A+":"+i];wt.publish(this._id,tt,{instance:r,option:i,type:"scale",scale:t.scaleIdentity})}}detach(t,i,r){let d=t.getId(),A=this._heldAssets[d+":"+i];if(A)if(delete this._heldAssets[d+":"+i],r)A.asset.setScale(r);else{r=this._update(A);let t=A.asset.getEditorHelper(),d=A.preTransformState,g=r;t._updateVector3("scale",g,!1,!0,d),t._publish(["scale"]),wt.publish(this._id,it,{instance:A.asset,option:i,type:"scale",scale:r})}}update(){for(let t in this._heldAssets){let i=this._heldAssets[t];this._update(i)}}_update(t){if(!t)return;let i=t.asset.getWorldPosition().distanceTo(t.controller.hands[t.hand].getWorldPosition()),r=[t.scaleIdentity[0]*i,t.scaleIdentity[1]*i,t.scaleIdentity[2]*i];return t.asset.setScale(r),r}_swapToHand(t,i,r,d){let A=t.getId(),g=this._heldAssets[A+":"+r];if(g.hand=i,this._heldAssets[A+":"+i]=g,delete this._heldAssets[A+":"+r],d)g.scaleIdentity=d;else{let r=t.hands[i].getWorldPosition().distanceTo(g.asset.getWorldPosition()),d=g.asset.getWorldScale();g.scaleIdentity=d.divideScalar(r).toArray()}}};let fs=new class{constructor(){this._id=uuidv4(),this._heldAssets={},wt.subscribe(this._id,qe,(t=>{for(let t in this._heldAssets){let i=this._heldAssets[t];i.preTransformState&&this.detach(i.controller,i.hand)}})),wt.subscribe(this._id,at,(t=>{if(!t.targetOnlyMenu)for(let t in this._heldAssets){let i=this._heldAssets[t];i.preTransformState&&this.detach(i.controller,i.hand)}})),wt.subscribe(this._id,$e,(t=>{for(let i in this._heldAssets){let r=this._heldAssets[i];if(r.asset==t.instance){let t=r.asset.getEditorHelper(),d=r.asset.getObject();r.preTransformState&&(d.position.fromArray(r.preTransformState),t._publish(["position"])),delete this._heldAssets[i]}}})),wt.subscribe(this._id,pt,(t=>{for(let t in this._heldAssets)delete this._heldAssets[t]}))}attach(t,i,r,d){let A=t.getId(),g=pi.otherHand(i),b=this._heldAssets[A+":"+g];if(b&&b.asset==r)this._swapToHand(t,i,g,d);else{let g={asset:r,controller:t,hand:i};if(d)g.positionDifference=d;else{let t=r.getWorldPosition();g.preTransformState=t.toArray(),g.positionDifference=t.sub(g.controller.hands[i].getWorldPosition()).toArray()}this._heldAssets[A+":"+i]=g}if(!d){let t=this._heldAssets[A+":"+i];wt.publish(this._id,tt,{instance:r,option:i,type:"translate",position:t.positionDifference})}}detach(t,i,r){let d=t.getId(),A=this._heldAssets[d+":"+i];if(A)if(delete this._heldAssets[d+":"+i],r)A.asset.setPosition(r);else{r=this._update(A);let t=A.asset.getEditorHelper(),d=A.preTransformState,g=r;t._updateVector3("position",g,!1,!0,d),t._publish(["position"]),wt.publish(this._id,it,{instance:A.asset,option:i,type:"translate",position:r})}}update(){for(let t in this._heldAssets){let i=this._heldAssets[t];this._update(i)}}_update(t){if(!t)return;let i=t.controller.hands[t.hand].getWorldPosition(),r=[t.positionDifference[0]+i.x,t.positionDifference[1]+i.y,t.positionDifference[2]+i.z];return t.asset.setPosition(r),r}_swapToHand(t,i,r,d){let A=t.getId(),g=this._heldAssets[A+":"+r];if(g.hand=i,this._heldAssets[A+":"+i]=g,delete this._heldAssets[A+":"+r],d)g.positionDifference=d;else{let t=asset.getWorldPosition();g.positionDifference=t.sub(g.controller.hands[g.hand].getWorldPosition()).toArray()}}};const bs={iceServers:[{urls:["stun:stun1.l.google.com:19302","stun:stun2.l.google.com:19302","stun:stun3.l.google.com:19302","stun:stun4.l.google.com:19302"]}]};class RTCPeer{constructor(t,i,r,d,A){this._peerId=t,this._polite=i,this._socket=r,this._onTimeout=A,this._myAudioStream=d,this._myAudioTrack=d.getAudioTracks()[0],this._peerAudioTrack,this._connection=new RTCPeerConnection(bs),this._audio=function(){let t=document.createElement("audio");return t.autoplay=!0,document.body.appendChild(t),t}(),this._makingOffer=!1,this._ignoreOffer=!1,this._isSettingRemoteAnswerPending=!1,this._hasConnected=!1,this._dataChannel=null,i||(this._timeoutId=setTimeout((()=>this._timeout()),2e4)),this._setupConnection(),this._sendDataQueue=new Queue,this._polite||this._setupDataChannel()}_setupConnection(){this._connection.ontrack=t=>{this._peerAudioTrack=t.track,t.track.onunmute=()=>{this._audio.srcObject||(this._audio.srcObject=t.streams[0])}},this._connection.onicecandidate=t=>{this._socket.send({topic:"candidate",to:this._peerId,candidate:t.candidate})},this._connection.onnegotiationneeded=async()=>{try{this._makingOffer=!0,await this._connection.setLocalDescription(),this._socket.send({topic:"description",to:this._peerId,description:this._connection.localDescription})}catch(t){console.error(t)}finally{this._makingOffer=!1}},this._connection.ondatachannel=t=>{this._polite&&(this._dataChannel=t.channel,this._dataChannel.binaryType="arraybuffer",this._dataChannel.bufferedAmountLowThreshold=65536,this._dataChannel.onopen=t=>{this._onSendDataChannelOpen&&this._onSendDataChannelOpen(t)},this._dataChannel.onclose=t=>{this._onSendDataChannelClose&&this._onSendDataChannelClose(t)},this._dataChannel.onmessage=t=>{this._onMessage&&this._onMessage(t.data)})},this._connection.onconnectionstatechange=t=>{let i=this._connection.connectionState;"connected"!=i||this._hasConnected?"disconnected"!=i&&"failed"!=i||(this._polite||(clearTimeout(this._timeoutId),!this._hasConnected&&this._onFailedImpoliteConnect&&this._onFailedImpoliteConnect()),this._onDisconnect&&this._onDisconnect()):(this._hasConnected=!0,this._myAudioTrack&&this._addAudioTrack(),this._polite||clearTimeout(this._timeoutId))}}_setupDataChannel(){this._dataChannel=this._connection.createDataChannel(this._peerId),this._dataChannel.binaryType="arraybuffer",this._dataChannel.bufferedAmountLowThreshold=65536,this._dataChannel.onopen=t=>{this._onSendDataChannelOpen&&this._onSendDataChannelOpen(t)},this._dataChannel.onclose=t=>{this._onSendDataChannelClose&&this._onSendDataChannelClose(t)},this._dataChannel.onmessage=t=>{this._onMessage&&this._onMessage(t.data)}}_timeout(){this._onTimeout&&(this._onFailedImpoliteConnect=null,this._onTimeout())}toggleMyselfMuted(t){this._myAudioTrack&&(this._myAudioTrack.enabled=!t)}togglePeerMuted(t){this._peerAudioTrack&&(this._peerAudioTrack.enabled=!t)}_addAudioTrack(t,i){this._connection.addTrack(this._myAudioTrack,this._myAudioStream)}close(){this._connection.close(),this._audio.srcObject=null,this._audio.parentNode&&document.body.removeChild(this._audio),this._onDisconnect&&this._onDisconnect()}getPeerId(){return this._peerId}setPeerId(t){this._peerId=t}async handleCandidate(t){try{await this._connection.addIceCandidate(t.candidate)}catch(t){this._ignoreOffer||console.error(t)}}async handleDescription(t){let i=t.description;try{let t=!this._makingOffer&&("stable"==this._connection.signalingState||this._isSettingRemoteAnswerPending),r="offer"==i.type&&!t;if(this._ignoreOffer=!this._polite&&r,this._ignoreOffer)return;this._isSettingRemoteAnswerPending="answer"==i.type,await this._connection.setRemoteDescription(i),this._isSettingRemoteAnswerPending=!1,"offer"==i.type&&(await this._connection.setLocalDescription(),this._socket.send({topic:"description",to:this._peerId,description:this._connection.localDescription}))}catch(t){console.error(t)}}isConnected(){return this._hasConnected}sendData(t){this._sendDataQueue.enqueue(t),this._dataChannel.onbufferedamountlow||1==this._sendDataQueue.length&&this._sendData()}_sendData(){let t=this._dataChannel;for(;t.bufferedAmount<=t.bufferedAmountLowThreshold;){try{t.send(this._sendDataQueue.dequeue())}catch(t){if(!t.message.includes("readyState is not 'open'"))throw t}if(0==this._sendDataQueue.length)return}t.onbufferedamountlow=()=>{t.onbufferedamountlow=null,this._sendData()}}setOnDisconnect(t){this._onDisconnect=t}setOnFailedImpoliteConnect(t){this._onFailedImpoliteConnect=t}setOnMessage(t){this._onMessage=t}setOnSendDataChannelOpen(t){this._onSendDataChannelOpen=t}setOnSendDataChannelClose(t){this._onSendDataChannelClose=t}}const Is={audio:!0,video:!1};let ws=new class{constructor(){this._peers={},this._userAudio=function(){let t=document.createElement("audio");return t.autoplay=!0,document.body.appendChild(t),t}(),this._userAudio.defaultMuted=!0,this._userAudio.muted=!0,this._pingIntervalId=null,this._authIntervalId=null}host(t,i,r){this._fetchAuthToken((()=>{this.connect(!0,t,i,r)}),r)}join(t,i,r){this._fetchAuthToken((()=>{this.connect(!1,t,i,r)}),r)}connect(t,i,r,d){this._socket&&this.disconnect(),this._isHost=t,this._roomId=i,this._successCallback=r,this._errorCallback=d,this._userAudio.srcObject?this._setupWebSocket():this._setupUserMedia()}disconnect(){this._socket&&this._socket.close(),this._replacementSocket&&this._replacementSocket.close(),this._pingIntervalId&&(clearInterval(this._pingIntervalId),this._pingIntervalId=null),this._authIntervalId&&(clearInterval(this._authIntervalId),this._authIntervalId=null),this._socket=null,this._isHost=!1;for(let t in this._peers)this._peers[t].close();this._peers={},this._onDisconnect&&this._onDisconnect()}bootPeer(t){this._socket.send({topic:"boot-peer",peerId:t})}designateHost(t){this._socket.send({topic:"designate-host",peerId:t})}setOnPeerIdUpdate(t){this._onPeerIdUpdate=t}setOnSetupPeer(t){this._onSetupPeer=t}setOnDisconnect(t){this._onDisconnect=t}_fetchAuthToken(t,i){fetch(ze.authUrl,{cache:"no-store"}).then((t=>t.json())).then((r=>{if(!r.authToken)return this.disconnect(),void(i&&i({topic:"bad-auth"}));this._authToken=r.authToken,t&&t()})).catch((t=>{this.disconnect(),i&&i({topic:"bad-auth"})}))}_initiateUpdateSocket(){this._socket.send({topic:"update-connection",initiate:!0})}_updateSocket(t){this._replacementSocket.send({topic:"update-connection",code:t})}_updateSocketSuccess(){let t=this._socket;this._socket=this._replacementSocket,this._socket.send=t=>{t.authToken=this._authToken,this._socket._send(JSON.stringify(t))},t.onclose=()=>{},t.close(),this._replacementSocket=null}_replacePeerId(t,i){this._peers[t].setPeerId(i),this._peers[i]=this._peers[t],delete this._peers[t],this._onPeerIdUpdate&&this._onPeerIdUpdate(t,i)}_setupUserMedia(){navigator.mediaDevices.getUserMedia(Is).then((t=>{this._userAudio.srcObject=t,this._setupWebSocket()})).catch((t=>{this._userAudio.srcObject=new MediaStream,this._setupWebSocket()}))}_setupWebSocket(){this._socket=new WebSocket(ze.socketUrl),this._socket.onopen=t=>{this._onSocketOpen(t)},this._socket.onclose=t=>{this._onSocketClose(t)},this._socket.onmessage=t=>{this._onSocketMessage(t)},this._socket.onerror=t=>{this._onSocketError(t)},this._socket._send=this._socket.send,this._socket.send=t=>{t.authToken=this._authToken,this._socket._send(JSON.stringify(t))}}_setupReplacementSocket(){this._replacementSocket=new WebSocket(ze.socketUrl),this._replacementSocket.onopen=()=>{this._initiateUpdateSocket()},this._replacementSocket.onclose=this._socket.onclose,this._replacementSocket.onmessage=this._socket.onmessage,this._replacementSocket.onerror=this._socket.onerror,this._replacementSocket._send=this._replacementSocket.send,this._replacementSocket.send=t=>{t.authToken=this._authToken,this._replacementSocket._send(JSON.stringify(t))}}_onSocketOpen(t){this._socket.send({topic:"identify",roomId:this._roomId,isHost:this._isHost}),this._pingIntervalId=setInterval((()=>{this._socket.send({topic:"ping"})}),54e4),this._authIntervalId=setInterval((()=>{this._fetchAuthToken((()=>{this._setupReplacementSocket()}),(()=>{wt.publish(this._id,ot,{text:"Could not authenticate with Server"})}))}),3e6)}_onSocketClose(t){this._socket&&this.disconnect()}_onSocketMessage(t){let i=JSON.parse(t.data),r=i.topic;"initiate"==r?this._setupRTCPeer(i):"candidate"==r?this._peers[i.from].handleCandidate(i):"description"==r?this._peers[i.from].handleDescription(i):"hosting"==r?this._successCallback&&this._successCallback():"update-connection-ready"==r?this._updateSocket(i.code):"update-connection-success"==r?this._updateSocketSuccess():"replace-connection"==r?this._replacePeerId(i.oldPeerId,i.newPeerId):"designate-host"==r?wt.publish(this._id,Ke):"boot-peer"==r?wt.publish(this._id,Ze,i.peerId):"disconnect"==r?this.disconnect():"error"==r&&"boot-peer"==i.requestTopic?wt.publish(this._id,ot,{text:"Error: Couldn't kick out user"}):"error"==r&&"designate-host"==i.requestTopic?(wt.publish(this._id,Ke),wt.publish(this._id,ot,{text:"Error: Couldn't make user host"})):"error"==r&&"update-connection"==i.requestTopic?(wt.publish(this._id,ot,{text:"Could not reinitiate connection with Server"}),this.disconnect()):(this.disconnect(),this._errorCallback&&this._errorCallback(i))}_onSocketError(t){this.disconnect(),this._errorCallback&&this._errorCallback(t)}_onRTCTimeout(){this._socket&&this._onSocketError({topic:"rtc-timeout"})}_setupRTCPeer(t){let i=t.peerId,r=t.polite;this._peers[i]=new RTCPeer(t.peerId,r,this._socket,this._userAudio.srcObject.clone(),(()=>this._onRTCTimeout())),this._onSetupPeer&&this._onSetupPeer(this._peers[i])}};class PeerHand extends Entity{constructor(i){if(super(),!i in pi)throw new Error("constructor for PeerHand must be LEFT or RIGHT");this._hand=i,this._isGripPressed=!1,this._vector3=new t.Vector3,this._euler=new t.Euler,this._quaternion=new t.Quaternion,this._setup()}_setup(){let i=new t.SphereGeometry(.05),r=new t.MeshLambertMaterial({color:13011043});this._mesh=new t.Mesh(i,r),this._object.add(this._mesh)}getWorldPosition(){return this._object.getWorldPosition(this._vector3),this._vector3}getWorldRotation(){return this._object.getWorldQuaternion(this._quaternion),this._quaternion.normalize(),this._euler.setFromQuaternion(this._quaternion),this._euler}getWorldQuaternion(){return this._object.getWorldQuaternion(this._quaternion),this._quaternion}add(t){this._object.add(t)}attach(t){this._object.attach(t)}remove(t){t.parent==this._object&&ze.scene.attach(t)}}class PeerController extends Entity{constructor(i,r,d,A){super(),this._velocity=new t.Vector3,this._positionError=new t.Vector3,this._errorFixFrame=30,this._username=r||"...",this._displayingUsername=d,this._isXR=A,this._setup(i)}_setup(i){if(this._avatar=new Avatar({URL:i,"Vertical Offset":this._isXR?0:1.7}),this._avatar.addToScene(this._object),this._isXR){this.hands={};for(let t of[pi.RIGHT,pi.LEFT]){let i=new PeerHand(t);this.hands[t]=i,i.addToScene(this._object)}}let r={text:this._username,fontFamily:Tt,fontTexture:xt,fontSize:.06,height:.04,width:.5,offset:0,margin:0};this._usernameBlock=new t.Object3D;let d=ThreeMeshUIHelper.createTextBlock(r),A=ThreeMeshUIHelper.createTextBlock(r);d.rotateY(Math.PI),this._usernameBlock.position.setY(1.85),this._usernameBlock.add(d),this._usernameBlock.add(A),this._displayingUsername&&this._object.add(this._usernameBlock)}_updateAvatarData(t,i){let r=this._avatar.getObject();r.position.fromArray(t,i);let d=t.slice(i+3,i+6);r.rotation.fromArray(d)}_updateHandData(t,i,r){let d=this.hands[r].getObject();d.position.fromArray(t,i);let A=t.slice(i+3,i+6);d.rotation.fromArray(A)}_updateVelocity(t,i,r){if(this._velocity.fromArray(t,i),this._object.position.addScaledVector(this._velocity,r),!this._isXR){if(Pt[0].copy(this._velocity).setY(0),Pt[0].length()<.001)return;Pt[0].multiplyScalar(-1).add(this._object.position),this._object.lookAt(Pt[0])}}_updatePosition(t,i){this._positionError.fromArray(t,i).sub(this._object.position),this._errorFixFrame=0}updateAvatar(t){this._avatar.updateSourceUrl(t)}setDisplayingUsername(t){this._displayingUsername!=t&&(this._displayingUsername=!this._displayingUsername,this._displayingUsername?this._object.add(this._usernameBlock):this._object.remove(this._usernameBlock))}updateScale(t){this._object.scale.set(t,t,t)}updateUsername(t){if(this._username==t)return;this._username=t;let i=t=stringWithMaxLength(t||"...",17);this._usernameBlock.children.forEach((t=>{t.children[1].set({content:i})}))}update(t,i){i?this._updateWithMessage(t,i):this._updateWithoutMessage(t),this._errorFixFrame<30&&(this._object.position.addScaledVector(this._positionError,.03333333333333333),this._errorFixFrame++)}_updateWithMessage(t,i){let r=new Uint8Array(i.slice(2,3))[0],d=new Float32Array(i.slice(3)),A=0;cs.AVATAR&r&&(this._updateAvatarData(d,A),A+=6),cs.LEFT_HAND&r&&(this._updateHandData(d,A,pi.LEFT),A+=6),cs.RIGHT_HAND&r&&(this._updateHandData(d,A,pi.RIGHT),A+=6),cs.USER_VELOCITY&r?(this._updateVelocity(d,A,t),A+=3):this._velocity.set(0,0,0),cs.USER_POSITION&r&&(this._updatePosition(d,A),A+=3)}_updateWithoutMessage(t,i){this._object.position.addScaledVector(this._velocity,t)}}let ys=new class{constructor(){this._materials={},this._materialClassMap={},this._sessionMaterials={}}addNewMaterial(t,i,r,d){let A=new this._materialClassMap[t](i);return this.addMaterial(A,r,d),A}addMaterial(t,i,r){this._materials[t.getId()]||(this._materials[t.getId()]=t,this._sessionMaterials[t.getId()]=t,i||Oi.addAction((()=>{this.deleteMaterial(t,!0,r)}),(()=>{this.addMaterial(t,!0,r)})),t.undoDispose(),r||wt.publish(this._id,st,t))}deleteMaterial(t,i,r){if(!(t.getId()in this._materials))return;let d;i||(d=Oi.addAction((()=>{this.addMaterial(t,!0,r)}),(()=>{this.deleteMaterial(t,!0,r)}))),t.dispose(),delete this._materials[t.getId()],r||wt.publish(this._id,nt,{material:t,undoRedoAction:d})}load(t){if(t)for(let i in t)if(i in this._materialClassMap)for(let r of t[i])this.addNewMaterial(i,r,!0,!0);else console.error("Unrecognized material found")}registerMaterial(t,i){this._materialClassMap[i]=t}getMaterials(){return this._materials}getMaterial(t){return this._materials[t]}getSessionMaterial(t){return this._sessionMaterials[t]}getType(t){return this._materials[t].getMaterialType()}reset(){this._materials={},this._sessionMaterials={}}getMaterialsAssetIds(){return new Set}getMaterialsDetails(){let t={};for(let i in this._materials){let r=this._materials[i],d=r.getMaterialType(),A=r.exportParams();d in t||(t[d]=[]),t[d].push(A)}return t}};let Cs=new class{constructor(){this._textures={},this._textureClassMap={},this._sessionTextures={}}addNewTexture(t,i,r,d){let A=new this._textureClassMap[t](i);return this.addTexture(A,r,d),A}addTexture(t,i,r){this._textures[t.getId()]||(this._textures[t.getId()]=t,this._sessionTextures[t.getId()]=t,i||Oi.addAction((()=>{this.deleteTexture(t,!0,r)}),(()=>{this.addTexture(t,!0,r)})),r||wt.publish(this._id,_t,t))}deleteTexture(t,i,r){if(!(t.getId()in this._textures))return;let d;i||(d=Oi.addAction((()=>{this.addTexture(t,!0,r)}),(()=>{this.deleteTexture(t,!0,r)}))),t.dispose(),delete this._textures[t.getId()],r||wt.publish(this._id,ft,{texture:t,undoRedoAction:d})}load(t){if(t)for(let i in t)if(i in this._textureClassMap)for(let r of t[i])this.addNewTexture(i,r,!0,!0);else console.error("Unrecognized texture found")}registerTexture(t,i){this._textureClassMap[i]=t}getTextures(){return this._textures}getTexture(t){return this._textures[t]}getSessionTexture(t){return this._sessionTextures[t]}getTextureName(t){return t in this._textures?this._textures[t].getName():null}getType(t){return this._textures[t].getTextureType()}reset(){this._textures={},this._sessionTextures={}}getTexturesAssetIds(){let t=new Set;for(let i in this._textures){let r=this._textures[i].getAssetIds();for(let i of r)t.add(i)}return t}getTexturesDetails(){let t={};for(let i in this._textures){let r=this._textures[i],d=r.getTextureType(),A=r.exportParams();d in t||(t[d]=[]),t[d].push(A)}return t}};const Bs=16384,vs={instance_added:"_handleInstanceAdded",instance_deleted:"_handleInstanceDeleted",instance_updated:"_handleInstanceUpdated",instance_attached:"_handleInstanceAttached",instance_detached:"_handleInstanceDetached",material_added:"_handleMaterialAdded",material_deleted:"_handleMaterialDeleted",material_updated:"_handleMaterialUpdated",settings_updated:"_handleSettingsUpdated",texture_added:"_handleTextureAdded",texture_deleted:"_handleTextureDeleted",texture_updated:"_handleTextureUpdated"};let Es=new class{constructor(){this._id=uuidv4(),this._handlingLocks=new Set,this._handleQueue=new Queue,this._publishQueue=new Queue}init(t){this._partyHandler=t;let i={avatar:(t,i)=>{this._handleAvatar(t,i)},asset_added:(t,i)=>{this._handleAssetAdded(t,i)},username:(t,i)=>{this._handleUsername(t,i)},user_scale:(t,i)=>{this._handleUserScale(t,i)}};for(let t in vs){let r=vs[t];i[t]=(t,i)=>{this._handleBlockable(r,t,i)}}this._partyHandler.addMessageHandlers(i)}_handleAvatar(t,i){t.controller?t.controller.updateAvatar(i.url):(t.controller=new PeerController(i.url,t.username,this._partyHandler.getDisplayingUsernames(),i.isXR),t.controller.addToScene(ze.scene))}_handleAssetAdded(t,i){let r=uuidv4();this._handlingLocks.add(r);let d=i.parts,A=i.assetId,g=i.name,b=i.type,I=[];this._partyHandler.setEventBufferHandler(t,((t,i)=>{if(I.push(i),I.length==d){this._partyHandler.setEventBufferHandler(t);let i=new Blob(I),d={Name:g,Type:b};ui.loadLibraryAsset(A,d,i).then((()=>{wt.publish(this._id,We,A),this._removeHandlingLock(r)}))}}))}_handleBlockable(t,i,r){this._handlingLocks.size>0?this._handleQueue.enqueue((()=>{this[t](i,r)})):this[t](i,r)}_handleInstanceAdded(t,i){let r=yn.getSessionInstance(i.instance.id);r?(r.addToScene(ze.scene),yn.addAsset(r,!0,!0)):r=yn.addInstance(i.instance,!0,!0),wt.publish(this._id,Je,r)}_handleInstanceDeleted(t,i){let r=yn.getInstancesForAssetId(i.assetId)[i.id];if(r){yn.deleteAssetInstance(r,!0,!0);let t=$e+":"+i.id,d={instance:r};wt.publish(this._id,t,d,!0)}else console.error("Instance to delete does not exist")}_handleInstanceUpdated(t,i){let r=i.instance,d=yn.getSessionInstance(r.id);d&&this._handleAssetUpdate(d,r,et)}_handleInstanceAttached(t,i){let r=yn.getSessionInstance(i.id);if(r){let d=r.getEditorHelper();d&&d.attachToPeer(t,i)}}_handleInstanceDetached(t,i){let r=yn.getSessionInstance(i.id);if(r){let d=r.getEditorHelper();d&&d.detachFromPeer(t,i)}}_handleMaterialAdded(t,i){let r=ys.getSessionMaterial(i.material.id);r?ys.addMaterial(r,!0,!0):r=ys.addNewMaterial(i.type,i.material,!0,!0),wt.publish(this._id,st,r)}_handleMaterialDeleted(t,i){let r=ys.getMaterial(i.id);if(r){ys.deleteMaterial(r,!0,!0);let t=nt+":"+i.id,d={material:r};wt.publish(this._id,t,d,!0)}else console.error("Material to delete does not exist")}_handleMaterialUpdated(t,i){let r=i.material,d=ys.getSessionMaterial(r.id);d&&this._handleAssetUpdate(d,r,rt)}_handleSettingsUpdated(t,i){let r=i.settings;for(let t in r){let i;if("User Settings"==t)i="setUserSetting";else{if("Skybox"!=t)return void console.error("Unknown setting updated: "+t);i="setSkyboxSide"}for(let d in r[t])Ci[i](d,r[t][d],!0)}wt.publish(this._id,mt,{settings:r})}_handleTextureAdded(t,i){let r=Cs.getSessionTexture(i.texture.id);r?Cs.addTexture(r,!0,!0):r=Cs.addNewTexture(i.type,i.texture,!0,!0),wt.publish(this._id,_t,r)}_handleTextureDeleted(t,i){let r=Cs.getTexture(i.id);if(r){Cs.deleteTexture(r,!0,!0);let t=ft+":"+i.id,d={texture:r};wt.publish(this._id,t,d,!0)}else console.error("Texture to delete does not exist")}_handleTextureUpdated(t,i){let r=i.texture,d=Cs.getSessionTexture(r.id);d&&this._handleAssetUpdate(d,r,bt)}_handleAssetUpdate(t,i,r){let d=[];for(let r in i){if("id"==r)continue;d.push(r);let A=capitalizeFirstLetter(r);"set"+A in t&&t["set"+A](i[r]),ze.isEditor&&t.getEditorHelper().updateMenuField(r)}let A={asset:t,fields:d};wt.publish(this._id,r,A)}_handleUsername(t,i){let r=i.username;t.username!=r&&(t.username=r,t.controller&&t.controller.updateUsername(r),wt.publish(this._id,ut,{peer:t}))}_handleUserScale(t,i){let r=i.scale;t.controller&&t.controller.updateScale(r)}handlePartyStarted(){wt.publish(this._id,dt)}handlePartyEnded(){wt.publish(this._id,ht)}handlePeerConnected(t){wt.publish(this._id,ct,{peer:t})}handlePeerDisconnected(t){wt.publish(this._id,At,{peer:t})}_removeHandlingLock(t){for(this._handlingLocks.delete(t);this._handleQueue.length>0&&0==this._handlingLocks.size;)this._handleQueue.dequeue()()}_publishAssetAdded(t){return new Promise((i=>{let r=ui.getLibrary()[t];r.Blob.arrayBuffer().then((d=>{let A=[],g=Math.ceil(d.byteLength/Bs);for(let t=0;t<g;t++){let i=t*Bs,r=(t+1)*Bs;A.push(d.slice(i,r))}this._partyHandler.sendToAllPeers(JSON.stringify({topic:"asset_added",assetId:t,name:r.Name,type:r.Type,parts:A.length}));for(let t of A)this._partyHandler.sendToAllPeers(t);i()}))}))}_publishAvatarUpdated(t){return this._partyHandler.sendToAllPeers(JSON.stringify({topic:"avatar",url:t})),Promise.resolve()}_publishInstanceAdded(t){let i={topic:"instance_added",instance:t.exportParams()};return this._partyHandler.sendToAllPeers(JSON.stringify(i)),Promise.resolve()}_publishInstanceDeleted(t){let i={topic:"instance_deleted",id:t.getId(),assetId:t.getAssetId()};return this._partyHandler.sendToAllPeers(JSON.stringify(i)),Promise.resolve()}_publishInstanceAttached(t){let i={topic:"instance_attached",id:t.instance.getId(),assetId:t.instance.getAssetId(),option:t.option,type:t.type};return"XR"==ze.deviceType&&(i.position=t.position,i.rotation=t.rotation,i.scale=t.scale,i.twoHandScaling=t.twoHandScaling,i.isXR=!0),this._partyHandler.sendToAllPeers(JSON.stringify(i)),Promise.resolve()}_publishInstanceDetached(t){let i={topic:"instance_detached",id:t.instance.getId(),assetId:t.instance.getAssetId(),option:t.option,type:t.type};return"XR"==ze.deviceType&&(i.position=t.position,i.rotation=t.rotation,i.scale=t.scale,i.twoHandScaling=t.twoHandScaling,i.isXR=!0),this._partyHandler.sendToAllPeers(JSON.stringify(i)),Promise.resolve()}_publishMaterialAdded(t){let i={topic:"material_added",material:t.exportParams(),type:t.getMaterialType()};return this._partyHandler.sendToAllPeers(JSON.stringify(i)),Promise.resolve()}_publishMaterialDeleted(t){let i={topic:"material_deleted",id:t.getId()};return this._partyHandler.sendToAllPeers(JSON.stringify(i)),Promise.resolve()}_publishSettingsUpdate(t){let i=t.settings,r=t.keys,d={topic:"settings_updated",settings:{}};return d.settings[r[0]]={},d.settings[r[0]][r[1]]=i[r[0]][r[1]],this._partyHandler.sendToAllPeers(JSON.stringify(d)),Promise.resolve()}_publishTextureAdded(t){let i={topic:"texture_added",texture:t.exportParams(),type:t.getTextureType()};return this._partyHandler.sendToAllPeers(JSON.stringify(i)),Promise.resolve()}_publishTextureDeleted(t){let i={topic:"texture_deleted",id:t.getId()};return this._partyHandler.sendToAllPeers(JSON.stringify(i)),Promise.resolve()}_publishAssetUpdate(t,i){let r={};r.id=t.asset.getId();for(let i of t.fields){let d=capitalizeFirstLetter(i);r[i]=t.asset["get"+d]()}let d={topic:i+"_updated"};return d[i]=r,this._partyHandler.sendToAllPeers(JSON.stringify(d,((t,i)=>void 0===i?null:i))),Promise.resolve()}_publishUserScaleUpdated(t){let i={topic:"user_scale",scale:t};return this._partyHandler.sendToAllPeers(JSON.stringify(i)),Promise.resolve()}addSubscriptions(){wt.subscribe(this._id,We,(t=>{this._publishQueue.enqueue((()=>this._publishAssetAdded(t)))})),wt.subscribe(this._id,Xe,(t=>{this._publishQueue.enqueue((()=>this._publishAvatarUpdated(t)))})),wt.subscribe(this._id,Ke,(()=>{this._partyHandler.setIsHost(!0)})),wt.subscribe(this._id,Ze,(t=>{this._partyHandler.bootPeer(t)})),wt.subscribe(this._id,Je,(t=>{this._publishQueue.enqueue((()=>this._publishInstanceAdded(t)))})),wt.subscribe(this._id,$e,(t=>{this._publishQueue.enqueue((()=>this._publishInstanceDeleted(t.instance)))})),wt.subscribe(this._id,et,(t=>{this._publishQueue.enqueue((()=>this._publishAssetUpdate(t,"instance")))})),wt.subscribe(this._id,tt,(t=>{this._publishQueue.enqueue((()=>this._publishInstanceAttached(t)))})),wt.subscribe(this._id,it,(t=>{this._publishQueue.enqueue((()=>this._publishInstanceDetached(t)))})),wt.subscribe(this._id,st,(t=>{this._publishQueue.enqueue((()=>this._publishMaterialAdded(t)))})),wt.subscribe(this._id,nt,(t=>{this._publishQueue.enqueue((()=>this._publishMaterialDeleted(t.material)))})),wt.subscribe(this._id,rt,(t=>{this._publishQueue.enqueue((()=>this._publishAssetUpdate(t,"material")))})),wt.subscribe(this._id,mt,(t=>{this._publishQueue.enqueue((()=>this._publishSettingsUpdate(t)))})),wt.subscribe(this._id,_t,(t=>{this._publishQueue.enqueue((()=>this._publishTextureAdded(t)))})),wt.subscribe(this._id,ft,(t=>{this._publishQueue.enqueue((()=>this._publishTextureDeleted(t.texture)))})),wt.subscribe(this._id,bt,(t=>{this._publishQueue.enqueue((()=>this._publishAssetUpdate(t,"texture")))})),wt.subscribe(this._id,It,(t=>{this._publishQueue.enqueue((()=>this._publishUserScaleUpdated(t)))}))}removeSubscriptions(){wt.unsubscribe(this._id,We),wt.unsubscribe(this._id,Xe),wt.unsubscribe(this._id,Ke),wt.unsubscribe(this._id,Ze),wt.unsubscribe(this._id,Je),wt.unsubscribe(this._id,$e),wt.unsubscribe(this._id,et),wt.unsubscribe(this._id,tt),wt.unsubscribe(this._id,it),wt.unsubscribe(this._id,st),wt.unsubscribe(this._id,nt),wt.unsubscribe(this._id,rt),wt.unsubscribe(this._id,mt),wt.unsubscribe(this._id,_t),wt.unsubscribe(this._id,ft),wt.unsubscribe(this._id,bt)}update(){this._isPublishing||0==this._publishQueue.length||(this._isPublishing=!0,this._publishQueue.dequeue()().then((()=>this._isPublishing=!1)))}};const Ss=16384,Ts=65536;let xs=new class{constructor(){this._peers={},this._partyActive=!1,this._displayingUsernames=!1,this._username=String.fromCharCode(97+Math.floor(26*Math.random()))+Math.floor(100*Math.random()),this._messageHandlers={project:(t,i)=>{this._handleProject(t,i)}},Es.init(this),ws.setOnPeerIdUpdate(((t,i)=>{this._updatePeerId(t,i)})),ws.setOnSetupPeer((t=>{this._registerPeer(t)})),ws.setOnDisconnect((()=>{this._onDisconnect()}))}_onDisconnect(){this._partyActive=!1,Es.removeSubscriptions();for(let t in this._peers){let i=this._peers[t];i.rtc&&i.rtc.close(),i.controller&&i.controller.removeFromScene()}this._peers={},Es.handlePartyEnded()}_registerPeer(t){let i={id:t.getPeerId(),jitterBuffer:new Queue};this._peers[i.id]=i,t.setOnSendDataChannelOpen((()=>{this._successCallback&&this._successCallback(),i.rtc=t,Es.handlePeerConnected(i),t.sendData(JSON.stringify({topic:"avatar",url:ps.getAvatarUrl(),isXR:"XR"==ze.deviceType})),t.sendData(JSON.stringify({topic:"username",username:this._username})),t.sendData(JSON.stringify({topic:"user_scale",scale:Ci.getUserScale()})),this._isHost&&ze.isEditor&&this._sendProject([t])})),t.setOnSendDataChannelClose((()=>{delete i.rtc})),t.setOnDisconnect((()=>{i.controller&&i.controller.removeFromScene(),i.id in this._peers&&(delete this._peers[i.id],Es.handlePeerDisconnected(i))})),t.setOnFailedImpoliteConnect((()=>{this._errorCallback&&this._errorCallback({topic:"could-not-connect"}),ws.disconnect()})),t.setOnMessage((t=>{"string"==typeof t?this._handleJSON(i,JSON.parse(t)):this._handleArrayBuffer(i,t)}))}_updatePeerId(t,i){this._peers[t].id=i,this._peers[i]=this._peers[t],delete this._peers[t]}_handleJSON(t,i){i.topic in this._messageHandlers&&this._messageHandlers[i.topic](t,i)}_handleArrayBuffer(t,i){t.handleEventArrayBuffer?t.handleEventArrayBuffer(t,i):t.jitterBuffer.enqueue(i)}_getNextJitterBufferMessage(t,i){let r=t.peek();if(!r)return null;let d,A=this._getMessageTimestamp(r),g=i-A;if(g=(g%Ts+Ts)%Ts,g<=50)return null;do{if(r=t.dequeue(),d=t.peek(),!d)return r;A=this._getMessageTimestamp(d),g=i-A,g=(g%Ts+Ts)%Ts}while(g>50);return r}_getMessageTimestamp(t){return new Uint16Array(t,0,1)[0]}_sendProject(t,i){if(i){t.forEach((t=>t.sendData(JSON.stringify({topic:"project",parts:i.length}))));for(let r of i)t.forEach((t=>t.sendData(r)))}else{yn.exportProject().generateAsync({type:"arraybuffer"}).then((i=>{let r=[],d=Math.ceil(i.byteLength/Ss);for(let t=0;t<d;t++){let d=t*Ss,A=(t+1)*Ss;r.push(i.slice(d,A))}this._sendProject(t,r)}))}}_handleProject(t,i){let r=i.parts,d=[];t.handleEventArrayBuffer=(t,i)=>{if(d.push(i),d.length==r){t.handleEventArrayBuffer=null;let i=concatenateArrayBuffers(d);(new JSZip).loadAsync(i).then((t=>{yn.loadZip(t)}))}}}addMessageHandlers(t){for(let i in t)this._messageHandlers[i]=t[i]}bootPeer(t){let i=this._peers[t];i&&i.rtc?i.rtc.close():console.warn("Warn: couldn't boot peer because peer's rtc connection does not exist. Likely a race condition where the peer disconnecting from their end already closed the connection")}getDisplayingUsernames(){return this._displayingUsernames}getPeer(t){return this._peers[t]}getPeers(){return this._peers}getUsername(){return this._username}sendProject(){let t=[];for(let i in this._peers)this._peers[i].rtc&&t.push(this._peers[i].rtc);this._sendProject(t)}setDisplayingUsernames(t){if(this._displayingUsernames!=t){this._displayingUsernames=!this._displayingUsernames;for(let t in this._peers){let i=this._peers[t].controller;i&&i.setDisplayingUsername(this._displayingUsernames)}}}setIsHost(t){this._isHost=t}setUsername(t){this._username=t,this.sendToAllPeers(JSON.stringify({topic:"username",username:t}))}isHost(){return this._isHost}isPartyActive(){return this._partyActive}host(t,i,r){this._isHost=!0,this._successCallback=i,this._errorCallback=r,ws.host(t,i,r),Es.addSubscriptions(),this._partyActive=!0,Es.handlePartyStarted()}join(t,i,r){this._isHost=!1,this._successCallback=i,this._errorCallback=r,ws.join(t,i,r),Es.addSubscriptions(),this._partyActive=!0,Es.handlePartyStarted()}sendToAllPeers(t){for(let i in this._peers){let r=this._peers[i].rtc;r&&r.sendData(t)}}setEventBufferHandler(t,i){t.handleEventArrayBuffer=i}update(t){if(!this._partyActive)return;let i=(new Date).getTime()%Ts,r=new Uint16Array([i]).buffer;r=concatenateArrayBuffers([r,...ps.getDataForRTC()]);for(let d in this._peers){let A=this._peers[d];if(A.controller){let r=this._getNextJitterBufferMessage(A.jitterBuffer,i);A.controller.update(t,r)}A.rtc&&A.rtc.sendData(r)}Es.update()}};class PointerInteractableEntity extends Entity{constructor(){super(),this._pointerInteractable=PointerInteractable.emptyGroup()}setPointerInteractableParent(t){t&&t.addChild(this._pointerInteractable)}removeParentInteractableParent(){this._pointerInteractable.parent&&this._pointerInteractable.parent.removeChild(this._pointerInteractable)}addToScene(t,i){super.addToScene(t),this.setPointerInteractableParent(i)}removeFromScene(){super.removeFromScene(),this.removeParentInteractableParent()}}let Ms=new class{constructor(){this._id=uuidv4(),this._pivotPoint=new R,this._interactables=[],this._pageInteractables=[[],[]],this._keyboardPage=0,this._owner=null,this._keysPressed=new Set}init(t){this._scene=t,this._setupKeyboard()}_setupKeyboard(){this._keyboard=new je.Keyboard({language:"English",fontFamily:Tt,fontTexture:xt,fontSize:.035,backgroundColor:St.keyboard,backgroundOpacity:1,backspaceTexture:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABF9pVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDIxIDc5LjE1NTc3MiwgMjAxNC8wMS8xMy0xOTo0NDowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOjliMGViMjkzLTQ5YjEtNzk0Ny04ODQ2LTQ5ZmU3OWUzN2VjYiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDoyNTJDRDY5NkEzRTYxMUVBODFDQjk4NTAyMkIzRTQxOCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDoyNTJDRDY5NUEzRTYxMUVBODFDQjk4NTAyMkIzRTQxOCIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxNCBXaW5kb3dzIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6RUVFQjQyNUZBM0UxMTFFQUIwOUNCQUQwM0U4OTg4N0YiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6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",shiftTexture:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABF9pVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDIxIDc5LjE1NTc3MiwgMjAxNC8wMS8xMy0xOTo0NDowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOjliMGViMjkzLTQ5YjEtNzk0Ny04ODQ2LTQ5ZmU3OWUzN2VjYiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo0NzY4M0Y0M0EzRTYxMUVBODc0MkQ2NEU2OUQ0NzMxQSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo0NzY4M0Y0MkEzRTYxMUVBODc0MkQ2NEU2OUQ0NzMxQSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxNCBXaW5kb3dzIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6MDYyMjJFRUJBM0UyMTFFQUE1QjVGOThGNjlDRTRBQzgiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6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",enterTexture:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABF9pVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDIxIDc5LjE1NTc3MiwgMjAxNC8wMS8xMy0xOTo0NDowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOjliMGViMjkzLTQ5YjEtNzk0Ny04ODQ2LTQ5ZmU3OWUzN2VjYiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozOEE3NEZCM0EzRTYxMUVBODQ2RTg5N0U1ODk3QTY3MyIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozOEE3NEZCMkEzRTYxMUVBODQ2RTg5N0U1ODk3QTY3MyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxNCBXaW5kb3dzIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6Rjg2REZFNTNBM0UxMTFFQUEyRjRDNThCOUZCMENEMDIiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6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"}),this._keyboard.scale.set(.6,.6,.6);for(let t=0;t<this._keyboard.keys.length;t++)this._setupKey(t);this._pivotPoint.position.setY(-.275),this._pivotPoint.add(this._keyboard)}_setupKey(t){let i,r=this._keyboard.keys[t];r.setupState({state:Bi.IDLE,attributes:{offset:0,backgroundColor:St.keyboardButtonIdle,backgroundOpacity:1},onSet:()=>{this._keysPressed.delete(r)}}),r.setupState({state:Bi.HOVERED,attributes:{offset:0,backgroundColor:St.keyboardButtonHovered,backgroundOpacity:1},onSet:()=>{this._keysPressed.delete(r)}}),r.setupState({state:Bi.SELECTED,attributes:{offset:0,backgroundColor:St.keyboardButtonSelected,backgroundOpacity:1},onSet:()=>{if(this._keysPressed.add(r),r.info.command)switch(r.info.command){case"switch-set":this._keyboard.setNextCharset();break;case"enter":this._owner.handleKey("Enter");break;case"space":this._owner.handleKey(" ");break;case"backspace":this._owner.handleKey("Backspace");break;case"shift":this._keyboard.toggleCase()}else r.info.input&&this._owner.handleKey(r.info.input)}}),i="switch"==r.info.command?new PointerInteractable(r,(()=>{this._switchPanel()})):new PointerInteractable(r),t<=32?this._pageInteractables[0].push(i):this._pageInteractables[1].push(i),this._interactables.push(i)}_switchPanel(){this._keyboard.setNextPanel(),this._owner&&(ds.removeInteractables(this._pageInteractables[this._keyboardPage]),this._keyboardPage=(this._keyboardPage+1)%2,ds.addInteractables(this._pageInteractables[this._keyboardPage]))}isKeyPressed(){return 0!=this._keysPressed.size}setOwner(t){this._owner=t,this._scene.add(this._pivotPoint),ds.addInteractables(this._pageInteractables[this._keyboardPage]),Oi.disable(this._id)}removeOwner(t){this._owner==t&&this._pivotPoint.parent&&(this._owner=null,this._pivotPoint.parent.remove(this._pivotPoint),ds.removeInteractables(this._interactables),Oi.enable(this._id))}};class TextField extends PointerInteractableEntity{constructor(t){super(),this._onBlur=t.onBlur||null,this._onEnter=t.onEnter||null,this._onUpdate=t.onUpdate||null,this._defaultContent=t.text||"",this._initialContent=t.initialText||"",this._maxLength=t.maxLength||null,this.content="","POINTER"==ze.deviceType&&this._setupEventListeners(),this._object=ThreeMeshUIHelper.createInputBlock(t),this._pointerInteractable=new PointerInteractable(this._object,(()=>{this._activate()})),this._active=!1,this._initialContent&&this.setContent(this._initialContent)}_setupEventListeners(){this._keyListener=t=>{this.handleKey(t.key)},this._clickListener=t=>{Ms.isKeyPressed()||this._pointerInteractable.getState()==Bi.SELECTED||this.deactivate()},this._pasteListener=t=>{this._handlePaste(t)}}_addSubscriptions(){wt.subscribe(this._id,at,(t=>{this._id!=t.id&&this.deactivate()})),wt.subscribe(this._id,lt,(()=>{this.deactivate()})),"XR"==ze.deviceType&&wt.subscribe(this._id,tt,(()=>{this.deactivate()}))}_removeSubscriptions(){wt.unsubscribe(this._id,at),wt.unsubscribe(this._id,lt),"XR"==ze.deviceType&&wt.unsubscribe(this._id,tt)}_handlePaste(t){if(t.clipboardData.types.indexOf("text/plain")<0)return;let i=t.clipboardData.getData("text/plain"),r=!0;for(let t of i)Ot.has(t)||(r=!1);r&&(this.appendToContent(i),t.preventDefault())}handleKey(t){fi.isKeyCodePressed("ControlLeft")||fi.isKeyCodePressed("MetaLeft")||(Ot.has(t)?(this.appendToContent(t),this._onUpdate&&this._onUpdate()):"Backspace"==t?(this._removeFromEndOfContent(),this._onUpdate&&this._onUpdate()):"Enter"==t&&(this.deactivate(),this._onEnter&&this._onEnter()))}appendToContent(t){this.content+=t,this._updateDisplayedContentWithCursor()}_removeFromEndOfContent(){this.content.length>0&&(this.content=this.content.slice(0,-1),this._updateDisplayedContentWithCursor())}_updateDisplayedContentWithCursor(){this._updateDisplayedContent(!0)}_updateDisplayedContentWithoutCursor(){this._updateDisplayedContent(!1)}_updateDisplayedContent(t){let i=this.content,r=this._object.children[1];this._maxLength&&i.length>this._maxLength&&(i="..."+i.substring(i.length-this._maxLength)),t&&(i+="|"),r.set({content:i})}_activate(){if("XR"==ze.deviceType){if(this._active)return;this._active=!0,this._updateDisplayedContentWithCursor(),Ms.setOwner(this),this._addSubscriptions()}else if("POINTER"==ze.deviceType){if(this._active)return;this._active=!0,this._updateDisplayedContentWithCursor(),document.addEventListener("keydown",this._keyListener),document.addEventListener("click",this._clickListener),document.addEventListener("paste",this._pasteListener),ze.keyboardLock=!0}else if("MOBILE"==ze.deviceType){let t=prompt("Enter Value",this.content);(t||""==t)&&(this.setContent(t),this._onBlur&&this._onBlur(),this._onEnter&&this._onEnter())}wt.publish(this._id,at,{id:this._id,targetOnlyMenu:!1})}deactivate(){this._active&&(this._active=!1,"XR"==ze.deviceType?(Ms.removeOwner(this),this._updateDisplayedContentWithoutCursor(),je.update(),this._removeSubscriptions()):"POINTER"==ze.deviceType&&(document.removeEventListener("keydown",this._keyListener),document.removeEventListener("click",this._clickListener),document.removeEventListener("paste",this._pasteListener),ze.keyboardLock=!1,this._updateDisplayedContentWithoutCursor(),je.update()),this._onBlur&&this._onBlur())}setContent(t){this.content=t;let i=this._object.children[1].content;i!=t&&(i.length>0&&i.endsWith("|")?this._updateDisplayedContentWithCursor():this._updateDisplayedContentWithoutCursor())}setDefaultContent(t){this._defaultContent=t}isBlank(){return""==this.content}reset(){if(this._initialContent)this.setContent(this._initialContent);else{this.content="",this._object.children[1].set({content:this._defaultContent})}}}class NumberField extends TextField{constructor(t){super(t),this._lastValidNumber=t.initialText,this._minValue=numberOr(t.minValue,-1/0),this._maxValue=numberOr(t.maxValue,1/0)}handleKey(t){isFinite(t)||"-"==t||"."==t?(this.appendToContent(t),this._update()):"Backspace"==t?(this._removeFromEndOfContent(),this._update()):"Enter"==t&&(this.deactivate(),this._onEnter&&this._onEnter())}_update(){let t=Number.parseFloat(this.content);isNaN(t)||(t!=this.content&&this.setContent(String(t)),t>=this._minValue&&t<=this._maxValue&&(this._lastValidNumber=String(t))),this._onUpdate&&this._onUpdate()}_updateDisplayedContentWithoutCursor(){let t=Number.parseFloat(this.content);Number.isNaN(t)?this.content=String(this._lastValidNumber):t<this._minValue?this.content=String(this._minValue):t>this._maxValue?this.content=String(this._maxValue):this._lastValidNumber=String(t),this._updateDisplayedContent(!1)}}const Ps=.05;class CheckboxInput extends PointerInteractableEntity{constructor(t){super(),this._onUpdate=t.onUpdate,this._getFromSource=t.getFromSource;let i=t.initialValue||!1,r=t.title||"Missing Field Name...",d=t.titleWidth||.14,A=t.swapOrder?"row-reverse":"row";this._suppressMenuFocusEvent=t.suppressMenuFocusEvent,this._createInputs(i,r,d,A)}_createInputs(t,i,r,d){this._object=new je.Block({fontFamily:Tt,fontTexture:xt,height:Ps,width:.31,contentDirection:d,justifyContent:"start",backgroundOpacity:0,offset:0});let A=ThreeMeshUIHelper.createTextBlock({text:i,fontSize:Mt.body,height:Ps,width:r,margin:0,textAlign:"row"==d?"left":"right"});this._selectBox=ThreeMeshUIHelper.createCheckboxBlock({initialValue:t,height:.04,width:.04,margin:0}),this._object.add(A),this._object.add(this._selectBox);let g=new PointerInteractable(this._selectBox,(()=>{let t=this._selectBox.toggle();this._onUpdate&&this._onUpdate(Boolean(t)),wt.publish(this._id,at,{id:this._id,targetOnlyMenu:this._suppressMenuFocusEvent})}));this._pointerInteractable.addChild(g)}getWidth(){return.31}getHeight(){return Ps}deactivate(){}updateFromSource(){this._getFromSource&&this._getFromSource()!=this._selectBox.getIsChecked()&&this._selectBox.toggle()}}const ks={ACKNOWLEDGEMENTS:"ACKNOWLEDGEMENTS",ASSET:"ASSET",ASSETS:"ASSETS",ASSET_SELECT:"ASSET_SELECT",COLOR_WHEEL:"COLOR_WHEEL",EDITOR_SETTINGS:"EDITOR_SETTINGS",HANDS:"HANDS",HOST_PARTY:"HOST_PARTY",INSTANCE:"INSTANCE",JOIN_PARTY:"JOIN_PARTY",LIBRARY:"LIBRARY",LIBRARY_SEARCH:"LIBRARY_SEARCH",LOAD_GDRIVE:"LOAD_GDRIVE",MATERIAL:"MATERIAL",MATERIALS:"MATERIALS",NAVIGATION:"NAVIGATION",NEW_MATERIAL:"NEW_MATERIAL",NEW_TEXTURE:"NEW_TEXTURE",PARTY:"PARTY",PEER:"PEER",PROJECT:"PROJECT",SETTINGS:"SETTINGS",SKETCHFAB_ASSET:"SKETCHFAB_ASSET",SKETCHFAB_LOGIN:"SKETCHFAB_LOGIN",SKETCHFAB_SEARCH:"SKETCHFAB_SEARCH",SKYBOX:"SKYBOX",TEXTURE:"TEXTURE",TEXTURES:"TEXTURES",TEXT_INPUT:"TEXT_INPUT",UPLOAD:"UPLOAD",USER_SETTINGS:"USER_SETTINGS"},Ds=.05;class ColorInput extends PointerInteractableEntity{constructor(i){super();let r=i.title||"Missing Field Name...";this._lastValue=numberOr(i.initialValue,2800597),this._color=new t.Color(this._lastValue),this._onBlur=i.onBlur,this._onUpdate=i.onUpdate,this._getFromSource=i.getFromSource,this._createInputs(r)}_createInputs(t){this._object=new je.Block({fontFamily:Tt,fontTexture:xt,height:Ds,width:.31,contentDirection:"row",justifyContent:"start",backgroundOpacity:0,offset:0});let i=ThreeMeshUIHelper.createTextBlock({text:t,fontSize:Mt.body,height:Ds,width:.14,margin:0,textAlign:"left"});this._colorBlock=ThreeMeshUIHelper.createColorBlock({height:.04,width:.08,margin:0,selectedColor:this._color}),this._object.add(i),this._object.add(this._colorBlock);let r=new PointerInteractable(this._colorBlock,(()=>{let t=ze.menuController.getPage(ks.COLOR_WHEEL);t.setContent(this._id,this._color,(t=>{this._color.setHex(t),this._onUpdate&&this._onUpdate(t)}),(()=>{if(t.isDraggingCursors())return;let i=this._lastValue,r=this._color.getHex();this._onBlur&&this._onBlur(i,r),this._lastValue=r,this._color.setHex(this._lastValue)})),ze.menuController.pushPage(ks.COLOR_WHEEL),wt.publish(this._id,at,{id:this._id,targetOnlyMenu:!0})}));this._pointerInteractable.addChild(r)}getWidth(){return.31}getHeight(){return Ds}deactivate(){}updateFromSource(){if(this._getFromSource){this._lastValue=this._getFromSource(),this._color.setHex(this._lastValue),ze.menuController.getPage(ks.COLOR_WHEEL).updateColor(this._id,this._color)}}}const Qs=[bi.TOP,bi.LEFT,bi.FRONT,bi.RIGHT,bi.BACK,bi.BOTTOM],Fs={};Fs[bi.TOP]=0,Fs[bi.LEFT]=1,Fs[bi.FRONT]=2,Fs[bi.RIGHT]=3,Fs[bi.BACK]=4,Fs[bi.BOTTOM]=5;class CubeImageInput extends PointerInteractableEntity{constructor(t){if(super(),this._getFromSource=t.getFromSource,this._onUpdate=t.onUpdate,this._lastValues={},t.initialValue)for(let i in t.initialValue)this._lastValues[i]=t.initialValue[i];this._title=t.title||null,this._buttons=[],this._createInputs();for(let t of Qs)this._updateImage(t,this._lastValues[t])}_createInputs(){if(this._object=new je.Block({fontFamily:Tt,fontTexture:xt,height:.2,width:.31,contentDirection:"column",justifyContent:"start",backgroundOpacity:0,offset:0}),this._title){let t=ThreeMeshUIHelper.createTextBlock({text:this._title,fontSize:Mt.body,height:.04,width:.31,margin:0});this._object.add(t)}let t=new je.Block({height:.064,width:.3,contentDirection:"row",justifyContent:"center",backgroundOpacity:0});for(let i=0;i<Qs.length;i++){let r=ThreeMeshUIHelper.createButtonBlock({backgroundTexture:vt.searchIcon,height:.06,width:.06,margin:.002,borderRadius:1e-5}),d=new PointerInteractable(r,(()=>{this._handleInteractable(Qs[i])}));if(this._pointerInteractable.addChild(d),0==i){let t=new je.Block({height:.064,width:.128,contentDirection:"row",justifyContent:"start",backgroundOpacity:0});t.add(r),this._object.add(t)}else if(i<5)t.add(r);else{this._object.add(t);let i=new je.Block({height:.064,width:.128,contentDirection:"row",justifyContent:"start",backgroundOpacity:0});i.add(r),this._object.add(i)}this._buttons.push(r)}}_handleInteractable(t){let i=ui.getLibrary(),r={"null\n":{Name:"Blank"}};for(let t in i){let d=i[t];d.Type==Ve.IMAGE&&(r[t]=d)}ze.menuController.getPage(ks.ASSET_SELECT).setContent(r,(i=>{"null\n"==i&&(i=null),this._handleAssetSelection(t,i)}),(()=>{this._fileUploadSide=t,Fi.triggerUpload()}),(()=>{Fi.stopListening()})),ze.menuController.pushPage(ks.ASSET_SELECT),document.addEventListener(this._eventType,this._clickListener),Fi.listenForAssets((t=>{t.length>0&&this._handleAssetSelection(this._fileUploadSide,t[0])}),!1,Ve.IMAGE)}_handleAssetSelection(t,i){"null\n"==i&&(i=null),this._lastValues[t]!=i&&(this._onUpdate&&this._onUpdate(t,i),this._updateImage(t,i)),ze.menuController.back(),wt.publish(this._id,at,{id:this._id,targetOnlyMenu:!0})}_updateImage(t,i){let r=Fs[t];this._lastValues[t]=i,i?this._buttons[r].children[1].set({backgroundTexture:ui.getTexture(i)}):this._buttons[r].children[1].set({backgroundTexture:vt.searchIcon})}getWidth(){return.31}getHeight(){return this._title?.2+.04:.2}deactivate(){}updateFromSource(){if(!this._getFromSource)return;let t=this._getFromSource();for(let i of Qs)this._lastValues[i]!=t[i]&&this._updateImage(i,t[i])}}const Rs=.05,Ls=.03,Os=.17;class EnumInput extends PointerInteractableEntity{constructor(t){super(),this._getFromSource=t.getFromSource,this._onUpdate=t.onUpdate,this._lastValue=t.initialValue;let i=t.title||"Missing Field Name...",r=t.options||[];this._createInputs(i,r)}_createInputs(t,i){this._object=new je.Block({fontFamily:Tt,fontTexture:xt,height:Rs,width:.31,contentDirection:"row",justifyContent:"start",backgroundOpacity:0,offset:0});let r=ThreeMeshUIHelper.createTextBlock({text:t,fontSize:Mt.body,height:Rs,width:.13,margin:0,textAlign:"left"});this._optionSelection=ThreeMeshUIHelper.createButtonBlock({text:stringWithMaxLength(this._lastValue,13),fontSize:Mt.body,height:Ls,width:Os,margin:.01}),this._optionsContainer=new je.Block({fontFamily:Tt,fontTexture:xt,height:Ls*i.length,width:Os,backgroundOpacity:0}),this._optionsInteractable=new PointerInteractable(this._optionsContainer);for(let t of i){let i=ThreeMeshUIHelper.createButtonBlock({text:t,fontSize:Mt.body,height:Ls,width:Os,margin:0});this._optionsContainer.add(i);let r=new PointerInteractable(i,(()=>{this._handleSelection(t)}));this._optionsInteractable.addChild(r)}this._object.add(r),this._object.add(this._optionSelection),this._selectionInteractable=new PointerInteractable(this._optionSelection,(()=>{0!=i.length&&(this._optionSelection.add(this._optionsContainer),this._selectionInteractable.addChild(this._optionsInteractable))})),this._pointerInteractable.addChild(this._selectionInteractable)}_handleSelection(t){this._lastValue!=t&&(this._onUpdate&&this._onUpdate(t),this._updateOption(t),wt.publish(this._id,at,{id:this._id,targetOnlyMenu:!0})),this.deactivate()}_updateOption(t){this._lastValue=t,t=stringWithMaxLength(t,13),this._optionSelection.children[1].set({content:t})}getWidth(){return.31}getHeight(){return Rs}deactivate(){this._optionSelection.remove(this._optionsContainer),this._selectionInteractable.removeChild(this._optionsInteractable)}updateFromSource(){if(!this._getFromSource)return;let t=this._getFromSource();t!=this._lastValue&&this._updateOption(t)}}const Us=.11,Ns=.31,Hs=.09,Gs=.03,js=.17,zs=.0025;class EulerInput extends PointerInteractableEntity{constructor(t){super(),this._onBlur=t.onBlur,this._onUpdate=t.onUpdate,this._getFromSource=t.getFromSource,this._lastValue=t.initialValue||[0,0,0];let i=t.title||"Missing Field Name...";this._createInputs(i)}_createInputs(t){this._object=new je.Block({fontFamily:Tt,fontTexture:xt,height:Us,width:Ns,contentDirection:"row",justifyContent:"start",backgroundOpacity:0,margin:0,offset:0});let i=new je.Block({height:Us,width:Ns-Hs,contentDirection:"column",justifyContent:"center",alignItems:"end",backgroundOpacity:0,margin:0,offset:0}),r=ThreeMeshUIHelper.createTextBlock({text:t,fontSize:Mt.body,height:Us,width:Hs,margin:0,textAlign:"left"});this._xField=new NumberField({initialText:toDegrees(this._lastValue[0]),fontSize:Mt.body,height:Gs,width:js,margin:zs,maxLength:13,onBlur:()=>{this._blur(0)},onUpdate:()=>{this._update(0)}}),this._yField=new NumberField({initialText:toDegrees(this._lastValue[1]),fontSize:Mt.body,height:Gs,width:js,margin:zs,maxLength:13,onBlur:()=>{this._blur(1)},onUpdate:()=>{this._update(1)}}),this._zField=new NumberField({initialText:toDegrees(this._lastValue[2]),fontSize:Mt.body,height:Gs,width:js,margin:zs,maxLength:13,onBlur:()=>{this._blur(2)},onUpdate:()=>{this._update(2)}});let d=createLabelRow$2("X:"),A=createLabelRow$2("Y:"),g=createLabelRow$2("Z:");this._xField.addToScene(d,this._pointerInteractable),this._yField.addToScene(A,this._pointerInteractable),this._zField.addToScene(g,this._pointerInteractable),this._object.add(r),this._object.add(i),i.add(d),i.add(A),i.add(g)}_update(t){let i=[this.getX(),this.getY(),this.getZ()];isNaN(i[t])||(i.forEach(((t,r)=>i[r]=le.degToRad(t))),this._onUpdate&&this._onUpdate(i))}_blur(t){let i=[this.getX(),this.getY(),this.getZ()];i.forEach(((t,r)=>i[r]=le.degToRad(t))),this._onBlur&&this._onBlur(this._lastValue,i),this._lastValue=i}getX(){return Number.parseFloat(this._xField.content)}getY(){return Number.parseFloat(this._yField.content)}getZ(){return Number.parseFloat(this._zField.content)}getWidth(){return Ns}getHeight(){return Us}deactivate(){this._xField.deactivate(),this._yField.deactivate(),this._zField.deactivate()}reset(){this._xField.reset(),this._yField.reset(),this._zField.reset()}updateFromSource(){if(!this._getFromSource)return;let t=this._getFromSource();t[0]==this._lastValue[0]&&t[1]==this._lastValue[1]&&t[2]==this._lastValue[2]||(this._lastValue=t,this._xField.setContent(toDegrees(t[0])),this._yField.setContent(toDegrees(t[1])),this._zField.setContent(toDegrees(t[2])))}}function createLabelRow$2(t){let i=new je.Block({height:Gs,width:Ns-Hs,contentDirection:"row",justifyContent:"start",backgroundOpacity:0,margin:zs,offset:0}),r=ThreeMeshUIHelper.createTextBlock({text:t,fontSize:Mt.body,height:Gs,width:Ns-Hs-js,margin:0});return i.add(r),i}function toDegrees(t){return String(roundWithPrecision(le.radToDeg(t),5))}const Vs=.05,Ys={};Ys[Bi.IDLE]=St.defaultIdle,Ys[Bi.HOVERED]=St.defaultHovered,Ys[Bi.SELECTED]=St.defaultHovered;class ImageInput extends PointerInteractableEntity{constructor(t){super(),this._getFromSource=t.getFromSource,this._onUpdate=t.onUpdate,this._lastValue=t.initialValue;let i=t.title||"Missing Field Name...";this._createInputs(i),this._updateImage(this._lastValue)}_createInputs(t){this._object=new je.Block({fontFamily:Tt,fontTexture:xt,height:Vs,width:.31,contentDirection:"row",justifyContent:"start",backgroundOpacity:0,offset:0});let i=ThreeMeshUIHelper.createTextBlock({text:t,fontSize:Mt.body,height:Vs,width:.13,margin:0,textAlign:"left"});this._imageSelection=ThreeMeshUIHelper.createButtonBlock({text:" ",fontSize:Mt.body,height:.03,width:.17,margin:.01,idleOpacity:.9,hoveredOpacity:1,selectedOpacity:1}),this._updateImage(),this._object.add(i),this._object.add(this._imageSelection);let r=new PointerInteractable(this._imageSelection,(()=>{let t=ui.getLibrary(),i={"null\n":{Name:"Blank"}};for(let r in t){let d=t[r];d.Type==Ve.IMAGE&&(i[r]=d)}ze.menuController.getPage(ks.ASSET_SELECT).setContent(i,(t=>{"null\n"==t&&(t=null),this._handleAssetSelection(t)}),(()=>{Fi.triggerUpload()}),(()=>{Fi.stopListening()})),ze.menuController.pushPage(ks.ASSET_SELECT),Fi.listenForAssets((t=>{t.length>0&&this._handleAssetSelection(t[0])}),!1,Ve.IMAGE)}));this._pointerInteractable.addChild(r)}_handleAssetSelection(t){"null\n"==t&&(t=null),this._lastValue!=t&&(this._onUpdate&&this._onUpdate(t),this._updateImage(t)),ze.menuController.back(),wt.publish(this._id,at,{id:this._id,targetOnlyMenu:!0})}_updateImage(t){this._lastValue=t;let i=this._lastValue?ui.getAssetName(this._lastValue):" ";if(i=stringWithMaxLength(i,13),this._imageSelection.children[1].set({content:i}),this._lastValue){for(let t in Bi){this._imageSelection.states[t].attributes.backgroundColor=St.white}this._imageSelection.set({backgroundTexture:ui.getTexture(this._lastValue),backgroundColor:St.white})}else{for(let t in Bi){this._imageSelection.states[t].attributes.backgroundColor=Ys[t]}this._imageSelection.set({backgroundTexture:null,backgroundColor:St.defaultIdle})}}getWidth(){return.31}getHeight(){return Vs}deactivate(){}updateFromSource(){if(!this._getFromSource)return;let t=this._getFromSource();this._lastValue!=t&&this._updateImage(t)}}const Ws=.05,Xs={},Ks={};Ks[Bi.IDLE]=St.defaultIdle,Ks[Bi.HOVERED]=St.defaultHovered,Ks[Bi.SELECTED]=St.defaultHovered;class MaterialInput extends PointerInteractableEntity{constructor(t){super(),this._getFromSource=t.getFromSource,this._onUpdate=t.onUpdate,this._lastValue=t.initialValue;let i=t.title||"Missing Field Name...";this._createInputs(i),this._updateMaterial(this._lastValue)}_createInputs(t){this._object=new je.Block({fontFamily:Tt,fontTexture:xt,height:Ws,width:.31,contentDirection:"row",justifyContent:"start",backgroundOpacity:0,offset:0});let i=ThreeMeshUIHelper.createTextBlock({text:t,fontSize:Mt.body,height:Ws,width:.13,margin:0,textAlign:"left"});this._materialBlock=ThreeMeshUIHelper.createButtonBlock({text:" ",fontSize:Mt.body,height:.03,width:.13,margin:.01,idleBackgroundColor:St.white,hoveredBackgroundColor:St.white,selectedBackgroundColor:St.white,idleOpacity:.9,hoveredOpacity:1,selectedOpacity:1}),this._editButton=ThreeMeshUIHelper.createButtonBlock({backgroundTexture:vt.pencilIcon,height:.03,width:.03,margin:0}),this._object.add(i),this._object.add(this._materialBlock),this._object.add(this._editButton);let r=new PointerInteractable(this._materialBlock,(()=>{let t=ys.getMaterials(),i={"null\n":{Name:"Blank"}};for(let r in t)i[r]={Name:t[r].getName()};ze.menuController.getPage(ks.ASSET_SELECT).setContent(i,(t=>{"null\n"==t&&(t=null),this._handleMaterialSelection(t)}),(()=>{this._selectNewMaterial()})),ze.menuController.pushPage(ks.ASSET_SELECT)}));this._editInteractable=new PointerInteractable(this._editButton,(()=>{if(!this._lastValue)return;let t=ys.getMaterial(this._lastValue);ze.menuController.getPage(ks.MATERIAL).setMaterial(t),ze.menuController.pushPage(ks.MATERIAL)})),this._pointerInteractable.addChild(r)}_selectNewMaterial(){ze.menuController.getPage(ks.NEW_MATERIAL).setContent((t=>{this._handleMaterialSelection(t.getId()),ze.menuController.getPage(ks.MATERIAL).setMaterial(t),ze.menuController.pushPage(ks.MATERIAL)})),ze.menuController.pushPage(ks.NEW_MATERIAL)}_handleMaterialSelection(t){"null\n"==t&&(t=null),this._lastValue!=t&&(this._onUpdate&&this._onUpdate(t),this._updateMaterial(t)),ze.menuController.back(),wt.publish(this._id,at,{id:this._id,targetOnlyMenu:!0})}_updateMaterial(t){this._lastValue=t;let i=ys.getMaterial(this._lastValue),r=i?i.getName():" ";if(r=stringWithMaxLength(r,9),this._materialBlock.children[1].set({content:r}),i){let t=i.getMaterial().color||St.white;for(let i in Bi){this._materialBlock.states[i].attributes.backgroundColor=t}this._updateTextureAndColor(i.getSampleTexture(),t),this._pointerInteractable.addChild(this._editInteractable),this._editButton.visible=!0}else{for(let t in Bi){this._materialBlock.states[t].attributes.backgroundColor=Ks[t]}this._updateTextureAndColor(null,St.defaultIdle),this._pointerInteractable.removeChild(this._editInteractable),this._editButton.visible=!1}}_updateTextureAndColor(t,i){this._materialBlock.backgroundTexture!=t&&this._materialBlock.set({backgroundTexture:t}),this._materialBlock.backgroundColor!=i&&this._materialBlock.set({backgroundColor:i}),this._materialBlock.backgroundColor.getHSL(Xs);let r=!t&&Xs.l>.85?St.black:St.white;this._materialBlock.children[1].fontColor!=r&&this._materialBlock.children[1].set({fontColor:r})}_addSubscriptions(){wt.subscribe(this._id,rt,(t=>{this._lastValue==t.asset.getId()&&this.updateFromSource()}))}_removeSubscriptions(){wt.unsubscribe(this._id,rt)}getWidth(){return.31}getHeight(){return Ws}deactivate(){}updateFromSource(){this._getFromSource&&this._updateMaterial(this._getFromSource())}addToScene(t,i){this.updateFromSource(),this._addSubscriptions(),super.addToScene(t,i)}removeFromScene(){this._removeSubscriptions(),super.removeFromScene()}}const Zs=.05;class NumberInput extends PointerInteractableEntity{constructor(t){super(),this._onBlur=t.onBlur,this._onUpdate=t.onUpdate,this._getFromSource=t.getFromSource,this._minValue=numberOr(t.minValue,-1/0),this._maxValue=numberOr(t.maxValue,1/0),this._lastValue=t.initialValue||0;let i=t.title||"Missing Field Name...";this._createInput(i)}_createInput(t){this._object=new je.Block({fontFamily:Tt,fontTexture:xt,height:Zs,width:.31,contentDirection:"row",justifyContent:"start",backgroundOpacity:0,offset:0});let i=ThreeMeshUIHelper.createTextBlock({text:t,fontSize:Mt.body,height:Zs,width:.13,margin:0,textAlign:"left"});this._numberField=new NumberField({initialText:String(this._lastValue),fontSize:Mt.body,height:.03,width:.17,margin:.01,maxLength:13,minValue:this._minValue,maxValue:this._maxValue,onBlur:()=>{this._blur()},onUpdate:()=>{this._update()}}),this._object.add(i),this._numberField.addToScene(this._object,this._pointerInteractable)}_update(){this._onUpdate&&this._validate()&&this._onUpdate(this.getValue())}_blur(){let t=this.getValue();this._onBlur&&this._onBlur(this._lastValue,t),this._lastValue=t}_validate(){let t=this.getValue();return!isNaN(t)&&t<=this._maxValue&&t>=this._minValue}getValue(){return Number.parseFloat(this._numberField.content)}getWidth(){return.31}getHeight(){return Zs}deactivate(){this._numberField.deactivate()}reset(){this._numberField.reset()}updateFromSource(){this._getFromSource&&(this._lastValue=this._getFromSource(),this._numberField.setContent(String(this._lastValue)))}}const qs="BASIC",Js="CUBE",$s=.05,en={};en[Bi.IDLE]=St.defaultIdle,en[Bi.HOVERED]=St.defaultHovered,en[Bi.SELECTED]=St.defaultHovered;class TextureInput extends PointerInteractableEntity{constructor(t){super(),this._getFromSource=t.getFromSource,this._onUpdate=t.onUpdate,this._lastValue=t.initialValue,this._filter=t.filter;let i=t.title||"Missing Field Name...";this._createInputs(i),this._updateTexture(this._lastValue)}_createInputs(t){this._object=new je.Block({fontFamily:Tt,fontTexture:xt,height:$s,width:.31,contentDirection:"row",justifyContent:"start",backgroundOpacity:0,offset:0});let i=ThreeMeshUIHelper.createTextBlock({text:t,fontSize:Mt.body,height:$s,width:.13,margin:0,textAlign:"left"});this._textureSelection=ThreeMeshUIHelper.createButtonBlock({text:" ",fontSize:Mt.body,height:.03,width:.13,margin:.01,idleOpacity:.9,hoveredOpacity:1,selectedOpacity:1}),this._editButton=ThreeMeshUIHelper.createButtonBlock({backgroundTexture:vt.pencilIcon,height:.03,width:.03,margin:0}),this._object.add(i),this._object.add(this._textureSelection),this._object.add(this._editButton);let r=new PointerInteractable(this._textureSelection,(()=>{let t=Cs.getTextures(),i={"null\n":{Name:"Blank"}};for(let r in t)this._filter&&this._filter!=t[r].getTextureType()||(i[r]={Name:t[r].getName()});ze.menuController.getPage(ks.ASSET_SELECT).setContent(i,(t=>{"null\n"==t&&(t=null),this._handleTextureSelection(t)}),(()=>{this._selectNewTexture()})),ze.menuController.pushPage(ks.ASSET_SELECT)}));this._editInteractable=new PointerInteractable(this._editButton,(()=>{if(!this._lastValue)return;let t=Cs.getTexture(this._lastValue);ze.menuController.getPage(ks.TEXTURE).setTexture(t),ze.menuController.pushPage(ks.TEXTURE)})),this._pointerInteractable.addChild(r)}_selectNewTexture(){if(this._filter){let t=Cs.addNewTexture(this._filter);this._handleTextureSelection(t.getId()),ze.menuController.getPage(ks.TEXTURE).setTexture(t),ze.menuController.pushPage(ks.TEXTURE)}else{ze.menuController.getPage(ks.NEW_TEXTURE).setContent((t=>{this._handleTextureSelection(t.getId()),ze.menuController.getPage(ks.TEXTURE).setTexture(t),ze.menuController.pushPage(ks.TEXTURE)})),ze.menuController.pushPage(ks.NEW_TEXTURE)}}_handleTextureSelection(t){"null\n"==t&&(t=null),this._lastValue!=t&&(this._onUpdate&&this._onUpdate(t),this._updateTexture(t)),ze.menuController.back(),wt.publish(this._id,at,{id:this._id,targetOnlyMenu:!0})}_updateTexture(t){this._lastValue=t;let i=Cs.getTexture(this._lastValue),r=i?i.getName():" ";if(r=stringWithMaxLength(r,9),this._textureSelection.children[1].set({content:r}),i){for(let t in Bi){this._textureSelection.states[t].attributes.backgroundColor=St.white}this._updateTextureAndColor(i.getPreviewTexture(),St.white),this._pointerInteractable.addChild(this._editInteractable),this._editButton.visible=!0}else{for(let t in Bi){this._textureSelection.states[t].attributes.backgroundColor=en[t]}this._updateTextureAndColor(null,St.defaultIdle),this._pointerInteractable.removeChild(this._editInteractable),this._editButton.visible=!1}}_updateTextureAndColor(t,i){this._textureSelection.backgroundTexture!=t&&this._textureSelection.set({backgroundTexture:t}),this._textureSelection.backgroundColor!=i&&this._textureSelection.set({backgroundColor:i})}getWidth(){return.31}getHeight(){return $s}deactivate(){}updateFromSource(){this._getFromSource&&this._updateTexture(this._getFromSource())}}const tn=.085,sn=.31,nn=.09,rn=.03,an=.17,on=.0025;class Vector2Input extends PointerInteractableEntity{constructor(t){super(),this._onBlur=t.onBlur,this._onUpdate=t.onUpdate,this._getFromSource=t.getFromSource,this._lastValue=t.initialValue||[0,0];let i=t.title||"Missing Field Name...";this._createInputs(i)}_createInputs(t){this._object=new je.Block({fontFamily:Tt,fontTexture:xt,height:tn,width:sn,contentDirection:"row",justifyContent:"start",backgroundOpacity:0,margin:0,offset:0});let i=new je.Block({height:tn,width:sn-nn,contentDirection:"column",justifyContent:"center",alignItems:"end",backgroundOpacity:0,margin:0,offset:0}),r=ThreeMeshUIHelper.createTextBlock({text:t,fontSize:Mt.body,height:tn,width:nn,margin:0,textAlign:"left"});this._xField=new NumberField({initialText:String(this._lastValue[0]),fontSize:Mt.body,height:rn,width:an,margin:on,maxLength:13,onBlur:()=>{this._blur(0)},onUpdate:()=>{this._update(0)}}),this._yField=new NumberField({initialText:String(this._lastValue[1]),fontSize:Mt.body,height:rn,width:an,margin:on,maxLength:13,onBlur:()=>{this._blur(1)},onUpdate:()=>{this._update(1)}});let d=createLabelRow$1("X:"),A=createLabelRow$1("Y:");this._xField.addToScene(d,this._pointerInteractable),this._yField.addToScene(A,this._pointerInteractable),this._object.add(r),this._object.add(i),i.add(d),i.add(A)}_update(t){let i=[this.getX(),this.getY()];isNaN(i[t])||this._onUpdate&&this._onUpdate(i)}_blur(t){let i=[this.getX(),this.getY()];this._onBlur&&this._onBlur(this._lastValue,i),this._lastValue=i}getX(){return Number.parseFloat(this._xField.content)}getY(){return Number.parseFloat(this._yField.content)}getWidth(){return sn}getHeight(){return tn}deactivate(){this._xField.deactivate(),this._yField.deactivate()}reset(){this._xField.reset(),this._yField.reset()}updateFromSource(){if(!this._getFromSource)return;let t=this._getFromSource();t[0]==this._lastValue[0]&&t[1]==this._lastValue[1]||(this._lastValue=t,this._xField.setContent(String(t[0])),this._yField.setContent(String(t[1])))}}function createLabelRow$1(t){let i=new je.Block({height:rn,width:sn-nn,contentDirection:"row",justifyContent:"start",backgroundOpacity:0,margin:on,offset:0}),r=ThreeMeshUIHelper.createTextBlock({text:t,fontSize:Mt.body,height:rn,width:sn-nn-an,margin:0});return i.add(r),i}const ln=.11,hn=.31,dn=.09,cn=.03,An=.17,un=.0025;class Vector3Input extends PointerInteractableEntity{constructor(t){super(),this._onBlur=t.onBlur,this._onUpdate=t.onUpdate,this._getFromSource=t.getFromSource,this._lastValue=t.initialValue||[0,0,0];let i=t.title||"Missing Field Name...";this._createInputs(i)}_createInputs(t){this._object=new je.Block({fontFamily:Tt,fontTexture:xt,height:ln,width:hn,contentDirection:"row",justifyContent:"start",backgroundOpacity:0,margin:0,offset:0});let i=new je.Block({height:ln,width:hn-dn,contentDirection:"column",justifyContent:"center",alignItems:"end",backgroundOpacity:0,margin:0,offset:0}),r=ThreeMeshUIHelper.createTextBlock({text:t,fontSize:Mt.body,height:ln,width:dn,margin:0,textAlign:"left"});this._xField=new NumberField({initialText:String(this._lastValue[0]),fontSize:Mt.body,height:cn,width:An,margin:un,maxLength:13,onBlur:()=>{this._blur(0)},onUpdate:()=>{this._update(0)}}),this._yField=new NumberField({initialText:String(this._lastValue[1]),fontSize:Mt.body,height:cn,width:An,margin:un,maxLength:13,onBlur:()=>{this._blur(1)},onUpdate:()=>{this._update(1)}}),this._zField=new NumberField({initialText:String(this._lastValue[2]),fontSize:Mt.body,height:cn,width:An,margin:un,maxLength:13,onBlur:()=>{this._blur(2)},onUpdate:()=>{this._update(2)}});let d=createLabelRow("X:"),A=createLabelRow("Y:"),g=createLabelRow("Z:");this._xField.addToScene(d,this._pointerInteractable),this._yField.addToScene(A,this._pointerInteractable),this._zField.addToScene(g,this._pointerInteractable),this._object.add(r),this._object.add(i),i.add(d),i.add(A),i.add(g)}_update(t){let i=[this.getX(),this.getY(),this.getZ()];isNaN(i[t])||this._onUpdate&&this._onUpdate(i)}_blur(t){let i=[this.getX(),this.getY(),this.getZ()];this._onBlur&&this._onBlur(this._lastValue,i),this._lastValue=i}getX(){return Number.parseFloat(this._xField.content)}getY(){return Number.parseFloat(this._yField.content)}getZ(){return Number.parseFloat(this._zField.content)}getWidth(){return hn}getHeight(){return ln}deactivate(){this._xField.deactivate(),this._yField.deactivate(),this._zField.deactivate()}reset(){this._xField.reset(),this._yField.reset(),this._zField.reset()}updateFromSource(){if(!this._getFromSource)return;let t=this._getFromSource();t[0]==this._lastValue[0]&&t[1]==this._lastValue[1]&&t[2]==this._lastValue[2]||(this._lastValue=t,this._xField.setContent(String(t[0])),this._yField.setContent(String(t[1])),this._zField.setContent(String(t[2])))}}function createLabelRow(t){let i=new je.Block({height:cn,width:hn-dn,contentDirection:"row",justifyContent:"start",backgroundOpacity:0,margin:un,offset:0}),r=ThreeMeshUIHelper.createTextBlock({text:t,fontSize:Mt.body,height:cn,width:hn-dn-An,margin:0});return i.add(r),i}const pn={CheckboxInput:"_createCheckboxInput",ColorInput:"_createColorInput",CubeImageInput:"_createCubeImageInput",EnumInput:"_createEnumInput",EulerInput:"_createEulerInput",ImageInput:"_createImageInput",MaterialInput:"_createMaterialInput",NumberInput:"_createNumberInput",TextureInput:"_createTextureInput",Vector2Input:"_createVector2Input",Vector3Input:"_createVector3Input"};class EditorHelper{constructor(t,i){this._asset=t,this._id=t.getId(),this._updatedTopic=i}_publish(t){let i={asset:this._asset,fields:t};wt.publish(this._id,this._updatedTopic,i)}_updateCubeImage(t,i,r,d,A,g){let b=capitalizeFirstLetter(t),I=this._asset["get"+b]()[i];I!=r&&(this._asset["set"+b](r,i),A||this._publish([t])),g||(g=I),d||g==r||Oi.addAction((()=>{this._updateCubeImage(t,i,g,!0,A),this.updateMenuField(t)}),(()=>{this._updateCubeImage(t,i,r,!0,A),this.updateMenuField(t)}))}_updateEuler(t,i,r,d,A){this._updateVector3(t,i,r,d,A)}_updateVector2(t,i,r,d,A){this._updateVector3(t,i,r,d,A)}_updateVector3(t,i,r,d,A){let g=capitalizeFirstLetter(t),b=this._asset["get"+g]();b.reduce(((t,r,d)=>t&&i[d]==r),!0)||(this._asset["set"+g](i),d||this._publish([t])),A||(A=b),r||A.reduce(((t,r,d)=>t&&i[d]==r),!0)||Oi.addAction((()=>{this._updateVector3(t,A,!0,d),this.updateMenuField(t)}),(()=>{this._updateVector3(t,i,!0,d),this.updateMenuField(t)}))}_updateParameter(t,i,r,d,A){let g=capitalizeFirstLetter(t),b=this._asset["get"+g]();b!=i&&(this._asset["set"+g](i),d||this._publish([t])),null==A&&(A=b),r||A==i||Oi.addAction((()=>{this._updateParameter(t,A,!0,d),this.updateMenuField(t)}),(()=>{this._updateParameter(t,i,!0,d),this.updateMenuField(t)}))}updateMenuField(t){if(!this._menuFields)return;let i=this._menuFieldsMap[t];i&&i.updateFromSource()}updateName(t,i){let r=this._asset.getName();r!=t&&(this._asset.setName(t),this._publish(["name"]),i||Oi.addAction((()=>{this.updateName(r,!0)}),(()=>{this.updateName(t,!0)})))}getMenuFields(t){if(this._menuFields)return this._menuFields;this._menuFieldsMap=this._getMenuFieldsMap();let i=[];for(let r of t)r.parameter in this._menuFieldsMap&&i.push(this._menuFieldsMap[r.parameter]);return this._menuFields=i,i}_getMenuFieldsMap(){return{}}_createStandardInput(t){if(t.type.name in pn)return this[pn[t.type.name]](t)}_createCheckboxInput(t){let i="get"+capitalizeFirstLetter(t.parameter);return new CheckboxInput({title:t.name,initialValue:this._asset[i](),suppressMenuFocusEvent:1==t.suppressMenuFocusEvent,getFromSource:()=>this._asset[i](),onUpdate:i=>{this._updateParameter(t.parameter,i)}})}_createColorInput(t){let i="get"+capitalizeFirstLetter(t.parameter);return new ColorInput({title:t.name,initialValue:this._asset[i](),getFromSource:()=>this._asset[i](),onBlur:(i,r)=>{this._updateParameter(t.parameter,r,!1,!1,i)},onUpdate:i=>{this._updateParameter(t.parameter,i,!0)}})}_createCubeImageInput(t){let i="get"+capitalizeFirstLetter(t.parameter);return new CubeImageInput({title:t.name,initialValue:this._asset[i](),getFromSource:()=>this._asset[i](),onUpdate:(i,r)=>{this._updateCubeImage(t.parameter,i,r)}})}_createEnumInput(t){let i="get"+capitalizeFirstLetter(t.parameter);return new EnumInput({title:t.name,initialValue:t.reverseMap[this._asset[i]()],options:t.options,getFromSource:()=>t.reverseMap[this._asset[i]()],onUpdate:i=>{this._updateParameter(t.parameter,t.map[i])}})}_createEulerInput(t){let i="get"+capitalizeFirstLetter(t.parameter);return new EulerInput({title:t.name,initialValue:this._asset[i](),getFromSource:()=>this._asset[i](),onBlur:(i,r)=>{this._updateEuler(t.parameter,r,!1,!1,i)},onUpdate:i=>{this._updateEuler(t.parameter,i,!0)}})}_createImageInput(t){let i="get"+capitalizeFirstLetter(t.parameter);return new ImageInput({title:t.name,initialValue:this._asset[i](),getFromSource:()=>this._asset[i](),onUpdate:i=>{this._updateParameter(t.parameter,i)}})}_createMaterialInput(t){let i="get"+capitalizeFirstLetter(t.parameter);return new MaterialInput({title:t.name,initialValue:this._asset[i](),getFromSource:()=>this._asset[i](),onUpdate:i=>{this._updateParameter(t.parameter,i)}})}_createNumberInput(t){let i="get"+capitalizeFirstLetter(t.parameter);return new NumberInput({title:t.name,minValue:t.min,maxValue:t.max,initialValue:this._asset[i](),getFromSource:()=>this._asset[i](),onBlur:(i,r)=>{this._updateParameter(t.parameter,r,!1,!1,i)},onUpdate:i=>{this._updateParameter(t.parameter,i,!0)}})}_createTextureInput(t){let i="get"+capitalizeFirstLetter(t.parameter);return new TextureInput({title:t.name,filter:t.filter,initialValue:this._asset[i](),getFromSource:()=>this._asset[i](),onUpdate:i=>{this._updateParameter(t.parameter,i)}})}_createVector2Input(t){let i="get"+capitalizeFirstLetter(t.parameter);return new Vector2Input({title:t.name,initialValue:this._asset[i](),getFromSource:()=>this._asset[i](),onBlur:(i,r)=>{this._updateVector2(t.parameter,r,!1,!1,i)},onUpdate:i=>{this._updateVector2(t.parameter,i,!0)}})}_createVector3Input(t){let i="get"+capitalizeFirstLetter(t.parameter);return new Vector3Input({title:t.name,initialValue:this._asset[i](),getFromSource:()=>this._asset[i](),onBlur:(i,r)=>{this._updateVector3(t.parameter,r,!1,!1,i)},onUpdate:i=>{this._updateVector3(t.parameter,i,!0)}})}}const gn="TOOL_AGNOSTIC",mn=[gn,vi.EDIT,vi.COPY_PASTE,vi.DELETE,vi.TRANSLATE,vi.ROTATE,vi.SCALE],_n=["position","rotation","scale"],fn=[{parameter:"position",name:"Position",type:Vector3Input},{parameter:"rotation",name:"Rotation",type:EulerInput},{parameter:"scale",name:"Scale",type:Vector3Input},{parameter:"visualEdit",name:"Visually Edit",type:CheckboxInput}];class AssetHelper extends EditorHelper{constructor(i){super(i,et),this._object=i.getObject(),this._attachedPeers=new Set,this._gripInteractables={},this._pointerInteractables={};for(let t of mn)this._pointerInteractables[t]=[],this._gripInteractables[t]=[];this._boundingBox=new t.Box3,this._boundingBoxObj=new Box3Helper(this._boundingBox),this._createInteractables()}_createInteractables(){if("XR"==ze.deviceType){let t=new GripInteractable(this._object,(t=>{hs.attach(this._asset,t)}),(t=>{hs.detach(t)}));this._gripInteractables[vi.EDIT].push(t);let i=new GripInteractable(this._object,(t=>{yn.deleteAssetInstance(this._asset)}));this._gripInteractables[vi.DELETE].push(i),i=new PointerInteractable(this._object,(t=>{yn.deleteAssetInstance(this._asset)}),!0,!0),this._pointerInteractables[vi.DELETE].push(i);let r=new GripInteractable(this._object,(t=>{Ei.copy(this._asset)}),null,null,pi.LEFT);this._gripInteractables[vi.COPY_PASTE].push(r),r=new PointerInteractable(this._object,(t=>{Ei.copy(this._asset)}),!0,!0,pi.LEFT),this._pointerInteractables[vi.COPY_PASTE].push(r);let d=new GripInteractable(this._object,(t=>{fs.attach(ps,t,this._asset)}),(t=>{fs.detach(ps,t)}));this._gripInteractables[vi.TRANSLATE].push(d);let A=new GripInteractable(this._object,(t=>{ms.attach(ps,t,this._asset)}),(t=>{ms.detach(ps,t)}));this._gripInteractables[vi.ROTATE].push(A);let g=new GripInteractable(this._object,(t=>{_s.attach(ps,t,this._asset)}),(t=>{_s.detach(ps,t)}));this._gripInteractables[vi.SCALE].push(g)}else{this._object.states=Bi,this._object.setState=t=>{t==Bi.HOVERED&&this._object!=hs.getObject()?(this._boundingBox.setFromObject(this._object),ze.scene.add(this._boundingBoxObj)):ze.scene.remove(this._boundingBoxObj)};let t=new PointerInteractable(this._object,(()=>{hs.attach(this._asset)}),!0,!0);this._pointerInteractables[gn].push(t)}}_addInteractables(){for(let t of mn){let i=t!=gn?t:null;gs.addInteractables(this._gripInteractables[t],i),ds.addInteractables(this._pointerInteractables[t],i)}}_removeInteractables(){for(let t of mn){let i=t!=gn?t:null;gs.removeInteractables(this._gripInteractables[t],i),ds.removeInteractables(this._pointerInteractables[t],i)}}updateVisualEdit(t,i,r){t!=this._asset.visualEdit&&(this._asset.visualEdit=t,t?this._object.parent&&0==this._attachedPeers.size&&this._addInteractables():this._removeInteractables(),r||this._publish(["visualEdit"]),i||Oi.addAction((()=>{this.updateVisualEdit(!t,!0,r),this.updateMenuField("visualEdit")}),(()=>{this.updateVisualEdit(t,!0,r),this.updateMenuField("visualEdit")})))}attachToPeer(t,i){if(this._attachedPeers.add(t.id+":"+i.option),i.isXR){if(i.twoHandScaling)return ze.scene.attach(this._object),this._asset.setPosition(i.position),void this._asset.setRotation(i.rotation);i.option in pi&&t.controller&&("translate"==i.type?fs.attach(t.controller,i.option,this._asset,i.position):"rotate"==i.type?ms.attach(t.controller,i.option,this._asset,i.rotation):"scale"==i.type?_s.attach(t.controller,i.option,this._asset,i.scale):(t.controller.hands[i.option].attach(this._object),this._asset.setPosition(i.position),this._asset.setRotation(i.rotation)))}this._asset.visualEdit&&this._removeInteractables()}detachFromPeer(t,i){if(this._attachedPeers.delete(t.id+":"+i.option),i.isXR){if(i.twoHandScaling){let r=pi.otherHand(i.option);return t.controller.hands[r].attach(this._object),this._asset.setPosition(i.position),void this._asset.setRotation(i.rotation)}"translate"==i.type?fs.detach(t.controller,i.option,i.position):"rotate"==i.type?ms.detach(t.controller,i.option,i.rotation):"scale"==i.type?_s.detach(t.controller,i.option,i.scale):(ze.scene.attach(this._object),this._asset.setPosition(i.position),this._asset.setRotation(i.rotation))}this._asset.visualEdit&&this._addInteractables()}getObjectTransformation(){return{position:this._object.position.toArray(),rotation:this._object.rotation.toArray(),scale:this._object.scale.toArray()}}setObjectTransformation(t,i,r,d){let A=[];for(let r of _n){let d=t?t[r]:this._object[r].toArray(),g=i[r];d.reduce(((t,i,r)=>t&&g[r]==i),!0)||(this._object[r].fromArray(g),this.updateMenuField(r),A.push(r))}0!=A.length&&(d||this._publish(A),r||Oi.addAction((()=>{this.setObjectTransformation(null,t,!0,d)}),(()=>{this.setObjectTransformation(null,i,!0,d)})))}roundAttributes(t){let i=[];for(let t of _n)this._object[t].roundWithPrecision(5)&&(i.push(t),this.updateMenuField(t));0!=i.length&&(t||this._publish(i))}place(t){let i=t.point;this._object.position.copy(i),this.roundAttributes(!0)}_getMenuFieldsMap(){let t=super._getMenuFieldsMap();for(let i of fn)if(!(i.parameter in t))if(i.type==CheckboxInput)t[i.parameter]=new CheckboxInput({title:i.name,initialValue:this._asset.visualEdit,getFromSource:()=>this._asset.visualEdit,onUpdate:t=>{this.updateVisualEdit(t)}});else{let r=this._createStandardInput(i);r&&(t[i.parameter]=r)}return t}addToScene(t){!this._asset.visualEdit||this._attachedPeers.size>0||this._addInteractables()}removeFromScene(){this._attachedPeers.clear(),ze.scene.remove(this._boundingBoxObj),fullDispose(this._boundingBoxObj),this._removeInteractables()}}class Asset extends Entity{constructor(t={}){super(),this._id=t.id||this._id,this._assetId=t.assetId,this._name="name"in t?t.name:"Object";let i=t.position?t.position:[0,0,0],r=t.rotation?t.rotation:[0,0,0],d=t.scale?t.scale:[1,1,1];this.visualEdit=t.visualEdit||!1,this._object.position.fromArray(i),this._object.rotation.fromArray(r),this._object.scale.fromArray(d),ze.isEditor&&this._createEditorHelper()}_createEditorHelper(){this._editorHelper=new AssetHelper(this)}makeTranslucent(){this._object.traverse((function(i){if(i instanceof t.Mesh&&i.material)if(Array.isArray(i.material))for(let t=0;t<i.material.length;t++){let r=i.material[t],d=r.clone();makeMaterialTranslucent(d),d.userData.oldMaterial=r,i.material[t]=d}else{let t=i.material.clone();makeMaterialTranslucent(t),t.userData.oldMaterial=i.material,i.material=t}}))}returnTransparency(){this._object.traverse((function(i){if(i instanceof t.Mesh&&i.material)if(Array.isArray(i.material))for(let t=0;t<i.material.length;t++){let r=i.material[t];i.material[t]=r.userData.oldMaterial,disposeMaterial(r)}else{let t=i.material;i.material=i.material.userData.oldMaterial,disposeMaterial(t)}}))}_fetchCloneParams(t){let i=this.exportParams(),r=null!=t?t:this.visualEdit,d=this._object.getWorldPosition(Pt[0]).toArray(),A=Dt.setFromQuaternion(this._object.getWorldQuaternion(Qt)).toArray();return i.visualEdit=r,i.position=d,i.rotation=A,delete i.id,i}preview(){let t=this.exportParams();return t.visualEdit=!1,t.isPreview=!0,delete t.id,new this.constructor(t)}exportParams(){return{id:this._id,name:this._name,assetId:this._assetId,position:this.getPosition(),rotation:this.getRotation(),scale:this.getScale(),visualEdit:this.visualEdit}}getAssetId(){return this._assetId}getEditorHelper(){return this._editorHelper}getName(){return this._name}getPosition(){return this._object.position.toArray()}getRotation(){return this._object.rotation.toArray()}getScale(){return this._object.scale.toArray()}getVisualEdit(){return this.visualEdit}getWorldPosition(t){return t||(t=Pt[0]),this._object.getWorldPosition(t),t}getWorldQuaternion(t){return t||(t=Qt),this._object.getWorldQuaternion(t),t}getWorldScale(t){return t||(t=Pt[0]),this._object.getWorldScale(t),t}setPosition(t){this._object.position.fromArray(t)}setRotation(t){this._object.rotation.fromArray(t)}setRotationFromQuaternion(t){Qt.fromArray(t),this._object.setRotationFromQuaternion(Qt)}setScale(t){this._object.scale.fromArray(t)}setVisualEdit(t){this._editorHelper?this._editorHelper.updateVisualEdit(t,!0,!0):this.visualEdit=t}setName(t){null!=t&&this._name!=t&&(this._name=t)}addToScene(t){super.addToScene(t),ze.isEditor&&this._editorHelper.addToScene()}removeFromScene(){super.removeFromScene(),ze.isEditor&&this._editorHelper.removeFromScene()}}function makeMaterialTranslucent(t){t.opacity=.5,t.transparent=!0}const bn=[{parameter:"visualEdit"},{parameter:"doubleSided",name:"Double Sided",suppressMenuFocusEvent:!0,type:CheckboxInput},{parameter:"position"},{parameter:"rotation"},{parameter:"scale"}];class ClampedTexturePlaneHelper extends AssetHelper{constructor(t){super(t)}place(t){let i=t.object,r=t.point;t.face,i.updateMatrixWorld();let d=t.face.normal.clone().transformDirection(i.matrixWorld).clampLength(0,.001);ze.camera.getWorldDirection(Pt[0]).dot(d)>0&&d.negate(),this._object.position.copy(d).add(r),this._object.lookAt(d.add(this._object.position)),this.roundAttributes(!0)}getMenuFields(){return super.getMenuFields(bn)}_getMenuFieldsMap(){let t=super._getMenuFieldsMap();return t.doubleSided=this._createCheckboxInput({name:"Double Sided",parameter:"doubleSided",suppressMenuFocusEvent:!0}),t}}class ClampedTexturePlane extends Asset{constructor(t={}){super(t),this._createMesh(t.assetId),this._doubleSided=!(0==t.doubleSided),this._doubleSided||this._updateDoubleSided(!1),this._transparent=0!=t.transparent,this._transparent||this._updateTransparent(!1),t.isPreview&&this.makeTranslucent()}_createEditorHelper(){this._editorHelper=new ClampedTexturePlaneHelper(this)}_createMesh(t){this._mesh=ui.cloneMesh(t),this._object.add(this._mesh)}_updateTransparent(t){this._materialAlreadyCloned||(this._mesh.material=this._mesh.material.clone(),this._materialAlreadyCloned=!0),this._mesh.material.transparent=t,this._transparent=t}clone(t){let i=this._fetchCloneParams(t);return yn.addImage(i)}exportParams(){let i=super.exportParams();return i.doubleSided=this._mesh.material.side==t.DoubleSide,i.transparent=this._transparent,i}getDoubleSided(){return this._mesh.material.side==t.DoubleSide}setDoubleSided(i){i!=this._doubleSided&&(this._materialAlreadyCloned||(this._mesh.material=this._mesh.material.clone(),this._materialAlreadyCloned=!0),this._mesh.material.side=i?t.DoubleSide:t.FrontSide,this._doubleSided=i)}}const In=[{parameter:"visualEdit"},{parameter:"position"},{parameter:"rotation"},{parameter:"scale"}];class GLTFAssetHelper extends AssetHelper{constructor(t){super(t)}getMenuFields(){return super.getMenuFields(In)}}class GLTFAsset extends Asset{constructor(t={}){super(t),this._createMesh(t.assetId),t.isPreview&&this.makeTranslucent()}_createEditorHelper(){this._editorHelper=new GLTFAssetHelper(this)}_createMesh(t){this._mesh=ui.cloneMesh(t),this._object.add(this._mesh)}clone(t){let i=this._fetchCloneParams(t);return yn.addGLTF(i)}}let wn=new class{constructor(){this._lightClassMap={},this._shapeClassMap={}}init(t){this._scene=t,this._id=uuidv4(),this._objects=[],this._sessionInstances={},this.project={},Ci.init(t)}load(t,i,r){JSZipUtils.getBinaryContent(t,((t,d)=>{t?r&&r(t):JSZip.loadAsync(d).then((t=>{this.loadZip(t,(()=>{i&&i()}),(()=>{r&&r()}))}))}))}loadZip(t,i,r){wt.publish(this._id,pt,!1,!0),this.reset();let d=uuidv4();ze.loadingLocks.add(d),t.file("projectDetails.json").async("string").then((A=>{let g;try{g=JSON.parse(A)}catch(t){return void this._handleLoadingError(r)}ui.load(g.library,t,(()=>{ze.loadingLocks.delete(d),Ci.load(g.settings),Cs.load(g.textures),ys.load(g.materials);try{for(let t in g.assets){let i=g.assets[t],r=ui.getType(t);r==Ve.IMAGE?this._addImages(i,!0,!0):r==Ve.MODEL?this._addGLTFs(i,!0,!0):r==Ve.LIGHT?this._addLights(i,t,!0,!0):r==Ve.SHAPE&&this._addShapes(i,t,!0,!0)}}catch(t){return console.error(t),void this._handleLoadingError(r)}wt.publish(this._id,pt,!0),i&&i()}),(()=>{this._handleLoadingError(r)}))}),(()=>{this._handleLoadingError(r)}))}_handleLoadingError(t){wt.publish(this._id,pt,!0),t&&t()}addInstance(t,i,r){let d,A=t.assetId,g=ui.getType(A);return g==Ve.IMAGE?d=this.addImage(t,i,r):g==Ve.MODEL?d=this.addGLTF(t,i,r):g==Ve.LIGHT?d=this.addLight(t,A,i,r):g==Ve.SHAPE&&(d=this.addShape(t,A,i,r)),d}_addImages(t,i,r){for(let d of t)this.addImage(d,i,r)}addImage(t,i,r){let d=new ClampedTexturePlane(t);return d.addToScene(this._scene),this.addAsset(d,i,r),d}_addGLTFs(t,i,r){for(let d of t)this.addGLTF(d,i,r)}addGLTF(t,i,r){let d=new GLTFAsset(t);return d.addToScene(this._scene),this.addAsset(d,i,r),d}_addLights(t,i,r,d){for(let A of t)this.addLight(A,i,r,d)}addLight(t,i,r,d){let A=new this._lightClassMap[i](t);return A.addToScene(this._scene),this.addAsset(A,r,d),A}registerLight(t,i,r){this._lightClassMap[i]=t,ui.loadLight(i,r)}_addShapes(t,i,r,d){for(let A of t)this.addShape(A,i,r,d)}addShape(t,i,r,d){let A=new this._shapeClassMap[i](t);return A.addToScene(this._scene),this.addAsset(A,r,d),A}registerShape(t,i,r){this._shapeClassMap[i]=t,ui.loadShape(i,r)}getObjects(){return this._objects}getInstancesForAssetId(t){return this.project[t]||{}}getSessionInstance(t){return this._sessionInstances[t]}deleteAssetInstance(t,i,r){let d;i||(d=Oi.addAction((()=>{t.addToScene(this._scene),this.addAsset(t,!0)}),(()=>{this.deleteAssetInstance(t,!0)})));let A=t.getAssetId(),g=t.getId();if(A in this.project&&g in this.project[A]){for(let i=0;i<this._objects.length;i++)if(t.getObject()==this._objects[i]){this._objects.splice(i,1);break}if(t.getObject().parent!=this._scene&&this._scene.attach(t.getObject()),delete this.project[A][g],t.removeFromScene(),r)return;let i=$e+":"+t.getId();wt.publish(this._id,i,{instance:t,undoRedoAction:d})}}addAsset(t,i,r){i||Oi.addAction((()=>{this.deleteAssetInstance(t,!0,r)}),(()=>{t.addToScene(this._scene),this.addAsset(t,!0,r)}));let d=t.getAssetId(),A=t.getId();d in this.project||(this.project[d]={}),this.project[d][A]||(this.project[d][A]=t,this._objects.push(t.getObject()),this._sessionInstances[A]=t,r||wt.publish(this._id,Je,t))}reset(){this._sessionInstances={};for(let t in this.project){let i=this.project[t];for(let t in i)this.deleteAssetInstance(i[t],!0,!0)}ze.disableImmersion||Oi.reset(),ui.reset(),ys.reset(),Cs.reset(),Ci.reset()}exportProject(){let t=this._getProjectDetails(),i=new JSZip;i.file("projectDetails.json",JSON.stringify(t));let r=ui.getLibrary();for(let d in t.library){if(t.library[d].Type!=Ve.PRIMITVE){let A=t.library[d].Filepath;i.file(A,r[d].Blob)}}return i}_getProjectDetails(){let t={};for(let i in this.project){let r=this.project[i],d=[];for(let t in r)d.push(r[t].exportParams());d.length>0&&(t[i]=d)}let i=Object.keys(t),r=Ci.getSettings(),d=ys.getMaterialsDetails(),A=Cs.getTexturesDetails();for(let d in r.Skybox){let A=r.Skybox[d];A&&!t[A]&&i.push(A)}let g=Cs.getTexturesAssetIds();for(let t of g)i.push(t);return{library:ui.getLibraryDetails(i),assets:t,settings:r,materials:d,textures:A}}};var yn=wn;const Cn="FADE_IN",Bn="SUSTAIN",vn="FADE_OUT";class NotificationHub extends Entity{constructor(){super(),this._createNotification(),this._addSubscriptions(),this._object.position.setZ(.01),this._notificationHeight=0,this._notifications=[]}_createNotification(){this._container=new je.Block({height:.04,width:.3,interline:.01,backgroundColor:St.defaultMenuBackground,backgroundOpacity:.8,justifyContent:"center"}),this._container.set({fontFamily:Tt,fontTexture:xt}),this._textComponent=new je.Text({content:"Notificaton Placeholder",fontColor:St.white,fontSize:Mt.body,fontOpacity:1,offset:0}),this._container.add(this._textComponent),this._object.add(this._container),this._container.visible=!1}setNotificationHeight(t){this._notificationHeight=t}_handleNotification(t){this._notifications.push({state:Cn,text:t.text,sustainTime:t.sustainTime||3,fadeTime:t.fadeTime||1,timeInState:0})}_addSubscriptions(){wt.subscribe(this._id,ot,(t=>{this._handleNotification(t)}))}update(t){if(0==this._notifications.length)return;let i=this._notifications[0];if(i.state==Cn){if(0==i.timeInState){this._container.visible=!0;let t=.02*Math.ceil(i.text.length/20)+.02;this._container.set({height:t}),this._textComponent.set({content:i.text}),this._object.position.setY(this._notificationHeight)}i.timeInState=Math.min(i.timeInState+t,i.fadeTime);let r=i.timeInState/i.fadeTime;this._container.set({backgroundOpacity:.8*r}),this._textComponent.set({fontOpacity:1*r}),1==r&&(i.state=Bn,i.timeInState=0)}else if(i.state==Bn)i.timeInState+=t,i.timeInState>=i.sustainTime&&(i.state=vn,i.timeInState=0);else if(i.state==vn){i.timeInState=Math.min(i.timeInState+t,i.fadeTime);let r=1-i.timeInState/i.fadeTime;this._container.set({backgroundOpacity:.8*r}),this._textComponent.set({fontOpacity:1*r}),0==r&&(this._notifications.shift(),this._object.position.setY(0),this._container.visible=!1)}}}class MenuGripInteractable extends GripInteractable{constructor(t,i,r,d,A){super(t,r,d,A),this._border=i}_createBoundingObject(){this._boundingPlane=new t.Plane}_getBoundingObject(){return this._threeObj.getWorldPosition(Pt[0]),this._threeObj.getWorldQuaternion(Qt),Pt[1].set(0,0,1).applyQuaternion(Qt),this._boundingPlane.setFromNormalAndCoplanarPoint(Pt[1],Pt[0]),this._boundingPlane}_displayBoundingObject(){this._threeObj.add(this._border)}_hideBoundingObject(){this._threeObj.remove(this._border)}intersectsSphere(t){let i,r=this._getBoundingObject();return i=!!r&&(t.intersectsPlane(r)&&t.distanceToPoint(Pt[0])<.45),i}distanceToSphere(t){return this._boundingPlane.distanceToPoint(t.center)}static emptyGroup(){return new MenuGripInteractable}}class MenuController extends PointerInteractableEntity{constructor(){super(),this._object.position.setZ(-100),this._pages={},this._pageCalls=[],this._gripInteractable=MenuGripInteractable.emptyGroup(),this._gripOwners=new Set,this._eventAlreadyTriggered=!1,this._addEventListeners(),this._setupNotificationHub(),this._createInteractables()}_addEventListeners(){document.getElementById("mobile-menu-open-button").addEventListener("click",(()=>{this._openMenu()}))}_setupNotificationHub(){this._notificationHub=new NotificationHub,this._notificationHub.addToScene(this._object),this._notificationHub.setNotificationHeight(.18)}_getCurrentPage(){return this._pages[this._pageCalls[this._pageCalls.length-1]]}getPage(t){return this._pages[t]}setPage(t){let i=this._getCurrentPage();i.removeFromScene(),this._pageCalls=[t],i=this._getCurrentPage(),i.addToScene(this._object,this._pointerInteractable),wt.publish(this._id,lt)}pushPage(t){this._getCurrentPage().removeFromScene(),this._pageCalls.push(t),this._pages[t].addToScene(this._object,this._pointerInteractable),wt.publish(this._id,lt)}popPage(){let t=this._getCurrentPage();t.removeFromScene(),this._pageCalls.pop(),t=this._getCurrentPage(),t.addToScene(this._object,this._pointerInteractable),wt.publish(this._id,lt)}popPagesPast(t){let i,r;do{r=this._getCurrentPage(),i=this._pageCalls[this._pageCalls.length-1],r.back()}while(i!=t);wt.publish(this._id,lt)}back(){this._getCurrentPage().back()}_createBorder(){let i=new Uint16Array([0,1,1,2,2,3,3,0]),r=new t.BufferGeometry;r.setIndex(new t.BufferAttribute(i,1)),r.setAttribute("position",new t.Float32BufferAttribute([.225,.15,0,-.225,.15,0,-.225,-.15,0,.225,-.15,0],3));let d=new t.LineSegments(r);return d.material.color.set(16776960),d}_createInteractables(){if("XR"!=ze.deviceType)return;let t=this._createBorder(),i=new MenuGripInteractable(this._object,t,(t=>{ps.hands[t].attach(this._object),this._gripOwners.add(t)}),(t=>{ps.hands[t].remove(this._object),this._gripOwners.delete(t)}));this._gripInteractable.addChild(i),Ms.init(this._object)}getPosition(t){return this._object.getWorldPosition(t)}getPositionArray(){return this._object.getWorldPosition(Pt[0]).toArray()}getRotationArray(){return Dt.setFromQuaternion(this._object.getWorldQuaternion(Qt).normalize()).toArray()}getDirection(t){return this._object.getWorldDirection(t)}update(t){"XR"==ze.deviceType?(this._updateVR(t),this.update=this._updateVR):"POINTER"==ze.deviceType?(this._updatePointer(t),this.update=this._updatePointer):"MOBILE"==ze.deviceType&&(this._updateMobile(t),this.update=this._updateMobile)}_openMenu(){let t=Ci.getUserScale();ze.renderer.getSize(kt);let i=kt.x/kt.y,r=i>1.15?1.5:1.5*i;ze.camera.getWorldPosition(Pt[0]),ze.camera.getWorldDirection(Pt[1]),Pt[1].normalize().divideScalar(r).multiplyScalar(t),this._object.position.addVectors(Pt[0],Pt[1]),this._object.lookAt(Pt[0]),this._object.scale.set(t,t,t),this.addToScene(this._scene)}closeMenu(){this.removeFromScene()}_updateVR(t){if(ze.sessionActive){let t=fi.getXRGamepad(pi.RIGHT),i=fi.getXRGamepad(pi.LEFT);t?.buttons[4]?.pressed||i?.buttons[4]?.pressed?this._eventAlreadyTriggered||(this._eventAlreadyTriggered=!0,0==this._gripOwners.size&&this._openMenu()):this._eventAlreadyTriggered=!1}this._notificationHub.update(t)}_updatePointer(t){ze.sessionActive&&!ze.keyboardLock&&(fi.isKeyPressed("m")||fi.isKeyPressed("M")?this._eventAlreadyTriggered||(this._eventAlreadyTriggered=!0,this._openMenu()):this._eventAlreadyTriggered=!1),this._notificationHub.update(t)}_updateMobile(t){this._notificationHub.update(t)}addToScene(t){this._object.parent!=t&&(super.addToScene(t),this._scene=t,this._getCurrentPage().addToScene(this._object,this._pointerInteractable),"XR"==ze.deviceType&&gs.addInteractable(this._gripInteractable),ds.addInteractable(this._pointerInteractable))}removeFromScene(){super.removeFromScene(),this._getCurrentPage().removeFromScene(),"XR"==ze.deviceType&&gs.removeInteractable(this._gripInteractable),ds.removeInteractable(this._pointerInteractable)}}const En=Tt,Sn=xt,Tn=St.defaultMenuBackground;class MenuPage extends PointerInteractableEntity{constructor(t,i,r){super(),this._controller=t,this._createPage(),this._createCloseButton(),i?this._createSideBarButton():r&&this._createBackButton()}_createSideBarButton(){let t=new je.Block({height:.06,width:.06,backgroundColor:Tn,backgroundOpacity:0}),i=ThreeMeshUIHelper.createButtonBlock({backgroundTexture:vt.hamburgerIcon,height:.04,width:.04});t.set({fontFamily:En,fontTexture:Sn}),t.position.fromArray([-.225,.15,-.001]),t.add(i);let r=new PointerInteractable(i,(()=>{this._controller.setPage(ks.NAVIGATION)}));this._pointerInteractable.addChild(r),this._object.add(t)}_createBackButton(){let t=new je.Block({height:.06,width:.06,backgroundColor:Tn,backgroundOpacity:0}),i=ThreeMeshUIHelper.createButtonBlock({text:"<",fontSize:.03,height:.04,width:.04});t.set({fontFamily:En,fontTexture:Sn}),t.position.fromArray([-.225,.15,-.001]),t.add(i);let r=new PointerInteractable(i,(()=>{this.back()}));this._pointerInteractable.addChild(r),this._object.add(t)}_createCloseButton(){let t=new je.Block({height:.06,width:.06,backgroundColor:Tn,backgroundOpacity:0}),i=ThreeMeshUIHelper.createButtonBlock({text:"X",fontSize:.03,height:.04,width:.04});t.set({fontFamily:En,fontTexture:Sn}),t.position.fromArray([.225,.15,-.001]),t.add(i);let r=new PointerInteractable(i,(()=>{this._controller.closeMenu()}));this._pointerInteractable.addChild(r),this._object.add(t)}_createPage(){this._container=new je.Block({height:.3,width:.45,borderWidth:0,offset:0,backgroundOpacity:0});let t=new je.Block({height:.3,width:.45,backgroundColor:Tn,backgroundOpacity:.5,borderWidth:.001,borderColor:St.white,borderOpacity:.75});this._container.set({fontFamily:En,fontTexture:Sn}),this._containerInteractable=new PointerInteractable(this._container.children[0],null,!1),this._pointerInteractable.addChild(this._containerInteractable),t.add(this._container),this._object.add(t)}back(){this._controller.popPage()}}class AcknowledgementsPage extends MenuPage{constructor(t){super(t,!1,!0),this._sketchfabAssets=[],this._addPageContent()}_addPageContent(){this._createPreviousAndNextButtons(),this._titleBlock=ThreeMeshUIHelper.createTextBlock({text:" ",fontSize:Mt.header,height:.04,width:.3}),this._container.add(this._titleBlock),this._noAcknowledgements=ThreeMeshUIHelper.createTextBlock({text:"No Acknowledgements to Display",fontSize:.025,height:.04,width:.4,fontFamily:Tt,fontTexture:xt}),this._acknowledgementsContainer=new je.Block({height:.2,width:.45,contentDirection:"row",justifyContent:"center",backgroundOpacity:0,offset:0});let t=new je.Block({height:.2,width:.31,contentDirection:"column",justifyContent:"start",backgroundOpacity:0});this._textureBlock=new je.Block({height:.085,width:.1,backgroundOpacity:1}),t.add(this._textureBlock),this._authorBlock=ThreeMeshUIHelper.createTextBlock({text:"Author: ",fontSize:Mt.body,height:.025,width:.3}),t.add(this._authorBlock),this._sketchfabButton=ThreeMeshUIHelper.createButtonBlock({text:"View on Sketchfab",fontSize:Mt.body,height:.035,width:.3,margin:.006}),t.add(this._sketchfabButton),this._sketchfabInteractable=new PointerInteractable(this._sketchfabButton,(()=>{"XR"==ze.deviceType&&ki.exitXRSession(),window.open(this._sketchfabAssets[this._page]["Sketchfab Link"],"_blank")})),this._containerInteractable.addChild(this._sketchfabInteractable),this._container.add(this._acknowledgementsContainer),this._acknowledgementsContainer.add(this._previousButton),this._acknowledgementsContainer.add(t),this._acknowledgementsContainer.add(this._nextButton)}_createPreviousAndNextButtons(){this._previousButton=ThreeMeshUIHelper.createButtonBlock({text:"<",fontSize:.03,height:.04,width:.04,fontFamily:Tt,fontTexture:xt}),this._nextButton=ThreeMeshUIHelper.createButtonBlock({text:">",fontSize:.03,height:.04,width:.04,fontFamily:Tt,fontTexture:xt}),this._previousInteractable=new PointerInteractable(this._previousButton,(()=>{this._page+=this._sketchfabAssets.length-1,this._page%=this._sketchfabAssets.length,this._setAsset()})),this._nextInteractable=new PointerInteractable(this._nextButton,(()=>{this._page+=1,this._page%=this._sketchfabAssets.length,this._setAsset()}))}setAssets(t){if(this._sketchfabAssets=t,this._page=0,t.length>1)this._previousButton.visible=!0,this._nextButton.visible=!0,this._containerInteractable.addChild(this._previousInteractable),this._containerInteractable.addChild(this._nextInteractable);else if(this._previousButton.visible=!1,this._nextButton.visible=!1,this._containerInteractable.removeChild(this._previousInteractable),this._containerInteractable.removeChild(this._nextInteractable),0==t.length)return this._container.remove(this._acknowledgementsContainer),void this._container.add(this._noAcknowledgements);this._setAsset()}_setAsset(){let t=this._page,i=this._sketchfabAssets[t];this._titleBlock.children[1].set({content:i.Name}),i.Author?(this._authorBlock.children[1].set({content:"Author: "+i.Author}),this._authorBlock.visible=!0):this._authorBlock.visible=!1,i.previewTexture?(this._textureBlock.set({backgroundTexture:i.previewTexture}),this._textureBlock.visible=!0):i["Preview Image URL"]&&!i.isLoadingTexture?(this._textureBlock.visible=!1,i.isLoadingTexture=!0,(new L).load(i["Preview Image URL"],(r=>{this._page==t&&(i.previewTexture=r,this._setAsset())}))):this._textureBlock.visible=!1,i["Sketchfab Link"]?(this._sketchfabButton.visible=!0,this._containerInteractable.addChild(this._sketchfabInteractable)):(this._sketchfabButton.visible=!1,this._containerInteractable.removeChild(this._sketchfabInteractable))}}class PaginatedPage extends MenuPage{constructor(t,i,r){super(t,i,r),this._paginatedListButtons=[],this._paginatedListInteractables=[],this._page=0,this._optionsInteractable=PointerInteractable.emptyGroup()}_addList(){this._createPreviousAndNextButtons(),this._optionsContainer=new je.Block({height:.17,width:.45,contentDirection:"row",justifyContent:"center",backgroundOpacity:0,offset:0}),this._optionsBlock=new je.Block({height:.17,width:.31,contentDirection:"column",justifyContent:"start",backgroundOpacity:0,offset:0});for(let t=0;t<5;t++){let i=ThreeMeshUIHelper.createButtonBlock({text:" ",fontSize:Mt.body,height:.035,width:.3,margin:.002,fontFamily:Tt,fontTexture:xt});this._optionsBlock.add(i),this._paginatedListButtons.push(i);let r=new PointerInteractable(i,(()=>{let i=5*this._page+t;this._items.length>i?this._handleItemInteraction(this._items[i]):console.error("PaginatedPage displaying non existant option")}));this._optionsInteractable.addChild(r),this._paginatedListInteractables.push(r)}this._optionsContainer.add(this._previousButton),this._optionsContainer.add(this._optionsBlock),this._optionsContainer.add(this._nextButton),this._container.add(this._optionsContainer),this._containerInteractable.addChild(this._optionsInteractable)}_createPreviousAndNextButtons(){this._previousButton=ThreeMeshUIHelper.createButtonBlock({text:"<",fontSize:.03,height:.04,width:.04,fontFamily:Tt,fontTexture:xt}),this._nextButton=ThreeMeshUIHelper.createButtonBlock({text:">",fontSize:.03,height:.04,width:.04,fontFamily:Tt,fontTexture:xt}),this._previousInteractable=new PointerInteractable(this._previousButton,(()=>{this._page-=1,this._updateItemsGUI()})),this._nextInteractable=new PointerInteractable(this._nextButton,(()=>{this._page+=1,this._updateItemsGUI()}))}_updateItemsGUI(){let t=5*this._page;for(let i=0;i<5;i++){let r=this._paginatedListInteractables[i],d=this._paginatedListButtons[i];if(t+i<this._items.length){let A=this._items[t+i];d.children[1].set({content:this._getItemName(A)}),d.visible=!0,this._optionsInteractable.addChild(r)}else d.visible=!1,this._optionsInteractable.removeChild(r)}0==this._page?(this._previousButton.visible=!1,this._optionsInteractable.removeChild(this._previousInteractable)):(this._previousButton.visible=!0,this._optionsInteractable.addChild(this._previousInteractable)),this._items.length>t+5?(this._nextButton.visible=!0,this._optionsInteractable.addChild(this._nextInteractable)):(this._nextButton.visible=!1,this._optionsInteractable.removeChild(this._nextInteractable))}_getItemName(){return console.error("PaginatedPage._getItemName() should be overridden"),""}_handleItemInteraction(){console.error("PaginatedPage._handleItemInteraction() should be overridden")}_refreshItems(){console.error("PaginatedPage._refreshItems() should be overridden")}addToScene(t,i){super.addToScene(t,i),t&&(this._refreshItems(),this._updateItemsGUI())}}class AssetPage extends PaginatedPage{constructor(t){super(t,!1,!0),this._instances={},this._items=Object.keys(this._instances),this._addPageContent(),this._createAddButton()}_addPageContent(){this._titleBlock=ThreeMeshUIHelper.createTextBlock({text:" ",fontSize:Mt.header,height:.04,width:.4}),this._container.add(this._titleBlock),this._addList()}_createAddButton(){let t=new je.Block({height:.06,width:.06,backgroundColor:St.defaultMenuBackground,backgroundOpacity:0}),i=ThreeMeshUIHelper.createButtonBlock({text:"+",fontSize:.04,height:.04,width:.04});t.set({fontFamily:Tt,fontTexture:xt}),t.position.fromArray([.175,.12,-.001]),t.add(i);let r=new PointerInteractable(i,(()=>{this._controller.getPosition(Pt[0]),this._controller.getDirection(Pt[1]).normalize().divideScalar(4);let t=Pt[0].sub(Pt[1]).toArray();Pt[0].set(0,0,1),Pt[1].setY(0).normalize(),Qt.setFromUnitVectors(Pt[0],Pt[1]),Dt.setFromQuaternion(Qt);let i=Dt.toArray(),r={assetId:this._assetId,position:t,rotation:i,visualEdit:!0},d=ui.getType(this._assetId);d==Ve.IMAGE?(r.doubleSided=!0,r.transparent=!0,yn.addImage(r)):d==Ve.MODEL?yn.addGLTF(r):d==Ve.SHAPE?yn.addShape(r,this._assetId):d==Ve.LIGHT&&yn.addLight(r,this._assetId)}));this._containerInteractable.addChild(r),this._object.add(t)}_getItemName(t){return"Acknowledgement"==t?t:this._instances[t].getName()}_handleItemInteraction(t){if("Acknowledgement"==t){this._controller.getPage(ks.ACKNOWLEDGEMENTS).setAssets([ui.library[this._assetId]]),this._controller.pushPage(ks.ACKNOWLEDGEMENTS)}else{this._controller.getPage(ks.INSTANCE).setInstance(this._instances[t]),this._controller.pushPage(ks.INSTANCE)}}_refreshItems(){this._instances=yn.getInstancesForAssetId(this._assetId),this._items=Object.keys(this._instances),ui.library[this._assetId].Author&&this._items.push("Acknowledgement")}setAsset(t){let i=ui.library[t];this._assetId=t,this._titleBlock.children[1].set({content:i.Name}),this._instances=yn.getInstancesForAssetId(t)}_addSubscriptions(){wt.subscribe(this._id,Je,(t=>{t.getAssetId()==this._assetId&&(this._refreshItems(),this._updateItemsGUI())})),wt.subscribe(this._id,et,(t=>{t.asset.getAssetId()==this._assetId&&(this._refreshItems(),this._updateItemsGUI())})),wt.subscribe(this._id,$e,(t=>{t.instance.getAssetId()==this._assetId&&this._items.includes(t.instance.getId())&&(this._refreshItems(),this._updateItemsGUI())})),wt.subscribe(this._id,pt,(t=>{t&&(this._controller.back(),this._controller.back())}))}_removeSubscriptions(){wt.unsubscribe(this._id,Je),wt.unsubscribe(this._id,et),wt.unsubscribe(this._id,$e),wt.unsubscribe(this._id,pt)}addToScene(t,i){this._addSubscriptions(),super.addToScene(t,i)}removeFromScene(){this._removeSubscriptions(),super.removeFromScene()}}class LightsPage extends PaginatedPage{constructor(t){super(t,!1,!0),this._assets={},this._items=Object.keys(this._assets),this._addPageContent(),this._createAddButton()}_addPageContent(){this._titleBlock=ThreeMeshUIHelper.createTextBlock({text:" ",fontSize:Mt.header,height:.04,width:.2}),this._container.add(this._titleBlock),this._addList()}_createAddButton(){this._addButtonParent=new je.Block({height:.06,width:.06,backgroundColor:St.defaultMenuBackground,backgroundOpacity:0});let t=ThreeMeshUIHelper.createButtonBlock({text:"+",fontSize:.04,height:.04,width:.04});this._addButtonParent.set({fontFamily:Tt,fontTexture:xt}),this._addButtonParent.position.fromArray([.175,.12,-.001]),this._addButtonParent.add(t),this._addInteractable=new PointerInteractable(t,(()=>{this._controller.pushPage(ks.UPLOAD)})),this._containerInteractable.addChild(this._addInteractable),this._object.add(this._addButtonParent)}_getItemName(t){let i=this._assets[t].Name;return i.length>25&&(i="..."+i.substring(i.length-25)),i}_handleItemInteraction(t){this._controller.getPage(ks.ASSET).setAsset(t),this._controller.pushPage(ks.ASSET)}_refreshItems(){let t=ui.getLibrary();for(let i in t)t[i].Type==this._assetType&&(this._assets[i]=t[i]);this._items=Object.keys(this._assets)}setContent(t,i){this._assets={},this._assetType=t,t==Ve.MODEL||t==Ve.IMAGE?(this._object.add(this._addButtonParent),this._containerInteractable.addChild(this._addInteractable)):(this._object.remove(this._addButtonParent),this._containerInteractable.removeChild(this._addInteractable)),this._titleBlock.children[1].set({content:i})}_addSubscriptions(){wt.subscribe(this._id,We,(t=>{ui.getType(t)==this._assetType&&(this._refreshItems(),this._updateItemsGUI())})),wt.subscribe(this._id,pt,(t=>{t&&(this._refreshItems(),this._updateItemsGUI())}))}_removeSubscriptions(){wt.unsubscribe(this._id,We),wt.unsubscribe(this._id,pt)}addToScene(t,i){this._addSubscriptions(),super.addToScene(t,i)}removeFromScene(){this._removeSubscriptions(),super.removeFromScene()}}class AssetSelectPage extends PaginatedPage{constructor(t){super(t,!1,!0),this._assets={},this._items=Object.keys(this._assets),this._addPageContent(),this._createAddButton()}_addPageContent(){this._textField=new TextField({height:.04,width:.3,onBlur:()=>{this._searchUpdated()},onUpdate:()=>{this._searchUpdated()}}),this._textField.addToScene(this._container,this._containerInteractable),this._addList()}_createAddButton(){let t=new je.Block({height:.06,width:.06,backgroundColor:St.defaultMenuBackground,backgroundOpacity:0});this._addButton=ThreeMeshUIHelper.createButtonBlock({text:"+",fontSize:.04,height:.04,width:.04}),t.set({fontFamily:Tt,fontTexture:xt}),t.position.fromArray([.175,.12,-.001]),t.add(this._addButton),this._addInteractable=new PointerInteractable(this._addButton,(()=>{this._addAction&&this._addAction()})),this._containerInteractable.addChild(this._addInteractable),this._object.add(t)}_searchUpdated(){this._refreshItems(),this._updateItemsGUI()}_getItemName(t){let i=this._assets[t].Name;return i.length>25&&(i="..."+i.substring(i.length-25)),i}_handleItemInteraction(t){this._action&&this._action(t)}_refreshItems(){this._items=this._getFilteredItems()}_getFilteredItems(){let t=[],i=this._textField.content.toLowerCase();for(let r in this._assets)this._assets[r].Name.toLowerCase().includes(i)&&t.push(r);return t}setContent(t,i,r,d){this._assets=t,this._action=i,this._addAction=r,this._backAction=d,this._addAction?(this._addButton.visible=!0,this._containerInteractable.addChild(this._addInteractable)):(this._addButton.visible=!1,this._containerInteractable.removeChild(this._addInteractable))}back(){this._action=null,this._textField.deactivate(),this._backAction&&this._backAction(),super.back()}}const xn=256,Mn=128;let Pn=new class{constructor(){this._hue=171,this._saturation=.7,this._lightness=.5,this._createTextures()}_createTextures(){let i=document.createElement("canvas"),r=document.createElement("canvas");i.width=256,i.height=256,r.width=1,r.height=xn,this._colorContext=i.getContext("2d"),this._lightnessContext=r.getContext("2d"),this._updateColorWheel(),this._updateLightnessBar(),this._colorTexture=new t.CanvasTexture(i),this._lightnessTexture=new t.CanvasTexture(r)}_updateColorWheel(){let t=this._colorContext.getImageData(0,0,256,256),i=t.data;this._drawColorWheel(i),this._colorContext.putImageData(t,0,0)}_drawColorWheel(t){let i=this._lightness;for(let r=-128;r<=Mn;r++){let d=r*r,A=Math.ceil(Math.sqrt(16384-d));for(let d=-A;d<=A;d++){let[A,g]=cartesianToPolar(r,d);if(A>Mn)continue;let b=4*(r+Mn+(d+Mn)*256),I=radiansToDegrees(g),w=A/Mn,[C,B,S]=hslToRGB(I,w,i);t[b]=C,t[b+1]=B,t[b+2]=S,t[b+3]=255}}}_updateLightnessBar(){let t=this._lightnessContext.getImageData(0,0,1,xn),i=t.data;for(let t=0;t<1;t++)for(let r=0;r<xn;r++){let d=4*(t+1*r),A=this._hue,g=this._saturation,b=1-r/xn,[I,w,C]=hslToRGB(A,g,b);i[d]=I,i[d+1]=w,i[d+2]=C,i[d+3]=255}this._lightnessContext.putImageData(t,0,0)}getColorTexture(){return this._colorTexture}getLightnessTexture(){return this._lightnessTexture}getXY(i){return r=this._saturation*i,d=t.MathUtils.degToRad(this._hue+180),[r*Math.cos(d),r*Math.sin(d)];var r,d}getLightness(){return this._lightness}setFromHSL(t){this._hue=360*t.h,this._saturation=t.s,this._lightness=t.l,this._updateColorWheel(),this._updateLightnessBar(),this._colorTexture.needsUpdate=!0,this._lightnessTexture.needsUpdate=!0}selectColorFromXY(t,i,r){let[d,A]=cartesianToPolar(i,r);d>t&&(d=t);let g=radiansToDegrees(-A),b=d/t,I=this._lightness,[w,C,B]=hslToRGB(g,b,I);return this._hue=g,this._saturation=b,this._updateLightnessBar(),this._lightnessTexture.needsUpdate=!0,rgbToHex(w,C,B)}selectLightnessFromXY(t,i,r){let d=this._hue,A=this._saturation,g=r/t+.5;g<0&&(g=0),g>1&&(g=1);let[b,I,w]=hslToRGB(d,A,g);return this._lightness=g,this._updateColorWheel(),this._colorTexture.needsUpdate=!0,rgbToHex(b,I,w)}};const kn=.1,Dn={};class ColorWheelPage extends MenuPage{constructor(t){super(t,!1,!0),this._addPageContent(),this._createCursors()}_addPageContent(){this._titleBlock=ThreeMeshUIHelper.createTextBlock({text:"Color Picker",fontSize:Mt.header,height:.04,width:.4}),this._container.add(this._titleBlock);let t=new je.Block({height:.2,width:.25,contentDirection:"row",justifyContent:"center",backgroundOpacity:0,offset:0});this._colorBlock=new je.Block({height:.2,width:.2,backgroundOpacity:1,backgroundTexture:Pn.getColorTexture(),margin:.02,borderWidth:0}),this._lightnessBlock=new je.Block({height:.2,width:.02,backgroundOpacity:1,backgroundTexture:Pn.getLightnessTexture(),backgroundSize:"stretch",margin:.02});let i=PointerInteractable.createDraggable(this._colorBlock,(t=>{this._handleColorCursorDrag(t),this._isDraggingColorCursor=!1,this._onEnter&&this._onEnter()}),(t=>{this._handleColorCursorDrag(t)})),r=PointerInteractable.createDraggable(this._lightnessBlock,(t=>{this._handleLightnessCursorDrag(t),this._isDraggingLightnessCursor=!1,this._onEnter&&this._onEnter()}),(t=>{this._handleLightnessCursorDrag(t)}));t.add(this._colorBlock),t.add(this._lightnessBlock),this._container.add(t),this._containerInteractable.addChild(i),this._containerInteractable.addChild(r)}_handleColorCursorDrag(t){if(!t)return;Pt[0].copy(t),this._colorBlock.worldToLocal(Pt[0]);let i=Pn.selectColorFromXY(kn,Pt[0].x,Pt[0].y);i&&this._onUpdate&&(this._onUpdate(i),this._updateColorCursor(),this._colorCursor.visible||(this._colorCursor.visible=!0)),this._isDraggingColorCursor=!0}_handleLightnessCursorDrag(t){if(!t)return;Pt[0].copy(t),this._lightnessBlock.worldToLocal(Pt[0]);let i=Pn.selectLightnessFromXY(.2,Pt[0].x,Pt[0].y);i&&this._onUpdate&&(this._onUpdate(i),this._updateLightnessCursor(),this._lightnessCursor.visible||(this._lightnessCursor.visible=!0)),this._isDraggingLightnessCursor=!0}_createCursors(){let i=new t.RingGeometry(kn/12,.01,16),r=new t.MeshBasicMaterial({color:St.white,side:t.FrontSide});this._colorCursor=new t.Mesh(i,r),this._colorCursor.position.setZ(.015),this._object.add(this._colorCursor),this._colorCursor.visible=!1,i=new t.RingGeometry(kn/9,kn/7.5,4,1,Math.PI/4);let d=i.getAttribute("position");for(let t=0;t<d.count;t++){let i=d.getY(t);i>0&&d.setY(t,i-.005),i<0&&d.setY(t,i+.005)}r=new t.MeshBasicMaterial({color:St.white,side:t.FrontSide}),this._lightnessCursor=new t.Mesh(i,r),this._lightnessCursor.position.setZ(.0105),this._object.add(this._lightnessCursor),this._lightnessCursor.visible=!1}_updateColorCursor(){let[t,i]=Pn.getXY(kn);Pt[0].set(t,-i,0),this._object.worldToLocal(this._colorBlock.localToWorld(Pt[0])),this._colorCursor.position.setX(Pt[0].x),this._colorCursor.position.setY(Pt[0].y)}_updateLightnessCursor(){let t=Pn.getLightness(kn);Pt[0].set(0,(t-.5)*kn*2,0),this._object.worldToLocal(this._lightnessBlock.localToWorld(Pt[0])),this._lightnessCursor.position.setX(Pt[0].x),this._lightnessCursor.position.setY(Pt[0].y)}setContent(t,i,r,d){Pn.setFromHSL(i.getHSL(Dn)),this._updateColorCursor(),this._updateLightnessCursor(),this._requesterId=t,this._onUpdate=r,this._onEnter=d}updateColor(t,i){this._object.parent&&this._requesterId==t&&(Pn.setFromHSL(i.getHSL(Dn)),this._updateColorCursor(),this._updateLightnessCursor())}isDraggingCursors(){return this._isDraggingColorCursor||this._isDraggingLightnessCursor}back(){this._onUpdate=null,super.back()}}const Qn=.22;class DynamicFieldsPage extends MenuPage{constructor(t){super(t,!1,!0),this._firstItemIndex=0,this._lastItemIndex=-1,this._fields=[],this._addPageContent()}_addPageContent(){this._createPreviousAndNextButtons(),this._createTitleBlock();let t=new je.Block({height:Qn,width:.45,contentDirection:"row",justifyContent:"center",backgroundOpacity:0,margin:0,offset:0});this._fieldsContainer=new je.Block({height:Qn,width:.31,contentDirection:"column",justifyContent:"space-around",backgroundOpacity:0,margin:0,offset:0}),t.add(this._previousButton),t.add(this._fieldsContainer),t.add(this._nextButton),this._container.add(this._titleBlock),this._container.add(t)}_createTitleBlock(){this._titleBlock=ThreeMeshUIHelper.createTextBlock({text:" ",fontSize:Mt.header,height:.04,width:.4,offset:0})}_createPreviousAndNextButtons(){this._previousButton=ThreeMeshUIHelper.createButtonBlock({text:"<",fontSize:.03,height:.04,width:.04}),this._nextButton=ThreeMeshUIHelper.createButtonBlock({text:">",fontSize:.03,height:.04,width:.04}),this._previousInteractable=new PointerInteractable(this._previousButton,(()=>{this._loadPrevPage()})),this._nextInteractable=new PointerInteractable(this._nextButton,(()=>{this._loadNextPage()}))}_setFields(t){this._removeCurrentFields(),this._firstItemIndex=0,this._lastItemIndex=-1,this._fields=t,this._loadNextPage();for(let i of t)i.updateFromSource()}_removeField(t){let i=this._fields.indexOf(t);t.deactivate(),t.removeFromScene(),this._fields.splice(i,1),i<=this._lastItemIndex?(i<this._firstItemIndex&&this._firstItemIndex--,this._lastItemIndex--,this._firstItemIndex==this._fields.length?this._loadPrevPage():(this._removeCurrentFields(),this._lastItemIndex=this._firstItemIndex-1,this._loadNextPage())):this._fields.length==this._lastItemIndex+1&&this._updateNavButtons()}_loadNextPage(){this._removeCurrentFields(),this._firstItemIndex=this._lastItemIndex+1;let t=Qn;for(let i=this._firstItemIndex;i<this._fields.length;i++){let r=this._fields[i];if(t-=r.getHeight(),!(t>=0||i==this._firstItemIndex))break;r.addToScene(this._fieldsContainer,this._containerInteractable),this._lastItemIndex=i}this._updateNavButtons(),this._container.update(!0,!0,!1)}_loadPrevPage(){this._removeCurrentFields();let t=Qn;this._lastItemIndex=this._firstItemIndex-1;let i=[];for(let r=this._lastItemIndex;r>=0;r--){let d=this._fields[r];if(t-=d.getHeight(),!(t>=0||r==this._lastItemIndex))break;i.push(d),this._firstItemIndex=r}for(let t=i.length-1;t>=0;t--)i[t].addToScene(this._fieldsContainer,this._containerInteractable);this._updateNavButtons()}_updateNavButtons(){0==this._firstItemIndex?(this._previousButton.visible=!1,this._containerInteractable.removeChild(this._previousInteractable)):(this._previousButton.visible=!0,this._containerInteractable.addChild(this._previousInteractable)),this._lastItemIndex+1==this._fields.length?(this._nextButton.visible=!1,this._containerInteractable.removeChild(this._nextInteractable)):(this._nextButton.visible=!0,this._containerInteractable.addChild(this._nextInteractable))}_removeCurrentFields(){for(let t=this._firstItemIndex;t<=this._lastItemIndex;t++){let i=this._fields[t];i.deactivate(),i.removeFromScene()}}_unfocusFields(){for(let t=this._firstItemIndex;t<=this._lastItemIndex;t++)this._fields[t].deactivate()}}class EditorSettingsPage extends DynamicFieldsPage{constructor(t){super(t,!1,!0),this._createFields()}_createTitleBlock(){this._titleBlock=ThreeMeshUIHelper.createTextBlock({text:"Editor Settings",fontSize:Mt.header,height:.04,width:.3})}_createFields(){let t=[];t.push(new NumberInput({title:"Movement Speed",minValue:0,maxValue:1e3,initialValue:4,onBlur:(t,i)=>{Ci.setEditorSetting("Movement Speed",i)},getFromSource:()=>Ci.getEditorSettings()["Movement Speed"]})),t.push(new NumberInput({title:"User Scale",minValue:.001,maxValue:1e3,initialValue:1,onBlur:(t,i)=>{wt.publish(this._id,It,i),Ci.setEditorSetting("User Scale",i)},getFromSource:()=>Ci.getEditorSettings()["User Scale"]})),t.push(new CheckboxInput({title:"Enable Flying",initialValue:!0,onUpdate:t=>{Ci.setEditorSetting("Enable Flying",t)},getFromSource:()=>Ci.getEditorSettings()["Enable Flying"]})),"XR"==ze.deviceType&&t.push(new CheckboxInput({title:"Swap Joysticks",initialValue:!1,onUpdate:t=>{Ci.setEditorSetting("Swap Joysticks",t)},getFromSource:()=>Ci.getEditorSettings()["Swap Joysticks"]})),this._setFields(t)}addToScene(t,i){for(let t of this._fields)t.updateFromSource();super.addToScene(t,i)}removeFromScene(){super.removeFromScene()}}const Fn=[{title:"Edit",type:vi.EDIT},{title:"Copy / Paste",type:vi.COPY_PASTE},{title:"Delete",type:vi.DELETE},{title:"Translate",type:vi.TRANSLATE},{title:"Rotate",type:vi.ROTATE},{title:"Scale",type:vi.SCALE}];class HandsPage extends PaginatedPage{constructor(t){super(t,!1,!0),this._items=Fn,this._addPageContent()}_addPageContent(){let t=ThreeMeshUIHelper.createTextBlock({text:"Hand Tools",fontSize:Mt.header,height:.04,width:.2});this._container.add(t),this._addList()}_getItemName(t){return t.title}_handleItemInteraction(t){vi.ACTIVE!=t.type&&(vi.ACTIVE=t.type,wt.publish(this._id,qe,t.type))}_refreshItems(){}}class HostPartyPage extends MenuPage{constructor(t){super(t,!1,!0),this._addPageContent()}_addPageContent(){let t=ThreeMeshUIHelper.createTextBlock({text:"Host Party",fontSize:Mt.header,height:.04,width:.2});this._container.add(t),this._contentBlock=new je.Block({height:.2,width:.45,contentDirection:"column",justifyContent:"start",backgroundOpacity:0,fontFamily:Tt,fontTexture:xt}),this._textField=new TextField({height:.03,width:.4,text:"Party Name",onEnter:()=>{this._hostParty()}}),this._textField.addToScene(this._contentBlock,this._containerInteractable);let i=ThreeMeshUIHelper.createButtonBlock({text:"Submit",fontSize:Mt.body,height:.035,width:.2,margin:.002});this._contentBlock.add(i);let r=new PointerInteractable(i,(()=>{this._hostParty()}));this._containerInteractable.addChild(r),this._container.add(this._contentBlock),this._connectingBlock=ThreeMeshUIHelper.createTextBlock({text:"Connecting...",fontSize:.025,height:.04,width:.4,fontFamily:Tt,fontTexture:xt})}_hostParty(){let t=this._textField.content;0!=t.length?(this._container.remove(this._contentBlock),this._container.add(this._connectingBlock),this._pointerInteractable.removeChild(this._containerInteractable),this._isConnecting=!0,xs.host(t,(()=>{this._successCallback()}),(t=>{this._errorCallback(t)}))):wt.publish(this._id,ot,{text:"Missing Party Name"})}_successCallback(){this._isConnecting&&(this._isConnecting=!1,this._pointerInteractable.addChild(this._containerInteractable),this._container.remove(this._connectingBlock),this._container.add(this._contentBlock),this._container.update(!1,!1,!0),this._object.parent&&this._controller.back())}_errorCallback(t){this._isConnecting=!1;let i=t.topic;"409-room"==i?wt.publish(this._id,ot,{text:"Party Name Already Taken"}):"rtc-timeout"==i?wt.publish(this._id,ot,{text:"Could not connect to all other users, please try again"}):"bad-auth"==i?wt.publish(this._id,ot,{text:"Could not authenticate with Server"}):("error"==i||console.error("Unexpected error message topic: "+i),wt.publish(this._id,ot,{text:"Unexpected Error"})),this._pointerInteractable.addChild(this._containerInteractable),this._container.remove(this._connectingBlock),this._container.add(this._contentBlock),this._container.update(!1,!1,!0)}addToScene(t,i){this._isConnecting&&!xs.isPartyActive()&&(this._pointerInteractable.addChild(this._containerInteractable),this._container.remove(this._connectingBlock),this._container.add(this._contentBlock),this._container.update(!1,!1,!0)),super.addToScene(t,i)}}class InstancePage extends DynamicFieldsPage{constructor(t){super(t,!1,!0)}_createTitleBlock(){this._titleBlock=new je.Block({height:.04,width:.43,contentDirection:"row",justifyContent:"end",backgroundOpacity:0,margin:.01,offset:0}),this._titleField=new TextField({height:.04,width:.31,fontSize:Mt.header,margin:0,onBlur:()=>{this._instance.getEditorHelper().updateName(this._titleField.content)}});let t=ThreeMeshUIHelper.createButtonBlock({backgroundTexture:vt.trashIcon,backgroundTextureScale:.7,height:.04,width:.04});this._titleBlock.add(this._titleField.getObject()),this._titleBlock.add(t),this._titleField.setPointerInteractableParent(this._containerInteractable);let i=new PointerInteractable(t,(()=>{yn.deleteAssetInstance(this._instance)}));this._containerInteractable.addChild(i)}setInstance(t){this._instance=t;let i=t.getName();this._titleField.setContent(i),this._setFields(t.getEditorHelper().getMenuFields())}_addSubscriptions(){wt.subscribe(this._id,$e,(t=>{t.instance==this._instance&&this._controller.popPagesPast(ks.INSTANCE)})),wt.subscribe(this._id,et,(t=>{t.asset==this._instance&&this._titleField.setContent(t.asset.getName())})),wt.subscribe(this._id,tt,(t=>{t.instance.getId()==this._instance.getId()&&this._unfocusFields()})),wt.subscribe(this._id,pt,(t=>{t&&(this._removeSubscriptions(),this._containerInteractable.removeChild(this._previousInteractable),this._containerInteractable.removeChild(this._nextInteractable),this._controller.setPage(ks.NAVIGATION))}))}_removeSubscriptions(){wt.unsubscribe(this._id,$e),wt.unsubscribe(this._id,et),wt.unsubscribe(this._id,tt),wt.unsubscribe(this._id,pt)}back(){this._removeCurrentFields(),this._containerInteractable.removeChild(this._previousInteractable),this._containerInteractable.removeChild(this._nextInteractable),this._removeSubscriptions(),super.back()}addToScene(t,i){this._addSubscriptions(),super.addToScene(t,i)}removeFromScene(){super.removeFromScene()}}class JoinPartyPage extends MenuPage{constructor(t){super(t,!1,!0),this._addPageContent()}_addPageContent(){let t=ThreeMeshUIHelper.createTextBlock({text:"Join Party",fontSize:Mt.header,height:.04,width:.2});this._container.add(t),this._contentBlock=new je.Block({height:.2,width:.45,contentDirection:"column",justifyContent:"start",backgroundOpacity:0,fontFamily:Tt,fontTexture:xt}),this._textField=new TextField({height:.03,width:.4,text:"Party Name",onEnter:()=>{this._joinParty()}}),this._textField.addToScene(this._contentBlock,this._containerInteractable);let i=ThreeMeshUIHelper.createButtonBlock({text:"Join",fontSize:Mt.body,height:.035,width:.2,margin:.002});this._contentBlock.add(i);let r=new PointerInteractable(i,(()=>{this._joinParty()}));this._containerInteractable.addChild(r),this._container.add(this._contentBlock),this._connectingBlock=ThreeMeshUIHelper.createTextBlock({text:"Connecting...",fontSize:.025,height:.04,width:.4,fontFamily:Tt,fontTexture:xt})}_joinParty(){let t=this._textField.content;0!=t.length?(this._container.remove(this._contentBlock),this._container.add(this._connectingBlock),this._pointerInteractable.removeChild(this._containerInteractable),this._isConnecting=!0,xs.join(t,(()=>{this._successCallback()}),(t=>{this._errorCallback(t)}))):wt.publish(this._id,ot,{text:"Missing Party Name"})}_successCallback(){this._isConnecting&&(this._isConnecting=!1,this._pointerInteractable.addChild(this._containerInteractable),this._container.remove(this._connectingBlock),this._container.add(this._contentBlock),this._container.update(!1,!1,!0),this._object.parent&&this._controller.back())}_errorCallback(t){this._isConnecting=!1;let i=t.topic;"404-room"==i?wt.publish(this._id,ot,{text:"Party Name Not Found"}):"rtc-timeout"==i?wt.publish(this._id,ot,{text:"Could not connect to all other users in time, please try again"}):"could-not-connect"==i?wt.publish(this._id,ot,{text:"Could not connect to all other users, please try again"}):"bad-auth"==i?wt.publish(this._id,ot,{text:"Could not authenticate with Server"}):("error"==i||console.error("Unexpected error message topic: "+i),wt.publish(this._id,ot,{text:"Unexpected Error"})),this._pointerInteractable.addChild(this._containerInteractable),this._container.remove(this._connectingBlock),this._container.add(this._contentBlock),this._container.update(!1,!1,!0)}addToScene(t,i){this._isConnecting&&!xs.isPartyActive()&&(this._pointerInteractable.addChild(this._containerInteractable),this._container.remove(this._connectingBlock),this._container.add(this._contentBlock),this._container.update(!1,!1,!0)),super.addToScene(t,i)}}const Rn=["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"];let Ln=new class{init(){this._files,this._fileId,this._folderId,this._gapiInitialized=!1,this._gisInitialized=!1,gapi.load("client",(()=>{this._initClient()}))}_initClient(){this._tokenClient=google.accounts.oauth2.initTokenClient({client_id:"791471431939-q3fifjtaq8mhlhce0l5h96k38m8fchn2.apps.googleusercontent.com",scope:"https://www.googleapis.com/auth/drive.file",callback:t=>{this._accessToken=t.access_token,this._gisInitialized=!0,this._initialize(),this._authCallback&&this._authCallback(),this._authCallback=null}}),gapi.client.init({apiKey:"AIzaSyBdadP7BFyNpPCRAlCfV-ikXklXkdJ188s",discoveryDocs:Rn}).then((()=>{this._gapiInitialized=!0,this._initialize()}),(function(t){"idpiframe_initialization_failed"==t.error&&t.details.includes("Cookies")&&console.log("TODO: Let user know cookies must be enabled for Google Drive to work"),console.error(JSON.stringify(t,null,2))}))}_initialize(){this._gisInitialized&&this._gapiInitialized&&!this._folderId&&(this._fetchFolder(),this.fetchFiles())}handleAuthButton(t){this._authCallback=t,this._tokenClient.requestAccessToken()}handleSignoutButton(t){gapi.client.setToken(),this._gisInitialized=!1,this._folderId=null,t&&t()}_fetchFolder(){gapi.client.drive.files.list({q:"mimeType = 'application/vnd.google-apps.folder'",spaces:"drive"}).execute((t=>{0==t.files.length?this._createFolder():this._folderId=t.files[0].id}))}_createFolder(){gapi.client.drive.files.create({resource:{name:"Digital Bacon",mimeType:"application/vnd.google-apps.folder"}}).then((t=>{200!=t.status?console.log("TODO: Let user know there was a problem"):this._folderId=t.result.id}))}isSignedIn(){return gapi.client&&null!=gapi.client.getToken()}hasActiveFile(){return null!=this._fileId}clearActiveFile(){this._fileId=null}fetchFiles(t){return gapi.client.drive.files.list({q:"mimeType='application/zip'"}).execute((i=>{this._files=i.files,t&&t(this._files)})),this._files}loadFile(t,i,r){gapi.client.drive.files.get({fileId:t,alt:"media"}).then((r=>{JSZip.loadAsync(r.body).then((r=>{this._fileId=t,i&&i(r)}))}),(function(t){console.error("Failed to get file: "+t),r&&r()}))}save(t,i,r){if(!this.isSignedIn())throw"Not signed into google drive";t.generateAsync({type:"blob"}).then((t=>{this._update(t,i,r)}))}saveAs(t,i,r,d){if(!this.isSignedIn())throw"Not signed into google drive";i.generateAsync({type:"blob"}).then((i=>{this._upload(t,i,r,d)}))}_upload(t,i,r,d){let A={name:t+".zip",mimeType:"application/zip",parents:[this._folderId]},g=JSON.stringify(A),b=this._accessToken;fetch("https://www.googleapis.com/upload/drive/v3/files?uploadType=resumable&supportsAllDrives=true",{method:"POST",headers:new Headers({Authorization:"Bearer "+b,"Content-Type":"application/json; charset=UTF-8","Content-Length":g.length}),body:g}).then((t=>{if(200!=t.status)console.error("Error:",error),d();else{let A=t.headers.get("location");this._resumableUpload(A,i,r,d,!1)}}))}_update(t,i,r){let d=this._accessToken;fetch("https://www.googleapis.com/upload/drive/v3/files/{fileId}?uploadType=resumable".replace("{fileId}",this._fileId),{method:"PUT",headers:new Headers({Authorization:"Bearer "+d,"X-HTTP-Method-Override":"PATCH"})}).then((d=>{if(200!=d.status)console.error("Error:",error),r();else{let A=d.headers.get("location");this._resumableUpload(A,t,i,r,!0)}}))}_resumableUpload(t,i,r,d,A){let g={Authorization:"Bearer "+this._accessToken};A&&(g["X-HTTP-Method-Override"]="PATCH"),fetch(t,{method:"PUT",headers:new Headers(g),body:i}).then((t=>{200==t.status?(r(),t.json().then((t=>{this._fileId=t.id}))):(console.error("Error:",error),d())}))}};class LoadFromGDrivePage extends PaginatedPage{constructor(t){super(t,!1,!0),this._instances={},this._items=Object.keys(this._instances),this._addPageContent(),this._filesLoaded=!1,this._isLoadingSaving=!1,this._addSubscriptions()}_addPageContent(){this._titleBlock=ThreeMeshUIHelper.createTextBlock({text:"Load From Google Drive",fontSize:Mt.header,height:.04,width:.4}),this._container.add(this._titleBlock),this._loadingSavingBlock=ThreeMeshUIHelper.createTextBlock({text:"Loading...",fontSize:.025,height:.04,width:.4,fontFamily:Tt,fontTexture:xt}),this._container.add(this._loadingSavingBlock),this._addList()}_getItemName(t){return this._instances[t].name}_handleItemInteraction(t){this._loadingSavingBlock.children[1].set({content:"Project Loading..."}),this._updateLoadingSaving(!1),Ln.loadFile(this._instances[t].id,(t=>{this._loadSuccessCallback(t)}),(()=>{this._loadErrorCallback()}))}_loadSuccessCallback(t){yn.loadZip(t,(()=>{wt.publish(this._id,ot,{text:"Project Loaded"}),xs.isPartyActive()&&xs.isHost()&&xs.sendProject()}),(()=>{this._loadErrorCallback()}))}_loadErrorCallback(){this._updateLoadingSaving(!0),wt.publish(this._id,ot,{text:"Error Loading Project",sustainTime:5})}_refreshItems(){this._items=Object.keys(this._instances)}loadProjects(){let t=Ln.fetchFiles((t=>{this._filesLoaded||(this._filesLoaded=!0,this._isLoadingSaving||(this._container.remove(this._loadingSavingBlock),this._container.add(this._optionsContainer),this._containerInteractable.addChild(this._optionsInteractable))),this._instances=t,this._refreshItems(),this._updateItemsGUI()}));t&&(this._instances=t,this._filesLoaded||(this._filesLoaded=!0,this._isLoadingSaving||(this._container.remove(this._loadingSavingBlock),this._container.add(this._optionsContainer),this._containerInteractable.addChild(this._optionsInteractable))))}_addSubscriptions(){wt.subscribe(this._id,pt,(t=>{this._loadingSavingBlock.children[1].set({content:"Project Loading..."}),this._updateLoadingSaving(t)})),wt.subscribe(this._id,gt,(t=>{this._loadingSavingBlock.children[1].set({content:"Project Saving..."}),this._updateLoadingSaving(t)}))}_updateLoadingSaving(t){if(this._isLoadingSaving=!t,t){if(!this._filesLoaded)return void this._loadingSavingBlock.children[1].set({content:"Loading..."});this._container.remove(this._loadingSavingBlock),this._container.add(this._optionsContainer),this._containerInteractable.addChild(this._optionsInteractable),this._container.update(!1,!1,!0)}else this._container.remove(this._optionsContainer),this._container.add(this._loadingSavingBlock),this._containerInteractable.removeChild(this._optionsInteractable)}}let On=class extends MenuPage{constructor(t,i,r){super(t,i,r),this._paginatedListButtons=[],this._paginatedListInteractables=[],this._page=0,this._optionsInteractable=PointerInteractable.emptyGroup()}_addList(){this._createPreviousAndNextButtons(),this._optionsContainer=new je.Block({height:.17,width:.45,contentDirection:"row",justifyContent:"center",backgroundOpacity:0,offset:0});let t={height:.17,width:.31,contentDirection:"column",justifyContent:"start",backgroundOpacity:0,offset:0};this._optionsBlock=new je.Block(t),t.height=.085,t.contentDirection="row",t.justifyContent="center",t.margin=.005,this._rows=[],this._rows.push(new je.Block(t)),this._rows.push(new je.Block(t));for(let t=0;t<2;t++){let i=this._rows[t];for(let r=0;r<3;r++){let d=ThreeMeshUIHelper.createButtonBlock({height:.085,width:.1,margin:.002,justifyContent:"start",fontFamily:Tt,fontTexture:xt}),A=new je.Block({height:.04,width:.04,backgroundTexture:vt.searchIcon,offset:1e-4,borderRadius:0}),g=ThreeMeshUIHelper.createTextBlock({text:" ",height:.035,width:.1,margin:0});d.add(A),d.add(g),i.add(d),this._paginatedListButtons.push(d);let b=new PointerInteractable(d,(()=>{let i=2*this._page*3+3*t+r;this._items.length>i?this._handleItemInteraction(this._items[i]):console.error("PaginatedIconsPage displaying non existant option")}));this._optionsInteractable.addChild(b),this._paginatedListInteractables.push(b)}}this._optionsBlock.add(this._rows[0]),this._optionsBlock.add(this._rows[1]),this._optionsContainer.add(this._previousButton),this._optionsContainer.add(this._optionsBlock),this._optionsContainer.add(this._nextButton),this._container.add(this._optionsContainer),this._containerInteractable.addChild(this._optionsInteractable)}_createPreviousAndNextButtons(){this._previousButton=ThreeMeshUIHelper.createButtonBlock({text:"<",fontSize:.03,height:.04,width:.04,fontFamily:Tt,fontTexture:xt}),this._nextButton=ThreeMeshUIHelper.createButtonBlock({text:">",fontSize:.03,height:.04,width:.04,fontFamily:Tt,fontTexture:xt}),this._previousInteractable=new PointerInteractable(this._previousButton,(()=>{this._page-=1,this._updateItemsGUI()})),this._nextInteractable=new PointerInteractable(this._nextButton,(()=>{this._page+=1,this._updateItemsGUI()}))}_updateItemsGUI(){let t=2*this._page*3;for(let i=0;i<6;i++){let r=this._paginatedListInteractables[i],d=this._paginatedListButtons[i];if(t+i<this._items.length){let A=this._items[t+i];d.children[2].children[1].set({content:this._getItemName(A)}),d.children[1].set({backgroundTexture:this._getItemIcon(A)}),d.visible=!0,this._optionsInteractable.addChild(r)}else d.visible=!1,this._optionsInteractable.removeChild(r)}0==this._page?(this._previousButton.visible=!1,this._optionsInteractable.removeChild(this._previousInteractable)):(this._previousButton.visible=!0,this._optionsInteractable.addChild(this._previousInteractable)),this._items.length>t+6?(this._nextButton.visible=!0,this._optionsInteractable.addChild(this._nextInteractable)):(this._nextButton.visible=!1,this._optionsInteractable.removeChild(this._nextInteractable))}_getItemName(){return console.error("PaginatedIconsPage._getItemName() should be overridden"),""}_getItemIcon(){return console.error("PaginatedIconsPage._getItemIcon() should be overridden"),""}_handleItemInteraction(){console.error("PaginatedIconsPage._handleItemInteraction() should be overridden")}_refreshItems(){console.error("PaginatedIconsPage._refreshItems() should be overridden")}addToScene(t,i){super.addToScene(t,i),t&&(this._refreshItems(),this._updateItemsGUI())}};const Un=[{text:"Models",icon:vt.objectIcon,page:ks.ASSETS,assetType:Ve.MODEL},{text:"Images",icon:vt.imageIcon,page:ks.ASSETS,assetType:Ve.IMAGE},{text:"Shapes",icon:vt.shapesIcon,page:ks.ASSETS,assetType:Ve.SHAPE},{text:"Lights",icon:vt.lightbulbIcon,page:ks.ASSETS,assetType:Ve.LIGHT},{text:"Materials",icon:vt.materialIcon,page:ks.MATERIALS},{text:"Textures",icon:vt.textureIcon,page:ks.TEXTURES}];class LibraryPage extends On{constructor(t){super(t,!1,!0),this._items=Object.keys(Un),this._addPageContent(),this._createSearchButton()}_addPageContent(){let t=ThreeMeshUIHelper.createTextBlock({text:"Assets",fontSize:Mt.header,height:.04,width:.2});this._container.add(t),this._addList()}_createSearchButton(){let t=new je.Block({height:.06,width:.06,backgroundColor:St.defaultMenuBackground,backgroundOpacity:0}),i=ThreeMeshUIHelper.createButtonBlock({backgroundTexture:vt.searchIcon,backgroundTextureScale:.8,height:.04,width:.04,padding:.01});t.set({fontFamily:Tt,fontTexture:xt}),t.position.fromArray([-.175,.12,-.001]),t.add(i);let r=new PointerInteractable(i,(()=>{this._controller.pushPage(ks.LIBRARY_SEARCH)}));this._containerInteractable.addChild(r),this._object.add(t)}_getItemName(t){return Un[t].text}_getItemIcon(t){return Un[t].icon}_handleItemInteraction(t){if(Un[t].assetType){this._controller.getPage(Un[t].page).setContent(Un[t].assetType,Un[t].text)}this._controller.pushPage(Un[t].page)}_refreshItems(){}}class LibrarySearchPage extends PaginatedPage{constructor(t){super(t,!1,!0),this._assets=ui.getLibrary(),this._items=Object.keys(this._assets),this._addPageContent()}_addPageContent(){this._textField=new TextField({height:.04,width:.4,fontSize:Mt.header,onBlur:()=>{this._searchUpdated()},onUpdate:()=>{this._searchUpdated()}}),this._textField.addToScene(this._container,this._containerInteractable),this._addList()}_searchUpdated(){this._refreshItems(),this._updateItemsGUI()}_getItemName(t){let i=this._assets[t].Name;return i.length>25&&(i="..."+i.substring(i.length-25)),i}_handleItemInteraction(t){this._controller.getPage(ks.ASSET).setAsset(t),this._controller.pushPage(ks.ASSET)}_refreshItems(){this._assets=ui.getLibrary(),this._items=this._getFilteredItems()}_getFilteredItems(){let t=[],i=this._textField.content.toLowerCase();for(let r in this._assets)if(this._assets[r].Name.toLowerCase().includes(i))t.push(r);else{let d=yn.getInstancesForAssetId(r);for(let A in d)if(d[A].getName().toLowerCase().includes(i)){t.push(r);break}}return t}back(){this._textField.deactivate(),super.back()}}class MaterialPage extends DynamicFieldsPage{constructor(t){super(t,!1,!0)}_createTitleBlock(){this._titleBlock=new je.Block({height:.04,width:.43,contentDirection:"row",justifyContent:"end",backgroundOpacity:0,margin:.01,offset:0}),this._titleField=new TextField({height:.04,width:.31,fontSize:Mt.header,margin:0,onBlur:()=>{this._material.getEditorHelper().updateName(this._titleField.content)}});let t=ThreeMeshUIHelper.createButtonBlock({backgroundTexture:vt.trashIcon,backgroundTextureScale:.7,height:.04,width:.04});this._titleBlock.add(this._titleField.getObject()),this._titleBlock.add(t),this._titleField.setPointerInteractableParent(this._containerInteractable);let i=new PointerInteractable(t,(()=>{ys.deleteMaterial(this._material)}));this._containerInteractable.addChild(i)}setMaterial(t){this._material=t;let i=t.getName();this._titleField.setContent(i),this._setFields(t.getEditorHelper().getMenuFields())}_addSubscriptions(){wt.subscribe(this._id,nt,(t=>{t.material==this._material&&this._controller.popPagesPast(ks.MATERIAL)})),wt.subscribe(this._id,rt,(t=>{t.asset==this._material&&this._titleField.setContent(t.asset.getName())})),wt.subscribe(this._id,pt,(t=>{t&&(this._removeSubscriptions(),this._containerInteractable.removeChild(this._previousInteractable),this._containerInteractable.removeChild(this._nextInteractable),this._controller.setPage(ks.NAVIGATION))}))}_removeSubscriptions(){wt.unsubscribe(this._id,nt),wt.unsubscribe(this._id,rt),wt.unsubscribe(this._id,pt)}back(){this._removeCurrentFields(),this._containerInteractable.removeChild(this._previousInteractable),this._containerInteractable.removeChild(this._nextInteractable),this._removeSubscriptions(),super.back()}addToScene(t,i){this._addSubscriptions(),super.addToScene(t,i)}removeFromScene(){super.removeFromScene()}}class MaterialsPage extends PaginatedPage{constructor(t){super(t,!1,!0),this._materials=ys.getMaterials(),this._items=Object.keys(this._materials),this._addPageContent(),this._createAddButton()}_addPageContent(){let t=ThreeMeshUIHelper.createTextBlock({text:"Materials",fontSize:Mt.header,height:.04,width:.2});this._container.add(t),this._addList()}_createAddButton(){let t=new je.Block({height:.06,width:.06,backgroundColor:St.defaultMenuBackground,backgroundOpacity:0}),i=ThreeMeshUIHelper.createButtonBlock({text:"+",fontSize:.04,height:.04,width:.04});t.set({fontFamily:Tt,fontTexture:xt}),t.position.fromArray([.175,.12,-.001]),t.add(i);let r=new PointerInteractable(i,(()=>{this._controller.getPage(ks.NEW_MATERIAL).setContent((t=>{this._handleItemInteraction(t.getId())})),this._controller.pushPage(ks.NEW_MATERIAL)}));this._containerInteractable.addChild(r),this._object.add(t)}_getItemName(t){let i=this._materials[t].getName();return i.length>25&&(i="..."+i.substring(i.length-25)),i}_handleItemInteraction(t){this._controller.getPage(ks.MATERIAL).setMaterial(this._materials[t]),this._controller.pushPage(ks.MATERIAL)}_refreshItems(){this._materials=ys.getMaterials(),this._items=Object.keys(this._materials)}_addSubscriptions(){wt.subscribe(this._id,st,(t=>{this._refreshItems(),this._updateItemsGUI()})),wt.subscribe(this._id,rt,(t=>{this._refreshItems(),this._updateItemsGUI()})),wt.subscribe(this._id,nt,(t=>{this._refreshItems(),this._updateItemsGUI()})),wt.subscribe(this._id,pt,(t=>{t&&(this._refreshItems(),this._updateItemsGUI())}))}_removeSubscriptions(){wt.unsubscribe(this._id,st),wt.unsubscribe(this._id,rt),wt.unsubscribe(this._id,nt),wt.unsubscribe(this._id,pt)}addToScene(t,i){this._addSubscriptions(),super.addToScene(t,i)}removeFromScene(){this._removeSubscriptions(),super.removeFromScene()}}const Nn=[{title:"Hand Tools",menuPage:ks.HANDS},{title:"Library",menuPage:ks.LIBRARY},{title:"Settings",menuPage:ks.SETTINGS},{title:"Project File",menuPage:ks.PROJECT},{title:"Connect with Peers",menuPage:ks.PARTY}];class NavigationPage extends MenuPage{constructor(t){super(t,!1),this._addPageContent()}_addPageContent(){let t=ThreeMeshUIHelper.createTextBlock({text:"Menu",fontSize:Mt.header,height:.04,width:.2});this._container.add(t);let i=new je.Block({height:.2,width:.45,contentDirection:"column",justifyContent:"start",backgroundOpacity:0}),r=ze.authUrl&&ze.socketUrl;for(let t of Nn){if("XR"!=ze.deviceType&&t.menuPage==ks.HANDS)continue;if(t.menuPage==ks.PARTY&&!r)continue;let d=ThreeMeshUIHelper.createButtonBlock({text:t.title,fontSize:Mt.body,height:.035,width:.3,margin:.002});i.add(d);let A=new PointerInteractable(d,(()=>{this._controller.pushPage(t.menuPage)}));this._containerInteractable.addChild(A)}this._container.add(i)}}const Hn="BASIC",Gn="LAMBERT",jn="NORMAL",zn="PHONG",Vn="STANDARD",Yn="TOON",Wn=[{title:"Basic",materialType:Hn},{title:"Lambert",materialType:Gn},{title:"Normal",materialType:jn},{title:"Phong",materialType:zn},{title:"Standard",materialType:Vn},{title:"Toon",materialType:Yn}];class NewMaterialPage extends PaginatedPage{constructor(t){super(t,!1,!0),this._items=Wn,this._addPageContent()}_addPageContent(){let t=ThreeMeshUIHelper.createTextBlock({text:"Add New Material",fontSize:Mt.header,height:.04,width:.3});this._container.add(t),this._addList()}_getItemName(t){return t.title}_handleItemInteraction(t){let i=ys.addNewMaterial(t.materialType);this.back(),this._additionalAction&&this._additionalAction(i)}_refreshItems(){}setContent(t){this._additionalAction=t}}const Xn=[{title:"Basic",textureType:qs},{title:"Cube",textureType:Js}];class NewTexturePage extends PaginatedPage{constructor(t){super(t,!1,!0),this._items=Xn,this._addPageContent()}_addPageContent(){let t=ThreeMeshUIHelper.createTextBlock({text:"Add New Texture",fontSize:.03,height:.04,width:.3});this._container.add(t),this._addList()}_getItemName(t){return t.title}_handleItemInteraction(t){let i=Cs.addNewTexture(t.textureType);this.back(),this._additionalAction&&this._additionalAction(i)}_refreshItems(){}setContent(t){this._additionalAction=t}}const Kn=[{title:"Host Party",menuPage:ks.HOST_PARTY},{title:"Join Party",menuPage:ks.JOIN_PARTY}],Zn=[{title:"Display Usernames",handler:"_handleDisplayUsernames"},{title:"Update Username",handler:"_handleUpdateUsername"},{title:"Mute Myself",handler:"_handleMuteMyself"},{title:"Mute Friends",handler:"_handleMuteFriends"},{title:"Disconnect",handler:"_handleDisconnect"},{title:"Users",type:"label"}];class PartyPage extends DynamicFieldsPage{constructor(t){super(t),this._connected=!1,this._displayingUsernames=!1,this._mutedMyself=!1,this._mutedPeers=!1,this._fieldsContainer.set({justifyContent:"start"}),this._peerFields={},this._addFields()}_createTitleBlock(){this._titleBlock=ThreeMeshUIHelper.createTextBlock({text:"Party",fontSize:Mt.header,height:.04,width:.4,offset:0})}_addFields(){this._connectedFields=[],this._disconnectedFields=[];for(let t of Kn){let i=new ButtonEntity(t.title,(()=>{this._controller.pushPage(t.menuPage)}));this._disconnectedFields.push(i)}for(let t of Zn){let i;t.handler?i=new ButtonEntity(t.title,(()=>{this[t.handler]()})):"label"==t.type&&(i=new TextEntity(t.title)),this._connectedFields.push(i)}this._setFields(this._disconnectedFields)}_handleDisplayUsernames(){this._displayingUsernames=!this._displayingUsernames;let t=this._connectedFields[0].getObject();this._displayingUsernames?t.children[1].set({content:"Hide Usernames"}):t.children[1].set({content:"Display Usernames"}),xs.setDisplayingUsernames(this._displayingUsernames)}_handleUpdateUsername(){let t=this._controller.getPage(ks.TEXT_INPUT),i=xs.getUsername();t.setContentWithInitialValue("Update Username",i,"Update",(t=>{(t=t.trim())?(xs.setUsername(t),this._controller.back()):wt.publish(this._id,ot,{text:"Username can't be blank"})})),this._controller.pushPage(ks.TEXT_INPUT)}_handleDisconnect(){ws.disconnect(),this._updateFields()}_handleMuteMyself(){this._mutedMyself=!this._mutedMyself;let t=this._connectedFields[2].getObject();this._mutedMyself?t.children[1].set({content:"Unmute Myself"}):t.children[1].set({content:"Mute Myself"});for(let t in this._peerFields)this._peerFields[t].toggleMyselfMuted(this._mutedMyself)}_handleMuteFriends(){this._mutedPeers=!this._mutedPeers;let t=this._connectedFields[3].getObject();this._mutedPeers?t.children[1].set({content:"Unmute Friends"}):t.children[1].set({content:"Mute Friends"});for(let t in this._peerFields)this._peerFields[t].togglePeerMuted(this._mutedPeers)}_updateFields(){if(xs.isPartyActive()){if(!this._checkPeers()&&this._connected)return;this._setFields(this._connectedFields.concat(Object.values(this._peerFields))),this._connected=!0}else{for(let t in this._peerFields)delete this._peerFields[t];this._setFields(this._disconnectedFields),this._connected=!1}}_checkPeers(){let t=!1,i=xs.getPeers();for(let r in i)if(!(r in this._peerFields)&&i[r].rtc){let d=i[r];this._peerFields[r]=new PeerEntity(d,d.username,this._controller,(t=>this._abdicateHost(t))),this._mutedMyself&&this._peerFields[r].toggleMyselfMuted(!0),this._mutedPeers&&this._peerFields[r].togglePeerMuted(!0),t=!0}for(let r in this._peerFields)r in i?this._peerFields[r].setUsername(i[r].username):(this._peerFields[r].removeFromScene(),delete this._peerFields[r],t=!0);return t}_abdicateHost(t){for(let t in this._peerFields)this._peerFields[t].toggleHost(!1)}_handlePeerConnected(t){if(!this._connected)return;let i=t.peer,r=new PeerEntity(i,i.username,this._controller,(t=>this._abdicateHost(t)));this._mutedMyself&&r.toggleMyselfMuted(!0),this._mutedPeers&&r.togglePeerMuted(!0),this._peerFields[i.id]=r,this._fields.push(r),this._fields.length==this._lastItemIndex+2&&(this._removeCurrentFields(),this._lastItemIndex=this._firstItemIndex-1,this._loadNextPage())}_addSubscriptions(){wt.subscribe(this._id,Ke,(()=>{for(let t in this._peerFields)this._peerFields[t].toggleHost(!0)})),wt.subscribe(this._id,dt,(()=>{this._connected||this._updateFields()})),wt.subscribe(this._id,ht,(()=>{this._connected&&this._updateFields()})),wt.subscribe(this._id,ct,(t=>{this._handlePeerConnected(t)})),wt.subscribe(this._id,At,(t=>{if(!this._connected)return;let i=t.peer,r=this._peerFields[i.id];r&&(this._removeField(r),delete this._peerFields[i.id])})),wt.subscribe(this._id,ut,(t=>{if(!this._connected)return;let i=t.peer;this._peerFields[i.id].setUsername(i.username)}))}_removeSubscriptions(){wt.unsubscribe(this._id,dt),wt.unsubscribe(this._id,ht),wt.unsubscribe(this._id,ct),wt.unsubscribe(this._id,At),wt.unsubscribe(this._id,ut)}addToScene(t,i){this._updateFields(),this._addSubscriptions(),super.addToScene(t,i)}removeFromScene(){this._removeSubscriptions(),super.removeFromScene()}}class MenuEntity extends PointerInteractableEntity{constructor(){super()}getHeight(){return.039}updateFromSource(){}deactivate(){}}class ButtonEntity extends MenuEntity{constructor(t,i){super(),this._object=ThreeMeshUIHelper.createButtonBlock({text:t,fontFamily:Tt,fontTexture:xt,fontSize:Mt.body,height:.035,width:.3,margin:.002}),this._pointerInteractable=new PointerInteractable(this._object,i)}}class TextEntity extends MenuEntity{constructor(t){super(),this._object=ThreeMeshUIHelper.createTextBlock({text:t,fontFamily:Tt,fontTexture:xt,fontSize:Mt.body,height:.035,width:.3,offset:0,margin:.002})}getHeight(){return.045}}class PeerEntity extends MenuEntity{constructor(t,i,r,d){super(),this._peer=t,this._controller=r,this._designateHostCallback=d,this._mutedMyself=!1,this._mutedPeer=!1,this._object=new je.Block({fontFamily:Tt,fontTexture:xt,height:.035,width:.31,contentDirection:"row",justifyContent:"start",backgroundOpacity:0,offset:0,margin:.002}),this._addContent(i)}_addContent(t){this._usernameBlock=ThreeMeshUIHelper.createButtonBlock({text:t||"...",fontFamily:Tt,fontTexture:xt,fontSize:Mt.body,height:.035,width:.228,offset:0,margin:.002});let i={backgroundTexture:vt.microphoneIcon,backgroundTextureScale:.85,height:.035,width:.035,margin:.002};this._muteMyselfButton=ThreeMeshUIHelper.createButtonBlock(i),i.backgroundTexture=vt.headphonesIcon,this._mutePeerButton=ThreeMeshUIHelper.createButtonBlock(i),this._muteMyselfButton.children[1].set({backgroundColor:St.green}),this._mutePeerButton.children[1].set({backgroundColor:St.green}),xs.isHost()||this._usernameBlock.set({backgroundOpacity:0}),this._object.add(this._usernameBlock),this._object.add(this._muteMyselfButton),this._object.add(this._mutePeerButton),this._addInteractables()}_addInteractables(){this._usernameInteractable=new PointerInteractable(this._usernameBlock,(()=>{this._controller.getPage(ks.PEER).setContent(this._peer,this._designateHostCallback),this._controller.pushPage(ks.PEER)})),this._muteMyselfInteractable=new PointerInteractable(this._muteMyselfButton,(()=>{this.toggleMyselfMuted()})),this._mutePeerInteractable=new PointerInteractable(this._mutePeerButton,(()=>{this.togglePeerMuted()})),xs.isHost()&&this._pointerInteractable.addChild(this._usernameInteractable),this._pointerInteractable.addChild(this._muteMyselfInteractable),this._pointerInteractable.addChild(this._mutePeerInteractable)}toggleHost(t){t?(this._pointerInteractable.addChild(this._usernameInteractable),this._usernameBlock.set({backgroundOpacity:.7})):(this._pointerInteractable.removeChild(this._usernameInteractable),this._usernameBlock.set({backgroundOpacity:0}))}toggleMyselfMuted(t){if(t==this._mutedMyself)return;let i;this._mutedMyself=!this._mutedMyself,i=this._mutedMyself?St.red:St.green,this._peer.rtc.toggleMyselfMuted(this._mutedMyself),this._muteMyselfButton.children[1].set({backgroundColor:i})}togglePeerMuted(t){if(t==this._mutedPeer)return;let i;this._mutedPeer=!this._mutedPeer,i=this._mutedPeer?St.red:St.green,this._peer.rtc.togglePeerMuted(this._mutedPeer),this._mutePeerButton.children[1].set({backgroundColor:i})}setUsername(t){t=stringWithMaxLength(t||"...",12),this._usernameBlock.children[1].content!=t&&this._usernameBlock.children[1].set({content:t})}addToScene(t,i){this.setUsername(this._peer.username),super.addToScene(t,i)}}const qn=[{title:"Make Host",handler:"_handleMakeHost"},{title:"Kick Out",handler:"_handleKickOut"}];class PeerPage extends MenuPage{constructor(t){super(t,!1,!0),this._addPageContent()}_addPageContent(){this._titleBlock=ThreeMeshUIHelper.createTextBlock({text:" ",fontSize:Mt.header,height:.04,width:.4}),this._container.add(this._titleBlock);let t=new je.Block({height:.2,width:.45,contentDirection:"column",justifyContent:"start",backgroundOpacity:0});for(let i of qn){let r=ThreeMeshUIHelper.createButtonBlock({text:i.title,fontSize:Mt.body,height:.035,width:.3,margin:.002}),d=new PointerInteractable(r,(()=>this[i.handler]()));t.add(r),this._containerInteractable.addChild(d)}this._container.add(t)}_handleMakeHost(){this._designateHostCallback&&this._designateHostCallback(this._peer.id),xs.setIsHost(!1),ws.designateHost(this._peer.id),this._controller.back()}_handleKickOut(){ws.bootPeer(this._peer.id),this._controller.back()}setContent(t,i){let r=stringWithMaxLength(t.username||"...",12);this._titleBlock.children[1].set({content:r}),this._peer=t,this._designateHostCallback=i}_addSubscriptions(){wt.subscribe(this._id,ht,(()=>{this._controller.back()})),wt.subscribe(this._id,At,(t=>{this._peer==t.peer&&this._controller.back()})),wt.subscribe(this._id,ut,(t=>{this._peer==t.peer&&this.setContent(this._peer)}))}_removeSubscriptions(){wt.unsubscribe(this._id,ht),wt.unsubscribe(this._id,At),wt.unsubscribe(this._id,ut)}back(){this._removeSubscriptions(),super.back()}addToScene(t,i){this._addSubscriptions(),super.addToScene(t,i)}}const Jn=[{parameter:"visualEdit"},{parameter:"intensity",name:"Intensity",min:0,type:NumberInput},{parameter:"color",name:"Color",type:ColorInput},{parameter:"position"},{parameter:"rotation"},{parameter:"scale"}];class PrimitiveLightHelper extends AssetHelper{constructor(t){super(t),this._createMesh()}_createMesh(){console.error("PrimitiveLightHelper._createMesh() should be overridden")}_updateVisualEdit(t){t?this._object.add(this._mesh):(this._object.remove(this._mesh),fullDispose(this._mesh)),super._updateVisualEdit(t)}_getMenuFieldsMap(){let t=super._getMenuFieldsMap();for(let i of Jn)if(!(i.parameter in t)){let r=this._createStandardInput(i);r&&(t[i.parameter]=r)}return t}}class PrimitiveLight extends Asset{constructor(t={}){super(t),this._color=numberOr(t.color,16777215),this._intensity=numberOr(t.intensity,1)}_createEditorHelper(){this._editorHelper=new PrimitiveLightHelper(this)}clone(t){let i=this._fetchCloneParams(t);return yn.addLight(i,this._assetId)}exportParams(){let t=super.exportParams();return t.color=this._light.color.getHex(),t.intensity=this._intensity,t}getColor(){return this._color}getIntensity(){return this._intensity}setColor(t){this._color!=t&&(this._color=t,this._light.color.setHex(t))}setIntensity(t){this._intensity!=t&&(this._intensity=t,this._light.intensity=t)}}const $n=[{parameter:"visualEdit"},{parameter:"intensity"},{parameter:"color"},{parameter:"position"},{parameter:"rotation"},{parameter:"scale"}];class PrimitiveAmbientLightHelper extends PrimitiveLightHelper{constructor(t){super(t)}_createMesh(){let i=new t.BoxGeometry(.1,.1,.1),r=new t.MeshBasicMaterial({color:St.yellow});this._mesh=new t.Mesh(i,r),this._asset.visualEdit&&this._object.add(this._mesh)}getMenuFields(){return super.getMenuFields($n)}}const er="7605bff2-8ca3-4a47-b6f7-311d745507de";class PrimitiveAmbientLight extends PrimitiveLight{constructor(t={}){super(t),this._assetId=er,this._createLight(),t.isPreview&&this.makeTranslucent()}_createEditorHelper(){this._editorHelper=new PrimitiveAmbientLightHelper(this)}_createLight(){this._light=new t.AmbientLight(this._color,this._intensity),this._object.add(this._light)}}yn.registerLight(PrimitiveAmbientLight,er,"Ambient Light");let tr=new class{constructor(){this._triggerDelayedClickEvent=!1,this._addEventListeners()}_addEventListeners(){"XR"!=ze.deviceType&&(this._eventType="MOBILE"==ze.deviceType?"touchend":"click",this._clickListener=t=>{setTimeout((()=>{this._triggerDelayedClickEvent&&(this._triggerDelayedClickEvent=!1,this._callback&&this._callback())}),20)})}triggerEvent(){this._triggerDelayedClickEvent=!0}listenForClick(t){this._callback=t,document.addEventListener(this._eventType,this._clickListener)}stopListening(){this._callback=null,this._fileListenerActive=!1,document.removeEventListener(this._eventType,this._clickListener)}};const ir={"New Project":"_newProject","Load from Device":"_localLoad","Load from Google Drive":"_googleDriveLoad","Save to Device":"_localSave","Save to Google Drive":"_googleDriveSave","Sign out of Google Drive":"_googleDriveSignout"};class ProjectPage extends PaginatedPage{constructor(t){super(t,!1,!0),this._items=Object.keys(ir).slice(0,-1),this._addPageContent(),this._addSubscriptions()}_addPageContent(){let t=ThreeMeshUIHelper.createTextBlock({text:"Project File",fontSize:Mt.header,height:.04,width:.2});this._container.add(t),this._loadingSavingBlock=ThreeMeshUIHelper.createTextBlock({text:"Project Loading...",fontSize:.025,height:.04,width:.4,fontFamily:Tt,fontTexture:xt}),this._addList()}_getItemName(t){return t}_handleItemInteraction(t){this[ir[t]]()}_refreshItems(){Ln.isSignedIn()?this._items=Object.keys(ir):this._items=Object.keys(ir).slice(0,-1)}_newProject(){if(xs.isPartyActive()&&!xs.isHost())return void wt.publish(this._id,ot,{text:"Only Host Can Load Projects"});yn.reset();let t=new PrimitiveAmbientLight({visualEdit:!1});yn.addLight(t,t.getAssetId(),!0),Ln.clearActiveFile(),xs.isPartyActive()&&xs.isHost()&&xs.sendProject()}_localSave(){this._updateSaving(!1),wt.publish(this._id,gt,!1),yn.exportProject().generateAsync({type:"blob"}).then((t=>{this._updateSaving(!0),wt.publish(this._id,gt,!0),saveAs(t,"Digital Bacon Project.zip")}),(t=>{console.error(t),this._updateSaving(!0),wt.publish(this._id,gt,!0),wt.publish(this._id,ot,{text:"Error Saving Project"})}))}_localLoad(){!xs.isPartyActive()||xs.isHost()?Fi.triggerUpload():wt.publish(this._id,ot,{text:"Only Host Can Load Projects"})}_googleDriveSave(){if(Ln.isSignedIn()){if(Ln.hasActiveFile())return this._updateSaving(!1),wt.publish(this._id,gt,!1),void Ln.save(yn.exportProject(),(()=>{this._saveSuccessCallback()}),(()=>{this._saveErrorCallback()}));this._controller.getPage(ks.TEXT_INPUT).setContent("Save Project As","Filename","Save",(t=>{this._updateSaving(!1),wt.publish(this._id,gt,!1),Ln.saveAs(t,yn.exportProject(),(()=>{this._saveSuccessCallback()}),(()=>{this._saveErrorCallback()})),this._controller.back()})),this._controller.pushPage(ks.TEXT_INPUT)}else this._googleDriveSignin((()=>this._googleDriveSave()))}_googleDriveLoad(){if(!xs.isPartyActive()||xs.isHost())if(Ln.isSignedIn()){this._controller.getPage(ks.LOAD_GDRIVE).loadProjects(),this._controller.pushPage(ks.LOAD_GDRIVE)}else this._googleDriveSignin((()=>this._googleDriveLoad()));else wt.publish(this._id,ot,{text:"Only Host Can Load Projects"})}_googleDriveSignin(t){this._googleSigninCallback=t,"XR"==ze.deviceType?(ki.exitXRSession(),Ln.handleAuthButton((()=>{this._handleGoogleAuthResponse()}))):tr.triggerEvent()}_handleGoogleAuthResponse(){this._refreshItems(),this._updateItemsGUI(),this._googleSigninCallback&&this._googleSigninCallback()}_googleDriveSignout(){Ln.isSignedIn()&&Ln.handleSignoutButton(),this._page=0,this._refreshItems(),this._updateItemsGUI()}_handleLocalFile(t){this._updateLoading(!1),JSZip.loadAsync(t).then((t=>{Ln.clearActiveFile(),yn.loadZip(t,(()=>{wt.publish(this._id,ot,{text:"Project Loaded"}),xs.isPartyActive()&&xs.isHost()&&xs.sendProject()}),(()=>{this._loadErrorCallback()}))}))}_loadErrorCallback(){wt.publish(this._id,ot,{text:"Error Loading Project",sustainTime:5})}_saveSuccessCallback(){this._updateSaving(!0),wt.publish(this._id,gt,!0),wt.publish(this._id,ot,{text:"Project Saved"})}_saveErrorCallback(){this._updateSaving(!0),wt.publish(this._id,gt,!0),wt.publish(this._id,ot,{text:"Error Saving Project"})}_addSubscriptions(){wt.subscribe(this._id,pt,(t=>{this._updateLoading(t)})),wt.subscribe(this._id,gt,(t=>{this._updateSaving(t)}))}_updateLoading(t){this._loadingSavingBlock.children[1].set({content:"Project Loading..."}),this._updateLoadingSaving(t)}_updateSaving(t){this._loadingSavingBlock.children[1].set({content:"Project Saving..."}),this._updateLoadingSaving(t)}_updateLoadingSaving(t){t?(this._container.remove(this._loadingSavingBlock),this._container.add(this._optionsContainer),this._container.update(!1,!1,!0)):(this._container.remove(this._optionsContainer),this._container.add(this._loadingSavingBlock))}addToScene(t,i){tr.listenForClick((()=>{Ln.handleAuthButton((()=>{this._handleGoogleAuthResponse()}))})),Fi.listenForProjectFile((t=>{this._handleLocalFile(t)})),super.addToScene(t,i)}removeFromScene(){tr.stopListening(),Fi.stopListening(),super.removeFromScene()}}let sr=new class{init(t){this._setupIframe(t),this._addEventListeners()}_setupIframe(t){this._iframe=document.createElement("iframe"),this._iframe.id="digital-bacon-rpm-iframe",this._iframe.allow="camera *; microphone *; clipboard-write",this._iframe.src="https://digital-bacon.readyplayer.me/avatar?frameApi&clearCache",this._iframe.hidden=!0,this._closeButton=document.createElement("button"),this._closeButton.innerHTML="Close Ready Player Me",this._closeButton.id="ready-player-me-close-button",$(this._closeButton).addClass("hidden"),t.append(this._iframe),t.append(this._closeButton)}_addEventListeners(){window.addEventListener("message",(t=>{this._handleMessage(t)})),this._closeButton.addEventListener("click",(()=>{this._close()}))}_handleMessage(t){const i=function(t){try{return JSON.parse(t.data)}catch(t){return null}}(t);i&&"readyplayerme"===i.source&&("v1.frame.ready"===i.eventName&&this._iframe.contentWindow.postMessage(JSON.stringify({target:"readyplayerme",type:"subscribe",eventName:"v1.**"}),"*"),"v1.avatar.exported"===i.eventName&&(ps.updateAvatar(i.data.url+"?useHands=false"),this._close()),i.eventName)}_close(){$(this._closeButton).addClass("hidden"),this._iframe.hidden=!0}selectAvatar(){$(this._closeButton).removeClass("hidden"),this._iframe.hidden=!1,"XR"==ze.deviceType&&ki.exitXRSession()}};const nr=[{title:"Backdrop",menuPage:ks.SKYBOX,isEditorOnly:!0},{title:"User Settings",menuPage:ks.USER_SETTINGS},{title:"Editor Settings",menuPage:ks.EDITOR_SETTINGS,isEditorOnly:!0},{title:"Update Avatar"}];class SettingsPage extends MenuPage{constructor(t){super(t,!1,!0),this._addPageContent()}_addPageContent(){let t=ThreeMeshUIHelper.createTextBlock({text:"Settings",fontSize:Mt.header,height:.04,width:.2});this._container.add(t);let i=new je.Block({height:.2,width:.45,contentDirection:"column",justifyContent:"start",backgroundOpacity:0});for(let t of nr){if(!ze.isEditor&&t.isEditorOnly)continue;let r=ThreeMeshUIHelper.createButtonBlock({text:t.title,fontSize:Mt.body,height:.035,width:.3,margin:.002});i.add(r);let d=new PointerInteractable(r,(()=>{t.menuPage?this._controller.pushPage(t.menuPage):sr.selectAvatar()}));this._containerInteractable.addChild(d)}this._container.add(i)}}const rr="DigitalBacon:Sketchfab:authToken",ar="DigitalBacon:Sketchfab:authExpiry",or="https://digitalbacon.io";let lr=new class{constructor(){this._authToken=localStorage.getItem(rr),this._authExpiry=localStorage.getItem(ar)}isSignedIn(){return this._authToken&&this._authExpiry&&this._authExpiry>Date.now()}signIn(t,i){this._intervalId&&(clearInterval(this._intervalId),this._intervalId=null);let r=window.open("https://sketchfab.com/oauth2/authorize/?state=123456789&response_type=token&client_id=WXFMTux03Lde8DFpnZWlzwR4afwtSrpumZToMy62","_blank");r.focus(),window._tab=r,this._intervalId=setInterval((()=>{r.postMessage("fetch_auth_token",or)}),1e3),window.addEventListener("message",(d=>{d.origin==or&&"sketchfab_auth_token"==d.data.topic&&(clearInterval(this._intervalId),r.postMessage("close_tab",or),this._authToken=d.data.authToken,this._authExpiry=d.data.authExpiry,t&&(localStorage.setItem(rr,this._authToken),localStorage.setItem(ar,this._authExpiry)),i&&i())}))}search(t,i,r){let d="https://api.sketchfab.com/v3/search?type=models&downloadable=true&archives_flavours=false&q="+encodeURIComponent(t);this.fetch(d,i,r)}fetch(t,i,r){fetch(t,{headers:{Authorization:"Bearer "+this._authToken}}).then((t=>t.json())).then((t=>{i&&i(t)})).catch((t=>{console.error(t),r&&r()}))}_download(t,i,r,d){fetch(t).then((t=>t.blob())).then((t=>{ui.addNewAsset(t,i.name,Ve.MODEL,(t=>{ui.setSketchfabDetails(t,i),r&&r(t)}))})).catch((t=>{console.error(t),d&&d()}))}download(t,i,r){this.fetch("https://api.sketchfab.com/v3/models/{uid}/download".replace("{uid}",t.uid),(d=>{d.glb?this._download(d.glb.url,t,i,r):r&&r()}),r)}},hr=class extends MenuPage{constructor(t){super(t,!1,!0),this._staySignedIn=!1,this._addPageContent()}_addPageContent(){this._titleBlock=ThreeMeshUIHelper.createTextBlock({text:" ",fontSize:Mt.header,height:.04,width:.3}),this._container.add(this._titleBlock);let t=new je.Block({height:.2,width:.45,contentDirection:"column",justifyContent:"start",backgroundOpacity:0});this._textureBlock=new je.Block({height:.085,width:.1,backgroundOpacity:1}),t.add(this._textureBlock),this._authorBlock=ThreeMeshUIHelper.createTextBlock({text:"Author: ",fontSize:Mt.body,height:.025,width:.3}),t.add(this._authorBlock);let i=ThreeMeshUIHelper.createButtonBlock({text:"View on Sketchfab",fontSize:Mt.body,height:.035,width:.3,margin:.006});t.add(i);let r=new PointerInteractable(i,(()=>{"XR"==ze.deviceType&&ki.exitXRSession(),window.open(this._sketchfabAsset.viewerUrl,"_blank")}));this._containerInteractable.addChild(r),this._downloadButton=ThreeMeshUIHelper.createButtonBlock({text:"Download",fontSize:Mt.body,height:.035,width:.3,margin:.006}),t.add(this._downloadButton),this._downloadInteractable=new PointerInteractable(this._downloadButton,(()=>{this._downloadButton.visible=!1,this._containerInteractable.removeChild(this._downloadInteractable),lr.download(this._sketchfabAsset,(t=>{this._handleDownloadSuccess(t)}),(()=>{this._handleDownloadError()}))})),this._containerInteractable.addChild(this._downloadInteractable),this._container.add(t)}_handleDownloadSuccess(t){this._controller.getPosition(Pt[0]),this._controller.getDirection(Pt[1]).normalize().divideScalar(4);let i=Pt[0].sub(Pt[1]).toArray();Pt[0].set(0,0,1),Pt[1].setY(0).normalize(),Qt.setFromUnitVectors(Pt[0],Pt[1]),Dt.setFromQuaternion(Qt);let r=Dt.toArray();yn.addGLTF({assetId:t,position:i,rotation:r,visualEdit:!0}),this._downloadButton.visible=!0,this._containerInteractable.addChild(this._downloadInteractable)}_handleDownloadError(){wt.publish(this._id,ot,{text:"Could not download model, please try again later"}),this._downloadButton.visible=!0,this._containerInteractable.addChild(this._downloadInteractable)}setContent(t){this._titleBlock.children[1].set({content:t.name}),this._authorBlock.children[1].set({content:"Author: "+t.user.username}),t.previewTexture?(this._textureBlock.set({backgroundTexture:t.previewTexture}),this._textureBlock.visible=!0):this._textureBlock.visible=!1,this._sketchfabAsset=t}};class SketchfabLoginPage extends MenuPage{constructor(t){super(t,!1,!0),this._staySignedIn=!1,this._addPageContent()}_addPageContent(){let t=ThreeMeshUIHelper.createTextBlock({text:"Login to Sketchfab",fontSize:Mt.header,height:.04,width:.3});this._container.add(t);let i=new je.Block({height:.2,width:.45,contentDirection:"column",justifyContent:"start",backgroundOpacity:0,margin:.03});new CheckboxInput({title:"Stay signed in on this device",titleWidth:.27,initialValue:!1,swapOrder:!0,onUpdate:t=>{this._staySignedIn=t},getFromSource:()=>this._staySignedIn}).addToScene(i,this._containerInteractable);let r=ThreeMeshUIHelper.createButtonBlock({text:"Login",fontSize:Mt.body,height:.035,width:.3});i.add(r);let d=new PointerInteractable(r,(()=>{"XR"==ze.deviceType&&ki.exitXRSession(),lr.signIn(this._staySignedIn,(()=>{this._handleLoginCallback()}))}));this._containerInteractable.addChild(d),this._container.add(i)}_handleLoginCallback(){this._controller.popPage(),this._controller.pushPage(ks.SKETCHFAB_SEARCH)}}class PaginatedIconsPage extends MenuPage{constructor(t,i,r){super(t,i,r),this._paginatedListButtons=[],this._paginatedListInteractables=[],this._page=0,this._optionsInteractable=PointerInteractable.emptyGroup()}_addList(){this._createPreviousAndNextButtons(),this._optionsContainer=new je.Block({height:.17,width:.45,contentDirection:"row",justifyContent:"center",backgroundOpacity:0,offset:0});let t={height:.17,width:.31,contentDirection:"column",justifyContent:"start",backgroundOpacity:0,offset:0};this._optionsBlock=new je.Block(t),t.height=.085,t.contentDirection="row",t.justifyContent="center",t.margin=.005,this._rows=[],this._rows.push(new je.Block(t)),this._rows.push(new je.Block(t));for(let t=0;t<2;t++){let i=this._rows[t];for(let r=0;r<3;r++){let d=ThreeMeshUIHelper.createButtonBlock({height:.085,width:.1,margin:.002,justifyContent:"start",idleBackgroundColor:St.white,hoveredBackgroundColor:St.white,selectedBackgroundColor:St.white,idleOpacity:1}),A=ThreeMeshUIHelper.createTextBlock({text:" ",height:.035,width:.1,margin:0});d.add(A),i.add(d),this._paginatedListButtons.push(d);let g=new PointerInteractable(d,(()=>{let i=2*this._page*3+3*t+r;this._items.length>i?this._handleItemInteraction(this._items[i]):console.error("PaginatedIconsPage displaying non existant option")}));this._optionsInteractable.addChild(g),this._paginatedListInteractables.push(g)}}this._optionsBlock.add(this._rows[0]),this._optionsBlock.add(this._rows[1]),this._optionsContainer.add(this._previousButton),this._optionsContainer.add(this._optionsBlock),this._optionsContainer.add(this._nextButton),this._container.add(this._optionsContainer),this._containerInteractable.addChild(this._optionsInteractable)}_createPreviousAndNextButtons(){this._previousButton=ThreeMeshUIHelper.createButtonBlock({text:"<",fontSize:.03,height:.04,width:.04,fontFamily:Tt,fontTexture:xt}),this._nextButton=ThreeMeshUIHelper.createButtonBlock({text:">",fontSize:.03,height:.04,width:.04,fontFamily:Tt,fontTexture:xt}),this._previousInteractable=new PointerInteractable(this._previousButton,(()=>{this._page-=1,this._updateItemsGUI()})),this._nextInteractable=new PointerInteractable(this._nextButton,(()=>{this._page+=1,this._updateItemsGUI()})),this._fetchNextInteractable=new PointerInteractable(this._nextButton,(()=>{this._page+=1,this._fetchNextItems(),this._updateItemsGUI()}))}_updateItemsGUI(){let t=2*this._page*3;for(let i=0;i<6;i++){let r=this._paginatedListInteractables[i],d=this._paginatedListButtons[i];if(t+i<this._items.length){let A=this._items[t+i],g=this._getItemImage(A);d.set({backgroundTexture:g}),d.visible=!0,this._optionsInteractable.addChild(r)}else d.visible=!1,this._optionsInteractable.removeChild(r)}0==this._page?(this._previousButton.visible=!1,this._optionsInteractable.removeChild(this._previousInteractable)):(this._previousButton.visible=!0,this._optionsInteractable.addChild(this._previousInteractable)),this._items.length>t+6?(this._nextButton.visible=!0,this._optionsInteractable.addChild(this._nextInteractable),this._optionsInteractable.removeChild(this._fetchNextInteractable)):this._items.length==t+6&&this._canFetchMore?(this._nextButton.visible=!0,this._optionsInteractable.addChild(this._fetchNextInteractable),this._optionsInteractable.removeChild(this._nextInteractable)):(this._nextButton.visible=!1,this._optionsInteractable.removeChild(this._nextInteractable),this._optionsInteractable.removeChild(this._fetchNextInteractable))}_getItemImage(){return console.error("PaginatedIconsPage._getItemImage() should be overridden"),""}_handleItemInteraction(){console.error("PaginatedIconsPage._handleItemInteraction() should be overridden")}_refreshItems(){console.error("PaginatedIconsPage._refreshItems() should be overridden")}addToScene(t,i){super.addToScene(t,i),t&&(this._refreshItems(),this._updateItemsGUI())}}class SketchfabSearchPage extends PaginatedIconsPage{constructor(t){super(t,!1,!0),this._items=[],this._addPageContent()}_addPageContent(){this._textField=new TextField({height:.04,width:.4,text:"Search",fontSize:Mt.header,onBlur:()=>{this._searchUpdated()}}),this._textField.addToScene(this._container,this._containerInteractable),this._loadingBlock=ThreeMeshUIHelper.createTextBlock({text:"Loading...",fontSize:.025,height:.04,width:.4,fontFamily:Tt,fontTexture:xt}),this._addList()}_searchUpdated(){for(let t of this._items)t.isDeleted=!0,t.previewTexture&&t.previewTexture.dispose();if(this._page=0,this._items=[],this._updateItemsGUI(),0==this._textField.content.length)return void this._textField.reset();this._container.remove(this._optionsContainer),this._container.add(this._loadingBlock);let t=Math.random();this._idempotentKey=t,lr.search(this._textField.content,(i=>{this._handleSearchResponse(i,t)}),(()=>{this._handleSearchError()}))}_handleSearchResponse(t,i){if(this._idempotentKey==i){this._container.remove(this._loadingBlock),this._container.add(this._optionsContainer);for(let i of t.results)this._items.push(i);this._canFetchMore=t.next,this._updateItemsGUI()}}_handleSearchError(){this._container.remove(this._loadingBlock),wt.publish(this._id,ot,{text:"An unexpected error occurred, please try again later"})}_handleFetchMoreError(){this._page--,this._updateItemsGUI(),wt.publish(this._id,ot,{text:"An unexpected error occurred, please try again later"})}_fetchNextItems(){this._container.remove(this._optionsContainer),this._container.add(this._loadingBlock);let t=Math.random();this._idempotentKey=t,lr.fetch(this._canFetchMore,(i=>{this._handleSearchResponse(i,t)}),(()=>{this._handleFetchMoreError()}))}_getItemImage(t){if(t.previewTexture)return t.previewTexture;if(!t.isLoadingTexture){let i=this._getSmallestImage(t.thumbnails.images);t.previewUrl=i.url,t.isLoadingTexture=!0,(new L).load(t.previewUrl,(i=>{t.isDeleted?i.dispose():(t.previewTexture=i,this._updateItemsGUI())}))}return vt.ellipsisIcon}_getSmallestImage(t){let i=null;for(let r of t)r.width<256||(null==i||r.size<i.size)&&(i=r);return i}_handleItemInteraction(t){this._controller.getPage(ks.SKETCHFAB_ASSET).setContent(t),this._controller.pushPage(ks.SKETCHFAB_ASSET)}_refreshItems(){}}const dr=[bi.TOP,bi.LEFT,bi.FRONT,bi.RIGHT,bi.BACK,bi.BOTTOM];class SkyboxPage extends MenuPage{constructor(t){super(t,!1,!0),this._buttons=[],this._addPageContent()}_addPageContent(){let t=ThreeMeshUIHelper.createTextBlock({text:"Backdrop",fontSize:Mt.header,height:.04,width:.2});this._container.add(t);let i=new je.Block({height:.2,width:.45,contentDirection:"column",justifyContent:"start",backgroundOpacity:0}),r=new je.Block({height:.064,width:.3,contentDirection:"row",justifyContent:"center",backgroundOpacity:0});for(let t=0;t<dr.length;t++){let d=ThreeMeshUIHelper.createButtonBlock({backgroundTexture:vt.searchIcon,height:.06,width:.06,margin:.002,borderRadius:1e-5}),A=new PointerInteractable(d,(()=>{let i=ui.getLibrary(),r={"null\n":{Name:"Blank"}};for(let t in i){let d=i[t];d.Type==Ve.IMAGE&&(r[t]=d)}this._controller.getPage(ks.ASSET_SELECT).setContent(r,(i=>{"null\n"==i&&(i=null),Ci.setSkyboxSide(dr[t],i),this._controller.back()}),(()=>{this._fileUploadSide=dr[t],Fi.triggerUpload()}),(()=>{Fi.stopListening()})),this._controller.pushPage(ks.ASSET_SELECT),Fi.listenForAssets((t=>{t.length>0&&(Ci.setSkyboxSide(this._fileUploadSide,t[0]),this._controller.back())}),!1,Ve.IMAGE)}));if(this._containerInteractable.addChild(A),0==t){let t=new je.Block({height:.064,width:.128,contentDirection:"row",justifyContent:"start",backgroundOpacity:0});t.add(d),i.add(t)}else if(t<5)r.add(d);else{i.add(r);let t=new je.Block({height:.064,width:.128,contentDirection:"row",justifyContent:"start",backgroundOpacity:0});t.add(d),i.add(t)}this._buttons.push(d)}this._container.add(i)}_setTextures(){let t=Ci.getSkyboxTextures();for(let i=0;i<dr.length;i++)this._buttons[i].children[1].backgroundTexture!=t[dr[i]]&&this._buttons[i].children[1].set({backgroundTexture:t[dr[i]]})}_addSubscriptions(){wt.subscribe(this._id,mt,(t=>{this._setTextures()}))}_removeSubscriptions(){wt.unsubscribe(this._id,mt)}addToScene(t,i){super.addToScene(t,i),this._setTextures(),this._addSubscriptions()}removeFromScene(){super.removeFromScene(),this._removeSubscriptions()}}class TexturePage extends DynamicFieldsPage{constructor(t){super(t,!1,!0)}_createTitleBlock(){this._titleBlock=new je.Block({height:.04,width:.43,contentDirection:"row",justifyContent:"end",backgroundOpacity:0,margin:.01,offset:0}),this._titleField=new TextField({height:.04,width:.31,fontSize:Mt.header,margin:0,onBlur:()=>{this._texture.getEditorHelper().updateName(this._titleField.content)}});let t=ThreeMeshUIHelper.createButtonBlock({backgroundTexture:vt.trashIcon,backgroundTextureScale:.7,height:.04,width:.04});this._titleBlock.add(this._titleField.getObject()),this._titleBlock.add(t),this._titleField.setPointerInteractableParent(this._containerInteractable);let i=new PointerInteractable(t,(()=>{Cs.deleteTexture(this._texture)}));this._containerInteractable.addChild(i)}setTexture(t){this._texture=t;let i=t.getName();this._titleField.setContent(i),this._setFields(t.getEditorHelper().getMenuFields())}_addSubscriptions(){wt.subscribe(this._id,ft,(t=>{t.texture==this._texture&&this._controller.popPagesPast(ks.TEXTURE)})),wt.subscribe(this._id,bt,(t=>{t.asset==this._texture&&this._titleField.setContent(t.asset.getName())})),wt.subscribe(this._id,pt,(t=>{t&&(this._removeSubscriptions(),this._containerInteractable.removeChild(this._previousInteractable),this._containerInteractable.removeChild(this._nextInteractable),this._controller.setPage(ks.NAVIGATION))}))}_removeSubscriptions(){wt.unsubscribe(this._id,ft),wt.unsubscribe(this._id,bt),wt.unsubscribe(this._id,pt)}back(){this._removeCurrentFields(),this._containerInteractable.removeChild(this._previousInteractable),this._containerInteractable.removeChild(this._nextInteractable),this._removeSubscriptions(),super.back()}addToScene(t,i){this._addSubscriptions(),super.addToScene(t,i)}removeFromScene(){super.removeFromScene()}}class TexturesPage extends PaginatedPage{constructor(t){super(t,!1,!0),this._textures=Cs.getTextures(),this._items=Object.keys(this._textures),this._addPageContent(),this._createAddButton()}_addPageContent(){let t=ThreeMeshUIHelper.createTextBlock({text:"Textures",fontSize:Mt.header,height:.04,width:.2});this._container.add(t),this._addList()}_createAddButton(){let t=new je.Block({height:.06,width:.06,backgroundColor:St.defaultMenuBackground,backgroundOpacity:0}),i=ThreeMeshUIHelper.createButtonBlock({text:"+",fontSize:.04,height:.04,width:.04});t.set({fontFamily:Tt,fontTexture:xt}),t.position.fromArray([.175,.12,-.001]),t.add(i);let r=new PointerInteractable(i,(()=>{this._controller.getPage(ks.NEW_TEXTURE).setContent((t=>{this._handleItemInteraction(t.getId())})),this._controller.pushPage(ks.NEW_TEXTURE)}));this._containerInteractable.addChild(r),this._object.add(t)}_getItemName(t){let i=this._textures[t].getName();return i.length>25&&(i="..."+i.substring(i.length-25)),i}_handleItemInteraction(t){this._controller.getPage(ks.TEXTURE).setTexture(this._textures[t]),this._controller.pushPage(ks.TEXTURE)}_refreshItems(){this._textures=Cs.getTextures(),this._items=Object.keys(this._textures)}_addSubscriptions(){wt.subscribe(this._id,_t,(t=>{this._refreshItems(),this._updateItemsGUI()})),wt.subscribe(this._id,bt,(t=>{this._refreshItems(),this._updateItemsGUI()})),wt.subscribe(this._id,ft,(t=>{this._refreshItems(),this._updateItemsGUI()})),wt.subscribe(this._id,pt,(t=>{t&&(this._refreshItems(),this._updateItemsGUI())}))}_removeSubscriptions(){wt.unsubscribe(this._id,_t),wt.unsubscribe(this._id,bt),wt.unsubscribe(this._id,ft),wt.unsubscribe(this._id,pt)}addToScene(t,i){this._addSubscriptions(),super.addToScene(t,i)}removeFromScene(){this._removeSubscriptions(),super.removeFromScene()}}class TextInputPage extends MenuPage{constructor(t){super(t,!1,!0),this._addPageContent()}_addPageContent(){this._titleBlock=ThreeMeshUIHelper.createTextBlock({text:" ",fontSize:Mt.header,height:.04,width:.4}),this._container.add(this._titleBlock);let t=new je.Block({height:.2,width:.45,contentDirection:"column",justifyContent:"start",backgroundOpacity:0});this._textField=new TextField({height:.04,width:.4,onEnter:()=>{this._inputConfirmed()}}),this._button=ThreeMeshUIHelper.createButtonBlock({text:" ",fontSize:Mt.body,height:.04,width:.25,margin:.002});let i=new PointerInteractable(this._button,(()=>{this._inputConfirmed()}));this._textField.addToScene(t,this._containerInteractable),t.add(this._button),this._container.add(t),this._containerInteractable.addChild(i)}_inputConfirmed(){this._textField.deactivate(),this._action&&this._action(this._textField.content)}setContent(t,i,r,d){this._titleBlock.children[1].set({content:t}),this._button.children[1].set({content:r}),this._action=d,this._textField.setDefaultContent(i),this._textField.reset()}setContentWithInitialValue(t,i,r,d){this._titleBlock.children[1].set({content:t}),this._button.children[1].set({content:r}),this._action=d,this._textField.setContent(i)}back(){this._textField.deactivate(),super.back()}}const cr={"Select from Device":"_uploadAsset","Select from Sketchfab":"_selectFromSketchfab"};class UploadPage extends PaginatedPage{constructor(t){super(t,!1,!0),this._items=Object.keys(cr),this._addPageContent()}_addPageContent(){let t=ThreeMeshUIHelper.createTextBlock({text:"Upload Asset",fontSize:Mt.header,height:.04,width:.2});this._container.add(t),this._addList()}_getItemName(t){return t}_handleItemInteraction(t){this[cr[t]]()}_refreshItems(){}_uploadAsset(){Fi.triggerUpload()}_selectFromSketchfab(){lr.isSignedIn()?this._controller.pushPage(ks.SKETCHFAB_SEARCH):this._controller.pushPage(ks.SKETCHFAB_LOGIN)}_uploadCallback(t){this._controller.getPosition(Pt[0]),this._controller.getDirection(Pt[1]).normalize().divideScalar(4);let i=Pt[0].sub(Pt[1]).toArray();Pt[0].set(0,0,1),Pt[1].setY(0).normalize(),Qt.setFromUnitVectors(Pt[0],Pt[1]),Dt.setFromQuaternion(Qt);let r=Dt.toArray();for(let d of t){let t=ui.getType(d);t==Ve.IMAGE?yn.addImage({assetId:d,position:i,rotation:r,doubleSided:!0,transparent:!0,visualEdit:!0}):t==Ve.MODEL&&yn.addGLTF({assetId:d,position:i,rotation:r,visualEdit:!0})}}addToScene(t,i){Fi.listenForAssets((t=>{this._uploadCallback(t)}),!0),super.addToScene(t,i)}removeFromScene(){Fi.stopListening(),super.removeFromScene()}}class UserSettingsPage extends DynamicFieldsPage{constructor(t){super(t,!1,!0),this._createFields()}_createTitleBlock(){this._titleBlock=ThreeMeshUIHelper.createTextBlock({text:"User Settings",fontSize:Mt.header,height:.04,width:.3})}_createFields(){let t=[];t.push(new NumberInput({title:"Movement Speed",minValue:0,maxValue:1e3,initialValue:4,onBlur:(t,i)=>{Ci.setUserSetting("Movement Speed",i)},getFromSource:()=>Ci.getUserSettings()["Movement Speed"]})),t.push(new CheckboxInput({title:"Enable Flying",initialValue:!0,onUpdate:t=>{Ci.setUserSetting("Enable Flying",t)},getFromSource:()=>Ci.getUserSettings()["Enable Flying"]})),this._setFields(t)}_addSubscriptions(){wt.subscribe(this._id,mt,(t=>{for(let t of this._fields)t.updateFromSource()}))}_removeSubscriptions(){wt.unsubscribe(this._id,mt)}addToScene(t,i){this._addSubscriptions();for(let t of this._fields)t.updateFromSource();super.addToScene(t,i)}removeFromScene(){this._removeSubscriptions(),super.removeFromScene()}}class EditorMenuController extends MenuController{constructor(){super(),this._pages[ks.ACKNOWLEDGEMENTS]=new AcknowledgementsPage(this),this._pages[ks.ASSET]=new AssetPage(this),this._pages[ks.ASSETS]=new LightsPage(this),this._pages[ks.ASSET_SELECT]=new AssetSelectPage(this),this._pages[ks.COLOR_WHEEL]=new ColorWheelPage(this),this._pages[ks.EDITOR_SETTINGS]=new EditorSettingsPage(this),this._pages[ks.HOST_PARTY]=new HostPartyPage(this),this._pages[ks.INSTANCE]=new InstancePage(this),this._pages[ks.JOIN_PARTY]=new JoinPartyPage(this),this._pages[ks.LIBRARY]=new LibraryPage(this),this._pages[ks.LIBRARY_SEARCH]=new LibrarySearchPage(this),this._pages[ks.LOAD_GDRIVE]=new LoadFromGDrivePage(this),this._pages[ks.MATERIAL]=new MaterialPage(this),this._pages[ks.MATERIALS]=new MaterialsPage(this),this._pages[ks.NAVIGATION]=new NavigationPage(this),this._pages[ks.NEW_MATERIAL]=new NewMaterialPage(this),this._pages[ks.NEW_TEXTURE]=new NewTexturePage(this),this._pages[ks.PARTY]=new PartyPage(this),this._pages[ks.PEER]=new PeerPage(this),this._pages[ks.PROJECT]=new ProjectPage(this),this._pages[ks.SETTINGS]=new SettingsPage(this),this._pages[ks.SKETCHFAB_ASSET]=new hr(this),this._pages[ks.SKETCHFAB_LOGIN]=new SketchfabLoginPage(this),this._pages[ks.SKETCHFAB_SEARCH]=new SketchfabSearchPage(this),this._pages[ks.SKYBOX]=new SkyboxPage(this),this._pages[ks.TEXTURE]=new TexturePage(this),this._pages[ks.TEXTURES]=new TexturesPage(this),this._pages[ks.TEXT_INPUT]=new TextInputPage(this),this._pages[ks.UPLOAD]=new UploadPage(this),this._pages[ks.USER_SETTINGS]=new UserSettingsPage(this),this._pageCalls.push(ks.NAVIGATION),"XR"==ze.deviceType&&(this._pages[ks.HANDS]=new HandsPage(this))}_createInteractables(){super._createInteractables(),Oi.addButtons(this._object,this._pointerInteractable)}}const Ar=[{title:"Settings",menuPage:ks.SETTINGS},{title:"Connect with Peers",menuPage:ks.PARTY},{title:"Acknowledgements",menuPage:ks.ACKNOWLEDGEMENTS}];class HomePage extends MenuPage{constructor(t){super(t,!1),this._addPageContent()}_addPageContent(){let t=ThreeMeshUIHelper.createTextBlock({text:"Home",fontSize:Mt.header,height:.04,width:.2});this._container.add(t);let i=new je.Block({height:.2,width:.45,contentDirection:"column",justifyContent:"start",backgroundOpacity:0}),r=ze.authUrl&&ze.socketUrl,d=this._getAuthoredAssets();for(let t of Ar){if(t.menuPage==ks.PARTY&&!r)continue;if(t.menuPage==ks.ACKNOWLEDGEMENTS&&0==d.length)continue;let A=ThreeMeshUIHelper.createButtonBlock({text:t.title,fontSize:Mt.body,height:.035,width:.3,margin:.002});i.add(A);let g=new PointerInteractable(A,(()=>{if(t.menuPage==ks.ACKNOWLEDGEMENTS){this._controller.getPage(ks.ACKNOWLEDGEMENTS).setAssets(d)}this._controller.pushPage(t.menuPage)}));this._containerInteractable.addChild(g)}this._container.add(i)}_getAuthoredAssets(){let t=[];for(let i in ui.library){let r=ui.library[i];r.Type==Ve.MODEL&&r.Author&&t.push(r)}return t}}class LiveMenuController extends MenuController{constructor(){super(),this._pages[ks.ACKNOWLEDGEMENTS]=new AcknowledgementsPage(this),this._pages[ks.HOME]=new HomePage(this),this._pages[ks.HOST_PARTY]=new HostPartyPage(this),this._pages[ks.JOIN_PARTY]=new JoinPartyPage(this),this._pages[ks.PARTY]=new PartyPage(this),this._pages[ks.PEER]=new PeerPage(this),this._pages[ks.SETTINGS]=new SettingsPage(this),this._pages[ks.USER_SETTINGS]=new UserSettingsPage(this),this._pageCalls.push(ks.HOME)}}var Stats=function(){var t=0,i=document.createElement("div");function addPanel(t){return i.appendChild(t.dom),t}function showPanel(r){for(var d=0;d<i.children.length;d++)i.children[d].style.display=d===r?"block":"none";t=r}i.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",i.addEventListener("click",(function(r){r.preventDefault(),showPanel(++t%i.children.length)}),!1);var r=(performance||Date).now(),d=r,A=0,g=addPanel(new Stats.Panel("FPS","#0ff","#002")),b=addPanel(new Stats.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var I=addPanel(new Stats.Panel("MB","#f08","#201"));return showPanel(0),{REVISION:16,dom:i,addPanel:addPanel,showPanel:showPanel,begin:function(){r=(performance||Date).now()},end:function(){A++;var t=(performance||Date).now();if(b.update(t-r,200),t>=d+1e3&&(g.update(1e3*A/(t-d),100),d=t,A=0,I)){var i=performance.memory;I.update(i.usedJSHeapSize/1048576,i.jsHeapSizeLimit/1048576)}return t},update:function(){r=this.end()},domElement:i,setMode:showPanel}};Stats.Panel=function(t,i,r){var d=1/0,A=0,g=Math.round,b=g(window.devicePixelRatio||1),I=80*b,w=48*b,C=3*b,B=2*b,S=3*b,T=15*b,x=74*b,M=30*b,P=document.createElement("canvas");P.width=I,P.height=w,P.style.cssText="width:80px;height:48px";var D=P.getContext("2d");return D.font="bold "+9*b+"px Helvetica,Arial,sans-serif",D.textBaseline="top",D.fillStyle=r,D.fillRect(0,0,I,w),D.fillStyle=i,D.fillText(t,C,B),D.fillRect(S,T,x,M),D.fillStyle=r,D.globalAlpha=.9,D.fillRect(S,T,x,M),{dom:P,update:function(w,Q){d=Math.min(d,w),A=Math.max(A,w),D.fillStyle=r,D.globalAlpha=1,D.fillRect(0,0,I,T),D.fillStyle=i,D.fillText(g(w)+" "+t+" ("+g(d)+"-"+g(A)+")",C,B),D.drawImage(P,S+b,T,x-b,M,S,T,x-b,M),D.fillRect(S+x-b,T,b,M),D.fillStyle=r,D.globalAlpha=.9,D.fillRect(S+x-b,T,b,g((1-w/Q)*M))}}};class Main{constructor(i,r,d){this._renderer,this._scene,this._camera,this._clock=new t.Clock,this._container=document.getElementById(r),this._loadingMessage=document.querySelector("#digital-bacon-loading"),this._errorMessage=document.querySelector("#digital-bacon-error"),this._dynamicAssets=[],this._callback=i,this._createRenderer(),this._createScene(),this._createCamera(),this._createUser(),this._createHandlers(),this._createClients(),this._createAssets(d),this._addEventListeners(),this._onResize(),this._enableStats(),this._renderer.setAnimationLoop((()=>{this._loading()}))}_createRenderer(){this._renderer=new t.WebGLRenderer({antialias:!0}),this._container.appendChild(this._renderer.domElement),"XR"==ze.deviceType&&(this._renderer.xr.enabled=!0),ze.renderer=this._renderer}_createScene(){this._scene=new t.Scene,ze.scene=this._scene}_createCamera(){this._camera=new t.PerspectiveCamera(45,this._container.clientWidth/this._container.clientHeight,.1,1e3),ze.camera=this._camera,this._scene.add(this._camera)}_createUser(){ze.disableImmersion||(this._userObj=new t.Object3D,this._cameraFocus=new t.Object3D,"XR"!=ze.deviceType&&(this._camera.position.setY(.5),this._camera.position.setZ(1.9)),this._cameraFocus.add(this._camera),this._userObj.add(this._cameraFocus),this._scene.add(this._userObj),ze.cameraFocus=this._cameraFocus)}_createHandlers(){yn.init(this._scene),ze.disableImmersion||(ki.init(this._container),fi.init(this._container,this._renderer,this._userObj),ds.init(),Oi.init(),"XR"==ze.deviceType&&gs.init(),hs.init(this._renderer.domElement,this._camera,this._scene))}_createClients(){ze.disableImmersion||(ze.isEditor&&Ln.init(),sr.init(this._container))}_createAssets(t){if(t){let i=uuidv4();ze.loadingLocks.add(i),yn.load(t,(()=>{ze.disableImmersion||this._setupForImmersion(),ze.loadingLocks.delete(i)}),(t=>{if($(this._loadingMessage).removeClass("loading"),$(this._errorMessage).addClass("error"),t)throw t}))}else{let t=new PrimitiveAmbientLight({visualEdit:!1});yn.addLight(t,t.getAssetId(),!0),ze.disableImmersion||this._setupForImmersion()}}_setupForImmersion(){this._menuController=ze.isEditor?new EditorMenuController:new LiveMenuController,this._menuController.addToScene(this._scene),ze.menuController=this._menuController,ps.init({"User Object":this._userObj,"Flight Enabled":!0}),ps.addToScene(this._userObj)}_addEventListeners(){window.addEventListener("resize",(()=>{this._onResize()})),ze.disableImmersion||this._container.addEventListener("wheel",(function(t){t.preventDefault()}),{passive:!1,capture:!0})}_onResize(){this._renderer.setSize(this._container.clientWidth,this._container.clientHeight),this._camera.aspect=this._container.clientWidth/this._container.clientHeight,this._camera.updateProjectionMatrix()}_enableStats(){this._stats=new Stats,this._stats.showPanel(0),this._stats.dom.style.top="",this._stats.dom.style.left="",ze.isEditor&&this._container.insertBefore(this._stats.dom,this._container.firstChild)}_loading(){if(0==ze.loadingLocks.size){if(setTimeout((()=>{$(this._loadingMessage.children[0]).html("&nbsp;"),$(this._loadingMessage).addClass("ending"),setTimeout((()=>{$(this._loadingMessage).removeClass("loading"),ze.disableImmersion||ki.displayButton()}),1e3)}),50),ze.disableImmersion)return this._renderer.setAnimationLoop((()=>{this._update()})),void(this._callback&&this._callback(this));"XR"==ze.deviceType?(this._dynamicAssets.push(gs),this._renderer.setAnimationLoop(((t,i)=>{fi.update(i),this._update()}))):("POINTER"==ze.deviceType||"MOBILE"==ze.deviceType)&&this._renderer.setAnimationLoop((()=>{this._update()})),this._dynamicAssets.push(this._menuController),this._dynamicAssets.push(ps),this._dynamicAssets.push(ds),this._dynamicAssets.push(wt),this._dynamicAssets.push(je),this._dynamicAssets.push(xs),ze.isEditor&&(this._dynamicAssets.push(fs),this._dynamicAssets.push(ms),this._dynamicAssets.push(_s)),this._callback&&this._callback(this)}else $(this._loadingMessage.children[0]).html("Loading "+ze.loadingLocks.size+" more asset(s)")}_update(){this._stats.begin();let t=this._clock.getDelta();for(let i of this._dynamicAssets)i.update(t);this._renderer.render(this._scene,this._camera),this._stats.end()}getCamera(){return this._camera}getRenderer(){return this._renderer}getScene(){return this._scene}}class PrimitiveMeshHelper extends AssetHelper{constructor(t){super(t)}_getMenuFieldsMap(){let t=super._getMenuFieldsMap();return t.material=this._createMaterialInput({parameter:"material",name:"Material"}),t}_addSubscriptions(){wt.subscribe(this._id,nt,(t=>{if(this._asset.getMaterial()==t.material.getId()&&(this._updateParameter("material",null,!0),this.updateMenuField("material"),t.undoRedoAction)){let i=t.undoRedoAction.undo;t.undoRedoAction.undo=()=>{i(),this._updateParameter("material",t.material.getId(),!0),this.updateMenuField("material")}}}))}_removeSubscriptions(){wt.unsubscribe(this._id,nt)}addToScene(t){super.addToScene(t),this._addSubscriptions()}removeFromScene(){super.removeFromScene(),this._removeSubscriptions()}}class PrimitiveMesh extends Asset{constructor(t={}){super(t),this._material=t.material}_createEditorHelper(){this._editorHelper=new PrimitiveMeshHelper(this)}_updateGeometry(){console.error("PrimitiveMesh._updateGeometry() should be overridden")}_getMaterial(){return this._material?ys.getMaterial(this._material).getMaterial():Et.defaultMeshMaterial}clone(t){let i=this._fetchCloneParams(t);return yn.addShape(i,this._assetId)}exportParams(){let t=super.exportParams();return t.material=this._material,t}getMaterial(){return this._material}setMaterial(t){if(t==this._material)return;let i=this._mesh.material.userData.oldMaterial;i&&this.returnTransparency(),this._material=t;let r=this._mesh.material,d=this._getMaterial();this._mesh.material=d,r.dispose(),i&&this.makeTranslucent()}}const ur=[{parameter:"visualEdit"},{parameter:"material"},{parameter:"width",name:"Width",min:0,type:NumberInput},{parameter:"height",name:"Height",min:0,type:NumberInput},{parameter:"depth",name:"Depth",min:0,type:NumberInput},{parameter:"widthSegments",name:"Width Segments",min:1,type:NumberInput},{parameter:"heightSegments",name:"Height Segments",min:1,type:NumberInput},{parameter:"depthSegments",name:"Depth Segments",min:1,type:NumberInput},{parameter:"position"},{parameter:"rotation"},{parameter:"scale"}];class PrimitiveBoxHelper extends PrimitiveMeshHelper{constructor(t){super(t)}getMenuFields(){return super.getMenuFields(ur)}_getMenuFieldsMap(){let t=super._getMenuFieldsMap();for(let i of ur)if(!(i.parameter in t)){let r=this._createStandardInput(i);r&&(t[i.parameter]=r)}return t}}const pr="a6ffffc9-2cd0-4fb7-a7b1-7f334930af51";yn.registerShape(class extends PrimitiveMesh{constructor(t={}){super(t),this._assetId=pr,this._width=numberOr(t.width,.1),this._height=numberOr(t.height,.1),this._depth=numberOr(t.depth,.1),this._widthSegments=t.widthSegments||1,this._heightSegments=t.heightSegments||1,this._depthSegments=t.depthSegments||1,this._createMesh(),t.isPreview&&this.makeTranslucent()}_createEditorHelper(){this._editorHelper=new PrimitiveBoxHelper(this)}_createMesh(){let i=new t.BoxGeometry(this._width,this._height,this._depth,this._widthSegments,this._heightSegments,this._depthSegments);this._mesh=new t.Mesh(i,this._getMaterial()),this._object.add(this._mesh)}_updateGeometry(){let i=this._mesh.geometry,r=new t.BoxGeometry(this._width,this._height,this._depth,this._widthSegments,this._heightSegments,this._depthSegments);this._mesh.geometry=r,i.dispose()}exportParams(){let t=super.exportParams();return t.width=this._width,t.height=this._height,t.depth=this._depth,t.widthSegments=this._widthSegments,t.heightSegments=this._heightSegments,t.depthSegments=this._depthSegments,t}getDepth(){return this._depth}getHeight(){return this._height}getWidth(){return this._width}getDepthSegments(){return this._depthSegments}getHeightSegments(){return this._heightSegments}getWidthSegments(){return this._widthSegments}setDepth(t){this._depth!=t&&(this._depth=t,this._updateGeometry())}setHeight(t){this._height!=t&&(this._height=t,this._updateGeometry())}setWidth(t){this._width!=t&&(this._width=t,this._updateGeometry())}setDepthSegments(t){this._depthSegments!=t&&(this._depthSegments=t,this._updateGeometry())}setHeightSegments(t){this._heightSegments!=t&&(this._heightSegments=t,this._updateGeometry())}setWidthSegments(t){this._widthSegments!=t&&(this._widthSegments=t,this._updateGeometry())}},pr,"Box");const gr=[{parameter:"visualEdit"},{parameter:"material"},{parameter:"radius",name:"Radius",min:0,type:NumberInput},{parameter:"segments",name:"Sides",min:3,type:NumberInput},{parameter:"thetaLength",name:"Degrees",min:0,max:360,type:NumberInput},{parameter:"position"},{parameter:"rotation"},{parameter:"scale"}];class PrimitiveCircleHelper extends PrimitiveMeshHelper{constructor(t){super(t)}place(t){let i=t.object,r=t.point;t.face,i.updateMatrixWorld();let d=t.face.normal.clone().transformDirection(i.matrixWorld).clampLength(0,.001);ze.camera.getWorldDirection(vector3s[0]).dot(d)>0&&d.negate(),this._object.position.copy(d).add(r),this._object.lookAt(d.add(this._object.position)),this.roundAttributes(!0)}getMenuFields(){return super.getMenuFields(gr)}_getMenuFieldsMap(){let t=super._getMenuFieldsMap();for(let i of gr)if(!(i.parameter in t)){let r=this._createStandardInput(i);r&&(t[i.parameter]=r)}return t}}const mr="0a0c7c21-d834-4a88-9234-0d9b5cf705f6";yn.registerShape(class extends PrimitiveMesh{constructor(t={}){super(t),this._assetId=mr,this._radius=numberOr(t.radius,.1),this._segments=t.segments||32,this._thetaLength=numberOr(t.thetaLength,360),this._createMesh(),t.isPreview&&this.makeTranslucent()}_createEditorHelper(){this._editorHelper=new PrimitiveCircleHelper(this)}_createMesh(){let i=this._thetaLength*Math.PI/180,r=new t.CircleGeometry(this._radius,this._segments,0,i);this._mesh=new t.Mesh(r,this._getMaterial()),this._object.add(this._mesh)}_updateGeometry(){let i=this._thetaLength*Math.PI/180,r=this._mesh.geometry,d=new t.CircleGeometry(this._radius,this._segments,0,i);this._mesh.geometry=d,r.dispose()}exportParams(){let t=super.exportParams();return t.radius=this._radius,t.segments=this._segments,t.thetaLength=this._thetaLength,t}getRadius(){return this._radius}getSegments(){return this._segments}getThetaLength(){return this._thetaLength}setRadius(t){this._radius!=t&&(this._radius=t,this._updateGeometry())}setSegments(t){this._segments!=t&&(this._segments=t,this._updateGeometry())}setThetaLength(t){this._thetaLength!=t&&(this._thetaLength=t,this._updateGeometry())}},mr,"Circle");const _r=[{parameter:"visualEdit"},{parameter:"material"},{parameter:"height",name:"Height",min:0,type:NumberInput},{parameter:"radius",name:"Radius",min:0,type:NumberInput},{parameter:"radialSegments",name:"Sides",min:3,type:NumberInput},{parameter:"heightSegments",name:"Height Segments",min:1,type:NumberInput},{parameter:"thetaLength",name:"Degrees",min:0,max:360,type:NumberInput},{parameter:"openEnded",name:"Open Ended",type:CheckboxInput},{parameter:"position"},{parameter:"rotation"},{parameter:"scale"}];class PrimitiveConeHelper extends PrimitiveMeshHelper{constructor(t){super(t)}getMenuFields(){return super.getMenuFields(_r)}_getMenuFieldsMap(){let t=super._getMenuFieldsMap();for(let i of _r)if(!(i.parameter in t)){let r=this._createStandardInput(i);r&&(t[i.parameter]=r)}return t}}const fr="42779f01-e2cc-495a-a4b3-b286197fa762";yn.registerShape(class extends PrimitiveMesh{constructor(t={}){super(t),this._assetId=fr,this._height=numberOr(t.height,.2),this._radius=numberOr(t.radius,.1),this._radialSegments=t.radialSegments||32,this._heightSegments=t.heightSegments||1,this._thetaLength=numberOr(t.thetaLength,360),this._openEnded=t.openEnded||!1,this._createMesh(),t.isPreview&&this.makeTranslucent()}_createEditorHelper(){this._editorHelper=new PrimitiveConeHelper(this)}_createMesh(){let i=this._thetaLength*Math.PI/180,r=new t.ConeGeometry(this._radius,this._height,this._radialSegments,this._heightSegments,this._openEnded,0,i);this._mesh=new t.Mesh(r,this._getMaterial()),this._object.add(this._mesh)}_updateGeometry(){let i=this._thetaLength*Math.PI/180,r=this._mesh.geometry,d=new t.ConeGeometry(this._radius,this._height,this._radialSegments,this._heightSegments,this._openEnded,0,i);this._mesh.geometry=d,r.dispose()}exportParams(){let t=super.exportParams();return t.height=this._height,t.radius=this._radius,t.radialSegments=this._radialSegments,t.heightSegments=this._heightSegments,t.thetaLength=this._thetaLength,t.openEnded=this._openEnded,t}getHeight(){return this._height}getRadius(){return this._radius}getRadialSegments(){return this._radialSegments}getHeightSegments(){return this._heightSegments}getThetaLength(){return this._thetaLength}getOpenEnded(){return this._openEnded}setHeight(t){this._height!=t&&(this._height=t,this._updateGeometry())}setRadius(t){this._radius!=t&&(this._radius=t,this._updateGeometry())}setRadialSegments(t){this._radialSegments!=t&&(this._radialSegments=t,this._updateGeometry())}setHeightSegments(t){this._heightSegments!=t&&(this._heightSegments=t,this._updateGeometry())}setThetaLength(t){this._thetaLength!=t&&(this._thetaLength=t,this._updateGeometry())}setOpenEnded(t){this._openEnded!=t&&(this._openEnded=t,this._updateGeometry())}},fr,"Cone");const br=[{parameter:"visualEdit"},{parameter:"material"},{parameter:"height",name:"Height",min:0,type:NumberInput},{parameter:"radiusTop",name:"Top Radius",min:0,type:NumberInput},{parameter:"radiusBottom",name:"Bottom Radius",min:0,type:NumberInput},{parameter:"radialSegments",name:"Sides",min:3,type:NumberInput},{parameter:"heightSegments",name:"Height Segments",min:1,type:NumberInput},{parameter:"thetaLength",name:"Degrees",min:0,max:360,type:NumberInput},{parameter:"openEnded",name:"Open Ended",type:CheckboxInput},{parameter:"position"},{parameter:"rotation"},{parameter:"scale"}];class PrimitiveCylinderHelper extends PrimitiveMeshHelper{constructor(t){super(t)}getMenuFields(){return super.getMenuFields(br)}_getMenuFieldsMap(){let t=super._getMenuFieldsMap();for(let i of br)if(!(i.parameter in t)){let r=this._createStandardInput(i);r&&(t[i.parameter]=r)}return t}}const Ir="f4efc996-0d50-48fe-9313-3c7b1a5c1754";yn.registerShape(class extends PrimitiveMesh{constructor(t={}){super(t),this._assetId=Ir,this._height=numberOr(t.height,.2),this._radiusTop=numberOr(t.radiusTop,.1),this._radiusBottom=numberOr(t.radiusBottom,.1),this._radialSegments=t.radialSegments||32,this._heightSegments=t.heightSegments||1,this._thetaLength=numberOr(t.thetaLength,360),this._openEnded=t.openEnded||!1,this._createMesh(),t.isPreview&&this.makeTranslucent()}_createEditorHelper(){this._editorHelper=new PrimitiveCylinderHelper(this)}_createMesh(){let i=this._thetaLength*Math.PI/180,r=new t.CylinderGeometry(this._radiusTop,this._radiusBottom,this._height,this._radialSegments,this._heightSegments,this._openEnded,0,i);this._mesh=new t.Mesh(r,this._getMaterial()),this._object.add(this._mesh)}_updateGeometry(){let i=this._thetaLength*Math.PI/180,r=this._mesh.geometry,d=new t.CylinderGeometry(this._radiusTop,this._radiusBottom,this._height,this._radialSegments,this._heightSegments,this._openEnded,0,i);this._mesh.geometry=d,r.dispose()}exportParams(){let t=super.exportParams();return t.height=this._height,t.radiusTop=this._radiusTop,t.radiusBottom=this._radiusBottom,t.radialSegments=this._radialSegments,t.heightSegments=this._heightSegments,t.thetaLength=this._thetaLength,t.openEnded=this._openEnded,t}getHeight(){return this._height}getRadiusTop(){return this._radiusTop}getRadiusBottom(){return this._radiusBottom}getRadialSegments(){return this._radialSegments}getHeightSegments(){return this._heightSegments}getThetaLength(){return this._thetaLength}getOpenEnded(){return this._openEnded}setHeight(t){this._height!=t&&(this._height=t,this._updateGeometry())}setRadiusTop(t){this._radiusTop!=t&&(this._radiusTop=t,this._updateGeometry())}setRadiusBottom(t){this._radiusBottom!=t&&(this._radiusBottom=t,this._updateGeometry())}setRadialSegments(t){this._radialSegments!=t&&(this._radialSegments=t,this._updateGeometry())}setHeightSegments(t){this._heightSegments!=t&&(this._heightSegments=t,this._updateGeometry())}setThetaLength(t){this._thetaLength!=t&&(this._thetaLength=t,this._updateGeometry())}setOpenEnded(t){this._openEnded!=t&&(this._openEnded=t,this._updateGeometry())}},Ir,"Cylinder");const wr=[{parameter:"visualEdit"},{parameter:"material"},{parameter:"width",name:"Width",min:0,type:NumberInput},{parameter:"height",name:"Height",min:0,type:NumberInput},{parameter:"widthSegments",name:"Width Segments",min:1,type:NumberInput},{parameter:"heightSegments",name:"Height Segments",min:1,type:NumberInput},{parameter:"position"},{parameter:"rotation"},{parameter:"scale"}];class PrimitivePlaneHelper extends PrimitiveMeshHelper{constructor(t){super(t)}place(t){let i=t.object,r=t.point;t.face,i.updateMatrixWorld();let d=t.face.normal.clone().transformDirection(i.matrixWorld).clampLength(0,.001);ze.camera.getWorldDirection(vector3s[0]).dot(d)>0&&d.negate(),this._object.position.copy(d).add(r),this._object.lookAt(d.add(this._object.position)),this.roundAttributes(!0)}getMenuFields(){return super.getMenuFields(wr)}_getMenuFieldsMap(){let t=super._getMenuFieldsMap();for(let i of wr)if(!(i.parameter in t)){let r=this._createStandardInput(i);r&&(t[i.parameter]=r)}return t}}const yr="936bd538-9cb8-44f5-b21f-6b4a7eccfff4";yn.registerShape(class extends PrimitiveMesh{constructor(t={}){super(t),this._assetId=yr,this._width=numberOr(t.width,.1),this._height=numberOr(t.height,.1),this._widthSegments=t.widthSegments||1,this._heightSegments=t.heightSegments||1,this._createMesh(),t.isPreview&&this.makeTranslucent()}_createEditorHelper(){this._editorHelper=new PrimitivePlaneHelper(this)}_createMesh(){let i=new t.PlaneGeometry(this._width,this._height,this._widthSegments,this._heightSegments);this._mesh=new t.Mesh(i,this._getMaterial()),this._object.add(this._mesh)}_updateGeometry(){let i=this._mesh.geometry,r=new t.PlaneGeometry(this._width,this._height,this._widthSegments,this._heightSegments);this._mesh.geometry=r,i.dispose()}exportParams(){let t=super.exportParams();return t.width=this._width,t.height=this._height,t.widthSegments=this._widthSegments,t.heightSegments=this._heightSegments,t}getHeight(){return this._height}getWidth(){return this._width}getHeightSegments(){return this._heightSegments}getWidthSegments(){return this._widthSegments}setHeight(t){this._height!=t&&(this._height=t,this._updateGeometry())}setWidth(t){this._width!=t&&(this._width=t,this._updateGeometry())}setHeightSegments(t){this._heightSegments!=t&&(this._heightSegments=t,this._updateGeometry())}setWidthSegments(t){this._widthSegments!=t&&(this._widthSegments=t,this._updateGeometry())}},yr,"Plane");const Cr=[{parameter:"visualEdit"},{parameter:"color"},{parameter:"intensity"},{parameter:"distance",name:"Distance",min:0,type:NumberInput},{parameter:"decay",name:"Decay",min:0,type:NumberInput},{parameter:"position"},{parameter:"rotation"},{parameter:"scale"}];class PrimitivePointLightHelper extends PrimitiveLightHelper{constructor(t){super(t)}_createMesh(){let i=new t.SphereGeometry(.07),r=new t.MeshBasicMaterial({color:St.yellow});this._mesh=new t.Mesh(i,r),this._asset.visualEdit&&this._object.add(this._mesh)}getMenuFields(){return super.getMenuFields(Cr)}_getMenuFieldsMap(){let t=super._getMenuFieldsMap();for(let i of Cr)if(!(i.parameter in t)){let r=this._createStandardInput(i);r&&(t[i.parameter]=r)}return t}}const Br="944a6b29-05d2-47d9-9b33-60e7a3e18b7d";yn.registerLight(class extends PrimitiveLight{constructor(t={}){super(t),this._assetId=Br,this._distance=numberOr(t.distance,0),this._decay=numberOr(t.decay,2),this._createLight(),t.isPreview&&this.makeTranslucent()}_createEditorHelper(){this._editorHelper=new PrimitivePointLightHelper(this)}_createLight(){this._light=new t.PointLight(this._color,this._intensity,this._distance,this._decay),this._object.add(this._light)}_updateLight(){super._updateLight(),this._light.distance=this._distance,this._light.decay=this._decay}exportParams(){let t=super.exportParams();return t.distance=this._distance,t.decay=this._decay,t}getDistance(){return this._distance}getDecay(){return this._decay}setDistance(t){this._distance!=t&&(this._distance=t,this._light.distance=t)}setDecay(t){this._decay!=t&&(this._decay=t,this._light.decay=t)}},Br,"Basic Light");const vr=[{parameter:"visualEdit"},{parameter:"material"},{parameter:"innerRadius",name:"Inner Radius",min:0,type:NumberInput},{parameter:"outerRadius",name:"Outer Radius",min:0,type:NumberInput},{parameter:"thetaSegments",name:"Sides",min:3,type:NumberInput},{parameter:"phiSegments",name:"Radius Segments",min:1,type:NumberInput},{parameter:"thetaLength",name:"Degrees",min:0,max:360,type:NumberInput},{parameter:"position"},{parameter:"rotation"},{parameter:"scale"}];class PrimitiveRingHelper extends PrimitiveMeshHelper{constructor(t){super(t)}place(t){let i=t.object,r=t.point;t.face,i.updateMatrixWorld();let d=t.face.normal.clone().transformDirection(i.matrixWorld).clampLength(0,.001);ze.camera.getWorldDirection(vector3s[0]).dot(d)>0&&d.negate(),this._object.position.copy(d).add(r),this._object.lookAt(d.add(this._object.position)),this.roundAttributes(!0)}getMenuFields(){return super.getMenuFields(vr)}_getMenuFieldsMap(){let t=super._getMenuFieldsMap();for(let i of vr)if(!(i.parameter in t)){let r=this._createStandardInput(i);r&&(t[i.parameter]=r)}return t}}const Er="534f29c3-1e85-4510-bb84-459011de6722";yn.registerShape(class extends PrimitiveMesh{constructor(t={}){super(t),this._assetId=Er,this._innerRadius=numberOr(t.innerRadius,.05),this._outerRadius=numberOr(t.outerRadius,.1),this._thetaSegments=t.thetaSegments||32,this._phiSegments=t.phiSegments||1,this._thetaLength=numberOr(t.thetaLength,360),this._createMesh(),t.isPreview&&this.makeTranslucent()}_createEditorHelper(){this._editorHelper=new PrimitiveRingHelper(this)}_createMesh(){let i=this._thetaLength*Math.PI/180,r=new t.RingGeometry(this._innerRadius,this._outerRadius,this._thetaSegments,this._phiSegments,0,i);this._mesh=new t.Mesh(r,this._getMaterial()),this._object.add(this._mesh)}_updateGeometry(){let i=this._thetaLength*Math.PI/180,r=this._mesh.geometry,d=new t.RingGeometry(this._innerRadius,this._outerRadius,this._thetaSegments,this._phiSegments,0,i);this._mesh.geometry=d,r.dispose()}exportParams(){let t=super.exportParams();return t.innerRadius=this._innerRadius,t.outerRadius=this._outerRadius,t.thetaSegments=this._thetaSegments,t.phiSegments=this._phiSegments,t.thetaLength=this._thetaLength,t}getInnerRadius(){return this._innerRadius}getOuterRadius(){return this._outerRadius}getThetaSegments(){return this._thetaSegments}getPhiSegments(){return this._phiSegments}getThetaLength(){return this._thetaLength}setInnerRadius(t){this._innerRadius!=t&&(this._innerRadius=t,this._updateGeometry())}setOuterRadius(t){this._outerRadius!=t&&(this._outerRadius=t,this._updateGeometry())}setThetaSegments(t){this._thetaSegments!=t&&(this._thetaSegments=t,this._updateGeometry())}setPhiSegments(t){this._phiSegments!=t&&(this._phiSegments=t,this._updateGeometry())}setThetaLength(t){this._thetaLength!=t&&(this._thetaLength=t,this._updateGeometry())}},Er,"Ring");const Sr=[{parameter:"visualEdit"},{parameter:"material"},{parameter:"radius",name:"Radius",min:0,type:NumberInput},{parameter:"widthSegments",name:"Horizontal Sides",min:3,type:NumberInput},{parameter:"heightSegments",name:"Vertical Sides",min:2,type:NumberInput},{parameter:"phiLength",name:"Horizontal Degrees",min:0,max:360,type:NumberInput},{parameter:"thetaLength",name:"Vertical Degrees",min:0,max:180,type:NumberInput},{parameter:"position"},{parameter:"rotation"},{parameter:"scale"}];class PrimitiveSphereHelper extends PrimitiveMeshHelper{constructor(t){super(t)}getMenuFields(){return super.getMenuFields(Sr)}_getMenuFieldsMap(){let t=super._getMenuFieldsMap();for(let i of Sr)if(!(i.parameter in t)){let r=this._createStandardInput(i);r&&(t[i.parameter]=r)}return t}}const Tr="423c9506-52f4-4725-b848-69913cce2b00";yn.registerShape(class extends PrimitiveMesh{constructor(t={}){super(t),this._assetId=Tr,this._radius=numberOr(t.radius,.1),this._widthSegments=t.widthSegments||32,this._heightSegments=t.heightSegments||16,this._phiLength=numberOr(t.phiLength,360),this._thetaLength=numberOr(t.thetaLength,180),this._createMesh(),t.isPreview&&this.makeTranslucent()}_createEditorHelper(){this._editorHelper=new PrimitiveSphereHelper(this)}_createMesh(){let i=this._phiLength*Math.PI/180,r=this._thetaLength*Math.PI/180,d=new t.SphereGeometry(this._radius,this._widthSegments,this._heightSegments,0,i,0,r);this._mesh=new t.Mesh(d,this._getMaterial()),this._object.add(this._mesh)}_updateGeometry(){let i=this._phiLength*Math.PI/180,r=this._thetaLength*Math.PI/180,d=this._mesh.geometry,A=new t.SphereGeometry(this._radius,this._widthSegments,this._heightSegments,0,i,0,r);this._mesh.geometry=A,d.dispose()}exportParams(){let t=super.exportParams();return t.radius=this._radius,t.widthSegments=this._widthSegments,t.heightSegments=this._heightSegments,t.phiLength=this._phiLength,t.thetaLength=this._thetaLength,t}getRadius(){return this._radius}getWidthSegments(){return this._widthSegments}getHeightSegments(){return this._heightSegments}getPhiLength(){return this._phiLength}getThetaLength(){return this._thetaLength}setRadius(t){this._radius!=t&&(this._radius=t,this._updateGeometry())}setWidthSegments(t){this._widthSegments!=t&&(this._widthSegments=t,this._updateGeometry())}setHeightSegments(t){this._heightSegments!=t&&(this._heightSegments=t,this._updateGeometry())}setPhiLength(t){this._phiLength!=t&&(this._phiLength=t,this._updateGeometry())}setThetaLength(t){this._thetaLength!=t&&(this._thetaLength=t,this._updateGeometry())}},Tr,"Sphere");const xr=[{parameter:"visualEdit"},{parameter:"material"},{parameter:"radius",name:"Radius",min:0,type:NumberInput},{parameter:"tube",name:"Tube Radius",min:0,type:NumberInput},{parameter:"radialSegments",name:"Radial Sides",min:2,type:NumberInput},{parameter:"tubularSegments",name:"Tubular Sides",min:3,type:NumberInput},{parameter:"arc",name:"Degrees",min:0,max:360,type:NumberInput},{parameter:"position"},{parameter:"rotation"},{parameter:"scale"}];class PrimitiveTorusHelper extends PrimitiveMeshHelper{constructor(t){super(t)}getMenuFields(){return super.getMenuFields(xr)}_getMenuFieldsMap(){let t=super._getMenuFieldsMap();for(let i of xr)if(!(i.parameter in t)){let r=this._createStandardInput(i);r&&(t[i.parameter]=r)}return t}}const Mr="6b8bcbf1-49b0-42ce-9d60-9a7db6e425bf";yn.registerShape(class extends PrimitiveMesh{constructor(t={}){super(t),this._assetId=Mr,this._radius=numberOr(t.radius,.1),this._tube=numberOr(t.tube,.05),this._radialSegments=t.radialSegments||16,this._tubularSegments=t.tubularSegments||32,this._arc=numberOr(t.arc,360),this._createMesh(),t.isPreview&&this.makeTranslucent()}_createEditorHelper(){this._editorHelper=new PrimitiveTorusHelper(this)}_createMesh(){let i=this._arc*Math.PI/180,r=new t.TorusGeometry(this._radius,this._tube,this._radialSegments,this._tubularSegments,i);this._mesh=new t.Mesh(r,this._getMaterial()),this._object.add(this._mesh)}_updateGeometry(){let i=this._arc*Math.PI/180,r=this._mesh.geometry,d=new t.TorusGeometry(this._radius,this._tube,this._radialSegments,this._tubularSegments,i);this._mesh.geometry=d,r.dispose()}exportParams(){let t=super.exportParams();return t.radius=this._radius,t.tube=this._tube,t.radialSegments=this._radialSegments,t.tubularSegments=this._tubularSegments,t.arc=this._arc,t}getRadius(){return this._radius}getTube(){return this._tube}getRadialSegments(){return this._radialSegments}getTubularSegments(){return this._tubularSegments}getArc(){return this._arc}setRadius(t){this._radius!=t&&(this._radius=t,this._updateGeometry())}setTube(t){this._tube!=t&&(this._tube=t,this._updateGeometry())}setRadialSegments(t){this._radialSegments!=t&&(this._radialSegments=t,this._updateGeometry())}setTubularSegments(t){this._tubularSegments!=t&&(this._tubularSegments=t,this._updateGeometry())}setArc(t){this._arc!=t&&(this._arc=t,this._updateGeometry())}},Mr,"Torus");const Pr=[{parameter:"transparent",name:"Transparent",type:CheckboxInput},{parameter:"opacity",name:"Opacity",min:0,max:1,type:NumberInput},{parameter:"side",name:"Display",type:EnumInput,options:["Front Side","Back Side","Both Sides"],map:Gt,reverseMap:Wt}];class MaterialHelper extends EditorHelper{constructor(t){super(t,rt)}_getMenuFieldsMap(){let t=super._getMenuFieldsMap();for(let i of Pr)if(!(i.parameter in t)){let r=this._createStandardInput(i);r&&(t[i.parameter]=r)}return t}_addSubscriptions(){let t=this._asset.getMaps();wt.subscribe(this._id,ft,(i=>{let r=[];for(let d of t){let t=capitalizeFirstLetter(d);this._asset["get"+t]()==i.texture.getId()&&(this._updateParameter(d,null,!0),this.updateMenuField(d),r.push(d))}if(i.undoRedoAction&&r.length>0){let t=i.undoRedoAction.undo;i.undoRedoAction.undo=()=>{t();for(let t of r)this._updateParameter(t,i.texture.getId(),!0),this.updateMenuField(t)}}})),wt.subscribe(this._id,bt,(i=>{let r=i.asset.getId();for(let i of t){let t=capitalizeFirstLetter(i);this._asset["get"+t]()==r&&(this._asset._setTexture(i,r),this.updateMenuField(i))}}))}_removeSubscriptions(){wt.unsubscribe(this._id,ft),wt.unsubscribe(this._id,bt)}dispose(){this._removeSubscriptions()}undoDispose(){this._addSubscriptions()}}class Material{constructor(i={}){this._id=i.id||uuidv4(),this._name="name"in i?i.name:this._getDefaultName(),this._opacity=numberOr(i.opacity,1),this._side=i.side||t.FrontSide,this._transparent=i.transparent||!1,ze.isEditor&&this._createEditorHelper()}_createEditorHelper(){this._editorHelper=new MaterialHelper(this)}_getDefaultName(){console.error("Material._getDefaultName() should be overridden")}_createMaterial(){console.error("Material._createMaterial() should be overridden")}_setTexture(t,i){this["_"+t]=i;let r=Cs.getTexture(i);this._material[t]=r?r.getTexture():null,this._material.needsUpdate=!0}exportParams(){return{id:this._id,name:this._name,opacity:this._material.opacity,side:this._material.side,transparent:this._material.transparent}}_updateMaterialParamsWithMaps(t,i){for(let r of i)if(this["_"+r]){let i=Cs.getTexture(this["_"+r]);i&&(t[r]=i.getTexture())}}dispose(){disposeMaterial(this._material),ze.isEditor&&this._editorHelper.dispose()}undoDispose(){ze.isEditor&&this._editorHelper.undoDispose()}getMaps(){console.error("Material.getMaps() should be overridden")}getMaterial(){return this._material}getMaterialType(){console.error("Material.getMaterialType() should be overridden")}getSampleTexture(){console.error("Material.getSampleTexture() should be overridden")}getId(){return this._id}getEditorHelper(){return this._editorHelper}getName(){return this._name}getOpacity(){return this._opacity}getSide(){return this._side}getTransparent(){return this._transparent}setName(t){null!=t&&this._name!=t&&(this._name=t)}setOpacity(t){this._opacity!=t&&(this._opacity=t,this._material.opacity=t)}setSide(t){this._side!=t&&(this._side=t,this._material.side=t,this._material.needsUpdate=!0)}setTransparent(t){this._transparent!=t&&(this._transparent=t,this._material.transparent=t,this._material.needsUpdate=!0)}}const kr=[{parameter:"color",name:"Color",type:ColorInput},{parameter:"map",name:"Texture Map",filter:qs,type:TextureInput},{parameter:"side"},{parameter:"transparent"},{parameter:"opacity"},{parameter:"alphaMap",name:"Alpha Map",filter:qs,type:TextureInput},{parameter:"wireframe",name:"Wireframe",type:CheckboxInput},{parameter:"envMap",name:"Environment Map",filter:Js,type:TextureInput},{parameter:"combine",name:"Color & Environment Blend",options:["Multiply","Mix","Add"],map:Ut,reverseMap:zt,type:EnumInput},{parameter:"reflectivity",name:"Reflectivity",min:0,max:1,type:NumberInput},{parameter:"refractionRatio",name:"Refraction Ratio",min:0,max:1,type:NumberInput}];let Dr=class extends MaterialHelper{constructor(t){super(t)}getMenuFields(){return super.getMenuFields(kr)}_getMenuFieldsMap(){let t=super._getMenuFieldsMap();for(let i of kr)if(!(i.parameter in t)){let r=this._createStandardInput(i);r&&(t[i.parameter]=r)}return t}};const Qr=["map","alphaMap","envMap"];ys.registerMaterial(class extends Material{constructor(i={}){super(i),this._alphaMap=i.alphaMap,this._color=numberOr(i.color,4036976),this._combine=i.combine||t.MultiplyOperation,this._envMap=i.envMap,this._map=i.map,this._reflectivity=numberOr(i.reflectivity,1),this._refractionRatio=numberOr(i.refractionRatio,.98),this._wireframe=i.wireframe||!1,this._createMaterial()}_createEditorHelper(){this._editorHelper=new Dr(this)}_getDefaultName(){return"Basic Material"}_createMaterial(){let i={color:this._color,combine:this._combine,reflectivity:this._reflectivity,refractionRatio:this._refractionRatio,side:this._side,transparent:this._transparent,opacity:this._opacity,wireframe:this._wireframe};this._updateMaterialParamsWithMaps(i,Qr),this._material=new t.MeshBasicMaterial(i)}getMaps(){return Qr}getMaterialType(){return Hn}getSampleTexture(){return this._material.map}exportParams(){let t=super.exportParams();return t.alphaMap=this._alphaMap,t.color=this._color,t.combine=this._combine,t.envMap=this._envMap,t.map=this._map,t.reflectivity=this._reflectivity,t.refractionRatio=this._refractionRatio,t.wireframe=this._wireframe,t}getAlphaMap(){return this._alphaMap}getColor(){return this._color}getCombine(){return this._combine}getEnvMap(){return this._envMap}getMap(){return this._map}getReflectivity(){return this._reflectivity}getRefractionRatio(){return this._refractionRatio}getWireframe(){return this._wireframe}setAlphaMap(t){this._alphaMap!=t&&this._setTexture("alphaMap",t)}setColor(t){this._color!=t&&(this._color=t,this._material.color.setHex(t))}setCombine(t){this._combine!=t&&(this._combine=t,this._material.combine=t,this._material.needsUpdate=!0)}setEnvMap(t){this._envMap!=t&&this._setTexture("envMap",t)}setMap(t){this._map!=t&&this._setTexture("map",t)}setReflectivity(t){this._reflectivity!=t&&(this._reflectivity=t,this._material.reflectivity=t)}setRefractionRatio(t){this._refractionRatio!=t&&(this._refractionRatio=t,this._material.refractionRatio=t)}setWireframe(t){this._wireframe!=t&&(this._wireframe=t,this._material.wireframe=t,this._material.needsUpdate=!0)}},Hn);const Fr=[{parameter:"color",name:"Color",type:ColorInput},{parameter:"map",name:"Texture Map",filter:qs,type:TextureInput},{parameter:"side"},{parameter:"transparent"},{parameter:"opacity"},{parameter:"alphaMap",name:"Alpha Map",filter:qs,type:TextureInput},{parameter:"wireframe",name:"Wireframe",type:CheckboxInput},{parameter:"emissive",name:"Emissive Color",type:ColorInput},{parameter:"emissiveMap",name:"Emissive Map",filter:qs,type:TextureInput},{parameter:"emissiveIntensity",name:"Emissive Intensity",min:0,type:NumberInput},{parameter:"envMap",name:"Environment Map",filter:Js,type:TextureInput},{parameter:"combine",name:"Color & Environment Blend",options:["Multiply","Mix","Add"],map:Ut,reverseMap:zt,type:EnumInput},{parameter:"reflectivity",name:"Reflectivity",min:0,max:1,type:NumberInput},{parameter:"refractionRatio",name:"Refraction Ratio",min:0,max:1,type:NumberInput}];class LambertMaterialHelper extends MaterialHelper{constructor(t){super(t)}getMenuFields(){return super.getMenuFields(Fr)}_getMenuFieldsMap(){let t=super._getMenuFieldsMap();for(let i of Fr)if(!(i.parameter in t)){let r=this._createStandardInput(i);r&&(t[i.parameter]=r)}return t}}const Rr=["map","alphaMap","emissiveMap","envMap"];ys.registerMaterial(class extends Material{constructor(i={}){super(i),this._alphaMap=i.alphaMap,this._color=numberOr(i.color,4036976),this._combine=i.combine||t.MultiplyOperation,this._emissive=i.emissive||0,this._emissiveIntensity=numberOr(i.emissiveIntensity,1),this._emissiveMap=i.emissiveMap,this._envMap=i.envMap,this._map=i.map,this._reflectivity=numberOr(i.reflectivity,1),this._refractionRatio=numberOr(i.refractionRatio,.98),this._wireframe=i.wireframe||!1,this._createMaterial()}_createEditorHelper(){this._editorHelper=new LambertMaterialHelper(this)}_getDefaultName(){return"Lambert Material"}_createMaterial(){let i={color:this._color,combine:this._combine,emissive:this._emissive,emissiveIntensity:this._emissiveIntensity,opacity:this._opacity,reflectivity:this._reflectivity,refractionRatio:this._refractionRatio,side:this._side,transparent:this._transparent,wireframe:this._wireframe};this._updateMaterialParamsWithMaps(i,Rr),this._material=new t.MeshLambertMaterial(i)}getMaps(){return Rr}getMaterialType(){return Gn}getSampleTexture(){return this._material.map}exportParams(){let t=super.exportParams();return t.alphaMap=this._alphaMap,t.color=this._color,t.combine=this._combine,t.emissive=this._emissive,t.emissiveIntensity=this._emissiveIntensity,t.emissiveMap=this._emissiveMap,t.envMap=this._envMap,t.map=this._map,t.reflectivity=this._reflectivity,t.refractionRatio=this._refractionRatio,t.wireframe=this._wireframe,t}getAlphaMap(){return this._alphaMap}getColor(){return this._color}getCombine(){return this._combine}getEmissive(){return this._emissive}getEmissiveIntensity(){return this._emissiveIntensity}getEmissiveMap(){return this._emissiveMap}getEnvMap(){return this._envMap}getMap(){return this._map}getReflectivity(){return this._reflectivity}getRefractionRatio(){return this._refractionRatio}getWireframe(){return this._wireframe}setAlphaMap(t){this._alphaMap!=t&&this._setTexture("alphaMap",t)}setColor(t){this._color!=t&&(this._color=t,this._material.color.setHex(t))}setCombine(t){this._combine!=t&&(this._combine=t,this._material.combine=t,this._material.needsUpdate=!0)}setEmissive(t){this._emissive!=t&&(this._emissive=t,this._material.emissive.setHex(t))}setEmissiveIntensity(t){this._emissiveIntensity!=t&&(this._emissiveIntensity=t,this._material.emissiveIntensity=t)}setEmissiveMap(t){this._emissiveMap!=t&&this._setTexture("emissiveMap",t)}setEnvMap(t){this._envMap!=t&&this._setTexture("envMap",t)}setMap(t){this._map!=t&&this._setTexture("map",t)}setReflectivity(t){this._reflectivity!=t&&(this._reflectivity=t,this._material.reflectivity=t)}setRefractionRatio(t){this._refractionRatio!=t&&(this._refractionRatio=t,this._material.refractionRatio=t)}setWireframe(t){this._wireframe!=t&&(this._wireframe=t,this._material.wireframe=t,this._material.needsUpdate=!0)}},Gn);const Lr=[{parameter:"side"},{parameter:"transparent"},{parameter:"opacity"},{parameter:"flatShading",name:"Flat Shading",type:CheckboxInput},{parameter:"wireframe",name:"Wireframe",type:CheckboxInput},{parameter:"bumpMap",name:"Bump Map",filter:qs,type:TextureInput},{parameter:"bumpScale",name:"Bump Scale",min:0,max:1,type:NumberInput},{parameter:"displacementMap",name:"Displacement Map",filter:qs,type:TextureInput},{parameter:"displacementScale",name:"Displacement Scale",type:NumberInput},{parameter:"displacementBias",name:"Displacement Bias",type:NumberInput},{parameter:"normalMap",name:"Normal Map",filter:qs,type:TextureInput},{parameter:"normalMapType",name:"Normal Type",options:["Tangent","Object"],map:Ht,reverseMap:Yt,type:EnumInput},{parameter:"normalScale",name:"Normal Scale",min:0,max:1,type:Vector2Input}];class NormalMaterialHelper extends MaterialHelper{constructor(t){super(t)}getMenuFields(){return super.getMenuFields(Lr)}_getMenuFieldsMap(){let t=super._getMenuFieldsMap();for(let i of Lr)if(!(i.parameter in t)){let r=this._createStandardInput(i);r&&(t[i.parameter]=r)}return t}}const Or=["bumpMap","displacementMap","normalMap"];ys.registerMaterial(class extends Material{constructor(i={}){super(i),this._bumpMap=i.bumpMap,this._bumpScale=numberOr(i.bumpScale,1),this._displacementMap=i.displacementMap,this._displacementScale=numberOr(i.displacementScale,1),this._displacementBias=numberOr(i.displacementBias,0),this._flatShading=i.flatShading||!1,this._normalMap=i.normalMap,this._normalMapType=i.normalMapType||t.TangentSpaceNormalMap,this._normalScale=i.normalScale||[1,1],this._wireframe=i.wireframe||!1,this._createMaterial()}_createEditorHelper(){this._editorHelper=new NormalMaterialHelper(this)}_getDefaultName(){return"Normal Material"}_createMaterial(){let i={bumpScale:this._bumpScale,displacementScale:this._displacementScale,displacementBias:this._displacementBias,flatShading:this._flatShading,normalMapType:this._normalMapType,normalScale:(new t.Vector2).fromArray(this._normalScale),opacity:this._opacity,side:this._side,transparent:this._transparent,wireframe:this._wireframe};this._updateMaterialParamsWithMaps(i,Or),this._material=new t.MeshNormalMaterial(i)}getMaps(){return Or}getMaterialType(){return jn}getSampleTexture(){return this._material.map}exportParams(){let t=super.exportParams();return t.bumpMap=this._bumpMap,t.bumpScale=this._bumpScale,t.displacementBias=this._displacementBias,t.displacementMap=this._displacementMap,t.displacementScale=this._displacementScale,t.flatShading=this._flatShading,t.normalMap=this._normalMap,t.normalMapType=this._normalMapType,t.normalScale=this._normalScale,t.wireframe=this._wireframe,t}getBumpMap(){return this._bumpMap}getBumpScale(){return this._bumpScale}getDisplacementBias(){return this._displacementBias}getDisplacementMap(){return this._displacementMap}getDisplacementScale(){return this._displacementScale}getFlatShading(){return this._flatShading}getNormalMap(){return this._normalMap}getNormalMapType(){return this._normalMapType}getNormalScale(){return this._normalScale}getWireframe(){return this._wireframe}setBumpMap(t){this._bumpMap!=t&&this._setTexture("bumpMap",t)}setBumpScale(t){this._bumpScale!=t&&(this._bumpScale=t,this._material.bumpScale=t)}setDisplacementBias(t){this._displacementBias!=t&&(this._displacementBias=t,this._material.displacementBias=t)}setDisplacementMap(t){this._displacementMap!=t&&this._setTexture("displacementMap",t)}setDisplacementScale(t){this._displacementScale!=t&&(this._displacementScale=t,this._material.displacementScale=t)}setFlatShading(t){this._flatShading!=t&&(this._flatShading=t,this._material.flatShading=t,this._material.needsUpdate=!0)}setNormalMap(t){this._normalMap!=t&&this._setTexture("normalMap",t)}setNormalMapType(t){this._normalMapType!=t&&(this._normalMapType=t,this._material.normalMapType=t,this._material.needsUpdate=!0)}setNormalScale(t){this._normalScale!=t&&(this._normalScale=t,this._material.normalScale.fromArray(t))}setWireframe(t){this._wireframe!=t&&(this._wireframe=t,this._material.wireframe=t,this._material.needsUpdate=!0)}},jn);const Ur=[{parameter:"color",name:"Color",type:ColorInput},{parameter:"map",name:"Texture Map",filter:qs,type:TextureInput},{parameter:"side"},{parameter:"transparent"},{parameter:"opacity"},{parameter:"alphaMap",name:"Alpha Map",filter:qs,type:TextureInput},{parameter:"flatShading",name:"Flat Shading",type:CheckboxInput},{parameter:"wireframe",name:"Wireframe",type:CheckboxInput},{parameter:"bumpMap",name:"Bump Map",filter:qs,type:TextureInput},{parameter:"bumpScale",name:"Bump Scale",min:0,max:1,type:NumberInput},{parameter:"displacementMap",name:"Displacement Map",filter:qs,type:TextureInput},{parameter:"displacementScale",name:"Displacement Scale",type:NumberInput},{parameter:"displacementBias",name:"Displacement Bias",type:NumberInput},{parameter:"emissive",name:"Emissive Color",type:ColorInput},{parameter:"emissiveMap",name:"Emissive Map",filter:qs,type:TextureInput},{parameter:"emissiveIntensity",name:"Emissive Intensity",min:0,type:NumberInput},{parameter:"envMap",name:"Environment Map",filter:Js,type:TextureInput},{parameter:"combine",name:"Environment-Color Blend",options:["Multiply","Mix","Add"],map:Ut,reverseMap:zt,type:EnumInput},{parameter:"reflectivity",name:"Reflectivity",min:0,max:1,type:NumberInput},{parameter:"refractionRatio",name:"Refraction Ratio",min:0,max:1,type:NumberInput},{parameter:"normalMap",name:"Normal Map",filter:qs,type:TextureInput},{parameter:"normalMapType",name:"Normal Type",options:["Tangent","Object"],map:Ht,reverseMap:Yt,type:EnumInput},{parameter:"normalScale",name:"Normal Scale",min:0,max:1,type:Vector2Input},{parameter:"shininess",name:"Shininess",min:0,type:NumberInput},{parameter:"specular",name:"Specular Color",type:ColorInput},{parameter:"specularMap",name:"Specular Map",filter:qs,type:TextureInput}];class PhongMaterialHelper extends MaterialHelper{constructor(t){super(t)}getMenuFields(){return super.getMenuFields(Ur)}_getMenuFieldsMap(){let t=super._getMenuFieldsMap();for(let i of Ur)if(!(i.parameter in t)){let r=this._createStandardInput(i);r&&(t[i.parameter]=r)}return t}}const Nr=["map","alphaMap","bumpMap","displacementMap","emissiveMap","envMap","normalMap","specularMap"];ys.registerMaterial(class extends Material{constructor(i={}){super(i),this._alphaMap=i.alphaMap,this._bumpMap=i.bumpMap,this._bumpScale=numberOr(i.bumpScale,1),this._color=numberOr(i.color,4036976),this._combine=i.combine||t.MultiplyOperation,this._displacementMap=i.displacementMap,this._displacementScale=numberOr(i.displacementScale,1),this._displacementBias=numberOr(i.displacementBias,0),this._emissive=i.emissive||0,this._emissiveIntensity=numberOr(i.emissiveIntensity,1),this._emissiveMap=i.emissiveMap,this._envMap=i.envMap,this._flatShading=i.flatShading||!1,this._map=i.map,this._normalMap=i.normalMap,this._normalMapType=i.normalMapType||t.TangentSpaceNormalMap,this._normalScale=i.normalScale||[1,1],this._reflectivity=numberOr(i.reflectivity,1),this._refractionRatio=numberOr(i.refractionRatio,.98),this._shininess=numberOr(i.shininess,30),this._specular=numberOr(i.specular,1118481),this._specularMap=i.specularMap,this._wireframe=i.wireframe||!1,this._createMaterial()}_createEditorHelper(){this._editorHelper=new PhongMaterialHelper(this)}_getDefaultName(){return"Phong Material"}_createMaterial(){let i={color:this._color,bumpScale:this._bumpScale,combine:this._combine,displacementScale:this._displacementScale,displacementBias:this._displacementBias,emissive:this._emissive,emissiveIntensity:this._emissiveIntensity,flatShading:this._flatShading,normalMapType:this._normalMapType,normalScale:this._normalScale,opacity:this._opacity,side:this._side,transparent:this._transparent,reflectivity:this._reflectivity,refractionRatio:this._refractionRatio,shininess:this._shininess,specular:this._specular,wireframe:this._wireframe};this._updateMaterialParamsWithMaps(i,Nr),this._material=new t.MeshPhongMaterial(i)}getMaps(){return Nr}getMaterialType(){return zn}getSampleTexture(){return this._material.map}exportParams(){let t=super.exportParams();return t.alphaMap=this._alphaMap,t.bumpMap=this._bumpMap,t.bumpScale=this._bumpScale,t.color=this._color,t.combine=this._combine,t.displacementMap=this._displacementMap,t.displacementScale=this._displacementScale,t.displacementBias=this._displacementBias,t.emissive=this._emissive,t.emissiveIntensity=this._emissiveIntensity,t.emissiveMap=this._emissiveMap,t.envMap=this._envMap,t.flatShading=this._flatShading,t.map=this._map,t.normalMap=this._normalMap,t.normalMapType=this._normalMapType,t.normalScale=this._normalScale,t.reflectivity=this._reflectivity,t.refractionRatio=this._refractionRatio,t.shininess=this._shininess,t.specular=this._specular,t.specularMap=this._specularMap,t.wireframe=this._wireframe,t}getAlphaMap(){return this._alphaMap}getBumpMap(){return this._bumpMap}getBumpScale(){return this._bumpScale}getColor(){return this._color}getCombine(){return this._combine}getDisplacementBias(){return this._displacementBias}getDisplacementMap(){return this._displacementMap}getDisplacementScale(){return this._displacementScale}getEmissive(){return this._emissive}getEmissiveIntensity(){return this._emissiveIntensity}getEmissiveMap(){return this._emissiveMap}getEnvMap(){return this._envMap}getFlatShading(){return this._flatShading}getMap(){return this._map}getNormalMap(){return this._normalMap}getNormalMapType(){return this._normalMapType}getNormalScale(){return this._normalScale}getReflectivity(){return this._reflectivity}getRefractionRatio(){return this._refractionRatio}getShininess(){return this._shininess}getSpecular(){return this._specular}getSpecularMap(){return this._specularMap}getWireframe(){return this._wireframe}setAlphaMap(t){this._alphaMap!=t&&this._setTexture("alphaMap",t)}setBumpMap(t){this._bumpMap!=t&&this._setTexture("bumpMap",t)}setBumpScale(t){this._bumpScale!=t&&(this._bumpScale=t,this._material.bumpScale=t)}setColor(t){this._color!=t&&(this._color=t,this._material.color.setHex(t))}setCombine(t){this._combine!=t&&(this._combine=t,this._material.combine=t,this._material.needsUpdate=!0)}setDisplacementBias(t){this._displacementBias!=t&&(this._displacementBias=t,this._material.displacementBias=t)}setDisplacementMap(t){this._displacementMap!=t&&this._setTexture("displacementMap",t)}setDisplacementScale(t){this._displacementScale!=t&&(this._displacementScale=t,this._material.displacementScale=t)}setEmissive(t){this._emissive!=t&&(this._emissive=t,this._material.emissive.setHex(t))}setEmissiveIntensity(t){this._emissiveIntensity!=t&&(this._emissiveIntensity=t,this._material.emissiveIntensity=t)}setEmissiveMap(t){this._emissiveMap!=t&&this._setTexture("emissiveMap",t)}setEnvMap(t){this._envMap!=t&&this._setTexture("envMap",t)}setFlatShading(t){this._flatShading!=t&&(this._flatShading=t,this._material.flatShading=t,this._material.needsUpdate=!0)}setMap(t){this._map!=t&&this._setTexture("map",t)}setNormalMap(t){this._normalMap!=t&&this._setTexture("normalMap",t)}setNormalMapType(t){this._normalMapType!=t&&(this._normalMapType=t,this._material.normalMapType=t,this._material.needsUpdate=!0)}setNormalScale(t){this._normalScale!=t&&(this._normalScale=t,this._material.normalScale=t)}setReflectivity(t){this._reflectivity!=t&&(this._reflectivity=t,this._material.reflectivity=t)}setRefractionRatio(t){this._refractionRatio!=t&&(this._refractionRatio=t,this._material.refractionRatio=t)}setShininess(t){this._shininess!=t&&(this._shininess=t,this._material.shininess=t)}setSpecular(t){this._specular!=t&&(this._specular=t,this._material.specular.setHex(t))}setSpecularMap(t){this._specularMap!=t&&this._setTexture("specularMap",t)}setWireframe(t){this._wireframe!=t&&(this._wireframe=t,this._material.wireframe=t,this._material.needsUpdate=!0)}},zn);const Hr=[{parameter:"color",name:"Color",type:ColorInput},{parameter:"map",name:"Texture Map",filter:qs,type:TextureInput},{parameter:"side"},{parameter:"transparent"},{parameter:"opacity"},{parameter:"alphaMap",name:"Alpha Map",filter:qs,type:TextureInput},{parameter:"flatShading",name:"Flat Shading",type:CheckboxInput},{parameter:"wireframe",name:"Wireframe",type:CheckboxInput},{parameter:"bumpMap",name:"Bump Map",filter:qs,type:TextureInput},{parameter:"bumpScale",name:"Bump Scale",min:0,max:1,type:NumberInput},{parameter:"displacementMap",name:"Displacement Map",filter:qs,type:TextureInput},{parameter:"displacementScale",name:"Displacement Scale",type:NumberInput},{parameter:"displacementBias",name:"Displacement Bias",type:NumberInput},{parameter:"emissive",name:"Emissive Color",type:ColorInput},{parameter:"emissiveMap",name:"Emissive Map",filter:qs,type:TextureInput},{parameter:"emissiveIntensity",name:"Emissive Intensity",min:0,type:NumberInput},{parameter:"envMap",name:"Environment Map",filter:Js,type:TextureInput},{parameter:"envMapIntensity",name:"Environment Intensity",min:0,type:NumberInput},{parameter:"metalness",name:"Metalness",min:0,max:1,type:NumberInput},{parameter:"metalnessMap",name:"Metalness Map",filter:qs,type:TextureInput},{parameter:"normalMap",name:"Normal Map",filter:qs,type:TextureInput},{parameter:"normalMapType",name:"Normal Type",options:["Tangent","Object"],map:Ht,reverseMap:Yt,type:EnumInput},{parameter:"normalScale",name:"Normal Scale",min:0,max:1,type:Vector2Input},{parameter:"roughness",name:"Roughness",min:0,max:1,type:NumberInput},{parameter:"roughnessMap",name:"Roughness Map",filter:qs,type:TextureInput}];class StandardMaterialHelper extends MaterialHelper{constructor(t){super(t)}getMenuFields(){return super.getMenuFields(Hr)}_getMenuFieldsMap(){let t=super._getMenuFieldsMap();for(let i of Hr)if(!(i.parameter in t)){let r=this._createStandardInput(i);r&&(t[i.parameter]=r)}return t}}const Gr=["map","alphaMap","bumpMap","displacementMap","emissiveMap","envMap","metalnessMap","normalMap","roughnessMap"];ys.registerMaterial(class extends Material{constructor(i={}){super(i),this._color=numberOr(i.color,4036976),this._alphaMap=i.alphaMap,this._bumpMap=i.bumpMap,this._bumpScale=numberOr(i.bumpScale,1),this._displacementMap=i.displacementMap,this._displacementScale=numberOr(i.displacementScale,1),this._displacementBias=numberOr(i.displacementBias,0),this._emissive=i.emissive||0,this._emissiveMap=i.emissiveMap,this._emissiveIntensity=numberOr(i.emissiveIntensity,1),this._envMap=i.envMap,this._envMapIntensity=numberOr(i.envMapIntensity,1),this._flatShading=i.flatShading||!1,this._map=i.map,this._metalness=numberOr(i.metalness,0),this._metalnessMap=i.metalnessMap,this._normalMap=i.normalMap,this._normalMapType=i.normalMapType||t.TangentSpaceNormalMap,this._normalScale=i.normalScale||[1,1],this._roughness=numberOr(i.roughness,1),this._roughnessMap=i.roughnessMap,this._wireframe=i.wireframe||!1,this._createMaterial()}_createEditorHelper(){this._editorHelper=new StandardMaterialHelper(this)}_getDefaultName(){return"Standard Material"}_createMaterial(){let i={color:this._color,bumpScale:this._bumpScale,displacementScale:this._displacementScale,displacementBias:this._displacementBias,emissive:this._emissive,emissiveIntensity:this._emissiveIntensity,envMapIntensity:this._envMapIntensity,flatShading:this._flatShading,metalness:this._metalness,normalMapType:this._normalMapType,normalScale:this._normalScale,opacity:this._opacity,side:this._side,transparent:this._transparent,roughness:this._roughness,wireframe:this._wireframe};this._updateMaterialParamsWithMaps(i,Gr),this._material=new t.MeshStandardMaterial(i)}getMaps(){return Gr}getMaterialType(){return Vn}getSampleTexture(){return this._material.map}exportParams(){let t=super.exportParams();return t.alphaMap=this._alphaMap,t.bumpMap=this._bumpMap,t.bumpScale=this._bumpScale,t.color=this._material.color.getHex(),t.displacementMap=this._displacementMap,t.displacementScale=this._displacementScale,t.displacementBias=this._displacementBias,t.emissive=this._material.emissive.getHex(),t.emissiveMap=this._emissiveMap,t.emissiveIntensity=this._emissiveIntensity,t.envMap=this._envMap,t.envMapIntensity=this._envMapIntensity,t.flatShading=this._flatShading,t.map=this._map,t.metalness=this._metalness,t.metalnessMap=this._metalnessMap,t.normalMap=this._normalMap,t.normalMapType=this._normalMapType,t.normalScale=this._normalScale,t.roughness=this._roughness,t.roughnessMap=this._roughnessMap,t.wireframe=this._wireframe,t}getAlphaMap(){return this._alphaMap}getBumpMap(){return this._bumpMap}getBumpScale(){return this._bumpScale}getColor(){return this._color}getDisplacementBias(){return this._displacementBias}getDisplacementMap(){return this._displacementMap}getDisplacementScale(){return this._displacementScale}getEmissive(){return this._emissive}getEmissiveIntensity(){return this._emissiveIntensity}getEmissiveMap(){return this._emissiveMap}getEnvMap(){return this._envMap}getEnvMapIntensity(){return this._envMapIntensity}getFlatShading(){return this._flatShading}getMap(){return this._map}getMetalness(){return this._metalness}getMetalnessMap(){return this._metalnessMap}getNormalMap(){return this._normalMap}getNormalMapType(){return this._normalMapType}getNormalScale(){return this._normalScale}getRoughness(){return this._roughness}getRoughnessMap(){return this._roughnessMap}getWireframe(){return this._wireframe}setAlphaMap(t){this._alphaMap!=t&&this._setTexture("alphaMap",t)}setBumpMap(t){this._bumpMap!=t&&this._setTexture("bumpMap",t)}setBumpScale(t){this._bumpScale!=t&&(this._bumpScale=t,this._material.bumpScale=t)}setColor(t){this._color!=t&&(this._color=t,this._material.color.setHex(t))}setDisplacementBias(t){this._displacementBias!=t&&(this._displacementBias=t,this._material.displacementBias=t)}setDisplacementMap(t){this._displacementMap!=t&&this._setTexture("displacementMap",t)}setDisplacementScale(t){this._displacementScale!=t&&(this._displacementScale=t,this._material.displacementScale=t)}setEmissive(t){this._emissive!=t&&(this._emissive=t,this._material.emissive.setHex(t))}setEmissiveIntensity(t){this._emissiveIntensity!=t&&(this._emissiveIntensity=t,this._material.emissiveIntensity=t)}setEmissiveMap(t){this._emissiveMap!=t&&this._setTexture("emissiveMap",t)}setEnvMap(t){this._envMap!=t&&this._setTexture("envMap",t)}setEnvMapIntensity(t){this._envMapIntensity!=t&&(this._envMapIntensity=t,this._material.envMapIntensity=t)}setFlatShading(t){this._flatShading!=t&&(this._flatShading=t,this._material.flatShading=t,this._material.needsUpdate=!0)}setMap(t){this._map!=t&&this._setTexture("map",t)}setMetalness(t){this._metalness!=t&&(this._metalness=t,this._material.metalness=t)}setMetalnessMap(t){this._metalnessMap!=t&&this._setTexture("metalnessMap",t)}setNormalMap(t){this._normalMap!=t&&this._setTexture("normalMap",t)}setNormalMapType(t){this._normalMapType!=t&&(this._normalMapType=t,this._material.normalMapType=t,this._material.needsUpdate=!0)}setNormalScale(t){this._normalScale!=t&&(this._normalScale=t,this._material.normalScale=t)}setRoughness(t){this._roughness!=t&&(this._roughness=t,this._material.roughness=t)}setRoughnessMap(t){this._roughnessMap!=t&&this._setTexture("roughnessMap",t)}setWireframe(t){this._wireframe!=t&&(this._wireframe=t,this._material.wireframe=t,this._material.needsUpdate=!0)}},Vn);const jr=[{parameter:"color",name:"Color",type:ColorInput},{parameter:"map",name:"Texture Map",filter:qs,type:TextureInput},{parameter:"side"},{parameter:"transparent"},{parameter:"opacity"},{parameter:"alphaMap",name:"Alpha Map",filter:qs,type:TextureInput},{parameter:"wireframe",name:"Wireframe",type:CheckboxInput},{parameter:"bumpMap",name:"Bump Map",filter:qs,type:TextureInput},{parameter:"bumpScale",name:"Bump Scale",min:0,max:1,type:NumberInput},{parameter:"displacementMap",name:"Displacement Map",filter:qs,type:TextureInput},{parameter:"displacementScale",name:"Displacement Scale",type:NumberInput},{parameter:"displacementBias",name:"Displacement Bias",type:NumberInput},{parameter:"emissive",name:"Emissive Color",type:ColorInput},{parameter:"emissiveMap",name:"Emissive Map",filter:qs,type:TextureInput},{parameter:"emissiveIntensity",name:"Emissive Intensity",min:0,type:NumberInput},{parameter:"normalMap",name:"Normal Map",filter:qs,type:TextureInput},{parameter:"normalMapType",name:"Normal Type",options:["Tangent","Object"],map:Ht,reverseMap:Yt,type:EnumInput},{parameter:"normalScale",name:"Normal Scale",min:0,max:1,type:Vector2Input}];class BasicMaterialHelper extends MaterialHelper{constructor(t){super(t)}getMenuFields(){return super.getMenuFields(jr)}_getMenuFieldsMap(){let t=super._getMenuFieldsMap();for(let i of jr)if(!(i.parameter in t)){let r=this._createStandardInput(i);r&&(t[i.parameter]=r)}return t}}const zr=["map","alphaMap","bumpMap","displacementMap","emissiveMap","normalMap"];ys.registerMaterial(class extends Material{constructor(i={}){super(i),this._alphaMap=i.alphaMap,this._color=numberOr(i.color,4036976),this._bumpMap=i.bumpMap,this._bumpScale=numberOr(i.bumpScale,1),this._displacementMap=i.displacementMap,this._displacementScale=numberOr(i.displacementScale,1),this._displacementBias=numberOr(i.displacementBias,0),this._emissive=i.emissive||0,this._emissiveMap=i.emissiveMap,this._emissiveIntensity=numberOr(i.emissiveIntensity,1),this._map=i.map,this._normalMap=i.normalMap,this._normalMapType=i.normalMapType||t.TangentSpaceNormalMap,this._normalScale=i.normalScale||[1,1],this._wireframe=i.wireframe||!1,this._createMaterial()}_createEditorHelper(){this._editorHelper=new BasicMaterialHelper(this)}_getDefaultName(){return"Toon Material"}_createMaterial(){let i={bumpScale:this._bumpScale,color:this._color,displacementScale:this._displacementScale,displacementBias:this._displacementBias,emissive:this._emissive,emissiveIntensity:this._emissiveIntensity,normalMapType:this._normalMapType,normalScale:this._normalScale,opacity:this._opacity,side:this._side,transparent:this._transparent,wireframe:this._wireframe};this._updateMaterialParamsWithMaps(i,zr),this._material=new t.MeshToonMaterial(i)}getMaps(){return zr}getMaterialType(){return Yn}getSampleTexture(){return this._material.map}exportParams(){let t=super.exportParams();return t.alphaMap=this._alphaMap,t.bumpMap=this._bumpMap,t.bumpScale=this._bumpScale,t.color=this._material.color.getHex(),t.displacementMap=this._displacementMap,t.displacementScale=this._displacementScale,t.displacementBias=this._displacementBias,t.emissive=this._material.emissive.getHex(),t.emissiveMap=this._emissiveMap,t.emissiveIntensity=this._emissiveIntensity,t.map=this._map,t.normalMap=this._normalMap,t.normalMapType=this._normalMapType,t.normalScale=this._normalScale,t.wireframe=this._wireframe,t}getAlphaMap(){return this._alphaMap}getBumpMap(){return this._bumpMap}getBumpScale(){return this._bumpScale}getColor(){return this._color}getDisplacementBias(){return this._displacementBias}getDisplacementMap(){return this._displacementMap}getDisplacementScale(){return this._displacementScale}getEmissive(){return this._emissive}getEmissiveIntensity(){return this._emissiveIntensity}getEmissiveMap(){return this._emissiveMap}getMap(){return this._map}getNormalMap(){return this._normalMap}getNormalMapType(){return this._normalMapType}getNormalScale(){return this._normalScale}getWireframe(){return this._wireframe}setAlphaMap(t){this._alphaMap!=t&&this._setTexture("alphaMap",t)}setBumpMap(t){this._bumpMap!=t&&this._setTexture("bumpMap",t)}setBumpScale(t){this._bumpScale!=t&&(this._bumpScale=t,this._material.bumpScale=t)}setColor(t){this._color!=t&&(this._color=t,this._material.color.setHex(t))}setDisplacementBias(t){this._displacementBias!=t&&(this._displacementBias=t,this._material.displacementBias=t)}setDisplacementMap(t){this._displacementMap!=t&&this._setTexture("displacementMap",t)}setDisplacementScale(t){this._displacementScale!=t&&(this._displacementScale=t,this._material.displacementScale=t)}setEmissive(t){this._emissive!=t&&(this._emissive=t,this._material.emissive.setHex(t))}setEmissiveIntensity(t){this._emissiveIntensity!=t&&(this._emissiveIntensity=t,this._material.emissiveIntensity=t)}setEmissiveMap(t){this._emissiveMap!=t&&this._setTexture("emissiveMap",t)}setMap(t){this._map!=t&&this._setTexture("map",t)}setNormalMap(t){this._normalMap!=t&&this._setTexture("normalMap",t)}setNormalMapType(t){this._normalMapType!=t&&(this._normalMapType=t,this._material.normalMapType=t,this._material.needsUpdate=!0)}setNormalScale(t){this._normalScale!=t&&(this._normalScale=t,this._material.normalScale=t)}setWireframe(t){this._wireframe!=t&&(this._wireframe=t,this._material.wireframe=t,this._material.needsUpdate=!0)}},Yn);class Texture{constructor(t={}){this._id=t.id||uuidv4(),this._name="name"in t?t.name:this._getDefaultName(),ze.isEditor&&this._createEditorHelper()}_createEditorHelper(){console.error("Texture._createEditorHelper() should be overridden")}_getDefaultName(){console.error("Texture._getDefaultName() should be overridden")}_createTexture(){console.error("Texture._createTexture() should be overridden")}exportParams(){return{id:this._id,name:this._name}}setFromParams(t){console.warn("Unexpectedly trying to setFromParams() for Texture...")}_updateTexture(){let t=this._texture;this._createTexture(),setTimeout((()=>{t.dispose()}),20)}dispose(){setTimeout((()=>{this._texture.dispose()}),20)}getTexture(){return this._texture}getPreviewTexture(){return this._texture}getAssetIds(){console.error("Texture.getAssetIds() should be overridden")}getTextureType(){console.error("Texture.getTextureType() should be overridden")}getId(){return this._id}getEditorHelper(){return this._editorHelper}getName(){return this._name}setName(t){null!=t&&this._name!=t&&(this._name=t)}}const Vr=[{parameter:"image",name:"Image",type:ImageInput},{parameter:"wrapS",name:"Horizontal Wrapping",type:EnumInput,options:["Clamp","Repeat","Mirrored"],map:jt,reverseMap:Xt},{parameter:"wrapT",name:"Vertical Wrapping",type:EnumInput,options:["Clamp","Repeat","Mirrored"],map:jt,reverseMap:Xt},{parameter:"repeat",name:"Repeat",type:Vector2Input},{parameter:"offset",name:"Offset",type:Vector2Input}];class BasicTextureHelper extends EditorHelper{constructor(t){super(t,bt)}getMenuFields(){return super.getMenuFields(Vr)}_getMenuFieldsMap(){let t=super._getMenuFieldsMap();for(let i of Vr)if(!(i.parameter in t)){let r=this._createStandardInput(i);r&&(t[i.parameter]=r)}return t}}Cs.registerTexture(class extends Texture{constructor(i={}){super(i),this._image=i.image,this._wrapS=i.wrapS||t.ClampToEdgeWrapping,this._wrapT=i.wrapT||t.ClampToEdgeWrapping,this._repeat=i.repeat||[1,1],this._offset=i.offset||[0,0],this._createTexture()}_createEditorHelper(){this._editorHelper=new BasicTextureHelper(this)}_getDefaultName(){return"Texture"}_createTexture(){this._image?this._texture=ui.cloneTexture(this._image):this._texture=vt.blackPixel.clone(),this._texture.wrapS=this._wrapS,this._texture.wrapT=this._wrapT,this._texture.repeat.fromArray(this._repeat),this._texture.offset.fromArray(this._offset),this._texture.needsUpdate=!0}getAssetIds(){return this._image?[this._image]:[]}getTextureType(){return qs}exportParams(){let t=super.exportParams();return t.image=this._image,t.wrapS=this._texture.wrapS,t.wrapT=this._texture.wrapT,t.repeat=this._texture.repeat.toArray(),t.offset=this._texture.offset.toArray(),t}getImage(){return this._image}getOffset(){return this._offset}getRepeat(){return this._repeat}getWrapS(){return this._wrapS}getWrapT(){return this._wrapT}setImage(t){this._image!=t&&(this._image=t,this._updateTexture())}setOffset(t){compareLists(this._offset,t)||(this._offset=t,this._updateTexture())}setRepeat(t){compareLists(this._repeat,t)||(this._repeat=t,this._updateTexture())}setWrapS(t){this._wrapS!=t&&(this._wrapS=t,this._updateTexture())}setWrapT(t){this._wrapT!=t&&(this._wrapT=t,this._updateTexture())}},qs);const Yr=[{parameter:"images",name:"Images",type:CubeImageInput},{parameter:"mapping",name:"Mapping",type:EnumInput,options:["Reflection","Refraction"],map:Nt,reverseMap:Vt}];class CubeTextureHelper extends EditorHelper{constructor(t){super(t,bt)}getMenuFields(){return super.getMenuFields(Yr)}_getMenuFieldsMap(){let t=super._getMenuFieldsMap();for(let i of Yr)if(!(i.parameter in t)){let r=this._createStandardInput(i);r&&(t[i.parameter]=r)}return t}}Cs.registerTexture(class extends Texture{constructor(i={}){super(i),this._images=i.images||{},this._mapping=i.mapping||t.CubeReflectionMapping,this._createTexture()}_createEditorHelper(){this._editorHelper=new CubeTextureHelper(this)}_getDefaultName(){return"Cube Texture"}_createTexture(){let i=[this._getImageFromSide(bi.RIGHT),this._getImageFromSide(bi.LEFT),this._getImageFromSide(bi.TOP),this._getImageFromSide(bi.BOTTOM),this._getImageFromSide(bi.FRONT),this._getImageFromSide(bi.BACK)];this._validateImageList(i)||(i=Array(6).fill(vt.blackPixel.image)),this._texture=new t.CubeTexture(i,this._mapping),this._texture.needsUpdate=!0}_getImageFromSide(t){return this._images[t]?ui.getImage(this._images[t]):vt.blackPixel.image}_validateImageList(t){let i,r=!0;for(let A of t)if(A!=vt.blackPixel.image){if(A.width!=A.height)return PubSub.publish(this._id,PubSubTopics.MENU_NOTIFICATION,{text:"Images must be of same width and height",sustainTime:3}),!1;if(!(d=A.width)||d&d-1)return PubSub.publish(this._id,PubSubTopics.MENU_NOTIFICATION,{text:"Image lengths must be a power of 2",sustainTime:3}),!1;if(i&&A.width!=i)return PubSub.publish(this._id,PubSubTopics.MENU_NOTIFICATION,{text:"All images must be the same size",sustainTime:3}),!1;i=A.width}else r=!1;var d;return r}getPreviewTexture(){let t=this._images[bi.FRONT];return t?ui.getTexture(t):vt.blackPixel}getAssetIds(){let t=[];for(let i in bi)this._images[i]&&t.push(this._images[i]);return t}getTextureType(){return Js}exportParams(){let t=super.exportParams();return t.images=this._images,t.mapping=this._texture.mapping,t}getImages(){return this._images}getMapping(){return this._mapping}setImages(t,i){if(i){if(this._images[i]==t)return;this._images[i]=t,this._updateTexture()}else{let i=!1;for(let r in this._images)this._images[r]!=t[r]&&(this._images[r]=t[r],i=!0);i&&this._updateTexture()}}setMapping(t){this._mapping!=t&&(this._mapping=t,this._updateTexture())}},Js);var Wr="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0;function download(t,i,r){var d=new XMLHttpRequest;d.open("GET",t),d.responseType="blob",d.onload=function(){Jr(d.response,i,r)},d.onerror=function(){console.error("could not download file")},d.send()}function corsEnabled(t){var i=new XMLHttpRequest;i.open("HEAD",t,!1);try{i.send()}catch(t){}return i.status>=200&&i.status<=299}function click(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(r){var i=document.createEvent("MouseEvents");i.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(i)}}var Xr,Kr,Zr,qr=Wr.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),Jr=Wr.saveAs||("object"!=typeof window||window!==Wr?function(){}:"download"in HTMLAnchorElement.prototype&&!qr?function(t,i,r){var d=Wr.URL||Wr.webkitURL,A=document.createElement("a");i=i||t.name||"download",A.download=i,A.rel="noopener","string"==typeof t?(A.href=t,A.origin!==location.origin?corsEnabled(A.href)?download(t,i,r):click(A,A.target="_blank"):click(A)):(A.href=d.createObjectURL(t),setTimeout((function(){d.revokeObjectURL(A.href)}),4e4),setTimeout((function(){click(A)}),0))}:"msSaveOrOpenBlob"in navigator?function(t,i,r){if(i=i||t.name||"download","string"==typeof t)if(corsEnabled(t))download(t,i,r);else{var d=document.createElement("a");d.href=t,d.target="_blank",setTimeout((function(){click(d)}))}else navigator.msSaveOrOpenBlob(function(t,i){return void 0===i?i={autoBom:!1}:"object"!=typeof i&&(console.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob([String.fromCharCode(65279),t],{type:t.type}):t}(t,r),i)}:function(t,i,r,d){if((d=d||open("","_blank"))&&(d.document.title=d.document.body.innerText="downloading..."),"string"==typeof t)return download(t,i,r);var A="application/octet-stream"===t.type,g=/constructor/i.test(Wr.HTMLElement)||Wr.safari,b=/CriOS\/[\d]+/.test(navigator.userAgent);if((b||A&&g||qr)&&"undefined"!=typeof FileReader){var I=new FileReader;I.onloadend=function(){var t=I.result;t=b?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),d?d.location.href=t:location=t,d=null},I.readAsDataURL(t)}else{var w=Wr.URL||Wr.webkitURL,C=w.createObjectURL(t);d?d.location=C:location.href=C,d=null,setTimeout((function(){w.revokeObjectURL(C)}),4e4)}});function start(t,i,r){!function(t){let i=document.createElement("style");i.type="text/css",i.innerHTML="\n#digital-bacon-loading.loading, #digital-bacon-error.error {\n    position: absolute;\n    height: 100%;\n    width: 100%;\n    z-index: 100;\n    color: #4723D9;\n    display: block;\n    justify-content: center;\n    align-items: center;\n}\n\n#digital-bacon-loading, #digital-bacon-error {\n    display: none;\n}\n\n@keyframes animatedOpacity {\n    from { opacity: 1; }\n    to { opacity: 0; }\n}\n\n#digital-bacon-loading.loading.ending {\n    animation: animatedOpacity 1s linear 1 forwards;\n}\n\n@keyframes animatedScale {\n    0% { transform: scale(1.0); }\n    100% { transform: scale(1.1); }\n}\n\n#digital-bacon-loading.loading > img {\n    width: 25%;\n    animation: animatedScale 1s ease-in-out alternate infinite;\n}\n\n#mobile-joystick {\n    position: absolute;\n    width: 100px;\n    height: 100px;\n    left: 10px;\n    bottom: 10px;\n}\n\n#mobile-menu-open-button {\n    position: absolute;\n    top: 10px;\n    right: 10px;\n}\n\n#mobile-flying-controls {\n    position: absolute;\n    bottom: 10px;\n    right: 10px;\n}\n\n#mobile-flying-controls > button, #mobile-menu-open-button {\n    border-width: 1px;\n    border-style: solid;\n    border-color: #fff;\n    border-radius: 4px;\n    background: rgba(0,0,0,0.5);\n    padding: 12px;\n    color: #fff;\n    font: normal 13px sans-serif;\n    opacity: 0.75;\n}\n\n#mobile-flying-controls > button {\n    width: 70px;\n}\n\n#container button:hover {\n    opacity: 1;\n}\n\n#transform-controls {\n    position: absolute;\n    top: 50px;\n}\n\n#transform-controls > button, #ready-player-me-close-button {\n    border-width: 1px;\n    border-style: solid;\n    border-color: #fff;\n    border-radius: 4px;\n    background: rgba(0,0,0,0.5);\n    padding: 12px;\n    color: #fff;\n    font: normal 13px sans-serif;\n    opacity: 0.7;\n    width: 95px;\n    margin: 2px;\n    display: block;\n    text-align: left;\n}\n\n#transform-controls > button:hover, #transform-controls > button.selected {\n    opacity: 1;\n    font-weight: bold;\n    background-color: black;\n}\n\n#transform-controls > button > i {\n    font-size: 18px;\n    width: 25px;\n}\n\n#ready-player-me-close-button {\n    position: absolute;\n    top: 10%;\n    z-index: 1001;\n    transform: translateX(-50%);\n    width: fit-content;\n    display: inline;\n}\n\n#digital-bacon-rpm-iframe {\n    position: absolute;\n    top: 10%;\n    left: 0;\n    width: 100%;\n    height: 80%;\n    z-index: 1000;\n    border: none;\n}\n\n#container .hidden {\n    display: none;\n}\n\n#container > canvas {\n    outline: none;\n}\n    ".replaceAll("container",t),"MOBILE"==ze.deviceType&&(i.innerHTML+="\n@media screen and (max-height: 500px) {\n    #transform-controls {\n        max-height: calc(100% - 169px);\n        overflow: scroll;\n    }\n}\n        ");document.getElementsByTagName("head")[0].appendChild(i);let r=document.createElement("link");r.rel="stylesheet",r.href="https://maxst.icons8.com/vue-static/landings/line-awesome/line-awesome/1.3.0/css/line-awesome.min.css",document.getElementsByTagName("head")[0].appendChild(r);let d=document.getElementById(t);d.innerHTML='\n      <div id="digital-bacon-loading" class="loading">\n        <h1>Loading...</h1>\n        <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABAAAAAQACAMAAABIw9uxAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAL6UExURQAAAG0bVQAAAAAAAEASMW4bVmYaT0dwTG4cVj4ANAAAAAAAAAAAAG0bVQAAAAYBBW4cVgAAAG4cVgAAAEQRNW4cViIIGg4DDG8cVUkSOSoKIXAdVz0PMAAAAAAAAGMYTW4cVhcFEmgaUWobUzUNKkcVN24cVm4bVW4bVl0XSU8TPW4cVm4cVm4cVm4cVm4cVm4cVlUVQm4cVm4bVm4cVgAAAAAAAG8dVmYaUAAAAG4cVm8cVmAYS24cVgAAAG4cVlsXRwAAAG8eVgAAAFkWRWQZTm4bVm4cVW4cVm4cVm8cVW8cVv2W624cVv3LzNKWqP7q6/9pgv///9NSdf+ltG8dV/zKy3IgWXMiWnAeWNOXqf3Oz/7p6vnGydGVp3UkW9aaq3coXv7o6f7n6PvJy+Kqtoc7a9ecrOy2voQ5auCotH4wZPXBxo1Bb/S/xPG7wtuhsP3S04o+bf3Q0fbDx8+Tpt2jsZtRevjEyPK+w4M2aOixutmfrv7U1e+5wHkpX/rIyt+ls8GBmn4zZ3wtYuqzvOauueSst5dOeLFtjcOEnJBFcv7a29idrZJIdIEzZv7d3aJbgcmLobt6lXkrYJ1VfbNwj6pliHssYf7X2J9Yfq5qi7Zzkf7i46Rdgr18l8iJoOu1vcuNotCUp6hjhv7k5XYlXf7g4NSZqqZghL9+mIZAcM6Rpfvm6O24v7h2k/Tc4ZRKdsyPo5JQfJxgiKxnicmftrKBoOJZecaascaHnubH0opEc/zo6cSGnfrk57iForB7m+pde/jg5I9LeLp4lPNifs2QpKFli6dvk4YoXdpVd86kufHW3dOsv5dYgfz6+6Y6Z6Rqj9exwruNqKx1lsGUreLCzu3R2f2istGpvH4kW/pmgMZLcd27yZkzY9rF1LZCbP5ogs9PdOC+zPGXq/Lq8I8tYP+NoP9yif9/leHQ3P9thrhhhv+brNq2xvTt8semvYxHds6RpNqCnMdwkOnc5ffy9e7l7OSLo9O5y9GWqQAaAP8AAMG9VswAAAD+dFJOU1TzUQoE+woA/QEQTkT3SlfrGds9j7hqXByYcRKGITfUQ2Ll7X0WpSWBxKJey8I7m+Su1EppMi4z3ymSb8yMJa6+Hisrt9p6dlVZT1L///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9UYRtC9wAAanxJREFUeNrs3c3PFIUdwHFJHh55DiSEhORJuHApkABqqomJpDHhgGgzM3t5eH0MWmxtINZS0KhUg2IUGyLY+kYb+mJjMUVbUg2N2hYabOQgJSmtJRw8eSfpX9DngQDPzM7szuzO7s7sfj7Hpg+7O+vvu/M+t9wKjKxbLAIQAEAAAAEABAAQAEAAAAEABAAQAEAAAAEABAAQAEAAAAEABAAQAEAAAAEABAAQAEAAAAEABAAQAEAAAAEABAAQAEAAAAEABAAQAEAAAAEABAAEABAAQAAAAQAEABAAQAAAAQAEABAAQAAAAQAEABAAQAAAAQAEABAAQAAAAQAEABAAQAAAAQAEABAAQAAAAQAEABAAQAAAAQAEABAAQAAAAQAEAAQAEABAAAABAAQAEABAAAABAAQAEABAAAABAAQAEABAAAABAAQAEABAAAABAAQAEABAAAABAAQAEABAAAABAAQAEABAAAABAAQAEABAAAABAAQABAAQAEAAAAEABAAQAEAAAAEABAAQAEAAAAEABAAQAEAAAAEABAAQAEAAAAEABAAQAEAAAAEABAAQAEAAAAEABAAQAEAAAAEABAAQAEAAAAEABAAEABAAQAAAAQAEABAAQAAAAQAEABAAQAAAAQAEABAAQAAAAQAEABAAQAAAAQAEABAAQAAAAQAEABAArplcuXphcN2iJeu/YZEgAKPhrsVBmjvWWjQIwJBbHrSy2gJCAIbW+LygrSUWEwIwjO5cEOQyb6llhQAM269/zvGftWCd5YUADJP5QTHWAhCAofFAUNy4xYYADIVFQSfmWXAIQP2NBZ2638JDAGpuadC5+ROWHwJQZ5NBVzZYgghAfY0HXVpsGSIAtZU11ye+PN+47tMzB1olYMxSRABqsLG/dk38aP+ie1elj/THjWZfZBdgmWWL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">\n      </div>\n      <div id="digital-bacon-error">\n        <h1>Error Loading Default Environment</h1>\n      </div>\n      <div id="transform-controls" class="hidden">\n        <button id="place-button"><i class="las la-map-pin"></i>Place</button>\n        <button id="translate-button" class="selected"><i class="las la-arrows-alt"></i>Move</button>\n        <button id="rotate-button"><i class="las la-sync"></i>Rotate</button>\n        <button id="scale-button"><i class="las la-expand"></i>Scale</button>\n        <button id="clone-button"><i class="las la-copy"></i>Clone</button>\n        <button id="delete-button"><i class="las la-trash"></i>Delete</button>\n        <button id="close-button"><i class="las la-times-circle"></i>Close</button>\n      </div>\n      <div id="mobile-joystick" class="hidden"></div>\n      <button id="mobile-menu-open-button" class="hidden">OPEN MENU</button>\n      <div id="mobile-flying-controls" class="hidden">\n        <button id="mobile-flying-up-button">UP</button>\n        <button id="mobile-flying-down-button">DOWN</button>\n      </div>',d.style.position="relative"}(i),window.main=new Main(t,i,r)}function checkIfPointer(){("pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document)&&![/Android/i,/webOS/i,/iPhone/i,/iPad/i,/iPod/i,/BlackBerry/i,/Windows Phone/i].some((t=>navigator.userAgent.match(t)))&&(ze.deviceType="POINTER")}function setupEditor(t,i){return ze.isEditor=!0,setup(t,i)}function setup(t,i){return i=i||{},ze.authUrl=i.authUrl,ze.socketUrl=i.socketUrl,new Promise((r=>{if(!localStorage.getItem("DigitalBacon:MobileOverride"))return localStorage.getItem("DigitalBacon:PointerOverride")?(ze.deviceType="POINTER",void start(r,t,i.projectFilePath)):void("xr"in navigator?navigator.xr.isSessionSupported("immersive-vr").then((function(t){t?ze.deviceType="XR":checkIfPointer()})).catch((function(){checkIfPointer()})).finally((function(){start(r,t,i.projectFilePath)})):(checkIfPointer(),start(r,t,i.projectFilePath)));start(r,t,i.projectFilePath)}))}
/*!
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */Wr.saveAs=Jr.saveAs=Jr,"undefined"!=typeof module&&(module.exports=Jr)
/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/,function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).JSZip=t()}}((function(){return function e(t,i,r){function s(A,g){if(!i[A]){if(!t[A]){var b="function"==typeof require&&require;if(!g&&b)return b(A,!0);if(d)return d(A,!0);var I=new Error("Cannot find module '"+A+"'");throw I.code="MODULE_NOT_FOUND",I}var w=i[A]={exports:{}};t[A][0].call(w.exports,(function(i){var r=t[A][1][i];return s(r||i)}),w,w.exports,e,t,i,r)}return i[A].exports}for(var d="function"==typeof require&&require,A=0;A<r.length;A++)s(r[A]);return s}({1:[function(t,i,r){var d=t("./utils"),A=t("./support"),g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r.encode=function(t){for(var i,r,A,b,I,w,C,B=[],S=0,T=t.length,x=T,M="string"!==d.getTypeOf(t);S<t.length;)x=T-S,M?(i=t[S++],r=S<T?t[S++]:0,A=S<T?t[S++]:0):(i=t.charCodeAt(S++),r=S<T?t.charCodeAt(S++):0,A=S<T?t.charCodeAt(S++):0),b=i>>2,I=(3&i)<<4|r>>4,w=x>1?(15&r)<<2|A>>6:64,C=x>2?63&A:64,B.push(g.charAt(b)+g.charAt(I)+g.charAt(w)+g.charAt(C));return B.join("")},r.decode=function(t){var i,r,d,b,I,w,C=0,B=0,S="data:";if(t.substr(0,S.length)===S)throw new Error("Invalid base64 input, it looks like a data url.");var T,x=3*(t=t.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(t.charAt(t.length-1)===g.charAt(64)&&x--,t.charAt(t.length-2)===g.charAt(64)&&x--,x%1!=0)throw new Error("Invalid base64 input, bad content length.");for(T=A.uint8array?new Uint8Array(0|x):new Array(0|x);C<t.length;)i=g.indexOf(t.charAt(C++))<<2|(b=g.indexOf(t.charAt(C++)))>>4,r=(15&b)<<4|(I=g.indexOf(t.charAt(C++)))>>2,d=(3&I)<<6|(w=g.indexOf(t.charAt(C++))),T[B++]=i,64!==I&&(T[B++]=r),64!==w&&(T[B++]=d);return T}},{"./support":30,"./utils":32}],2:[function(t,i,r){var d=t("./external"),A=t("./stream/DataWorker"),g=t("./stream/Crc32Probe"),b=t("./stream/DataLengthProbe");function CompressedObject(t,i,r,d,A){this.compressedSize=t,this.uncompressedSize=i,this.crc32=r,this.compression=d,this.compressedContent=A}CompressedObject.prototype={getContentWorker:function(){var t=new A(d.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new b("data_length")),i=this;return t.on("end",(function(){if(this.streamInfo.data_length!==i.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")})),t},getCompressedWorker:function(){return new A(d.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},CompressedObject.createWorkerFrom=function(t,i,r){return t.pipe(new g).pipe(new b("uncompressedSize")).pipe(i.compressWorker(r)).pipe(new b("compressedSize")).withStreamInfo("compression",i)},i.exports=CompressedObject},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,i,r){var d=t("./stream/GenericWorker");r.STORE={magic:"\0\0",compressWorker:function(){return new d("STORE compression")},uncompressWorker:function(){return new d("STORE decompression")}},r.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,i,r){var d=t("./utils");var A=function(){for(var t,i=[],r=0;r<256;r++){t=r;for(var d=0;d<8;d++)t=1&t?3988292384^t>>>1:t>>>1;i[r]=t}return i}();i.exports=function(t,i){return void 0!==t&&t.length?"string"!==d.getTypeOf(t)?function(t,i,r,d){var g=A,b=d+r;t^=-1;for(var I=d;I<b;I++)t=t>>>8^g[255&(t^i[I])];return-1^t}(0|i,t,t.length,0):function(t,i,r,d){var g=A,b=d+r;t^=-1;for(var I=d;I<b;I++)t=t>>>8^g[255&(t^i.charCodeAt(I))];return-1^t}(0|i,t,t.length,0):0}},{"./utils":32}],5:[function(t,i,r){r.base64=!1,r.binary=!1,r.dir=!1,r.createFolders=!0,r.date=null,r.compression=null,r.compressionOptions=null,r.comment=null,r.unixPermissions=null,r.dosPermissions=null},{}],6:[function(t,i,r){var d=null;d="undefined"!=typeof Promise?Promise:t("lie"),i.exports={Promise:d}},{lie:37}],7:[function(t,i,r){var d="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,A=t("pako"),g=t("./utils"),b=t("./stream/GenericWorker"),I=d?"uint8array":"array";function FlateWorker(t,i){b.call(this,"FlateWorker/"+t),this._pako=null,this._pakoAction=t,this._pakoOptions=i,this.meta={}}r.magic="\b\0",g.inherits(FlateWorker,b),FlateWorker.prototype.processChunk=function(t){this.meta=t.meta,null===this._pako&&this._createPako(),this._pako.push(g.transformTo(I,t.data),!1)},FlateWorker.prototype.flush=function(){b.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},FlateWorker.prototype.cleanUp=function(){b.prototype.cleanUp.call(this),this._pako=null},FlateWorker.prototype._createPako=function(){this._pako=new A[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var t=this;this._pako.onData=function(i){t.push({data:i,meta:t.meta})}},r.compressWorker=function(t){return new FlateWorker("Deflate",t)},r.uncompressWorker=function(){return new FlateWorker("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,i,r){var d=t("../utils"),A=t("../stream/GenericWorker"),g=t("../utf8"),b=t("../crc32"),I=t("../signature"),decToHex=function(t,i){var r,d="";for(r=0;r<i;r++)d+=String.fromCharCode(255&t),t>>>=8;return d},generateZipParts=function(t,i,r,A,w,C){var B,S,T=t.file,x=t.compression,M=C!==g.utf8encode,P=d.transformTo("string",C(T.name)),D=d.transformTo("string",g.utf8encode(T.name)),Q=T.comment,F=d.transformTo("string",C(Q)),R=d.transformTo("string",g.utf8encode(Q)),L=D.length!==T.name.length,O=R.length!==Q.length,U="",N="",H="",G=T.dir,j=T.date,V={crc32:0,compressedSize:0,uncompressedSize:0};i&&!r||(V.crc32=t.crc32,V.compressedSize=t.compressedSize,V.uncompressedSize=t.uncompressedSize);var Y=0;i&&(Y|=8),M||!L&&!O||(Y|=2048);var W,X,K,Z=0,q=0;G&&(Z|=16),"UNIX"===w?(q=798,Z|=(W=T.unixPermissions,X=G,K=W,W||(K=X?16893:33204),(65535&K)<<16)):(q=20,Z|=63&(T.dosPermissions||0)),B=j.getUTCHours(),B<<=6,B|=j.getUTCMinutes(),B<<=5,B|=j.getUTCSeconds()/2,S=j.getUTCFullYear()-1980,S<<=4,S|=j.getUTCMonth()+1,S<<=5,S|=j.getUTCDate(),L&&(N=decToHex(1,1)+decToHex(b(P),4)+D,U+="up"+decToHex(N.length,2)+N),O&&(H=decToHex(1,1)+decToHex(b(F),4)+R,U+="uc"+decToHex(H.length,2)+H);var J="";return J+="\n\0",J+=decToHex(Y,2),J+=x.magic,J+=decToHex(B,2),J+=decToHex(S,2),J+=decToHex(V.crc32,4),J+=decToHex(V.compressedSize,4),J+=decToHex(V.uncompressedSize,4),J+=decToHex(P.length,2),J+=decToHex(U.length,2),{fileRecord:I.LOCAL_FILE_HEADER+J+P+U,dirRecord:I.CENTRAL_FILE_HEADER+decToHex(q,2)+J+decToHex(F.length,2)+"\0\0\0\0"+decToHex(Z,4)+decToHex(A,4)+P+U+F}},generateDataDescriptors=function(t){return I.DATA_DESCRIPTOR+decToHex(t.crc32,4)+decToHex(t.compressedSize,4)+decToHex(t.uncompressedSize,4)};function ZipFileWorker(t,i,r,d){A.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=i,this.zipPlatform=r,this.encodeFileName=d,this.streamFiles=t,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}d.inherits(ZipFileWorker,A),ZipFileWorker.prototype.push=function(t){var i=t.meta.percent||0,r=this.entriesCount,d=this._sources.length;this.accumulate?this.contentBuffer.push(t):(this.bytesWritten+=t.data.length,A.prototype.push.call(this,{data:t.data,meta:{currentFile:this.currentFile,percent:r?(i+100*(r-d-1))/r:100}}))},ZipFileWorker.prototype.openedSource=function(t){this.currentSourceOffset=this.bytesWritten,this.currentFile=t.file.name;var i=this.streamFiles&&!t.file.dir;if(i){var r=generateZipParts(t,i,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:r.fileRecord,meta:{percent:0}})}else this.accumulate=!0},ZipFileWorker.prototype.closedSource=function(t){this.accumulate=!1;var i=this.streamFiles&&!t.file.dir,r=generateZipParts(t,i,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(r.dirRecord),i)this.push({data:generateDataDescriptors(t),meta:{percent:100}});else for(this.push({data:r.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},ZipFileWorker.prototype.flush=function(){for(var t=this.bytesWritten,i=0;i<this.dirRecords.length;i++)this.push({data:this.dirRecords[i],meta:{percent:100}});var r=this.bytesWritten-t,A=function(t,i,r,A,g){var b=d.transformTo("string",g(A));return I.CENTRAL_DIRECTORY_END+"\0\0\0\0"+decToHex(t,2)+decToHex(t,2)+decToHex(i,4)+decToHex(r,4)+decToHex(b.length,2)+b}(this.dirRecords.length,r,t,this.zipComment,this.encodeFileName);this.push({data:A,meta:{percent:100}})},ZipFileWorker.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},ZipFileWorker.prototype.registerPrevious=function(t){this._sources.push(t);var i=this;return t.on("data",(function(t){i.processChunk(t)})),t.on("end",(function(){i.closedSource(i.previous.streamInfo),i._sources.length?i.prepareNextSource():i.end()})),t.on("error",(function(t){i.error(t)})),this},ZipFileWorker.prototype.resume=function(){return!!A.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},ZipFileWorker.prototype.error=function(t){var i=this._sources;if(!A.prototype.error.call(this,t))return!1;for(var r=0;r<i.length;r++)try{i[r].error(t)}catch(t){}return!0},ZipFileWorker.prototype.lock=function(){A.prototype.lock.call(this);for(var t=this._sources,i=0;i<t.length;i++)t[i].lock()},i.exports=ZipFileWorker},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,i,r){var d=t("../compressions"),A=t("./ZipFileWorker");r.generateWorker=function(t,i,r){var g=new A(i.streamFiles,r,i.platform,i.encodeFileName),b=0;try{t.forEach((function(t,r){b++;var A=function(t,i){var r=t||i,A=d[r];if(!A)throw new Error(r+" is not a valid compression method !");return A}(r.options.compression,i.compression),I=r.options.compressionOptions||i.compressionOptions||{},w=r.dir,C=r.date;r._compressWorker(A,I).withStreamInfo("file",{name:t,dir:w,date:C,comment:r.comment||"",unixPermissions:r.unixPermissions,dosPermissions:r.dosPermissions}).pipe(g)})),g.entriesCount=b}catch(t){g.error(t)}return g}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,i,r){function JSZip(){if(!(this instanceof JSZip))return new JSZip;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var t=new JSZip;for(var i in this)"function"!=typeof this[i]&&(t[i]=this[i]);return t}}JSZip.prototype=t("./object"),JSZip.prototype.loadAsync=t("./load"),JSZip.support=t("./support"),JSZip.defaults=t("./defaults"),JSZip.version="3.10.1",JSZip.loadAsync=function(t,i){return(new JSZip).loadAsync(t,i)},JSZip.external=t("./external"),i.exports=JSZip},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,i,r){var d=t("./utils"),A=t("./external"),g=t("./utf8"),b=t("./zipEntries"),I=t("./stream/Crc32Probe"),w=t("./nodejsUtils");function checkEntryCRC32(t){return new A.Promise((function(i,r){var d=t.decompressed.getContentWorker().pipe(new I);d.on("error",(function(t){r(t)})).on("end",(function(){d.streamInfo.crc32!==t.decompressed.crc32?r(new Error("Corrupted zip : CRC32 mismatch")):i()})).resume()}))}i.exports=function(t,i){var r=this;return i=d.extend(i||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:g.utf8decode}),w.isNode&&w.isStream(t)?A.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):d.prepareContent("the loaded zip file",t,!0,i.optimizedBinaryString,i.base64).then((function(t){var r=new b(i);return r.load(t),r})).then((function(t){var r=[A.Promise.resolve(t)],d=t.files;if(i.checkCRC32)for(var g=0;g<d.length;g++)r.push(checkEntryCRC32(d[g]));return A.Promise.all(r)})).then((function(t){for(var A=t.shift(),g=A.files,b=0;b<g.length;b++){var I=g[b],w=I.fileNameStr,C=d.resolve(I.fileNameStr);r.file(C,I.decompressed,{binary:!0,optimizedBinaryString:!0,date:I.date,dir:I.dir,comment:I.fileCommentStr.length?I.fileCommentStr:null,unixPermissions:I.unixPermissions,dosPermissions:I.dosPermissions,createFolders:i.createFolders}),I.dir||(r.file(C).unsafeOriginalName=w)}return A.zipComment.length&&(r.comment=A.zipComment),r}))}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,i,r){var d=t("../utils"),A=t("../stream/GenericWorker");function NodejsStreamInputAdapter(t,i){A.call(this,"Nodejs stream input adapter for "+t),this._upstreamEnded=!1,this._bindStream(i)}d.inherits(NodejsStreamInputAdapter,A),NodejsStreamInputAdapter.prototype._bindStream=function(t){var i=this;this._stream=t,t.pause(),t.on("data",(function(t){i.push({data:t,meta:{percent:0}})})).on("error",(function(t){i.isPaused?this.generatedError=t:i.error(t)})).on("end",(function(){i.isPaused?i._upstreamEnded=!0:i.end()}))},NodejsStreamInputAdapter.prototype.pause=function(){return!!A.prototype.pause.call(this)&&(this._stream.pause(),!0)},NodejsStreamInputAdapter.prototype.resume=function(){return!!A.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},i.exports=NodejsStreamInputAdapter},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,i,r){var d=t("readable-stream").Readable;function NodejsStreamOutputAdapter(t,i,r){d.call(this,i),this._helper=t;var A=this;t.on("data",(function(t,i){A.push(t)||A._helper.pause(),r&&r(i)})).on("error",(function(t){A.emit("error",t)})).on("end",(function(){A.push(null)}))}t("../utils").inherits(NodejsStreamOutputAdapter,d),NodejsStreamOutputAdapter.prototype._read=function(){this._helper.resume()},i.exports=NodejsStreamOutputAdapter},{"../utils":32,"readable-stream":16}],14:[function(t,i,r){i.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(t,i){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(t,i);if("number"==typeof t)throw new Error('The "data" argument must not be a number');return new Buffer(t,i)},allocBuffer:function(t){if(Buffer.alloc)return Buffer.alloc(t);var i=new Buffer(t);return i.fill(0),i},isBuffer:function(t){return Buffer.isBuffer(t)},isStream:function(t){return t&&"function"==typeof t.on&&"function"==typeof t.pause&&"function"==typeof t.resume}}},{}],15:[function(t,i,r){var d=t("./utf8"),A=t("./utils"),g=t("./stream/GenericWorker"),b=t("./stream/StreamHelper"),I=t("./defaults"),w=t("./compressedObject"),C=t("./zipObject"),B=t("./generate"),S=t("./nodejsUtils"),T=t("./nodejs/NodejsStreamInputAdapter"),fileAdd=function(t,i,r){var d,b=A.getTypeOf(i),B=A.extend(r||{},I);B.date=B.date||new Date,null!==B.compression&&(B.compression=B.compression.toUpperCase()),"string"==typeof B.unixPermissions&&(B.unixPermissions=parseInt(B.unixPermissions,8)),B.unixPermissions&&16384&B.unixPermissions&&(B.dir=!0),B.dosPermissions&&16&B.dosPermissions&&(B.dir=!0),B.dir&&(t=forceTrailingSlash(t)),B.createFolders&&(d=parentFolder(t))&&folderAdd.call(this,d,!0);var x="string"===b&&!1===B.binary&&!1===B.base64;r&&void 0!==r.binary||(B.binary=!x),(i instanceof w&&0===i.uncompressedSize||B.dir||!i||0===i.length)&&(B.base64=!1,B.binary=!0,i="",B.compression="STORE",b="string");var M=null;M=i instanceof w||i instanceof g?i:S.isNode&&S.isStream(i)?new T(t,i):A.prepareContent(t,i,B.binary,B.optimizedBinaryString,B.base64);var P=new C(t,M,B);this.files[t]=P},parentFolder=function(t){"/"===t.slice(-1)&&(t=t.substring(0,t.length-1));var i=t.lastIndexOf("/");return i>0?t.substring(0,i):""},forceTrailingSlash=function(t){return"/"!==t.slice(-1)&&(t+="/"),t},folderAdd=function(t,i){return i=void 0!==i?i:I.createFolders,t=forceTrailingSlash(t),this.files[t]||fileAdd.call(this,t,null,{dir:!0,createFolders:i}),this.files[t]};function isRegExp(t){return"[object RegExp]"===Object.prototype.toString.call(t)}var x={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(t){var i,r,d;for(i in this.files)d=this.files[i],(r=i.slice(this.root.length,i.length))&&i.slice(0,this.root.length)===this.root&&t(r,d)},filter:function(t){var i=[];return this.forEach((function(r,d){t(r,d)&&i.push(d)})),i},file:function(t,i,r){if(1===arguments.length){if(isRegExp(t)){var d=t;return this.filter((function(t,i){return!i.dir&&d.test(t)}))}var A=this.files[this.root+t];return A&&!A.dir?A:null}return t=this.root+t,fileAdd.call(this,t,i,r),this},folder:function(t){if(!t)return this;if(isRegExp(t))return this.filter((function(i,r){return r.dir&&t.test(i)}));var i=this.root+t,r=folderAdd.call(this,i),d=this.clone();return d.root=r.name,d},remove:function(t){t=this.root+t;var i=this.files[t];if(i||("/"!==t.slice(-1)&&(t+="/"),i=this.files[t]),i&&!i.dir)delete this.files[t];else for(var r=this.filter((function(i,r){return r.name.slice(0,t.length)===t})),d=0;d<r.length;d++)delete this.files[r[d].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(t){var i,r={};try{if((r=A.extend(t||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:d.utf8encode})).type=r.type.toLowerCase(),r.compression=r.compression.toUpperCase(),"binarystring"===r.type&&(r.type="string"),!r.type)throw new Error("No output type specified.");A.checkSupport(r.type),"darwin"!==r.platform&&"freebsd"!==r.platform&&"linux"!==r.platform&&"sunos"!==r.platform||(r.platform="UNIX"),"win32"===r.platform&&(r.platform="DOS");var I=r.comment||this.comment||"";i=B.generateWorker(this,r,I)}catch(t){(i=new g("error")).error(t)}return new b(i,r.type||"string",r.mimeType)},generateAsync:function(t,i){return this.generateInternalStream(t).accumulate(i)},generateNodeStream:function(t,i){return(t=t||{}).type||(t.type="nodebuffer"),this.generateInternalStream(t).toNodejsStream(i)}};i.exports=x},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,i,r){i.exports=t("stream")},{stream:void 0}],17:[function(t,i,r){var d=t("./DataReader");function ArrayReader(t){d.call(this,t);for(var i=0;i<this.data.length;i++)t[i]=255&t[i]}t("../utils").inherits(ArrayReader,d),ArrayReader.prototype.byteAt=function(t){return this.data[this.zero+t]},ArrayReader.prototype.lastIndexOfSignature=function(t){for(var i=t.charCodeAt(0),r=t.charCodeAt(1),d=t.charCodeAt(2),A=t.charCodeAt(3),g=this.length-4;g>=0;--g)if(this.data[g]===i&&this.data[g+1]===r&&this.data[g+2]===d&&this.data[g+3]===A)return g-this.zero;return-1},ArrayReader.prototype.readAndCheckSignature=function(t){var i=t.charCodeAt(0),r=t.charCodeAt(1),d=t.charCodeAt(2),A=t.charCodeAt(3),g=this.readData(4);return i===g[0]&&r===g[1]&&d===g[2]&&A===g[3]},ArrayReader.prototype.readData=function(t){if(this.checkOffset(t),0===t)return[];var i=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,i},i.exports=ArrayReader},{"../utils":32,"./DataReader":18}],18:[function(t,i,r){var d=t("../utils");function DataReader(t){this.data=t,this.length=t.length,this.index=0,this.zero=0}DataReader.prototype={checkOffset:function(t){this.checkIndex(this.index+t)},checkIndex:function(t){if(this.length<this.zero+t||t<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+t+"). Corrupted zip ?")},setIndex:function(t){this.checkIndex(t),this.index=t},skip:function(t){this.setIndex(this.index+t)},byteAt:function(){},readInt:function(t){var i,r=0;for(this.checkOffset(t),i=this.index+t-1;i>=this.index;i--)r=(r<<8)+this.byteAt(i);return this.index+=t,r},readString:function(t){return d.transformTo("string",this.readData(t))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var t=this.readInt(4);return new Date(Date.UTC(1980+(t>>25&127),(t>>21&15)-1,t>>16&31,t>>11&31,t>>5&63,(31&t)<<1))}},i.exports=DataReader},{"../utils":32}],19:[function(t,i,r){var d=t("./Uint8ArrayReader");function NodeBufferReader(t){d.call(this,t)}t("../utils").inherits(NodeBufferReader,d),NodeBufferReader.prototype.readData=function(t){this.checkOffset(t);var i=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,i},i.exports=NodeBufferReader},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,i,r){var d=t("./DataReader");function StringReader(t){d.call(this,t)}t("../utils").inherits(StringReader,d),StringReader.prototype.byteAt=function(t){return this.data.charCodeAt(this.zero+t)},StringReader.prototype.lastIndexOfSignature=function(t){return this.data.lastIndexOf(t)-this.zero},StringReader.prototype.readAndCheckSignature=function(t){return t===this.readData(4)},StringReader.prototype.readData=function(t){this.checkOffset(t);var i=this.data.slice(this.zero+this.index,this.zero+this.index+t);return this.index+=t,i},i.exports=StringReader},{"../utils":32,"./DataReader":18}],21:[function(t,i,r){var d=t("./ArrayReader");function Uint8ArrayReader(t){d.call(this,t)}t("../utils").inherits(Uint8ArrayReader,d),Uint8ArrayReader.prototype.readData=function(t){if(this.checkOffset(t),0===t)return new Uint8Array(0);var i=this.data.subarray(this.zero+this.index,this.zero+this.index+t);return this.index+=t,i},i.exports=Uint8ArrayReader},{"../utils":32,"./ArrayReader":17}],22:[function(t,i,r){var d=t("../utils"),A=t("../support"),g=t("./ArrayReader"),b=t("./StringReader"),I=t("./NodeBufferReader"),w=t("./Uint8ArrayReader");i.exports=function(t){var i=d.getTypeOf(t);return d.checkSupport(i),"string"!==i||A.uint8array?"nodebuffer"===i?new I(t):A.uint8array?new w(d.transformTo("uint8array",t)):new g(d.transformTo("array",t)):new b(t)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,i,r){r.LOCAL_FILE_HEADER="PK",r.CENTRAL_FILE_HEADER="PK",r.CENTRAL_DIRECTORY_END="PK",r.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",r.ZIP64_CENTRAL_DIRECTORY_END="PK",r.DATA_DESCRIPTOR="PK\b"},{}],24:[function(t,i,r){var d=t("./GenericWorker"),A=t("../utils");function ConvertWorker(t){d.call(this,"ConvertWorker to "+t),this.destType=t}A.inherits(ConvertWorker,d),ConvertWorker.prototype.processChunk=function(t){this.push({data:A.transformTo(this.destType,t.data),meta:t.meta})},i.exports=ConvertWorker},{"../utils":32,"./GenericWorker":28}],25:[function(t,i,r){var d=t("./GenericWorker"),A=t("../crc32");function Crc32Probe(){d.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(Crc32Probe,d),Crc32Probe.prototype.processChunk=function(t){this.streamInfo.crc32=A(t.data,this.streamInfo.crc32||0),this.push(t)},i.exports=Crc32Probe},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,i,r){var d=t("../utils"),A=t("./GenericWorker");function DataLengthProbe(t){A.call(this,"DataLengthProbe for "+t),this.propName=t,this.withStreamInfo(t,0)}d.inherits(DataLengthProbe,A),DataLengthProbe.prototype.processChunk=function(t){if(t){var i=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=i+t.data.length}A.prototype.processChunk.call(this,t)},i.exports=DataLengthProbe},{"../utils":32,"./GenericWorker":28}],27:[function(t,i,r){var d=t("../utils"),A=t("./GenericWorker");function DataWorker(t){A.call(this,"DataWorker");var i=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,t.then((function(t){i.dataIsReady=!0,i.data=t,i.max=t&&t.length||0,i.type=d.getTypeOf(t),i.isPaused||i._tickAndRepeat()}),(function(t){i.error(t)}))}d.inherits(DataWorker,A),DataWorker.prototype.cleanUp=function(){A.prototype.cleanUp.call(this),this.data=null},DataWorker.prototype.resume=function(){return!!A.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,d.delay(this._tickAndRepeat,[],this)),!0)},DataWorker.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(d.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},DataWorker.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var t=null,i=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":t=this.data.substring(this.index,i);break;case"uint8array":t=this.data.subarray(this.index,i);break;case"array":case"nodebuffer":t=this.data.slice(this.index,i)}return this.index=i,this.push({data:t,meta:{percent:this.max?this.index/this.max*100:0}})},i.exports=DataWorker},{"../utils":32,"./GenericWorker":28}],28:[function(t,i,r){function GenericWorker(t){this.name=t||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}GenericWorker.prototype={push:function(t){this.emit("data",t)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(t){this.emit("error",t)}return!0},error:function(t){return!this.isFinished&&(this.isPaused?this.generatedError=t:(this.isFinished=!0,this.emit("error",t),this.previous&&this.previous.error(t),this.cleanUp()),!0)},on:function(t,i){return this._listeners[t].push(i),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(t,i){if(this._listeners[t])for(var r=0;r<this._listeners[t].length;r++)this._listeners[t][r].call(this,i)},pipe:function(t){return t.registerPrevious(this)},registerPrevious:function(t){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=t.streamInfo,this.mergeStreamInfo(),this.previous=t;var i=this;return t.on("data",(function(t){i.processChunk(t)})),t.on("end",(function(){i.end()})),t.on("error",(function(t){i.error(t)})),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var t=!1;return this.generatedError&&(this.error(this.generatedError),t=!0),this.previous&&this.previous.resume(),!t},flush:function(){},processChunk:function(t){this.push(t)},withStreamInfo:function(t,i){return this.extraStreamInfo[t]=i,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var t in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,t)&&(this.streamInfo[t]=this.extraStreamInfo[t])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var t="Worker "+this.name;return this.previous?this.previous+" -> "+t:t}},i.exports=GenericWorker},{}],29:[function(t,i,r){var d=t("../utils"),A=t("./ConvertWorker"),g=t("./GenericWorker"),b=t("../base64"),I=t("../support"),w=t("../external"),C=null;if(I.nodestream)try{C=t("../nodejs/NodejsStreamOutputAdapter")}catch(t){}function accumulate(t,i){return new w.Promise((function(r,A){var g=[],I=t._internalType,w=t._outputType,C=t._mimeType;t.on("data",(function(t,r){g.push(t),i&&i(r)})).on("error",(function(t){g=[],A(t)})).on("end",(function(){try{var t=function(t,i,r){switch(t){case"blob":return d.newBlob(d.transformTo("arraybuffer",i),r);case"base64":return b.encode(i);default:return d.transformTo(t,i)}}(w,function(t,i){var r,d=0,A=null,g=0;for(r=0;r<i.length;r++)g+=i[r].length;switch(t){case"string":return i.join("");case"array":return Array.prototype.concat.apply([],i);case"uint8array":for(A=new Uint8Array(g),r=0;r<i.length;r++)A.set(i[r],d),d+=i[r].length;return A;case"nodebuffer":return Buffer.concat(i);default:throw new Error("concat : unsupported type '"+t+"'")}}(I,g),C);r(t)}catch(t){A(t)}g=[]})).resume()}))}function StreamHelper(t,i,r){var b=i;switch(i){case"blob":case"arraybuffer":b="uint8array";break;case"base64":b="string"}try{this._internalType=b,this._outputType=i,this._mimeType=r,d.checkSupport(b),this._worker=t.pipe(new A(b)),t.lock()}catch(t){this._worker=new g("error"),this._worker.error(t)}}StreamHelper.prototype={accumulate:function(t){return accumulate(this,t)},on:function(t,i){var r=this;return"data"===t?this._worker.on(t,(function(t){i.call(r,t.data,t.meta)})):this._worker.on(t,(function(){d.delay(i,arguments,r)})),this},resume:function(){return d.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(t){if(d.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new C(this,{objectMode:"nodebuffer"!==this._outputType},t)}},i.exports=StreamHelper},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,i,r){if(r.base64=!0,r.array=!0,r.string=!0,r.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,r.nodebuffer="undefined"!=typeof Buffer,r.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)r.blob=!1;else{var d=new ArrayBuffer(0);try{r.blob=0===new Blob([d],{type:"application/zip"}).size}catch(t){try{var A=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);A.append(d),r.blob=0===A.getBlob("application/zip").size}catch(t){r.blob=!1}}}try{r.nodestream=!!t("readable-stream").Readable}catch(t){r.nodestream=!1}},{"readable-stream":16}],31:[function(t,i,r){for(var d=t("./utils"),A=t("./support"),g=t("./nodejsUtils"),b=t("./stream/GenericWorker"),I=new Array(256),w=0;w<256;w++)I[w]=w>=252?6:w>=248?5:w>=240?4:w>=224?3:w>=192?2:1;I[254]=I[254]=1;function Utf8DecodeWorker(){b.call(this,"utf-8 decode"),this.leftOver=null}function Utf8EncodeWorker(){b.call(this,"utf-8 encode")}r.utf8encode=function(t){return A.nodebuffer?g.newBufferFrom(t,"utf-8"):function(t){var i,r,d,g,b,I=t.length,w=0;for(g=0;g<I;g++)55296==(64512&(r=t.charCodeAt(g)))&&g+1<I&&56320==(64512&(d=t.charCodeAt(g+1)))&&(r=65536+(r-55296<<10)+(d-56320),g++),w+=r<128?1:r<2048?2:r<65536?3:4;for(i=A.uint8array?new Uint8Array(w):new Array(w),b=0,g=0;b<w;g++)55296==(64512&(r=t.charCodeAt(g)))&&g+1<I&&56320==(64512&(d=t.charCodeAt(g+1)))&&(r=65536+(r-55296<<10)+(d-56320),g++),r<128?i[b++]=r:r<2048?(i[b++]=192|r>>>6,i[b++]=128|63&r):r<65536?(i[b++]=224|r>>>12,i[b++]=128|r>>>6&63,i[b++]=128|63&r):(i[b++]=240|r>>>18,i[b++]=128|r>>>12&63,i[b++]=128|r>>>6&63,i[b++]=128|63&r);return i}(t)},r.utf8decode=function(t){return A.nodebuffer?d.transformTo("nodebuffer",t).toString("utf-8"):function(t){var i,r,A,g,b=t.length,w=new Array(2*b);for(r=0,i=0;i<b;)if((A=t[i++])<128)w[r++]=A;else if((g=I[A])>4)w[r++]=65533,i+=g-1;else{for(A&=2===g?31:3===g?15:7;g>1&&i<b;)A=A<<6|63&t[i++],g--;g>1?w[r++]=65533:A<65536?w[r++]=A:(A-=65536,w[r++]=55296|A>>10&1023,w[r++]=56320|1023&A)}return w.length!==r&&(w.subarray?w=w.subarray(0,r):w.length=r),d.applyFromCharCode(w)}(t=d.transformTo(A.uint8array?"uint8array":"array",t))},d.inherits(Utf8DecodeWorker,b),Utf8DecodeWorker.prototype.processChunk=function(t){var i=d.transformTo(A.uint8array?"uint8array":"array",t.data);if(this.leftOver&&this.leftOver.length){if(A.uint8array){var g=i;(i=new Uint8Array(g.length+this.leftOver.length)).set(this.leftOver,0),i.set(g,this.leftOver.length)}else i=this.leftOver.concat(i);this.leftOver=null}var b=function(t,i){var r;for((i=i||t.length)>t.length&&(i=t.length),r=i-1;r>=0&&128==(192&t[r]);)r--;return r<0||0===r?i:r+I[t[r]]>i?r:i}(i),w=i;b!==i.length&&(A.uint8array?(w=i.subarray(0,b),this.leftOver=i.subarray(b,i.length)):(w=i.slice(0,b),this.leftOver=i.slice(b,i.length))),this.push({data:r.utf8decode(w),meta:t.meta})},Utf8DecodeWorker.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:r.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},r.Utf8DecodeWorker=Utf8DecodeWorker,d.inherits(Utf8EncodeWorker,b),Utf8EncodeWorker.prototype.processChunk=function(t){this.push({data:r.utf8encode(t.data),meta:t.meta})},r.Utf8EncodeWorker=Utf8EncodeWorker},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,i,r){var d=t("./support"),A=t("./base64"),g=t("./nodejsUtils"),b=t("./external");function identity(t){return t}function stringToArrayLike(t,i){for(var r=0;r<t.length;++r)i[r]=255&t.charCodeAt(r);return i}t("setimmediate"),r.newBlob=function(t,i){r.checkSupport("blob");try{return new Blob([t],{type:i})}catch(r){try{var d=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return d.append(t),d.getBlob(i)}catch(t){throw new Error("Bug : can't construct the Blob.")}}};var I={stringifyByChunk:function(t,i,r){var d=[],A=0,g=t.length;if(g<=r)return String.fromCharCode.apply(null,t);for(;A<g;)"array"===i||"nodebuffer"===i?d.push(String.fromCharCode.apply(null,t.slice(A,Math.min(A+r,g)))):d.push(String.fromCharCode.apply(null,t.subarray(A,Math.min(A+r,g)))),A+=r;return d.join("")},stringifyByChar:function(t){for(var i="",r=0;r<t.length;r++)i+=String.fromCharCode(t[r]);return i},applyCanBeUsed:{uint8array:function(){try{return d.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(t){return!1}}(),nodebuffer:function(){try{return d.nodebuffer&&1===String.fromCharCode.apply(null,g.allocBuffer(1)).length}catch(t){return!1}}()}};function arrayLikeToString(t){var i=65536,d=r.getTypeOf(t),A=!0;if("uint8array"===d?A=I.applyCanBeUsed.uint8array:"nodebuffer"===d&&(A=I.applyCanBeUsed.nodebuffer),A)for(;i>1;)try{return I.stringifyByChunk(t,d,i)}catch(t){i=Math.floor(i/2)}return I.stringifyByChar(t)}function arrayLikeToArrayLike(t,i){for(var r=0;r<t.length;r++)i[r]=t[r];return i}r.applyFromCharCode=arrayLikeToString;var w={};w.string={string:identity,array:function(t){return stringToArrayLike(t,new Array(t.length))},arraybuffer:function(t){return w.string.uint8array(t).buffer},uint8array:function(t){return stringToArrayLike(t,new Uint8Array(t.length))},nodebuffer:function(t){return stringToArrayLike(t,g.allocBuffer(t.length))}},w.array={string:arrayLikeToString,array:identity,arraybuffer:function(t){return new Uint8Array(t).buffer},uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return g.newBufferFrom(t)}},w.arraybuffer={string:function(t){return arrayLikeToString(new Uint8Array(t))},array:function(t){return arrayLikeToArrayLike(new Uint8Array(t),new Array(t.byteLength))},arraybuffer:identity,uint8array:function(t){return new Uint8Array(t)},nodebuffer:function(t){return g.newBufferFrom(new Uint8Array(t))}},w.uint8array={string:arrayLikeToString,array:function(t){return arrayLikeToArrayLike(t,new Array(t.length))},arraybuffer:function(t){return t.buffer},uint8array:identity,nodebuffer:function(t){return g.newBufferFrom(t)}},w.nodebuffer={string:arrayLikeToString,array:function(t){return arrayLikeToArrayLike(t,new Array(t.length))},arraybuffer:function(t){return w.nodebuffer.uint8array(t).buffer},uint8array:function(t){return arrayLikeToArrayLike(t,new Uint8Array(t.length))},nodebuffer:identity},r.transformTo=function(t,i){if(i||(i=""),!t)return i;r.checkSupport(t);var d=r.getTypeOf(i);return w[d][t](i)},r.resolve=function(t){for(var i=t.split("/"),r=[],d=0;d<i.length;d++){var A=i[d];"."===A||""===A&&0!==d&&d!==i.length-1||(".."===A?r.pop():r.push(A))}return r.join("/")},r.getTypeOf=function(t){return"string"==typeof t?"string":"[object Array]"===Object.prototype.toString.call(t)?"array":d.nodebuffer&&g.isBuffer(t)?"nodebuffer":d.uint8array&&t instanceof Uint8Array?"uint8array":d.arraybuffer&&t instanceof ArrayBuffer?"arraybuffer":void 0},r.checkSupport=function(t){if(!d[t.toLowerCase()])throw new Error(t+" is not supported by this platform")},r.MAX_VALUE_16BITS=65535,r.MAX_VALUE_32BITS=-1,r.pretty=function(t){var i,r,d="";for(r=0;r<(t||"").length;r++)d+="\\x"+((i=t.charCodeAt(r))<16?"0":"")+i.toString(16).toUpperCase();return d},r.delay=function(t,i,r){setImmediate((function(){t.apply(r||null,i||[])}))},r.inherits=function(t,i){var Obj=function(){};Obj.prototype=i.prototype,t.prototype=new Obj},r.extend=function(){var t,i,r={};for(t=0;t<arguments.length;t++)for(i in arguments[t])Object.prototype.hasOwnProperty.call(arguments[t],i)&&void 0===r[i]&&(r[i]=arguments[t][i]);return r},r.prepareContent=function(t,i,g,I,w){return b.Promise.resolve(i).then((function(t){return d.blob&&(t instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(t)))&&"undefined"!=typeof FileReader?new b.Promise((function(i,r){var d=new FileReader;d.onload=function(t){i(t.target.result)},d.onerror=function(t){r(t.target.error)},d.readAsArrayBuffer(t)})):t})).then((function(i){var C,B=r.getTypeOf(i);return B?("arraybuffer"===B?i=r.transformTo("uint8array",i):"string"===B&&(w?i=A.decode(i):g&&!0!==I&&(i=stringToArrayLike(C=i,d.uint8array?new Uint8Array(C.length):new Array(C.length)))),i):b.Promise.reject(new Error("Can't read the data of '"+t+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))}))}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,i,r){var d=t("./reader/readerFor"),A=t("./utils"),g=t("./signature"),b=t("./zipEntry"),I=t("./support");function ZipEntries(t){this.files=[],this.loadOptions=t}ZipEntries.prototype={checkSignature:function(t){if(!this.reader.readAndCheckSignature(t)){this.reader.index-=4;var i=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+A.pretty(i)+", expected "+A.pretty(t)+")")}},isSignature:function(t,i){var r=this.reader.index;this.reader.setIndex(t);var d=this.reader.readString(4)===i;return this.reader.setIndex(r),d},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var t=this.reader.readData(this.zipCommentLength),i=I.uint8array?"uint8array":"array",r=A.transformTo(i,t);this.zipComment=this.loadOptions.decodeFileName(r)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var t,i,r,d=this.zip64EndOfCentralSize-44;0<d;)t=this.reader.readInt(2),i=this.reader.readInt(4),r=this.reader.readData(i),this.zip64ExtensibleData[t]={id:t,length:i,value:r}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var t,i;for(t=0;t<this.files.length;t++)i=this.files[t],this.reader.setIndex(i.localHeaderOffset),this.checkSignature(g.LOCAL_FILE_HEADER),i.readLocalPart(this.reader),i.handleUTF8(),i.processAttributes()},readCentralDir:function(){var t;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(g.CENTRAL_FILE_HEADER);)(t=new b({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(t);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var t=this.reader.lastIndexOfSignature(g.CENTRAL_DIRECTORY_END);if(t<0)throw!this.isSignature(0,g.LOCAL_FILE_HEADER)?new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip: can't find end of central directory");this.reader.setIndex(t);var i=t;if(this.checkSignature(g.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===A.MAX_VALUE_16BITS||this.diskWithCentralDirStart===A.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===A.MAX_VALUE_16BITS||this.centralDirRecords===A.MAX_VALUE_16BITS||this.centralDirSize===A.MAX_VALUE_32BITS||this.centralDirOffset===A.MAX_VALUE_32BITS){if(this.zip64=!0,(t=this.reader.lastIndexOfSignature(g.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(t),this.checkSignature(g.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,g.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(g.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(g.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var r=this.centralDirOffset+this.centralDirSize;this.zip64&&(r+=20,r+=12+this.zip64EndOfCentralSize);var d=i-r;if(d>0)this.isSignature(i,g.CENTRAL_FILE_HEADER)||(this.reader.zero=d);else if(d<0)throw new Error("Corrupted zip: missing "+Math.abs(d)+" bytes.")},prepareReader:function(t){this.reader=d(t)},load:function(t){this.prepareReader(t),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},i.exports=ZipEntries},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,i,r){var d=t("./reader/readerFor"),A=t("./utils"),g=t("./compressedObject"),b=t("./crc32"),I=t("./utf8"),w=t("./compressions"),C=t("./support");function ZipEntry(t,i){this.options=t,this.loadOptions=i}ZipEntry.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(t){var i,r;if(t.skip(22),this.fileNameLength=t.readInt(2),r=t.readInt(2),this.fileName=t.readData(this.fileNameLength),t.skip(r),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(i=function(t){for(var i in w)if(Object.prototype.hasOwnProperty.call(w,i)&&w[i].magic===t)return w[i];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+A.pretty(this.compressionMethod)+" unknown (inner file : "+A.transformTo("string",this.fileName)+")");this.decompressed=new g(this.compressedSize,this.uncompressedSize,this.crc32,i,t.readData(this.compressedSize))},readCentralPart:function(t){this.versionMadeBy=t.readInt(2),t.skip(2),this.bitFlag=t.readInt(2),this.compressionMethod=t.readString(2),this.date=t.readDate(),this.crc32=t.readInt(4),this.compressedSize=t.readInt(4),this.uncompressedSize=t.readInt(4);var i=t.readInt(2);if(this.extraFieldsLength=t.readInt(2),this.fileCommentLength=t.readInt(2),this.diskNumberStart=t.readInt(2),this.internalFileAttributes=t.readInt(2),this.externalFileAttributes=t.readInt(4),this.localHeaderOffset=t.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");t.skip(i),this.readExtraFields(t),this.parseZIP64ExtraField(t),this.fileComment=t.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var t=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0===t&&(this.dosPermissions=63&this.externalFileAttributes),3===t&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var t=d(this.extraFields[1].value);this.uncompressedSize===A.MAX_VALUE_32BITS&&(this.uncompressedSize=t.readInt(8)),this.compressedSize===A.MAX_VALUE_32BITS&&(this.compressedSize=t.readInt(8)),this.localHeaderOffset===A.MAX_VALUE_32BITS&&(this.localHeaderOffset=t.readInt(8)),this.diskNumberStart===A.MAX_VALUE_32BITS&&(this.diskNumberStart=t.readInt(4))}},readExtraFields:function(t){var i,r,d,A=t.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});t.index+4<A;)i=t.readInt(2),r=t.readInt(2),d=t.readData(r),this.extraFields[i]={id:i,length:r,value:d};t.setIndex(A)},handleUTF8:function(){var t=C.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=I.utf8decode(this.fileName),this.fileCommentStr=I.utf8decode(this.fileComment);else{var i=this.findExtraFieldUnicodePath();if(null!==i)this.fileNameStr=i;else{var r=A.transformTo(t,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(r)}var d=this.findExtraFieldUnicodeComment();if(null!==d)this.fileCommentStr=d;else{var g=A.transformTo(t,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(g)}}},findExtraFieldUnicodePath:function(){var t=this.extraFields[28789];if(t){var i=d(t.value);return 1!==i.readInt(1)||b(this.fileName)!==i.readInt(4)?null:I.utf8decode(i.readData(t.length-5))}return null},findExtraFieldUnicodeComment:function(){var t=this.extraFields[25461];if(t){var i=d(t.value);return 1!==i.readInt(1)||b(this.fileComment)!==i.readInt(4)?null:I.utf8decode(i.readData(t.length-5))}return null}},i.exports=ZipEntry},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,i,r){var d=t("./stream/StreamHelper"),A=t("./stream/DataWorker"),g=t("./utf8"),b=t("./compressedObject"),I=t("./stream/GenericWorker"),ZipObject=function(t,i,r){this.name=t,this.dir=r.dir,this.date=r.date,this.comment=r.comment,this.unixPermissions=r.unixPermissions,this.dosPermissions=r.dosPermissions,this._data=i,this._dataBinary=r.binary,this.options={compression:r.compression,compressionOptions:r.compressionOptions}};ZipObject.prototype={internalStream:function(t){var i=null,r="string";try{if(!t)throw new Error("No output type specified.");var A="string"===(r=t.toLowerCase())||"text"===r;"binarystring"!==r&&"text"!==r||(r="string"),i=this._decompressWorker();var b=!this._dataBinary;b&&!A&&(i=i.pipe(new g.Utf8EncodeWorker)),!b&&A&&(i=i.pipe(new g.Utf8DecodeWorker))}catch(t){(i=new I("error")).error(t)}return new d(i,r,"")},async:function(t,i){return this.internalStream(t).accumulate(i)},nodeStream:function(t,i){return this.internalStream(t||"nodebuffer").toNodejsStream(i)},_compressWorker:function(t,i){if(this._data instanceof b&&this._data.compression.magic===t.magic)return this._data.getCompressedWorker();var r=this._decompressWorker();return this._dataBinary||(r=r.pipe(new g.Utf8EncodeWorker)),b.createWorkerFrom(r,t,i)},_decompressWorker:function(){return this._data instanceof b?this._data.getContentWorker():this._data instanceof I?this._data:new A(this._data)}};for(var w=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],removedFn=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},C=0;C<w.length;C++)ZipObject.prototype[w[C]]=removedFn;i.exports=ZipObject},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,i,r){(function(t){var r,d,A=t.MutationObserver||t.WebKitMutationObserver;if(A){var g=0,b=new A(nextTick),I=t.document.createTextNode("");b.observe(I,{characterData:!0}),r=function(){I.data=g=++g%2}}else if(t.setImmediate||void 0===t.MessageChannel)r="document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var i=t.document.createElement("script");i.onreadystatechange=function(){nextTick(),i.onreadystatechange=null,i.parentNode.removeChild(i),i=null},t.document.documentElement.appendChild(i)}:function(){setTimeout(nextTick,0)};else{var w=new t.MessageChannel;w.port1.onmessage=nextTick,r=function(){w.port2.postMessage(0)}}var C=[];function nextTick(){var t,i;d=!0;for(var r=C.length;r;){for(i=C,C=[],t=-1;++t<r;)i[t]();r=C.length}d=!1}i.exports=function(t){1!==C.push(t)||d||r()}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(t,i,r){var d=t("immediate");function INTERNAL(){}var A={},g=["REJECTED"],b=["FULFILLED"],I=["PENDING"];function Promise(t){if("function"!=typeof t)throw new TypeError("resolver must be a function");this.state=I,this.queue=[],this.outcome=void 0,t!==INTERNAL&&safelyResolveThenable(this,t)}function QueueItem(t,i,r){this.promise=t,"function"==typeof i&&(this.onFulfilled=i,this.callFulfilled=this.otherCallFulfilled),"function"==typeof r&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}function unwrap(t,i,r){d((function(){var d;try{d=i(r)}catch(i){return A.reject(t,i)}d===t?A.reject(t,new TypeError("Cannot resolve promise with itself")):A.resolve(t,d)}))}function getThen(t){var i=t&&t.then;if(t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof i)return function(){i.apply(t,arguments)}}function safelyResolveThenable(t,i){var r=!1;function onError(i){r||(r=!0,A.reject(t,i))}function onSuccess(i){r||(r=!0,A.resolve(t,i))}var d=tryCatch((function(){i(onSuccess,onError)}));"error"===d.status&&onError(d.value)}function tryCatch(t,i){var r={};try{r.value=t(i),r.status="success"}catch(t){r.status="error",r.value=t}return r}i.exports=Promise,Promise.prototype.finally=function(t){if("function"!=typeof t)return this;var i=this.constructor;return this.then((function(r){return i.resolve(t()).then((function(){return r}))}),(function(r){return i.resolve(t()).then((function(){throw r}))}))},Promise.prototype.catch=function(t){return this.then(null,t)},Promise.prototype.then=function(t,i){if("function"!=typeof t&&this.state===b||"function"!=typeof i&&this.state===g)return this;var r=new this.constructor(INTERNAL);this.state!==I?unwrap(r,this.state===b?t:i,this.outcome):this.queue.push(new QueueItem(r,t,i));return r},QueueItem.prototype.callFulfilled=function(t){A.resolve(this.promise,t)},QueueItem.prototype.otherCallFulfilled=function(t){unwrap(this.promise,this.onFulfilled,t)},QueueItem.prototype.callRejected=function(t){A.reject(this.promise,t)},QueueItem.prototype.otherCallRejected=function(t){unwrap(this.promise,this.onRejected,t)},A.resolve=function(t,i){var r=tryCatch(getThen,i);if("error"===r.status)return A.reject(t,r.value);var d=r.value;if(d)safelyResolveThenable(t,d);else{t.state=b,t.outcome=i;for(var g=-1,I=t.queue.length;++g<I;)t.queue[g].callFulfilled(i)}return t},A.reject=function(t,i){t.state=g,t.outcome=i;for(var r=-1,d=t.queue.length;++r<d;)t.queue[r].callRejected(i);return t},Promise.resolve=function(t){if(t instanceof this)return t;return A.resolve(new this(INTERNAL),t)},Promise.reject=function(t){var i=new this(INTERNAL);return A.reject(i,t)},Promise.all=function(t){var i=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var r=t.length,d=!1;if(!r)return this.resolve([]);var g=new Array(r),b=0,I=-1,w=new this(INTERNAL);for(;++I<r;)allResolver(t[I],I);return w;function allResolver(t,I){i.resolve(t).then((function(t){g[I]=t,++b!==r||d||(d=!0,A.resolve(w,g))}),(function(t){d||(d=!0,A.reject(w,t))}))}},Promise.race=function(t){var i=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var r=t.length,d=!1;if(!r)return this.resolve([]);var g=-1,b=new this(INTERNAL);for(;++g<r;)I=t[g],i.resolve(I).then((function(t){d||(d=!0,A.resolve(b,t))}),(function(t){d||(d=!0,A.reject(b,t))}));var I;return b}},{immediate:36}],38:[function(t,i,r){var d={};(0,t("./lib/utils/common").assign)(d,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),i.exports=d},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,i,r){var d=t("./zlib/deflate"),A=t("./utils/common"),g=t("./utils/strings"),b=t("./zlib/messages"),I=t("./zlib/zstream"),w=Object.prototype.toString,C=0,B=-1,S=0,T=8;function Deflate(t){if(!(this instanceof Deflate))return new Deflate(t);this.options=A.assign({level:B,method:T,chunkSize:16384,windowBits:15,memLevel:8,strategy:S,to:""},t||{});var i=this.options;i.raw&&i.windowBits>0?i.windowBits=-i.windowBits:i.gzip&&i.windowBits>0&&i.windowBits<16&&(i.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new I,this.strm.avail_out=0;var r=d.deflateInit2(this.strm,i.level,i.method,i.windowBits,i.memLevel,i.strategy);if(r!==C)throw new Error(b[r]);if(i.header&&d.deflateSetHeader(this.strm,i.header),i.dictionary){var x;if(x="string"==typeof i.dictionary?g.string2buf(i.dictionary):"[object ArrayBuffer]"===w.call(i.dictionary)?new Uint8Array(i.dictionary):i.dictionary,(r=d.deflateSetDictionary(this.strm,x))!==C)throw new Error(b[r]);this._dict_set=!0}}function deflate(t,i){var r=new Deflate(i);if(r.push(t,!0),r.err)throw r.msg||b[r.err];return r.result}Deflate.prototype.push=function(t,i){var r,b,I=this.strm,B=this.options.chunkSize;if(this.ended)return!1;b=i===~~i?i:!0===i?4:0,"string"==typeof t?I.input=g.string2buf(t):"[object ArrayBuffer]"===w.call(t)?I.input=new Uint8Array(t):I.input=t,I.next_in=0,I.avail_in=I.input.length;do{if(0===I.avail_out&&(I.output=new A.Buf8(B),I.next_out=0,I.avail_out=B),1!==(r=d.deflate(I,b))&&r!==C)return this.onEnd(r),this.ended=!0,!1;0!==I.avail_out&&(0!==I.avail_in||4!==b&&2!==b)||("string"===this.options.to?this.onData(g.buf2binstring(A.shrinkBuf(I.output,I.next_out))):this.onData(A.shrinkBuf(I.output,I.next_out)))}while((I.avail_in>0||0===I.avail_out)&&1!==r);return 4===b?(r=d.deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===C):2!==b||(this.onEnd(C),I.avail_out=0,!0)},Deflate.prototype.onData=function(t){this.chunks.push(t)},Deflate.prototype.onEnd=function(t){t===C&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=A.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},r.Deflate=Deflate,r.deflate=deflate,r.deflateRaw=function(t,i){return(i=i||{}).raw=!0,deflate(t,i)},r.gzip=function(t,i){return(i=i||{}).gzip=!0,deflate(t,i)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,i,r){var d=t("./zlib/inflate"),A=t("./utils/common"),g=t("./utils/strings"),b=t("./zlib/constants"),I=t("./zlib/messages"),w=t("./zlib/zstream"),C=t("./zlib/gzheader"),B=Object.prototype.toString;function Inflate(t){if(!(this instanceof Inflate))return new Inflate(t);this.options=A.assign({chunkSize:16384,windowBits:0,to:""},t||{});var i=this.options;i.raw&&i.windowBits>=0&&i.windowBits<16&&(i.windowBits=-i.windowBits,0===i.windowBits&&(i.windowBits=-15)),!(i.windowBits>=0&&i.windowBits<16)||t&&t.windowBits||(i.windowBits+=32),i.windowBits>15&&i.windowBits<48&&0==(15&i.windowBits)&&(i.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new w,this.strm.avail_out=0;var r=d.inflateInit2(this.strm,i.windowBits);if(r!==b.Z_OK)throw new Error(I[r]);this.header=new C,d.inflateGetHeader(this.strm,this.header)}function inflate(t,i){var r=new Inflate(i);if(r.push(t,!0),r.err)throw r.msg||I[r.err];return r.result}Inflate.prototype.push=function(t,i){var r,I,w,C,S,T,x=this.strm,M=this.options.chunkSize,P=this.options.dictionary,D=!1;if(this.ended)return!1;I=i===~~i?i:!0===i?b.Z_FINISH:b.Z_NO_FLUSH,"string"==typeof t?x.input=g.binstring2buf(t):"[object ArrayBuffer]"===B.call(t)?x.input=new Uint8Array(t):x.input=t,x.next_in=0,x.avail_in=x.input.length;do{if(0===x.avail_out&&(x.output=new A.Buf8(M),x.next_out=0,x.avail_out=M),(r=d.inflate(x,b.Z_NO_FLUSH))===b.Z_NEED_DICT&&P&&(T="string"==typeof P?g.string2buf(P):"[object ArrayBuffer]"===B.call(P)?new Uint8Array(P):P,r=d.inflateSetDictionary(this.strm,T)),r===b.Z_BUF_ERROR&&!0===D&&(r=b.Z_OK,D=!1),r!==b.Z_STREAM_END&&r!==b.Z_OK)return this.onEnd(r),this.ended=!0,!1;x.next_out&&(0!==x.avail_out&&r!==b.Z_STREAM_END&&(0!==x.avail_in||I!==b.Z_FINISH&&I!==b.Z_SYNC_FLUSH)||("string"===this.options.to?(w=g.utf8border(x.output,x.next_out),C=x.next_out-w,S=g.buf2string(x.output,w),x.next_out=C,x.avail_out=M-C,C&&A.arraySet(x.output,x.output,w,C,0),this.onData(S)):this.onData(A.shrinkBuf(x.output,x.next_out)))),0===x.avail_in&&0===x.avail_out&&(D=!0)}while((x.avail_in>0||0===x.avail_out)&&r!==b.Z_STREAM_END);return r===b.Z_STREAM_END&&(I=b.Z_FINISH),I===b.Z_FINISH?(r=d.inflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===b.Z_OK):I!==b.Z_SYNC_FLUSH||(this.onEnd(b.Z_OK),x.avail_out=0,!0)},Inflate.prototype.onData=function(t){this.chunks.push(t)},Inflate.prototype.onEnd=function(t){t===b.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=A.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg},r.Inflate=Inflate,r.inflate=inflate,r.inflateRaw=function(t,i){return(i=i||{}).raw=!0,inflate(t,i)},r.ungzip=inflate},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,i,r){var d="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;r.assign=function(t){for(var i=Array.prototype.slice.call(arguments,1);i.length;){var r=i.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(var d in r)r.hasOwnProperty(d)&&(t[d]=r[d])}}return t},r.shrinkBuf=function(t,i){return t.length===i?t:t.subarray?t.subarray(0,i):(t.length=i,t)};var A={arraySet:function(t,i,r,d,A){if(i.subarray&&t.subarray)t.set(i.subarray(r,r+d),A);else for(var g=0;g<d;g++)t[A+g]=i[r+g]},flattenChunks:function(t){var i,r,d,A,g,b;for(d=0,i=0,r=t.length;i<r;i++)d+=t[i].length;for(b=new Uint8Array(d),A=0,i=0,r=t.length;i<r;i++)g=t[i],b.set(g,A),A+=g.length;return b}},g={arraySet:function(t,i,r,d,A){for(var g=0;g<d;g++)t[A+g]=i[r+g]},flattenChunks:function(t){return[].concat.apply([],t)}};r.setTyped=function(t){t?(r.Buf8=Uint8Array,r.Buf16=Uint16Array,r.Buf32=Int32Array,r.assign(r,A)):(r.Buf8=Array,r.Buf16=Array,r.Buf32=Array,r.assign(r,g))},r.setTyped(d)},{}],42:[function(t,i,r){var d=t("./common"),A=!0,g=!0;try{String.fromCharCode.apply(null,[0])}catch(t){A=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){g=!1}for(var b=new d.Buf8(256),I=0;I<256;I++)b[I]=I>=252?6:I>=248?5:I>=240?4:I>=224?3:I>=192?2:1;function buf2binstring(t,i){if(i<65537&&(t.subarray&&g||!t.subarray&&A))return String.fromCharCode.apply(null,d.shrinkBuf(t,i));for(var r="",b=0;b<i;b++)r+=String.fromCharCode(t[b]);return r}b[254]=b[254]=1,r.string2buf=function(t){var i,r,A,g,b,I=t.length,w=0;for(g=0;g<I;g++)55296==(64512&(r=t.charCodeAt(g)))&&g+1<I&&56320==(64512&(A=t.charCodeAt(g+1)))&&(r=65536+(r-55296<<10)+(A-56320),g++),w+=r<128?1:r<2048?2:r<65536?3:4;for(i=new d.Buf8(w),b=0,g=0;b<w;g++)55296==(64512&(r=t.charCodeAt(g)))&&g+1<I&&56320==(64512&(A=t.charCodeAt(g+1)))&&(r=65536+(r-55296<<10)+(A-56320),g++),r<128?i[b++]=r:r<2048?(i[b++]=192|r>>>6,i[b++]=128|63&r):r<65536?(i[b++]=224|r>>>12,i[b++]=128|r>>>6&63,i[b++]=128|63&r):(i[b++]=240|r>>>18,i[b++]=128|r>>>12&63,i[b++]=128|r>>>6&63,i[b++]=128|63&r);return i},r.buf2binstring=function(t){return buf2binstring(t,t.length)},r.binstring2buf=function(t){for(var i=new d.Buf8(t.length),r=0,A=i.length;r<A;r++)i[r]=t.charCodeAt(r);return i},r.buf2string=function(t,i){var r,d,A,g,I=i||t.length,w=new Array(2*I);for(d=0,r=0;r<I;)if((A=t[r++])<128)w[d++]=A;else if((g=b[A])>4)w[d++]=65533,r+=g-1;else{for(A&=2===g?31:3===g?15:7;g>1&&r<I;)A=A<<6|63&t[r++],g--;g>1?w[d++]=65533:A<65536?w[d++]=A:(A-=65536,w[d++]=55296|A>>10&1023,w[d++]=56320|1023&A)}return buf2binstring(w,d)},r.utf8border=function(t,i){var r;for((i=i||t.length)>t.length&&(i=t.length),r=i-1;r>=0&&128==(192&t[r]);)r--;return r<0||0===r?i:r+b[t[r]]>i?r:i}},{"./common":41}],43:[function(t,i,r){i.exports=function(t,i,r,d){for(var A=65535&t|0,g=t>>>16&65535|0,b=0;0!==r;){r-=b=r>2e3?2e3:r;do{g=g+(A=A+i[d++]|0)|0}while(--b);A%=65521,g%=65521}return A|g<<16|0}},{}],44:[function(t,i,r){i.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,i,r){var d=function(){for(var t,i=[],r=0;r<256;r++){t=r;for(var d=0;d<8;d++)t=1&t?3988292384^t>>>1:t>>>1;i[r]=t}return i}();i.exports=function(t,i,r,A){var g=d,b=A+r;t^=-1;for(var I=A;I<b;I++)t=t>>>8^g[255&(t^i[I])];return-1^t}},{}],46:[function(t,i,r){var d,A=t("../utils/common"),g=t("./trees"),b=t("./adler32"),I=t("./crc32"),w=t("./messages"),C=0,B=1,S=3,T=4,x=5,M=0,P=1,D=-2,Q=-3,F=-5,R=-1,L=1,O=2,U=3,N=4,H=0,G=2,j=8,V=9,Y=15,W=8,X=286,K=30,Z=19,q=2*X+1,J=15,$=3,ee=258,te=ee+$+1,ie=32,se=42,ne=69,re=73,ae=91,oe=103,le=113,he=666,de=1,ce=2,Ae=3,ue=4,pe=3;function err(t,i){return t.msg=w[i],i}function rank(t){return(t<<1)-(t>4?9:0)}function zero(t){for(var i=t.length;--i>=0;)t[i]=0}function flush_pending(t){var i=t.state,r=i.pending;r>t.avail_out&&(r=t.avail_out),0!==r&&(A.arraySet(t.output,i.pending_buf,i.pending_out,r,t.next_out),t.next_out+=r,i.pending_out+=r,t.total_out+=r,t.avail_out-=r,i.pending-=r,0===i.pending&&(i.pending_out=0))}function flush_block_only(t,i){g._tr_flush_block(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,i),t.block_start=t.strstart,flush_pending(t.strm)}function put_byte(t,i){t.pending_buf[t.pending++]=i}function putShortMSB(t,i){t.pending_buf[t.pending++]=i>>>8&255,t.pending_buf[t.pending++]=255&i}function read_buf(t,i,r,d){var g=t.avail_in;return g>d&&(g=d),0===g?0:(t.avail_in-=g,A.arraySet(i,t.input,t.next_in,g,r),1===t.state.wrap?t.adler=b(t.adler,i,g,r):2===t.state.wrap&&(t.adler=I(t.adler,i,g,r)),t.next_in+=g,t.total_in+=g,g)}function longest_match(t,i){var r,d,A=t.max_chain_length,g=t.strstart,b=t.prev_length,I=t.nice_match,w=t.strstart>t.w_size-te?t.strstart-(t.w_size-te):0,C=t.window,B=t.w_mask,S=t.prev,T=t.strstart+ee,x=C[g+b-1],M=C[g+b];t.prev_length>=t.good_match&&(A>>=2),I>t.lookahead&&(I=t.lookahead);do{if(C[(r=i)+b]===M&&C[r+b-1]===x&&C[r]===C[g]&&C[++r]===C[g+1]){g+=2,r++;do{}while(C[++g]===C[++r]&&C[++g]===C[++r]&&C[++g]===C[++r]&&C[++g]===C[++r]&&C[++g]===C[++r]&&C[++g]===C[++r]&&C[++g]===C[++r]&&C[++g]===C[++r]&&g<T);if(d=ee-(T-g),g=T-ee,d>b){if(t.match_start=i,b=d,d>=I)break;x=C[g+b-1],M=C[g+b]}}}while((i=S[i&B])>w&&0!=--A);return b<=t.lookahead?b:t.lookahead}function fill_window(t){var i,r,d,g,b,I=t.w_size;do{if(g=t.window_size-t.lookahead-t.strstart,t.strstart>=I+(I-te)){A.arraySet(t.window,t.window,I,I,0),t.match_start-=I,t.strstart-=I,t.block_start-=I,i=r=t.hash_size;do{d=t.head[--i],t.head[i]=d>=I?d-I:0}while(--r);i=r=I;do{d=t.prev[--i],t.prev[i]=d>=I?d-I:0}while(--r);g+=I}if(0===t.strm.avail_in)break;if(r=read_buf(t.strm,t.window,t.strstart+t.lookahead,g),t.lookahead+=r,t.lookahead+t.insert>=$)for(b=t.strstart-t.insert,t.ins_h=t.window[b],t.ins_h=(t.ins_h<<t.hash_shift^t.window[b+1])&t.hash_mask;t.insert&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[b+$-1])&t.hash_mask,t.prev[b&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=b,b++,t.insert--,!(t.lookahead+t.insert<$)););}while(t.lookahead<te&&0!==t.strm.avail_in)}function deflate_fast(t,i){for(var r,d;;){if(t.lookahead<te){if(fill_window(t),t.lookahead<te&&i===C)return de;if(0===t.lookahead)break}if(r=0,t.lookahead>=$&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+$-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==r&&t.strstart-r<=t.w_size-te&&(t.match_length=longest_match(t,r)),t.match_length>=$)if(d=g._tr_tally(t,t.strstart-t.match_start,t.match_length-$),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=$){t.match_length--;do{t.strstart++,t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+$-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+1])&t.hash_mask;else d=g._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(d&&(flush_block_only(t,!1),0===t.strm.avail_out))return de}return t.insert=t.strstart<$-1?t.strstart:$-1,i===T?(flush_block_only(t,!0),0===t.strm.avail_out?Ae:ue):t.last_lit&&(flush_block_only(t,!1),0===t.strm.avail_out)?de:ce}function deflate_slow(t,i){for(var r,d,A;;){if(t.lookahead<te){if(fill_window(t),t.lookahead<te&&i===C)return de;if(0===t.lookahead)break}if(r=0,t.lookahead>=$&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+$-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=$-1,0!==r&&t.prev_length<t.max_lazy_match&&t.strstart-r<=t.w_size-te&&(t.match_length=longest_match(t,r),t.match_length<=5&&(t.strategy===L||t.match_length===$&&t.strstart-t.match_start>4096)&&(t.match_length=$-1)),t.prev_length>=$&&t.match_length<=t.prev_length){A=t.strstart+t.lookahead-$,d=g._tr_tally(t,t.strstart-1-t.prev_match,t.prev_length-$),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=A&&(t.ins_h=(t.ins_h<<t.hash_shift^t.window[t.strstart+$-1])&t.hash_mask,r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=$-1,t.strstart++,d&&(flush_block_only(t,!1),0===t.strm.avail_out))return de}else if(t.match_available){if((d=g._tr_tally(t,0,t.window[t.strstart-1]))&&flush_block_only(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return de}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(d=g._tr_tally(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<$-1?t.strstart:$-1,i===T?(flush_block_only(t,!0),0===t.strm.avail_out?Ae:ue):t.last_lit&&(flush_block_only(t,!1),0===t.strm.avail_out)?de:ce}function Config(t,i,r,d,A){this.good_length=t,this.max_lazy=i,this.nice_length=r,this.max_chain=d,this.func=A}function DeflateState(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=j,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new A.Buf16(2*q),this.dyn_dtree=new A.Buf16(2*(2*K+1)),this.bl_tree=new A.Buf16(2*(2*Z+1)),zero(this.dyn_ltree),zero(this.dyn_dtree),zero(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new A.Buf16(J+1),this.heap=new A.Buf16(2*X+1),zero(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new A.Buf16(2*X+1),zero(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function deflateResetKeep(t){var i;return t&&t.state?(t.total_in=t.total_out=0,t.data_type=G,(i=t.state).pending=0,i.pending_out=0,i.wrap<0&&(i.wrap=-i.wrap),i.status=i.wrap?se:le,t.adler=2===i.wrap?0:1,i.last_flush=C,g._tr_init(i),M):err(t,D)}function deflateReset(t){var i,r=deflateResetKeep(t);return r===M&&((i=t.state).window_size=2*i.w_size,zero(i.head),i.max_lazy_match=d[i.level].max_lazy,i.good_match=d[i.level].good_length,i.nice_match=d[i.level].nice_length,i.max_chain_length=d[i.level].max_chain,i.strstart=0,i.block_start=0,i.lookahead=0,i.insert=0,i.match_length=i.prev_length=$-1,i.match_available=0,i.ins_h=0),r}function deflateInit2(t,i,r,d,g,b){if(!t)return D;var I=1;if(i===R&&(i=6),d<0?(I=0,d=-d):d>15&&(I=2,d-=16),g<1||g>V||r!==j||d<8||d>15||i<0||i>9||b<0||b>N)return err(t,D);8===d&&(d=9);var w=new DeflateState;return t.state=w,w.strm=t,w.wrap=I,w.gzhead=null,w.w_bits=d,w.w_size=1<<w.w_bits,w.w_mask=w.w_size-1,w.hash_bits=g+7,w.hash_size=1<<w.hash_bits,w.hash_mask=w.hash_size-1,w.hash_shift=~~((w.hash_bits+$-1)/$),w.window=new A.Buf8(2*w.w_size),w.head=new A.Buf16(w.hash_size),w.prev=new A.Buf16(w.w_size),w.lit_bufsize=1<<g+6,w.pending_buf_size=4*w.lit_bufsize,w.pending_buf=new A.Buf8(w.pending_buf_size),w.d_buf=1*w.lit_bufsize,w.l_buf=3*w.lit_bufsize,w.level=i,w.strategy=b,w.method=r,deflateReset(t)}d=[new Config(0,0,0,0,(function(t,i){var r=65535;for(r>t.pending_buf_size-5&&(r=t.pending_buf_size-5);;){if(t.lookahead<=1){if(fill_window(t),0===t.lookahead&&i===C)return de;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;var d=t.block_start+r;if((0===t.strstart||t.strstart>=d)&&(t.lookahead=t.strstart-d,t.strstart=d,flush_block_only(t,!1),0===t.strm.avail_out))return de;if(t.strstart-t.block_start>=t.w_size-te&&(flush_block_only(t,!1),0===t.strm.avail_out))return de}return t.insert=0,i===T?(flush_block_only(t,!0),0===t.strm.avail_out?Ae:ue):(t.strstart>t.block_start&&(flush_block_only(t,!1),t.strm.avail_out),de)})),new Config(4,4,8,4,deflate_fast),new Config(4,5,16,8,deflate_fast),new Config(4,6,32,32,deflate_fast),new Config(4,4,16,16,deflate_slow),new Config(8,16,32,32,deflate_slow),new Config(8,16,128,128,deflate_slow),new Config(8,32,128,256,deflate_slow),new Config(32,128,258,1024,deflate_slow),new Config(32,258,258,4096,deflate_slow)],r.deflateInit=function(t,i){return deflateInit2(t,i,j,Y,W,H)},r.deflateInit2=deflateInit2,r.deflateReset=deflateReset,r.deflateResetKeep=deflateResetKeep,r.deflateSetHeader=function(t,i){return t&&t.state?2!==t.state.wrap?D:(t.state.gzhead=i,M):D},r.deflate=function(t,i){var r,A,b,w;if(!t||!t.state||i>x||i<0)return t?err(t,D):D;if(A=t.state,!t.output||!t.input&&0!==t.avail_in||A.status===he&&i!==T)return err(t,0===t.avail_out?F:D);if(A.strm=t,r=A.last_flush,A.last_flush=i,A.status===se)if(2===A.wrap)t.adler=0,put_byte(A,31),put_byte(A,139),put_byte(A,8),A.gzhead?(put_byte(A,(A.gzhead.text?1:0)+(A.gzhead.hcrc?2:0)+(A.gzhead.extra?4:0)+(A.gzhead.name?8:0)+(A.gzhead.comment?16:0)),put_byte(A,255&A.gzhead.time),put_byte(A,A.gzhead.time>>8&255),put_byte(A,A.gzhead.time>>16&255),put_byte(A,A.gzhead.time>>24&255),put_byte(A,9===A.level?2:A.strategy>=O||A.level<2?4:0),put_byte(A,255&A.gzhead.os),A.gzhead.extra&&A.gzhead.extra.length&&(put_byte(A,255&A.gzhead.extra.length),put_byte(A,A.gzhead.extra.length>>8&255)),A.gzhead.hcrc&&(t.adler=I(t.adler,A.pending_buf,A.pending,0)),A.gzindex=0,A.status=ne):(put_byte(A,0),put_byte(A,0),put_byte(A,0),put_byte(A,0),put_byte(A,0),put_byte(A,9===A.level?2:A.strategy>=O||A.level<2?4:0),put_byte(A,pe),A.status=le);else{var Q=j+(A.w_bits-8<<4)<<8;Q|=(A.strategy>=O||A.level<2?0:A.level<6?1:6===A.level?2:3)<<6,0!==A.strstart&&(Q|=ie),Q+=31-Q%31,A.status=le,putShortMSB(A,Q),0!==A.strstart&&(putShortMSB(A,t.adler>>>16),putShortMSB(A,65535&t.adler)),t.adler=1}if(A.status===ne)if(A.gzhead.extra){for(b=A.pending;A.gzindex<(65535&A.gzhead.extra.length)&&(A.pending!==A.pending_buf_size||(A.gzhead.hcrc&&A.pending>b&&(t.adler=I(t.adler,A.pending_buf,A.pending-b,b)),flush_pending(t),b=A.pending,A.pending!==A.pending_buf_size));)put_byte(A,255&A.gzhead.extra[A.gzindex]),A.gzindex++;A.gzhead.hcrc&&A.pending>b&&(t.adler=I(t.adler,A.pending_buf,A.pending-b,b)),A.gzindex===A.gzhead.extra.length&&(A.gzindex=0,A.status=re)}else A.status=re;if(A.status===re)if(A.gzhead.name){b=A.pending;do{if(A.pending===A.pending_buf_size&&(A.gzhead.hcrc&&A.pending>b&&(t.adler=I(t.adler,A.pending_buf,A.pending-b,b)),flush_pending(t),b=A.pending,A.pending===A.pending_buf_size)){w=1;break}w=A.gzindex<A.gzhead.name.length?255&A.gzhead.name.charCodeAt(A.gzindex++):0,put_byte(A,w)}while(0!==w);A.gzhead.hcrc&&A.pending>b&&(t.adler=I(t.adler,A.pending_buf,A.pending-b,b)),0===w&&(A.gzindex=0,A.status=ae)}else A.status=ae;if(A.status===ae)if(A.gzhead.comment){b=A.pending;do{if(A.pending===A.pending_buf_size&&(A.gzhead.hcrc&&A.pending>b&&(t.adler=I(t.adler,A.pending_buf,A.pending-b,b)),flush_pending(t),b=A.pending,A.pending===A.pending_buf_size)){w=1;break}w=A.gzindex<A.gzhead.comment.length?255&A.gzhead.comment.charCodeAt(A.gzindex++):0,put_byte(A,w)}while(0!==w);A.gzhead.hcrc&&A.pending>b&&(t.adler=I(t.adler,A.pending_buf,A.pending-b,b)),0===w&&(A.status=oe)}else A.status=oe;if(A.status===oe&&(A.gzhead.hcrc?(A.pending+2>A.pending_buf_size&&flush_pending(t),A.pending+2<=A.pending_buf_size&&(put_byte(A,255&t.adler),put_byte(A,t.adler>>8&255),t.adler=0,A.status=le)):A.status=le),0!==A.pending){if(flush_pending(t),0===t.avail_out)return A.last_flush=-1,M}else if(0===t.avail_in&&rank(i)<=rank(r)&&i!==T)return err(t,F);if(A.status===he&&0!==t.avail_in)return err(t,F);if(0!==t.avail_in||0!==A.lookahead||i!==C&&A.status!==he){var R=A.strategy===O?function(t,i){for(var r;;){if(0===t.lookahead&&(fill_window(t),0===t.lookahead)){if(i===C)return de;break}if(t.match_length=0,r=g._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,r&&(flush_block_only(t,!1),0===t.strm.avail_out))return de}return t.insert=0,i===T?(flush_block_only(t,!0),0===t.strm.avail_out?Ae:ue):t.last_lit&&(flush_block_only(t,!1),0===t.strm.avail_out)?de:ce}(A,i):A.strategy===U?function(t,i){for(var r,d,A,b,I=t.window;;){if(t.lookahead<=ee){if(fill_window(t),t.lookahead<=ee&&i===C)return de;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=$&&t.strstart>0&&(d=I[A=t.strstart-1])===I[++A]&&d===I[++A]&&d===I[++A]){b=t.strstart+ee;do{}while(d===I[++A]&&d===I[++A]&&d===I[++A]&&d===I[++A]&&d===I[++A]&&d===I[++A]&&d===I[++A]&&d===I[++A]&&A<b);t.match_length=ee-(b-A),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=$?(r=g._tr_tally(t,1,t.match_length-$),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(r=g._tr_tally(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),r&&(flush_block_only(t,!1),0===t.strm.avail_out))return de}return t.insert=0,i===T?(flush_block_only(t,!0),0===t.strm.avail_out?Ae:ue):t.last_lit&&(flush_block_only(t,!1),0===t.strm.avail_out)?de:ce}(A,i):d[A.level].func(A,i);if(R!==Ae&&R!==ue||(A.status=he),R===de||R===Ae)return 0===t.avail_out&&(A.last_flush=-1),M;if(R===ce&&(i===B?g._tr_align(A):i!==x&&(g._tr_stored_block(A,0,0,!1),i===S&&(zero(A.head),0===A.lookahead&&(A.strstart=0,A.block_start=0,A.insert=0))),flush_pending(t),0===t.avail_out))return A.last_flush=-1,M}return i!==T?M:A.wrap<=0?P:(2===A.wrap?(put_byte(A,255&t.adler),put_byte(A,t.adler>>8&255),put_byte(A,t.adler>>16&255),put_byte(A,t.adler>>24&255),put_byte(A,255&t.total_in),put_byte(A,t.total_in>>8&255),put_byte(A,t.total_in>>16&255),put_byte(A,t.total_in>>24&255)):(putShortMSB(A,t.adler>>>16),putShortMSB(A,65535&t.adler)),flush_pending(t),A.wrap>0&&(A.wrap=-A.wrap),0!==A.pending?M:P)},r.deflateEnd=function(t){var i;return t&&t.state?(i=t.state.status)!==se&&i!==ne&&i!==re&&i!==ae&&i!==oe&&i!==le&&i!==he?err(t,D):(t.state=null,i===le?err(t,Q):M):D},r.deflateSetDictionary=function(t,i){var r,d,g,I,w,C,B,S,T=i.length;if(!t||!t.state)return D;if(2===(I=(r=t.state).wrap)||1===I&&r.status!==se||r.lookahead)return D;for(1===I&&(t.adler=b(t.adler,i,T,0)),r.wrap=0,T>=r.w_size&&(0===I&&(zero(r.head),r.strstart=0,r.block_start=0,r.insert=0),S=new A.Buf8(r.w_size),A.arraySet(S,i,T-r.w_size,r.w_size,0),i=S,T=r.w_size),w=t.avail_in,C=t.next_in,B=t.input,t.avail_in=T,t.next_in=0,t.input=i,fill_window(r);r.lookahead>=$;){d=r.strstart,g=r.lookahead-($-1);do{r.ins_h=(r.ins_h<<r.hash_shift^r.window[d+$-1])&r.hash_mask,r.prev[d&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=d,d++}while(--g);r.strstart=d,r.lookahead=$-1,fill_window(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=$-1,r.match_available=0,t.next_in=C,t.input=B,t.avail_in=w,r.wrap=I,M},r.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,i,r){i.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,i,r){i.exports=function(t,i){var r,d,A,g,b,I,w,C,B,S,T,x,M,P,D,Q,F,R,L,O,U,N,H,G,j;r=t.state,d=t.next_in,G=t.input,A=d+(t.avail_in-5),g=t.next_out,j=t.output,b=g-(i-t.avail_out),I=g+(t.avail_out-257),w=r.dmax,C=r.wsize,B=r.whave,S=r.wnext,T=r.window,x=r.hold,M=r.bits,P=r.lencode,D=r.distcode,Q=(1<<r.lenbits)-1,F=(1<<r.distbits)-1;e:do{M<15&&(x+=G[d++]<<M,M+=8,x+=G[d++]<<M,M+=8),R=P[x&Q];t:for(;;){if(x>>>=L=R>>>24,M-=L,0===(L=R>>>16&255))j[g++]=65535&R;else{if(!(16&L)){if(0==(64&L)){R=P[(65535&R)+(x&(1<<L)-1)];continue t}if(32&L){r.mode=12;break e}t.msg="invalid literal/length code",r.mode=30;break e}O=65535&R,(L&=15)&&(M<L&&(x+=G[d++]<<M,M+=8),O+=x&(1<<L)-1,x>>>=L,M-=L),M<15&&(x+=G[d++]<<M,M+=8,x+=G[d++]<<M,M+=8),R=D[x&F];i:for(;;){if(x>>>=L=R>>>24,M-=L,!(16&(L=R>>>16&255))){if(0==(64&L)){R=D[(65535&R)+(x&(1<<L)-1)];continue i}t.msg="invalid distance code",r.mode=30;break e}if(U=65535&R,M<(L&=15)&&(x+=G[d++]<<M,(M+=8)<L&&(x+=G[d++]<<M,M+=8)),(U+=x&(1<<L)-1)>w){t.msg="invalid distance too far back",r.mode=30;break e}if(x>>>=L,M-=L,U>(L=g-b)){if((L=U-L)>B&&r.sane){t.msg="invalid distance too far back",r.mode=30;break e}if(N=0,H=T,0===S){if(N+=C-L,L<O){O-=L;do{j[g++]=T[N++]}while(--L);N=g-U,H=j}}else if(S<L){if(N+=C+S-L,(L-=S)<O){O-=L;do{j[g++]=T[N++]}while(--L);if(N=0,S<O){O-=L=S;do{j[g++]=T[N++]}while(--L);N=g-U,H=j}}}else if(N+=S-L,L<O){O-=L;do{j[g++]=T[N++]}while(--L);N=g-U,H=j}for(;O>2;)j[g++]=H[N++],j[g++]=H[N++],j[g++]=H[N++],O-=3;O&&(j[g++]=H[N++],O>1&&(j[g++]=H[N++]))}else{N=g-U;do{j[g++]=j[N++],j[g++]=j[N++],j[g++]=j[N++],O-=3}while(O>2);O&&(j[g++]=j[N++],O>1&&(j[g++]=j[N++]))}break}}break}}while(d<A&&g<I);d-=O=M>>3,x&=(1<<(M-=O<<3))-1,t.next_in=d,t.next_out=g,t.avail_in=d<A?A-d+5:5-(d-A),t.avail_out=g<I?I-g+257:257-(g-I),r.hold=x,r.bits=M}},{}],49:[function(t,i,r){var d=t("../utils/common"),A=t("./adler32"),g=t("./crc32"),b=t("./inffast"),I=t("./inftrees"),w=0,C=1,B=2,S=4,T=5,x=6,M=0,P=1,D=2,Q=-2,F=-3,R=-4,L=-5,O=8,U=1,N=2,H=3,G=4,j=5,V=6,Y=7,W=8,X=9,K=10,Z=11,q=12,J=13,$=14,ee=15,te=16,ie=17,se=18,ne=19,re=20,ae=21,oe=22,le=23,he=24,de=25,ce=26,Ae=27,ue=28,pe=29,ge=30,me=31,_e=852,fe=592,be=15;function zswap32(t){return(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24)}function InflateState(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new d.Buf16(320),this.work=new d.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function inflateResetKeep(t){var i;return t&&t.state?(i=t.state,t.total_in=t.total_out=i.total=0,t.msg="",i.wrap&&(t.adler=1&i.wrap),i.mode=U,i.last=0,i.havedict=0,i.dmax=32768,i.head=null,i.hold=0,i.bits=0,i.lencode=i.lendyn=new d.Buf32(_e),i.distcode=i.distdyn=new d.Buf32(fe),i.sane=1,i.back=-1,M):Q}function inflateReset(t){var i;return t&&t.state?((i=t.state).wsize=0,i.whave=0,i.wnext=0,inflateResetKeep(t)):Q}function inflateReset2(t,i){var r,d;return t&&t.state?(d=t.state,i<0?(r=0,i=-i):(r=1+(i>>4),i<48&&(i&=15)),i&&(i<8||i>15)?Q:(null!==d.window&&d.wbits!==i&&(d.window=null),d.wrap=r,d.wbits=i,inflateReset(t))):Q}function inflateInit2(t,i){var r,d;return t?(d=new InflateState,t.state=d,d.window=null,(r=inflateReset2(t,i))!==M&&(t.state=null),r):Q}var Ie,we,ye=!0;function fixedtables(t){if(ye){var i;for(Ie=new d.Buf32(512),we=new d.Buf32(32),i=0;i<144;)t.lens[i++]=8;for(;i<256;)t.lens[i++]=9;for(;i<280;)t.lens[i++]=7;for(;i<288;)t.lens[i++]=8;for(I(C,t.lens,0,288,Ie,0,t.work,{bits:9}),i=0;i<32;)t.lens[i++]=5;I(B,t.lens,0,32,we,0,t.work,{bits:5}),ye=!1}t.lencode=Ie,t.lenbits=9,t.distcode=we,t.distbits=5}function updatewindow(t,i,r,A){var g,b=t.state;return null===b.window&&(b.wsize=1<<b.wbits,b.wnext=0,b.whave=0,b.window=new d.Buf8(b.wsize)),A>=b.wsize?(d.arraySet(b.window,i,r-b.wsize,b.wsize,0),b.wnext=0,b.whave=b.wsize):((g=b.wsize-b.wnext)>A&&(g=A),d.arraySet(b.window,i,r-A,g,b.wnext),(A-=g)?(d.arraySet(b.window,i,r-A,A,0),b.wnext=A,b.whave=b.wsize):(b.wnext+=g,b.wnext===b.wsize&&(b.wnext=0),b.whave<b.wsize&&(b.whave+=g))),0}r.inflateReset=inflateReset,r.inflateReset2=inflateReset2,r.inflateResetKeep=inflateResetKeep,r.inflateInit=function(t){return inflateInit2(t,be)},r.inflateInit2=inflateInit2,r.inflate=function(t,i){var r,_e,fe,be,Ie,we,ye,Ce,Be,ve,Ee,Se,Te,xe,Me,Pe,ke,De,Qe,Fe,Re,Le,Oe,Ue,Ne=0,He=new d.Buf8(4),Ge=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return Q;(r=t.state).mode===q&&(r.mode=J),Ie=t.next_out,fe=t.output,ye=t.avail_out,be=t.next_in,_e=t.input,we=t.avail_in,Ce=r.hold,Be=r.bits,ve=we,Ee=ye,Le=M;e:for(;;)switch(r.mode){case U:if(0===r.wrap){r.mode=J;break}for(;Be<16;){if(0===we)break e;we--,Ce+=_e[be++]<<Be,Be+=8}if(2&r.wrap&&35615===Ce){r.check=0,He[0]=255&Ce,He[1]=Ce>>>8&255,r.check=g(r.check,He,2,0),Ce=0,Be=0,r.mode=N;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&Ce)<<8)+(Ce>>8))%31){t.msg="incorrect header check",r.mode=ge;break}if((15&Ce)!==O){t.msg="unknown compression method",r.mode=ge;break}if(Be-=4,Re=8+(15&(Ce>>>=4)),0===r.wbits)r.wbits=Re;else if(Re>r.wbits){t.msg="invalid window size",r.mode=ge;break}r.dmax=1<<Re,t.adler=r.check=1,r.mode=512&Ce?K:q,Ce=0,Be=0;break;case N:for(;Be<16;){if(0===we)break e;we--,Ce+=_e[be++]<<Be,Be+=8}if(r.flags=Ce,(255&r.flags)!==O){t.msg="unknown compression method",r.mode=ge;break}if(57344&r.flags){t.msg="unknown header flags set",r.mode=ge;break}r.head&&(r.head.text=Ce>>8&1),512&r.flags&&(He[0]=255&Ce,He[1]=Ce>>>8&255,r.check=g(r.check,He,2,0)),Ce=0,Be=0,r.mode=H;case H:for(;Be<32;){if(0===we)break e;we--,Ce+=_e[be++]<<Be,Be+=8}r.head&&(r.head.time=Ce),512&r.flags&&(He[0]=255&Ce,He[1]=Ce>>>8&255,He[2]=Ce>>>16&255,He[3]=Ce>>>24&255,r.check=g(r.check,He,4,0)),Ce=0,Be=0,r.mode=G;case G:for(;Be<16;){if(0===we)break e;we--,Ce+=_e[be++]<<Be,Be+=8}r.head&&(r.head.xflags=255&Ce,r.head.os=Ce>>8),512&r.flags&&(He[0]=255&Ce,He[1]=Ce>>>8&255,r.check=g(r.check,He,2,0)),Ce=0,Be=0,r.mode=j;case j:if(1024&r.flags){for(;Be<16;){if(0===we)break e;we--,Ce+=_e[be++]<<Be,Be+=8}r.length=Ce,r.head&&(r.head.extra_len=Ce),512&r.flags&&(He[0]=255&Ce,He[1]=Ce>>>8&255,r.check=g(r.check,He,2,0)),Ce=0,Be=0}else r.head&&(r.head.extra=null);r.mode=V;case V:if(1024&r.flags&&((Se=r.length)>we&&(Se=we),Se&&(r.head&&(Re=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),d.arraySet(r.head.extra,_e,be,Se,Re)),512&r.flags&&(r.check=g(r.check,_e,Se,be)),we-=Se,be+=Se,r.length-=Se),r.length))break e;r.length=0,r.mode=Y;case Y:if(2048&r.flags){if(0===we)break e;Se=0;do{Re=_e[be+Se++],r.head&&Re&&r.length<65536&&(r.head.name+=String.fromCharCode(Re))}while(Re&&Se<we);if(512&r.flags&&(r.check=g(r.check,_e,Se,be)),we-=Se,be+=Se,Re)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=W;case W:if(4096&r.flags){if(0===we)break e;Se=0;do{Re=_e[be+Se++],r.head&&Re&&r.length<65536&&(r.head.comment+=String.fromCharCode(Re))}while(Re&&Se<we);if(512&r.flags&&(r.check=g(r.check,_e,Se,be)),we-=Se,be+=Se,Re)break e}else r.head&&(r.head.comment=null);r.mode=X;case X:if(512&r.flags){for(;Be<16;){if(0===we)break e;we--,Ce+=_e[be++]<<Be,Be+=8}if(Ce!==(65535&r.check)){t.msg="header crc mismatch",r.mode=ge;break}Ce=0,Be=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=q;break;case K:for(;Be<32;){if(0===we)break e;we--,Ce+=_e[be++]<<Be,Be+=8}t.adler=r.check=zswap32(Ce),Ce=0,Be=0,r.mode=Z;case Z:if(0===r.havedict)return t.next_out=Ie,t.avail_out=ye,t.next_in=be,t.avail_in=we,r.hold=Ce,r.bits=Be,D;t.adler=r.check=1,r.mode=q;case q:if(i===T||i===x)break e;case J:if(r.last){Ce>>>=7&Be,Be-=7&Be,r.mode=Ae;break}for(;Be<3;){if(0===we)break e;we--,Ce+=_e[be++]<<Be,Be+=8}switch(r.last=1&Ce,Be-=1,3&(Ce>>>=1)){case 0:r.mode=$;break;case 1:if(fixedtables(r),r.mode=re,i===x){Ce>>>=2,Be-=2;break e}break;case 2:r.mode=ie;break;case 3:t.msg="invalid block type",r.mode=ge}Ce>>>=2,Be-=2;break;case $:for(Ce>>>=7&Be,Be-=7&Be;Be<32;){if(0===we)break e;we--,Ce+=_e[be++]<<Be,Be+=8}if((65535&Ce)!=(Ce>>>16^65535)){t.msg="invalid stored block lengths",r.mode=ge;break}if(r.length=65535&Ce,Ce=0,Be=0,r.mode=ee,i===x)break e;case ee:r.mode=te;case te:if(Se=r.length){if(Se>we&&(Se=we),Se>ye&&(Se=ye),0===Se)break e;d.arraySet(fe,_e,be,Se,Ie),we-=Se,be+=Se,ye-=Se,Ie+=Se,r.length-=Se;break}r.mode=q;break;case ie:for(;Be<14;){if(0===we)break e;we--,Ce+=_e[be++]<<Be,Be+=8}if(r.nlen=257+(31&Ce),Ce>>>=5,Be-=5,r.ndist=1+(31&Ce),Ce>>>=5,Be-=5,r.ncode=4+(15&Ce),Ce>>>=4,Be-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=ge;break}r.have=0,r.mode=se;case se:for(;r.have<r.ncode;){for(;Be<3;){if(0===we)break e;we--,Ce+=_e[be++]<<Be,Be+=8}r.lens[Ge[r.have++]]=7&Ce,Ce>>>=3,Be-=3}for(;r.have<19;)r.lens[Ge[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,Oe={bits:r.lenbits},Le=I(w,r.lens,0,19,r.lencode,0,r.work,Oe),r.lenbits=Oe.bits,Le){t.msg="invalid code lengths set",r.mode=ge;break}r.have=0,r.mode=ne;case ne:for(;r.have<r.nlen+r.ndist;){for(;Pe=(Ne=r.lencode[Ce&(1<<r.lenbits)-1])>>>16&255,ke=65535&Ne,!((Me=Ne>>>24)<=Be);){if(0===we)break e;we--,Ce+=_e[be++]<<Be,Be+=8}if(ke<16)Ce>>>=Me,Be-=Me,r.lens[r.have++]=ke;else{if(16===ke){for(Ue=Me+2;Be<Ue;){if(0===we)break e;we--,Ce+=_e[be++]<<Be,Be+=8}if(Ce>>>=Me,Be-=Me,0===r.have){t.msg="invalid bit length repeat",r.mode=ge;break}Re=r.lens[r.have-1],Se=3+(3&Ce),Ce>>>=2,Be-=2}else if(17===ke){for(Ue=Me+3;Be<Ue;){if(0===we)break e;we--,Ce+=_e[be++]<<Be,Be+=8}Be-=Me,Re=0,Se=3+(7&(Ce>>>=Me)),Ce>>>=3,Be-=3}else{for(Ue=Me+7;Be<Ue;){if(0===we)break e;we--,Ce+=_e[be++]<<Be,Be+=8}Be-=Me,Re=0,Se=11+(127&(Ce>>>=Me)),Ce>>>=7,Be-=7}if(r.have+Se>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=ge;break}for(;Se--;)r.lens[r.have++]=Re}}if(r.mode===ge)break;if(0===r.lens[256]){t.msg="invalid code -- missing end-of-block",r.mode=ge;break}if(r.lenbits=9,Oe={bits:r.lenbits},Le=I(C,r.lens,0,r.nlen,r.lencode,0,r.work,Oe),r.lenbits=Oe.bits,Le){t.msg="invalid literal/lengths set",r.mode=ge;break}if(r.distbits=6,r.distcode=r.distdyn,Oe={bits:r.distbits},Le=I(B,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,Oe),r.distbits=Oe.bits,Le){t.msg="invalid distances set",r.mode=ge;break}if(r.mode=re,i===x)break e;case re:r.mode=ae;case ae:if(we>=6&&ye>=258){t.next_out=Ie,t.avail_out=ye,t.next_in=be,t.avail_in=we,r.hold=Ce,r.bits=Be,b(t,Ee),Ie=t.next_out,fe=t.output,ye=t.avail_out,be=t.next_in,_e=t.input,we=t.avail_in,Ce=r.hold,Be=r.bits,r.mode===q&&(r.back=-1);break}for(r.back=0;Pe=(Ne=r.lencode[Ce&(1<<r.lenbits)-1])>>>16&255,ke=65535&Ne,!((Me=Ne>>>24)<=Be);){if(0===we)break e;we--,Ce+=_e[be++]<<Be,Be+=8}if(Pe&&0==(240&Pe)){for(De=Me,Qe=Pe,Fe=ke;Pe=(Ne=r.lencode[Fe+((Ce&(1<<De+Qe)-1)>>De)])>>>16&255,ke=65535&Ne,!(De+(Me=Ne>>>24)<=Be);){if(0===we)break e;we--,Ce+=_e[be++]<<Be,Be+=8}Ce>>>=De,Be-=De,r.back+=De}if(Ce>>>=Me,Be-=Me,r.back+=Me,r.length=ke,0===Pe){r.mode=ce;break}if(32&Pe){r.back=-1,r.mode=q;break}if(64&Pe){t.msg="invalid literal/length code",r.mode=ge;break}r.extra=15&Pe,r.mode=oe;case oe:if(r.extra){for(Ue=r.extra;Be<Ue;){if(0===we)break e;we--,Ce+=_e[be++]<<Be,Be+=8}r.length+=Ce&(1<<r.extra)-1,Ce>>>=r.extra,Be-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=le;case le:for(;Pe=(Ne=r.distcode[Ce&(1<<r.distbits)-1])>>>16&255,ke=65535&Ne,!((Me=Ne>>>24)<=Be);){if(0===we)break e;we--,Ce+=_e[be++]<<Be,Be+=8}if(0==(240&Pe)){for(De=Me,Qe=Pe,Fe=ke;Pe=(Ne=r.distcode[Fe+((Ce&(1<<De+Qe)-1)>>De)])>>>16&255,ke=65535&Ne,!(De+(Me=Ne>>>24)<=Be);){if(0===we)break e;we--,Ce+=_e[be++]<<Be,Be+=8}Ce>>>=De,Be-=De,r.back+=De}if(Ce>>>=Me,Be-=Me,r.back+=Me,64&Pe){t.msg="invalid distance code",r.mode=ge;break}r.offset=ke,r.extra=15&Pe,r.mode=he;case he:if(r.extra){for(Ue=r.extra;Be<Ue;){if(0===we)break e;we--,Ce+=_e[be++]<<Be,Be+=8}r.offset+=Ce&(1<<r.extra)-1,Ce>>>=r.extra,Be-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=ge;break}r.mode=de;case de:if(0===ye)break e;if(Se=Ee-ye,r.offset>Se){if((Se=r.offset-Se)>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=ge;break}Se>r.wnext?(Se-=r.wnext,Te=r.wsize-Se):Te=r.wnext-Se,Se>r.length&&(Se=r.length),xe=r.window}else xe=fe,Te=Ie-r.offset,Se=r.length;Se>ye&&(Se=ye),ye-=Se,r.length-=Se;do{fe[Ie++]=xe[Te++]}while(--Se);0===r.length&&(r.mode=ae);break;case ce:if(0===ye)break e;fe[Ie++]=r.length,ye--,r.mode=ae;break;case Ae:if(r.wrap){for(;Be<32;){if(0===we)break e;we--,Ce|=_e[be++]<<Be,Be+=8}if(Ee-=ye,t.total_out+=Ee,r.total+=Ee,Ee&&(t.adler=r.check=r.flags?g(r.check,fe,Ee,Ie-Ee):A(r.check,fe,Ee,Ie-Ee)),Ee=ye,(r.flags?Ce:zswap32(Ce))!==r.check){t.msg="incorrect data check",r.mode=ge;break}Ce=0,Be=0}r.mode=ue;case ue:if(r.wrap&&r.flags){for(;Be<32;){if(0===we)break e;we--,Ce+=_e[be++]<<Be,Be+=8}if(Ce!==(4294967295&r.total)){t.msg="incorrect length check",r.mode=ge;break}Ce=0,Be=0}r.mode=pe;case pe:Le=P;break e;case ge:Le=F;break e;case me:return R;default:return Q}return t.next_out=Ie,t.avail_out=ye,t.next_in=be,t.avail_in=we,r.hold=Ce,r.bits=Be,(r.wsize||Ee!==t.avail_out&&r.mode<ge&&(r.mode<Ae||i!==S))&&updatewindow(t,t.output,t.next_out,Ee-t.avail_out),ve-=t.avail_in,Ee-=t.avail_out,t.total_in+=ve,t.total_out+=Ee,r.total+=Ee,r.wrap&&Ee&&(t.adler=r.check=r.flags?g(r.check,fe,Ee,t.next_out-Ee):A(r.check,fe,Ee,t.next_out-Ee)),t.data_type=r.bits+(r.last?64:0)+(r.mode===q?128:0)+(r.mode===re||r.mode===ee?256:0),(0===ve&&0===Ee||i===S)&&Le===M&&(Le=L),Le},r.inflateEnd=function(t){if(!t||!t.state)return Q;var i=t.state;return i.window&&(i.window=null),t.state=null,M},r.inflateGetHeader=function(t,i){var r;return t&&t.state?0==(2&(r=t.state).wrap)?Q:(r.head=i,i.done=!1,M):Q},r.inflateSetDictionary=function(t,i){var r,d=i.length;return t&&t.state?0!==(r=t.state).wrap&&r.mode!==Z?Q:r.mode===Z&&A(1,i,d,0)!==r.check?F:updatewindow(t,i,d,d)?(r.mode=me,R):(r.havedict=1,M):Q},r.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,i,r){var d=t("../utils/common"),A=15,g=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],b=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],I=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],w=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];i.exports=function(t,i,r,C,B,S,T,x){var M,P,D,Q,F,R,L,O,U,N=x.bits,H=0,G=0,j=0,V=0,Y=0,W=0,X=0,K=0,Z=0,q=0,J=null,$=0,ee=new d.Buf16(16),te=new d.Buf16(16),ie=null,se=0;for(H=0;H<=A;H++)ee[H]=0;for(G=0;G<C;G++)ee[i[r+G]]++;for(Y=N,V=A;V>=1&&0===ee[V];V--);if(Y>V&&(Y=V),0===V)return B[S++]=20971520,B[S++]=20971520,x.bits=1,0;for(j=1;j<V&&0===ee[j];j++);for(Y<j&&(Y=j),K=1,H=1;H<=A;H++)if(K<<=1,(K-=ee[H])<0)return-1;if(K>0&&(0===t||1!==V))return-1;for(te[1]=0,H=1;H<A;H++)te[H+1]=te[H]+ee[H];for(G=0;G<C;G++)0!==i[r+G]&&(T[te[i[r+G]]++]=G);if(0===t?(J=ie=T,R=19):1===t?(J=g,$-=257,ie=b,se-=257,R=256):(J=I,ie=w,R=-1),q=0,G=0,H=j,F=S,W=Y,X=0,D=-1,Q=(Z=1<<Y)-1,1===t&&Z>852||2===t&&Z>592)return 1;for(;;){L=H-X,T[G]<R?(O=0,U=T[G]):T[G]>R?(O=ie[se+T[G]],U=J[$+T[G]]):(O=96,U=0),M=1<<H-X,j=P=1<<W;do{B[F+(q>>X)+(P-=M)]=L<<24|O<<16|U|0}while(0!==P);for(M=1<<H-1;q&M;)M>>=1;if(0!==M?(q&=M-1,q+=M):q=0,G++,0==--ee[H]){if(H===V)break;H=i[r+T[G]]}if(H>Y&&(q&Q)!==D){for(0===X&&(X=Y),F+=j,K=1<<(W=H-X);W+X<V&&!((K-=ee[W+X])<=0);)W++,K<<=1;if(Z+=1<<W,1===t&&Z>852||2===t&&Z>592)return 1;B[D=q&Q]=Y<<24|W<<16|F-S|0}}return 0!==q&&(B[F+q]=H-X<<24|64<<16|0),x.bits=Y,0}},{"../utils/common":41}],51:[function(t,i,r){i.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,i,r){var d=t("../utils/common"),A=4,g=0,b=1,I=2;function zero(t){for(var i=t.length;--i>=0;)t[i]=0}var w=0,C=1,B=2,S=29,T=256,x=T+1+S,M=30,P=19,D=2*x+1,Q=15,F=16,R=7,L=256,O=16,U=17,N=18,H=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],G=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],j=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],V=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Y=new Array(2*(x+2));zero(Y);var W=new Array(2*M);zero(W);var X=new Array(512);zero(X);var K=new Array(256);zero(K);var Z=new Array(S);zero(Z);var q,J,$,ee=new Array(M);function StaticTreeDesc(t,i,r,d,A){this.static_tree=t,this.extra_bits=i,this.extra_base=r,this.elems=d,this.max_length=A,this.has_stree=t&&t.length}function TreeDesc(t,i){this.dyn_tree=t,this.max_code=0,this.stat_desc=i}function d_code(t){return t<256?X[t]:X[256+(t>>>7)]}function put_short(t,i){t.pending_buf[t.pending++]=255&i,t.pending_buf[t.pending++]=i>>>8&255}function send_bits(t,i,r){t.bi_valid>F-r?(t.bi_buf|=i<<t.bi_valid&65535,put_short(t,t.bi_buf),t.bi_buf=i>>F-t.bi_valid,t.bi_valid+=r-F):(t.bi_buf|=i<<t.bi_valid&65535,t.bi_valid+=r)}function send_code(t,i,r){send_bits(t,r[2*i],r[2*i+1])}function bi_reverse(t,i){var r=0;do{r|=1&t,t>>>=1,r<<=1}while(--i>0);return r>>>1}function gen_codes(t,i,r){var d,A,g=new Array(Q+1),b=0;for(d=1;d<=Q;d++)g[d]=b=b+r[d-1]<<1;for(A=0;A<=i;A++){var I=t[2*A+1];0!==I&&(t[2*A]=bi_reverse(g[I]++,I))}}function init_block(t){var i;for(i=0;i<x;i++)t.dyn_ltree[2*i]=0;for(i=0;i<M;i++)t.dyn_dtree[2*i]=0;for(i=0;i<P;i++)t.bl_tree[2*i]=0;t.dyn_ltree[2*L]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0}function bi_windup(t){t.bi_valid>8?put_short(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0}function smaller(t,i,r,d){var A=2*i,g=2*r;return t[A]<t[g]||t[A]===t[g]&&d[i]<=d[r]}function pqdownheap(t,i,r){for(var d=t.heap[r],A=r<<1;A<=t.heap_len&&(A<t.heap_len&&smaller(i,t.heap[A+1],t.heap[A],t.depth)&&A++,!smaller(i,d,t.heap[A],t.depth));)t.heap[r]=t.heap[A],r=A,A<<=1;t.heap[r]=d}function compress_block(t,i,r){var d,A,g,b,I=0;if(0!==t.last_lit)do{d=t.pending_buf[t.d_buf+2*I]<<8|t.pending_buf[t.d_buf+2*I+1],A=t.pending_buf[t.l_buf+I],I++,0===d?send_code(t,A,i):(send_code(t,(g=K[A])+T+1,i),0!==(b=H[g])&&send_bits(t,A-=Z[g],b),send_code(t,g=d_code(--d),r),0!==(b=G[g])&&send_bits(t,d-=ee[g],b))}while(I<t.last_lit);send_code(t,L,i)}function build_tree(t,i){var r,d,A,g=i.dyn_tree,b=i.stat_desc.static_tree,I=i.stat_desc.has_stree,w=i.stat_desc.elems,C=-1;for(t.heap_len=0,t.heap_max=D,r=0;r<w;r++)0!==g[2*r]?(t.heap[++t.heap_len]=C=r,t.depth[r]=0):g[2*r+1]=0;for(;t.heap_len<2;)g[2*(A=t.heap[++t.heap_len]=C<2?++C:0)]=1,t.depth[A]=0,t.opt_len--,I&&(t.static_len-=b[2*A+1]);for(i.max_code=C,r=t.heap_len>>1;r>=1;r--)pqdownheap(t,g,r);A=w;do{r=t.heap[1],t.heap[1]=t.heap[t.heap_len--],pqdownheap(t,g,1),d=t.heap[1],t.heap[--t.heap_max]=r,t.heap[--t.heap_max]=d,g[2*A]=g[2*r]+g[2*d],t.depth[A]=(t.depth[r]>=t.depth[d]?t.depth[r]:t.depth[d])+1,g[2*r+1]=g[2*d+1]=A,t.heap[1]=A++,pqdownheap(t,g,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],function(t,i){var r,d,A,g,b,I,w=i.dyn_tree,C=i.max_code,B=i.stat_desc.static_tree,S=i.stat_desc.has_stree,T=i.stat_desc.extra_bits,x=i.stat_desc.extra_base,M=i.stat_desc.max_length,P=0;for(g=0;g<=Q;g++)t.bl_count[g]=0;for(w[2*t.heap[t.heap_max]+1]=0,r=t.heap_max+1;r<D;r++)(g=w[2*w[2*(d=t.heap[r])+1]+1]+1)>M&&(g=M,P++),w[2*d+1]=g,d>C||(t.bl_count[g]++,b=0,d>=x&&(b=T[d-x]),I=w[2*d],t.opt_len+=I*(g+b),S&&(t.static_len+=I*(B[2*d+1]+b)));if(0!==P){do{for(g=M-1;0===t.bl_count[g];)g--;t.bl_count[g]--,t.bl_count[g+1]+=2,t.bl_count[M]--,P-=2}while(P>0);for(g=M;0!==g;g--)for(d=t.bl_count[g];0!==d;)(A=t.heap[--r])>C||(w[2*A+1]!==g&&(t.opt_len+=(g-w[2*A+1])*w[2*A],w[2*A+1]=g),d--)}}(t,i),gen_codes(g,C,t.bl_count)}function scan_tree(t,i,r){var d,A,g=-1,b=i[1],I=0,w=7,C=4;for(0===b&&(w=138,C=3),i[2*(r+1)+1]=65535,d=0;d<=r;d++)A=b,b=i[2*(d+1)+1],++I<w&&A===b||(I<C?t.bl_tree[2*A]+=I:0!==A?(A!==g&&t.bl_tree[2*A]++,t.bl_tree[2*O]++):I<=10?t.bl_tree[2*U]++:t.bl_tree[2*N]++,I=0,g=A,0===b?(w=138,C=3):A===b?(w=6,C=3):(w=7,C=4))}function send_tree(t,i,r){var d,A,g=-1,b=i[1],I=0,w=7,C=4;for(0===b&&(w=138,C=3),d=0;d<=r;d++)if(A=b,b=i[2*(d+1)+1],!(++I<w&&A===b)){if(I<C)do{send_code(t,A,t.bl_tree)}while(0!=--I);else 0!==A?(A!==g&&(send_code(t,A,t.bl_tree),I--),send_code(t,O,t.bl_tree),send_bits(t,I-3,2)):I<=10?(send_code(t,U,t.bl_tree),send_bits(t,I-3,3)):(send_code(t,N,t.bl_tree),send_bits(t,I-11,7));I=0,g=A,0===b?(w=138,C=3):A===b?(w=6,C=3):(w=7,C=4)}}zero(ee);var te=!1;function _tr_stored_block(t,i,r,A){send_bits(t,(w<<1)+(A?1:0),3),function(t,i,r,A){bi_windup(t),A&&(put_short(t,r),put_short(t,~r)),d.arraySet(t.pending_buf,t.window,i,r,t.pending),t.pending+=r}(t,i,r,!0)}r._tr_init=function(t){te||(!function(){var t,i,r,d,A,g=new Array(Q+1);for(r=0,d=0;d<S-1;d++)for(Z[d]=r,t=0;t<1<<H[d];t++)K[r++]=d;for(K[r-1]=d,A=0,d=0;d<16;d++)for(ee[d]=A,t=0;t<1<<G[d];t++)X[A++]=d;for(A>>=7;d<M;d++)for(ee[d]=A<<7,t=0;t<1<<G[d]-7;t++)X[256+A++]=d;for(i=0;i<=Q;i++)g[i]=0;for(t=0;t<=143;)Y[2*t+1]=8,t++,g[8]++;for(;t<=255;)Y[2*t+1]=9,t++,g[9]++;for(;t<=279;)Y[2*t+1]=7,t++,g[7]++;for(;t<=287;)Y[2*t+1]=8,t++,g[8]++;for(gen_codes(Y,x+1,g),t=0;t<M;t++)W[2*t+1]=5,W[2*t]=bi_reverse(t,5);q=new StaticTreeDesc(Y,H,T+1,x,Q),J=new StaticTreeDesc(W,G,0,M,Q),$=new StaticTreeDesc(new Array(0),j,0,P,R)}(),te=!0),t.l_desc=new TreeDesc(t.dyn_ltree,q),t.d_desc=new TreeDesc(t.dyn_dtree,J),t.bl_desc=new TreeDesc(t.bl_tree,$),t.bi_buf=0,t.bi_valid=0,init_block(t)},r._tr_stored_block=_tr_stored_block,r._tr_flush_block=function(t,i,r,d){var w,S,x=0;t.level>0?(t.strm.data_type===I&&(t.strm.data_type=function(t){var i,r=4093624447;for(i=0;i<=31;i++,r>>>=1)if(1&r&&0!==t.dyn_ltree[2*i])return g;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return b;for(i=32;i<T;i++)if(0!==t.dyn_ltree[2*i])return b;return g}(t)),build_tree(t,t.l_desc),build_tree(t,t.d_desc),x=function(t){var i;for(scan_tree(t,t.dyn_ltree,t.l_desc.max_code),scan_tree(t,t.dyn_dtree,t.d_desc.max_code),build_tree(t,t.bl_desc),i=P-1;i>=3&&0===t.bl_tree[2*V[i]+1];i--);return t.opt_len+=3*(i+1)+5+5+4,i}(t),w=t.opt_len+3+7>>>3,(S=t.static_len+3+7>>>3)<=w&&(w=S)):w=S=r+5,r+4<=w&&-1!==i?_tr_stored_block(t,i,r,d):t.strategy===A||S===w?(send_bits(t,(C<<1)+(d?1:0),3),compress_block(t,Y,W)):(send_bits(t,(B<<1)+(d?1:0),3),function(t,i,r,d){var A;for(send_bits(t,i-257,5),send_bits(t,r-1,5),send_bits(t,d-4,4),A=0;A<d;A++)send_bits(t,t.bl_tree[2*V[A]+1],3);send_tree(t,t.dyn_ltree,i-1),send_tree(t,t.dyn_dtree,r-1)}(t,t.l_desc.max_code+1,t.d_desc.max_code+1,x+1),compress_block(t,t.dyn_ltree,t.dyn_dtree)),init_block(t),d&&bi_windup(t)},r._tr_tally=function(t,i,r){return t.pending_buf[t.d_buf+2*t.last_lit]=i>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&i,t.pending_buf[t.l_buf+t.last_lit]=255&r,t.last_lit++,0===i?t.dyn_ltree[2*r]++:(t.matches++,i--,t.dyn_ltree[2*(K[r]+T+1)]++,t.dyn_dtree[2*d_code(i)]++),t.last_lit===t.lit_bufsize-1},r._tr_align=function(t){send_bits(t,C<<1,3),send_code(t,L,Y),function(t){16===t.bi_valid?(put_short(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}(t)}},{"../utils/common":41}],53:[function(t,i,r){i.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,i,r){(function(t){!function(t,i){if(!t.setImmediate){var r,d,A,g,b,I=1,w={},C=!1,B=t.document,S=Object.getPrototypeOf&&Object.getPrototypeOf(t);S=S&&S.setTimeout?S:t,"[object process]"==={}.toString.call(t.process)?r=function(t){process.nextTick((function(){runIfPresent(t)}))}:!function(){if(t.postMessage&&!t.importScripts){var i=!0,r=t.onmessage;return t.onmessage=function(){i=!1},t.postMessage("","*"),t.onmessage=r,i}}()?t.MessageChannel?((A=new MessageChannel).port1.onmessage=function(t){runIfPresent(t.data)},r=function(t){A.port2.postMessage(t)}):B&&"onreadystatechange"in B.createElement("script")?(d=B.documentElement,r=function(t){var i=B.createElement("script");i.onreadystatechange=function(){runIfPresent(t),i.onreadystatechange=null,d.removeChild(i),i=null},d.appendChild(i)}):r=function(t){setTimeout(runIfPresent,0,t)}:(g="setImmediate$"+Math.random()+"$",b=function(i){i.source===t&&"string"==typeof i.data&&0===i.data.indexOf(g)&&runIfPresent(+i.data.slice(g.length))},t.addEventListener?t.addEventListener("message",b,!1):t.attachEvent("onmessage",b),r=function(i){t.postMessage(g+i,"*")}),S.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var i=new Array(arguments.length-1),d=0;d<i.length;d++)i[d]=arguments[d+1];var A={callback:t,args:i};return w[I]=A,r(I),I++},S.clearImmediate=clearImmediate}function clearImmediate(t){delete w[t]}function runIfPresent(t){if(C)setTimeout(runIfPresent,0,t);else{var i=w[t];if(i){C=!0;try{!function(t){var i=t.callback,r=t.args;switch(r.length){case 0:i();break;case 1:i(r[0]);break;case 2:i(r[0],r[1]);break;case 3:i(r[0],r[1],r[2]);break;default:i.apply(void 0,r)}}(i)}finally{clearImmediate(t),C=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[10])(10)})),Xr=function(){return function e(t,i,r){function s(A,g){if(!i[A]){if(!t[A]){var b="function"==typeof require&&require;if(!g&&b)return b(A,!0);if(d)return d(A,!0);throw new Error("Cannot find module '"+A+"'")}var I=i[A]={exports:{}};t[A][0].call(I.exports,(function(i){var r=t[A][1][i];return s(r||i)}),I,I.exports,e,t,i,r)}return i[A].exports}for(var d="function"==typeof require&&require,A=0;A<r.length;A++)s(r[A]);return s}({1:[function(t,i,r){var d={};function createStandardXHR(){try{return new window.XMLHttpRequest}catch(t){}}d._getBinaryFromXHR=function(t){return t.response||t.responseText};var A="undefined"!=typeof window&&window.ActiveXObject?function(){return createStandardXHR()||function(){try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}()}:createStandardXHR;d.getBinaryContent=function(t,i){var r,g,b,I;i||(i={}),"function"==typeof i?(I=i,i={}):"function"==typeof i.callback&&(I=i.callback),I||"undefined"==typeof Promise?(g=function(t){I(null,t)},b=function(t){I(t,null)}):r=new Promise((function(t,i){g=t,b=i}));try{var w=A();w.open("GET",t,!0),"responseType"in w&&(w.responseType="arraybuffer"),w.overrideMimeType&&w.overrideMimeType("text/plain; charset=x-user-defined"),w.onreadystatechange=function(i){if(4===w.readyState)if(200===w.status||0===w.status)try{g(d._getBinaryFromXHR(w))}catch(t){b(new Error(t))}else b(new Error("Ajax error for "+t+" : "+this.status+" "+this.statusText))},i.progress&&(w.onprogress=function(r){i.progress({path:t,originalEvent:r,percent:r.loaded/r.total*100,loaded:r.loaded,total:r.total})}),w.send()}catch(t){b(new Error(t),null)}return r},i.exports=d},{}]},{},[1])(1)},"object"==typeof exports?module.exports=Xr():"function"==typeof define&&define.amd?define(Xr):"undefined"!=typeof window?window.JSZipUtils=Xr():"undefined"!=typeof global?global.JSZipUtils=Xr():"undefined"!=typeof self&&(self.JSZipUtils=Xr()),Kr=window,Zr=function(){return function(t){var i={};function e(r){if(i[r])return i[r].exports;var d=i[r]={i:r,l:!1,exports:{}};return t[r].call(d.exports,d,d.exports,e),d.l=!0,d.exports}return e.m=t,e.c=i,e.d=function(t,i,r){e.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:r})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,i){if(1&i&&(t=e(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var d in t)e.d(r,d,function(i){return t[i]}.bind(null,d));return r},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},e.p="",e(e.s=0)}([function(t,i,r){r.r(i);var d,n=function(t,i){var r=i.x-t.x,d=i.y-t.y;return Math.sqrt(r*r+d*d)},s=function(t){return t*(Math.PI/180)},A=new Map,a=function(t){A.has(t)&&clearTimeout(A.get(t)),A.set(t,setTimeout(t,100))},p=function(t,i,r){for(var d,A=i.split(/[ ,]+/g),g=0;g<A.length;g+=1)d=A[g],t.addEventListener?t.addEventListener(d,r,!1):t.attachEvent&&t.attachEvent(d,r)},c=function(t,i,r){for(var d,A=i.split(/[ ,]+/g),g=0;g<A.length;g+=1)d=A[g],t.removeEventListener?t.removeEventListener(d,r):t.detachEvent&&t.detachEvent(d,r)},l=function(t){return t.preventDefault(),t.type.match(/^touch/)?t.changedTouches:t},h=function(){return{x:void 0!==window.pageXOffset?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,y:void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop}},u=function(t,i){i.top||i.right||i.bottom||i.left?(t.style.top=i.top,t.style.right=i.right,t.style.bottom=i.bottom,t.style.left=i.left):(t.style.left=i.x+"px",t.style.top=i.y+"px")},f=function(t,i,r){var d=y(t);for(var A in d)if(d.hasOwnProperty(A))if("string"==typeof i)d[A]=i+" "+r;else{for(var g="",b=0,I=i.length;b<I;b+=1)g+=i[b]+" "+r+", ";d[A]=g.slice(0,-2)}return d},y=function(t){var i={};return i[t]="",["webkit","Moz","o"].forEach((function(r){i[r+t.charAt(0).toUpperCase()+t.slice(1)]=""})),i},m=function(t,i){for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r]);return t},v=function(t,i){if(t.length)for(var r=0,d=t.length;r<d;r+=1)i(t[r]);else i(t)},g=!!("ontouchstart"in window),b=!!window.PointerEvent,I=!!window.MSPointerEvent,w={start:"mousedown",move:"mousemove",end:"mouseup"},C={};function _(){}b?d={start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"}:I?d={start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:g?(d={start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},C=w):d=w,_.prototype.on=function(t,i){var r,d=t.split(/[ ,]+/g);this._handlers_=this._handlers_||{};for(var A=0;A<d.length;A+=1)r=d[A],this._handlers_[r]=this._handlers_[r]||[],this._handlers_[r].push(i);return this},_.prototype.off=function(t,i){return this._handlers_=this._handlers_||{},void 0===t?this._handlers_={}:void 0===i?this._handlers_[t]=null:this._handlers_[t]&&this._handlers_[t].indexOf(i)>=0&&this._handlers_[t].splice(this._handlers_[t].indexOf(i),1),this},_.prototype.trigger=function(t,i){var r,d=this,A=t.split(/[ ,]+/g);d._handlers_=d._handlers_||{};for(var g=0;g<A.length;g+=1)r=A[g],d._handlers_[r]&&d._handlers_[r].length&&d._handlers_[r].forEach((function(t){t.call(d,{type:r,target:d},i)}))},_.prototype.config=function(t){this.options=this.defaults||{},t&&(this.options=function(t,i){var r={};for(var d in t)t.hasOwnProperty(d)&&i.hasOwnProperty(d)?r[d]=i[d]:t.hasOwnProperty(d)&&(r[d]=t[d]);return r}(this.options,t))},_.prototype.bindEvt=function(t,i){var r=this;return r._domHandlers_=r._domHandlers_||{},r._domHandlers_[i]=function(){"function"==typeof r["on"+i]?r["on"+i].apply(r,arguments):console.warn('[WARNING] : Missing "on'+i+'" handler.')},p(t,d[i],r._domHandlers_[i]),C[i]&&p(t,C[i],r._domHandlers_[i]),r},_.prototype.unbindEvt=function(t,i){return this._domHandlers_=this._domHandlers_||{},c(t,d[i],this._domHandlers_[i]),C[i]&&c(t,C[i],this._domHandlers_[i]),delete this._domHandlers_[i],this};var B=_;function k(t,i){return this.identifier=i.identifier,this.position=i.position,this.frontPosition=i.frontPosition,this.collection=t,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1,shape:"circle"},this.config(i),"dynamic"===this.options.mode&&(this.options.restOpacity=0),this.id=k.id,k.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}k.prototype=new B,k.constructor=k,k.id=0,k.prototype.buildEl=function(t){return this.ui={},this.options.dataOnly||(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front)),this},k.prototype.stylize=function(){if(this.options.dataOnly)return this;var t=this.options.fadeTime+"ms",i=function(t,i){var r=y("borderRadius");for(var d in r)r.hasOwnProperty(d)&&(r[d]="50%");return r}(),r=f("transition","opacity",t),d={};return d.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:999},d.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:this.options.color,opacity:".5"},d.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:this.options.color,opacity:".5"},m(d.el,r),"circle"===this.options.shape&&m(d.back,i),m(d.front,i),this.applyStyles(d),this},k.prototype.applyStyles=function(t){for(var i in this.ui)if(this.ui.hasOwnProperty(i))for(var r in t[i])this.ui[i].style[r]=t[i][r];return this},k.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)||this.options.zone.appendChild(this.ui.el),this},k.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)||this.options.zone.removeChild(this.ui.el),this},k.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()},k.prototype.show=function(t){var i=this;return i.options.dataOnly||(clearTimeout(i.removeTimeout),clearTimeout(i.showTimeout),clearTimeout(i.restTimeout),i.addToDom(),i.restCallback(),setTimeout((function(){i.ui.el.style.opacity=1}),0),i.showTimeout=setTimeout((function(){i.trigger("shown",i.instance),"function"==typeof t&&t.call(this)}),i.options.fadeTime)),i},k.prototype.hide=function(t){var i=this;if(i.options.dataOnly)return i;if(i.ui.el.style.opacity=i.options.restOpacity,clearTimeout(i.removeTimeout),clearTimeout(i.showTimeout),clearTimeout(i.restTimeout),i.removeTimeout=setTimeout((function(){var r="dynamic"===i.options.mode?"none":"block";i.ui.el.style.display=r,"function"==typeof t&&t.call(i),i.trigger("hidden",i.instance)}),i.options.fadeTime),i.options.restJoystick){var r=i.options.restJoystick,d={};d.x=!0===r||!1!==r.x?0:i.instance.frontPosition.x,d.y=!0===r||!1!==r.y?0:i.instance.frontPosition.y,i.setPosition(t,d)}return i},k.prototype.setPosition=function(t,i){var r=this;r.frontPosition={x:i.x,y:i.y};var d=r.options.fadeTime+"ms",A={};A.front=f("transition",["top","left"],d);var g={front:{}};g.front={left:r.frontPosition.x+"px",top:r.frontPosition.y+"px"},r.applyStyles(A),r.applyStyles(g),r.restTimeout=setTimeout((function(){"function"==typeof t&&t.call(r),r.restCallback()}),r.options.fadeTime)},k.prototype.restCallback=function(){var t={};t.front=f("transition","none",""),this.applyStyles(t),this.trigger("rested",this.instance)},k.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}},k.prototype.computeDirection=function(t){var i,r,d,A=t.angle.radian,g=Math.PI/4,b=Math.PI/2;if(A>g&&A<3*g&&!t.lockX?i="up":A>-g&&A<=g&&!t.lockY?i="left":A>3*-g&&A<=-g&&!t.lockX?i="down":t.lockY||(i="right"),t.lockY||(r=A>-b&&A<b?"left":"right"),t.lockX||(d=A>0?"up":"down"),t.force>this.options.threshold){var I,w={};for(I in this.direction)this.direction.hasOwnProperty(I)&&(w[I]=this.direction[I]);var C={};for(I in this.direction={x:r,y:d,angle:i},t.direction=this.direction,w)w[I]===this.direction[I]&&(C[I]=!0);if(C.x&&C.y&&C.angle)return t;C.x&&C.y||this.trigger("plain",t),C.x||this.trigger("plain:"+r,t),C.y||this.trigger("plain:"+d,t),C.angle||this.trigger("dir dir:"+i,t)}else this.resetDirection();return t};var S=k;function E(t,i){this.nipples=[],this.idles=[],this.actives=[],this.ids=[],this.pressureIntervals={},this.manager=t,this.id=E.id,E.id+=1,this.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,lockX:!1,lockY:!1,shape:"circle",dynamicPage:!1,follow:!1},this.config(i),"static"!==this.options.mode&&"semi"!==this.options.mode||(this.options.multitouch=!1),this.options.multitouch||(this.options.maxNumberOfNipples=1);var r=getComputedStyle(this.options.zone.parentElement);return r&&"flex"===r.display&&(this.parentIsFlex=!0),this.updateBox(),this.prepareNipples(),this.bindings(),this.begin(),this.nipples}E.prototype=new B,E.constructor=E,E.id=0,E.prototype.prepareNipples=function(){var t=this.nipples;t.on=this.on.bind(this),t.off=this.off.bind(this),t.options=this.options,t.destroy=this.destroy.bind(this),t.ids=this.ids,t.id=this.id,t.processOnMove=this.processOnMove.bind(this),t.processOnEnd=this.processOnEnd.bind(this),t.get=function(i){if(void 0===i)return t[0];for(var r=0,d=t.length;r<d;r+=1)if(t[r].identifier===i)return t[r];return!1}},E.prototype.bindings=function(){this.bindEvt(this.options.zone,"start"),this.options.zone.style.touchAction="none",this.options.zone.style.msTouchAction="none"},E.prototype.begin=function(){var t=this.options;if("static"===t.mode){var i=this.createNipple(t.position,this.manager.getIdentifier());i.add(),this.idles.push(i)}},E.prototype.createNipple=function(t,i){var r=this.manager.scroll,d={},A=this.options,g=this.parentIsFlex?r.x:r.x+this.box.left,b=this.parentIsFlex?r.y:r.y+this.box.top;if(t.x&&t.y)d={x:t.x-g,y:t.y-b};else if(t.top||t.right||t.bottom||t.left){var I=document.createElement("DIV");I.style.display="hidden",I.style.top=t.top,I.style.right=t.right,I.style.bottom=t.bottom,I.style.left=t.left,I.style.position="absolute",A.zone.appendChild(I);var w=I.getBoundingClientRect();A.zone.removeChild(I),d=t,t={x:w.left+r.x,y:w.top+r.y}}var C=new S(this,{color:A.color,size:A.size,threshold:A.threshold,fadeTime:A.fadeTime,dataOnly:A.dataOnly,restJoystick:A.restJoystick,restOpacity:A.restOpacity,mode:A.mode,identifier:i,position:t,zone:A.zone,frontPosition:{x:0,y:0},shape:A.shape});return A.dataOnly||(u(C.ui.el,d),u(C.ui.front,C.frontPosition)),this.nipples.push(C),this.trigger("added "+C.identifier+":added",C),this.manager.trigger("added "+C.identifier+":added",C),this.bindNipple(C),C},E.prototype.updateBox=function(){this.box=this.options.zone.getBoundingClientRect()},E.prototype.bindNipple=function(t){var i,r=this,o=function(t,d){i=t.type+" "+d.id+":"+t.type,r.trigger(i,d)};t.on("destroyed",r.onDestroyed.bind(r)),t.on("shown hidden rested dir plain",o),t.on("dir:up dir:right dir:down dir:left",o),t.on("plain:up plain:right plain:down plain:left",o)},E.prototype.pressureFn=function(t,i,r){var d=this,A=0;clearInterval(d.pressureIntervals[r]),d.pressureIntervals[r]=setInterval(function(){var r=t.force||t.pressure||t.webkitForce||0;r!==A&&(i.trigger("pressure",r),d.trigger("pressure "+i.identifier+":pressure",r),A=r)}.bind(d),100)},E.prototype.onstart=function(t){var i=this,r=i.options,d=t;return t=l(t),i.updateBox(),v(t,(function(A){i.actives.length<r.maxNumberOfNipples?i.processOnStart(A):d.type.match(/^touch/)&&(Object.keys(i.manager.ids).forEach((function(r){if(Object.values(d.touches).findIndex((function(t){return t.identifier===r}))<0){var A=[t[0]];A.identifier=r,i.processOnEnd(A)}})),i.actives.length<r.maxNumberOfNipples&&i.processOnStart(A))})),i.manager.bindDocument(),!1},E.prototype.processOnStart=function(t){var i,r=this,d=r.options,A=r.manager.getIdentifier(t),g=t.force||t.pressure||t.webkitForce||0,b={x:t.pageX,y:t.pageY},I=r.getOrCreate(A,b);I.identifier!==A&&r.manager.removeIdentifier(I.identifier),I.identifier=A;var p=function(i){i.trigger("start",i),r.trigger("start "+i.id+":start",i),i.show(),g>0&&r.pressureFn(t,i,i.identifier),r.processOnMove(t)};if((i=r.idles.indexOf(I))>=0&&r.idles.splice(i,1),r.actives.push(I),r.ids.push(I.identifier),"semi"!==d.mode)p(I);else{if(!(n(b,I.position)<=d.catchDistance))return I.destroy(),void r.processOnStart(t);p(I)}return I},E.prototype.getOrCreate=function(t,i){var r,d=this.options;return/(semi|static)/.test(d.mode)?(r=this.idles[0])?(this.idles.splice(0,1),r):"semi"===d.mode?this.createNipple(i,t):(console.warn("Coudln't find the needed nipple."),!1):r=this.createNipple(i,t)},E.prototype.processOnMove=function(t){var i=this.options,r=this.manager.getIdentifier(t),d=this.nipples.get(r),A=this.manager.scroll;if(function(t){return isNaN(t.buttons)?0!==t.pressure:0!==t.buttons}(t)){if(!d)return console.error("Found zombie joystick with ID "+r),void this.manager.removeIdentifier(r);if(i.dynamicPage){var g=d.el.getBoundingClientRect();d.position={x:A.x+g.left,y:A.y+g.top}}d.identifier=r;var b=d.options.size/2,I={x:t.pageX,y:t.pageY};i.lockX&&(I.y=d.position.y),i.lockY&&(I.x=d.position.x);var w,C,B,S,T,x,M,P,D,Q,F=n(I,d.position),R=(w=I,B=(C=d.position).x-w.x,S=C.y-w.y,function(t){return t*(180/Math.PI)}(Math.atan2(S,B))),L=s(R),O=F/b,U={distance:F,position:I};if("circle"===d.options.shape?(T=Math.min(F,b),M=d.position,P=T,Q={x:0,y:0},D=s(D=R),Q.x=M.x-P*Math.cos(D),Q.y=M.y-P*Math.sin(D),x=Q):(x=function(t,i,r){return{x:Math.min(Math.max(t.x,i.x-r),i.x+r),y:Math.min(Math.max(t.y,i.y-r),i.y+r)}}(I,d.position,b),T=n(x,d.position)),i.follow){if(F>b){var N=I.x-x.x,H=I.y-x.y;d.position.x+=N,d.position.y+=H,d.el.style.top=d.position.y-(this.box.top+A.y)+"px",d.el.style.left=d.position.x-(this.box.left+A.x)+"px",F=n(I,d.position)}}else I=x,F=T;var G=I.x-d.position.x,j=I.y-d.position.y;d.frontPosition={x:G,y:j},i.dataOnly||u(d.ui.front,d.frontPosition);var V={identifier:d.identifier,position:I,force:O,pressure:t.force||t.pressure||t.webkitForce||0,distance:F,angle:{radian:L,degree:R},vector:{x:G/b,y:-j/b},raw:U,instance:d,lockX:i.lockX,lockY:i.lockY};(V=d.computeDirection(V)).angle={radian:s(180-R),degree:180-R},d.trigger("move",V),this.trigger("move "+d.id+":move",V)}else this.processOnEnd(t)},E.prototype.processOnEnd=function(t){var i=this,r=i.options,d=i.manager.getIdentifier(t),A=i.nipples.get(d),g=i.manager.removeIdentifier(A.identifier);A&&(r.dataOnly||A.hide((function(){"dynamic"===r.mode&&(A.trigger("removed",A),i.trigger("removed "+A.id+":removed",A),i.manager.trigger("removed "+A.id+":removed",A),A.destroy())})),clearInterval(i.pressureIntervals[A.identifier]),A.resetDirection(),A.trigger("end",A),i.trigger("end "+A.id+":end",A),i.ids.indexOf(A.identifier)>=0&&i.ids.splice(i.ids.indexOf(A.identifier),1),i.actives.indexOf(A)>=0&&i.actives.splice(i.actives.indexOf(A),1),/(semi|static)/.test(r.mode)?i.idles.push(A):i.nipples.indexOf(A)>=0&&i.nipples.splice(i.nipples.indexOf(A),1),i.manager.unbindDocument(),/(semi|static)/.test(r.mode)&&(i.manager.ids[g.id]=g.identifier))},E.prototype.onDestroyed=function(t,i){this.nipples.indexOf(i)>=0&&this.nipples.splice(this.nipples.indexOf(i),1),this.actives.indexOf(i)>=0&&this.actives.splice(this.actives.indexOf(i),1),this.idles.indexOf(i)>=0&&this.idles.splice(this.idles.indexOf(i),1),this.ids.indexOf(i.identifier)>=0&&this.ids.splice(this.ids.indexOf(i.identifier),1),this.manager.removeIdentifier(i.identifier),this.manager.unbindDocument()},E.prototype.destroy=function(){for(var t in this.unbindEvt(this.options.zone,"start"),this.nipples.forEach((function(t){t.destroy()})),this.pressureIntervals)this.pressureIntervals.hasOwnProperty(t)&&clearInterval(this.pressureIntervals[t]);this.trigger("destroyed",this.nipples),this.manager.unbindDocument(),this.off()};var T=E;function z(t){var i=this;i.ids={},i.index=0,i.collections=[],i.scroll=h(),i.config(t),i.prepareCollections();var e=function(){var t;i.collections.forEach((function(r){r.forEach((function(r){t=r.el.getBoundingClientRect(),r.position={x:i.scroll.x+t.left,y:i.scroll.y+t.top}}))}))};p(window,"resize",(function(){a(e)}));var o=function(){i.scroll=h()};return p(window,"scroll",(function(){a(o)})),i.collections}z.prototype=new B,z.constructor=z,z.prototype.prepareCollections=function(){var t=this;t.collections.create=t.create.bind(t),t.collections.on=t.on.bind(t),t.collections.off=t.off.bind(t),t.collections.destroy=t.destroy.bind(t),t.collections.get=function(i){var r;return t.collections.every((function(t){return!(r=t.get(i))})),r}},z.prototype.create=function(t){return this.createCollection(t)},z.prototype.createCollection=function(t){var i=new T(this,t);return this.bindCollection(i),this.collections.push(i),i},z.prototype.bindCollection=function(t){var i,r=this,o=function(t,d){i=t.type+" "+d.id+":"+t.type,r.trigger(i,d)};t.on("destroyed",r.onDestroyed.bind(r)),t.on("shown hidden rested dir plain",o),t.on("dir:up dir:right dir:down dir:left",o),t.on("plain:up plain:right plain:down plain:left",o)},z.prototype.bindDocument=function(){this.binded||(this.bindEvt(document,"move").bindEvt(document,"end"),this.binded=!0)},z.prototype.unbindDocument=function(t){Object.keys(this.ids).length&&!0!==t||(this.unbindEvt(document,"move").unbindEvt(document,"end"),this.binded=!1)},z.prototype.getIdentifier=function(t){var i;return t?void 0===(i=void 0===t.identifier?t.pointerId:t.identifier)&&(i=this.latest||0):i=this.index,void 0===this.ids[i]&&(this.ids[i]=this.index,this.index+=1),this.latest=i,this.ids[i]},z.prototype.removeIdentifier=function(t){var i={};for(var r in this.ids)if(this.ids[r]===t){i.id=r,i.identifier=this.ids[r],delete this.ids[r];break}return i},z.prototype.onmove=function(t){return this.onAny("move",t),!1},z.prototype.onend=function(t){return this.onAny("end",t),!1},z.prototype.oncancel=function(t){return this.onAny("end",t),!1},z.prototype.onAny=function(t,i){var r,d=this,A="processOn"+t.charAt(0).toUpperCase()+t.slice(1);return i=l(i),v(i,(function(t){r=d.getIdentifier(t),v(d.collections,function(t,i,r){r.ids.indexOf(i)>=0&&(r[A](t),t._found_=!0)}.bind(null,t,r)),t._found_||d.removeIdentifier(r)})),!1},z.prototype.destroy=function(){this.unbindDocument(!0),this.ids={},this.index=0,this.collections.forEach((function(t){t.destroy()})),this.off()},z.prototype.onDestroyed=function(t,i){if(this.collections.indexOf(i)<0)return!1;this.collections.splice(this.collections.indexOf(i),1)};var x=new z;i.default={create:function(t){return x.create(t)},factory:x}}]).default},"object"==typeof exports&&"object"==typeof module?module.exports=Zr():"function"==typeof define&&define.amd?define("nipplejs",[],Zr):"object"==typeof exports?exports.nipplejs=Zr():Kr.nipplejs=Zr(),ze.deviceType="MOBILE",ze.isChrome=-1!==navigator.userAgent.indexOf("Chrome");const $r="0.1.1";function getDeviceType(){return ze.deviceType}function disableImmersion(){ze.disableImmersion=!0}export{ui as LibraryHandler,yn as ProjectHandler,disableImmersion,getDeviceType,setup,setupEditor,$r as version};
