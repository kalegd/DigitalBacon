/*
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */
import*as r from"three";import{Vector3 as A,Vector2 as b,Plane as C,Line3 as I,Box3 as x,Matrix4 as S,Ray as B,Mesh as D,BatchedMesh as R,Vector4 as F,Quaternion as N,Color as Q,MeshBasicMaterial as H,DoubleSide as G,Triangle as j,Sphere as V,IntType as W,DataTexture as X,RGBAFormat as Y,FloatType as K,NearestFilter as q,RGIntegerFormat as Z,UnsignedIntType as J,BufferAttribute as $,Loader as ee,LoaderUtils as te,FileLoader as se,LinearSRGBColorSpace as ie,SpotLight as ne,PointLight as re,DirectionalLight as ae,SRGBColorSpace as oe,MeshPhysicalMaterial as le,InstancedMesh as he,InstancedBufferAttribute as de,Object3D as ce,TextureLoader as ue,ImageBitmapLoader as pe,InterleavedBuffer as Ae,InterleavedBufferAttribute as ge,LinearFilter as fe,LinearMipmapLinearFilter as me,RepeatWrapping as _e,Texture as be,PointsMaterial as ye,Material as ve,LineBasicMaterial as Ce,MeshStandardMaterial as we,PropertyBinding as Ee,BufferGeometry as Ie,FrontSide as Te,SkinnedMesh as xe,LineSegments as Se,Line as Be,LineLoop as De,Points as Pe,Group as Me,PerspectiveCamera as ke,MathUtils as Re,OrthographicCamera as Fe,Skeleton as Le,AnimationClip as Oe,Bone as Ue,InterpolateLinear as Ne,QuaternionKeyframeTrack as Qe,ColorManagement as He,SphereGeometry as Ge,REVISION as je,Matrix3 as Ve,TrianglesDrawMode as ze,TriangleFanDrawMode as We,TriangleStripDrawMode as Xe,Interpolant as Ye,NearestMipmapNearestFilter as Ke,LinearMipmapNearestFilter as qe,NearestMipmapLinearFilter as Ze,ClampToEdgeWrapping as Je,MirroredRepeatWrapping as $e,InterpolateDiscrete as et,NumberKeyframeTrack as tt,VectorKeyframeTrack as st,InstancedBufferGeometry as it,BackSide as nt,PlaneGeometry as rt,Float32BufferAttribute as at,UnsignedByteType as ot,UnsignedShortType as lt,ByteType as ht,ShortType as dt,RGFormat as ct,RedFormat as ut,RGBAIntegerFormat as pt,RedIntegerFormat as At,UniformsUtils as gt,MeshDepthMaterial as ft,RGBADepthPacking as mt,MeshDistanceMaterial as _t,ShaderChunk as bt,CubeTexture as yt,BoxGeometry as vt,EventDispatcher as Ct,MOUSE as wt,TOUCH as Et,Spherical as It,Euler as Tt,Raycaster as xt,Controls as St,CylinderGeometry as Bt,OctahedronGeometry as Dt,TorusGeometry as Pt}from"three";let Mt={};Mt.dynamicAssets=new Set,Mt.loadingLocks=new Set;const kt={AUDIO:"AUDIO",COMPONENT:"COMPONENT",CUSTOM_ASSET:"CUSTOM_ASSET",IMAGE:"IMAGE",INTERNAL:"INTERNAL",LIGHT:"LIGHT",MATERIAL:"MATERIAL",MODEL:"MODEL",SHAPE:"SHAPE",SYSTEM:"SYSTEM",TEXT:"TEXT",TEXTURE:"TEXTURE",VIDEO:"VIDEO"},Rt={ASSET_ADDED:"ASSET_ADDED",AUDIO_ADDED:"AUDIO_ADDED",AUDIO_CREATED:"AUDIO_CREATED",AUDIO_DELETED:"AUDIO_DELETED",AUDIO_UPDATED:"AUDIO_UPDATED",AUDIO_ATTACHED:"AUDIO_ATTACHED",AUDIO_DETACHED:"AUDIO_DETACHED",AVATAR_UPDATED:"AVATAR_UPDATED",BECOME_PARTY_HOST:"BECOME_PARTY_HOST",BOOT_PEER:"BOOT_PEER",COMPONENT_ADDED:"COMPONENT_ADDED",COMPONENT_CREATED:"COMPONENT_CREATED",COMPONENT_DELETED:"COMPONENT_DELETED",COMPONENT_UPDATED:"COMPONENT_UPDATED",COMPONENT_ATTACHED:"COMPONENT_ATTACHED",COMPONENT_DETACHED:"COMPONENT_DETACHED",CUSTOM_ASSET_ADDED:"CUSTOM_ASSET_ADDED",CUSTOM_ASSET_CREATED:"CUSTOM_ASSET_CREATED",CUSTOM_ASSET_DELETED:"CUSTOM_ASSET_DELETED",CUSTOM_ASSET_UPDATED:"CUSTOM_ASSET_UPDATED",CUSTOM_ASSET_ATTACHED:"CUSTOM_ASSET_ATTACHED",CUSTOM_ASSET_DETACHED:"CUSTOM_ASSET_DETACHED",EMPTY_CLICK:"EMPTY_CLICK",ENTITY_ADDED:"ENTITY_ADDED",ENTITY_ATTACHED:"ENTITY_ATTACHED",IMAGE_ADDED:"IMAGE_ADDED",IMAGE_CREATED:"IMAGE_CREATED",IMAGE_DELETED:"IMAGE_DELETED",IMAGE_UPDATED:"IMAGE_UPDATED",IMAGE_ATTACHED:"IMAGE_ATTACHED",IMAGE_DETACHED:"IMAGE_DETACHED",INSTANCE_ATTACHED:"INSTANCE_ATTACHED",INSTANCE_DETACHED:"INSTANCE_DETACHED",INTERNAL_ADDED:"INTERNAL_ADDED",INTERNAL_DELETED:"INTERNAL_DELETED",INTERNAL_UPDATED:"INTERNAL_UPDATED",LIGHT_ADDED:"LIGHT_ADDED",LIGHT_CREATED:"LIGHT_CREATED",LIGHT_DELETED:"LIGHT_DELETED",LIGHT_UPDATED:"LIGHT_UPDATED",LIGHT_ATTACHED:"LIGHT_ATTACHED",LIGHT_DETACHED:"LIGHT_DETACHED",MATERIAL_ADDED:"MATERIAL_ADDED",MATERIAL_CREATED:"MATERIAL_CREATED",MATERIAL_DELETED:"MATERIAL_DELETED",MATERIAL_UPDATED:"MATERIAL_UPDATED",MENU_NOTIFICATION:"MENU_NOTIFICATION",MODEL_ADDED:"MODEL_ADDED",MODEL_CREATED:"MODEL_CREATED",MODEL_DELETED:"MODEL_DELETED",MODEL_UPDATED:"MODEL_UPDATED",MODEL_ATTACHED:"MODEL_ATTACHED",MODEL_DETACHED:"MODEL_DETACHED",NOTIFICATION:"NOTIFICATION",PARTY_ENDED:"PARTY_ENDED",PARTY_STARTED:"PARTY_STARTED",PEER_CONNECTED:"PEER_CONNECTED",PEER_DISCONNECTED:"PEER_DISCONNECTED",PEER_READY:"PEER_READY",PEER_USERNAME_UPDATED:"PEER_USERNAME_UPDATED",PROJECT_LOADING:"PROJECT_LOADING",PROJECT_SAVING:"PROJECT_SAVING",SANITIZE_INTERNALS:"SANITIZE_INTERNALS",SETTINGS_UPDATED:"SETTINGS_UPDATED",SHAPE_ADDED:"SHAPE_ADDED",SHAPE_CREATED:"SHAPE_CREATED",SHAPE_DELETED:"SHAPE_DELETED",SHAPE_UPDATED:"SHAPE_UPDATED",SHAPE_ATTACHED:"SHAPE_ATTACHED",SHAPE_DETACHED:"SHAPE_DETACHED",SESSION_STARTED:"SESSION_STARTED",SESSION_ENDED:"SESSION_ENDED",SYSTEM_ADDED:"SYSTEM_ADDED",SYSTEM_CREATED:"SYSTEM_CREATED",SYSTEM_DELETED:"SYSTEM_DELETED",SYSTEM_UPDATED:"SYSTEM_UPDATED",TEXT_ADDED:"TEXT_ADDED",TEXT_CREATED:"TEXT_CREATED",TEXT_DELETED:"TEXT_DELETED",TEXT_UPDATED:"TEXT_UPDATED",TEXT_ATTACHED:"TEXT_ATTACHED",TEXT_DETACHED:"TEXT_DETACHED",TEXTURE_ADDED:"TEXTURE_ADDED",TEXTURE_CREATED:"TEXTURE_CREATED",TEXTURE_DELETED:"TEXTURE_DELETED",TEXTURE_RECREATED:"TEXTURE_RECREATED",TEXTURE_UPDATED:"TEXTURE_UPDATED",USER_PERSPECTIVE_CHANGED:"USER_PERSPECTIVE_CHANGED",USERNAME_UPDATED:"USERNAME_UPDATED",VIDEO_ADDED:"VIDEO_ADDED",VIDEO_CREATED:"VIDEO_CREATED",VIDEO_DELETED:"VIDEO_DELETED",VIDEO_UPDATED:"VIDEO_UPDATED",VIDEO_ATTACHED:"VIDEO_ATTACHED",VIDEO_DETACHED:"VIDEO_DETACHED"},Ft={COMPONENT:"COMPONENT",CUSTOM_ASSET:"CUSTOM_ASSET",LIGHT:"LIGHT",MATERIAL:"MATERIAL",SHAPE:"SHAPE",SYSTEM:"SYSTEM",TEXT:"TEXT",TEXTURE:"TEXTURE"},Lt={mp3:"mp3",wav:"wav"},Ot={jpg:"jpg",jpeg:"jpeg",png:"png"},Ut={glb:"glb"},Nt={mp4:"mp4",webm:"webm"};let Qt=new class PubSub{constructor(){this._topics={},this._toPublish=[]}subscribe(r,A,b){A in this._topics||(this._topics[A]={}),this._topics[A][r]=b}unsubscribe(r,A){A in this._topics&&(delete this._topics[A][r],0==Object.keys(this._topics[A]).length&&delete this._topics[A])}publish(r,A,b,C){C?this._publish(r,A,b):this._toPublish.push((()=>{this._publish(r,A,b)}))}_splitTopic(r){let A=r.split(":"),b=A[0],C=[b];for(let r=1;r<A.length;r++)b+=":"+A[r],C.push(b);return C}_publish(r,A,b){let C=this._splitTopic(A);for(let A of C){if(!(A in this._topics))continue;let C=this._topics[A];for(let A in C)A!=r&&C[A](b)}}update(){for(let r of this._toPublish)r();this._toPublish=[]}};const uuidv4=()=>([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(r=>(r^crypto.getRandomValues(new Uint8Array(1))[0]&15>>r/4).toString(16))),uuidToBytes=r=>{let A=new Uint8Array(16);return(r.replace(/-/g,"").match(/.{2}/g)||[]).map(((r,b)=>A[b]=parseInt(r,16))),A},uuidFromBytes=r=>{let A=[];for(let b of r)A.push(("00"+b.toString(16)).slice(-2));return A.join("").replace(/(.{8})(.{4})(.{4})(.{4})(.{12})/,"$1-$2-$3-$4-$5")},numberOr$1=(r,A)=>"number"==typeof r?r:A,stringOr=(r,A)=>"string"==typeof r?r:A,stringWithMaxLength=(r,A)=>r.length>A?r.substring(0,A)+"...":r,fullDispose=(A,b)=>{A.traverse((A=>{(A instanceof r.Mesh||A instanceof r.Line)&&(A.geometry&&A.geometry.dispose(),A.material&&(Array.isArray(A.material)?A.material.forEach((r=>{disposeMaterial(r,b)})):disposeMaterial(A.material,b)))}))},disposeMaterial=(r,A)=>{A&&(r.alphaMap&&r.alphaMap.dispose(),r.aoMap&&r.aoMap.dispose(),r.bumpMap&&r.bumpMap.dispose(),r.displacementMap&&r.displacementMap.dispose(),r.emissiveMap&&r.emissiveMap.dispose(),r.envMap&&r.envMap.dispose(),r.gradientMap&&r.gradientMap.dispose(),r.lightMap&&r.lightMap.dispose(),r.map&&r.map.dispose(),r.metalnessMap&&r.metalnessMap.dispose(),r.normalMap&&r.normalMap.dispose(),r.roughnessMap&&r.roughnessMap.dispose(),r.specularMap&&r.specularMap.dispose()),r.dispose()},buildBVH=A=>{A.traverse((A=>{(A instanceof r.Mesh||A instanceof r.Line)&&A.geometry&&A.geometry.computeBoundsTree()}))},roundWithPrecision=(r,A)=>{let b=A||9;return Number(r.toFixed(b))};r.Vector3.prototype.roundWithPrecision=function(r){let A=r||9,b=[this.x,this.y,this.z];return this.setX(roundWithPrecision(this.x,A)),this.setY(roundWithPrecision(this.y,A)),this.setZ(roundWithPrecision(this.z,A)),this.x!=b[0]||this.y!=b[1]||this.z!=b[2]},r.Euler.prototype.roundWithPrecision=function(r){let A=r||9,b=[this.x,this.y,this.z];return this.set(roundWithPrecision(this.x,A),roundWithPrecision(this.y,A),roundWithPrecision(this.z,A)),this.x!=b[0]||this.y!=b[1]||this.z!=b[2]},r.Cache.enabled=!0;function hueToRGB$1(r,A,b){return b<0&&(b+=1),b>1&&(b-=1),b<1/6?r+6*(A-r)*b:b<.5?A:b<2/3?r+(A-r)*(2/3-b)*6:r}const blobToHash=r=>new Promise(((A,b)=>{r.arrayBuffer().then((r=>{crypto.subtle.digest("SHA-256",r).then((r=>{let b=Array.from(new Uint8Array(r)).map((r=>r.toString(16).padStart(2,"0"))).join("");A(b)}))})).catch(b)})),concatenateArrayBuffers=(...r)=>concatenateArrayBuffersFromList(r),concatenateArrayBuffersFromList=r=>{let A=0;for(let b of r)A+=b.byteLength;let b=new Uint8Array(A),C=0;for(let A of r)A.buffer&&(A=A.buffer),b.set(new Uint8Array(A),C),C+=A.byteLength;return b.buffer},storeStringValuesInSet=(r,A)=>{if("object"==typeof r)for(let b in r){let C=r[b];"string"==typeof C?A.add(C):storeStringValuesInSet(C,A)}};function ascSort(r,A){return r.distance-A.distance}function intersectObject(r,A,b,C){if(r.layers.test(A.layers)&&r.raycast(A,b),!0===C){const C=r.children;for(let r=0,I=C.length;r<I;r++)intersectObject(C[r],A,b,!0)}}const intersectRelevantObjects=(r,A,b)=>{let C=[];for(let I=0,x=A.length;I<x;I++)A[I]!=b&&intersectObject(A[I],r,C,!0);return C.sort(ascSort),C};class Queue{constructor(){this.items={},this.headIndex=0,this.tailIndex=0,this.length=0}enqueue(r){this.items[this.tailIndex]=r,this.tailIndex++,this.length++}dequeue(){const r=this.items[this.headIndex];return delete this.items[this.headIndex],this.headIndex++,this.length--,r}peek(){return this.items[this.headIndex]}}var Ht=Object.freeze({__proto__:null,Queue:Queue,blobToHash:blobToHash,buildBVH:buildBVH,cartesianToPolar:(r,A)=>[Math.sqrt(r*r+A*A),Math.atan2(A,r)],compareLists:(r,A)=>r.length==A.length&&r.reduce(((r,b,C)=>r&&A[C]==b),!0),concatenateArrayBuffers:concatenateArrayBuffers,concatenateArrayBuffersFromList:concatenateArrayBuffersFromList,disposeMaterial:disposeMaterial,fullDispose:fullDispose,hslToRGB:(r,A,b)=>{let C,I,x;if(r/=360,0==A)C=I=x=b;else{let S=b<.5?b*(1+A):b+A-b*A,B=2*b-S;C=hueToRGB$1(B,S,r+1/3),I=hueToRGB$1(B,S,r),x=hueToRGB$1(B,S,r-1/3)}return[Math.round(255*C),Math.round(255*I),Math.round(255*x)]},intersectRelevantObjects:intersectRelevantObjects,numberOr:numberOr$1,polarToCartesian:(r,A)=>[r*Math.cos(A),r*Math.sin(A)],radiansToDegrees:r=>(r+Math.PI)/(2*Math.PI)*360,rgbToHex:(r,A,b)=>r<<16^A<<8^b<<0,roundWithPrecision:roundWithPrecision,storeStringValuesInSet:storeStringValuesInSet,stringOr:stringOr,stringWithMaxLength:stringWithMaxLength,typedArrayToArray:r=>[].slice.call(r),uuidFromBytes:uuidFromBytes,uuidToBytes:uuidToBytes,uuidv4:uuidv4});class Style{constructor(r={}){this._listeners=new Set;for(let A of Style.PROPERTIES)A in r&&(this["_"+A]=r[A])}addUpdateListener(r){this._listeners.add(r)}removeUpdateListener(r){this._listeners.delete(r)}_genericGet(r){return this["_"+r]}_genericSet(r,A){this["_"+r]=A;for(let A of this._listeners)A(r)}get alignItems(){return this._genericGet("alignItems")}get backgroundVisible(){return this._genericGet("backgroundVisible")}get borderMaterial(){return this._genericGet("borderMaterial")}get borderRadius(){return this._genericGet("borderRadius")}get borderBottomLeftRadius(){return this._genericGet("borderBottomLeftRadius")}get borderBottomRightRadius(){return this._genericGet("borderBottomRightRadius")}get borderTopLeftRadius(){return this._genericGet("borderTopLeftRadius")}get borderTopRightRadius(){return this._genericGet("borderTopRightRadius")}get borderWidth(){return this._genericGet("borderWidth")}get color(){return this._genericGet("color")}get contentDirection(){return this._genericGet("contentDirection")}get font(){return this._genericGet("font")}get fontSize(){return this._genericGet("fontSize")}get glassmorphism(){return this._genericGet("glassmorphism")}get height(){return this._genericGet("height")}get justifyContent(){return this._genericGet("justifyContent")}get margin(){return this._genericGet("margin")}get marginBottom(){return this._genericGet("marginBottom")}get marginLeft(){return this._genericGet("marginLeft")}get marginRight(){return this._genericGet("marginRight")}get marginTop(){return this._genericGet("marginTop")}get material(){return this._genericGet("material")}get materialColor(){return this._genericGet("materialColor")}get maxHeight(){return this._genericGet("maxHeight")}get maxWidth(){return this._genericGet("maxWidth")}get minHeight(){return this._genericGet("minHeight")}get minWidth(){return this._genericGet("minWidth")}get opacity(){return this._genericGet("opacity")}get overflow(){return this._genericGet("overflow")}get padding(){return this._genericGet("padding")}get paddingBottom(){return this._genericGet("paddingBottom")}get paddingLeft(){return this._genericGet("paddingLeft")}get paddingRight(){return this._genericGet("paddingRight")}get paddingTop(){return this._genericGet("paddingTop")}get pointerInteractableClassOverride(){return this._genericGet("pointerInteractableClassOverride")}get textAlign(){return this._genericGet("textAlign")}get textureFit(){return this._genericGet("textureFit")}get width(){return this._genericGet("width")}set alignItems(r){this._genericSet("alignItems",r)}set backgroundVisible(r){this._genericSet("backgroundVisible",r)}set borderMaterial(r){this._genericSet("borderMaterial",r)}set borderRadius(r){this._genericSet("borderRadius",r)}set borderBottomLeftRadius(r){this._genericSet("borderBottomLeftRadius",r)}set borderBottomRightRadius(r){this._genericSet("borderBottomRightRadius",r)}set borderTopLeftRadius(r){this._genericSet("borderTopLeftRadius",r)}set borderTopRightRadius(r){this._genericSet("borderTopRightRadius",r)}set borderWidth(r){this._genericSet("borderWidth",r)}set color(r){this._genericSet("color",r)}set contentDirection(r){this._genericSet("contentDirection",r)}set font(r){this._genericSet("font",r)}set fontSize(r){this._genericSet("fontSize",r)}set glassmorphism(r){this._genericSet("glassmorphism",r)}set height(r){this._genericSet("height",r)}set justifyContent(r){this._genericSet("justifyContent",r)}set margin(r){this._genericSet("margin",r)}set marginBottom(r){this._genericSet("marginBottom",r)}set marginLeft(r){this._genericSet("marginLeft",r)}set marginRight(r){this._genericSet("marginRight",r)}set marginTop(r){this._genericSet("marginTop",r)}set material(r){this._genericSet("material",r)}set materialColor(r){this._genericSet("materialColor",r)}set maxHeight(r){this._genericSet("maxHeight",r)}set maxWidth(r){this._genericSet("maxWidth",r)}set minHeight(r){this._genericSet("minHeight",r)}set minWidth(r){this._genericSet("minWidth",r)}set opacity(r){this._genericSet("opacity",r)}set overflow(r){this._genericSet("overflow",r)}set padding(r){this._genericSet("padding",r)}set paddingBottom(r){this._genericSet("paddingBottom",r)}set paddingLeft(r){this._genericSet("paddingLeft",r)}set paddingRight(r){this._genericSet("paddingRight",r)}set paddingTop(r){this._genericSet("paddingTop",r)}set pointerInteractableClassOverride(r){this._genericSet("pointerInteractableClassOverride",r)}set textAlign(r){this._genericSet("textAlign",r)}set textureFit(r){this._genericSet("textureFit",r)}set width(r){this._genericSet("width",r)}static PROPERTIES=["alignItems","backgroundVisible","borderMaterial","borderRadius","borderBottomLeftRadius","borderBottomRightRadius","borderTopLeftRadius","borderTopRightRadius","borderWidth","color","contentDirection","font","fontSize","glassmorphism","height","justifyContent","margin","marginBottom","marginLeft","marginRight","marginTop","material","materialColor","maxHeight","maxWidth","minHeight","minWidth","padding","paddingBottom","paddingLeft","paddingRight","paddingTop","pointerInteractableClassOverride","opacity","overflow","textAlign","textureFit","width"]}const Gt=0,jt=1,Vt=2,zt=2,Wt=1.25,Xt=1,Yt=32,Kt=65535,qt=Math.pow(2,-24),Zt=Symbol("SKIP_GENERATION");function getVertexCount(r){return r.index?r.index.count:r.attributes.position.count}function getTriCount(r){return getVertexCount(r)/3}function getIndexArray(r,A=ArrayBuffer){return r>65535?new Uint32Array(new A(4*r)):new Uint16Array(new A(2*r))}function getFullGeometryRange(r,A){const b=getTriCount(r),C=A||r.drawRange,I=C.start/3,x=(C.start+C.count)/3,S=Math.max(0,I),B=Math.min(b,x)-S;return[{offset:Math.floor(S),count:Math.floor(B)}]}function getRootIndexRanges(r,A){if(!r.groups||!r.groups.length)return getFullGeometryRange(r,A);const b=[],C=new Set,I=A||r.drawRange,x=I.start/3,S=(I.start+I.count)/3;for(const A of r.groups){const r=A.start/3,b=(A.start+A.count)/3;C.add(Math.max(x,r)),C.add(Math.min(S,b))}const B=Array.from(C.values()).sort(((r,A)=>r-A));for(let r=0;r<B.length-1;r++){const A=B[r],C=B[r+1];b.push({offset:Math.floor(A),count:Math.floor(C-A)})}return b}function getBounds(r,A,b,C,I){let x=1/0,S=1/0,B=1/0,D=-1/0,R=-1/0,F=-1/0,N=1/0,Q=1/0,H=1/0,G=-1/0,j=-1/0,V=-1/0;for(let C=6*A,I=6*(A+b);C<I;C+=6){const A=r[C+0],b=r[C+1],I=A-b,W=A+b;I<x&&(x=I),W>D&&(D=W),A<N&&(N=A),A>G&&(G=A);const X=r[C+2],Y=r[C+3],K=X-Y,q=X+Y;K<S&&(S=K),q>R&&(R=q),X<Q&&(Q=X),X>j&&(j=X);const Z=r[C+4],J=r[C+5],$=Z-J,ee=Z+J;$<B&&(B=$),ee>F&&(F=ee),Z<H&&(H=Z),Z>V&&(V=Z)}C[0]=x,C[1]=S,C[2]=B,C[3]=D,C[4]=R,C[5]=F,I[0]=N,I[1]=Q,I[2]=H,I[3]=G,I[4]=j,I[5]=V}function arrayToBox(r,A,b){return b.min.x=A[r],b.min.y=A[r+1],b.min.z=A[r+2],b.max.x=A[r+3],b.max.y=A[r+4],b.max.z=A[r+5],b}function getLongestEdgeIndex(r){let A=-1,b=-1/0;for(let C=0;C<3;C++){const I=r[C+3]-r[C];I>b&&(b=I,A=C)}return A}function copyBounds(r,A){A.set(r)}function unionBounds(r,A,b){let C,I;for(let x=0;x<3;x++){const S=x+3;C=r[x],I=A[x],b[x]=C<I?C:I,C=r[S],I=A[S],b[S]=C>I?C:I}}function expandByTriangleBounds(r,A,b){for(let C=0;C<3;C++){const I=A[r+2*C],x=A[r+2*C+1],S=I-x,B=I+x;S<b[C]&&(b[C]=S),B>b[C+3]&&(b[C+3]=B)}}function computeSurfaceArea(r){const A=r[3]-r[0],b=r[4]-r[1],C=r[5]-r[2];return 2*(A*b+b*C+C*A)}const Jt=32,binsSort=(r,A)=>r.candidate-A.candidate,$t=new Array(Jt).fill().map((()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0}))),es=new Float32Array(6);class MeshBVHNode{constructor(){this.boundingData=new Float32Array(6)}}function partition(r,A,b,C,I,x){let S=C,B=C+I-1;const D=x.pos,R=2*x.axis;for(;;){for(;S<=B&&b[6*S+R]<D;)S++;for(;S<=B&&b[6*B+R]>=D;)B--;if(!(S<B))return S;for(let r=0;r<3;r++){let b=A[3*S+r];A[3*S+r]=A[3*B+r],A[3*B+r]=b}for(let r=0;r<6;r++){let A=b[6*S+r];b[6*S+r]=b[6*B+r],b[6*B+r]=A}S++,B--}}function partition_indirect(r,A,b,C,I,x){let S=C,B=C+I-1;const D=x.pos,R=2*x.axis;for(;;){for(;S<=B&&b[6*S+R]<D;)S++;for(;S<=B&&b[6*B+R]>=D;)B--;if(!(S<B))return S;{let A=r[S];r[S]=r[B],r[B]=A;for(let r=0;r<6;r++){let A=b[6*S+r];b[6*S+r]=b[6*B+r],b[6*B+r]=A}S++,B--}}}function IS_LEAF(r,A){return 65535===A[r+15]}function OFFSET(r,A){return A[r+6]}function COUNT(r,A){return A[r+14]}function LEFT_NODE(r){return r+8}function RIGHT_NODE(r,A){return A[r+6]}function SPLIT_AXIS(r,A){return A[r+7]}let ts,ss,is,ns;const rs=Math.pow(2,32);function countNodes(r){return"count"in r?1:1+countNodes(r.left)+countNodes(r.right)}function populateBuffer(r,A,b){return ts=new Float32Array(b),ss=new Uint32Array(b),is=new Uint16Array(b),ns=new Uint8Array(b),_populateBuffer(r,A)}function _populateBuffer(r,A){const b=r/4,C=r/2,I="count"in A,x=A.boundingData;for(let r=0;r<6;r++)ts[b+r]=x[r];if(I){if(A.buffer){const C=A.buffer;ns.set(new Uint8Array(C),r);for(let A=r,I=r+C.byteLength;A<I;A+=Yt)IS_LEAF(A/2,is)||(ss[A/4+6]+=b);return r+C.byteLength}{const I=A.offset,x=A.count;return ss[b+6]=I,is[C+14]=x,is[C+15]=Kt,r+Yt}}{const C=A.left,I=A.right,x=A.splitAxis;let S;if(S=_populateBuffer(r+Yt,C),S/4>rs)throw new Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return ss[b+6]=S/4,S=_populateBuffer(S,I),ss[b+7]=x,S}}function buildPackedTree(r,A){const b=r.geometry;A.indirect&&(r._indirectBuffer=function(r,A){const b=(r.index?r.index.count:r.attributes.position.count)/3,C=b>65536,I=C?4:2,x=A?new SharedArrayBuffer(b*I):new ArrayBuffer(b*I),S=C?new Uint32Array(x):new Uint16Array(x);for(let r=0,A=S.length;r<A;r++)S[r]=r;return S}(b,A.useSharedArrayBuffer),function(r,A){const b=getTriCount(r),C=getRootIndexRanges(r,A).sort(((r,A)=>r.offset-A.offset)),I=C[C.length-1];I.count=Math.min(b-I.offset,I.count);let x=0;return C.forEach((({count:r})=>x+=r)),b!==x}(b,A.range)&&!A.verbose&&console.warn('MeshBVH: Provided geometry contains groups or a range that do not fully span the vertex contents while using the "indirect" option. BVH may incorrectly report intersections on unrendered portions of the geometry.')),r._indirectBuffer||function(r,A){if(!r.index){const b=r.attributes.position.count,C=getIndexArray(b,A.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer);r.setIndex(new $(C,1));for(let r=0;r<b;r++)C[r]=r}}(b,A);const C=A.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,I=function(r,A=null,b=null,C=null){const I=r.attributes.position,x=r.index?r.index.array:null,S=getTriCount(r),B=I.normalized;let D;null===A?(D=new Float32Array(6*S*4),b=0,C=S):(D=A,b=b||0,C=C||S);const R=I.array,F=I.offset||0;let N=3;I.isInterleavedBufferAttribute&&(N=I.data.stride);const Q=["getX","getY","getZ"];for(let r=b;r<b+C;r++){const A=3*r,b=6*r;let C=A+0,S=A+1,H=A+2;x&&(C=x[C],S=x[S],H=x[H]),B||(C=C*N+F,S=S*N+F,H=H*N+F);for(let r=0;r<3;r++){let A,x,F;B?(A=I[Q[r]](C),x=I[Q[r]](S),F=I[Q[r]](H)):(A=R[C+r],x=R[S+r],F=R[H+r]);let N=A;x<N&&(N=x),F<N&&(N=F);let G=A;x>G&&(G=x),F>G&&(G=F);const j=(G-N)/2,V=2*r;D[b+V+0]=N+j,D[b+V+1]=j+(Math.abs(N)+j)*qt}}return D}(b),x=A.indirect?getFullGeometryRange(b,A.range):getRootIndexRanges(b,A.range);r._roots=x.map((b=>{const x=function buildTree(r,A,b,C,I){const{maxDepth:x,verbose:S,maxLeafTris:B,strategy:D,onProgress:R,indirect:F}=I,N=r._indirectBuffer,Q=r.geometry,H=Q.index?Q.index.array:null,G=F?partition_indirect:partition,j=getTriCount(Q),V=new Float32Array(6);let W=!1;const X=new MeshBVHNode;return getBounds(A,b,C,X.boundingData,V),function splitNode(r,b,C,I=null,R=0){if(!W&&R>=x&&(W=!0,S&&(console.warn(`MeshBVH: Max depth of ${x} reached when generating BVH. Consider increasing maxDepth.`),console.warn(Q))),C<=B||R>=x)return triggerProgress(b+C),r.offset=b,r.count=C,r;const F=function(r,A,b,C,I,x){let S=-1,B=0;if(x===Gt)S=getLongestEdgeIndex(A),-1!==S&&(B=(A[S]+A[S+3])/2);else if(x===jt)S=getLongestEdgeIndex(r),-1!==S&&(B=function(r,A,b,C){let I=0;for(let x=A,S=A+b;x<S;x++)I+=r[6*x+2*C];return I/b}(b,C,I,S));else if(x===Vt){const x=computeSurfaceArea(r);let D=Wt*I;const R=6*C,F=6*(C+I);for(let r=0;r<3;r++){const C=A[r],N=(A[r+3]-C)/Jt;if(I<Jt/4){const A=[...$t];A.length=I;let C=0;for(let I=R;I<F;I+=6,C++){const x=A[C];x.candidate=b[I+2*r],x.count=0;const{bounds:S,leftCacheBounds:B,rightCacheBounds:D}=x;for(let r=0;r<3;r++)D[r]=1/0,D[r+3]=-1/0,B[r]=1/0,B[r+3]=-1/0,S[r]=1/0,S[r+3]=-1/0;expandByTriangleBounds(I,b,S)}A.sort(binsSort);let N=I;for(let r=0;r<N;r++){const b=A[r];for(;r+1<N&&A[r+1].candidate===b.candidate;)A.splice(r+1,1),N--}for(let C=R;C<F;C+=6){const I=b[C+2*r];for(let r=0;r<N;r++){const x=A[r];I>=x.candidate?expandByTriangleBounds(C,b,x.rightCacheBounds):(expandByTriangleBounds(C,b,x.leftCacheBounds),x.count++)}}for(let b=0;b<N;b++){const C=A[b],R=C.count,F=I-C.count,N=C.leftCacheBounds,Q=C.rightCacheBounds;let H=0;0!==R&&(H=computeSurfaceArea(N)/x);let G=0;0!==F&&(G=computeSurfaceArea(Q)/x);const j=Xt+Wt*(H*R+G*F);j<D&&(S=r,D=j,B=C.candidate)}}else{for(let r=0;r<Jt;r++){const A=$t[r];A.count=0,A.candidate=C+N+r*N;const b=A.bounds;for(let r=0;r<3;r++)b[r]=1/0,b[r+3]=-1/0}for(let A=R;A<F;A+=6){let I=~~((b[A+2*r]-C)/N);I>=Jt&&(I=Jt-1);const x=$t[I];x.count++,expandByTriangleBounds(A,b,x.bounds)}const A=$t[Jt-1];copyBounds(A.bounds,A.rightCacheBounds);for(let r=Jt-2;r>=0;r--){const A=$t[r],b=$t[r+1];unionBounds(A.bounds,b.rightCacheBounds,A.rightCacheBounds)}let Q=0;for(let A=0;A<Jt-1;A++){const b=$t[A],C=b.count,R=b.bounds,F=$t[A+1].rightCacheBounds;0!==C&&(0===Q?copyBounds(R,es):unionBounds(R,es,es)),Q+=C;let N=0,H=0;0!==Q&&(N=computeSurfaceArea(es)/x);const G=I-Q;0!==G&&(H=computeSurfaceArea(F)/x);const j=Xt+Wt*(N*Q+H*G);j<D&&(S=r,D=j,B=b.candidate)}}}}else console.warn(`MeshBVH: Invalid build strategy value ${x} used.`);return{axis:S,pos:B}}(r.boundingData,I,A,b,C,D);if(-1===F.axis)return triggerProgress(b+C),r.offset=b,r.count=C,r;const j=G(N,H,A,b,C,F);if(j===b||j===b+C)triggerProgress(b+C),r.offset=b,r.count=C;else{r.splitAxis=F.axis;const I=new MeshBVHNode,x=b,S=j-b;r.left=I,getBounds(A,x,S,I.boundingData,V),splitNode(I,x,S,V,R+1);const B=new MeshBVHNode,D=j,N=C-S;r.right=B,getBounds(A,D,N,B.boundingData,V),splitNode(B,D,N,V,R+1)}return r}(X,b,C,V),X;function triggerProgress(r){R&&R(r/j)}}(r,I,b.offset,b.count,A),S=countNodes(x),B=new C(Yt*S);return populateBuffer(0,x,B),B}))}class SeparatingAxisBounds{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(r,A){let b=1/0,C=-1/0;for(let I=0,x=r.length;I<x;I++){const x=r[I][A];b=x<b?x:b,C=x>C?x:C}this.min=b,this.max=C}setFromPoints(r,A){let b=1/0,C=-1/0;for(let I=0,x=A.length;I<x;I++){const x=A[I],S=r.dot(x);b=S<b?S:b,C=S>C?S:C}this.min=b,this.max=C}isSeparated(r){return this.min>r.max||r.min>this.max}}SeparatingAxisBounds.prototype.setFromBox=function(){const r=new A;return function(A,b){const C=b.min,I=b.max;let x=1/0,S=-1/0;for(let b=0;b<=1;b++)for(let B=0;B<=1;B++)for(let D=0;D<=1;D++){r.x=C.x*b+I.x*(1-b),r.y=C.y*B+I.y*(1-B),r.z=C.z*D+I.z*(1-D);const R=A.dot(r);x=Math.min(R,x),S=Math.max(R,S)}this.min=x,this.max=S}}();const as=function(){const r=new A,b=new A,C=new A;return function(A,I,x){const S=A.start,B=r,D=I.start,R=b;C.subVectors(S,D),r.subVectors(A.end,A.start),b.subVectors(I.end,I.start);const F=C.dot(R),N=R.dot(B),Q=R.dot(R),H=C.dot(B),G=B.dot(B)*Q-N*N;let j,V;j=0!==G?(F*N-H*Q)/G:0,V=(F+j*N)/Q,x.x=j,x.y=V}}(),os=function(){const r=new b,C=new A,I=new A;return function(A,b,x,S){as(A,b,r);let B=r.x,D=r.y;if(B>=0&&B<=1&&D>=0&&D<=1)return A.at(B,x),void b.at(D,S);if(B>=0&&B<=1)return D<0?b.at(0,S):b.at(1,S),void A.closestPointToPoint(S,!0,x);if(D>=0&&D<=1)return B<0?A.at(0,x):A.at(1,x),void b.closestPointToPoint(x,!0,S);{let r,R;r=B<0?A.start:A.end,R=D<0?b.start:b.end;const F=C,N=I;return A.closestPointToPoint(R,!0,C),b.closestPointToPoint(r,!0,I),F.distanceToSquared(R)<=N.distanceToSquared(r)?(x.copy(F),void S.copy(R)):(x.copy(r),void S.copy(N))}}}(),ls=function(){const r=new A,b=new A,x=new C,S=new I;return function(A,C){const{radius:I,center:B}=A,{a:D,b:R,c:F}=C;if(S.start=D,S.end=R,S.closestPointToPoint(B,!0,r).distanceTo(B)<=I)return!0;if(S.start=D,S.end=F,S.closestPointToPoint(B,!0,r).distanceTo(B)<=I)return!0;if(S.start=R,S.end=F,S.closestPointToPoint(B,!0,r).distanceTo(B)<=I)return!0;const N=C.getPlane(x);if(Math.abs(N.distanceToPoint(B))<=I){const r=N.projectPoint(B,b);if(C.containsPoint(r))return!0}return!1}}();function isNearZero(r){return Math.abs(r)<1e-15}class ExtendedTriangle extends j{constructor(...r){super(...r),this.isExtendedTriangle=!0,this.satAxes=new Array(4).fill().map((()=>new A)),this.satBounds=new Array(4).fill().map((()=>new SeparatingAxisBounds)),this.points=[this.a,this.b,this.c],this.sphere=new V,this.plane=new C,this.needsUpdate=!0}intersectsSphere(r){return ls(r,this)}update(){const r=this.a,A=this.b,b=this.c,C=this.points,I=this.satAxes,x=this.satBounds,S=I[0],B=x[0];this.getNormal(S),B.setFromPoints(S,C);const D=I[1],R=x[1];D.subVectors(r,A),R.setFromPoints(D,C);const F=I[2],N=x[2];F.subVectors(A,b),N.setFromPoints(F,C);const Q=I[3],H=x[3];Q.subVectors(b,r),H.setFromPoints(Q,C),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(S,r),this.needsUpdate=!1}}ExtendedTriangle.prototype.closestPointToSegment=function(){const r=new A,b=new A,C=new I;return function(A,I=null,x=null){const{start:S,end:B}=A,D=this.points;let R,F=1/0;for(let S=0;S<3;S++){const B=(S+1)%3;C.start.copy(D[S]),C.end.copy(D[B]),os(C,A,r,b),R=r.distanceToSquared(b),R<F&&(F=R,I&&I.copy(r),x&&x.copy(b))}return this.closestPointToPoint(S,r),R=S.distanceToSquared(r),R<F&&(F=R,I&&I.copy(r),x&&x.copy(S)),this.closestPointToPoint(B,r),R=B.distanceToSquared(r),R<F&&(F=R,I&&I.copy(r),x&&x.copy(B)),Math.sqrt(F)}}(),ExtendedTriangle.prototype.intersectsTriangle=function(){const r=new ExtendedTriangle,b=new Array(3),C=new Array(3),x=new SeparatingAxisBounds,S=new SeparatingAxisBounds,B=new A,D=new A,R=new A,F=new A,N=new A,Q=new I,H=new I,G=new I,j=new A;function triIntersectPlane(r,A,b){const C=r.points;let I=0,x=-1;for(let r=0;r<3;r++){const{start:S,end:B}=Q;S.copy(C[r]),B.copy(C[(r+1)%3]),Q.delta(D);const R=isNearZero(A.distanceToPoint(S));if(isNearZero(A.normal.dot(D))&&R){b.copy(Q),I=2;break}const F=A.intersectLine(Q,j);if(!F&&R&&j.copy(S),(F||R)&&!isNearZero(j.distanceTo(B))){if(I<=1)(1===I?b.start:b.end).copy(j),R&&(x=I);else if(I>=2){(1===x?b.start:b.end).copy(j),I=2;break}if(I++,2===I&&-1===x)break}}return I}return function(A,I=null,D=!1){this.needsUpdate&&this.update(),A.isExtendedTriangle?A.needsUpdate&&A.update():(r.copy(A),r.update(),A=r);const Q=this.plane,j=A.plane;if(Math.abs(Q.normal.dot(j.normal))>1-1e-10){const r=this.satBounds,R=this.satAxes;C[0]=A.a,C[1]=A.b,C[2]=A.c;for(let A=0;A<4;A++){const b=r[A],I=R[A];if(x.setFromPoints(I,C),b.isSeparated(x))return!1}const F=A.satBounds,N=A.satAxes;b[0]=this.a,b[1]=this.b,b[2]=this.c;for(let r=0;r<4;r++){const A=F[r],C=N[r];if(x.setFromPoints(C,b),A.isSeparated(x))return!1}for(let r=0;r<4;r++){const A=R[r];for(let r=0;r<4;r++){const I=N[r];if(B.crossVectors(A,I),x.setFromPoints(B,b),S.setFromPoints(B,C),x.isSeparated(S))return!1}}return I&&(D||console.warn("ExtendedTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),I.start.set(0,0,0),I.end.set(0,0,0)),!0}{const r=triIntersectPlane(this,j,H);if(1===r&&A.containsPoint(H.end))return I&&(I.start.copy(H.end),I.end.copy(H.end)),!0;if(2!==r)return!1;const b=triIntersectPlane(A,Q,G);if(1===b&&this.containsPoint(G.end))return I&&(I.start.copy(G.end),I.end.copy(G.end)),!0;if(2!==b)return!1;if(H.delta(R),G.delta(F),R.dot(F)<0){let r=G.start;G.start=G.end,G.end=r}const C=H.start.dot(R),x=H.end.dot(R),S=G.start.dot(R),B=G.end.dot(R);return(C===B||S===x||x<S!=C<B)&&(I&&(N.subVectors(H.start,G.start),N.dot(R)>0?I.start.copy(H.start):I.start.copy(G.start),N.subVectors(H.end,G.end),N.dot(R)<0?I.end.copy(H.end):I.end.copy(G.end)),!0)}}}(),ExtendedTriangle.prototype.distanceToPoint=function(){const r=new A;return function(A){return this.closestPointToPoint(A,r),A.distanceTo(r)}}(),ExtendedTriangle.prototype.distanceToTriangle=function(){const r=new A,b=new A,C=["a","b","c"],x=new I,S=new I;return function(A,I=null,B=null){const D=I||B?x:null;if(this.intersectsTriangle(A,D))return(I||B)&&(I&&D.getCenter(I),B&&D.getCenter(B)),0;let R=1/0;for(let b=0;b<3;b++){let x;const S=C[b],D=A[S];this.closestPointToPoint(D,r),x=D.distanceToSquared(r),x<R&&(R=x,I&&I.copy(r),B&&B.copy(D));const F=this[S];A.closestPointToPoint(F,r),x=F.distanceToSquared(r),x<R&&(R=x,I&&I.copy(F),B&&B.copy(r))}for(let D=0;D<3;D++){const F=C[D],N=C[(D+1)%3];x.set(this[F],this[N]);for(let D=0;D<3;D++){const F=C[D],N=C[(D+1)%3];S.set(A[F],A[N]),os(x,S,r,b);const Q=r.distanceToSquared(b);Q<R&&(R=Q,I&&I.copy(r),B&&B.copy(b))}}return Math.sqrt(R)}}();class OrientedBox{constructor(r,b,C){this.isOrientedBox=!0,this.min=new A,this.max=new A,this.matrix=new S,this.invMatrix=new S,this.points=new Array(8).fill().map((()=>new A)),this.satAxes=new Array(3).fill().map((()=>new A)),this.satBounds=new Array(3).fill().map((()=>new SeparatingAxisBounds)),this.alignedSatBounds=new Array(3).fill().map((()=>new SeparatingAxisBounds)),this.needsUpdate=!1,r&&this.min.copy(r),b&&this.max.copy(b),C&&this.matrix.copy(C)}set(r,A,b){this.min.copy(r),this.max.copy(A),this.matrix.copy(b),this.needsUpdate=!0}copy(r){this.min.copy(r.min),this.max.copy(r.max),this.matrix.copy(r.matrix),this.needsUpdate=!0}}OrientedBox.prototype.update=function(){const r=this.matrix,A=this.min,b=this.max,C=this.points;for(let I=0;I<=1;I++)for(let x=0;x<=1;x++)for(let S=0;S<=1;S++){const B=C[1*I|2*x|4*S];B.x=I?b.x:A.x,B.y=x?b.y:A.y,B.z=S?b.z:A.z,B.applyMatrix4(r)}const I=this.satBounds,x=this.satAxes,S=C[0];for(let r=0;r<3;r++){const A=x[r],b=I[r],B=C[1<<r];A.subVectors(S,B),b.setFromPoints(A,C)}const B=this.alignedSatBounds;B[0].setFromPointsField(C,"x"),B[1].setFromPointsField(C,"y"),B[2].setFromPointsField(C,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1},OrientedBox.prototype.intersectsBox=function(){const r=new SeparatingAxisBounds;return function(A){this.needsUpdate&&this.update();const b=A.min,C=A.max,I=this.satBounds,x=this.satAxes,S=this.alignedSatBounds;if(r.min=b.x,r.max=C.x,S[0].isSeparated(r))return!1;if(r.min=b.y,r.max=C.y,S[1].isSeparated(r))return!1;if(r.min=b.z,r.max=C.z,S[2].isSeparated(r))return!1;for(let b=0;b<3;b++){const C=x[b],S=I[b];if(r.setFromBox(C,A),S.isSeparated(r))return!1}return!0}}(),OrientedBox.prototype.intersectsTriangle=function(){const r=new ExtendedTriangle,b=new Array(3),C=new SeparatingAxisBounds,I=new SeparatingAxisBounds,x=new A;return function(A){this.needsUpdate&&this.update(),A.isExtendedTriangle?A.needsUpdate&&A.update():(r.copy(A),r.update(),A=r);const S=this.satBounds,B=this.satAxes;b[0]=A.a,b[1]=A.b,b[2]=A.c;for(let r=0;r<3;r++){const A=S[r],I=B[r];if(C.setFromPoints(I,b),A.isSeparated(C))return!1}const D=A.satBounds,R=A.satAxes,F=this.points;for(let r=0;r<3;r++){const A=D[r],b=R[r];if(C.setFromPoints(b,F),A.isSeparated(C))return!1}for(let r=0;r<3;r++){const A=B[r];for(let r=0;r<4;r++){const S=R[r];if(x.crossVectors(A,S),C.setFromPoints(x,b),I.setFromPoints(x,F),C.isSeparated(I))return!1}}return!0}}(),OrientedBox.prototype.closestPointToPoint=function(r,A){return this.needsUpdate&&this.update(),A.copy(r).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),A},OrientedBox.prototype.distanceToPoint=function(){const r=new A;return function(A){return this.closestPointToPoint(A,r),A.distanceTo(r)}}(),OrientedBox.prototype.distanceToBox=function(){const r=["x","y","z"],b=new Array(12).fill().map((()=>new I)),C=new Array(12).fill().map((()=>new I)),x=new A,S=new A;return function(A,I=0,B=null,D=null){if(this.needsUpdate&&this.update(),this.intersectsBox(A))return(B||D)&&(A.getCenter(S),this.closestPointToPoint(S,x),A.closestPointToPoint(x,S),B&&B.copy(x),D&&D.copy(S)),0;const R=I*I,F=A.min,N=A.max,Q=this.points;let H=1/0;for(let r=0;r<8;r++){const A=Q[r];S.copy(A).clamp(F,N);const b=A.distanceToSquared(S);if(b<H&&(H=b,B&&B.copy(A),D&&D.copy(S),b<R))return Math.sqrt(b)}let G=0;for(let A=0;A<3;A++)for(let I=0;I<=1;I++)for(let x=0;x<=1;x++){const S=(A+1)%3,B=(A+2)%3,D=1<<A|I<<S|x<<B,R=Q[I<<S|x<<B],H=Q[D];b[G].set(R,H);const j=r[A],V=r[S],W=r[B],X=C[G],Y=X.start,K=X.end;Y[j]=F[j],Y[V]=I?F[V]:N[V],Y[W]=x?F[W]:N[V],K[j]=N[j],K[V]=I?F[V]:N[V],K[W]=x?F[W]:N[V],G++}for(let r=0;r<=1;r++)for(let A=0;A<=1;A++)for(let b=0;b<=1;b++){S.x=r?N.x:F.x,S.y=A?N.y:F.y,S.z=b?N.z:F.z,this.closestPointToPoint(S,x);const C=S.distanceToSquared(x);if(C<H&&(H=C,B&&B.copy(x),D&&D.copy(S),C<R))return Math.sqrt(C)}for(let r=0;r<12;r++){const A=b[r];for(let r=0;r<12;r++){const b=C[r];os(A,b,x,S);const I=x.distanceToSquared(S);if(I<H&&(H=I,B&&B.copy(x),D&&D.copy(S),I<R))return Math.sqrt(I)}}return Math.sqrt(H)}}();class PrimitivePool{constructor(r){this._getNewPrimitive=r,this._primitives=[]}getPrimitive(){const r=this._primitives;return 0===r.length?this._getNewPrimitive():r.pop()}releasePrimitive(r){this._primitives.push(r)}}const hs=new class ExtendedTrianglePoolBase extends PrimitivePool{constructor(){super((()=>new ExtendedTriangle))}},ds=new class{constructor(){this.float32Array=null,this.uint16Array=null,this.uint32Array=null;const r=[];let A=null;this.setBuffer=b=>{A&&r.push(A),A=b,this.float32Array=new Float32Array(b),this.uint16Array=new Uint16Array(b),this.uint32Array=new Uint32Array(b)},this.clearBuffer=()=>{A=null,this.float32Array=null,this.uint16Array=null,this.uint32Array=null,0!==r.length&&this.setBuffer(r.pop())}}};let cs,us;const ps=[],As=new PrimitivePool((()=>new x));function shapecast(r,A,b,C,I,x){cs=As.getPrimitive(),us=As.getPrimitive(),ps.push(cs,us),ds.setBuffer(r._roots[A]);const S=shapecastTraverse(0,r.geometry,b,C,I,x);ds.clearBuffer(),As.releasePrimitive(cs),As.releasePrimitive(us),ps.pop(),ps.pop();const B=ps.length;return B>0&&(us=ps[B-1],cs=ps[B-2]),S}function shapecastTraverse(r,A,b,C,I=null,x=0,S=0){const{float32Array:B,uint16Array:D,uint32Array:R}=ds;let F=2*r;if(IS_LEAF(F,D)){const N=OFFSET(r,R),Q=COUNT(F,D);return arrayToBox(r,B,cs),C(N,Q,!1,S,x+r,cs)}{const H=LEFT_NODE(r),G=RIGHT_NODE(r,R);let j,V,W,X,Y=H,K=G;if(I&&(W=cs,X=us,arrayToBox(Y,B,W),arrayToBox(K,B,X),j=I(W),V=I(X),V<j)){Y=G,K=H;const ee=j;j=V,V=ee,W=X}W||(W=cs,arrayToBox(Y,B,W));const q=b(W,IS_LEAF(2*Y,D),j,S+1,x+Y);let Z;if(q===zt){const te=getLeftOffset(Y);Z=C(te,getRightEndOffset(Y)-te,!0,S+1,x+Y,W)}else Z=q&&shapecastTraverse(Y,A,b,C,I,x,S+1);if(Z)return!0;X=us,arrayToBox(K,B,X);const J=b(X,IS_LEAF(2*K,D),V,S+1,x+K);let $;if(J===zt){const se=getLeftOffset(K);$=C(se,getRightEndOffset(K)-se,!0,S+1,x+K,X)}else $=J&&shapecastTraverse(K,A,b,C,I,x,S+1);return!!$;function getLeftOffset(r){const{uint16Array:A,uint32Array:b}=ds;let C=2*r;for(;!IS_LEAF(C,A);)C=2*(r=LEFT_NODE(r));return OFFSET(r,b)}function getRightEndOffset(r){const{uint16Array:A,uint32Array:b}=ds;let C=2*r;for(;!IS_LEAF(C,A);)C=2*(r=RIGHT_NODE(r,b));return OFFSET(r,b)+COUNT(C,A)}}}const gs=new A,fs=new A,ms=new A,_s=new A,bs=new A,ys=new b,vs=new b,Cs=new b,ws=new A,Es=new A,Is=new A,Ts=new A;function intersectTri(r,C,I,x,S,B,D){const R=3*x;let F=R+0,N=R+1,Q=R+2;const H=r.index;r.index&&(F=H.getX(F),N=H.getX(N),Q=H.getX(Q));const{position:V,normal:W,uv:X,uv1:Y}=r.attributes,K=function checkBufferGeometryIntersection(r,C,I,x,S,B,D,R,F,N,Q){ms.fromBufferAttribute(C,B),_s.fromBufferAttribute(C,D),bs.fromBufferAttribute(C,R);const H=function(r,A,b,C,I,x,S,B){let D;if(D=x===nt?r.intersectTriangle(C,b,A,!0,I):r.intersectTriangle(A,b,C,x!==G,I),null===D)return null;const R=r.origin.distanceTo(I);return R<S||R>B?null:{distance:R,point:I.clone()}}(r,ms,_s,bs,Ts,F,N,Q);if(H){x&&(ys.fromBufferAttribute(x,B),vs.fromBufferAttribute(x,D),Cs.fromBufferAttribute(x,R),H.uv=j.getInterpolation(Ts,ms,_s,bs,ys,vs,Cs,new b)),S&&(ys.fromBufferAttribute(S,B),vs.fromBufferAttribute(S,D),Cs.fromBufferAttribute(S,R),H.uv1=j.getInterpolation(Ts,ms,_s,bs,ys,vs,Cs,new b)),I&&(ws.fromBufferAttribute(I,B),Es.fromBufferAttribute(I,D),Is.fromBufferAttribute(I,R),H.normal=j.getInterpolation(Ts,ms,_s,bs,ws,Es,Is,new A),H.normal.dot(r.direction)>0&&H.normal.multiplyScalar(-1));const C={a:B,b:D,c:R,normal:new A,materialIndex:0};j.getNormal(ms,_s,bs,C.normal),H.face=C,H.faceIndex=B}return H}(I,V,W,X,Y,F,N,Q,C,B,D);return K?(K.faceIndex=x,S&&S.push(K),K):null}function setTriangle(r,A,b,C){const I=r.a,x=r.b,S=r.c;let B=A,D=A+1,R=A+2;b&&(B=b.getX(B),D=b.getX(D),R=b.getX(R)),I.x=C.getX(B),I.y=C.getY(B),I.z=C.getZ(B),x.x=C.getX(D),x.y=C.getY(D),x.z=C.getZ(D),S.x=C.getX(R),S.y=C.getY(R),S.z=C.getZ(R)}const xs=new A,Ss=new A,Bs=new A,Ds=new b,Ps=new b,Ms=new b;function iterateOverTriangles(r,A,b,C,I,x,S){const{geometry:B}=b,{index:D}=B,R=B.attributes.position;for(let b=r,B=A+r;b<B;b++){let r;if(r=b,setTriangle(S,3*r,D,R),S.needsUpdate=!0,C(S,r,I,x))return!0}return!1}function refit(r,A=null){A&&Array.isArray(A)&&(A=new Set(A));const b=r.geometry,C=b.index?b.index.array:null,I=b.attributes.position;let x,S,B,D,R=0;const F=r._roots;for(let r=0,A=F.length;r<A;r++)x=F[r],S=new Uint32Array(x),B=new Uint16Array(x),D=new Float32Array(x),_traverse(0,R),R+=x.byteLength;function _traverse(r,b,x=!1){const R=2*r;if(B[R+15]===Kt){const A=S[r+6];let b=1/0,x=1/0,F=1/0,N=-1/0,Q=-1/0,H=-1/0;for(let r=3*A,S=3*(A+B[R+14]);r<S;r++){let A=C[r];const S=I.getX(A),B=I.getY(A),D=I.getZ(A);S<b&&(b=S),S>N&&(N=S),B<x&&(x=B),B>Q&&(Q=B),D<F&&(F=D),D>H&&(H=D)}return(D[r+0]!==b||D[r+1]!==x||D[r+2]!==F||D[r+3]!==N||D[r+4]!==Q||D[r+5]!==H)&&(D[r+0]=b,D[r+1]=x,D[r+2]=F,D[r+3]=N,D[r+4]=Q,D[r+5]=H,!0)}{const C=r+8,I=S[r+6],B=C+b,R=I+b;let F=x,N=!1,Q=!1;A?F||(N=A.has(B),Q=A.has(R),F=!N&&!Q):(N=!0,Q=!0);const H=F||Q;let G=!1;(F||N)&&(G=_traverse(C,b,F));let j=!1;H&&(j=_traverse(I,b,F));const V=G||j;if(V)for(let A=0;A<3;A++){const b=C+A,x=I+A,S=D[b],B=D[b+3],R=D[x],F=D[x+3];D[r+A]=S<R?S:R,D[r+A+3]=B>F?B:F}return V}}}function intersectRay(r,A,b,C,I){let x,S,B,D,R,F;const N=1/b.direction.x,Q=1/b.direction.y,H=1/b.direction.z,G=b.origin.x,j=b.origin.y,V=b.origin.z;let W=A[r],X=A[r+3],Y=A[r+1],K=A[r+3+1],q=A[r+2],Z=A[r+3+2];return N>=0?(x=(W-G)*N,S=(X-G)*N):(x=(X-G)*N,S=(W-G)*N),Q>=0?(B=(Y-j)*Q,D=(K-j)*Q):(B=(K-j)*Q,D=(Y-j)*Q),!(x>D||B>S)&&((B>x||isNaN(x))&&(x=B),(D<S||isNaN(S))&&(S=D),H>=0?(R=(q-V)*H,F=(Z-V)*H):(R=(Z-V)*H,F=(q-V)*H),!(x>F||R>S)&&((R>x||x!=x)&&(x=R),(F<S||S!=S)&&(S=F),x<=I&&S>=C))}function iterateOverTriangles_indirect(r,A,b,C,I,x,S){const{geometry:B}=b,{index:D}=B,R=B.attributes.position;for(let B=r,F=A+r;B<F;B++){let r;if(r=b.resolveTriangleIndex(B),setTriangle(S,3*r,D,R),S.needsUpdate=!0,C(S,r,I,x))return!0}return!1}function raycast(r,A,b,C,I,x,S){ds.setBuffer(r._roots[A]),_raycast$1(0,r,b,C,I,x,S),ds.clearBuffer()}function _raycast$1(r,A,b,C,I,x,S){const{float32Array:B,uint16Array:D,uint32Array:R}=ds,F=2*r;if(IS_LEAF(F,D))!function(r,A,b,C,I,x,S,B){const{geometry:D,_indirectBuffer:R}=r;for(let r=C,R=C+I;r<R;r++)intersectTri(D,A,b,r,x,S,B)}(A,b,C,OFFSET(r,R),COUNT(F,D),I,x,S);else{const D=LEFT_NODE(r);intersectRay(D,B,C,x,S)&&_raycast$1(D,A,b,C,I,x,S);const F=RIGHT_NODE(r,R);intersectRay(F,B,C,x,S)&&_raycast$1(F,A,b,C,I,x,S)}}const ks=["x","y","z"];function raycastFirst(r,A,b,C,I,x){ds.setBuffer(r._roots[A]);const S=_raycastFirst$1(0,r,b,C,I,x);return ds.clearBuffer(),S}function _raycastFirst$1(r,A,b,C,I,x){const{float32Array:S,uint16Array:B,uint32Array:D}=ds;let R=2*r;if(IS_LEAF(R,B))return function(r,A,b,C,I,x,S){const{geometry:B,_indirectBuffer:D}=r;let R=1/0,F=null;for(let r=C,D=C+I;r<D;r++){let C;C=intersectTri(B,A,b,r,null,x,S),C&&C.distance<R&&(F=C,R=C.distance)}return F}(A,b,C,OFFSET(r,D),COUNT(R,B),I,x);{const B=SPLIT_AXIS(r,D),R=ks[B],F=C.direction[R]>=0;let N,Q;F?(N=LEFT_NODE(r),Q=RIGHT_NODE(r,D)):(N=RIGHT_NODE(r,D),Q=LEFT_NODE(r));const H=intersectRay(N,S,C,I,x)?_raycastFirst$1(N,A,b,C,I,x):null;if(H){const r=H.point[R];if(F?r<=S[Q+B]:r>=S[Q+B+3])return H}const G=intersectRay(Q,S,C,I,x)?_raycastFirst$1(Q,A,b,C,I,x):null;return H&&G?H.distance<=G.distance?H:G:H||G||null}}const Rs=new x,Fs=new ExtendedTriangle,Ls=new ExtendedTriangle,Os=new S,Us=new OrientedBox,Ns=new OrientedBox;function intersectsGeometry(r,A,b,C){ds.setBuffer(r._roots[A]);const I=_intersectsGeometry$1(0,r,b,C);return ds.clearBuffer(),I}function _intersectsGeometry$1(r,A,b,C,I=null){const{float32Array:x,uint16Array:S,uint32Array:B}=ds;let D=2*r;if(null===I&&(b.boundingBox||b.computeBoundingBox(),Us.set(b.boundingBox.min,b.boundingBox.max,C),I=Us),!IS_LEAF(D,S)){const S=r+8,D=B[r+6];return arrayToBox(S,x,Rs),I.intersectsBox(Rs)&&_intersectsGeometry$1(S,A,b,C,I)?!0:(arrayToBox(D,x,Rs),!(!I.intersectsBox(Rs)||!_intersectsGeometry$1(D,A,b,C,I)))}{const I=A.geometry,R=I.index,F=I.attributes.position,N=b.index,Q=b.attributes.position,H=OFFSET(r,B),G=COUNT(D,S);if(Os.copy(C).invert(),b.boundsTree){arrayToBox(r,x,Ns),Ns.matrix.copy(Os),Ns.needsUpdate=!0;const A=b.boundsTree.shapecast({intersectsBounds:r=>Ns.intersectsBox(r),intersectsTriangle:r=>{r.a.applyMatrix4(C),r.b.applyMatrix4(C),r.c.applyMatrix4(C),r.needsUpdate=!0;for(let A=3*H,b=3*(G+H);A<b;A+=3)if(setTriangle(Ls,A,R,F),Ls.needsUpdate=!0,r.intersectsTriangle(Ls))return!0;return!1}});return A}for(let r=3*H,A=3*(G+H);r<A;r+=3){setTriangle(Fs,r,R,F),Fs.a.applyMatrix4(Os),Fs.b.applyMatrix4(Os),Fs.c.applyMatrix4(Os),Fs.needsUpdate=!0;for(let r=0,A=N.count;r<A;r+=3)if(setTriangle(Ls,r,N,Q),Ls.needsUpdate=!0,Fs.intersectsTriangle(Ls))return!0}}}const Qs=new S,Hs=new OrientedBox,Gs=new OrientedBox,js=new A,Vs=new A,zs=new A,Ws=new A;function closestPointToGeometry(r,A,b,C={},I={},x=0,S=1/0){A.boundingBox||A.computeBoundingBox(),Hs.set(A.boundingBox.min,A.boundingBox.max,b),Hs.needsUpdate=!0;const B=r.geometry,D=B.attributes.position,R=B.index,F=A.attributes.position,N=A.index,Q=hs.getPrimitive(),H=hs.getPrimitive();let G=js,j=Vs,V=null,W=null;I&&(V=zs,W=Ws);let X=1/0,Y=null,K=null;return Qs.copy(b).invert(),Gs.matrix.copy(Qs),r.shapecast({boundsTraverseOrder:r=>Hs.distanceToBox(r),intersectsBounds:(r,A,b)=>b<X&&b<S&&(A&&(Gs.min.copy(r.min),Gs.max.copy(r.max),Gs.needsUpdate=!0),!0),intersectsRange:(r,C)=>{if(A.boundsTree)return A.boundsTree.shapecast({boundsTraverseOrder:r=>Gs.distanceToBox(r),intersectsBounds:(r,A,b)=>b<X&&b<S,intersectsRange:(A,I)=>{for(let S=A,B=A+I;S<B;S++){setTriangle(H,3*S,N,F),H.a.applyMatrix4(b),H.b.applyMatrix4(b),H.c.applyMatrix4(b),H.needsUpdate=!0;for(let A=r,b=r+C;A<b;A++){setTriangle(Q,3*A,R,D),Q.needsUpdate=!0;const r=Q.distanceToTriangle(H,G,V);if(r<X&&(j.copy(G),W&&W.copy(V),X=r,Y=A,K=S),r<x)return!0}}}});for(let I=0,S=getTriCount(A);I<S;I++){setTriangle(H,3*I,N,F),H.a.applyMatrix4(b),H.b.applyMatrix4(b),H.c.applyMatrix4(b),H.needsUpdate=!0;for(let A=r,b=r+C;A<b;A++){setTriangle(Q,3*A,R,D),Q.needsUpdate=!0;const r=Q.distanceToTriangle(H,G,V);if(r<X&&(j.copy(G),W&&W.copy(V),X=r,Y=A,K=I),r<x)return!0}}}}),hs.releasePrimitive(Q),hs.releasePrimitive(H),X===1/0?null:(C.point?C.point.copy(j):C.point=j.clone(),C.distance=X,C.faceIndex=Y,I&&(I.point?I.point.copy(W):I.point=W.clone(),I.point.applyMatrix4(Qs),j.applyMatrix4(Qs),I.distance=j.sub(I.point).length(),I.faceIndex=K),C)}function refit_indirect(r,A=null){A&&Array.isArray(A)&&(A=new Set(A));const b=r.geometry,C=b.index?b.index.array:null,I=b.attributes.position;let x,S,B,D,R=0;const F=r._roots;for(let r=0,A=F.length;r<A;r++)x=F[r],S=new Uint32Array(x),B=new Uint16Array(x),D=new Float32Array(x),_traverse(0,R),R+=x.byteLength;function _traverse(b,x,R=!1){const F=2*b;if(B[F+15]===Kt){const A=S[b+6];let x=1/0,R=1/0,N=1/0,Q=-1/0,H=-1/0,G=-1/0;for(let b=A,S=A+B[F+14];b<S;b++){const A=3*r.resolveTriangleIndex(b);for(let r=0;r<3;r++){let b=A+r;b=C?C[b]:b;const S=I.getX(b),B=I.getY(b),D=I.getZ(b);S<x&&(x=S),S>Q&&(Q=S),B<R&&(R=B),B>H&&(H=B),D<N&&(N=D),D>G&&(G=D)}}return(D[b+0]!==x||D[b+1]!==R||D[b+2]!==N||D[b+3]!==Q||D[b+4]!==H||D[b+5]!==G)&&(D[b+0]=x,D[b+1]=R,D[b+2]=N,D[b+3]=Q,D[b+4]=H,D[b+5]=G,!0)}{const r=b+8,C=S[b+6],I=r+x,B=C+x;let F=R,N=!1,Q=!1;A?F||(N=A.has(I),Q=A.has(B),F=!N&&!Q):(N=!0,Q=!0);const H=F||Q;let G=!1;(F||N)&&(G=_traverse(r,x,F));let j=!1;H&&(j=_traverse(C,x,F));const V=G||j;if(V)for(let A=0;A<3;A++){const I=r+A,x=C+A,S=D[I],B=D[I+3],R=D[x],F=D[x+3];D[b+A]=S<R?S:R,D[b+A+3]=B>F?B:F}return V}}}function raycast_indirect(r,A,b,C,I,x,S){ds.setBuffer(r._roots[A]),_raycast(0,r,b,C,I,x,S),ds.clearBuffer()}function _raycast(r,A,b,C,I,x,S){const{float32Array:B,uint16Array:D,uint32Array:R}=ds,F=2*r;if(IS_LEAF(F,D))!function(r,A,b,C,I,x,S,B){const{geometry:D,_indirectBuffer:R}=r;for(let r=C,F=C+I;r<F;r++)intersectTri(D,A,b,R?R[r]:r,x,S,B)}(A,b,C,OFFSET(r,R),COUNT(F,D),I,x,S);else{const D=LEFT_NODE(r);intersectRay(D,B,C,x,S)&&_raycast(D,A,b,C,I,x,S);const F=RIGHT_NODE(r,R);intersectRay(F,B,C,x,S)&&_raycast(F,A,b,C,I,x,S)}}const Xs=["x","y","z"];function raycastFirst_indirect(r,A,b,C,I,x){ds.setBuffer(r._roots[A]);const S=_raycastFirst(0,r,b,C,I,x);return ds.clearBuffer(),S}function _raycastFirst(r,A,b,C,I,x){const{float32Array:S,uint16Array:B,uint32Array:D}=ds;let R=2*r;if(IS_LEAF(R,B))return function(r,A,b,C,I,x,S){const{geometry:B,_indirectBuffer:D}=r;let R=1/0,F=null;for(let r=C,N=C+I;r<N;r++){let C;C=intersectTri(B,A,b,D?D[r]:r,null,x,S),C&&C.distance<R&&(F=C,R=C.distance)}return F}(A,b,C,OFFSET(r,D),COUNT(R,B),I,x);{const B=SPLIT_AXIS(r,D),R=Xs[B],F=C.direction[R]>=0;let N,Q;F?(N=LEFT_NODE(r),Q=RIGHT_NODE(r,D)):(N=RIGHT_NODE(r,D),Q=LEFT_NODE(r));const H=intersectRay(N,S,C,I,x)?_raycastFirst(N,A,b,C,I,x):null;if(H){const r=H.point[R];if(F?r<=S[Q+B]:r>=S[Q+B+3])return H}const G=intersectRay(Q,S,C,I,x)?_raycastFirst(Q,A,b,C,I,x):null;return H&&G?H.distance<=G.distance?H:G:H||G||null}}const Ys=new x,Ks=new ExtendedTriangle,qs=new ExtendedTriangle,Zs=new S,Js=new OrientedBox,$s=new OrientedBox;function intersectsGeometry_indirect(r,A,b,C){ds.setBuffer(r._roots[A]);const I=_intersectsGeometry(0,r,b,C);return ds.clearBuffer(),I}function _intersectsGeometry(r,A,b,C,I=null){const{float32Array:x,uint16Array:S,uint32Array:B}=ds;let D=2*r;if(null===I&&(b.boundingBox||b.computeBoundingBox(),Js.set(b.boundingBox.min,b.boundingBox.max,C),I=Js),!IS_LEAF(D,S)){const S=r+8,D=B[r+6];return arrayToBox(S,x,Ys),I.intersectsBox(Ys)&&_intersectsGeometry(S,A,b,C,I)?!0:(arrayToBox(D,x,Ys),!(!I.intersectsBox(Ys)||!_intersectsGeometry(D,A,b,C,I)))}{const I=A.geometry,R=I.index,F=I.attributes.position,N=b.index,Q=b.attributes.position,H=OFFSET(r,B),G=COUNT(D,S);if(Zs.copy(C).invert(),b.boundsTree){arrayToBox(r,x,$s),$s.matrix.copy(Zs),$s.needsUpdate=!0;const I=b.boundsTree.shapecast({intersectsBounds:r=>$s.intersectsBox(r),intersectsTriangle:r=>{r.a.applyMatrix4(C),r.b.applyMatrix4(C),r.c.applyMatrix4(C),r.needsUpdate=!0;for(let b=H,C=G+H;b<C;b++)if(setTriangle(qs,3*A.resolveTriangleIndex(b),R,F),qs.needsUpdate=!0,r.intersectsTriangle(qs))return!0;return!1}});return I}for(let r=H,b=G+H;r<b;r++){const b=A.resolveTriangleIndex(r);setTriangle(Ks,3*b,R,F),Ks.a.applyMatrix4(Zs),Ks.b.applyMatrix4(Zs),Ks.c.applyMatrix4(Zs),Ks.needsUpdate=!0;for(let r=0,A=N.count;r<A;r+=3)if(setTriangle(qs,r,N,Q),qs.needsUpdate=!0,Ks.intersectsTriangle(qs))return!0}}}const ei=new S,ti=new OrientedBox,si=new OrientedBox,ii=new A,ni=new A,ri=new A,ai=new A;function closestPointToGeometry_indirect(r,A,b,C={},I={},x=0,S=1/0){A.boundingBox||A.computeBoundingBox(),ti.set(A.boundingBox.min,A.boundingBox.max,b),ti.needsUpdate=!0;const B=r.geometry,D=B.attributes.position,R=B.index,F=A.attributes.position,N=A.index,Q=hs.getPrimitive(),H=hs.getPrimitive();let G=ii,j=ni,V=null,W=null;I&&(V=ri,W=ai);let X=1/0,Y=null,K=null;return ei.copy(b).invert(),si.matrix.copy(ei),r.shapecast({boundsTraverseOrder:r=>ti.distanceToBox(r),intersectsBounds:(r,A,b)=>b<X&&b<S&&(A&&(si.min.copy(r.min),si.max.copy(r.max),si.needsUpdate=!0),!0),intersectsRange:(C,I)=>{if(A.boundsTree){const B=A.boundsTree;return B.shapecast({boundsTraverseOrder:r=>si.distanceToBox(r),intersectsBounds:(r,A,b)=>b<X&&b<S,intersectsRange:(A,S)=>{for(let q=A,Z=A+S;q<Z;q++){const A=B.resolveTriangleIndex(q);setTriangle(H,3*A,N,F),H.a.applyMatrix4(b),H.b.applyMatrix4(b),H.c.applyMatrix4(b),H.needsUpdate=!0;for(let A=C,b=C+I;A<b;A++){const b=r.resolveTriangleIndex(A);setTriangle(Q,3*b,R,D),Q.needsUpdate=!0;const C=Q.distanceToTriangle(H,G,V);if(C<X&&(j.copy(G),W&&W.copy(V),X=C,Y=A,K=q),C<x)return!0}}}})}for(let S=0,B=getTriCount(A);S<B;S++){setTriangle(H,3*S,N,F),H.a.applyMatrix4(b),H.b.applyMatrix4(b),H.c.applyMatrix4(b),H.needsUpdate=!0;for(let A=C,b=C+I;A<b;A++){const b=r.resolveTriangleIndex(A);setTriangle(Q,3*b,R,D),Q.needsUpdate=!0;const C=Q.distanceToTriangle(H,G,V);if(C<X&&(j.copy(G),W&&W.copy(V),X=C,Y=A,K=S),C<x)return!0}}}}),hs.releasePrimitive(Q),hs.releasePrimitive(H),X===1/0?null:(C.point?C.point.copy(j):C.point=j.clone(),C.distance=X,C.faceIndex=Y,I&&(I.point?I.point.copy(W):I.point=W.clone(),I.point.applyMatrix4(ei),j.applyMatrix4(ei),I.distance=j.sub(I.point).length(),I.faceIndex=K),C)}function isSharedArrayBufferSupported(){return"undefined"!=typeof SharedArrayBuffer}const oi=new ds.constructor,li=new ds.constructor,hi=new PrimitivePool((()=>new x)),di=new x,ci=new x,ui=new x,pi=new x;let Ai=!1;function _traverse(r,A,b,C,I,x=0,S=0,B=0,D=0,R=null,F=!1){let N,Q;F?(N=li,Q=oi):(N=oi,Q=li);const H=N.float32Array,G=N.uint32Array,j=N.uint16Array,V=Q.float32Array,W=Q.uint32Array,X=Q.uint16Array,Y=2*A,K=IS_LEAF(2*r,j),q=IS_LEAF(Y,X);let Z=!1;if(q&&K)Z=F?I(OFFSET(A,W),COUNT(2*A,X),OFFSET(r,G),COUNT(2*r,j),D,S+A,B,x+r):I(OFFSET(r,G),COUNT(2*r,j),OFFSET(A,W),COUNT(2*A,X),B,x+r,D,S+A);else if(q){const R=hi.getPrimitive();arrayToBox(A,V,R),R.applyMatrix4(b);const N=LEFT_NODE(r),Q=RIGHT_NODE(r,G);arrayToBox(N,H,di),arrayToBox(Q,H,ci);const j=R.intersectsBox(di),W=R.intersectsBox(ci);Z=j&&_traverse(A,N,C,b,I,S,x,D,B+1,R,!F)||W&&_traverse(A,Q,C,b,I,S,x,D,B+1,R,!F),hi.releasePrimitive(R)}else{const N=LEFT_NODE(A),Q=RIGHT_NODE(A,W);arrayToBox(N,V,ui),arrayToBox(Q,V,pi);const j=R.intersectsBox(ui),X=R.intersectsBox(pi);if(j&&X)Z=_traverse(r,N,b,C,I,x,S,B,D+1,R,F)||_traverse(r,Q,b,C,I,x,S,B,D+1,R,F);else if(j)if(K)Z=_traverse(r,N,b,C,I,x,S,B,D+1,R,F);else{const A=hi.getPrimitive();A.copy(ui).applyMatrix4(b);const R=LEFT_NODE(r),Q=RIGHT_NODE(r,G);arrayToBox(R,H,di),arrayToBox(Q,H,ci);const j=A.intersectsBox(di),V=A.intersectsBox(ci);Z=j&&_traverse(N,R,C,b,I,S,x,D,B+1,A,!F)||V&&_traverse(N,Q,C,b,I,S,x,D,B+1,A,!F),hi.releasePrimitive(A)}else if(X)if(K)Z=_traverse(r,Q,b,C,I,x,S,B,D+1,R,F);else{const A=hi.getPrimitive();A.copy(pi).applyMatrix4(b);const R=LEFT_NODE(r),N=RIGHT_NODE(r,G);arrayToBox(R,H,di),arrayToBox(N,H,ci);const j=A.intersectsBox(di),V=A.intersectsBox(ci);Z=j&&_traverse(Q,R,C,b,I,S,x,D,B+1,A,!F)||V&&_traverse(Q,N,C,b,I,S,x,D,B+1,A,!F),hi.releasePrimitive(A)}}return Z}const gi=new OrientedBox,fi=new x,mi={strategy:Gt,maxDepth:40,maxLeafTris:10,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,indirect:!1,verbose:!0,range:null};class MeshBVH{static serialize(r,A={}){A={cloneBuffers:!0,...A};const b=r.geometry,C=r._roots,I=r._indirectBuffer,x=b.getIndex();let S;return S=A.cloneBuffers?{roots:C.map((r=>r.slice())),index:x?x.array.slice():null,indirectBuffer:I?I.slice():null}:{roots:C,index:x?x.array:null,indirectBuffer:I},S}static deserialize(r,A,b={}){b={setIndex:!0,indirect:Boolean(r.indirectBuffer),...b};const{index:C,roots:I,indirectBuffer:x}=r,S=new MeshBVH(A,{...b,[Zt]:!0});if(S._roots=I,S._indirectBuffer=x||null,b.setIndex){const b=A.getIndex();if(null===b){const b=new $(r.index,1,!1);A.setIndex(b)}else b.array!==C&&(b.array.set(C),b.needsUpdate=!0)}return S}get indirect(){return!!this._indirectBuffer}constructor(r,A={}){if(!r.isBufferGeometry)throw new Error("MeshBVH: Only BufferGeometries are supported.");if(r.index&&r.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.");if((A=Object.assign({...mi,[Zt]:!1},A)).useSharedArrayBuffer&&!isSharedArrayBufferSupported())throw new Error("MeshBVH: SharedArrayBuffer is not available.");this.geometry=r,this._roots=null,this._indirectBuffer=null,A[Zt]||(buildPackedTree(this,A),!r.boundingBox&&A.setBoundingBox&&(r.boundingBox=this.getBoundingBox(new x))),this.resolveTriangleIndex=A.indirect?r=>this._indirectBuffer[r]:r=>r}refit(r=null){return(this.indirect?refit_indirect:refit)(this,r)}traverse(r,A=0){const b=this._roots[A],C=new Uint32Array(b),I=new Uint16Array(b);!function _traverse(A,x=0){const S=2*A,B=I[S+15]===Kt;if(B){const D=C[A+6],R=I[S+14];r(x,B,new Float32Array(b,4*A,6),D,R)}else{const I=A+Yt/4,S=C[A+6],D=C[A+7];r(x,B,new Float32Array(b,4*A,6),D)||(_traverse(I,x+1),_traverse(S,x+1))}}(0)}raycast(r,A=Te,b=0,C=1/0){const I=this._roots,x=this.geometry,S=[],B=A.isMaterial,D=Array.isArray(A),R=x.groups,F=B?A.side:A,N=this.indirect?raycast_indirect:raycast;for(let x=0,B=I.length;x<B;x++){const I=D?A[R[x].materialIndex].side:F,B=S.length;if(N(this,x,I,r,S,b,C),D){const r=R[x].materialIndex;for(let A=B,b=S.length;A<b;A++)S[A].face.materialIndex=r}}return S}raycastFirst(r,A=Te,b=0,C=1/0){const I=this._roots,x=this.geometry,S=A.isMaterial,B=Array.isArray(A);let D=null;const R=x.groups,F=S?A.side:A,N=this.indirect?raycastFirst_indirect:raycastFirst;for(let x=0,S=I.length;x<S;x++){const I=N(this,x,B?A[R[x].materialIndex].side:F,r,b,C);null!=I&&(null==D||I.distance<D.distance)&&(D=I,B&&(I.face.materialIndex=R[x].materialIndex))}return D}intersectsGeometry(r,A){let b=!1;const C=this._roots,I=this.indirect?intersectsGeometry_indirect:intersectsGeometry;for(let x=0,S=C.length;x<S&&(b=I(this,x,r,A),!b);x++);return b}shapecast(r){const A=hs.getPrimitive(),b=this.indirect?iterateOverTriangles_indirect:iterateOverTriangles;let{boundsTraverseOrder:C,intersectsBounds:I,intersectsRange:x,intersectsTriangle:S}=r;if(x&&S){const r=x;x=(C,I,x,B,D)=>!!r(C,I,x,B,D)||b(C,I,this,S,x,B,A)}else x||(x=S?(r,C,I,x)=>b(r,C,this,S,I,x,A):(r,A,b)=>b);let B=!1,D=0;const R=this._roots;for(let r=0,A=R.length;r<A;r++){const A=R[r];if(B=shapecast(this,r,I,x,C,D),B)break;D+=A.byteLength}return hs.releasePrimitive(A),B}bvhcast(r,A,b){let{intersectsRanges:C,intersectsTriangles:I}=b;const x=hs.getPrimitive(),B=this.geometry.index,D=this.geometry.attributes.position,R=this.indirect?r=>{const A=this.resolveTriangleIndex(r);setTriangle(x,3*A,B,D)}:r=>{setTriangle(x,3*r,B,D)},F=hs.getPrimitive(),N=r.geometry.index,Q=r.geometry.attributes.position,H=r.indirect?A=>{const b=r.resolveTriangleIndex(A);setTriangle(F,3*b,N,Q)}:r=>{setTriangle(F,3*r,N,Q)};if(I){const iterateOverDoubleTriangles=(r,b,C,S,B,D,N,Q)=>{for(let G=C,j=C+S;G<j;G++){H(G),F.a.applyMatrix4(A),F.b.applyMatrix4(A),F.c.applyMatrix4(A),F.needsUpdate=!0;for(let A=r,C=r+b;A<C;A++)if(R(A),x.needsUpdate=!0,I(x,F,A,G,B,D,N,Q))return!0}return!1};if(C){const r=C;C=function(A,b,C,I,x,S,B,D){return!!r(A,b,C,I,x,S,B,D)||iterateOverDoubleTriangles(A,b,C,I,x,S,B,D)}}else C=iterateOverDoubleTriangles}return function(r,A,b,C){if(Ai)throw new Error("MeshBVH: Recursive calls to bvhcast not supported.");Ai=!0;const I=r._roots,x=A._roots;let B,D=0,R=0;const F=(new S).copy(b).invert();for(let r=0,A=I.length;r<A;r++){oi.setBuffer(I[r]),R=0;const A=hi.getPrimitive();arrayToBox(0,oi.float32Array,A),A.applyMatrix4(F);for(let r=0,I=x.length;r<I&&(li.setBuffer(x[r]),B=_traverse(0,0,b,F,C,D,R,0,0,A),li.clearBuffer(),R+=x[r].length,!B);r++);if(hi.releasePrimitive(A),oi.clearBuffer(),D+=I[r].length,B)break}return Ai=!1,B}(this,r,A,C)}intersectsBox(r,A){return gi.set(r.min,r.max,A),gi.needsUpdate=!0,this.shapecast({intersectsBounds:r=>gi.intersectsBox(r),intersectsTriangle:r=>gi.intersectsTriangle(r)})}intersectsSphere(r){return this.shapecast({intersectsBounds:A=>r.intersectsBox(A),intersectsTriangle:A=>A.intersectsSphere(r)})}closestPointToGeometry(r,A,b={},C={},I=0,x=1/0){return(this.indirect?closestPointToGeometry_indirect:closestPointToGeometry)(this,r,A,b,C,I,x)}closestPointToPoint(r,A={},b=0,C=1/0){return function(r,A,b={},C=0,I=1/0){const x=C*C,S=I*I;let B=1/0,D=null;if(r.shapecast({boundsTraverseOrder:r=>(gs.copy(A).clamp(r.min,r.max),gs.distanceToSquared(A)),intersectsBounds:(r,A,b)=>b<B&&b<S,intersectsTriangle:(r,b)=>{r.closestPointToPoint(A,gs);const C=A.distanceToSquared(gs);return C<B&&(fs.copy(gs),B=C,D=b),C<x}}),B===1/0)return null;const R=Math.sqrt(B);return b.point?b.point.copy(fs):b.point=fs.clone(),b.distance=R,b.faceIndex=D,b}(this,r,A,b,C)}getBoundingBox(r){return r.makeEmpty(),this._roots.forEach((A=>{arrayToBox(0,new Float32Array(A),fi),r.union(fi)})),r}}const _i=new x,bi=new S;class MeshBVHRootHelper extends ce{get isMesh(){return!this.displayEdges}get isLineSegments(){return this.displayEdges}get isLine(){return this.displayEdges}getVertexPosition(...r){return D.prototype.getVertexPosition.call(this,...r)}constructor(r,A,b=10,C=0){super(),this.material=A,this.geometry=new Ie,this.name="MeshBVHRootHelper",this.depth=b,this.displayParents=!1,this.bvh=r,this.displayEdges=!0,this._group=C}raycast(){}update(){const r=this.geometry,A=this.bvh,b=this._group;if(r.dispose(),this.visible=!1,A){const C=this.depth-1,I=this.displayParents;let x=0;A.traverse(((r,A)=>{if(r>=C||A)return x++,!0;I&&x++}),b);let S=0;const B=new Float32Array(24*x);let D,R;A.traverse(((r,A,b)=>{const x=r>=C||A;if(x||I){arrayToBox(0,b,_i);const{min:r,max:A}=_i;for(let b=-1;b<=1;b+=2){const C=b<0?r.x:A.x;for(let b=-1;b<=1;b+=2){const I=b<0?r.y:A.y;for(let b=-1;b<=1;b+=2){const x=b<0?r.z:A.z;B[S+0]=C,B[S+1]=I,B[S+2]=x,S+=3}}}return x}}),b),R=this.displayEdges?new Uint8Array([0,4,1,5,2,6,3,7,0,2,1,3,4,6,5,7,0,1,2,3,4,5,6,7]):new Uint8Array([0,1,2,2,1,3,4,6,5,6,7,5,1,4,5,0,4,1,2,3,6,3,7,6,0,2,4,2,6,4,1,5,3,3,5,7]),D=B.length>65535?new Uint32Array(R.length*x):new Uint16Array(R.length*x);const F=R.length;for(let r=0;r<x;r++){const A=8*r,b=r*F;for(let r=0;r<F;r++)D[b+r]=A+R[r]}r.setIndex(new $(D,1,!1)),r.setAttribute("position",new $(B,3,!1)),this.visible=!0}}}class MeshBVHHelper extends Me{get color(){return this.edgeMaterial.color}get opacity(){return this.edgeMaterial.opacity}set opacity(r){this.edgeMaterial.opacity=r,this.meshMaterial.opacity=r}constructor(r=null,A=null,b=10){r instanceof MeshBVH&&(b=A||10,A=r,r=null),"number"==typeof A&&(b=A,A=null),super(),this.name="MeshBVHHelper",this.depth=b,this.mesh=r,this.bvh=A,this.displayParents=!1,this.displayEdges=!0,this.objectIndex=0,this._roots=[];const C=new Ce({color:65416,transparent:!0,opacity:.3,depthWrite:!1}),I=new H({color:65416,transparent:!0,opacity:.3,depthWrite:!1});I.color=C.color,this.edgeMaterial=C,this.meshMaterial=I,this.update()}update(){const r=this.mesh;let A=this.bvh||r.geometry.boundsTree||null;if(r.isBatchedMesh&&r.boundsTrees&&!A){const b=r._drawInfo[this.objectIndex];b&&(A=r.boundsTrees[b.geometryIndex]||A)}const b=A?A._roots.length:0;for(;this._roots.length>b;){const r=this._roots.pop();r.geometry.dispose(),this.remove(r)}for(let r=0;r<b;r++){const{depth:b,edgeMaterial:C,meshMaterial:I,displayParents:x,displayEdges:S}=this;if(r>=this._roots.length){const I=new MeshBVHRootHelper(A,C,b,r);this.add(I),this._roots.push(I)}const B=this._roots[r];B.bvh=A,B.depth=b,B.displayParents=x,B.displayEdges=S,B.material=S?C:I,B.update()}}updateMatrixWorld(...r){const A=this.mesh,b=this.parent;null!==A&&(A.updateWorldMatrix(!0,!1),b?this.matrix.copy(b.matrixWorld).invert().multiply(A.matrixWorld):this.matrix.copy(A.matrixWorld),(A.isInstancedMesh||A.isBatchedMesh)&&(A.getMatrixAt(this.objectIndex,bi),this.matrix.multiply(bi)),this.matrix.decompose(this.position,this.quaternion,this.scale)),super.updateMatrixWorld(...r)}copy(r){this.depth=r.depth,this.mesh=r.mesh,this.bvh=r.bvh,this.opacity=r.opacity,this.color.copy(r.color)}clone(){return new MeshBVHHelper(this.mesh,this.bvh,this.depth)}dispose(){this.edgeMaterial.dispose(),this.meshMaterial.dispose();const r=this.children;for(let A=0,b=r.length;A<b;A++)r[A].geometry.dispose()}}const yi=new x,vi=new x,Ci=new A;function getPrimitiveSize(r){switch(typeof r){case"number":return 8;case"string":return 2*r.length;case"boolean":return 4;default:return 0}}function convertRaycastIntersect(r,A,b){return null===r?null:(r.point.applyMatrix4(A.matrixWorld),r.distance=r.point.distanceTo(b.ray.origin),r.object=A,r)}const wi=parseInt(je)>=166,Ei=new B,Ii=new A,Ti=new S,xi=D.prototype.raycast,Si=R.prototype.raycast,Bi=new A,Di=new D,Pi=[];function acceleratedBatchedMeshRaycast(r,A){if(this.boundsTrees){const b=this.boundsTrees,C=this._drawInfo,I=this._drawRanges,x=this.matrixWorld;Di.material=this.material,Di.geometry=this.geometry;const S=Di.geometry.boundsTree,B=Di.geometry.drawRange;null===Di.geometry.boundingSphere&&(Di.geometry.boundingSphere=new V);for(let S=0,B=C.length;S<B;S++){if(!this.getVisibleAt(S))continue;const B=C[S].geometryIndex;if(Di.geometry.boundsTree=b[B],this.getMatrixAt(S,Di.matrixWorld).premultiply(x),!Di.geometry.boundsTree){this.getBoundingBoxAt(B,Di.geometry.boundingBox),this.getBoundingSphereAt(B,Di.geometry.boundingSphere);const r=I[B];Di.geometry.setDrawRange(r.start,r.count)}Di.raycast(r,Pi);for(let r=0,b=Pi.length;r<b;r++){const b=Pi[r];b.object=this,b.batchId=S,A.push(b)}Pi.length=0}Di.geometry.boundsTree=S,Di.geometry.drawRange=B,Di.material=null,Di.geometry=null}else Si.call(this,r,A)}function acceleratedMeshRaycast(r,A){if(this.geometry.boundsTree){if(void 0===this.material)return;Ti.copy(this.matrixWorld).invert(),Ei.copy(r.ray).applyMatrix4(Ti),Bi.setFromMatrixScale(this.matrixWorld),Ii.copy(Ei.direction).multiply(Bi);const b=Ii.length(),C=r.near/b,I=r.far/b,x=this.geometry.boundsTree;if(!0===r.firstHitOnly){const b=convertRaycastIntersect(x.raycastFirst(Ei,this.material,C,I),this,r);b&&A.push(b)}else{const b=x.raycast(Ei,this.material,C,I);for(let C=0,I=b.length;C<I;C++){const I=convertRaycastIntersect(b[C],this,r);I&&A.push(I)}}}else xi.call(this,r,A)}function countToIntFormat(r){switch(r){case 1:return At;case 2:return Z;case 3:case 4:return pt}}class VertexAttributeTexture extends X{constructor(){super(),this.minFilter=q,this.magFilter=q,this.generateMipmaps=!1,this.overrideItemSize=null,this._forcedType=null}updateFrom(r){const A=this.overrideItemSize,b=r.itemSize,C=r.count;if(null!==A){if(b*C%A!=0)throw new Error("VertexAttributeTexture: overrideItemSize must divide evenly into buffer length.");r.itemSize=A,r.count=C*b/A}const I=r.itemSize,x=r.count,S=r.normalized,B=r.array.constructor,D=B.BYTES_PER_ELEMENT;let R,F,N,Q,H=this._forcedType,G=I;if(null===H)switch(B){case Float32Array:H=K;break;case Uint8Array:case Uint16Array:case Uint32Array:H=J;break;case Int8Array:case Int16Array:case Int32Array:H=W}let j=function(r){switch(r){case 1:return"R";case 2:return"RG";case 3:case 4:return"RGBA"}throw new Error}(I);switch(H){case K:N=1,F=function(r){switch(r){case 1:return ut;case 2:return ct;case 3:case 4:return Y}}(I),S&&1===D?(Q=B,j+="8",B===Uint8Array?R=ot:(R=ht,j+="_SNORM")):(Q=Float32Array,j+="32F",R=K);break;case W:j+=8*D+"I",N=S?Math.pow(2,8*B.BYTES_PER_ELEMENT-1):1,F=countToIntFormat(I),1===D?(Q=Int8Array,R=ht):2===D?(Q=Int16Array,R=dt):(Q=Int32Array,R=W);break;case J:j+=8*D+"UI",N=S?Math.pow(2,8*B.BYTES_PER_ELEMENT-1):1,F=countToIntFormat(I),1===D?(Q=Uint8Array,R=ot):2===D?(Q=Uint16Array,R=lt):(Q=Uint32Array,R=J)}3!==G||F!==Y&&F!==pt||(G=4);const V=Math.ceil(Math.sqrt(x))||1,X=new Q(G*V*V),q=r.normalized;r.normalized=!1;for(let A=0;A<x;A++){const b=G*A;X[b]=r.getX(A)/N,I>=2&&(X[b+1]=r.getY(A)/N),I>=3&&(X[b+2]=r.getZ(A)/N,4===G&&(X[b+3]=1)),I>=4&&(X[b+3]=r.getW(A)/N)}r.normalized=q,this.internalFormat=j,this.format=F,this.type=R,this.image.width=V,this.image.height=V,this.image.data=X,this.needsUpdate=!0,this.dispose(),r.itemSize=b,r.count=C}}class UIntVertexAttributeTexture extends VertexAttributeTexture{constructor(){super(),this._forcedType=J}}class FloatVertexAttributeTexture extends VertexAttributeTexture{constructor(){super(),this._forcedType=K}}const Mi=new A,ki=new A,Ri=new A,Fi=new F,Li=new A,Oi=new A,Ui=new F,Ni=new F,Qi=new S,Hi=new S;function validateAttributes(r,A){if(!r&&!A)return;const b=r.count===A.count,C=r.normalized===A.normalized,I=r.array.constructor===A.array.constructor,x=r.itemSize===A.itemSize;if(!(b&&C&&I&&x))throw new Error}function createAttributeClone(r,A=null){const b=r.array.constructor,C=r.normalized,I=r.itemSize,x=null===A?r.count:A;return new $(new b(I*x),I,C)}function copyAttributeContents(r,A,b=0){if(r.isInterleavedBufferAttribute){const C=r.itemSize;for(let I=0,x=r.count;I<x;I++){const x=I+b;A.setX(x,r.getX(I)),C>=2&&A.setY(x,r.getY(I)),C>=3&&A.setZ(x,r.getZ(I)),C>=4&&A.setW(x,r.getW(I))}}else{const C=A.array,I=C.constructor,x=C.BYTES_PER_ELEMENT*r.itemSize*b;new I(C.buffer,x,r.array.length).set(r.array)}}function addScaledMatrix(r,A,b){const C=r.elements,I=A.elements;for(let r=0,A=I.length;r<A;r++)C[r]+=I[r]*b}function boneNormalTransform(r,A,b){const C=r.skeleton,I=r.geometry,x=C.bones,S=C.boneInverses;Ui.fromBufferAttribute(I.attributes.skinIndex,A),Ni.fromBufferAttribute(I.attributes.skinWeight,A),Qi.elements.fill(0);for(let r=0;r<4;r++){const A=Ni.getComponent(r);if(0!==A){const b=Ui.getComponent(r);Hi.multiplyMatrices(x[b].matrixWorld,S[b]),addScaledMatrix(Qi,Hi,A)}}return Qi.multiply(r.bindMatrix).premultiply(r.bindMatrixInverse),b.transformDirection(Qi),b}function applyMorphTarget(r,A,b,C,I){Li.set(0,0,0);for(let x=0,S=r.length;x<S;x++){const S=A[x],B=r[x];0!==S&&(Oi.fromBufferAttribute(B,C),b?Li.addScaledVector(Oi,S):Li.addScaledVector(Oi.sub(I),S))}I.add(Li)}class GeometryDiff{constructor(r){this.matrixWorld=new S,this.geometryHash=null,this.boneMatrices=null,this.primitiveCount=-1,this.mesh=r,this.update()}update(){const r=this.mesh,A=r.geometry,b=r.skeleton,C=(A.index?A.index.count:A.attributes.position.count)/3;if(this.matrixWorld.copy(r.matrixWorld),this.geometryHash=A.attributes.position.version,this.primitiveCount=C,b){b.boneTexture||b.computeBoneTexture(),b.update();const r=b.boneMatrices;this.boneMatrices&&this.boneMatrices.length===r.length?this.boneMatrices.set(r):this.boneMatrices=r.slice()}else this.boneMatrices=null}didChange(){const r=this.mesh,A=r.geometry,b=(A.index?A.index.count:A.attributes.position.count)/3,C=this.matrixWorld.equals(r.matrixWorld)&&this.geometryHash===A.attributes.position.version&&function(r,A){if(null===r||null===A)return r===A;if(r.length!==A.length)return!1;for(let b=0,C=r.length;b<C;b++)if(r[b]!==A[b])return!1;return!0}(r.skeleton&&r.skeleton.boneMatrices||null,this.boneMatrices)&&this.primitiveCount===b;return!C}}class StaticGeometryGenerator{constructor(r){Array.isArray(r)||(r=[r]);const A=[];r.forEach((r=>{r.traverseVisible((r=>{r.isMesh&&A.push(r)}))})),this.meshes=A,this.useGroups=!0,this.applyWorldTransforms=!0,this.attributes=["position","normal","color","tangent","uv","uv2"],this._intermediateGeometry=new Array(A.length).fill().map((()=>new Ie)),this._diffMap=new WeakMap}getMaterials(){const r=[];return this.meshes.forEach((A=>{Array.isArray(A.material)?r.push(...A.material):r.push(A.material)})),r}generate(r=new Ie){let A=[];const{meshes:b,useGroups:C,_intermediateGeometry:I,_diffMap:x}=this;for(let r=0,C=b.length;r<C;r++){const C=b[r],S=I[r],B=x.get(C);!B||B.didChange(C)?(this._convertToStaticGeometry(C,S),A.push(!1),B?B.update():x.set(C,new GeometryDiff(C))):A.push(!0)}if(0===I.length){r.setIndex(null);const A=r.attributes;for(const b in A)r.deleteAttribute(b);for(const A in this.attributes)r.setAttribute(this.attributes[A],new $(new Float32Array(0),4,!1))}else!function(r,A={useGroups:!1,updateIndex:!1,skipAttributes:[]},b=new Ie){const C=null!==r[0].index,{useGroups:I=!1,updateIndex:x=!1,skipAttributes:S=[]}=A,B=new Set(Object.keys(r[0].attributes)),D={};let R=0;b.clearGroups();for(let A=0;A<r.length;++A){const x=r[A];let S=0;if(C!==(null!==x.index))throw new Error("StaticGeometryGenerator: All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them.");for(const r in x.attributes){if(!B.has(r))throw new Error('StaticGeometryGenerator: All geometries must have compatible attributes; make sure "'+r+'" attribute exists among all geometries, or in none of them.');void 0===D[r]&&(D[r]=[]),D[r].push(x.attributes[r]),S++}if(S!==B.size)throw new Error("StaticGeometryGenerator: Make sure all geometries have the same number of attributes.");if(I){let r;if(C)r=x.index.count;else{if(void 0===x.attributes.position)throw new Error("StaticGeometryGenerator: The geometry must have either an index or a position attribute");r=x.attributes.position.count}b.addGroup(R,r,A),R+=r}}if(C){let A=!1;if(!b.index){let C=0;for(let A=0;A<r.length;++A)C+=r[A].index.count;b.setIndex(new $(new Uint32Array(C),1,!1)),A=!0}if(x||A){const A=b.index;let C=0,I=0;for(let b=0;b<r.length;++b){const x=r[b],B=x.index;if(!0!==S[b])for(let r=0;r<B.count;++r)A.setX(C,B.getX(r)+I),C++;I+=x.attributes.position.count}}}for(const r in D){const A=D[r];if(!(r in b.attributes)){let C=0;for(const r in A)C+=A[r].count;b.setAttribute(r,createAttributeClone(D[r][0],C))}const C=b.attributes[r];let I=0;for(let r=0,b=A.length;r<b;r++){const b=A[r];!0!==S[r]&&copyAttributeContents(b,C,I),I+=b.count}}}(I,{useGroups:C,skipAttributes:A},r);for(const A in r.attributes)r.attributes[A].needsUpdate=!0;return r}_convertToStaticGeometry(r,A=new Ie){const b=r.geometry,C=this.applyWorldTransforms,I=this.attributes.includes("normal"),x=this.attributes.includes("tangent"),S=b.attributes,B=A.attributes;!A.index&&b.index&&(A.index=b.index.clone()),B.position||A.setAttribute("position",createAttributeClone(S.position)),I&&!B.normal&&S.normal&&A.setAttribute("normal",createAttributeClone(S.normal)),x&&!B.tangent&&S.tangent&&A.setAttribute("tangent",createAttributeClone(S.tangent)),validateAttributes(b.index,A.index),validateAttributes(S.position,B.position),I&&validateAttributes(S.normal,B.normal),x&&validateAttributes(S.tangent,B.tangent);const D=S.position,R=I?S.normal:null,F=x?S.tangent:null,N=b.morphAttributes.position,Q=b.morphAttributes.normal,H=b.morphAttributes.tangent,G=b.morphTargetsRelative,j=r.morphTargetInfluences,V=new Ve;V.getNormalMatrix(r.matrixWorld),b.index&&A.index.array.set(b.index.array);for(let A=0,b=S.position.count;A<b;A++)Mi.fromBufferAttribute(D,A),R&&ki.fromBufferAttribute(R,A),F&&(Fi.fromBufferAttribute(F,A),Ri.fromBufferAttribute(F,A)),j&&(N&&applyMorphTarget(N,j,G,A,Mi),Q&&applyMorphTarget(Q,j,G,A,ki),H&&applyMorphTarget(H,j,G,A,Ri)),r.isSkinnedMesh&&(r.applyBoneTransform(A,Mi),R&&boneNormalTransform(r,A,ki),F&&boneNormalTransform(r,A,Ri)),C&&Mi.applyMatrix4(r.matrixWorld),B.position.setXYZ(A,Mi.x,Mi.y,Mi.z),R&&(C&&ki.applyNormalMatrix(V),B.normal.setXYZ(A,ki.x,ki.y,ki.z)),F&&(C&&Ri.transformDirection(r.matrixWorld),B.tangent.setXYZW(A,Ri.x,Ri.y,Ri.z,Fi.w));for(const r in this.attributes){const b=this.attributes[r];"position"!==b&&"tangent"!==b&&"normal"!==b&&b in S&&(B[b]||A.setAttribute(b,createAttributeClone(S[b])),validateAttributes(S[b],B[b]),copyAttributeContents(S[b],B[b]))}return r.matrixWorld.determinant()<0&&function(r){const{index:A,attributes:b}=r;if(A)for(let r=0,b=A.count;r<b;r+=3){const b=A.getX(r),C=A.getX(r+2);A.setX(r,C),A.setX(r+2,b)}else for(const r in b){const A=b[r],C=A.itemSize;for(let r=0,b=A.count;r<b;r+=3)for(let b=0;b<C;b++){const C=A.getComponent(r,b),I=A.getComponent(r+2,b);A.setComponent(r,b,I),A.setComponent(r+2,b,C)}}}(A),A}}const Gi="\n\n// A stack of uint32 indices can can store the indices for\n// a perfectly balanced tree with a depth up to 31. Lower stack\n// depth gets higher performance.\n//\n// However not all trees are balanced. Best value to set this to\n// is the trees max depth.\n#ifndef BVH_STACK_DEPTH\n#define BVH_STACK_DEPTH 60\n#endif\n\n#ifndef INFINITY\n#define INFINITY 1e20\n#endif\n\n// Utilities\nuvec4 uTexelFetch1D( usampler2D tex, uint index ) {\n\n\tuint width = uint( textureSize( tex, 0 ).x );\n\tuvec2 uv;\n\tuv.x = index % width;\n\tuv.y = index / width;\n\n\treturn texelFetch( tex, ivec2( uv ), 0 );\n\n}\n\nivec4 iTexelFetch1D( isampler2D tex, uint index ) {\n\n\tuint width = uint( textureSize( tex, 0 ).x );\n\tuvec2 uv;\n\tuv.x = index % width;\n\tuv.y = index / width;\n\n\treturn texelFetch( tex, ivec2( uv ), 0 );\n\n}\n\nvec4 texelFetch1D( sampler2D tex, uint index ) {\n\n\tuint width = uint( textureSize( tex, 0 ).x );\n\tuvec2 uv;\n\tuv.x = index % width;\n\tuv.y = index / width;\n\n\treturn texelFetch( tex, ivec2( uv ), 0 );\n\n}\n\nvec4 textureSampleBarycoord( sampler2D tex, vec3 barycoord, uvec3 faceIndices ) {\n\n\treturn\n\t\tbarycoord.x * texelFetch1D( tex, faceIndices.x ) +\n\t\tbarycoord.y * texelFetch1D( tex, faceIndices.y ) +\n\t\tbarycoord.z * texelFetch1D( tex, faceIndices.z );\n\n}\n\nvoid ndcToCameraRay(\n\tvec2 coord, mat4 cameraWorld, mat4 invProjectionMatrix,\n\tout vec3 rayOrigin, out vec3 rayDirection\n) {\n\n\t// get camera look direction and near plane for camera clipping\n\tvec4 lookDirection = cameraWorld * vec4( 0.0, 0.0, - 1.0, 0.0 );\n\tvec4 nearVector = invProjectionMatrix * vec4( 0.0, 0.0, - 1.0, 1.0 );\n\tfloat near = abs( nearVector.z / nearVector.w );\n\n\t// get the camera direction and position from camera matrices\n\tvec4 origin = cameraWorld * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec4 direction = invProjectionMatrix * vec4( coord, 0.5, 1.0 );\n\tdirection /= direction.w;\n\tdirection = cameraWorld * direction - origin;\n\n\t// slide the origin along the ray until it sits at the near clip plane position\n\torigin.xyz += direction.xyz * near / dot( direction, lookDirection );\n\n\trayOrigin = origin.xyz;\n\trayDirection = direction.xyz;\n\n}\n",ji="\n\nfloat dot2( vec3 v ) {\n\n\treturn dot( v, v );\n\n}\n\n// https://www.shadertoy.com/view/ttfGWl\nvec3 closestPointToTriangle( vec3 p, vec3 v0, vec3 v1, vec3 v2, out vec3 barycoord ) {\n\n    vec3 v10 = v1 - v0;\n    vec3 v21 = v2 - v1;\n    vec3 v02 = v0 - v2;\n\n\tvec3 p0 = p - v0;\n\tvec3 p1 = p - v1;\n\tvec3 p2 = p - v2;\n\n    vec3 nor = cross( v10, v02 );\n\n    // method 2, in barycentric space\n    vec3  q = cross( nor, p0 );\n    float d = 1.0 / dot2( nor );\n    float u = d * dot( q, v02 );\n    float v = d * dot( q, v10 );\n    float w = 1.0 - u - v;\n\n\tif( u < 0.0 ) {\n\n\t\tw = clamp( dot( p2, v02 ) / dot2( v02 ), 0.0, 1.0 );\n\t\tu = 0.0;\n\t\tv = 1.0 - w;\n\n\t} else if( v < 0.0 ) {\n\n\t\tu = clamp( dot( p0, v10 ) / dot2( v10 ), 0.0, 1.0 );\n\t\tv = 0.0;\n\t\tw = 1.0 - u;\n\n\t} else if( w < 0.0 ) {\n\n\t\tv = clamp( dot( p1, v21 ) / dot2( v21 ), 0.0, 1.0 );\n\t\tw = 0.0;\n\t\tu = 1.0-v;\n\n\t}\n\n\tbarycoord = vec3( u, v, w );\n    return u * v1 + v * v2 + w * v0;\n\n}\n\nfloat distanceToTriangles(\n\t// geometry info and triangle range\n\tsampler2D positionAttr, usampler2D indexAttr, uint offset, uint count,\n\n\t// point and cut off range\n\tvec3 point, float closestDistanceSquared,\n\n\t// outputs\n\tinout uvec4 faceIndices, inout vec3 faceNormal, inout vec3 barycoord, inout float side, inout vec3 outPoint\n) {\n\n\tbool found = false;\n\tvec3 localBarycoord;\n\tfor ( uint i = offset, l = offset + count; i < l; i ++ ) {\n\n\t\tuvec3 indices = uTexelFetch1D( indexAttr, i ).xyz;\n\t\tvec3 a = texelFetch1D( positionAttr, indices.x ).rgb;\n\t\tvec3 b = texelFetch1D( positionAttr, indices.y ).rgb;\n\t\tvec3 c = texelFetch1D( positionAttr, indices.z ).rgb;\n\n\t\t// get the closest point and barycoord\n\t\tvec3 closestPoint = closestPointToTriangle( point, a, b, c, localBarycoord );\n\t\tvec3 delta = point - closestPoint;\n\t\tfloat sqDist = dot2( delta );\n\t\tif ( sqDist < closestDistanceSquared ) {\n\n\t\t\t// set the output results\n\t\t\tclosestDistanceSquared = sqDist;\n\t\t\tfaceIndices = uvec4( indices.xyz, i );\n\t\t\tfaceNormal = normalize( cross( a - b, b - c ) );\n\t\t\tbarycoord = localBarycoord;\n\t\t\toutPoint = closestPoint;\n\t\t\tside = sign( dot( faceNormal, delta ) );\n\n\t\t}\n\n\t}\n\n\treturn closestDistanceSquared;\n\n}\n\nfloat distanceSqToBounds( vec3 point, vec3 boundsMin, vec3 boundsMax ) {\n\n\tvec3 clampedPoint = clamp( point, boundsMin, boundsMax );\n\tvec3 delta = point - clampedPoint;\n\treturn dot( delta, delta );\n\n}\n\nfloat distanceSqToBVHNodeBoundsPoint( vec3 point, sampler2D bvhBounds, uint currNodeIndex ) {\n\n\tuint cni2 = currNodeIndex * 2u;\n\tvec3 boundsMin = texelFetch1D( bvhBounds, cni2 ).xyz;\n\tvec3 boundsMax = texelFetch1D( bvhBounds, cni2 + 1u ).xyz;\n\treturn distanceSqToBounds( point, boundsMin, boundsMax );\n\n}\n\n// use a macro to hide the fact that we need to expand the struct into separate fields\n#define\tbvhClosestPointToPoint(\t\tbvh,\t\tpoint, faceIndices, faceNormal, barycoord, side, outPoint\t)\t_bvhClosestPointToPoint(\t\tbvh.position, bvh.index, bvh.bvhBounds, bvh.bvhContents,\t\tpoint, faceIndices, faceNormal, barycoord, side, outPoint\t)\n\nfloat _bvhClosestPointToPoint(\n\t// bvh info\n\tsampler2D bvh_position, usampler2D bvh_index, sampler2D bvh_bvhBounds, usampler2D bvh_bvhContents,\n\n\t// point to check\n\tvec3 point,\n\n\t// output variables\n\tinout uvec4 faceIndices, inout vec3 faceNormal, inout vec3 barycoord,\n\tinout float side, inout vec3 outPoint\n ) {\n\n\t// stack needs to be twice as long as the deepest tree we expect because\n\t// we push both the left and right child onto the stack every traversal\n\tint ptr = 0;\n\tuint stack[ BVH_STACK_DEPTH ];\n\tstack[ 0 ] = 0u;\n\n\tfloat closestDistanceSquared = pow( 100000.0, 2.0 );\n\tbool found = false;\n\twhile ( ptr > - 1 && ptr < BVH_STACK_DEPTH ) {\n\n\t\tuint currNodeIndex = stack[ ptr ];\n\t\tptr --;\n\n\t\t// check if we intersect the current bounds\n\t\tfloat boundsHitDistance = distanceSqToBVHNodeBoundsPoint( point, bvh_bvhBounds, currNodeIndex );\n\t\tif ( boundsHitDistance > closestDistanceSquared ) {\n\n\t\t\tcontinue;\n\n\t\t}\n\n\t\tuvec2 boundsInfo = uTexelFetch1D( bvh_bvhContents, currNodeIndex ).xy;\n\t\tbool isLeaf = bool( boundsInfo.x & 0xffff0000u );\n\t\tif ( isLeaf ) {\n\n\t\t\tuint count = boundsInfo.x & 0x0000ffffu;\n\t\t\tuint offset = boundsInfo.y;\n\t\t\tclosestDistanceSquared = distanceToTriangles(\n\t\t\t\tbvh_position, bvh_index, offset, count, point, closestDistanceSquared,\n\n\t\t\t\t// outputs\n\t\t\t\tfaceIndices, faceNormal, barycoord, side, outPoint\n\t\t\t);\n\n\t\t} else {\n\n\t\t\tuint leftIndex = currNodeIndex + 1u;\n\t\t\tuint splitAxis = boundsInfo.x & 0x0000ffffu;\n\t\t\tuint rightIndex = boundsInfo.y;\n\t\t\tbool leftToRight = distanceSqToBVHNodeBoundsPoint( point, bvh_bvhBounds, leftIndex ) < distanceSqToBVHNodeBoundsPoint( point, bvh_bvhBounds, rightIndex );//rayDirection[ splitAxis ] >= 0.0;\n\t\t\tuint c1 = leftToRight ? leftIndex : rightIndex;\n\t\t\tuint c2 = leftToRight ? rightIndex : leftIndex;\n\n\t\t\t// set c2 in the stack so we traverse it later. We need to keep track of a pointer in\n\t\t\t// the stack while we traverse. The second pointer added is the one that will be\n\t\t\t// traversed first\n\t\t\tptr ++;\n\t\t\tstack[ ptr ] = c2;\n\t\t\tptr ++;\n\t\t\tstack[ ptr ] = c1;\n\n\t\t}\n\n\t}\n\n\treturn sqrt( closestDistanceSquared );\n\n}\n",Vi="\n\n#ifndef TRI_INTERSECT_EPSILON\n#define TRI_INTERSECT_EPSILON 1e-5\n#endif\n\n// Raycasting\nbool intersectsBounds( vec3 rayOrigin, vec3 rayDirection, vec3 boundsMin, vec3 boundsMax, out float dist ) {\n\n\t// https://www.reddit.com/r/opengl/comments/8ntzz5/fast_glsl_ray_box_intersection/\n\t// https://tavianator.com/2011/ray_box.html\n\tvec3 invDir = 1.0 / rayDirection;\n\n\t// find intersection distances for each plane\n\tvec3 tMinPlane = invDir * ( boundsMin - rayOrigin );\n\tvec3 tMaxPlane = invDir * ( boundsMax - rayOrigin );\n\n\t// get the min and max distances from each intersection\n\tvec3 tMinHit = min( tMaxPlane, tMinPlane );\n\tvec3 tMaxHit = max( tMaxPlane, tMinPlane );\n\n\t// get the furthest hit distance\n\tvec2 t = max( tMinHit.xx, tMinHit.yz );\n\tfloat t0 = max( t.x, t.y );\n\n\t// get the minimum hit distance\n\tt = min( tMaxHit.xx, tMaxHit.yz );\n\tfloat t1 = min( t.x, t.y );\n\n\t// set distance to 0.0 if the ray starts inside the box\n\tdist = max( t0, 0.0 );\n\n\treturn t1 >= dist;\n\n}\n\nbool intersectsTriangle(\n\tvec3 rayOrigin, vec3 rayDirection, vec3 a, vec3 b, vec3 c,\n\tout vec3 barycoord, out vec3 norm, out float dist, out float side\n) {\n\n\t// https://stackoverflow.com/questions/42740765/intersection-between-line-and-triangle-in-3d\n\tvec3 edge1 = b - a;\n\tvec3 edge2 = c - a;\n\tnorm = cross( edge1, edge2 );\n\n\tfloat det = - dot( rayDirection, norm );\n\tfloat invdet = 1.0 / det;\n\n\tvec3 AO = rayOrigin - a;\n\tvec3 DAO = cross( AO, rayDirection );\n\n\tvec4 uvt;\n\tuvt.x = dot( edge2, DAO ) * invdet;\n\tuvt.y = - dot( edge1, DAO ) * invdet;\n\tuvt.z = dot( AO, norm ) * invdet;\n\tuvt.w = 1.0 - uvt.x - uvt.y;\n\n\t// set the hit information\n\tbarycoord = uvt.wxy; // arranged in A, B, C order\n\tdist = uvt.z;\n\tside = sign( det );\n\tnorm = side * normalize( norm );\n\n\t// add an epsilon to avoid misses between triangles\n\tuvt += vec4( TRI_INTERSECT_EPSILON );\n\n\treturn all( greaterThanEqual( uvt, vec4( 0.0 ) ) );\n\n}\n\nbool intersectTriangles(\n\t// geometry info and triangle range\n\tsampler2D positionAttr, usampler2D indexAttr, uint offset, uint count,\n\n\t// ray\n\tvec3 rayOrigin, vec3 rayDirection,\n\n\t// outputs\n\tinout float minDistance, inout uvec4 faceIndices, inout vec3 faceNormal, inout vec3 barycoord,\n\tinout float side, inout float dist\n) {\n\n\tbool found = false;\n\tvec3 localBarycoord, localNormal;\n\tfloat localDist, localSide;\n\tfor ( uint i = offset, l = offset + count; i < l; i ++ ) {\n\n\t\tuvec3 indices = uTexelFetch1D( indexAttr, i ).xyz;\n\t\tvec3 a = texelFetch1D( positionAttr, indices.x ).rgb;\n\t\tvec3 b = texelFetch1D( positionAttr, indices.y ).rgb;\n\t\tvec3 c = texelFetch1D( positionAttr, indices.z ).rgb;\n\n\t\tif (\n\t\t\tintersectsTriangle( rayOrigin, rayDirection, a, b, c, localBarycoord, localNormal, localDist, localSide )\n\t\t\t&& localDist < minDistance\n\t\t) {\n\n\t\t\tfound = true;\n\t\t\tminDistance = localDist;\n\n\t\t\tfaceIndices = uvec4( indices.xyz, i );\n\t\t\tfaceNormal = localNormal;\n\n\t\t\tside = localSide;\n\t\t\tbarycoord = localBarycoord;\n\t\t\tdist = localDist;\n\n\t\t}\n\n\t}\n\n\treturn found;\n\n}\n\nbool intersectsBVHNodeBounds( vec3 rayOrigin, vec3 rayDirection, sampler2D bvhBounds, uint currNodeIndex, out float dist ) {\n\n\tuint cni2 = currNodeIndex * 2u;\n\tvec3 boundsMin = texelFetch1D( bvhBounds, cni2 ).xyz;\n\tvec3 boundsMax = texelFetch1D( bvhBounds, cni2 + 1u ).xyz;\n\treturn intersectsBounds( rayOrigin, rayDirection, boundsMin, boundsMax, dist );\n\n}\n\n// use a macro to hide the fact that we need to expand the struct into separate fields\n#define\tbvhIntersectFirstHit(\t\tbvh,\t\trayOrigin, rayDirection, faceIndices, faceNormal, barycoord, side, dist\t)\t_bvhIntersectFirstHit(\t\tbvh.position, bvh.index, bvh.bvhBounds, bvh.bvhContents,\t\trayOrigin, rayDirection, faceIndices, faceNormal, barycoord, side, dist\t)\n\nbool _bvhIntersectFirstHit(\n\t// bvh info\n\tsampler2D bvh_position, usampler2D bvh_index, sampler2D bvh_bvhBounds, usampler2D bvh_bvhContents,\n\n\t// ray\n\tvec3 rayOrigin, vec3 rayDirection,\n\n\t// output variables split into separate variables due to output precision\n\tinout uvec4 faceIndices, inout vec3 faceNormal, inout vec3 barycoord,\n\tinout float side, inout float dist\n) {\n\n\t// stack needs to be twice as long as the deepest tree we expect because\n\t// we push both the left and right child onto the stack every traversal\n\tint ptr = 0;\n\tuint stack[ BVH_STACK_DEPTH ];\n\tstack[ 0 ] = 0u;\n\n\tfloat triangleDistance = INFINITY;\n\tbool found = false;\n\twhile ( ptr > - 1 && ptr < BVH_STACK_DEPTH ) {\n\n\t\tuint currNodeIndex = stack[ ptr ];\n\t\tptr --;\n\n\t\t// check if we intersect the current bounds\n\t\tfloat boundsHitDistance;\n\t\tif (\n\t\t\t! intersectsBVHNodeBounds( rayOrigin, rayDirection, bvh_bvhBounds, currNodeIndex, boundsHitDistance )\n\t\t\t|| boundsHitDistance > triangleDistance\n\t\t) {\n\n\t\t\tcontinue;\n\n\t\t}\n\n\t\tuvec2 boundsInfo = uTexelFetch1D( bvh_bvhContents, currNodeIndex ).xy;\n\t\tbool isLeaf = bool( boundsInfo.x & 0xffff0000u );\n\n\t\tif ( isLeaf ) {\n\n\t\t\tuint count = boundsInfo.x & 0x0000ffffu;\n\t\t\tuint offset = boundsInfo.y;\n\n\t\t\tfound = intersectTriangles(\n\t\t\t\tbvh_position, bvh_index, offset, count,\n\t\t\t\trayOrigin, rayDirection, triangleDistance,\n\t\t\t\tfaceIndices, faceNormal, barycoord, side, dist\n\t\t\t) || found;\n\n\t\t} else {\n\n\t\t\tuint leftIndex = currNodeIndex + 1u;\n\t\t\tuint splitAxis = boundsInfo.x & 0x0000ffffu;\n\t\t\tuint rightIndex = boundsInfo.y;\n\n\t\t\tbool leftToRight = rayDirection[ splitAxis ] >= 0.0;\n\t\t\tuint c1 = leftToRight ? leftIndex : rightIndex;\n\t\t\tuint c2 = leftToRight ? rightIndex : leftIndex;\n\n\t\t\t// set c2 in the stack so we traverse it later. We need to keep track of a pointer in\n\t\t\t// the stack while we traverse. The second pointer added is the one that will be\n\t\t\t// traversed first\n\t\t\tptr ++;\n\t\t\tstack[ ptr ] = c2;\n\n\t\t\tptr ++;\n\t\t\tstack[ ptr ] = c1;\n\n\t\t}\n\n\t}\n\n\treturn found;\n\n}\n",zi="\nstruct BVH {\n\n\tusampler2D index;\n\tsampler2D position;\n\n\tsampler2D bvhBounds;\n\tusampler2D bvhContents;\n\n};\n";var Wi=Object.freeze({__proto__:null,bvh_distance_functions:ji,bvh_ray_functions:Vi,bvh_struct_definitions:zi,common_functions:Gi});const Xi=zi,Yi=ji,Ki=`\n\t${Gi}\n\t${Vi}\n`;var qi=Object.freeze({__proto__:null,AVERAGE:jt,BVHShaderGLSL:Wi,CENTER:Gt,CONTAINED:zt,ExtendedTriangle:ExtendedTriangle,FloatVertexAttributeTexture:FloatVertexAttributeTexture,INTERSECTED:1,IntVertexAttributeTexture:class extends VertexAttributeTexture{constructor(){super(),this._forcedType=W}},MeshBVH:MeshBVH,MeshBVHHelper:MeshBVHHelper,MeshBVHUniformStruct:class{constructor(){this.index=new UIntVertexAttributeTexture,this.position=new FloatVertexAttributeTexture,this.bvhBounds=new X,this.bvhContents=new X,this._cachedIndexAttr=null,this.index.overrideItemSize=3}updateFrom(r){const{geometry:A}=r;if(function(r,A,b){const C=r._roots;if(1!==C.length)throw new Error("MeshBVHUniformStruct: Multi-root BVHs not supported.");const I=C[0],x=new Uint16Array(I),S=new Uint32Array(I),B=new Float32Array(I),D=I.byteLength/Yt,R=2*Math.ceil(Math.sqrt(D/2)),F=new Float32Array(4*R*R),N=Math.ceil(Math.sqrt(D)),Q=new Uint32Array(2*N*N);for(let r=0;r<D;r++){const A=r*Yt/4,b=2*A,C=A;for(let A=0;A<3;A++)F[8*r+0+A]=B[C+0+A],F[8*r+4+A]=B[C+3+A];if(IS_LEAF(b,x)){const C=COUNT(b,x),I=OFFSET(A,S),B=4294901760|C;Q[2*r+0]=B,Q[2*r+1]=I}else{const b=4*RIGHT_NODE(A,S)/Yt,C=SPLIT_AXIS(A,S);Q[2*r+0]=C,Q[2*r+1]=b}}A.image.data=F,A.image.width=R,A.image.height=R,A.format=Y,A.type=K,A.internalFormat="RGBA32F",A.minFilter=q,A.magFilter=q,A.generateMipmaps=!1,A.needsUpdate=!0,A.dispose(),b.image.data=Q,b.image.width=N,b.image.height=N,b.format=Z,b.type=J,b.internalFormat="RG32UI",b.minFilter=q,b.magFilter=q,b.generateMipmaps=!1,b.needsUpdate=!0,b.dispose()}(r,this.bvhBounds,this.bvhContents),this.position.updateFrom(A.attributes.position),r.indirect){const b=r._indirectBuffer;if(null===this._cachedIndexAttr||this._cachedIndexAttr.count!==b.length)if(A.index)this._cachedIndexAttr=A.index.clone();else{const r=getIndexArray(getVertexCount(A));this._cachedIndexAttr=new $(r,1,!1)}!function(r,A,b){const C=b.array,I=r.index?r.index.array:null;for(let r=0,b=A.length;r<b;r++){const b=3*r,x=3*A[r];for(let r=0;r<3;r++)C[b+r]=I?I[x+r]:x+r}}(A,b,this._cachedIndexAttr),this.index.updateFrom(this._cachedIndexAttr)}else this.index.updateFrom(A.index)}dispose(){const{index:r,position:A,bvhBounds:b,bvhContents:C}=this;r&&r.dispose(),A&&A.dispose(),b&&b.dispose(),C&&C.dispose()}},NOT_INTERSECTED:0,OrientedBox:OrientedBox,SAH:Vt,StaticGeometryGenerator:StaticGeometryGenerator,UIntVertexAttributeTexture:UIntVertexAttributeTexture,VertexAttributeTexture:VertexAttributeTexture,acceleratedRaycast:function(r,A){this.isBatchedMesh?acceleratedBatchedMeshRaycast.call(this,r,A):acceleratedMeshRaycast.call(this,r,A)},computeBatchedBoundsTree:function(r=-1,A={}){if(!wi)throw new Error("BatchedMesh: Three r166+ is required to compute bounds trees.");A.indirect&&console.warn('"Indirect" is set to false because it is not supported for BatchedMesh.'),A={...A,indirect:!1,range:null};const b=this._drawRanges,C=this._geometryCount;this.boundsTrees||(this.boundsTrees=new Array(C).fill(null));const I=this.boundsTrees;for(;I.length<C;)I.push(null);if(r<0){for(let r=0;r<C;r++)A.range=b[r],I[r]=new MeshBVH(this.geometry,A);return I}return r<b.length&&(A.range=b[r],I[r]=new MeshBVH(this.geometry,A)),I[r]||null},computeBoundsTree:function(r={}){return this.boundsTree=new MeshBVH(this,r),this.boundsTree},disposeBatchedBoundsTree:function(r=-1){r<0?this.boundsTrees.fill(null):r<this.boundsTree.length&&(this.boundsTrees[r]=null)},disposeBoundsTree:function(){this.boundsTree=null},estimateMemoryInBytes:function(r){const A=new Set,b=[r];let C=0;for(;b.length;){const r=b.pop();if(!A.has(r)){A.add(r);for(let A in r){if(!Object.hasOwn(r,A))continue;C+=getPrimitiveSize(A);const I=r[A];!I||"object"!=typeof I&&"function"!=typeof I?C+=getPrimitiveSize(I):/(Uint|Int|Float)(8|16|32)Array/.test(I.constructor.name)||isSharedArrayBufferSupported()&&I instanceof SharedArrayBuffer||I instanceof ArrayBuffer?C+=I.byteLength:b.push(I)}}}return C},getBVHExtremes:function(r){return r._roots.map(((A,b)=>function(r,A){const b={nodeCount:0,leafNodeCount:0,depth:{min:1/0,max:-1/0},tris:{min:1/0,max:-1/0},splits:[0,0,0],surfaceAreaScore:0};return r.traverse(((r,A,C,I,x)=>{const S=C[3]-C[0],B=C[4]-C[1],D=C[5]-C[2],R=2*(S*B+B*D+D*S);b.nodeCount++,A?(b.leafNodeCount++,b.depth.min=Math.min(r,b.depth.min),b.depth.max=Math.max(r,b.depth.max),b.tris.min=Math.min(x,b.tris.min),b.tris.max=Math.max(x,b.tris.max),b.surfaceAreaScore+=R*Wt*x):(b.splits[I]++,b.surfaceAreaScore+=R*Xt)}),A),b.tris.min===1/0&&(b.tris.min=0,b.tris.max=0),b.depth.min===1/0&&(b.depth.min=0,b.depth.max=0),b}(r,b)))},getJSONStructure:function(r){const A=[];return r.traverse(((r,b,C,I,S)=>{const B={bounds:arrayToBox(0,C,new x)};b?(B.count=S,B.offset=I):(B.left=null,B.right=null),A[r]=B;const D=A[r-1];D&&(null===D.left?D.left=B:D.right=B)})),A[0]},getTriangleHitPointInfo:function(r,C,I,x){const S=C.getIndex().array,B=C.getAttribute("position"),D=C.getAttribute("uv"),R=S[3*I],F=S[3*I+1],N=S[3*I+2];xs.fromBufferAttribute(B,R),Ss.fromBufferAttribute(B,F),Bs.fromBufferAttribute(B,N);let Q=0;const H=C.groups,G=3*I;for(let r=0,A=H.length;r<A;r++){const A=H[r],{start:b,count:C}=A;if(G>=b&&G<b+C){Q=A.materialIndex;break}}let V=null;return D&&(Ds.fromBufferAttribute(D,R),Ps.fromBufferAttribute(D,F),Ms.fromBufferAttribute(D,N),V=x&&x.uv?x.uv:new b,j.getInterpolation(r,xs,Ss,Bs,Ds,Ps,Ms,V)),x?(x.face||(x.face={}),x.face.a=R,x.face.b=F,x.face.c=N,x.face.materialIndex=Q,x.face.normal||(x.face.normal=new A),j.getNormal(xs,Ss,Bs,x.face.normal),V&&(x.uv=V),x):{face:{a:R,b:F,c:N,materialIndex:Q,normal:j.getNormal(xs,Ss,Bs,new A)},uv:V}},shaderDistanceFunction:Yi,shaderIntersectFunction:Ki,shaderStructs:Xi,validateBounds:function(r){const A=r.geometry,b=[],C=A.index,I=A.getAttribute("position");let x=!0;return r.traverse(((A,S,B,D,R)=>{const F={depth:A,isLeaf:S,boundingData:B,offset:D,count:R};b[A]=F,arrayToBox(0,B,yi);const N=b[A-1];if(S)for(let A=D,b=D+R;A<b;A++){const b=r.resolveTriangleIndex(A);let S,B=3*b,D=3*b+1,R=3*b+2;C&&(B=C.getX(B),D=C.getX(D),R=C.getX(R)),Ci.fromBufferAttribute(I,B),S=yi.containsPoint(Ci),Ci.fromBufferAttribute(I,D),S=S&&yi.containsPoint(Ci),Ci.fromBufferAttribute(I,R),S=S&&yi.containsPoint(Ci),console.assert(S,"Leaf bounds does not fully contain triangle."),x=x&&S}if(N){arrayToBox(0,B,vi);const r=vi.containsBox(yi);console.assert(r,"Parent bounds does not fully contain child."),x=x&&r}})),x}});const numberOr=(r,A)=>"number"==typeof r?r:A,capitalizeFirstLetter=r=>r.charAt(0).toUpperCase()+r.slice(1),isDescendant=(r,A)=>{for(;A?.parent;){if(A.parent==r)return!0;A=A.parent}return!1},cartesianToPolar=(r,A)=>[Math.sqrt(r*r+A*A),Math.atan2(A,r)],polarToCartesian=(r,A)=>[r*Math.cos(A),r*Math.sin(A)],radiansToDegrees=r=>(r+Math.PI)/(2*Math.PI)*360;function hueToRGB(r,A,b){return b<0&&(b+=1),b>1&&(b-=1),b<1/6?r+6*(A-r)*b:b<.5?A:b<2/3?r+(A-r)*(2/3-b)*6:r}const hslToRGB=(r,A,b)=>{let C,I,x;if(r/=360,0==A)C=I=x=b;else{let S=b<.5?b*(1+A):b+A-b*A,B=2*b-S;C=hueToRGB(B,S,r+1/3),I=hueToRGB(B,S,r),x=hueToRGB(B,S,r-1/3)}return[Math.round(255*C),Math.round(255*I),Math.round(255*x)]},rgbToHex=(r,A,b)=>r<<16^A<<8^b<<0;function containsGeometry(r){if(r.geometry)return!0;for(let A of r.children)if(containsGeometry(A))return!0;return!1}const setupBVHForComplexObject=r=>{if(!containsGeometry(r))return!1;if(r.parent){let A=r.parent;A.remove(r),r.updateMatrixWorld(!0),A.add(r)}if(r.children?.length){r.staticGeometryGenerator=new StaticGeometryGenerator([r]);try{r.bvhGeometry=r.staticGeometryGenerator.generate()}catch(r){return console.error(r),!1}}else r.bvhGeometry=r.geometry;return r.bvhGeometry.computeBoundsTree(),r.parent&&r.updateMatrixWorld(!0),!0},updateBVHForComplexObject=r=>{if(!r.staticGeometryGenerator)return setupBVHForComplexObject(r);if(r.parent){let A=r.parent;A.remove(r),r.updateMatrixWorld(!0),A.add(r)}r.staticGeometryGenerator.generate(r.bvhGeometry),r.bvhGeometry.boundsTree.refit(),r.parent&&r.updateMatrixWorld(!0)};var Zi=Object.freeze({__proto__:null,addBVHHelper:A=>{if(A.bvhGeometry&&A.geomtry==A.bvhGeometry)return void A.parent.add(new MeshBVHHelper(A));let b=new r.MeshBasicMaterial({wireframe:!0,transparent:!0,opacity:.05,depthWrite:!1}),C=new r.Mesh(A.bvhGeometry,b);A.parent.add(C);let I=new MeshBVHHelper(C,10);A.parent.add(I),A.bvhHelper=I},capitalizeFirstLetter:capitalizeFirstLetter,cartesianToPolar:cartesianToPolar,hslToRGB:hslToRGB,isDescendant:isDescendant,numberOr:numberOr,polarToCartesian:polarToCartesian,radiansToDegrees:radiansToDegrees,rgbToHex:rgbToHex,setupBVHForComplexObject:setupBVHForComplexObject,updateBVHForComplexObject:updateBVHForComplexObject});class UIComponent extends r.Object3D{constructor(...r){super(),r=Array.from(new Set(r)),this._styles=[],this._needsUpdate={},this._overrideStyle={},this._latestValue={},this._defaults={},this._styleListener=r=>this._onStyleChange(r);for(let A of r)A&&(A instanceof Style||(A=new Style(A)),this._styles.push(A),A.addUpdateListener(this._styleListener))}addStyle(r){let A=!1;for(let b=this._styles.length-1;b>=0;b--)r==this._styles[b]&&(this._styles.splice(b,1),A=!0);this._styles.push(r);for(let A of Style.PROPERTIES)null!=r[A]&&this._onStyleChange(A);A||r.addUpdateListener(this._styleListener)}_onStyleChange(r){this._needsUpdate[r]=!0;let A="_handleStyleUpdateFor"+capitalizeFirstLetter(r);A in this&&this[A]()}removeStyle(r){let A=!1;for(let b=this._styles.length-1;b>=0;b--)r==this._styles[b]&&(this._styles.splice(b,1),A=!0);if(A){for(let A of Style.PROPERTIES)null!=r[A]&&this._onStyleChange(A);r.removeUpdateListener(this._styleListener)}}_genericGet(r){if(r in this._overrideStyle)return this._overrideStyle[r];if(!this._needsUpdate[r]&&null!=this._latestValue[r])return this._latestValue[r];for(let A=this._styles.length-1;A>=0;A--){let b=this._styles[A][r];if(null!=b)return this._needsUpdate[r]=!1,this._latestValue[r]=b,b}return this._needsUpdate[r]=!1,this._latestValue[r]=this._defaults[r],this._defaults[r]}_genericSet(r,A){null==A?delete this._overrideStyle[r]:this._overrideStyle[r]=A;let b="_handleStyleUpdateFor"+capitalizeFirstLetter(r);b in this&&this[b]()}get alignItems(){return this._genericGet("alignItems")}get backgroundVisible(){return this._genericGet("backgroundVisible")}get borderMaterial(){return this._genericGet("borderMaterial")}get borderRadius(){return this._genericGet("borderRadius")}get borderBottomLeftRadius(){return this._genericGet("borderBottomLeftRadius")}get borderBottomRightRadius(){return this._genericGet("borderBottomRightRadius")}get borderTopLeftRadius(){return this._genericGet("borderTopLeftRadius")}get borderTopRightRadius(){return this._genericGet("borderTopRightRadius")}get borderWidth(){return this._genericGet("borderWidth")}get color(){return this._genericGet("color")}get contentDirection(){return this._genericGet("contentDirection")}get font(){return this._genericGet("font")}get fontSize(){return this._genericGet("fontSize")}get glassmorphism(){return this._genericGet("glassmorphism")}get height(){return this._genericGet("height")}get justifyContent(){return this._genericGet("justifyContent")}get margin(){return this._genericGet("margin")}get marginBottom(){return this._genericGet("marginBottom")}get marginLeft(){return this._genericGet("marginLeft")}get marginRight(){return this._genericGet("marginRight")}get marginTop(){return this._genericGet("marginTop")}get material(){return this._genericGet("material")}get materialColor(){return this._genericGet("materialColor")}get maxHeight(){return this._genericGet("maxHeight")}get maxWidth(){return this._genericGet("maxWidth")}get minHeight(){return this._genericGet("minHeight")}get minWidth(){return this._genericGet("minWidth")}get opacity(){return this._genericGet("opacity")}get overflow(){return this._genericGet("overflow")}get padding(){return this._genericGet("padding")}get paddingBottom(){return this._genericGet("paddingBottom")}get paddingLeft(){return this._genericGet("paddingLeft")}get paddingRight(){return this._genericGet("paddingRight")}get paddingTop(){return this._genericGet("paddingTop")}get pointerInteractableClassOverride(){return this._genericGet("pointerInteractableClassOverride")}get textAlign(){return this._genericGet("textAlign")}get textureFit(){return this._genericGet("textureFit")}get width(){return this._genericGet("width")}set alignItems(r){this._genericSet("alignItems",r)}set backgroundVisible(r){this._genericSet("backgroundVisible",r)}set borderMaterial(r){this._genericSet("borderMaterial",r)}set borderRadius(r){this._genericSet("borderRadius",r)}set borderBottomLeftRadius(r){this._genericSet("borderBottomLeftRadius",r)}set borderBottomRightRadius(r){this._genericSet("borderBottomRightRadius",r)}set borderTopLeftRadius(r){this._genericSet("borderTopLeftRadius",r)}set borderTopRightRadius(r){this._genericSet("borderTopRightRadius",r)}set borderWidth(r){this._genericSet("borderWidth",r)}set color(r){this._genericSet("color",r)}set contentDirection(r){this._genericSet("contentDirection",r)}set font(r){this._genericSet("font",r)}set fontSize(r){this._genericSet("fontSize",r)}set glassmorphism(r){this._genericSet("glassmorphism",r)}set height(r){this._genericSet("height",r)}set justifyContent(r){this._genericSet("justifyContent",r)}set margin(r){this._genericSet("margin",r)}set marginBottom(r){this._genericSet("marginBottom",r)}set marginLeft(r){this._genericSet("marginLeft",r)}set marginRight(r){this._genericSet("marginRight",r)}set marginTop(r){this._genericSet("marginTop",r)}set material(r){this._genericSet("material",r)}set materialColor(r){this._genericSet("materialColor",r)}set maxHeight(r){this._genericSet("maxHeight",r)}set maxWidth(r){this._genericSet("maxWidth",r)}set minHeight(r){this._genericSet("minHeight",r)}set minWidth(r){this._genericSet("minWidth",r)}set opacity(r){this._genericSet("opacity",r)}set overflow(r){this._genericSet("overflow",r)}set padding(r){this._genericSet("padding",r)}set paddingBottom(r){this._genericSet("paddingBottom",r)}set paddingLeft(r){this._genericSet("paddingLeft",r)}set paddingRight(r){this._genericSet("paddingRight",r)}set paddingTop(r){this._genericSet("paddingTop",r)}set pointerInteractableClassOverride(r){this._genericSet("pointerInteractableClassOverride",r)}set textAlign(r){this._genericSet("textAlign",r)}set textureFit(r){this._genericSet("textureFit",r)}set width(r){this._genericSet("width",r)}}let Ji=new class{constructor(){this._listeners=new Set}add(r){this._listeners.add(r)}remove(r){this._listeners.delete(r)}update(){for(let r of this._listeners)r()}};const $i=new r.MeshBasicMaterial({color:16777215,side:r.DoubleSide,transparent:!0,polygonOffset:!0,polygonOffsetFactor:1,polygonOffsetUnits:1}),en=new r.MeshPhysicalMaterial({color:16777215,roughness:.45,side:r.DoubleSide,specularIntensity:0,transmission:.99,polygonOffset:!0,polygonOffsetFactor:1,polygonOffsetUnits:1}),tn=new r.MeshBasicMaterial({color:16777215,transparent:!0,side:r.DoubleSide,polygonOffset:!0});class LayoutComponent extends UIComponent{constructor(...A){super(...A),this._defaults.alignItems="center",this._defaults.backgroundVisible=!1,this._defaults.borderMaterial=tn.clone(),this._defaults.borderRadius=0,this._defaults.borderWidth=0,this._defaults.contentDirection="column",this._defaults.justifyContent="start",this._defaults.margin=0,this._defaults.material=this.glassmorphism?en.clone():$i.clone(),this._defaults.height="auto",this._defaults.overflow="visible",this._defaults.padding=0,this._defaults.width="auto",this._updateListener=()=>this._updateClippingPlanes(),this.computedHeight=0,this.marginedHeight=0,this.unpaddedHeight=0,this.computedWidth=0,this.marginedWidth=0,this.unpaddedWidth=0,this._materialOffset=0,this._content=new r.Object3D,this._content.position.z=1e-8,this.addEventListener("added",(()=>this._onAdded())),this.addEventListener("removed",(()=>this._onRemoved())),this.add(this._content),"visible"!=this.overflow&&this._createClippingPlanes()}_handleStyleUpdateForAlignItems(){this.updateLayout()}_handleStyleUpdateForBackgroundVisible(){this._background&&(this._background.visible=this.backgroundVisible||!1)}_handleStyleUpdateForBorderRadius(){this._createBackground()}_handleStyleUpdateForBorderBottomLeftRadius(){this._createBackground()}_handleStyleUpdateForBorderBottomRightRadius(){this._createBackground()}_handleStyleUpdateForBorderTopLeftRadius(){this._createBackground()}_handleStyleUpdateForBorderTopRightRadius(){this._createBackground()}_handleStyleUpdateForJustifyContent(){this.updateLayout()}_handleStyleUpdateForMargin(){this.updateLayout()}_handleStyleUpdateForMarginBottom(){this.updateLayout()}_handleStyleUpdateForMarginLeft(){this.updateLayout()}_handleStyleUpdateForMarginRight(){this.updateLayout()}_handleStyleUpdateForMarginTop(){this.updateLayout()}_handleStyleUpdateForMaxHeight(){this.updateLayout()}_handleStyleUpdateForMaxWidth(){this.updateLayout()}_handleStyleUpdateForMinHeight(){this.updateLayout()}_handleStyleUpdateForMinWidth(){this.updateLayout()}_handleStyleUpdateForPadding(){this.updateLayout()}_handleStyleUpdateForPaddingBottom(){this.updateLayout()}_handleStyleUpdateForPaddingLeft(){this.updateLayout()}_handleStyleUpdateForPaddingRight(){this.updateLayout()}_handleStyleUpdateForPaddingTop(){this.updateLayout()}_handleStyleUpdateForHeight(){this.updateLayout()}_handleStyleUpdateForWidth(){this.updateLayout()}_handleStyleUpdateForMaterial(){let r=this.material;r.polygonOffset=!0,r.polygonOffsetFactor=r.polygonOffsetUnits=-1*this._materialOffset,this._background.material=r}_handleStyleUpdateForMaterialColor(){let r=this.materialColor;null==r&&(r="#ffffff"),this.material.color.set(r)}_handleStyleUpdateForOpacity(){let r=this.opacity;null==r&&(r=1),this.material.opacity=r}_handleStyleUpdateForOverflow(){"visible"!=this.overflow?this.clippingPlanes||this._createClippingPlanes():this.clippingPlanes&&this._clearClippingPlanes()}_createBackground(){this._background&&this.remove(this._background),this._border&&this.remove(this._border),this._background=null,this._border=null;let A=this.material,b=this.materialColor,C=this.opacity;null!=b&&A.color.set(b),C&&(A.opacity=C);let I=this.borderWidth||0,x=this.borderRadius||0,S=numberOr(this.borderTopLeftRadius,x),B=numberOr(this.borderTopRightRadius,x),D=numberOr(this.borderBottomLeftRadius,x),R=numberOr(this.borderBottomRightRadius,x),F=this.computedHeight,N=this.computedWidth,Q=this._materialOffset;if(I){let A=LayoutComponent.createShape(N,F,S,B,D,R);S=Math.max(S-I,0),B=Math.max(B-I,0),D=Math.max(D-I,0),R=Math.max(R-I,0),F-=2*I,N-=2*I;let b=LayoutComponent.createShape(N,F,S,B,D,R),C=new r.ShapeGeometry(b);this._background=new r.Mesh(C,this.material),this.add(this._background),A.holes.push(b),C=new r.ShapeGeometry(A),this._border=new r.Mesh(C,this.borderMaterial),this.add(this._border),this._border.renderOrder=Q}else{let A=LayoutComponent.createShape(N,F,S,B,D,R),b=new r.ShapeGeometry(A);this._background=new r.Mesh(b,this.material),this.add(this._background)}this._background.renderOrder=Q,this.backgroundVisible||(this._background.visible=!1)}_addClippingPlanesUpdateListener(){this.clippingPlanes&&Ji.add(this._updateListener);for(let r of this._content.children)r instanceof LayoutComponent&&r._addClippingPlanesUpdateListener()}_removeClippingPlanesUpdateListener(){Ji.remove(this._updateListener);for(let r of this._content.children)r instanceof LayoutComponent&&r._removeClippingPlanesUpdateListener()}_createClippingPlanes(){this.clippingPlanes=[new r.Plane(new r.Vector3(0,1,0)),new r.Plane(new r.Vector3(0,-1,0)),new r.Plane(new r.Vector3(1,0,0)),new r.Plane(new r.Vector3(-1,0,0))],this._updateClippingPlanes(),this.updateClippingPlanes(!0),Ji.add(this._updateListener)}_getClippingPlanes(){let r=[],A=this;for(;A instanceof LayoutComponent;)A.clippingPlanes&&r.push(...A.clippingPlanes),A=A.parentComponent;return r.length?r:null}_clearClippingPlanes(){this.clippingPlanes=null,Ji.remove(this._updateListener),this.updateClippingPlanes(!0)}_updateClippingPlanes(){let r=this.computedWidth/2,A=this.computedHeight/2;this.clippingPlanes[0].constant=A,this.clippingPlanes[1].constant=A,this.clippingPlanes[2].constant=r,this.clippingPlanes[3].constant=r,this.clippingPlanes[0].normal.set(0,1,0),this.clippingPlanes[1].normal.set(0,-1,0),this.clippingPlanes[2].normal.set(1,0,0),this.clippingPlanes[3].normal.set(-1,0,0),this.updateWorldMatrix(!0);for(let r of this.clippingPlanes)r.applyMatrix4(this.matrixWorld)}updateClippingPlanes(r){let A=this._getClippingPlanes();if(this.material.clippingPlanes=A,this.borderMaterial.clippingPlanes=A,this._text&&(this._text.material.clippingPlanes=A),r)for(let r of this._content.children)r instanceof LayoutComponent&&r.updateClippingPlanes(!0)}updateLayout(){let r,A,b,C,I,x,S,B,D,R,F,N,Q,H,G,j,V,W=this.computedHeight,X=this.computedWidth,Y=this.marginedHeight,K=this.marginedWidth,q=this._computeDimension("height"),Z=this._computeDimension("width"),J=this._getContentHeight(),$=this._getContentWidth(),ee=this._content.children.reduce(((r,A)=>r+(A instanceof LayoutComponent?1:0)),0),te=this.alignItems,se=this.justifyContent,ie=0;"row"==this.contentDirection?(A=-Z,B=q,D=-$,b=-this.unpaddedWidth,R="computedWidth",F="computedHeight",I=this.paddingLeft||this.padding,x=this.paddingTop||this.padding,S=this.paddingBottom||this.padding,N="marginLeft",Q="marginRight",H="marginTop",G="marginBottom",j="x",V="y",C=1):(A=q,B=-Z,D=J,b=this.unpaddedHeight,R="computedHeight",F="computedWidth",I=this.paddingTop||this.padding,x=this.paddingLeft||this.padding,S=this.paddingRight||this.padding,N="marginTop",Q="marginBottom",H="marginLeft",G="marginRight",j="y",V="x",C=-1),"start"==se?(r=A/2,r+=I*C):"end"==se?(r=A/-2+D,r-=I*C):"center"==se||Math.abs(b)-Math.abs(D)<0?r=D/2:("spaceBetween"==se?(ie=Math.abs(b-D)/(ee-1)*C,r=A/2):"spaceAround"==se?(ie=Math.abs(b-D)/ee*C,r=A/2+ie/2):"spaceEvenly"==se&&(ie=Math.abs(b-D)/(ee+1)*C,r=A/2+ie),r+=I*C);for(let A of this._content.children)if(A instanceof LayoutComponent){let b=A.margin||0,I=numberOr(A[N],b),D=numberOr(A[Q],b),W=numberOr(A[H],b),X=numberOr(A[G],b);if(r+=I*C,A.position[j]=r+A[R]/2*C,r+=A[R]*C,r+=D*C,r+=ie,"start"==te)A.position[V]=B/2-A[F]/2*C-x*C-W*C;else if("end"==te)A.position[V]=-B/2+A[F]/2*C+S*C+X*C;else{let r=(S-x+X-W)*C/2;A.position[V]=r}}X!=Z||W!=q?(this._createBackground(),this.clippingPlanes&&this._updateClippingPlanes(),this.parentComponent instanceof LayoutComponent&&this.parent.parent.updateLayout(),this._updateChildrensLayout(X!=Z,W!=q)):Y==this.marginedHeight&&K==this.marginedWidth||(this.clippingPlanes&&this._updateClippingPlanes(),this.parentComponent instanceof LayoutComponent&&this.parent.parent.updateLayout())}_updateChildrensLayout(r,A){for(let b of this._content.children)if(b instanceof LayoutComponent){let C=!1;if(r){let r=b.width;"string"==typeof r&&r.endsWith("%")&&(C=!0)}if(!C&&A){let r=b.height;"string"==typeof r&&r.endsWith("%")&&(C=!0)}C&&b.updateLayout()}}_computeDimension(r,A){let b=capitalizeFirstLetter(r),C="computed"+b,I="margined"+b,x="unpadded"+b,S="max"+b,B="min"+b,D=this[A||r];if("number"==typeof D)this[C]=D;else if("auto"==D)if("column"==this.contentDirection==("height"==r)){let A=0;for(let r of this._content.children)r instanceof LayoutComponent&&(A+=r[I]);let b="height"==r?this.paddingVertical:this.paddingHorizontal;this[C]=A+b}else{let A=0;for(let r of this._content.children)r instanceof LayoutComponent&&(A=Math.max(A,r[I]));let b="height"==r?this.paddingVertical:this.paddingHorizontal;this[C]=A+b}else{let r=this.parentComponent;if(r instanceof LayoutComponent){let A=Number(D.replace("%",""))/100;this[C]=r[x]*A}}if(A)return this[C];{let A=!1;if(null!=this[S]){let b=this[C];this._computeDimension(r,S),b<this[C]?this[C]=b:A=!0}if(null!=this[B]&&!A){let A=this[C];this._computeDimension(r,B),A>this[C]&&(this[C]=A)}}return this._computeUnpaddedAndMarginedDimensions(r,this[C]),this[C]}_computeUnpaddedAndMarginedDimensions(r,A){let b="margined"+capitalizeFirstLetter(r),C="height"==r?"Vertical":"Horizontal";this["unpadded"+capitalizeFirstLetter(r)]=A-this["padding"+C],this[b]=A+this["margin"+C],"height"==r?(this.unpaddedHeight=Math.max(A-this.paddingVertical,0),this.marginedHeight=A+this.marginVertical):(this.unpaddedWidth=Math.max(A-this.paddingHorizontal,0),this.marginedWidth=A+this.marginHorizontal)}_getContentHeight(){if("column"==this.contentDirection){let r=0;for(let A of this._content.children)A instanceof LayoutComponent&&(r+=A.marginedHeight);return r}{let r=0;for(let A of this._content.children)A instanceof LayoutComponent&&(r=Math.max(r,A.marginedHeight));return r}}_getContentWidth(){if("row"==this.contentDirection){let r=0;for(let A of this._content.children)A instanceof LayoutComponent&&(r+=A.marginedWidth);return r}{let r=0;for(let A of this._content.children)A instanceof LayoutComponent&&(r=Math.max(r,A.marginedWidth));return r}}_updateMaterialOffset(r){this._materialOffset=r+1;let A=this.material,b=this.borderMaterial;b.polygonOffset=A.polygonOffset=!0,b.polygonOffsetFactor=b.polygonOffsetUnits=A.polygonOffsetFactor=A.polygonOffsetUnits=-1*this._materialOffset;for(let r of this._content.children)r instanceof LayoutComponent&&r._updateMaterialOffset(this._materialOffset);let C=this._materialOffset;this._background&&(this._background.renderOrder=C),this._border&&(this._border.renderOrder=C)}_onAdded(){this._addClippingPlanesUpdateListener()}_onRemoved(){this._removeClippingPlanesUpdateListener()}add(r){if(arguments.length>1)for(let r of arguments)this.add(r);else r instanceof UIComponent&&!r.bypassContentPositioning?(this._content.add(r),r.updateLayout(),r._updateMaterialOffset(this._materialOffset),r.updateClippingPlanes(!0),this.updateLayout()):super.add(r)}remove(r){if(arguments.length>1)for(let r of arguments)this.add(r);else r instanceof UIComponent&&!r.bypassContentPositioning?this._content.remove(r):super.remove(r)}get marginHorizontal(){let r=this.margin||0;return numberOr(this.marginLeft,r)+numberOr(this.marginRight,r)}get marginVertical(){let r=this.margin||0;return numberOr(this.marginTop,r)+numberOr(this.marginBottom,r)}get paddingHorizontal(){let r=this.padding||0;return numberOr(this.paddingLeft,r)+numberOr(this.paddingRight,r)}get paddingVertical(){let r=this.padding||0;return numberOr(this.paddingTop,r)+numberOr(this.paddingBottom,r)}get parentComponent(){return this.parent?.parent}static createShape(A,b,C,I,x,S){let B=new r.Shape,D=A/2,R=b/2,F=-1*D,N=-1*R;return B.moveTo(F,N+x),B.lineTo(F,R-C),C&&B.absarc(F+C,R-C,C,Math.PI,Math.PI/2,!0),B.lineTo(D-I,R),I&&B.absarc(D-I,R-I,I,Math.PI/2,0,!0),B.lineTo(D,N+S),S&&B.absarc(D-S,N+S,S,0,Math.PI/-2,!0),B.lineTo(F+x,N),x&&B.absarc(F+x,N+x,x,Math.PI/-2,-Math.PI,!0),B}}let sn=new class{constructor(){this._tool=null,this._listeners=new Set}getTool(){return this._tool}setTool(r){this._tool=r;for(let A of this._listeners)A(r)}addUpdateListener(r){this._listeners.add(r)}removeUpdateListener(r){this._listeners.delete(r)}};const nn={IDLE:"IDLE",DISABLED:"DISABLED",HOVERED:"HOVERED",SELECTED:"SELECTED"};class Interactable{constructor(r){this._object=r,this._state=nn.IDLE,this.children=new Set,this._hoveredOwners=new Set,this._selectedOwners=new Set,this._capturedOwners=new Set,this._stateCallbacks=new Set,this._hoveredCallbacks=new Set,this._callbacks={},this._callbacksLength=0,this._toolCounts={},this._hoveredCallbackState=!1,this._disabled=!1}addEventListener(r,A,b){b&&(b={...b});let C=b?.tool||"none";r in this._callbacks||(this._callbacks[r]=new Map),this._callbacks[r].has(A)&&this.removeEventListener(r,A),this._callbacks[r].set(A,b),this._callbacksLength++,this._toolCounts[C]||(this._toolCounts[C]=0),this._toolCounts[C]++}copyEventListenersTo(r){for(let A in this._callbacks)for(let[b,C]of this._callbacks[A])r.addEventListener(A,b,C)}removeEventListener(r,A){if(r in this._callbacks&&this._callbacks[r].has(A)){let b=this._callbacks[r].get(A);this._callbacks[r].delete(A),this._callbacksLength--;let C=b?.tool||"none";this._toolCounts[C]--}}dispatchEvent(r,A){if(this._disabled||!(r in this._callbacks))return;let b=sn.getTool();for(let[C,I]of this._callbacks[r]){let r=I?.tool;r&&r!=b||C(A)}}over(r){this.dispatchEvent("over",r)}out(r){this.dispatchEvent("out",r)}down(r){this.dispatchEvent("down",r)}up(r){this.dispatchEvent("up",r)}click(r){this.dispatchEvent("click",r),this._capturedOwners.has(r.owner)&&this._capturedOwners.delete(r.owner)}move(r){this.dispatchEvent("move",r)}drag(r){this.dispatchEvent("drag",r)}capture(r){this._capturedOwners.add(r)}isCapturedBy(r){return this._capturedOwners.has(r)}getCallbacksLength(r){return r?this._toolCounts[r]:this._callbacksLength}supportsTool(){let r=sn.getTool();return this._toolCounts.none||this._toolCounts[r]}isOnlyGroup(){return!this.supportsTool()}addStateCallback(r){this._stateCallbacks.add(r)}addHoveredCallback(r){this._hoveredCallbacks.add(r)}removeStateCallback(r){this._stateCallbacks.delete(r)}removeHoveredCallback(r){this._hoveredCallbacks.delete(r)}_determineAndSetState(){this._selectedOwners.size>0?this.state=nn.SELECTED:this._hoveredOwners.size>0?this.state=nn.HOVERED:this.state=nn.IDLE}_determineHoveredCallbackState(){if(this._disabled||0==this._hoveredCallbacks.size)return;let r=!1;for(let A of this._hoveredOwners)if(!this._selectedOwners.has(A)){r=!0;break}if(r!=this._hoveredCallbackState){this._hoveredCallbackState=r;for(let A of this._hoveredCallbacks)A(r)}}addHoveredBy(r){this._hoveredOwners.has(r)||(this._hoveredOwners.add(r),this._determineHoveredCallbackState(),0==this._selectedOwners.size&&(this.state=nn.HOVERED))}removeHoveredBy(r){this._hoveredOwners.delete(r),this._determineAndSetState(),this._determineHoveredCallbackState()}addSelectedBy(r){this._selectedOwners.add(r),this.state=nn.SELECTED,this._determineHoveredCallbackState()}removeSelectedBy(r){this._selectedOwners.delete(r),this._determineAndSetState(),this._determineHoveredCallbackState()}reset(){this._hoveredOwners.clear(),this._selectedOwners.clear(),this.state=nn.IDLE,this.children.forEach((r=>{r.reset()}))}addChild(r){r.parent!=this&&(r.parent&&r.parent.removeChild(r),this.children.add(r),r.parent=this)}addChildren(r){r.forEach((r=>{this.addChild(r)}))}removeChild(r){this.children.delete(r),r.parent=null}removeChildren(r){r.forEach((r=>{this.removeChild(r)}))}get disabled(){return this._disabled}get object(){return this._object}get state(){return this._state}set disabled(r){r?(this._hoveredCallbackState&&(this._hoveredCallbacks.forEach((r=>r(!1))),this._hoveredCallbackState=!1),this.state=nn.DISABLED,this._disabled=r):(this._disabled=r,this._determineAndSetState(),this._determineHoveredCallbackState())}set object(r){this._object=r}set state(r){if(!this._disabled&&this._state!=r){this._state=r;for(let A of this._stateCallbacks)A(r)}}}class PointerInteractable extends Interactable{constructor(r){super(r),r&&(r.pointerInteractable=this),this._maxDistance=-1/0,this._hoveredCursor="pointer"}addEventListener(r,A,b={}){null==(b={...b}).maxDistance&&(b.maxDistance=1/0),b.maxDistance>this._maxDistance&&(this._maxDistance=b.maxDistance),super.addEventListener(r,A,b)}removeEventListener(r,A){let b=!1;if(r in this._callbacks&&this._callbacks[r].has(A)&&this._callbacks[r].get(A).maxDistance==this._maxDistance&&(b=!0),super.removeEventListener(r,A),b){this._maxDistance=-1/0;for(let r in this._callbacks)for(let[A,b]of this._callbacks[r])b.maxDistance>this._maxDistance&&(this._maxDistance=b.maxDistance)}}dispatchEvent(r,A){if(this._disabled||!(r in this._callbacks))return;let b=sn.getTool();for(let[C,I]of this._callbacks[r]){let r=I.tool;r&&r!=b||(null==A?.userDistance||I.maxDistance>=A.userDistance)&&C(A)}}isWithinReach(r){return r<this._maxDistance}get hoveredCursor(){return this._disabled?"not-allowed":this._hoveredCursor}set hoveredCursor(r){this._hoveredCursor=r}}const rn=new r.Matrix4;class TouchInteractable extends Interactable{constructor(r){super(r),this._target1={},this._target2={},this._targets=[this._target1,this._target2],r&&(r.touchInteractable=this,r.bvhGeometry||setupBVHForComplexObject(r)),this._createBoundingObject()}_createBoundingObject(){this._boundingBox=new r.Box3}_getBoundingObject(){return this._boundingBox.setFromObject(this._object),this._boundingBox}intersectsSphere(r){let A,b=this._getBoundingObject();return A=!!b&&r.intersectsBox(b),A}intersectsObject(r){if(r?.bvhGeometry?.boundsTree&&(this._object?.bvhGeometry?.boundsTree||setupBVHForComplexObject(this._object)))return rn.copy(this._object.matrixWorld).invert().multiply(r.matrixWorld),this._object.bvhGeometry.boundsTree.intersectsGeometry(r.bvhGeometry,rn)}getClosestPointTo(r){if(r.model&&(r=r.model),r?.bvhGeometry?.boundsTree&&this._object?.bvhGeometry?.boundsTree)return rn.copy(this._object.matrixWorld).invert().multiply(r.matrixWorld),this._object.bvhGeometry.boundsTree.closestPointToGeometry(r.bvhGeometry,rn,this._target1,this._target2)?(this._target2.object=r,this._targets):void 0}}const an={POINTER:"POINTER",TOUCH_SCREEN:"TOUCH_SCREEN",XR:"XR"},on={LEFT:"LEFT",RIGHT:"RIGHT",otherHand:r=>r==on.LEFT?on.RIGHT:r==on.RIGHT?on.LEFT:void console.error("ERROR: Unexpected hand provided to Handedness.otherHand")},ln={CONTROLLER:"CONTROLLER",HAND:"HAND",OTHER:"OTHER"};function toTrianglesDrawMode$1(r,A){if(A===ze)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),r;if(A===We||A===Xe){let b=r.getIndex();if(null===b){const A=[],C=r.getAttribute("position");if(void 0===C)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),r;for(let r=0;r<C.count;r++)A.push(r);r.setIndex(A),b=r.getIndex()}const C=b.count-2,I=[];if(A===We)for(let r=1;r<=C;r++)I.push(b.getX(0)),I.push(b.getX(r)),I.push(b.getX(r+1));else for(let r=0;r<C;r++)r%2==0?(I.push(b.getX(r)),I.push(b.getX(r+1)),I.push(b.getX(r+2))):(I.push(b.getX(r+2)),I.push(b.getX(r+1)),I.push(b.getX(r)));I.length/3!==C&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const x=r.clone();return x.setIndex(I),x.clearGroups(),x}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",A),r}let hn=class GLTFLoader extends ee{constructor(r){super(r),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register((function(r){return new An(r)})),this.register((function(r){return new gn(r)})),this.register((function(r){return new En(r)})),this.register((function(r){return new In(r)})),this.register((function(r){return new Tn(r)})),this.register((function(r){return new mn(r)})),this.register((function(r){return new _n(r)})),this.register((function(r){return new bn(r)})),this.register((function(r){return new yn(r)})),this.register((function(r){return new pn(r)})),this.register((function(r){return new vn(r)})),this.register((function(r){return new fn(r)})),this.register((function(r){return new wn(r)})),this.register((function(r){return new Cn(r)})),this.register((function(r){return new cn(r)})),this.register((function(r){return new xn(r)})),this.register((function(r){return new Sn(r)}))}load(r,A,b,C){const I=this;let x;if(""!==this.resourcePath)x=this.resourcePath;else if(""!==this.path){const A=te.extractUrlBase(r);x=te.resolveURL(A,this.path)}else x=te.extractUrlBase(r);this.manager.itemStart(r);const _onError=function(A){C?C(A):console.error(A),I.manager.itemError(r),I.manager.itemEnd(r)},S=new se(this.manager);S.setPath(this.path),S.setResponseType("arraybuffer"),S.setRequestHeader(this.requestHeader),S.setWithCredentials(this.withCredentials),S.load(r,(function(b){try{I.parse(b,x,(function(b){A(b),I.manager.itemEnd(r)}),_onError)}catch(r){_onError(r)}}),b,_onError)}setDRACOLoader(r){return this.dracoLoader=r,this}setKTX2Loader(r){return this.ktx2Loader=r,this}setMeshoptDecoder(r){return this.meshoptDecoder=r,this}register(r){return-1===this.pluginCallbacks.indexOf(r)&&this.pluginCallbacks.push(r),this}unregister(r){return-1!==this.pluginCallbacks.indexOf(r)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(r),1),this}parse(r,A,b,C){let I;const x={},S={},B=new TextDecoder;if("string"==typeof r)I=JSON.parse(r);else if(r instanceof ArrayBuffer)if(B.decode(new Uint8Array(r,0,4))===Bn){try{x[dn.KHR_BINARY_GLTF]=new Dn(r)}catch(r){return void(C&&C(r))}I=JSON.parse(x[dn.KHR_BINARY_GLTF].content)}else I=JSON.parse(B.decode(r));else I=r;if(void 0===I.asset||I.asset.version[0]<2)return void(C&&C(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const D=new Wn(I,{path:A||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});D.fileLoader.setRequestHeader(this.requestHeader);for(let r=0;r<this.pluginCallbacks.length;r++){const A=this.pluginCallbacks[r](D);A.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),S[A.name]=A,x[A.name]=!0}if(I.extensionsUsed)for(let r=0;r<I.extensionsUsed.length;++r){const A=I.extensionsUsed[r],b=I.extensionsRequired||[];switch(A){case dn.KHR_MATERIALS_UNLIT:x[A]=new un;break;case dn.KHR_DRACO_MESH_COMPRESSION:x[A]=new Pn(I,this.dracoLoader);break;case dn.KHR_TEXTURE_TRANSFORM:x[A]=new Mn;break;case dn.KHR_MESH_QUANTIZATION:x[A]=new kn;break;default:b.indexOf(A)>=0&&void 0===S[A]&&console.warn('THREE.GLTFLoader: Unknown extension "'+A+'".')}}D.setExtensions(x),D.setPlugins(S),D.parse(b,C)}parseAsync(r,A){const b=this;return new Promise((function(C,I){b.parse(r,A,C,I)}))}};function GLTFRegistry$1(){let r={};return{get:function(A){return r[A]},add:function(A,b){r[A]=b},remove:function(A){delete r[A]},removeAll:function(){r={}}}}const dn={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};let cn=class GLTFLightsExtension{constructor(r){this.parser=r,this.name=dn.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const r=this.parser,A=this.parser.json.nodes||[];for(let b=0,C=A.length;b<C;b++){const C=A[b];C.extensions&&C.extensions[this.name]&&void 0!==C.extensions[this.name].light&&r._addNodeRef(this.cache,C.extensions[this.name].light)}}_loadLight(r){const A=this.parser,b="light:"+r;let C=A.cache.get(b);if(C)return C;const I=A.json,x=((I.extensions&&I.extensions[this.name]||{}).lights||[])[r];let S;const B=new Q(16777215);void 0!==x.color&&B.setRGB(x.color[0],x.color[1],x.color[2],ie);const D=void 0!==x.range?x.range:0;switch(x.type){case"directional":S=new ae(B),S.target.position.set(0,0,-1),S.add(S.target);break;case"point":S=new re(B),S.distance=D;break;case"spot":S=new ne(B),S.distance=D,x.spot=x.spot||{},x.spot.innerConeAngle=void 0!==x.spot.innerConeAngle?x.spot.innerConeAngle:0,x.spot.outerConeAngle=void 0!==x.spot.outerConeAngle?x.spot.outerConeAngle:Math.PI/4,S.angle=x.spot.outerConeAngle,S.penumbra=1-x.spot.innerConeAngle/x.spot.outerConeAngle,S.target.position.set(0,0,-1),S.add(S.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+x.type)}return S.position.set(0,0,0),S.decay=2,assignExtrasToUserData$1(S,x),void 0!==x.intensity&&(S.intensity=x.intensity),S.name=A.createUniqueName(x.name||"light_"+r),C=Promise.resolve(S),A.cache.add(b,C),C}getDependency(r,A){if("light"===r)return this._loadLight(A)}createNodeAttachment(r){const A=this,b=this.parser,C=b.json.nodes[r],I=(C.extensions&&C.extensions[this.name]||{}).light;return void 0===I?null:this._loadLight(I).then((function(r){return b._getNodeRef(A.cache,I,r)}))}},un=class GLTFMaterialsUnlitExtension{constructor(){this.name=dn.KHR_MATERIALS_UNLIT}getMaterialType(){return H}extendParams(r,A,b){const C=[];r.color=new Q(1,1,1),r.opacity=1;const I=A.pbrMetallicRoughness;if(I){if(Array.isArray(I.baseColorFactor)){const A=I.baseColorFactor;r.color.setRGB(A[0],A[1],A[2],ie),r.opacity=A[3]}void 0!==I.baseColorTexture&&C.push(b.assignTexture(r,"map",I.baseColorTexture,oe))}return Promise.all(C)}},pn=class GLTFMaterialsEmissiveStrengthExtension{constructor(r){this.parser=r,this.name=dn.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(r,A){const b=this.parser.json.materials[r];if(!b.extensions||!b.extensions[this.name])return Promise.resolve();const C=b.extensions[this.name].emissiveStrength;return void 0!==C&&(A.emissiveIntensity=C),Promise.resolve()}},An=class GLTFMaterialsClearcoatExtension{constructor(r){this.parser=r,this.name=dn.KHR_MATERIALS_CLEARCOAT}getMaterialType(r){const A=this.parser.json.materials[r];return A.extensions&&A.extensions[this.name]?le:null}extendMaterialParams(r,A){const C=this.parser,I=C.json.materials[r];if(!I.extensions||!I.extensions[this.name])return Promise.resolve();const x=[],S=I.extensions[this.name];if(void 0!==S.clearcoatFactor&&(A.clearcoat=S.clearcoatFactor),void 0!==S.clearcoatTexture&&x.push(C.assignTexture(A,"clearcoatMap",S.clearcoatTexture)),void 0!==S.clearcoatRoughnessFactor&&(A.clearcoatRoughness=S.clearcoatRoughnessFactor),void 0!==S.clearcoatRoughnessTexture&&x.push(C.assignTexture(A,"clearcoatRoughnessMap",S.clearcoatRoughnessTexture)),void 0!==S.clearcoatNormalTexture&&(x.push(C.assignTexture(A,"clearcoatNormalMap",S.clearcoatNormalTexture)),void 0!==S.clearcoatNormalTexture.scale)){const r=S.clearcoatNormalTexture.scale;A.clearcoatNormalScale=new b(r,r)}return Promise.all(x)}},gn=class GLTFMaterialsDispersionExtension{constructor(r){this.parser=r,this.name=dn.KHR_MATERIALS_DISPERSION}getMaterialType(r){const A=this.parser.json.materials[r];return A.extensions&&A.extensions[this.name]?le:null}extendMaterialParams(r,A){const b=this.parser.json.materials[r];if(!b.extensions||!b.extensions[this.name])return Promise.resolve();const C=b.extensions[this.name];return A.dispersion=void 0!==C.dispersion?C.dispersion:0,Promise.resolve()}},fn=class GLTFMaterialsIridescenceExtension{constructor(r){this.parser=r,this.name=dn.KHR_MATERIALS_IRIDESCENCE}getMaterialType(r){const A=this.parser.json.materials[r];return A.extensions&&A.extensions[this.name]?le:null}extendMaterialParams(r,A){const b=this.parser,C=b.json.materials[r];if(!C.extensions||!C.extensions[this.name])return Promise.resolve();const I=[],x=C.extensions[this.name];return void 0!==x.iridescenceFactor&&(A.iridescence=x.iridescenceFactor),void 0!==x.iridescenceTexture&&I.push(b.assignTexture(A,"iridescenceMap",x.iridescenceTexture)),void 0!==x.iridescenceIor&&(A.iridescenceIOR=x.iridescenceIor),void 0===A.iridescenceThicknessRange&&(A.iridescenceThicknessRange=[100,400]),void 0!==x.iridescenceThicknessMinimum&&(A.iridescenceThicknessRange[0]=x.iridescenceThicknessMinimum),void 0!==x.iridescenceThicknessMaximum&&(A.iridescenceThicknessRange[1]=x.iridescenceThicknessMaximum),void 0!==x.iridescenceThicknessTexture&&I.push(b.assignTexture(A,"iridescenceThicknessMap",x.iridescenceThicknessTexture)),Promise.all(I)}},mn=class GLTFMaterialsSheenExtension{constructor(r){this.parser=r,this.name=dn.KHR_MATERIALS_SHEEN}getMaterialType(r){const A=this.parser.json.materials[r];return A.extensions&&A.extensions[this.name]?le:null}extendMaterialParams(r,A){const b=this.parser,C=b.json.materials[r];if(!C.extensions||!C.extensions[this.name])return Promise.resolve();const I=[];A.sheenColor=new Q(0,0,0),A.sheenRoughness=0,A.sheen=1;const x=C.extensions[this.name];if(void 0!==x.sheenColorFactor){const r=x.sheenColorFactor;A.sheenColor.setRGB(r[0],r[1],r[2],ie)}return void 0!==x.sheenRoughnessFactor&&(A.sheenRoughness=x.sheenRoughnessFactor),void 0!==x.sheenColorTexture&&I.push(b.assignTexture(A,"sheenColorMap",x.sheenColorTexture,oe)),void 0!==x.sheenRoughnessTexture&&I.push(b.assignTexture(A,"sheenRoughnessMap",x.sheenRoughnessTexture)),Promise.all(I)}},_n=class GLTFMaterialsTransmissionExtension{constructor(r){this.parser=r,this.name=dn.KHR_MATERIALS_TRANSMISSION}getMaterialType(r){const A=this.parser.json.materials[r];return A.extensions&&A.extensions[this.name]?le:null}extendMaterialParams(r,A){const b=this.parser,C=b.json.materials[r];if(!C.extensions||!C.extensions[this.name])return Promise.resolve();const I=[],x=C.extensions[this.name];return void 0!==x.transmissionFactor&&(A.transmission=x.transmissionFactor),void 0!==x.transmissionTexture&&I.push(b.assignTexture(A,"transmissionMap",x.transmissionTexture)),Promise.all(I)}},bn=class GLTFMaterialsVolumeExtension{constructor(r){this.parser=r,this.name=dn.KHR_MATERIALS_VOLUME}getMaterialType(r){const A=this.parser.json.materials[r];return A.extensions&&A.extensions[this.name]?le:null}extendMaterialParams(r,A){const b=this.parser,C=b.json.materials[r];if(!C.extensions||!C.extensions[this.name])return Promise.resolve();const I=[],x=C.extensions[this.name];A.thickness=void 0!==x.thicknessFactor?x.thicknessFactor:0,void 0!==x.thicknessTexture&&I.push(b.assignTexture(A,"thicknessMap",x.thicknessTexture)),A.attenuationDistance=x.attenuationDistance||1/0;const S=x.attenuationColor||[1,1,1];return A.attenuationColor=(new Q).setRGB(S[0],S[1],S[2],ie),Promise.all(I)}},yn=class GLTFMaterialsIorExtension{constructor(r){this.parser=r,this.name=dn.KHR_MATERIALS_IOR}getMaterialType(r){const A=this.parser.json.materials[r];return A.extensions&&A.extensions[this.name]?le:null}extendMaterialParams(r,A){const b=this.parser.json.materials[r];if(!b.extensions||!b.extensions[this.name])return Promise.resolve();const C=b.extensions[this.name];return A.ior=void 0!==C.ior?C.ior:1.5,Promise.resolve()}},vn=class GLTFMaterialsSpecularExtension{constructor(r){this.parser=r,this.name=dn.KHR_MATERIALS_SPECULAR}getMaterialType(r){const A=this.parser.json.materials[r];return A.extensions&&A.extensions[this.name]?le:null}extendMaterialParams(r,A){const b=this.parser,C=b.json.materials[r];if(!C.extensions||!C.extensions[this.name])return Promise.resolve();const I=[],x=C.extensions[this.name];A.specularIntensity=void 0!==x.specularFactor?x.specularFactor:1,void 0!==x.specularTexture&&I.push(b.assignTexture(A,"specularIntensityMap",x.specularTexture));const S=x.specularColorFactor||[1,1,1];return A.specularColor=(new Q).setRGB(S[0],S[1],S[2],ie),void 0!==x.specularColorTexture&&I.push(b.assignTexture(A,"specularColorMap",x.specularColorTexture,oe)),Promise.all(I)}},Cn=class GLTFMaterialsBumpExtension{constructor(r){this.parser=r,this.name=dn.EXT_MATERIALS_BUMP}getMaterialType(r){const A=this.parser.json.materials[r];return A.extensions&&A.extensions[this.name]?le:null}extendMaterialParams(r,A){const b=this.parser,C=b.json.materials[r];if(!C.extensions||!C.extensions[this.name])return Promise.resolve();const I=[],x=C.extensions[this.name];return A.bumpScale=void 0!==x.bumpFactor?x.bumpFactor:1,void 0!==x.bumpTexture&&I.push(b.assignTexture(A,"bumpMap",x.bumpTexture)),Promise.all(I)}},wn=class GLTFMaterialsAnisotropyExtension{constructor(r){this.parser=r,this.name=dn.KHR_MATERIALS_ANISOTROPY}getMaterialType(r){const A=this.parser.json.materials[r];return A.extensions&&A.extensions[this.name]?le:null}extendMaterialParams(r,A){const b=this.parser,C=b.json.materials[r];if(!C.extensions||!C.extensions[this.name])return Promise.resolve();const I=[],x=C.extensions[this.name];return void 0!==x.anisotropyStrength&&(A.anisotropy=x.anisotropyStrength),void 0!==x.anisotropyRotation&&(A.anisotropyRotation=x.anisotropyRotation),void 0!==x.anisotropyTexture&&I.push(b.assignTexture(A,"anisotropyMap",x.anisotropyTexture)),Promise.all(I)}},En=class GLTFTextureBasisUExtension{constructor(r){this.parser=r,this.name=dn.KHR_TEXTURE_BASISU}loadTexture(r){const A=this.parser,b=A.json,C=b.textures[r];if(!C.extensions||!C.extensions[this.name])return null;const I=C.extensions[this.name],x=A.options.ktx2Loader;if(!x){if(b.extensionsRequired&&b.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return A.loadTextureImage(r,I.source,x)}},In=class GLTFTextureWebPExtension{constructor(r){this.parser=r,this.name=dn.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(r){const A=this.name,b=this.parser,C=b.json,I=C.textures[r];if(!I.extensions||!I.extensions[A])return null;const x=I.extensions[A],S=C.images[x.source];let B=b.textureLoader;if(S.uri){const r=b.options.manager.getHandler(S.uri);null!==r&&(B=r)}return this.detectSupport().then((function(I){if(I)return b.loadTextureImage(r,x.source,B);if(C.extensionsRequired&&C.extensionsRequired.indexOf(A)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return b.loadTexture(r)}))}detectSupport(){return this.isSupported||(this.isSupported=new Promise((function(r){const A=new Image;A.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",A.onload=A.onerror=function(){r(1===A.height)}}))),this.isSupported}},Tn=class GLTFTextureAVIFExtension{constructor(r){this.parser=r,this.name=dn.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(r){const A=this.name,b=this.parser,C=b.json,I=C.textures[r];if(!I.extensions||!I.extensions[A])return null;const x=I.extensions[A],S=C.images[x.source];let B=b.textureLoader;if(S.uri){const r=b.options.manager.getHandler(S.uri);null!==r&&(B=r)}return this.detectSupport().then((function(I){if(I)return b.loadTextureImage(r,x.source,B);if(C.extensionsRequired&&C.extensionsRequired.indexOf(A)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return b.loadTexture(r)}))}detectSupport(){return this.isSupported||(this.isSupported=new Promise((function(r){const A=new Image;A.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",A.onload=A.onerror=function(){r(1===A.height)}}))),this.isSupported}},xn=class GLTFMeshoptCompression{constructor(r){this.name=dn.EXT_MESHOPT_COMPRESSION,this.parser=r}loadBufferView(r){const A=this.parser.json,b=A.bufferViews[r];if(b.extensions&&b.extensions[this.name]){const r=b.extensions[this.name],C=this.parser.getDependency("buffer",r.buffer),I=this.parser.options.meshoptDecoder;if(!I||!I.supported){if(A.extensionsRequired&&A.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return C.then((function(A){const b=r.byteOffset||0,C=r.byteLength||0,x=r.count,S=r.byteStride,B=new Uint8Array(A,b,C);return I.decodeGltfBufferAsync?I.decodeGltfBufferAsync(x,S,B,r.mode,r.filter).then((function(r){return r.buffer})):I.ready.then((function(){const A=new ArrayBuffer(x*S);return I.decodeGltfBuffer(new Uint8Array(A),x,S,B,r.mode,r.filter),A}))}))}return null}},Sn=class GLTFMeshGpuInstancing{constructor(r){this.name=dn.EXT_MESH_GPU_INSTANCING,this.parser=r}createNodeMesh(r){const b=this.parser.json,C=b.nodes[r];if(!C.extensions||!C.extensions[this.name]||void 0===C.mesh)return null;const I=b.meshes[C.mesh];for(const r of I.primitives)if(r.mode!==On.TRIANGLES&&r.mode!==On.TRIANGLE_STRIP&&r.mode!==On.TRIANGLE_FAN&&void 0!==r.mode)return null;const x=C.extensions[this.name].attributes,B=[],D={};for(const r in x)B.push(this.parser.getDependency("accessor",x[r]).then((A=>(D[r]=A,D[r]))));return B.length<1?null:(B.push(this.parser.createNodeMesh(r)),Promise.all(B).then((r=>{const b=r.pop(),C=b.isGroup?b.children:[b],I=r[0].count,x=[];for(const r of C){const b=new S,C=new A,B=new N,R=new A(1,1,1),F=new he(r.geometry,r.material,I);for(let r=0;r<I;r++)D.TRANSLATION&&C.fromBufferAttribute(D.TRANSLATION,r),D.ROTATION&&B.fromBufferAttribute(D.ROTATION,r),D.SCALE&&R.fromBufferAttribute(D.SCALE,r),F.setMatrixAt(r,b.compose(C,B,R));for(const A in D)if("_COLOR_0"===A){const r=D[A];F.instanceColor=new de(r.array,r.itemSize,r.normalized)}else"TRANSLATION"!==A&&"ROTATION"!==A&&"SCALE"!==A&&r.geometry.setAttribute(A,D[A]);ce.prototype.copy.call(F,r),this.parser.assignFinalMaterial(F),x.push(F)}return b.isGroup?(b.clear(),b.add(...x),b):x[0]})))}};const Bn="glTF";let Dn=class GLTFBinaryExtension{constructor(r){this.name=dn.KHR_BINARY_GLTF,this.content=null,this.body=null;const A=new DataView(r,0,12),b=new TextDecoder;if(this.header={magic:b.decode(new Uint8Array(r.slice(0,4))),version:A.getUint32(4,!0),length:A.getUint32(8,!0)},this.header.magic!==Bn)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const C=this.header.length-12,I=new DataView(r,12);let x=0;for(;x<C;){const A=I.getUint32(x,!0);x+=4;const C=I.getUint32(x,!0);if(x+=4,1313821514===C){const C=new Uint8Array(r,12+x,A);this.content=b.decode(C)}else if(5130562===C){const b=12+x;this.body=r.slice(b,b+A)}x+=A}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}},Pn=class GLTFDracoMeshCompressionExtension{constructor(r,A){if(!A)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=dn.KHR_DRACO_MESH_COMPRESSION,this.json=r,this.dracoLoader=A,this.dracoLoader.preload()}decodePrimitive(r,A){const b=this.json,C=this.dracoLoader,I=r.extensions[this.name].bufferView,x=r.extensions[this.name].attributes,S={},B={},D={};for(const r in x){const A=Gn[r]||r.toLowerCase();S[A]=x[r]}for(const A in r.attributes){const C=Gn[A]||A.toLowerCase();if(void 0!==x[A]){const I=b.accessors[r.attributes[A]],x=Un[I.componentType];D[C]=x.name,B[C]=!0===I.normalized}}return A.getDependency("bufferView",I).then((function(r){return new Promise((function(A,b){C.decodeDracoFile(r,(function(r){for(const A in r.attributes){const b=r.attributes[A],C=B[A];void 0!==C&&(b.normalized=C)}A(r)}),S,D,ie,b)}))}))}},Mn=class GLTFTextureTransformExtension{constructor(){this.name=dn.KHR_TEXTURE_TRANSFORM}extendTexture(r,A){return void 0!==A.texCoord&&A.texCoord!==r.channel||void 0!==A.offset||void 0!==A.rotation||void 0!==A.scale?(r=r.clone(),void 0!==A.texCoord&&(r.channel=A.texCoord),void 0!==A.offset&&r.offset.fromArray(A.offset),void 0!==A.rotation&&(r.rotation=A.rotation),void 0!==A.scale&&r.repeat.fromArray(A.scale),r.needsUpdate=!0,r):r}},kn=class GLTFMeshQuantizationExtension{constructor(){this.name=dn.KHR_MESH_QUANTIZATION}},Rn=class GLTFCubicSplineInterpolant extends Ye{constructor(r,A,b,C){super(r,A,b,C)}copySampleValue_(r){const A=this.resultBuffer,b=this.sampleValues,C=this.valueSize,I=r*C*3+C;for(let r=0;r!==C;r++)A[r]=b[I+r];return A}interpolate_(r,A,b,C){const I=this.resultBuffer,x=this.sampleValues,S=this.valueSize,B=2*S,D=3*S,R=C-A,F=(b-A)/R,N=F*F,Q=N*F,H=r*D,G=H-D,j=-2*Q+3*N,V=Q-N,W=1-j,X=V-N+F;for(let r=0;r!==S;r++){const A=x[G+r+S],b=x[G+r+B]*R,C=x[H+r+S],D=x[H+r]*R;I[r]=W*A+X*b+j*C+V*D}return I}};const Fn=new N;let Ln=class GLTFCubicSplineQuaternionInterpolant extends Rn{interpolate_(r,A,b,C){const I=super.interpolate_(r,A,b,C);return Fn.fromArray(I).normalize().toArray(I),I}};const On={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},Un={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Nn={9728:q,9729:fe,9984:Ke,9985:qe,9986:Ze,9987:me},Qn={33071:Je,33648:$e,10497:_e},Hn={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Gn={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},jn={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Vn={CUBICSPLINE:void 0,LINEAR:Ne,STEP:et};function addUnknownExtensionsToUserData$1(r,A,b){for(const C in b.extensions)void 0===r[C]&&(A.userData.gltfExtensions=A.userData.gltfExtensions||{},A.userData.gltfExtensions[C]=b.extensions[C])}function assignExtrasToUserData$1(r,A){void 0!==A.extras&&("object"==typeof A.extras?Object.assign(r.userData,A.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+A.extras))}function updateMorphTargets$1(r,A){if(r.updateMorphTargets(),void 0!==A.weights)for(let b=0,C=A.weights.length;b<C;b++)r.morphTargetInfluences[b]=A.weights[b];if(A.extras&&Array.isArray(A.extras.targetNames)){const b=A.extras.targetNames;if(r.morphTargetInfluences.length===b.length){r.morphTargetDictionary={};for(let A=0,C=b.length;A<C;A++)r.morphTargetDictionary[b[A]]=A}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function createPrimitiveKey$1(r){let A;const b=r.extensions&&r.extensions[dn.KHR_DRACO_MESH_COMPRESSION];if(A=b?"draco:"+b.bufferView+":"+b.indices+":"+createAttributesKey$1(b.attributes):r.indices+":"+createAttributesKey$1(r.attributes)+":"+r.mode,void 0!==r.targets)for(let b=0,C=r.targets.length;b<C;b++)A+=":"+createAttributesKey$1(r.targets[b]);return A}function createAttributesKey$1(r){let A="";const b=Object.keys(r).sort();for(let C=0,I=b.length;C<I;C++)A+=b[C]+":"+r[b[C]]+";";return A}function getNormalizedComponentScale$1(r){switch(r){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}const zn=new S;let Wn=class GLTFParser{constructor(r={},A={}){this.json=r,this.extensions={},this.plugins={},this.options=A,this.cache=new GLTFRegistry$1,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let b=!1,C=-1,I=!1,x=-1;if("undefined"!=typeof navigator){const r=navigator.userAgent;b=!0===/^((?!chrome|android).)*safari/i.test(r);const A=r.match(/Version\/(\d+)/);C=b&&A?parseInt(A[1],10):-1,I=r.indexOf("Firefox")>-1,x=I?r.match(/Firefox\/([0-9]+)\./)[1]:-1}"undefined"==typeof createImageBitmap||b&&C<17||I&&x<98?this.textureLoader=new ue(this.options.manager):this.textureLoader=new pe(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new se(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(r){this.extensions=r}setPlugins(r){this.plugins=r}parse(r,A){const b=this,C=this.json,I=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll((function(r){return r._markDefs&&r._markDefs()})),Promise.all(this._invokeAll((function(r){return r.beforeRoot&&r.beforeRoot()}))).then((function(){return Promise.all([b.getDependencies("scene"),b.getDependencies("animation"),b.getDependencies("camera")])})).then((function(A){const x={scene:A[0][C.scene||0],scenes:A[0],animations:A[1],cameras:A[2],asset:C.asset,parser:b,userData:{}};return addUnknownExtensionsToUserData$1(I,x,C),assignExtrasToUserData$1(x,C),Promise.all(b._invokeAll((function(r){return r.afterRoot&&r.afterRoot(x)}))).then((function(){for(const r of x.scenes)r.updateMatrixWorld();r(x)}))})).catch(A)}_markDefs(){const r=this.json.nodes||[],A=this.json.skins||[],b=this.json.meshes||[];for(let b=0,C=A.length;b<C;b++){const C=A[b].joints;for(let A=0,b=C.length;A<b;A++)r[C[A]].isBone=!0}for(let A=0,C=r.length;A<C;A++){const C=r[A];void 0!==C.mesh&&(this._addNodeRef(this.meshCache,C.mesh),void 0!==C.skin&&(b[C.mesh].isSkinnedMesh=!0)),void 0!==C.camera&&this._addNodeRef(this.cameraCache,C.camera)}}_addNodeRef(r,A){void 0!==A&&(void 0===r.refs[A]&&(r.refs[A]=r.uses[A]=0),r.refs[A]++)}_getNodeRef(r,A,b){if(r.refs[A]<=1)return b;const C=b.clone(),updateMappings=(r,A)=>{const b=this.associations.get(r);null!=b&&this.associations.set(A,b);for(const[b,C]of r.children.entries())updateMappings(C,A.children[b])};return updateMappings(b,C),C.name+="_instance_"+r.uses[A]++,C}_invokeOne(r){const A=Object.values(this.plugins);A.push(this);for(let b=0;b<A.length;b++){const C=r(A[b]);if(C)return C}return null}_invokeAll(r){const A=Object.values(this.plugins);A.unshift(this);const b=[];for(let C=0;C<A.length;C++){const I=r(A[C]);I&&b.push(I)}return b}getDependency(r,A){const b=r+":"+A;let C=this.cache.get(b);if(!C){switch(r){case"scene":C=this.loadScene(A);break;case"node":C=this._invokeOne((function(r){return r.loadNode&&r.loadNode(A)}));break;case"mesh":C=this._invokeOne((function(r){return r.loadMesh&&r.loadMesh(A)}));break;case"accessor":C=this.loadAccessor(A);break;case"bufferView":C=this._invokeOne((function(r){return r.loadBufferView&&r.loadBufferView(A)}));break;case"buffer":C=this.loadBuffer(A);break;case"material":C=this._invokeOne((function(r){return r.loadMaterial&&r.loadMaterial(A)}));break;case"texture":C=this._invokeOne((function(r){return r.loadTexture&&r.loadTexture(A)}));break;case"skin":C=this.loadSkin(A);break;case"animation":C=this._invokeOne((function(r){return r.loadAnimation&&r.loadAnimation(A)}));break;case"camera":C=this.loadCamera(A);break;default:if(C=this._invokeOne((function(b){return b!=this&&b.getDependency&&b.getDependency(r,A)})),!C)throw new Error("Unknown type: "+r)}this.cache.add(b,C)}return C}getDependencies(r){let A=this.cache.get(r);if(!A){const b=this,C=this.json[r+("mesh"===r?"es":"s")]||[];A=Promise.all(C.map((function(A,C){return b.getDependency(r,C)}))),this.cache.add(r,A)}return A}loadBuffer(r){const A=this.json.buffers[r],b=this.fileLoader;if(A.type&&"arraybuffer"!==A.type)throw new Error("THREE.GLTFLoader: "+A.type+" buffer type is not supported.");if(void 0===A.uri&&0===r)return Promise.resolve(this.extensions[dn.KHR_BINARY_GLTF].body);const C=this.options;return new Promise((function(r,I){b.load(te.resolveURL(A.uri,C.path),r,void 0,(function(){I(new Error('THREE.GLTFLoader: Failed to load buffer "'+A.uri+'".'))}))}))}loadBufferView(r){const A=this.json.bufferViews[r];return this.getDependency("buffer",A.buffer).then((function(r){const b=A.byteLength||0,C=A.byteOffset||0;return r.slice(C,C+b)}))}loadAccessor(r){const A=this,b=this.json,C=this.json.accessors[r];if(void 0===C.bufferView&&void 0===C.sparse){const r=Hn[C.type],A=Un[C.componentType],b=!0===C.normalized,I=new A(C.count*r);return Promise.resolve(new $(I,r,b))}const I=[];return void 0!==C.bufferView?I.push(this.getDependency("bufferView",C.bufferView)):I.push(null),void 0!==C.sparse&&(I.push(this.getDependency("bufferView",C.sparse.indices.bufferView)),I.push(this.getDependency("bufferView",C.sparse.values.bufferView))),Promise.all(I).then((function(r){const I=r[0],x=Hn[C.type],S=Un[C.componentType],B=S.BYTES_PER_ELEMENT,D=B*x,R=C.byteOffset||0,F=void 0!==C.bufferView?b.bufferViews[C.bufferView].byteStride:void 0,N=!0===C.normalized;let Q,H;if(F&&F!==D){const r=Math.floor(R/F),b="InterleavedBuffer:"+C.bufferView+":"+C.componentType+":"+r+":"+C.count;let D=A.cache.get(b);D||(Q=new S(I,r*F,C.count*F/B),D=new Ae(Q,F/B),A.cache.add(b,D)),H=new ge(D,x,R%F/B,N)}else Q=null===I?new S(C.count*x):new S(I,R,C.count*x),H=new $(Q,x,N);if(void 0!==C.sparse){const A=Hn.SCALAR,b=Un[C.sparse.indices.componentType],B=C.sparse.indices.byteOffset||0,D=C.sparse.values.byteOffset||0,R=new b(r[1],B,C.sparse.count*A),F=new S(r[2],D,C.sparse.count*x);null!==I&&(H=new $(H.array.slice(),H.itemSize,H.normalized)),H.normalized=!1;for(let r=0,A=R.length;r<A;r++){const A=R[r];if(H.setX(A,F[r*x]),x>=2&&H.setY(A,F[r*x+1]),x>=3&&H.setZ(A,F[r*x+2]),x>=4&&H.setW(A,F[r*x+3]),x>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}H.normalized=N}return H}))}loadTexture(r){const A=this.json,b=this.options,C=A.textures[r].source,I=A.images[C];let x=this.textureLoader;if(I.uri){const r=b.manager.getHandler(I.uri);null!==r&&(x=r)}return this.loadTextureImage(r,C,x)}loadTextureImage(r,A,b){const C=this,I=this.json,x=I.textures[r],S=I.images[A],B=(S.uri||S.bufferView)+":"+x.sampler;if(this.textureCache[B])return this.textureCache[B];const D=this.loadImageSource(A,b).then((function(A){A.flipY=!1,A.name=x.name||S.name||"",""===A.name&&"string"==typeof S.uri&&!1===S.uri.startsWith("data:image/")&&(A.name=S.uri);const b=(I.samplers||{})[x.sampler]||{};return A.magFilter=Nn[b.magFilter]||fe,A.minFilter=Nn[b.minFilter]||me,A.wrapS=Qn[b.wrapS]||_e,A.wrapT=Qn[b.wrapT]||_e,C.associations.set(A,{textures:r}),A})).catch((function(){return null}));return this.textureCache[B]=D,D}loadImageSource(r,A){const b=this.json,C=this.options;if(void 0!==this.sourceCache[r])return this.sourceCache[r].then((r=>r.clone()));const I=b.images[r],x=self.URL||self.webkitURL;let S=I.uri||"",B=!1;if(void 0!==I.bufferView)S=this.getDependency("bufferView",I.bufferView).then((function(r){B=!0;const A=new Blob([r],{type:I.mimeType});return S=x.createObjectURL(A),S}));else if(void 0===I.uri)throw new Error("THREE.GLTFLoader: Image "+r+" is missing URI and bufferView");const D=Promise.resolve(S).then((function(r){return new Promise((function(b,I){let x=b;!0===A.isImageBitmapLoader&&(x=function(r){const A=new be(r);A.needsUpdate=!0,b(A)}),A.load(te.resolveURL(r,C.path),x,void 0,I)}))})).then((function(r){var A;return!0===B&&x.revokeObjectURL(S),assignExtrasToUserData$1(r,I),r.userData.mimeType=I.mimeType||((A=I.uri).search(/\.jpe?g($|\?)/i)>0||0===A.search(/^data\:image\/jpeg/)?"image/jpeg":A.search(/\.webp($|\?)/i)>0||0===A.search(/^data\:image\/webp/)?"image/webp":"image/png"),r})).catch((function(r){throw console.error("THREE.GLTFLoader: Couldn't load texture",S),r}));return this.sourceCache[r]=D,D}assignTexture(r,A,b,C){const I=this;return this.getDependency("texture",b.index).then((function(x){if(!x)return null;if(void 0!==b.texCoord&&b.texCoord>0&&((x=x.clone()).channel=b.texCoord),I.extensions[dn.KHR_TEXTURE_TRANSFORM]){const r=void 0!==b.extensions?b.extensions[dn.KHR_TEXTURE_TRANSFORM]:void 0;if(r){const A=I.associations.get(x);x=I.extensions[dn.KHR_TEXTURE_TRANSFORM].extendTexture(x,r),I.associations.set(x,A)}}return void 0!==C&&(x.colorSpace=C),r[A]=x,x}))}assignFinalMaterial(r){const A=r.geometry;let b=r.material;const C=void 0===A.attributes.tangent,I=void 0!==A.attributes.color,x=void 0===A.attributes.normal;if(r.isPoints){const r="PointsMaterial:"+b.uuid;let A=this.cache.get(r);A||(A=new ye,ve.prototype.copy.call(A,b),A.color.copy(b.color),A.map=b.map,A.sizeAttenuation=!1,this.cache.add(r,A)),b=A}else if(r.isLine){const r="LineBasicMaterial:"+b.uuid;let A=this.cache.get(r);A||(A=new Ce,ve.prototype.copy.call(A,b),A.color.copy(b.color),A.map=b.map,this.cache.add(r,A)),b=A}if(C||I||x){let r="ClonedMaterial:"+b.uuid+":";C&&(r+="derivative-tangents:"),I&&(r+="vertex-colors:"),x&&(r+="flat-shading:");let A=this.cache.get(r);A||(A=b.clone(),I&&(A.vertexColors=!0),x&&(A.flatShading=!0),C&&(A.normalScale&&(A.normalScale.y*=-1),A.clearcoatNormalScale&&(A.clearcoatNormalScale.y*=-1)),this.cache.add(r,A),this.associations.set(A,this.associations.get(b))),b=A}r.material=b}getMaterialType(){return we}loadMaterial(r){const A=this,C=this.json,I=this.extensions,x=C.materials[r];let S;const B={},D=[];if((x.extensions||{})[dn.KHR_MATERIALS_UNLIT]){const r=I[dn.KHR_MATERIALS_UNLIT];S=r.getMaterialType(),D.push(r.extendParams(B,x,A))}else{const b=x.pbrMetallicRoughness||{};if(B.color=new Q(1,1,1),B.opacity=1,Array.isArray(b.baseColorFactor)){const r=b.baseColorFactor;B.color.setRGB(r[0],r[1],r[2],ie),B.opacity=r[3]}void 0!==b.baseColorTexture&&D.push(A.assignTexture(B,"map",b.baseColorTexture,oe)),B.metalness=void 0!==b.metallicFactor?b.metallicFactor:1,B.roughness=void 0!==b.roughnessFactor?b.roughnessFactor:1,void 0!==b.metallicRoughnessTexture&&(D.push(A.assignTexture(B,"metalnessMap",b.metallicRoughnessTexture)),D.push(A.assignTexture(B,"roughnessMap",b.metallicRoughnessTexture))),S=this._invokeOne((function(A){return A.getMaterialType&&A.getMaterialType(r)})),D.push(Promise.all(this._invokeAll((function(A){return A.extendMaterialParams&&A.extendMaterialParams(r,B)}))))}!0===x.doubleSided&&(B.side=G);const R=x.alphaMode||"OPAQUE";if("BLEND"===R?(B.transparent=!0,B.depthWrite=!1):(B.transparent=!1,"MASK"===R&&(B.alphaTest=void 0!==x.alphaCutoff?x.alphaCutoff:.5)),void 0!==x.normalTexture&&S!==H&&(D.push(A.assignTexture(B,"normalMap",x.normalTexture)),B.normalScale=new b(1,1),void 0!==x.normalTexture.scale)){const r=x.normalTexture.scale;B.normalScale.set(r,r)}if(void 0!==x.occlusionTexture&&S!==H&&(D.push(A.assignTexture(B,"aoMap",x.occlusionTexture)),void 0!==x.occlusionTexture.strength&&(B.aoMapIntensity=x.occlusionTexture.strength)),void 0!==x.emissiveFactor&&S!==H){const r=x.emissiveFactor;B.emissive=(new Q).setRGB(r[0],r[1],r[2],ie)}return void 0!==x.emissiveTexture&&S!==H&&D.push(A.assignTexture(B,"emissiveMap",x.emissiveTexture,oe)),Promise.all(D).then((function(){const b=new S(B);return x.name&&(b.name=x.name),assignExtrasToUserData$1(b,x),A.associations.set(b,{materials:r}),x.extensions&&addUnknownExtensionsToUserData$1(I,b,x),b}))}createUniqueName(r){const A=Ee.sanitizeNodeName(r||"");return A in this.nodeNamesUsed?A+"_"+ ++this.nodeNamesUsed[A]:(this.nodeNamesUsed[A]=0,A)}loadGeometries(r){const A=this,b=this.extensions,C=this.primitiveCache;function createDracoPrimitive(r){return b[dn.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(r,A).then((function(b){return addPrimitiveAttributes$1(b,r,A)}))}const I=[];for(let b=0,x=r.length;b<x;b++){const x=r[b],S=createPrimitiveKey$1(x),B=C[S];if(B)I.push(B.promise);else{let r;r=x.extensions&&x.extensions[dn.KHR_DRACO_MESH_COMPRESSION]?createDracoPrimitive(x):addPrimitiveAttributes$1(new Ie,x,A),C[S]={primitive:x,promise:r},I.push(r)}}return Promise.all(I)}loadMesh(r){const A=this,b=this.json,C=this.extensions,I=b.meshes[r],x=I.primitives,S=[];for(let r=0,A=x.length;r<A;r++){const A=void 0===x[r].material?(void 0===(B=this.cache).DefaultMaterial&&(B.DefaultMaterial=new we({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Te})),B.DefaultMaterial):this.getDependency("material",x[r].material);S.push(A)}var B;return S.push(A.loadGeometries(x)),Promise.all(S).then((function(b){const S=b.slice(0,b.length-1),B=b[b.length-1],R=[];for(let b=0,F=B.length;b<F;b++){const F=B[b],N=x[b];let Q;const H=S[b];if(N.mode===On.TRIANGLES||N.mode===On.TRIANGLE_STRIP||N.mode===On.TRIANGLE_FAN||void 0===N.mode)Q=!0===I.isSkinnedMesh?new xe(F,H):new D(F,H),!0===Q.isSkinnedMesh&&Q.normalizeSkinWeights(),N.mode===On.TRIANGLE_STRIP?Q.geometry=toTrianglesDrawMode$1(Q.geometry,Xe):N.mode===On.TRIANGLE_FAN&&(Q.geometry=toTrianglesDrawMode$1(Q.geometry,We));else if(N.mode===On.LINES)Q=new Se(F,H);else if(N.mode===On.LINE_STRIP)Q=new Be(F,H);else if(N.mode===On.LINE_LOOP)Q=new De(F,H);else{if(N.mode!==On.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+N.mode);Q=new Pe(F,H)}Object.keys(Q.geometry.morphAttributes).length>0&&updateMorphTargets$1(Q,I),Q.name=A.createUniqueName(I.name||"mesh_"+r),assignExtrasToUserData$1(Q,I),N.extensions&&addUnknownExtensionsToUserData$1(C,Q,N),A.assignFinalMaterial(Q),R.push(Q)}for(let b=0,C=R.length;b<C;b++)A.associations.set(R[b],{meshes:r,primitives:b});if(1===R.length)return I.extensions&&addUnknownExtensionsToUserData$1(C,R[0],I),R[0];const F=new Me;I.extensions&&addUnknownExtensionsToUserData$1(C,F,I),A.associations.set(F,{meshes:r});for(let r=0,A=R.length;r<A;r++)F.add(R[r]);return F}))}loadCamera(r){let A;const b=this.json.cameras[r],C=b[b.type];if(C)return"perspective"===b.type?A=new ke(Re.radToDeg(C.yfov),C.aspectRatio||1,C.znear||1,C.zfar||2e6):"orthographic"===b.type&&(A=new Fe(-C.xmag,C.xmag,C.ymag,-C.ymag,C.znear,C.zfar)),b.name&&(A.name=this.createUniqueName(b.name)),assignExtrasToUserData$1(A,b),Promise.resolve(A);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(r){const A=this.json.skins[r],b=[];for(let r=0,C=A.joints.length;r<C;r++)b.push(this._loadNodeShallow(A.joints[r]));return void 0!==A.inverseBindMatrices?b.push(this.getDependency("accessor",A.inverseBindMatrices)):b.push(null),Promise.all(b).then((function(r){const b=r.pop(),C=r,I=[],x=[];for(let r=0,B=C.length;r<B;r++){const B=C[r];if(B){I.push(B);const A=new S;null!==b&&A.fromArray(b.array,16*r),x.push(A)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',A.joints[r])}return new Le(I,x)}))}loadAnimation(r){const A=this.json,b=this,C=A.animations[r],I=C.name?C.name:"animation_"+r,x=[],S=[],B=[],D=[],R=[];for(let r=0,A=C.channels.length;r<A;r++){const A=C.channels[r],b=C.samplers[A.sampler],I=A.target,F=I.node,N=void 0!==C.parameters?C.parameters[b.input]:b.input,Q=void 0!==C.parameters?C.parameters[b.output]:b.output;void 0!==I.node&&(x.push(this.getDependency("node",F)),S.push(this.getDependency("accessor",N)),B.push(this.getDependency("accessor",Q)),D.push(b),R.push(I))}return Promise.all([Promise.all(x),Promise.all(S),Promise.all(B),Promise.all(D),Promise.all(R)]).then((function(r){const A=r[0],C=r[1],x=r[2],S=r[3],B=r[4],D=[];for(let r=0,I=A.length;r<I;r++){const I=A[r],R=C[r],F=x[r],N=S[r],Q=B[r];if(void 0===I)continue;I.updateMatrix&&I.updateMatrix();const H=b._createAnimationTracks(I,R,F,N,Q);if(H)for(let r=0;r<H.length;r++)D.push(H[r])}return new Oe(I,void 0,D)}))}createNodeMesh(r){const A=this.json,b=this,C=A.nodes[r];return void 0===C.mesh?null:b.getDependency("mesh",C.mesh).then((function(r){const A=b._getNodeRef(b.meshCache,C.mesh,r);return void 0!==C.weights&&A.traverse((function(r){if(r.isMesh)for(let A=0,b=C.weights.length;A<b;A++)r.morphTargetInfluences[A]=C.weights[A]})),A}))}loadNode(r){const A=this,b=this.json.nodes[r],C=A._loadNodeShallow(r),I=[],x=b.children||[];for(let r=0,b=x.length;r<b;r++)I.push(A.getDependency("node",x[r]));const S=void 0===b.skin?Promise.resolve(null):A.getDependency("skin",b.skin);return Promise.all([C,Promise.all(I),S]).then((function(r){const A=r[0],b=r[1],C=r[2];null!==C&&A.traverse((function(r){r.isSkinnedMesh&&r.bind(C,zn)}));for(let r=0,C=b.length;r<C;r++)A.add(b[r]);return A}))}_loadNodeShallow(r){const A=this.json,b=this.extensions,C=this;if(void 0!==this.nodeCache[r])return this.nodeCache[r];const I=A.nodes[r],x=I.name?C.createUniqueName(I.name):"",B=[],D=C._invokeOne((function(A){return A.createNodeMesh&&A.createNodeMesh(r)}));return D&&B.push(D),void 0!==I.camera&&B.push(C.getDependency("camera",I.camera).then((function(r){return C._getNodeRef(C.cameraCache,I.camera,r)}))),C._invokeAll((function(A){return A.createNodeAttachment&&A.createNodeAttachment(r)})).forEach((function(r){B.push(r)})),this.nodeCache[r]=Promise.all(B).then((function(A){let B;if(B=!0===I.isBone?new Ue:A.length>1?new Me:1===A.length?A[0]:new ce,B!==A[0])for(let r=0,b=A.length;r<b;r++)B.add(A[r]);if(I.name&&(B.userData.name=I.name,B.name=x),assignExtrasToUserData$1(B,I),I.extensions&&addUnknownExtensionsToUserData$1(b,B,I),void 0!==I.matrix){const r=new S;r.fromArray(I.matrix),B.applyMatrix4(r)}else void 0!==I.translation&&B.position.fromArray(I.translation),void 0!==I.rotation&&B.quaternion.fromArray(I.rotation),void 0!==I.scale&&B.scale.fromArray(I.scale);return C.associations.has(B)||C.associations.set(B,{}),C.associations.get(B).nodes=r,B})),this.nodeCache[r]}loadScene(r){const A=this.extensions,b=this.json.scenes[r],C=this,I=new Me;b.name&&(I.name=C.createUniqueName(b.name)),assignExtrasToUserData$1(I,b),b.extensions&&addUnknownExtensionsToUserData$1(A,I,b);const x=b.nodes||[],S=[];for(let r=0,A=x.length;r<A;r++)S.push(C.getDependency("node",x[r]));return Promise.all(S).then((function(r){for(let A=0,b=r.length;A<b;A++)I.add(r[A]);return C.associations=(r=>{const A=new Map;for(const[r,b]of C.associations)(r instanceof ve||r instanceof be)&&A.set(r,b);return r.traverse((r=>{const b=C.associations.get(r);null!=b&&A.set(r,b)})),A})(I),I}))}_createAnimationTracks(r,A,b,C,I){const x=[],S=r.name?r.name:r.uuid,B=[];let D;switch(jn[I.path]===jn.weights?r.traverse((function(r){r.morphTargetInfluences&&B.push(r.name?r.name:r.uuid)})):B.push(S),jn[I.path]){case jn.weights:D=tt;break;case jn.rotation:D=Qe;break;case jn.position:case jn.scale:D=st;break;default:D=1===b.itemSize?tt:st}const R=void 0!==C.interpolation?Vn[C.interpolation]:Ne,F=this._getArrayFromAccessor(b);for(let r=0,b=B.length;r<b;r++){const b=new D(B[r]+"."+jn[I.path],A.array,F,R);"CUBICSPLINE"===C.interpolation&&this._createCubicSplineTrackInterpolant(b),x.push(b)}return x}_getArrayFromAccessor(r){let A=r.array;if(r.normalized){const r=getNormalizedComponentScale$1(A.constructor),b=new Float32Array(A.length);for(let C=0,I=A.length;C<I;C++)b[C]=A[C]*r;A=b}return A}_createCubicSplineTrackInterpolant(r){r.createInterpolant=function(r){return new(this instanceof Qe?Ln:Rn)(this.times,this.values,this.getValueSize()/3,r)},r.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}};function addPrimitiveAttributes$1(r,b,C){const I=b.attributes,S=[];function assignAttributeAccessor(A,b){return C.getDependency("accessor",A).then((function(A){r.setAttribute(b,A)}))}for(const A in I){const b=Gn[A]||A.toLowerCase();b in r.attributes||S.push(assignAttributeAccessor(I[A],b))}if(void 0!==b.indices&&!r.index){const A=C.getDependency("accessor",b.indices).then((function(A){r.setIndex(A)}));S.push(A)}return He.workingColorSpace!==ie&&"COLOR_0"in I&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${He.workingColorSpace}" not supported.`),assignExtrasToUserData$1(r,b),function(r,b,C){const I=b.attributes,S=new x;if(void 0===I.POSITION)return;{const r=C.json.accessors[I.POSITION],b=r.min,x=r.max;if(void 0===b||void 0===x)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(S.set(new A(b[0],b[1],b[2]),new A(x[0],x[1],x[2])),r.normalized){const A=getNormalizedComponentScale$1(Un[r.componentType]);S.min.multiplyScalar(A),S.max.multiplyScalar(A)}}const B=b.targets;if(void 0!==B){const r=new A,b=new A;for(let A=0,I=B.length;A<I;A++){const I=B[A];if(void 0!==I.POSITION){const A=C.json.accessors[I.POSITION],x=A.min,S=A.max;if(void 0!==x&&void 0!==S){if(b.setX(Math.max(Math.abs(x[0]),Math.abs(S[0]))),b.setY(Math.max(Math.abs(x[1]),Math.abs(S[1]))),b.setZ(Math.max(Math.abs(x[2]),Math.abs(S[2]))),A.normalized){const r=getNormalizedComponentScale$1(Un[A.componentType]);b.multiplyScalar(r)}r.max(b)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}S.expandByVector(r)}r.boundingBox=S;const D=new V;S.getCenter(D.center),D.radius=S.min.distanceTo(S.max)/2,r.boundingSphere=D}(r,b,C),Promise.all(S).then((function(){return void 0!==b.targets?function(r,A,b){let C=!1,I=!1,x=!1;for(let r=0,b=A.length;r<b;r++){const b=A[r];if(void 0!==b.POSITION&&(C=!0),void 0!==b.NORMAL&&(I=!0),void 0!==b.COLOR_0&&(x=!0),C&&I&&x)break}if(!C&&!I&&!x)return Promise.resolve(r);const S=[],B=[],D=[];for(let R=0,F=A.length;R<F;R++){const F=A[R];if(C){const A=void 0!==F.POSITION?b.getDependency("accessor",F.POSITION):r.attributes.position;S.push(A)}if(I){const A=void 0!==F.NORMAL?b.getDependency("accessor",F.NORMAL):r.attributes.normal;B.push(A)}if(x){const A=void 0!==F.COLOR_0?b.getDependency("accessor",F.COLOR_0):r.attributes.color;D.push(A)}}return Promise.all([Promise.all(S),Promise.all(B),Promise.all(D)]).then((function(A){const b=A[0],S=A[1],B=A[2];return C&&(r.morphAttributes.position=b),I&&(r.morphAttributes.normal=S),x&&(r.morphAttributes.color=B),r.morphTargetsRelative=!0,r}))}(r,b.targets,C):r}))}const Xn={Handedness:Object.freeze({NONE:"none",LEFT:"left",RIGHT:"right"}),ComponentState:Object.freeze({DEFAULT:"default",TOUCHED:"touched",PRESSED:"pressed"}),ComponentProperty:Object.freeze({BUTTON:"button",X_AXIS:"xAxis",Y_AXIS:"yAxis",STATE:"state"}),ComponentType:Object.freeze({TRIGGER:"trigger",SQUEEZE:"squeeze",TOUCHPAD:"touchpad",THUMBSTICK:"thumbstick",BUTTON:"button"}),ButtonTouchThreshold:.05,AxisTouchThreshold:.1,VisualResponseProperty:Object.freeze({TRANSFORM:"transform",VISIBILITY:"visibility"})};async function fetchJsonFile(r){const A=await fetch(r);if(A.ok)return A.json();throw new Error(A.statusText)}const Yn={xAxis:0,yAxis:0,button:0,state:Xn.ComponentState.DEFAULT};class VisualResponse{constructor(r){this.componentProperty=r.componentProperty,this.states=r.states,this.valueNodeName=r.valueNodeName,this.valueNodeProperty=r.valueNodeProperty,this.valueNodeProperty===Xn.VisualResponseProperty.TRANSFORM&&(this.minNodeName=r.minNodeName,this.maxNodeName=r.maxNodeName),this.value=0,this.updateFromComponent(Yn)}updateFromComponent({xAxis:r,yAxis:A,button:b,state:C}){const{normalizedXAxis:I,normalizedYAxis:x}=function(r=0,A=0){let b=r,C=A;if(Math.sqrt(r*r+A*A)>1){const I=Math.atan2(A,r);b=Math.cos(I),C=Math.sin(I)}return{normalizedXAxis:.5*b+.5,normalizedYAxis:.5*C+.5}}(r,A);switch(this.componentProperty){case Xn.ComponentProperty.X_AXIS:this.value=this.states.includes(C)?I:.5;break;case Xn.ComponentProperty.Y_AXIS:this.value=this.states.includes(C)?x:.5;break;case Xn.ComponentProperty.BUTTON:this.value=this.states.includes(C)?b:0;break;case Xn.ComponentProperty.STATE:this.valueNodeProperty===Xn.VisualResponseProperty.VISIBILITY?this.value=this.states.includes(C):this.value=this.states.includes(C)?1:0;break;default:throw new Error(`Unexpected visualResponse componentProperty ${this.componentProperty}`)}}}let Kn=class Component{constructor(r,A){if(!(r&&A&&A.visualResponses&&A.gamepadIndices&&0!==Object.keys(A.gamepadIndices).length))throw new Error("Invalid arguments supplied");this.id=r,this.type=A.type,this.rootNodeName=A.rootNodeName,this.touchPointNodeName=A.touchPointNodeName,this.visualResponses={},Object.keys(A.visualResponses).forEach((r=>{const b=new VisualResponse(A.visualResponses[r]);this.visualResponses[r]=b})),this.gamepadIndices=Object.assign({},A.gamepadIndices),this.values={state:Xn.ComponentState.DEFAULT,button:void 0!==this.gamepadIndices.button?0:void 0,xAxis:void 0!==this.gamepadIndices.xAxis?0:void 0,yAxis:void 0!==this.gamepadIndices.yAxis?0:void 0}}get data(){return{id:this.id,...this.values}}updateFromGamepad(r){if(this.values.state=Xn.ComponentState.DEFAULT,void 0!==this.gamepadIndices.button&&r.buttons.length>this.gamepadIndices.button){const A=r.buttons[this.gamepadIndices.button];this.values.button=A.value,this.values.button=this.values.button<0?0:this.values.button,this.values.button=this.values.button>1?1:this.values.button,A.pressed||1===this.values.button?this.values.state=Xn.ComponentState.PRESSED:(A.touched||this.values.button>Xn.ButtonTouchThreshold)&&(this.values.state=Xn.ComponentState.TOUCHED)}void 0!==this.gamepadIndices.xAxis&&r.axes.length>this.gamepadIndices.xAxis&&(this.values.xAxis=r.axes[this.gamepadIndices.xAxis],this.values.xAxis=this.values.xAxis<-1?-1:this.values.xAxis,this.values.xAxis=this.values.xAxis>1?1:this.values.xAxis,this.values.state===Xn.ComponentState.DEFAULT&&Math.abs(this.values.xAxis)>Xn.AxisTouchThreshold&&(this.values.state=Xn.ComponentState.TOUCHED)),void 0!==this.gamepadIndices.yAxis&&r.axes.length>this.gamepadIndices.yAxis&&(this.values.yAxis=r.axes[this.gamepadIndices.yAxis],this.values.yAxis=this.values.yAxis<-1?-1:this.values.yAxis,this.values.yAxis=this.values.yAxis>1?1:this.values.yAxis,this.values.state===Xn.ComponentState.DEFAULT&&Math.abs(this.values.yAxis)>Xn.AxisTouchThreshold&&(this.values.state=Xn.ComponentState.TOUCHED)),Object.values(this.visualResponses).forEach((r=>{r.updateFromComponent(this.values)}))}};class MotionController{constructor(r,A,b){if(!r)throw new Error("No xrInputSource supplied");if(!A)throw new Error("No profile supplied");this.xrInputSource=r,this.assetUrl=b,this.id=A.profileId,this.layoutDescription=A.layouts[r.handedness],this.components={},Object.keys(this.layoutDescription.components).forEach((r=>{const A=this.layoutDescription.components[r];this.components[r]=new Kn(r,A)})),this.updateFromGamepad()}get gripSpace(){return this.xrInputSource.gripSpace}get targetRaySpace(){return this.xrInputSource.targetRaySpace}get data(){const r=[];return Object.values(this.components).forEach((A=>{r.push(A.data)})),r}updateFromGamepad(){Object.values(this.components).forEach((r=>{r.updateFromGamepad(this.xrInputSource.gamepad)}))}}class XRControllerModel extends ce{constructor(){super(),this.motionController=null,this.envMap=null}setEnvironmentMap(r){return this.envMap==r||(this.envMap=r,this.traverse((r=>{r.isMesh&&(r.material.envMap=this.envMap,r.material.needsUpdate=!0)}))),this}updateMatrixWorld(r){if(super.updateMatrixWorld(r),!this.motionController)return;let A=this.motionController.xrInputSource?.gamepad;A&&this.motionController.updateFromGamepad(),Object.values(this.motionController.components).forEach((r=>{Object.values(r.visualResponses).forEach((r=>{const{valueNode:A,minNode:b,maxNode:C,value:I,valueNodeProperty:x}=r;A&&(x===Xn.VisualResponseProperty.VISIBILITY?A.visible=I:x===Xn.VisualResponseProperty.TRANSFORM&&(A.quaternion.slerpQuaternions(b.quaternion,C.quaternion,I),A.position.lerpVectors(b.position,C.position,I)))}))}))}}function addAssetSceneToControllerModel(r,A){!function(r,A){Object.values(r.components).forEach((r=>{const{type:b,touchPointNodeName:C,visualResponses:I}=r;if(b===Xn.ComponentType.TOUCHPAD)if(r.touchPointNode=A.getObjectByName(C),r.touchPointNode){const A=new Ge(.001),b=new H({color:255}),C=new D(A,b);r.touchPointNode.add(C)}else console.warn("Could not find touch dot, "+r.touchPointNodeName+", in touchpad component "+r.id);Object.values(I).forEach((r=>{const{valueNodeName:b,minNodeName:C,maxNodeName:I,valueNodeProperty:x}=r;if(x===Xn.VisualResponseProperty.TRANSFORM){if(r.minNode=A.getObjectByName(C),r.maxNode=A.getObjectByName(I),!r.minNode)return void console.warn(`Could not find ${C} in the model`);if(!r.maxNode)return void console.warn(`Could not find ${I} in the model`)}r.valueNode=A.getObjectByName(b),r.valueNode||console.warn(`Could not find ${b} in the model`)}))}))}(r.motionController,A),r.envMap&&A.traverse((A=>{A.isMesh&&(A.material.envMap=r.envMap,A.material.needsUpdate=!0)})),r.add(A)}const qn="https://cdn.jsdelivr.net/npm/@webxr-input-profiles/assets@1.0/dist/profiles/generic-hand/";class XRHandMeshModel{constructor(r,b,C,I,x=null){this.xrInputSource=b,this.handModel=r,this.bones=[],this._fingertips=[],this._phalanxProximals=[],this._palmTriangleVectors=[new A,new A,new A],this._palmTriangleBones=[],this._palmTriangle=new j,this.isPinching=!1,this.isGrabbing=!1,this.palmDirection=new A,null===x&&(x=new hn).setPath(C||qn),x.load(`${I}.glb`,(A=>{const b=A.scene.children[0];this.handModel.add(b),this.assetUrl=qn+`${I}.glb`;const C=b.getObjectByProperty("type","SkinnedMesh");C.frustumCulled=!1,C.castShadow=!0,C.receiveShadow=!0,["wrist","thumb-metacarpal","thumb-phalanx-proximal","thumb-phalanx-distal","thumb-tip","index-finger-metacarpal","index-finger-phalanx-proximal","index-finger-phalanx-intermediate","index-finger-phalanx-distal","index-finger-tip","middle-finger-metacarpal","middle-finger-phalanx-proximal","middle-finger-phalanx-intermediate","middle-finger-phalanx-distal","middle-finger-tip","ring-finger-metacarpal","ring-finger-phalanx-proximal","ring-finger-phalanx-intermediate","ring-finger-phalanx-distal","ring-finger-tip","pinky-finger-metacarpal","pinky-finger-phalanx-proximal","pinky-finger-phalanx-intermediate","pinky-finger-phalanx-distal","pinky-finger-tip"].forEach((r=>{const A=b.getObjectByName(r);void 0!==A?A.jointName=r:console.warn(`Couldn't find ${r} in ${I} hand mesh`),this.bones.push(A)}));for(let r of[4,9,14,19,24])this._fingertips.push(this.bones[r]);for(let r of[2,6,11,16,21])this._phalanxProximals.push(this.bones[r]);this._palmTriangleBones.push(this.bones[5]),this._palmTriangleBones.push(this.bones[6]),this._palmTriangleBones.push(this.bones[10]),"left"==I&&this._palmTriangleBones.reverse(),setupBVHForComplexObject(r)}))}_updateGestures(){let r=this.bones[0];if(!r)return;let A=!0,b=r.position;for(let r=2;r<5;r++){let C=this._fingertips[r].position,I=this._phalanxProximals[r].position;if(C.distanceTo(b)>I.distanceTo(b)){A=!1;break}}this.isGrabbing=A;let C=this.bones[4],I=this.bones[9],x=C.position.distanceTo(I.position);this.isPinching?x>.025&&(this.isPinching=!1):x<.015&&(this.isPinching=!0);for(let r=0;r<3;r++)this._palmTriangleBones[r].getWorldPosition(this._palmTriangleVectors[r]);this._palmTriangle.setFromPointsAndIndices(this._palmTriangleVectors,0,1,2),this._palmTriangle.getNormal(this.palmDirection)}updateMesh(r,A,b){if(!b)return;b=b.clone().invert();let C=0;for(let I of this.xrInputSource.hand.values()){let x=this.bones[C],S=r.getJointPose(I,A);x&&S&&(x.matrix.fromArray(S.transform.matrix).premultiply(b),x.matrix.decompose(x.position,x.rotation,x.scale)),C++}this._updateGestures()}}class XRHandModel extends ce{constructor(r){super(),this.controller=r,this.motionController=null,this.envMap=null,this.mesh=null}}const Zn=new class{constructor(r=null){this.gltfLoader=r,this.path="https://cdn.jsdelivr.net/npm/@webxr-input-profiles/assets@1.0/dist/profiles",this._assetCache={},this.gltfLoader||(this.gltfLoader=new hn)}createControllerModel(r){const A=new XRControllerModel;let b=null;if("tracked-pointer"===r.targetRayMode&&r.gamepad)return async function fetchProfile(r,A,b=null,C=!0){if(!r)throw new Error("No xrInputSource supplied");if(!A)throw new Error("No basePath supplied");const I=await async function(r){if(!r)throw new Error("No basePath supplied");return await fetchJsonFile(`${r}/profilesList.json`)}(A);let x;if(r.profiles.some((r=>{const b=I[r];return b&&(x={profileId:r,profilePath:`${A}/${b.path}`,deprecated:!!b.deprecated}),!!x})),!x){if(!b)throw new Error("No matching profile name found");const r=I[b];if(!r)throw new Error(`No matching profile name found and default profile "${b}" missing.`);x={profileId:b,profilePath:`${A}/${r.path}`,deprecated:!!r.deprecated}}const S=await fetchJsonFile(x.profilePath);let B;if(C){let A;if(A="any"===r.handedness?S.layouts[Object.keys(S.layouts)[0]]:S.layouts[r.handedness],!A)throw new Error(`No matching handedness, ${r.handedness}, in profile ${x.profileId}`);A.assetPath&&(B=x.profilePath.replace("profile.json",A.assetPath))}return{profile:S,assetPath:B}}(r,this.path,"generic-trigger").then((({profile:C,assetPath:I})=>{A.motionController=new MotionController(r,C,I);const x=this._assetCache[A.motionController.assetUrl];if(x)b=x.scene.clone(),addAssetSceneToControllerModel(A,b);else{if(!this.gltfLoader)throw new Error("GLTFLoader not set.");this.gltfLoader.setPath(""),this.gltfLoader.load(A.motionController.assetUrl,(r=>{this._assetCache[A.motionController.assetUrl]=r,b=r.scene.clone(),addAssetSceneToControllerModel(A,b),setupBVHForComplexObject(A)}),null,(r=>{throw console.error(r),new Error("Asset "+A.motionController.assetUrl+" missing or malformed.")}))}})).catch((r=>{console.warn(r)})),A}},Jn=new class{constructor(){this.path=null}setPath(r){return this.path=r,this}createHandModel(r){let A=r;const b=new XRHandModel;return A.hand&&!b.motionController&&(b.xrInputSource=A,b.motionController=new XRHandMeshModel(b,A,this.path,A.handedness)),b}};let $n=new class{init(r,A){this._container=r,this._renderer=A,this._renderer.domElement.tabIndex="1",this._xrInputDevices={};for(let r in ln)this._xrInputDevices[r]={};this._pointerPosition=new b,this._pointerPressed=!1,this._keysPressed=new Set,this._keyCodesPressed=new Set,this._screenTouched=!1,this._joystickAngle=0,this._joystickDistance=0,this._container.style.position="relative",this._createExtraControls(),this._addEventListeners()}_addEventListeners(){if("XR"==an.active)this._renderer.xr.addEventListener("sessionstart",(()=>{this._onXRSessionStart()})),this._renderer.xr.addEventListener("sessionend",(()=>{this._onXRSessionEnd()}));else if("POINTER"==an.active)this._container.addEventListener("keydown",(r=>{this._keysPressed.add(r.key),this._keyCodesPressed.add(r.code)})),this._container.addEventListener("keyup",(r=>{this._keysPressed.delete(r.key),this._keyCodesPressed.delete(r.code)})),window.addEventListener("blur",(()=>{this._keysPressed.clear(),this._keyCodesPressed.clear()})),this._renderer.domElement.addEventListener("mousedown",(()=>{this._pointerPressed=!0})),this._renderer.domElement.addEventListener("mouseup",(()=>{this._pointerPressed=!1})),this._renderer.domElement.addEventListener("mousemove",(r=>{let A=r.target.getBoundingClientRect();this._pointerPosition.x=(r.clientX-A.left)/this._renderer.domElement.clientWidth*2-1,this._pointerPosition.y=-(r.clientY-A.top)/this._renderer.domElement.clientHeight*2+1})),this._container.addEventListener("mouseup",(()=>{this._renderer.domElement.focus()}));else if("TOUCH_SCREEN"==an.active){this._renderer.domElement.addEventListener("touchstart",(()=>{this._screenTouched=!0;let r=event.target.getBoundingClientRect();this._pointerPosition.x=(event.touches[0].clientX-r.left)/this._renderer.domElement.clientWidth*2-1,this._pointerPosition.y=-(event.touches[0].clientY-r.top)/this._renderer.domElement.clientHeight*2+1})),this._renderer.domElement.addEventListener("touchend",(()=>{this._screenTouched=!1})),this._renderer.domElement.addEventListener("touchmove",(r=>{let A=r.target.getBoundingClientRect();this._pointerPosition.x=(r.touches[0].clientX-A.left)/this._renderer.domElement.clientWidth*2-1,this._pointerPosition.y=-(r.touches[0].clientY-A.top)/this._renderer.domElement.clientHeight*2+1}));let r=0;document.addEventListener("touchend",(function(A){let b=(new Date).getTime();b-r<=300&&A.preventDefault(),r=b}),!1)}}_onXRSessionStart(){this._session=this._renderer.xr.getSession(),this._session.oninputsourceschange=r=>{this._onXRInputSourceChange(r)};let r=this._session.inputSources;for(let A=0;A<r.length;A++)this._addXRInputSource(r[A])}_onXRSessionEnd(){this._session.oninputsourcechange=null,this._session=null;for(let r in this._xrInputDevices)for(let A in this._xrInputDevices[r])delete this._xrInputDevices[r][A].inputSource}_onXRInputSourceChange(r){for(let A=0;A<r.removed.length;A++)this._deleteXRInputSource(r.removed[A]);for(let A=0;A<r.added.length;A++)this._addXRInputSource(r.added[A])}_addXRInputSource(r){if("tracked-pointer"!=r.targetRayMode)return;let A=null!=r.hand?ln.HAND:ln.CONTROLLER,b=r.handedness.toUpperCase();if(b in on){let C=this._xrInputDevices[A][b];if(C||(C={controllers:{}},this._xrInputDevices[A][b]=C,r.targetRaySpace&&(C.controllers.targetRay=new ce,C.controllers.targetRay.xrInputDeviceType=A,C.controllers.targetRay.handedness=b),r.gripSpace&&(C.controllers.grip=new ce,C.controllers.grip.xrInputDeviceType=A,C.controllers.grip.handedness=b)),C.inputSource=r,C.model){let A=C.model.motionController;A&&(A.xrInputSource=r)}else A==ln.HAND?C.model=Jn.createHandModel(r):A==ln.CONTROLLER&&(C.model=Zn.createControllerModel(r,"mesh"));if(this._xrControllerParent){this._xrControllerParent.add(C.controllers.targetRay);let A=C.controllers;r.gripSpace?(this._xrControllerParent.add(A.grip),A.grip.add(C.model),A.grip.model=C.model):(A.targetRay.add(C.model),A.targetRay.model=C.model)}}}_deleteXRInputSource(r){if("tracked-pointer"!=r.targetRayMode)return;let A=null!=r.hand?ln.HAND:ln.CONTROLLER,b=r.handedness.toUpperCase(),C=this._getXRInputDevice(A,b);C?.inputSource&&delete this._xrInputDevices[A][b].inputSource,C?.controllers&&this._xrControllerParent&&(this._xrControllerParent.remove(C.controllers.targetRay),this._xrControllerParent.remove(C.controllers.grip))}_getXRInputDevice(r,A){return this._xrInputDevices[r]?this._xrInputDevices[r][A]:null}getXRInputSource(r,A){let b=this._getXRInputDevice(r,A);return b?b.inputSource:null}getXRGamepad(r){let A=ln.CONTROLLER,b=this.getXRInputSource(A,r);return b?b.gamepad:null}getXRController(r,A,b){let C=this._getXRInputDevice(r,A);return C?C.controllers[b]:null}getXRControllerModel(r,A){let b=this._getXRInputDevice(r,A);return b?b.model:null}setXRControllerModel(r,A,b){let C=this._getXRInputDevice(r,A);return!!C&&(C.model&&(C.controllers.grip?C.controllers.grip.remove(C.model):C.controllers.targetRay.remove(C.model)),C.model=b,C.controllers.grip?C.controllers.grip.add(b):C.controllers.targetRay.add(b),!0)}enableXRControllerManagement(r){this._xrControllerParent=r}disableXRControllerManagement(){this._xrControllerParent=null}getPointerPosition(){return this._pointerPosition}isPointerPressed(){return this._pointerPressed}isKeyPressed(r){return this._keysPressed.has(r)}isKeyCodePressed(r){return this._keyCodesPressed.has(r)}isScreenTouched(){return this._screenTouched}getJoystickAngle(){return this._joystickAngle}getJoystickDistance(){return this._joystickDistance}_createExtraControls(){this._extraControls={},this._extraControlsDiv=document.createElement("div"),this._extraControlsDiv.style.position="absolute",this._extraControlsDiv.style.bottom="10px",this._extraControlsDiv.style.right="10px",this._container.appendChild(this._extraControlsDiv)}createJoystick(){console.warn("InputHandler.createJoystick() is deprecated, please use InputHandler.showJoystick() instead"),this._createJoystick()}_createJoystick(){if(this._joystickParent)return void this.showJoystick();this._joystickParent=document.createElement("div"),this._joystickParent.style.position="absolute",this._joystickParent.style.width="100px",this._joystickParent.style.height="100px",this._joystickParent.style.left="10px",this._joystickParent.style.bottom="10px",this._container.appendChild(this._joystickParent);let r={zone:this._joystickParent,mode:"static",position:{left:"50%",top:"50%"}},A=nipplejs.create(r).get(0);A.on("move",((r,A)=>{this._joystickAngle=A.angle.radian,this._joystickDistance=Math.min(A.force,1)})),A.on("end",(()=>{this._joystickDistance=0}))}showJoystick(){this._joystickParent?this._container.contains(this._joystickParent)||this._container.appendChild(this._joystickParent):this._createJoystick(),window.dispatchEvent(new Event("resize"))}hideJoystick(){this._joystickParent&&this._container.contains(this._joystickParent)&&this._container.removeChild(this._joystickParent)}addExtraControlsButton(r,A){let b=document.createElement("button");return b.id=r,b.innerText=A,b.style.borderWidth="1px",b.style.borderStyle="solid",b.style.borderColor="#fff",b.style.borderRadius="4px",b.style.background="rgba(0,0,0,0.5)",b.style.padding="12px",b.style.color="#fff",b.style.font="normal 13px sans-serif",b.style.marginLeft="5px",b.style.opacity="0.75",b.style.width="70px",this._extraControlsDiv.appendChild(b),this._extraControls[r]=b,b}getExtraControlsButton(r){return this._extraControls[r]}hideExtraControls(){this._extraControlsDiv.style.display="none"}hideExtraControlsButton(r){let A=this._extraControls[r];A&&(A.style.display="none")}showExtraControls(){this._extraControlsDiv.style.display="block"}showExtraControlsButton(r){let A=this._extraControls[r];A&&(A.style.display="inline-block")}_updateXRController(r,A,b){let C=b.inputSource,I=b.controllers;if(C){let x=r.getPose(C.targetRaySpace,A);if(null!=x&&(I.targetRay.matrix.fromArray(x.transform.matrix),I.targetRay.matrix.decompose(I.targetRay.position,I.targetRay.rotation,I.targetRay.scale)),C.gripSpace){let b=r.getPose(C.gripSpace,A);null!=b&&(I.grip.matrix.fromArray(b.transform.matrix),I.grip.matrix.decompose(I.grip.position,I.grip.rotation,I.grip.scale))}if(C.hand&&b.model){let C=I.grip?I.grip.matrix:I.targetRay.matrix,x=b.model.motionController;x&&(x.updateMesh(r,A,C),b.model.children.length&&updateBVHForComplexObject(b.model))}}}update(r){if(null==r)return;let A=this._renderer.xr.getReferenceSpace();for(let b in this._xrInputDevices)for(let C in this._xrInputDevices[b])this._updateXRController(r,A,this._xrInputDevices[b][C])}};class InteractableHandler{constructor(){this._interactables=new Set,this._hoveredInteractables=new Map,this._selectedInteractables=new Map,this._capturedInteractables=new Map,this._overInteractables=new Map,this._owners=new Map,this._owners.set("POINTER",{id:"POINTER"}),this._owners.set("TOUCH_SCREEN",{id:"TOUCH_SCREEN"}),this._wasPressed=new Map,this._listeners={},this._tool=null,this._toolHandlers={}}_setupXRSubscription(){sn.addUpdateListener((r=>{for(let[r,A]of this._hoveredInteractables)A&&A.removeHoveredBy(r),this._hoveredInteractables.delete(r);for(let[A,b]of this._selectedInteractables){if(!b)continue;let C=0;r&&(C+=b.getCallbacksLength(r)),this._tool&&(C+=b.getCallbacksLength(this._tool)),C&&(b.removeSelectedBy(A),this._selectedInteractables.delete(A))}this._tool=r}))}_getOwner(r){return this._owners.has(r)||this._owners.set(r,{id:r.uuid,object:r}),this._owners.get(r)}init(){"XR"==an.active?(this.update=this._updateForXR,this._setupXRSubscription()):"POINTER"==an.active?this.update=this._updateForPointer:"TOUCH_SCREEN"==an.active&&(this.update=this._updateForTouchScreen)}addEventListener(r,A){r in this._listeners||(this._listeners[r]=new Set),this._listeners[r].add(A)}removeEventListener(r,A){r in this._listeners&&(this._listeners[r].delete(A),0==this._listeners[r].size&&delete this._listeners[r])}_trigger(r,A,b){if(this._listeners[r]){let C={...A};if(b&&(C.target=b.object,b[r](A)),!this._listeners[r])return;let I=[];this._listeners[r].forEach((r=>I.push(r)));for(let r of I)r(C)}else b&&b[r](A)}registerToolHandler(r,A){this._toolHandlers[r]=A}addInteractable(r){this._interactables.add(r)}addInteractables(r){r.forEach((r=>{this._interactables.add(r)}))}removeInteractable(r){this._interactables.delete(r),r.reset()}removeInteractables(r){r.forEach((r=>{this._interactables.delete(r),r.reset()}))}reset(){this._interactables.forEach((r=>{r.reset()})),this._interactables=new Set,this._hoveredInteractables=new Map,this._selectedInteractables=new Map}update(){}_updateForXR(){}_updateForPointer(){}_updateForTouchScreen(){}}const er=new r.Vector3;let tr=new class extends InteractableHandler{constructor(){super(),this._cursors={},this._ignoredInteractables=new Set}init(r,A,b,C){super.init(),this._renderer=r,this._scene=A,this._camera=b,this._cameraFocus=C||b}_getXRCursor(A){if(this._cursors[A])return this._cursors[A];let b=document.createElement("canvas");b.width=64,b.height=64;let C=b.getContext("2d");C.beginPath(),C.arc(32,32,29,0,2*Math.PI),C.lineWidth=5,C.stroke(),C.fillStyle="white",C.fill();let I=new r.SpriteMaterial({map:new r.CanvasTexture(b),depthTest:!1,sizeAttenuation:!1});for(let A in on){let b=new r.Sprite(I);b.scale.set(.015,.015,.015),b.visible=!1,b.renderOrder=1/0,this._cursors[A]=b,this._scene.add(b)}return this._cursors[A]}_getRaycaster(A){A.raycaster||(A.raycaster=new r.Raycaster);let b=$n.getPointerPosition();return A.raycaster.setFromCamera(b,this._camera),A.raycaster}_getXRRaycaster(A){return A.raycaster||(A.raycaster=new r.Raycaster),A.getWorldPosition(A.raycaster.ray.origin),A.getWorldDirection(A.raycaster.ray.direction).negate().normalize(),A.raycaster}_isXRControllerPressed(r,A){if(r==ln.HAND){let b=$n.getXRControllerModel(r,A);return 1==b?.motionController?.isPinching}{let r=$n.getXRGamepad(A);return null!=r?.buttons&&r.buttons[0].pressed}}_squashInteractables(r,A,b){for(let C of A){let A=C.object;A&&!C.isOnlyGroup()&&b.push(A),0!=C.children.size&&this._squashInteractables(r,C.children,b)}}_getObjectInteractable(r){for(;null!=r;){let A=r.pointerInteractable;if(A&&!A.isOnlyGroup())return A;r=r.parent}}_raycastInteractables(r,A){this._ignoredInteractables.clear();let b=r.raycaster;if(!b||b.disabled)return;b.firstHitOnly=!0,b.params.Line.threshold=.01;let C=[];this._squashInteractables(r.owner,A,C);let I=b.intersectObjects(C);for(let A of I){let b=this._getObjectInteractable(A.object);if(!b||this._ignoredInteractables.has(b))continue;if(this._checkClipped(A.object,A.point)){this._ignoredInteractables.add(b);continue}let C=A.distance,I=C;if("XR"!=an.active&&(this._cameraFocus.getWorldPosition(er),I=A.point.distanceTo(er)),b.isWithinReach(I))return r.closestPointDistance=C,r.closestPoint=A.point,r.closestInteractable=b,void(r.userDistance=I)}}_checkClipped(r,A){let b=r?.material?.clippingPlanes;if(b&&b.length>0)for(let r of b)if(r.distanceToPoint(A)<0)return!0;return!1}_updateInteractables(r){let A=r.owner,b=r.isPressed,C=this._hoveredInteractables.get(A),I=this._selectedInteractables.get(A),x=this._overInteractables.get(A),S=r.closestInteractable,B=r.closestPoint,D=r.userDistance;S!=C&&(C&&(C.removeHoveredBy(A),this._hoveredInteractables.delete(A)),!S||(I||b)&&S!=I||(S.addHoveredBy(A),this._hoveredInteractables.set(A,S),C=S));let R={owner:A},F={owner:A,point:B,userDistance:D};I?(b||(I.removeSelectedBy(A),this._selectedInteractables.delete(A)),I==S?(x!=S&&(x&&x.out(R),S.over(F),this._overInteractables.set(A,S)),S.move(F),S.drag(F),b||(this._trigger("up",F,S),S.click(F))):I.isCapturedBy(A)?(I!=x&&(x&&x.out(R),I.over(R),this._overInteractables.set(A,I),x=I),I.move(R),I.drag(R),b||(this._trigger("up",R,I),I.click(R),x&&x.out(R),S?(S.over(F),this._overInteractables.set(A,S)):this._overInteractables.delete(A))):S?(x!=S&&(x&&x.out(R),S.over(F),this._overInteractables.set(A,S)),S.move(F),b||this._trigger("up",F,S)):x&&(x.out(R),this._overInteractables.delete(A))):S?(x!=S&&(x&&x.out(R),S.over(F),this._overInteractables.set(A,S)),S.move(F),b&&!this._wasPressed.get(A)?(this._trigger("down",F,S),S.addSelectedBy(A),this._selectedInteractables.set(A,S)):!b&&this._wasPressed.get(A)&&this._trigger("up",F,S)):(x&&(x.out(R),this._overInteractables.delete(A)),b?this._wasPressed.get(A)||this._trigger("down",R):this._wasPressed.get(A)&&this._trigger("up",R)),this._wasPressed.set(A,b)}_updateCursor(r){let A=r.cursor;A&&(null!=r.closestPoint?(A.position.copy(r.closestPoint),A.visible||(A.visible=!0)):A.visible&&(A.visible=!1))}_updateForXR(){for(let r in on){let A=!1;for(let b of[ln.HAND,ln.CONTROLLER]){let C=$n.getXRController(b,r,"grip");if(C||(C=$n.getXRController(b,r,"targetRay")),!C)continue;let I,x,S=this._getOwner(C),B=isDescendant(this._scene,C);if(B&&(b==ln.CONTROLLER?A=!0:A&&(B=!1)),B){let A=$n.getXRController(b,r,"targetRay");I=this._getXRRaycaster(A),S.raycaster||(S.raycaster=I),x=this._isXRControllerPressed(b,r)}let D={owner:S,raycaster:I,isPressed:x,closestPoint:null,closestPointDistance:Number.MAX_SAFE_INTEGER,cursor:B?this._getXRCursor(r):null,userDistance:Number.MAX_SAFE_INTEGER},R=!1;this._toolHandlers[this._tool]&&(R=this._toolHandlers[this._tool](D)),R||(this._raycastInteractables(D,this._interactables),this._updateInteractables(D)),this._updateCursor(D)}}}_updateForPointer(){let r=this._getOwner(an.POINTER),A={owner:r,raycaster:this._getRaycaster(r),isPressed:$n.isPointerPressed(),closestPoint:null,closestPointDistance:Number.MAX_SAFE_INTEGER,userDistance:Number.MAX_SAFE_INTEGER},b=!1;this._toolHandlers[this._tool]&&(b=this._toolHandlers[this._tool](A)),b||(this._raycastInteractables(A,this._interactables),this._updateInteractables(A));let C=this._renderer.domElement.style,I=this._hoveredInteractables.get(r);I&&!this._selectedInteractables.get(r)?C.cursor=I.hoveredCursor:""!=C.cursor&&(C.cursor="")}_updateForTouchScreen(){let r=this._getOwner(an.TOUCH_SCREEN),A={owner:r,raycaster:this._getRaycaster(r),isPressed:$n.isScreenTouched(),closestPoint:null,closestPointDistance:Number.MAX_SAFE_INTEGER,userDistance:Number.MAX_SAFE_INTEGER};A.raycaster.disabled=!A.isPressed&&!this._wasPressed.get(r);let b=!1;this._toolHandlers[this._tool]&&(b=this._toolHandlers[this._tool](A)),b?this._wasPressed.set(r,A.isPressed):(this._raycastInteractables(A,this._interactables),this._updateInteractables(A))}};const sr=new r.Vector3;let ir=new class extends InteractableHandler{constructor(){super(),this._skipIntersectsCheck=new Map,this._sphere=new r.Sphere,this._box3=new r.Box3}init(r){super.init(),this._scene=r}_setupXRSubscription(){sn.addUpdateListener((r=>{for(let[A,b]of this._selectedInteractables)for(let C of b){if(!C)continue;let b=0;r&&(b+=C.getCallbacksLength(r)),this._tool&&(b+=C.getCallbacksLength(this._tool)),b&&(C.removeSelectedBy(A),this._selectedInteractables.delete(A))}this._tool=r}))}_getBoundingSphere(r){return r?(this._skipIntersectsCheck.get(r)||this._skipIntersectsCheck.set(r,new Map),this._box3.setFromObject(r).getBoundingSphere(this._sphere),this._sphere):null}_scopeInteractables(r,A){let b=r.boundingSphere,C=r.skipIntersectsCheck;if(null!=b)for(let I of A){0!=I.children.size&&this._scopeInteractables(r,I.children);let A=I.object;if(null!=A&&!I.isOnlyGroup()&&(r.activeInteractables.add(I),I.intersectsSphere(b)&&!this._checkClipped(A))){let A=r.model||r.owner.object,b=C.get(I);b?(this._selectedInteractables.get(r.owner).has(I)&&r.touchedInteractables.add(I),C.set(I,b-1)):(I.intersectsObject(A)&&r.touchedInteractables.add(I),C.set(I,5))}}}_checkClipped(r){let A=r?.material?.clippingPlanes;if(A&&A.length>0){r.getWorldPosition(sr);for(let r of A)if(r.distanceToPoint(sr)<0)return!0}return!1}_updateInteractables(r){let A=r.owner;this._scopeInteractables(r,this._interactables),this._selectedInteractables.get(A)||this._selectedInteractables.set(A,new Set);let b=this._selectedInteractables.get(A),C=r.touchedInteractables,I=r.activeInteractables,x={owner:A};for(let r of b)C.has(r)||(r.removeSelectedBy(A),b.delete(r),I.has(r)&&(r.drag(x),this._trigger("up",x,r),r.click(x)));for(let r of C)b.has(r)?r.drag(x):(r.addSelectedBy(A),b.add(r),this._trigger("down",x,r))}_updateForXR(){for(let r in on){let A=!1;for(let b of[ln.HAND,ln.CONTROLLER]){let C=$n.getXRController(b,r,"grip"),I=$n.getXRControllerModel(b,r);if(C||(C=$n.getXRController(b,r,"targetRay")),!C)continue;let x,S,B=this._getOwner(C),D=isDescendant(this._scene,C);if(D&&(b==ln.CONTROLLER?A=!0:A&&(D=!1)),D){let r=isDescendant(C,I)?I:C;x=this._getBoundingSphere(r),S=this._skipIntersectsCheck.get(r)}let R={owner:B,model:I,boundingSphere:x,activeInteractables:new Set,touchedInteractables:new Set,skipIntersectsCheck:S},F=!1;this._toolHandlers[this._tool]&&(F=this._toolHandlers[this._tool](R)),F||this._updateInteractables(R)}}}};class InteractableComponent extends LayoutComponent{constructor(...r){super(...r),this.pointerInteractable=this.pointerInteractableClassOverride?new this.pointerInteractableClassOverride(this):new PointerInteractable(this),this.touchInteractable=new TouchInteractable(this),this._clickAction=r=>this._pointerClick(r),this._dragAction=r=>this._pointerDrag(r),this._touchAction=r=>this._touch(r),this._touchDragAction=r=>this._touchDrag(r)}_createBackground(){super._createBackground(),this.pointerInteractable.object=this._background,this.touchInteractable.object=this._background}_pointerClick(r){this._onClick&&this._onClick(r)}_pointerDrag(r){this._onDrag&&this._onDrag(r)}_touch(r){this._onTouch&&this._onTouch(r)}_touchDrag(r){this._onTouchDrag&&this._onTouchDrag(r)}_onAdded(){super._onAdded();let A=this.parentComponent;if(this.parent?.pointerInteractable&&this.parent?.touchInteractable)this.parent.pointerInteractable.addChild(this.pointerInteractable),this.parent.touchInteractable.addChild(this.touchInteractable);else if(A instanceof InteractableComponent)A.pointerInteractable.addChild(this.pointerInteractable),A.touchInteractable.addChild(this.touchInteractable);else{for(A=this.parent;A;){if(A instanceof r.Scene)return tr.addInteractable(this.pointerInteractable),void ir.addInteractable(this.touchInteractable);A=A.parent}tr.removeInteractable(this.pointerInteractable),ir.removeInteractable(this.touchInteractable)}}_onRemoved(){super._onRemoved(),this.pointerInteractable.parent?this.pointerInteractable.parent.removeChild(this.pointerInteractable):tr.removeInteractable(this.pointerInteractable),this.touchInteractable.parent?this.touchInteractable.parent.removeChild(this.touchInteractable):ir.removeInteractable(this.touchInteractable)}_setCallback(r,A,b,C){let I="_on"+capitalizeFirstLetter(b),x="_"+b+"Action";C&&!this[I]?r.addEventListener(A,this[x]):!C&&this[I]&&r.removeEventListener(A,this[x]),this[I]=C}get onClick(){return this._onClick}get onDrag(){return this._onDrag}get onTouch(){return this._onTouch}get onTouchDrag(){return this._onTouchDrag}set onClick(r){this._setCallback(this.pointerInteractable,"click","click",r)}set onClickAndTouch(r){this._setCallback(this.pointerInteractable,"click","click",r),this._setCallback(this.touchInteractable,"click","touch",r)}set onDrag(r){this._setCallback(this.pointerInteractable,"drag","drag",r)}set onTouch(r){this._setCallback(this.touchInteractable,"click","touch",r)}set onTouchDrag(r){this._setCallback(this.touchInteractable,"drag","touchDrag",r)}}const nr=new r.Vector3,rr=new r.Plane;class ScrollableComponent extends InteractableComponent{constructor(...A){super(...A),this.scrollAmount=0,this._scrollBoundsMin=new r.Vector2,this._scrollBoundsMax=new r.Vector2,this._scrollOwner,this._scrollable=!1,this._scrollableByAncestor=!1,this._downAction=r=>this.pointerInteractable.capture(r.owner),this._touchDownAction=r=>this.touchInteractable.capture(r.owner)}updateLayout(){super.updateLayout(),this._updateScrollInteractables()}_updateScrollInteractables(){let r=this._scrollable||this._scrollableByAncestor;if(this._updateScrollable(),r==(this._scrollable||this._scrollableByAncestor))return;for(let r of this._content.children)r instanceof ScrollableComponent&&r._updateScrollInteractables();let A=r?"removeEventListener":"addEventListener";this.pointerInteractable[A]("down",this._downAction),this.touchInteractable[A]("down",this._touchDownAction),this._onClick||this.pointerInteractable[A]("click",this._clickAction),this._onDrag||this.pointerInteractable[A]("drag",this._dragAction),this._onTouch||this.touchInteractable[A]("click",this._touchAction),this._onTouchDrag||this.touchInteractable[A]("drag",this._touchDragAction)}_updateScrollable(){let r=this.computedHeight,A=this.computedWidth,b=this._getContentHeight(),C=this._getContentWidth(),I="scroll"==this.overflow;if(this._verticallyScrollable=b>r&&I,this._horizontallyScrollable=C>A&&I,this._scrollable=this._verticallyScrollable||this._horizontallyScrollable,this._scrollableByAncestor=null!=this._onClick&&null!=this._getScrollableAncestor(),!this._scrollable)return this._content.position.x=0,void(this._content.position.y=0);let x,S,B,D,R,F,N,Q,H=this.justifyContent,G=this.alignItems;"row"==this.contentDirection?(x=-this.unpaddedWidth,S=this.unpaddedHeight,B=-C,D=b,R="x",F="y",N=this._scrollBoundsMin,Q=this._scrollBoundsMax):(x=this.unpaddedHeight,S=-this.unpaddedWidth,B=b,D=-C,R="y",F="x",N=this._scrollBoundsMax,Q=this._scrollBoundsMin),"start"==H?(N[R]=B-x,Q[R]=0):"end"==H?(N[R]=0,Q[R]=-B+x):"center"==H||Math.abs(x)-Math.abs(B)<0?(N[R]=(B-x)/2,Q[R]=-1*N[R]):N[R]=Q[R]=0,"start"==G?(Q[F]=D-S,N[F]=0):"end"==G?(Q[F]=0,N[F]=-D+S):(Q[F]=(D-S)/2,N[F]=-1*Q[F]),this._verticallyScrollable&&this._boundScrollPosition("y"),this._horizontallyScrollable&&this._boundScrollPosition("x")}_pointerClick(r){let{owner:A,point:b}=r;if(this._scrollAncestor){let C=!this._scrollAncestor.scrollThresholdReached;this._scrollAncestor.clearScroll(A),this._scrollAncestor=null,this._onClick&&C&&b&&this._onClick(r)}else this._onClick&&this._onClick(r);this.clearScroll(A)}_pointerDrag(r){let{owner:A,point:b}=r;this._onDrag?this._onDrag(r):this._scrollable?this.handleScroll(A,b):this._scrollableByAncestor&&(this._scrollAncestor?this._scrollAncestor.handleScroll(A,b):(this._scrollAncestor=this._getScrollableAncestor(),this._scrollAncestor&&this._scrollAncestor.handleScroll(A,b)))}_touch(r){let A=r.owner;if(this._scrollAncestor){let A=!this.scrollThresholdReached;this.scrollThresholdReached=!1,this._scrollAncestor=null,this._onTouch&&A&&this._onTouch(r)}else this._onTouch&&this._onTouch(r);this.clearScroll(A)}_touchDrag(r){let A=r.owner;this._onTouchDrag?this._onTouchDrag(A):this._scrollable?this.handleTouchScroll(A,this.touchInteractable):this._scrollAncestor?this._scrollAncestor.scrollThresholdReached&&!this.scrollThresholdReached&&(this.scrollThresholdReached=!0):this._scrollAncestor=this._getScrollableAncestor()}clearScroll(r){this._scrollStart&&r==this._scrollOwner&&(this._scrollOwner=null,this._scrollStart=null,this._scrollStartPosition=null,this._scrollType=null,this._scrollStartThresholdReached=null,this.scrollThresholdReached=null,this.scrollAmount=0)}handleScroll(r,A){this._scrollStart?r==this._scrollOwner&&"POINTER"==this._scrollType&&(A?A=nr.copy(A):(rr.set(nr.set(0,0,1),0),rr.applyMatrix4(this.matrixWorld),A=r.raycaster.ray.intersectPlane(rr,nr)),A&&(A=this.worldToLocal(A),this._horizontallyScrollable&&this._scroll("x",A),this._verticallyScrollable&&this._scroll("y",A))):A&&(this._scrollStart=this.worldToLocal(A.clone()),this._scrollStartPosition=this._content.position.clone(),this._scrollOwner=r,this._scrollType="POINTER")}handleTouchScroll(r,A){if(this._scrollStart){if(r==this._scrollOwner&&"TOUCH"==this._scrollType){let r=this._scrollController.bvhGeometry.getAttribute("position");nr.fromBufferAttribute(r,this._scrollVertex),this._scrollController.localToWorld(nr),this.worldToLocal(nr),this._horizontallyScrollable&&this._scroll("x",nr),this._verticallyScrollable&&this._scroll("y",nr)}}else{let b=A.getClosestPointTo(r.object);this._scrollController=b[1].object,this._scrollVertex=this._scrollController.bvhGeometry.index.array[3*b[1].faceIndex];let C=this._scrollController.bvhGeometry.getAttribute("position");nr.fromBufferAttribute(C,this._scrollVertex),this._scrollController.localToWorld(nr),this._scrollStart=this.worldToLocal(nr).clone(),this._scrollStartPosition=this._content.position.clone(),this._scrollOwner=r,this._scrollType="TOUCH"}}_getScrollableAncestor(){let r=this.parentComponent;for(;r instanceof LayoutComponent;){if(r._scrollable)return r;r=r.parentComponent}}_scroll(r,A){let b=this._content.position[r];if(this._content.position[r]=this._scrollStartPosition[r]-this._scrollStart[r]+A[r],this._boundScrollPosition(r),!this.scrollThresholdReached){let C=Math.abs(b-this._content.position[r]);this.scrollAmount+=C;let I="x"==r?this.computedWidth:this.computedHeight;this._scrollStartThresholdReached?this.scrollAmount>.1*I&&(this.scrollThresholdReached=!0):(this._content.position[r]=b,this._scrollStart[r]=A[r],this.scrollAmount>=.02*I&&(this._scrollStartThresholdReached=!0,this.scrollAmount=0))}}_boundScrollPosition(r){this._content.position[r]<this._scrollBoundsMin[r]?this._content.position[r]=this._scrollBoundsMin[r]:this._content.position[r]>this._scrollBoundsMax[r]&&(this._content.position[r]=this._scrollBoundsMax[r])}_setCallback(r,A,b,C){let I="_on"+capitalizeFirstLetter(b),x="_"+b+"Action";this._scrollable||this._scrollableByAncestor||(C&&!this[I]?r.addEventListener(A,this[x]):!C&&this[I]&&r.removeEventListener(A,this[x])),this[I]=C}}class Body extends ScrollableComponent{constructor(...r){super(...r),this.bypassContentPositioning=!0,this._defaults.backgroundVisible=!0,this._defaults.height=1,this._defaults.width=1,this.updateLayout()}}function workerBootstrap(){var r=Object.create(null);function registerModule(A,b){var C=A.id,I=A.name,x=A.dependencies;void 0===x&&(x=[]);var S=A.init;void 0===S&&(S=function(){});var B=A.getTransferables;if(void 0===B&&(B=null),!r[C])try{x=x.map((function(A){return A&&A.isWorkerModule&&(registerModule(A,(function(r){if(r instanceof Error)throw r})),A=r[A.id].value),A})),S=rehydrate("<"+I+">.init",S),B&&(B=rehydrate("<"+I+">.getTransferables",B));var D=null;"function"==typeof S?D=S.apply(void 0,x):console.error("worker module init function failed to rehydrate"),r[C]={id:C,value:D,getTransferables:B},b(D)}catch(r){r&&r.noLog||console.error(r),b(r)}}function rehydrate(r,A){var b=void 0;self.troikaDefine=function(r){return b=r};var C=URL.createObjectURL(new Blob(["/** "+r.replace(/\*/g,"")+" **/\n\ntroikaDefine(\n"+A+"\n)"],{type:"application/javascript"}));try{importScripts(C)}catch(r){console.error(r)}return URL.revokeObjectURL(C),delete self.troikaDefine,b}self.addEventListener("message",(function(A){var b=A.data,C=b.messageId,I=b.action,x=b.data;try{"registerModule"===I&&registerModule(x,(function(r){r instanceof Error?postMessage({messageId:C,success:!1,error:r.message}):postMessage({messageId:C,success:!0,result:{isCallable:"function"==typeof r}})})),"callModule"===I&&function(A,b){var C,I=A.id,x=A.args;r[I]&&"function"==typeof r[I].value||b(new Error("Worker module "+I+": not found or its 'init' did not return a function"));try{var S=(C=r[I]).value.apply(C,x);S&&"function"==typeof S.then?S.then(handleResult,(function(r){return b(r instanceof Error?r:new Error(""+r))})):handleResult(S)}catch(r){b(r)}function handleResult(A){try{var C=r[I].getTransferables&&r[I].getTransferables(A);C&&Array.isArray(C)&&C.length||(C=void 0),b(A,C)}catch(r){console.error(r),b(r)}}}(x,(function(r,A){r instanceof Error?postMessage({messageId:C,success:!1,error:r.message}):postMessage({messageId:C,success:!0,result:r},A||void 0)}))}catch(r){postMessage({messageId:C,success:!1,error:r.stack})}}))}var supportsWorkers=function(){var r=!1;if("undefined"!=typeof window&&void 0!==window.document)try{new Worker(URL.createObjectURL(new Blob([""],{type:"application/javascript"}))).terminate(),r=!0}catch(r){"undefined"!=typeof process&&"test"===process.env.NODE_ENV||console.log("Troika createWorkerModule: web workers not allowed; falling back to main thread execution. Cause: ["+r.message+"]")}return supportsWorkers=function(){return r},r},ar=0,or=0,lr=!1,hr=Object.create(null),dr=Object.create(null),cr=Object.create(null);function defineWorkerModule(r){if(!(r&&"function"==typeof r.init||lr))throw new Error("requires `options.init` function");var A=r.dependencies,b=r.init,C=r.getTransferables,I=r.workerId;if(!supportsWorkers())return function(r){var moduleFunc=function(){for(var r=[],A=arguments.length;A--;)r[A]=arguments[A];return moduleFunc._getInitResult().then((function(A){if("function"==typeof A)return A.apply(void 0,r);throw new Error("Worker module function was called but `init` did not return a callable function")}))};return moduleFunc._getInitResult=function(){var A=r.dependencies,b=r.init;A=Array.isArray(A)?A.map((function(r){return r&&r._getInitResult?r._getInitResult():r})):[];var C=Promise.all(A).then((function(r){return b.apply(null,r)}));return moduleFunc._getInitResult=function(){return C},C},moduleFunc}(r);null==I&&(I="#default");var x="workerModule"+ ++ar,S=r.name||x,B=null;function moduleFunc(){for(var r=[],A=arguments.length;A--;)r[A]=arguments[A];if(!B){B=callWorker(I,"registerModule",moduleFunc.workerModuleData);var unregister=function(){B=null,dr[I].delete(unregister)};(dr[I]||(dr[I]=new Set)).add(unregister)}return B.then((function(A){if(A.isCallable)return callWorker(I,"callModule",{id:x,args:r});throw new Error("Worker module function was called but `init` did not return a callable function")}))}return A=A&&A.map((function(r){return"function"!=typeof r||r.workerModuleData||(lr=!0,r=defineWorkerModule({workerId:I,name:"<"+S+"> function dependency: "+r.name,init:"function(){return (\n"+stringifyFunction(r)+"\n)}"}),lr=!1),r&&r.workerModuleData&&(r=r.workerModuleData),r})),moduleFunc.workerModuleData={isWorkerModule:!0,id:x,name:S,dependencies:A,init:stringifyFunction(b),getTransferables:C&&stringifyFunction(C)},moduleFunc}function stringifyFunction(r){var A=r.toString();return!/^function/.test(A)&&/^\w+\s*\(/.test(A)&&(A="function "+A),A}function callWorker(r,A,b){return new Promise((function(C,I){var x=++or;cr[x]=function(r){r.success?C(r.result):I(new Error("Error in worker "+A+" call: "+r.error))},function(r){var A=hr[r];if(!A){var b=stringifyFunction(workerBootstrap);(A=hr[r]=new Worker(URL.createObjectURL(new Blob(["/** Worker Module Bootstrap: "+r.replace(/\*/g,"")+" **/\n\n;("+b+")()"],{type:"application/javascript"})))).onmessage=function(r){var A=r.data,b=A.messageId,C=cr[b];if(!C)throw new Error("WorkerModule response with empty or unknown messageId");delete cr[b],C(A)}}return A}(r).postMessage({messageId:x,action:A,data:b})}))}function SDFGenerator(){var r=function(r){function pointOnCubicBezier(r,A,b,C,I,x,S,B,D,R){var F=1-D;R.x=F*F*F*r+3*F*F*D*b+3*F*D*D*I+D*D*D*S,R.y=F*F*F*A+3*F*F*D*C+3*F*D*D*x+D*D*D*B}function forEachPathCommand(r,A){for(var b,C,I,x,S,B=/([MLQCZ])([^MLQCZ]*)/g;b=B.exec(r);){var D=b[2].replace(/^\s*|\s*$/g,"").split(/[,\s]+/).map((function(r){return parseFloat(r)}));switch(b[1]){case"M":x=C=D[0],S=I=D[1];break;case"L":D[0]===x&&D[1]===S||A("L",x,S,x=D[0],S=D[1]);break;case"Q":A("Q",x,S,x=D[2],S=D[3],D[0],D[1]);break;case"C":A("C",x,S,x=D[4],S=D[5],D[0],D[1],D[2],D[3]);break;case"Z":x===C&&S===I||A("L",x,S,C,I)}}}function pathToLineSegments(r,A,b){void 0===b&&(b=16);var C={x:0,y:0};forEachPathCommand(r,(function(r,I,x,S,B,D,R,F,N){switch(r){case"L":A(I,x,S,B);break;case"Q":for(var Q=I,H=x,G=1;G<b;G++)X=x,Y=R,K=B,void 0,J=1-(q=G/(b-1)),(Z=C).x=J*J*I+2*J*q*D+q*q*S,Z.y=J*J*X+2*J*q*Y+q*q*K,A(Q,H,C.x,C.y),Q=C.x,H=C.y;break;case"C":for(var j=I,V=x,W=1;W<b;W++)pointOnCubicBezier(I,x,D,R,F,N,S,B,W/(b-1),C),A(j,V,C.x,C.y),j=C.x,V=C.y}var X,Y,K,q,Z,J}))}var A="precision highp float;attribute vec2 aUV;varying vec2 vUV;void main(){vUV=aUV;gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",b="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){gl_FragColor=texture2D(tex,vUV);}",C=new WeakMap,I={premultipliedAlpha:!1,preserveDrawingBuffer:!0,antialias:!1,depth:!1};function withWebGLContext(r,A){var b=r.getContext?r.getContext("webgl",I):r,x=C.get(b);if(!x){var S="undefined"!=typeof WebGL2RenderingContext&&b instanceof WebGL2RenderingContext,B={},D={},R={},F=-1,N=[];function getExtension(r){var A=B[r];if(!A&&!(A=B[r]=b.getExtension(r)))throw new Error(r+" not supported");return A}function compileShader(r,A){var C=b.createShader(A);return b.shaderSource(C,r),b.compileShader(C),C}function handleContextLoss(){B={},D={},R={},F=-1,N.length=0}b.canvas.addEventListener("webglcontextlost",(function(r){handleContextLoss(),r.preventDefault()}),!1),C.set(b,x={gl:b,isWebGL2:S,getExtension:getExtension,withProgram:function withProgram(r,A,C,I){if(!D[r]){var x={},B={},R=b.createProgram();b.attachShader(R,compileShader(A,b.VERTEX_SHADER)),b.attachShader(R,compileShader(C,b.FRAGMENT_SHADER)),b.linkProgram(R),D[r]={program:R,transaction:function(r){b.useProgram(R),r({setUniform:function(r,A){for(var C=[],I=arguments.length-2;I-- >0;)C[I]=arguments[I+2];var x=B[A]||(B[A]=b.getUniformLocation(R,A));b["uniform"+r].apply(b,[x].concat(C))},setAttribute:function(r,A,C,I,B){var D=x[r];D||(D=x[r]={buf:b.createBuffer(),loc:b.getAttribLocation(R,r),data:null}),b.bindBuffer(b.ARRAY_BUFFER,D.buf),b.vertexAttribPointer(D.loc,A,b.FLOAT,!1,0,0),b.enableVertexAttribArray(D.loc),S?b.vertexAttribDivisor(D.loc,I):getExtension("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(D.loc,I),B!==D.data&&(b.bufferData(b.ARRAY_BUFFER,B,C),D.data=B)}})}}}D[r].transaction(I)},withTexture:function withTexture(r,A){F++;try{b.activeTexture(b.TEXTURE0+F);var C=R[r];C||(C=R[r]=b.createTexture(),b.bindTexture(b.TEXTURE_2D,C),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,b.NEAREST),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,b.NEAREST)),b.bindTexture(b.TEXTURE_2D,C),A(C,F)}finally{F--}},withTextureFramebuffer:function withTextureFramebuffer(r,A,C){var I=b.createFramebuffer();N.push(I),b.bindFramebuffer(b.FRAMEBUFFER,I),b.activeTexture(b.TEXTURE0+A),b.bindTexture(b.TEXTURE_2D,r),b.framebufferTexture2D(b.FRAMEBUFFER,b.COLOR_ATTACHMENT0,b.TEXTURE_2D,r,0);try{C(I)}finally{b.deleteFramebuffer(I),b.bindFramebuffer(b.FRAMEBUFFER,N[--N.length-1]||null)}},handleContextLoss:handleContextLoss})}A(x)}function renderImageData(r,C,I,x,S,B,D,R){void 0===D&&(D=15),void 0===R&&(R=null),withWebGLContext(r,(function(r){var F=r.gl,N=r.withProgram;(0,r.withTexture)("copy",(function(r,Q){F.texImage2D(F.TEXTURE_2D,0,F.RGBA,S,B,0,F.RGBA,F.UNSIGNED_BYTE,C),N("copy",A,b,(function(r){var A=r.setUniform;(0,r.setAttribute)("aUV",2,F.STATIC_DRAW,0,new Float32Array([0,0,2,0,0,2])),A("1i","image",Q),F.bindFramebuffer(F.FRAMEBUFFER,R||null),F.disable(F.BLEND),F.colorMask(8&D,4&D,2&D,1&D),F.viewport(I,x,S,B),F.scissor(I,x,S,B),F.drawArrays(F.TRIANGLES,0,3)}))}))}))}var x=Object.freeze({__proto__:null,withWebGLContext:withWebGLContext,renderImageData:renderImageData,resizeWebGLCanvasWithoutClearing:function(r,A,b){var C=r.width,I=r.height;withWebGLContext(r,(function(x){var S=x.gl,B=new Uint8Array(C*I*4);S.readPixels(0,0,C,I,S.RGBA,S.UNSIGNED_BYTE,B),r.width=A,r.height=b,renderImageData(S,B,0,0,C,I)}))}});function generate$2(r,A,b,C,I,x){void 0===x&&(x=1);var S=new Uint8Array(r*A),B=C[2]-C[0],D=C[3]-C[1],R=[];pathToLineSegments(b,(function(r,A,b,C){R.push({x1:r,y1:A,x2:b,y2:C,minX:Math.min(r,b),minY:Math.min(A,C),maxX:Math.max(r,b),maxY:Math.max(A,C)})})),R.sort((function(r,A){return r.maxX-A.maxX}));for(var F=0;F<r;F++)for(var N=0;N<A;N++){var Q=findNearestSignedDistance(C[0]+B*(F+.5)/r,C[1]+D*(N+.5)/A),H=Math.pow(1-Math.abs(Q)/I,x)/2;Q<0&&(H=1-H),H=Math.max(0,Math.min(255,Math.round(255*H))),S[N*r+F]=H}return S;function findNearestSignedDistance(r,A){for(var b=1/0,C=1/0,I=R.length;I--;){var x=R[I];if(x.maxX+C<=r)break;if(r+C>x.minX&&A-C<x.maxY&&A+C>x.minY){var S=absSquareDistanceToLineSegment(r,A,x.x1,x.y1,x.x2,x.y2);S<b&&(b=S,C=Math.sqrt(b))}}return function(r,A){for(var b=0,C=R.length;C--;){var I=R[C];if(I.maxX<=r)break;I.y1>A!=I.y2>A&&r<(I.x2-I.x1)*(A-I.y1)/(I.y2-I.y1)+I.x1&&(b+=I.y1<I.y2?1:-1)}return 0!==b}(r,A)&&(C=-C),C}}function generateIntoCanvas$2(r,A,b,C,I,x,S,B,D,R){void 0===x&&(x=1),void 0===B&&(B=0),void 0===D&&(D=0),void 0===R&&(R=0),generateIntoFramebuffer$1(r,A,b,C,I,x,S,null,B,D,R)}function generateIntoFramebuffer$1(r,A,b,C,I,x,S,B,D,R,F){void 0===x&&(x=1),void 0===D&&(D=0),void 0===R&&(R=0),void 0===F&&(F=0);for(var N=generate$2(r,A,b,C,I,x),Q=new Uint8Array(4*N.length),H=0;H<N.length;H++)Q[4*H+F]=N[H];renderImageData(S,Q,D,R,r,A,1<<3-F,B)}function absSquareDistanceToLineSegment(r,A,b,C,I,x){var S=I-b,B=x-C,D=S*S+B*B,R=D?Math.max(0,Math.min(1,((r-b)*S+(A-C)*B)/D)):0,F=r-(b+R*S),N=A-(C+R*B);return F*F+N*N}var S=Object.freeze({__proto__:null,generate:generate$2,generateIntoCanvas:generateIntoCanvas$2,generateIntoFramebuffer:generateIntoFramebuffer$1}),B="precision highp float;uniform vec4 uGlyphBounds;attribute vec2 aUV;attribute vec4 aLineSegment;varying vec4 vLineSegment;varying vec2 vGlyphXY;void main(){vLineSegment=aLineSegment;vGlyphXY=mix(uGlyphBounds.xy,uGlyphBounds.zw,aUV);gl_Position=vec4(mix(vec2(-1.0),vec2(1.0),aUV),0.0,1.0);}",D="precision highp float;uniform vec4 uGlyphBounds;uniform float uMaxDistance;uniform float uExponent;varying vec4 vLineSegment;varying vec2 vGlyphXY;float absDistToSegment(vec2 point,vec2 lineA,vec2 lineB){vec2 lineDir=lineB-lineA;float lenSq=dot(lineDir,lineDir);float t=lenSq==0.0 ? 0.0 : clamp(dot(point-lineA,lineDir)/lenSq,0.0,1.0);vec2 linePt=lineA+t*lineDir;return distance(point,linePt);}void main(){vec4 seg=vLineSegment;vec2 p=vGlyphXY;float dist=absDistToSegment(p,seg.xy,seg.zw);float val=pow(1.0-clamp(dist/uMaxDistance,0.0,1.0),uExponent)*0.5;bool crossing=(seg.y>p.y!=seg.w>p.y)&&(p.x<(seg.z-seg.x)*(p.y-seg.y)/(seg.w-seg.y)+seg.x);bool crossingUp=crossing&&vLineSegment.y<vLineSegment.w;gl_FragColor=vec4(crossingUp ? 1.0/255.0 : 0.0,crossing&&!crossingUp ? 1.0/255.0 : 0.0,0.0,val);}",R="precision highp float;uniform sampler2D tex;varying vec2 vUV;void main(){vec4 color=texture2D(tex,vUV);bool inside=color.r!=color.g;float val=inside ? 1.0-color.a : color.a;gl_FragColor=vec4(val);}",F=new Float32Array([0,0,2,0,0,2]),N=null,Q=!1,H={},G=new WeakMap;function validateSupport(r){if(!Q&&!isSupported(r))throw new Error("WebGL generation not supported")}function generate$1(r,A,b,C,I,x,S){if(void 0===x&&(x=1),void 0===S&&(S=null),!S&&!(S=N)){var B="function"==typeof OffscreenCanvas?new OffscreenCanvas(1,1):"undefined"!=typeof document?document.createElement("canvas"):null;if(!B)throw new Error("OffscreenCanvas or DOM canvas not supported");S=N=B.getContext("webgl",{depth:!1})}validateSupport(S);var D=new Uint8Array(r*A*4);withWebGLContext(S,(function(S){var B=S.gl,R=S.withTexture,F=S.withTextureFramebuffer;R("readable",(function(S,R){B.texImage2D(B.TEXTURE_2D,0,B.RGBA,r,A,0,B.RGBA,B.UNSIGNED_BYTE,null),F(S,R,(function(S){generateIntoFramebuffer(r,A,b,C,I,x,B,S,0,0,0),B.readPixels(0,0,r,A,B.RGBA,B.UNSIGNED_BYTE,D)}))}))}));for(var R=new Uint8Array(r*A),F=0,Q=0;F<D.length;F+=4)R[Q++]=D[F];return R}function generateIntoCanvas$1(r,A,b,C,I,x,S,B,D,R){void 0===x&&(x=1),void 0===B&&(B=0),void 0===D&&(D=0),void 0===R&&(R=0),generateIntoFramebuffer(r,A,b,C,I,x,S,null,B,D,R)}function generateIntoFramebuffer(r,b,C,I,x,S,N,Q,H,G,j){void 0===S&&(S=1),void 0===H&&(H=0),void 0===G&&(G=0),void 0===j&&(j=0),validateSupport(N);var V=[];pathToLineSegments(C,(function(r,A,b,C){V.push(r,A,b,C)})),V=new Float32Array(V),withWebGLContext(N,(function(C){var N=C.gl,W=C.isWebGL2,X=C.getExtension,Y=C.withProgram,K=C.withTexture,q=C.withTextureFramebuffer,Z=C.handleContextLoss;if(K("rawDistances",(function(C,K){r===C._lastWidth&&b===C._lastHeight||N.texImage2D(N.TEXTURE_2D,0,N.RGBA,C._lastWidth=r,C._lastHeight=b,0,N.RGBA,N.UNSIGNED_BYTE,null),Y("main",B,D,(function(A){var B=A.setAttribute,D=A.setUniform,R=!W&&X("ANGLE_instanced_arrays"),Q=!W&&X("EXT_blend_minmax");B("aUV",2,N.STATIC_DRAW,0,F),B("aLineSegment",4,N.DYNAMIC_DRAW,1,V),D.apply(void 0,["4f","uGlyphBounds"].concat(I)),D("1f","uMaxDistance",x),D("1f","uExponent",S),q(C,K,(function(A){N.enable(N.BLEND),N.colorMask(!0,!0,!0,!0),N.viewport(0,0,r,b),N.scissor(0,0,r,b),N.blendFunc(N.ONE,N.ONE),N.blendEquationSeparate(N.FUNC_ADD,W?N.MAX:Q.MAX_EXT),N.clear(N.COLOR_BUFFER_BIT),W?N.drawArraysInstanced(N.TRIANGLES,0,3,V.length/4):R.drawArraysInstancedANGLE(N.TRIANGLES,0,3,V.length/4)}))})),Y("post",A,R,(function(A){A.setAttribute("aUV",2,N.STATIC_DRAW,0,F),A.setUniform("1i","tex",K),N.bindFramebuffer(N.FRAMEBUFFER,Q),N.disable(N.BLEND),N.colorMask(0===j,1===j,2===j,3===j),N.viewport(H,G,r,b),N.scissor(H,G,r,b),N.drawArrays(N.TRIANGLES,0,3)}))})),N.isContextLost())throw Z(),new Error("webgl context lost")}))}function isSupported(r){var A=r&&r!==N?r.canvas||r:H,b=G.get(A);if(void 0===b){Q=!0;var C=null;try{var I=[97,106,97,61,99,137,118,80,80,118,137,99,61,97,106,97],x=generate$1(4,4,"M8,8L16,8L24,24L16,24Z",[0,0,32,32],24,1,r);b=x&&I.length===x.length&&x.every((function(r,A){return r===I[A]})),b||(C="bad trial run results",console.info(I,x))}catch(r){b=!1,C=r.message}C&&console.warn("WebGL SDF generation not supported:",C),Q=!1,G.set(A,b)}return b}var j=Object.freeze({__proto__:null,generate:generate$1,generateIntoCanvas:generateIntoCanvas$1,generateIntoFramebuffer:generateIntoFramebuffer,isSupported:isSupported});return r.forEachPathCommand=forEachPathCommand,r.generate=function(r,A,b,C,I,x){void 0===I&&(I=Math.max(C[2]-C[0],C[3]-C[1])/2),void 0===x&&(x=1);try{return generate$1.apply(j,arguments)}catch(r){return console.info("WebGL SDF generation failed, falling back to JS",r),generate$2.apply(S,arguments)}},r.generateIntoCanvas=function(r,A,b,C,I,x,B,D,R,F){void 0===I&&(I=Math.max(C[2]-C[0],C[3]-C[1])/2),void 0===x&&(x=1),void 0===D&&(D=0),void 0===R&&(R=0),void 0===F&&(F=0);try{return generateIntoCanvas$1.apply(j,arguments)}catch(r){return console.info("WebGL SDF generation failed, falling back to JS",r),generateIntoCanvas$2.apply(S,arguments)}},r.javascript=S,r.pathToLineSegments=pathToLineSegments,r.webgl=j,r.webglUtils=x,Object.defineProperty(r,"__esModule",{value:!0}),r}({});return r}const ur=/\bvoid\s+main\s*\(\s*\)\s*{/g;function expandShaderIncludes(r){return r.replace(/^[ \t]*#include +<([\w\d./]+)>/gm,(function(r,A){let b=bt[A];return b?expandShaderIncludes(b):r}))}const pr=[];for(let r=0;r<256;r++)pr[r]=(r<16?"0":"")+r.toString(16);const Ar=Object.assign||function(){let r=arguments[0];for(let A=1,b=arguments.length;A<b;A++){let b=arguments[A];if(b)for(let A in b)Object.prototype.hasOwnProperty.call(b,A)&&(r[A]=b[A])}return r},gr=Date.now(),fr=new WeakMap,mr=new Map;let _r=1e10;function createDerivedMaterial(r,A){const b=function(r){const A=JSON.stringify(r,optionsJsonReplacer);let b=yr.get(A);return null==b&&yr.set(A,b=++br),b}
/*!
Custom build of Typr.ts (https://github.com/fredli74/Typr.ts) for use in Troika text rendering.
Original MIT license applies: https://github.com/fredli74/Typr.ts/blob/master/LICENSE
*/(A);let C=fr.get(r);if(C||fr.set(r,C=Object.create(null)),C[b])return new C[b];const I=`_onBeforeCompile${b}`,onBeforeCompile=function(C,x){r.onBeforeCompile.call(this,C,x);const S=this.customProgramCacheKey()+"|"+C.vertexShader+"|"+C.fragmentShader;let B=mr[S];if(!B){const r=function(r,{vertexShader:A,fragmentShader:b},C,I){let{vertexDefs:x,vertexMainIntro:S,vertexMainOutro:B,vertexTransform:D,fragmentDefs:R,fragmentMainIntro:F,fragmentMainOutro:N,fragmentColorTransform:Q,customRewriter:H,timeUniform:G}=C;if(x=x||"",S=S||"",B=B||"",R=R||"",F=F||"",N=N||"",(D||H)&&(A=expandShaderIncludes(A)),(Q||H)&&(b=expandShaderIncludes(b=b.replace(/^[ \t]*#include <((?:tonemapping|encodings|fog|premultiplied_alpha|dithering)_fragment)>/gm,"\n//!BEGIN_POST_CHUNK $1\n$&\n//!END_POST_CHUNK\n"))),H){let r=H({vertexShader:A,fragmentShader:b});A=r.vertexShader,b=r.fragmentShader}if(Q){let r=[];b=b.replace(/^\/\/!BEGIN_POST_CHUNK[^]+?^\/\/!END_POST_CHUNK/gm,(A=>(r.push(A),""))),N=`${Q}\n${r.join("\n")}\n${N}`}if(G){const r=`\nuniform float ${G};\n`;x=r+x,R=r+R}return D&&(x=`${x}\nvoid troikaVertexTransform${I}(inout vec3 position, inout vec3 normal, inout vec2 uv) {\n  ${D}\n}\n`,S=`\ntroika_position_${I} = vec3(position);\ntroika_normal_${I} = vec3(normal);\ntroika_uv_${I} = vec2(uv);\ntroikaVertexTransform${I}(troika_position_${I}, troika_normal_${I}, troika_uv_${I});\n${S}\n`,A=(A=`vec3 troika_position_${I};\nvec3 troika_normal_${I};\nvec2 troika_uv_${I};\n${A}\n`).replace(/\b(position|normal|uv)\b/g,((r,A,b,C)=>/\battribute\s+vec[23]\s+$/.test(C.substr(0,b))?A:`troika_${A}_${I}`)),r.map&&r.map.channel>0||(A=A.replace(/\bMAP_UV\b/g,`troika_uv_${I}`))),{vertexShader:A=injectIntoShaderCode(A,I,x,S,B),fragmentShader:b=injectIntoShaderCode(b,I,R,F,N)}}(this,C,A,b);B=mr[S]=r}C.vertexShader=B.vertexShader,C.fragmentShader=B.fragmentShader,Ar(C.uniforms,this.uniforms),A.timeUniform&&(C.uniforms[A.timeUniform]={get value(){return Date.now()-gr}}),this[I]&&this[I](C)},DerivedMaterial=function(){return derive(A.chained?r:r.clone())},derive=function(C){const I=Object.create(C,x);return Object.defineProperty(I,"baseMaterial",{value:r}),Object.defineProperty(I,"id",{value:_r++}),I.uuid=function(){const r=4294967295*Math.random()|0,A=4294967295*Math.random()|0,b=4294967295*Math.random()|0,C=4294967295*Math.random()|0;return(pr[255&r]+pr[r>>8&255]+pr[r>>16&255]+pr[r>>24&255]+"-"+pr[255&A]+pr[A>>8&255]+"-"+pr[A>>16&15|64]+pr[A>>24&255]+"-"+pr[63&b|128]+pr[b>>8&255]+"-"+pr[b>>16&255]+pr[b>>24&255]+pr[255&C]+pr[C>>8&255]+pr[C>>16&255]+pr[C>>24&255]).toUpperCase()}(),I.uniforms=Ar({},C.uniforms,A.uniforms),I.defines=Ar({},C.defines,A.defines),I.defines[`TROIKA_DERIVED_MATERIAL_${b}`]="",I.extensions=Ar({},C.extensions,A.extensions),I._listeners=void 0,I},x={constructor:{value:DerivedMaterial},isDerivedMaterial:{value:!0},customProgramCacheKey:{writable:!0,configurable:!0,value:function(){return r.customProgramCacheKey()+"|"+b}},onBeforeCompile:{get:()=>onBeforeCompile,set(r){this[I]=r}},copy:{writable:!0,configurable:!0,value:function(A){return r.copy.call(this,A),r.isShaderMaterial||r.isDerivedMaterial||(Ar(this.extensions,A.extensions),Ar(this.defines,A.defines),Ar(this.uniforms,gt.clone(A.uniforms))),this}},clone:{writable:!0,configurable:!0,value:function(){const A=new r.constructor;return derive(A).copy(this)}},getDepthMaterial:{writable:!0,configurable:!0,value:function(){let b=this._depthMaterial;return b||(b=this._depthMaterial=createDerivedMaterial(r.isDerivedMaterial?r.getDepthMaterial():new ft({depthPacking:mt}),A),b.defines.IS_DEPTH_MATERIAL="",b.uniforms=this.uniforms),b}},getDistanceMaterial:{writable:!0,configurable:!0,value:function(){let b=this._distanceMaterial;return b||(b=this._distanceMaterial=createDerivedMaterial(r.isDerivedMaterial?r.getDistanceMaterial():new _t,A),b.defines.IS_DISTANCE_MATERIAL="",b.uniforms=this.uniforms),b}},dispose:{writable:!0,configurable:!0,value(){const{_depthMaterial:A,_distanceMaterial:b}=this;A&&A.dispose(),b&&b.dispose(),r.dispose.call(this)}}};return C[b]=DerivedMaterial,new DerivedMaterial}function injectIntoShaderCode(r,A,b,C,I){return(C||I||b)&&(r=r.replace(ur,`\n${b}\nvoid troikaOrigMain${A}() {`),r+=`\nvoid main() {\n  ${C}\n  troikaOrigMain${A}();\n  ${I}\n}`),r}function optionsJsonReplacer(r,A){return"uniforms"===r?void 0:"function"==typeof A?A.toString():A}let br=0;const yr=new Map,vr=defineWorkerModule({name:"Typr Font Parser",dependencies:[function(){return"undefined"==typeof window&&(self.window=self),function(r){var A={parse:function(r){var b=A._bin,C=new Uint8Array(r);if("ttcf"==b.readASCII(C,0,4)){var I=4;b.readUshort(C,I),I+=2,b.readUshort(C,I),I+=2;var x=b.readUint(C,I);I+=4;for(var S=[],B=0;B<x;B++){var D=b.readUint(C,I);I+=4,S.push(A._readFont(C,D))}return S}return[A._readFont(C,0)]},_readFont:function(r,b){var C=A._bin,I=b;C.readFixed(r,b),b+=4;var x=C.readUshort(r,b);b+=2,C.readUshort(r,b),b+=2,C.readUshort(r,b),b+=2,C.readUshort(r,b),b+=2;for(var S=["cmap","head","hhea","maxp","hmtx","name","OS/2","post","loca","glyf","kern","CFF ","GDEF","GPOS","GSUB","SVG "],B={_data:r,_offset:I},D={},R=0;R<x;R++){var F=C.readASCII(r,b,4);b+=4,C.readUint(r,b),b+=4;var N=C.readUint(r,b);b+=4;var Q=C.readUint(r,b);b+=4,D[F]={offset:N,length:Q}}for(R=0;R<S.length;R++){var H=S[R];D[H]&&(B[H.trim()]=A[H.trim()].parse(r,D[H].offset,D[H].length,B))}return B},_tabOffset:function(r,b,C){for(var I=A._bin,x=I.readUshort(r,C+4),S=C+12,B=0;B<x;B++){var D=I.readASCII(r,S,4);S+=4,I.readUint(r,S),S+=4;var R=I.readUint(r,S);if(S+=4,I.readUint(r,S),S+=4,D==b)return R}return 0}};A._bin={readFixed:function(r,A){return(r[A]<<8|r[A+1])+(r[A+2]<<8|r[A+3])/65540},readF2dot14:function(r,b){return A._bin.readShort(r,b)/16384},readInt:function(r,b){return A._bin._view(r).getInt32(b)},readInt8:function(r,b){return A._bin._view(r).getInt8(b)},readShort:function(r,b){return A._bin._view(r).getInt16(b)},readUshort:function(r,b){return A._bin._view(r).getUint16(b)},readUshorts:function(r,b,C){for(var I=[],x=0;x<C;x++)I.push(A._bin.readUshort(r,b+2*x));return I},readUint:function(r,b){return A._bin._view(r).getUint32(b)},readUint64:function(r,b){return 4294967296*A._bin.readUint(r,b)+A._bin.readUint(r,b+4)},readASCII:function(r,A,b){for(var C="",I=0;I<b;I++)C+=String.fromCharCode(r[A+I]);return C},readUnicode:function(r,A,b){for(var C="",I=0;I<b;I++){var x=r[A++]<<8|r[A++];C+=String.fromCharCode(x)}return C},_tdec:"undefined"!=typeof window&&window.TextDecoder?new window.TextDecoder:null,readUTF8:function(r,b,C){var I=A._bin._tdec;return I&&0==b&&C==r.length?I.decode(r):A._bin.readASCII(r,b,C)},readBytes:function(r,A,b){for(var C=[],I=0;I<b;I++)C.push(r[A+I]);return C},readASCIIArray:function(r,A,b){for(var C=[],I=0;I<b;I++)C.push(String.fromCharCode(r[A+I]));return C},_view:function(r){return r._dataView||(r._dataView=r.buffer?new DataView(r.buffer,r.byteOffset,r.byteLength):new DataView(new Uint8Array(r).buffer))}},A._lctf={},A._lctf.parse=function(r,b,C,I,x){var S=A._bin,B={},D=b;S.readFixed(r,b),b+=4;var R=S.readUshort(r,b);b+=2;var F=S.readUshort(r,b);b+=2;var N=S.readUshort(r,b);return b+=2,B.scriptList=A._lctf.readScriptList(r,D+R),B.featureList=A._lctf.readFeatureList(r,D+F),B.lookupList=A._lctf.readLookupList(r,D+N,x),B},A._lctf.readLookupList=function(r,b,C){var I=A._bin,x=b,S=[],B=I.readUshort(r,b);b+=2;for(var D=0;D<B;D++){var R=I.readUshort(r,b);b+=2;var F=A._lctf.readLookupTable(r,x+R,C);S.push(F)}return S},A._lctf.readLookupTable=function(r,b,C){var I=A._bin,x=b,S={tabs:[]};S.ltype=I.readUshort(r,b),b+=2,S.flag=I.readUshort(r,b),b+=2;var B=I.readUshort(r,b);b+=2;for(var D=S.ltype,R=0;R<B;R++){var F=I.readUshort(r,b);b+=2;var N=C(r,D,x+F,S);S.tabs.push(N)}return S},A._lctf.numOfOnes=function(r){for(var A=0,b=0;b<32;b++)0!=(r>>>b&1)&&A++;return A},A._lctf.readClassDef=function(r,b){var C=A._bin,I=[],x=C.readUshort(r,b);if(b+=2,1==x){var S=C.readUshort(r,b);b+=2;var B=C.readUshort(r,b);b+=2;for(var D=0;D<B;D++)I.push(S+D),I.push(S+D),I.push(C.readUshort(r,b)),b+=2}if(2==x){var R=C.readUshort(r,b);for(b+=2,D=0;D<R;D++)I.push(C.readUshort(r,b)),b+=2,I.push(C.readUshort(r,b)),b+=2,I.push(C.readUshort(r,b)),b+=2}return I},A._lctf.getInterval=function(r,A){for(var b=0;b<r.length;b+=3){var C=r[b],I=r[b+1];if(r[b+2],C<=A&&A<=I)return b}return-1},A._lctf.readCoverage=function(r,b){var C=A._bin,I={};I.fmt=C.readUshort(r,b),b+=2;var x=C.readUshort(r,b);return b+=2,1==I.fmt&&(I.tab=C.readUshorts(r,b,x)),2==I.fmt&&(I.tab=C.readUshorts(r,b,3*x)),I},A._lctf.coverageIndex=function(r,b){var C=r.tab;if(1==r.fmt)return C.indexOf(b);if(2==r.fmt){var I=A._lctf.getInterval(C,b);if(-1!=I)return C[I+2]+(b-C[I])}return-1},A._lctf.readFeatureList=function(r,b){var C=A._bin,I=b,x=[],S=C.readUshort(r,b);b+=2;for(var B=0;B<S;B++){var D=C.readASCII(r,b,4);b+=4;var R=C.readUshort(r,b);b+=2;var F=A._lctf.readFeatureTable(r,I+R);F.tag=D.trim(),x.push(F)}return x},A._lctf.readFeatureTable=function(r,b){var C=A._bin,I=b,x={},S=C.readUshort(r,b);b+=2,S>0&&(x.featureParams=I+S);var B=C.readUshort(r,b);b+=2,x.tab=[];for(var D=0;D<B;D++)x.tab.push(C.readUshort(r,b+2*D));return x},A._lctf.readScriptList=function(r,b){var C=A._bin,I=b,x={},S=C.readUshort(r,b);b+=2;for(var B=0;B<S;B++){var D=C.readASCII(r,b,4);b+=4;var R=C.readUshort(r,b);b+=2,x[D.trim()]=A._lctf.readScriptTable(r,I+R)}return x},A._lctf.readScriptTable=function(r,b){var C=A._bin,I=b,x={},S=C.readUshort(r,b);b+=2,S>0&&(x.default=A._lctf.readLangSysTable(r,I+S));var B=C.readUshort(r,b);b+=2;for(var D=0;D<B;D++){var R=C.readASCII(r,b,4);b+=4;var F=C.readUshort(r,b);b+=2,x[R.trim()]=A._lctf.readLangSysTable(r,I+F)}return x},A._lctf.readLangSysTable=function(r,b){var C=A._bin,I={};C.readUshort(r,b),b+=2,I.reqFeature=C.readUshort(r,b),b+=2;var x=C.readUshort(r,b);return b+=2,I.features=C.readUshorts(r,b,x),I},A.CFF={},A.CFF.parse=function(r,b,C){var I=A._bin;(r=new Uint8Array(r.buffer,b,C))[b=0],r[++b],r[++b],r[++b],b++;var x=[];b=A.CFF.readIndex(r,b,x);for(var S=[],B=0;B<x.length-1;B++)S.push(I.readASCII(r,b+x[B],x[B+1]-x[B]));b+=x[x.length-1];var D=[];b=A.CFF.readIndex(r,b,D);var R=[];for(B=0;B<D.length-1;B++)R.push(A.CFF.readDict(r,b+D[B],b+D[B+1]));b+=D[D.length-1];var F=R[0],N=[];b=A.CFF.readIndex(r,b,N);var Q=[];for(B=0;B<N.length-1;B++)Q.push(I.readASCII(r,b+N[B],N[B+1]-N[B]));if(b+=N[N.length-1],A.CFF.readSubrs(r,b,F),F.CharStrings){b=F.CharStrings,N=[],b=A.CFF.readIndex(r,b,N);var H=[];for(B=0;B<N.length-1;B++)H.push(I.readBytes(r,b+N[B],N[B+1]-N[B]));F.CharStrings=H}if(F.ROS){b=F.FDArray;var G=[];for(b=A.CFF.readIndex(r,b,G),F.FDArray=[],B=0;B<G.length-1;B++){var j=A.CFF.readDict(r,b+G[B],b+G[B+1]);A.CFF._readFDict(r,j,Q),F.FDArray.push(j)}b+=G[G.length-1],b=F.FDSelect,F.FDSelect=[];var V=r[b];if(b++,3!=V)throw V;var W=I.readUshort(r,b);for(b+=2,B=0;B<W+1;B++)F.FDSelect.push(I.readUshort(r,b),r[b+2]),b+=3}return F.Encoding&&(F.Encoding=A.CFF.readEncoding(r,F.Encoding,F.CharStrings.length)),F.charset&&(F.charset=A.CFF.readCharset(r,F.charset,F.CharStrings.length)),A.CFF._readFDict(r,F,Q),F},A.CFF._readFDict=function(r,b,C){var I;for(var x in b.Private&&(I=b.Private[1],b.Private=A.CFF.readDict(r,I,I+b.Private[0]),b.Private.Subrs&&A.CFF.readSubrs(r,I+b.Private.Subrs,b.Private)),b)-1!=["FamilyName","FontName","FullName","Notice","version","Copyright"].indexOf(x)&&(b[x]=C[b[x]-426+35])},A.CFF.readSubrs=function(r,b,C){var I=A._bin,x=[];b=A.CFF.readIndex(r,b,x);var S,B=x.length;S=B<1240?107:B<33900?1131:32768,C.Bias=S,C.Subrs=[];for(var D=0;D<x.length-1;D++)C.Subrs.push(I.readBytes(r,b+x[D],x[D+1]-x[D]))},A.CFF.tableSE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,0,111,112,113,114,0,115,116,117,118,119,120,121,122,0,123,0,124,125,126,127,128,129,130,131,0,132,133,0,134,135,136,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,138,0,139,0,0,0,0,140,141,142,143,0,0,0,0,0,144,0,0,0,145,0,0,146,147,148,149,0,0,0,0],A.CFF.glyphByUnicode=function(r,A){for(var b=0;b<r.charset.length;b++)if(r.charset[b]==A)return b;return-1},A.CFF.glyphBySE=function(r,b){return b<0||b>255?-1:A.CFF.glyphByUnicode(r,A.CFF.tableSE[b])},A.CFF.readEncoding=function(r,b,C){A._bin;var I=[".notdef"],x=r[b];if(b++,0!=x)throw"error: unknown encoding format: "+x;var S=r[b];b++;for(var B=0;B<S;B++)I.push(r[b+B]);return I},A.CFF.readCharset=function(r,b,C){var I=A._bin,x=[".notdef"],S=r[b];if(b++,0==S)for(var B=0;B<C;B++){var D=I.readUshort(r,b);b+=2,x.push(D)}else{if(1!=S&&2!=S)throw"error: format: "+S;for(;x.length<C;){D=I.readUshort(r,b),b+=2;var R=0;for(1==S?(R=r[b],b++):(R=I.readUshort(r,b),b+=2),B=0;B<=R;B++)x.push(D),D++}}return x},A.CFF.readIndex=function(r,b,C){var I=A._bin,x=I.readUshort(r,b)+1,S=r[b+=2];if(b++,1==S)for(var B=0;B<x;B++)C.push(r[b+B]);else if(2==S)for(B=0;B<x;B++)C.push(I.readUshort(r,b+2*B));else if(3==S)for(B=0;B<x;B++)C.push(16777215&I.readUint(r,b+3*B-1));else if(1!=x)throw"unsupported offset size: "+S+", count: "+x;return(b+=x*S)-1},A.CFF.getCharString=function(r,b,C){var I=A._bin,x=r[b],S=r[b+1];r[b+2],r[b+3],r[b+4];var B=1,D=null,R=null;x<=20&&(D=x,B=1),12==x&&(D=100*x+S,B=2),21<=x&&x<=27&&(D=x,B=1),28==x&&(R=I.readShort(r,b+1),B=3),29<=x&&x<=31&&(D=x,B=1),32<=x&&x<=246&&(R=x-139,B=1),247<=x&&x<=250&&(R=256*(x-247)+S+108,B=2),251<=x&&x<=254&&(R=256*-(x-251)-S-108,B=2),255==x&&(R=I.readInt(r,b+1)/65535,B=5),C.val=null!=R?R:"o"+D,C.size=B},A.CFF.readCharString=function(r,b,C){for(var I=b+C,x=A._bin,S=[];b<I;){var B=r[b],D=r[b+1];r[b+2],r[b+3],r[b+4];var R=1,F=null,N=null;B<=20&&(F=B,R=1),12==B&&(F=100*B+D,R=2),19!=B&&20!=B||(F=B,R=2),21<=B&&B<=27&&(F=B,R=1),28==B&&(N=x.readShort(r,b+1),R=3),29<=B&&B<=31&&(F=B,R=1),32<=B&&B<=246&&(N=B-139,R=1),247<=B&&B<=250&&(N=256*(B-247)+D+108,R=2),251<=B&&B<=254&&(N=256*-(B-251)-D-108,R=2),255==B&&(N=x.readInt(r,b+1)/65535,R=5),S.push(null!=N?N:"o"+F),b+=R}return S},A.CFF.readDict=function(r,b,C){for(var I=A._bin,x={},S=[];b<C;){var B=r[b],D=r[b+1];r[b+2],r[b+3],r[b+4];var R=1,F=null,N=null;if(28==B&&(N=I.readShort(r,b+1),R=3),29==B&&(N=I.readInt(r,b+1),R=5),32<=B&&B<=246&&(N=B-139,R=1),247<=B&&B<=250&&(N=256*(B-247)+D+108,R=2),251<=B&&B<=254&&(N=256*-(B-251)-D-108,R=2),255==B)throw N=I.readInt(r,b+1)/65535,R=5,"unknown number";if(30==B){var Q=[];for(R=1;;){var H=r[b+R];R++;var G=H>>4,j=15&H;if(15!=G&&Q.push(G),15!=j&&Q.push(j),15==j)break}for(var V="",W=[0,1,2,3,4,5,6,7,8,9,".","e","e-","reserved","-","endOfNumber"],X=0;X<Q.length;X++)V+=W[Q[X]];N=parseFloat(V)}B<=21&&(F=["version","Notice","FullName","FamilyName","Weight","FontBBox","BlueValues","OtherBlues","FamilyBlues","FamilyOtherBlues","StdHW","StdVW","escape","UniqueID","XUID","charset","Encoding","CharStrings","Private","Subrs","defaultWidthX","nominalWidthX"][B],R=1,12==B&&(F=["Copyright","isFixedPitch","ItalicAngle","UnderlinePosition","UnderlineThickness","PaintType","CharstringType","FontMatrix","StrokeWidth","BlueScale","BlueShift","BlueFuzz","StemSnapH","StemSnapV","ForceBold",0,0,"LanguageGroup","ExpansionFactor","initialRandomSeed","SyntheticBase","PostScript","BaseFontName","BaseFontBlend",0,0,0,0,0,0,"ROS","CIDFontVersion","CIDFontRevision","CIDFontType","CIDCount","UIDBase","FDArray","FDSelect","FontName"][D],R=2)),null!=F?(x[F]=1==S.length?S[0]:S,S=[]):S.push(N),b+=R}return x},A.cmap={},A.cmap.parse=function(r,b,C){r=new Uint8Array(r.buffer,b,C),b=0;var I=A._bin,x={};I.readUshort(r,b),b+=2;var S=I.readUshort(r,b);b+=2;var B=[];x.tables=[];for(var D=0;D<S;D++){var R=I.readUshort(r,b);b+=2;var F=I.readUshort(r,b);b+=2;var N=I.readUint(r,b);b+=4;var Q="p"+R+"e"+F,H=B.indexOf(N);if(-1==H){var G;H=x.tables.length,B.push(N);var j=I.readUshort(r,N);0==j?G=A.cmap.parse0(r,N):4==j?G=A.cmap.parse4(r,N):6==j?G=A.cmap.parse6(r,N):12==j?G=A.cmap.parse12(r,N):console.debug("unknown format: "+j,R,F,N),x.tables.push(G)}if(null!=x[Q])throw"multiple tables for one platform+encoding";x[Q]=H}return x},A.cmap.parse0=function(r,b){var C=A._bin,I={};I.format=C.readUshort(r,b),b+=2;var x=C.readUshort(r,b);b+=2,C.readUshort(r,b),b+=2,I.map=[];for(var S=0;S<x-6;S++)I.map.push(r[b+S]);return I},A.cmap.parse4=function(r,b){var C=A._bin,I=b,x={};x.format=C.readUshort(r,b),b+=2;var S=C.readUshort(r,b);b+=2,C.readUshort(r,b),b+=2;var B=C.readUshort(r,b);b+=2;var D=B/2;x.searchRange=C.readUshort(r,b),b+=2,x.entrySelector=C.readUshort(r,b),b+=2,x.rangeShift=C.readUshort(r,b),b+=2,x.endCount=C.readUshorts(r,b,D),b+=2*D,b+=2,x.startCount=C.readUshorts(r,b,D),b+=2*D,x.idDelta=[];for(var R=0;R<D;R++)x.idDelta.push(C.readShort(r,b)),b+=2;for(x.idRangeOffset=C.readUshorts(r,b,D),b+=2*D,x.glyphIdArray=[];b<I+S;)x.glyphIdArray.push(C.readUshort(r,b)),b+=2;return x},A.cmap.parse6=function(r,b){var C=A._bin,I={};I.format=C.readUshort(r,b),b+=2,C.readUshort(r,b),b+=2,C.readUshort(r,b),b+=2,I.firstCode=C.readUshort(r,b),b+=2;var x=C.readUshort(r,b);b+=2,I.glyphIdArray=[];for(var S=0;S<x;S++)I.glyphIdArray.push(C.readUshort(r,b)),b+=2;return I},A.cmap.parse12=function(r,b){var C=A._bin,I={};I.format=C.readUshort(r,b),b+=2,b+=2,C.readUint(r,b),b+=4,C.readUint(r,b),b+=4;var x=C.readUint(r,b);b+=4,I.groups=[];for(var S=0;S<x;S++){var B=b+12*S,D=C.readUint(r,B+0),R=C.readUint(r,B+4),F=C.readUint(r,B+8);I.groups.push([D,R,F])}return I},A.glyf={},A.glyf.parse=function(r,A,b,C){for(var I=[],x=0;x<C.maxp.numGlyphs;x++)I.push(null);return I},A.glyf._parseGlyf=function(r,b){var C=A._bin,I=r._data,x=A._tabOffset(I,"glyf",r._offset)+r.loca[b];if(r.loca[b]==r.loca[b+1])return null;var S={};if(S.noc=C.readShort(I,x),x+=2,S.xMin=C.readShort(I,x),x+=2,S.yMin=C.readShort(I,x),x+=2,S.xMax=C.readShort(I,x),x+=2,S.yMax=C.readShort(I,x),x+=2,S.xMin>=S.xMax||S.yMin>=S.yMax)return null;if(S.noc>0){S.endPts=[];for(var B=0;B<S.noc;B++)S.endPts.push(C.readUshort(I,x)),x+=2;var D=C.readUshort(I,x);if(x+=2,I.length-x<D)return null;S.instructions=C.readBytes(I,x,D),x+=D;var R=S.endPts[S.noc-1]+1;for(S.flags=[],B=0;B<R;B++){var F=I[x];if(x++,S.flags.push(F),0!=(8&F)){var N=I[x];x++;for(var Q=0;Q<N;Q++)S.flags.push(F),B++}}for(S.xs=[],B=0;B<R;B++){var H=0!=(2&S.flags[B]),G=0!=(16&S.flags[B]);H?(S.xs.push(G?I[x]:-I[x]),x++):G?S.xs.push(0):(S.xs.push(C.readShort(I,x)),x+=2)}for(S.ys=[],B=0;B<R;B++)H=0!=(4&S.flags[B]),G=0!=(32&S.flags[B]),H?(S.ys.push(G?I[x]:-I[x]),x++):G?S.ys.push(0):(S.ys.push(C.readShort(I,x)),x+=2);var j=0,V=0;for(B=0;B<R;B++)j+=S.xs[B],V+=S.ys[B],S.xs[B]=j,S.ys[B]=V}else{var W;S.parts=[];do{W=C.readUshort(I,x),x+=2;var X={m:{a:1,b:0,c:0,d:1,tx:0,ty:0},p1:-1,p2:-1};if(S.parts.push(X),X.glyphIndex=C.readUshort(I,x),x+=2,1&W){var Y=C.readShort(I,x);x+=2;var K=C.readShort(I,x);x+=2}else Y=C.readInt8(I,x),x++,K=C.readInt8(I,x),x++;2&W?(X.m.tx=Y,X.m.ty=K):(X.p1=Y,X.p2=K),8&W?(X.m.a=X.m.d=C.readF2dot14(I,x),x+=2):64&W?(X.m.a=C.readF2dot14(I,x),x+=2,X.m.d=C.readF2dot14(I,x),x+=2):128&W&&(X.m.a=C.readF2dot14(I,x),x+=2,X.m.b=C.readF2dot14(I,x),x+=2,X.m.c=C.readF2dot14(I,x),x+=2,X.m.d=C.readF2dot14(I,x),x+=2)}while(32&W);if(256&W){var q=C.readUshort(I,x);for(x+=2,S.instr=[],B=0;B<q;B++)S.instr.push(I[x]),x++}}return S},A.GDEF={},A.GDEF.parse=function(r,b,C,I){var x=b;b+=4;var S=A._bin.readUshort(r,b);return{glyphClassDef:0===S?null:A._lctf.readClassDef(r,x+S)}},A.GPOS={},A.GPOS.parse=function(r,b,C,I){return A._lctf.parse(r,b,C,I,A.GPOS.subt)},A.GPOS.subt=function(r,b,C,I){var x=A._bin,S=C,B={};if(B.fmt=x.readUshort(r,C),C+=2,1==b||2==b||3==b||7==b||8==b&&B.fmt<=2){var D=x.readUshort(r,C);C+=2,B.coverage=A._lctf.readCoverage(r,D+S)}if(1==b&&1==B.fmt){var R=x.readUshort(r,C);C+=2,0!=R&&(B.pos=A.GPOS.readValueRecord(r,C,R))}else if(2==b&&B.fmt>=1&&B.fmt<=2){R=x.readUshort(r,C),C+=2;var F=x.readUshort(r,C);C+=2;var N=A._lctf.numOfOnes(R),Q=A._lctf.numOfOnes(F);if(1==B.fmt){B.pairsets=[];var H=x.readUshort(r,C);C+=2;for(var G=0;G<H;G++){var j=S+x.readUshort(r,C);C+=2;var V=x.readUshort(r,j);j+=2;for(var W=[],X=0;X<V;X++){var Y=x.readUshort(r,j);j+=2,0!=R&&(ee=A.GPOS.readValueRecord(r,j,R),j+=2*N),0!=F&&(te=A.GPOS.readValueRecord(r,j,F),j+=2*Q),W.push({gid2:Y,val1:ee,val2:te})}B.pairsets.push(W)}}if(2==B.fmt){var K=x.readUshort(r,C);C+=2;var q=x.readUshort(r,C);C+=2;var Z=x.readUshort(r,C);C+=2;var J=x.readUshort(r,C);for(C+=2,B.classDef1=A._lctf.readClassDef(r,S+K),B.classDef2=A._lctf.readClassDef(r,S+q),B.matrix=[],G=0;G<Z;G++){var $=[];for(X=0;X<J;X++){var ee=null,te=null;0!=R&&(ee=A.GPOS.readValueRecord(r,C,R),C+=2*N),0!=F&&(te=A.GPOS.readValueRecord(r,C,F),C+=2*Q),$.push({val1:ee,val2:te})}B.matrix.push($)}}}else if(4==b&&1==B.fmt)B.markCoverage=A._lctf.readCoverage(r,x.readUshort(r,C)+S),B.baseCoverage=A._lctf.readCoverage(r,x.readUshort(r,C+2)+S),B.markClassCount=x.readUshort(r,C+4),B.markArray=A.GPOS.readMarkArray(r,x.readUshort(r,C+6)+S),B.baseArray=A.GPOS.readBaseArray(r,x.readUshort(r,C+8)+S,B.markClassCount);else if(6==b&&1==B.fmt)B.mark1Coverage=A._lctf.readCoverage(r,x.readUshort(r,C)+S),B.mark2Coverage=A._lctf.readCoverage(r,x.readUshort(r,C+2)+S),B.markClassCount=x.readUshort(r,C+4),B.mark1Array=A.GPOS.readMarkArray(r,x.readUshort(r,C+6)+S),B.mark2Array=A.GPOS.readBaseArray(r,x.readUshort(r,C+8)+S,B.markClassCount);else{if(9==b&&1==B.fmt){var se=x.readUshort(r,C);C+=2;var ie=x.readUint(r,C);if(C+=4,9==I.ltype)I.ltype=se;else if(I.ltype!=se)throw"invalid extension substitution";return A.GPOS.subt(r,I.ltype,S+ie)}console.debug("unsupported GPOS table LookupType",b,"format",B.fmt)}return B},A.GPOS.readValueRecord=function(r,b,C){var I=A._bin,x=[];return x.push(1&C?I.readShort(r,b):0),b+=1&C?2:0,x.push(2&C?I.readShort(r,b):0),b+=2&C?2:0,x.push(4&C?I.readShort(r,b):0),b+=4&C?2:0,x.push(8&C?I.readShort(r,b):0),b+=8&C?2:0,x},A.GPOS.readBaseArray=function(r,b,C){var I=A._bin,x=[],S=b,B=I.readUshort(r,b);b+=2;for(var D=0;D<B;D++){for(var R=[],F=0;F<C;F++)R.push(A.GPOS.readAnchorRecord(r,S+I.readUshort(r,b))),b+=2;x.push(R)}return x},A.GPOS.readMarkArray=function(r,b){var C=A._bin,I=[],x=b,S=C.readUshort(r,b);b+=2;for(var B=0;B<S;B++){var D=A.GPOS.readAnchorRecord(r,C.readUshort(r,b+2)+x);D.markClass=C.readUshort(r,b),I.push(D),b+=4}return I},A.GPOS.readAnchorRecord=function(r,b){var C=A._bin,I={};return I.fmt=C.readUshort(r,b),I.x=C.readShort(r,b+2),I.y=C.readShort(r,b+4),I},A.GSUB={},A.GSUB.parse=function(r,b,C,I){return A._lctf.parse(r,b,C,I,A.GSUB.subt)},A.GSUB.subt=function(r,b,C,I){var x=A._bin,S=C,B={};if(B.fmt=x.readUshort(r,C),C+=2,1!=b&&2!=b&&4!=b&&5!=b&&6!=b)return null;if(1==b||2==b||4==b||5==b&&B.fmt<=2||6==b&&B.fmt<=2){var D=x.readUshort(r,C);C+=2,B.coverage=A._lctf.readCoverage(r,S+D)}if(1==b&&B.fmt>=1&&B.fmt<=2){if(1==B.fmt)B.delta=x.readShort(r,C),C+=2;else if(2==B.fmt){var R=x.readUshort(r,C);C+=2,B.newg=x.readUshorts(r,C,R),C+=2*B.newg.length}}else if(2==b&&1==B.fmt){R=x.readUshort(r,C),C+=2,B.seqs=[];for(var F=0;F<R;F++){var N=x.readUshort(r,C)+S;C+=2;var Q=x.readUshort(r,N);B.seqs.push(x.readUshorts(r,N+2,Q))}}else if(4==b)for(B.vals=[],R=x.readUshort(r,C),C+=2,F=0;F<R;F++){var H=x.readUshort(r,C);C+=2,B.vals.push(A.GSUB.readLigatureSet(r,S+H))}else if(5==b&&2==B.fmt){if(2==B.fmt){var G=x.readUshort(r,C);C+=2,B.cDef=A._lctf.readClassDef(r,S+G),B.scset=[];var j=x.readUshort(r,C);for(C+=2,F=0;F<j;F++){var V=x.readUshort(r,C);C+=2,B.scset.push(0==V?null:A.GSUB.readSubClassSet(r,S+V))}}}else if(6==b&&3==B.fmt){if(3==B.fmt){for(F=0;F<3;F++){R=x.readUshort(r,C),C+=2;for(var W=[],X=0;X<R;X++)W.push(A._lctf.readCoverage(r,S+x.readUshort(r,C+2*X)));C+=2*R,0==F&&(B.backCvg=W),1==F&&(B.inptCvg=W),2==F&&(B.ahedCvg=W)}R=x.readUshort(r,C),C+=2,B.lookupRec=A.GSUB.readSubstLookupRecords(r,C,R)}}else{if(7==b&&1==B.fmt){var Y=x.readUshort(r,C);C+=2;var K=x.readUint(r,C);if(C+=4,9==I.ltype)I.ltype=Y;else if(I.ltype!=Y)throw"invalid extension substitution";return A.GSUB.subt(r,I.ltype,S+K)}console.debug("unsupported GSUB table LookupType",b,"format",B.fmt)}return B},A.GSUB.readSubClassSet=function(r,b){var C=A._bin.readUshort,I=b,x=[],S=C(r,b);b+=2;for(var B=0;B<S;B++){var D=C(r,b);b+=2,x.push(A.GSUB.readSubClassRule(r,I+D))}return x},A.GSUB.readSubClassRule=function(r,b){var C=A._bin.readUshort,I={},x=C(r,b),S=C(r,b+=2);b+=2,I.input=[];for(var B=0;B<x-1;B++)I.input.push(C(r,b)),b+=2;return I.substLookupRecords=A.GSUB.readSubstLookupRecords(r,b,S),I},A.GSUB.readSubstLookupRecords=function(r,b,C){for(var I=A._bin.readUshort,x=[],S=0;S<C;S++)x.push(I(r,b),I(r,b+2)),b+=4;return x},A.GSUB.readChainSubClassSet=function(r,b){var C=A._bin,I=b,x=[],S=C.readUshort(r,b);b+=2;for(var B=0;B<S;B++){var D=C.readUshort(r,b);b+=2,x.push(A.GSUB.readChainSubClassRule(r,I+D))}return x},A.GSUB.readChainSubClassRule=function(r,b){for(var C=A._bin,I={},x=["backtrack","input","lookahead"],S=0;S<x.length;S++){var B=C.readUshort(r,b);b+=2,1==S&&B--,I[x[S]]=C.readUshorts(r,b,B),b+=2*I[x[S]].length}return B=C.readUshort(r,b),b+=2,I.subst=C.readUshorts(r,b,2*B),b+=2*I.subst.length,I},A.GSUB.readLigatureSet=function(r,b){var C=A._bin,I=b,x=[],S=C.readUshort(r,b);b+=2;for(var B=0;B<S;B++){var D=C.readUshort(r,b);b+=2,x.push(A.GSUB.readLigature(r,I+D))}return x},A.GSUB.readLigature=function(r,b){var C=A._bin,I={chain:[]};I.nglyph=C.readUshort(r,b),b+=2;var x=C.readUshort(r,b);b+=2;for(var S=0;S<x-1;S++)I.chain.push(C.readUshort(r,b)),b+=2;return I},A.head={},A.head.parse=function(r,b,C){var I=A._bin,x={};return I.readFixed(r,b),b+=4,x.fontRevision=I.readFixed(r,b),b+=4,I.readUint(r,b),b+=4,I.readUint(r,b),b+=4,x.flags=I.readUshort(r,b),b+=2,x.unitsPerEm=I.readUshort(r,b),b+=2,x.created=I.readUint64(r,b),b+=8,x.modified=I.readUint64(r,b),b+=8,x.xMin=I.readShort(r,b),b+=2,x.yMin=I.readShort(r,b),b+=2,x.xMax=I.readShort(r,b),b+=2,x.yMax=I.readShort(r,b),b+=2,x.macStyle=I.readUshort(r,b),b+=2,x.lowestRecPPEM=I.readUshort(r,b),b+=2,x.fontDirectionHint=I.readShort(r,b),b+=2,x.indexToLocFormat=I.readShort(r,b),b+=2,x.glyphDataFormat=I.readShort(r,b),b+=2,x},A.hhea={},A.hhea.parse=function(r,b,C){var I=A._bin,x={};return I.readFixed(r,b),b+=4,x.ascender=I.readShort(r,b),b+=2,x.descender=I.readShort(r,b),b+=2,x.lineGap=I.readShort(r,b),b+=2,x.advanceWidthMax=I.readUshort(r,b),b+=2,x.minLeftSideBearing=I.readShort(r,b),b+=2,x.minRightSideBearing=I.readShort(r,b),b+=2,x.xMaxExtent=I.readShort(r,b),b+=2,x.caretSlopeRise=I.readShort(r,b),b+=2,x.caretSlopeRun=I.readShort(r,b),b+=2,x.caretOffset=I.readShort(r,b),b+=2,b+=8,x.metricDataFormat=I.readShort(r,b),b+=2,x.numberOfHMetrics=I.readUshort(r,b),b+=2,x},A.hmtx={},A.hmtx.parse=function(r,b,C,I){for(var x=A._bin,S={aWidth:[],lsBearing:[]},B=0,D=0,R=0;R<I.maxp.numGlyphs;R++)R<I.hhea.numberOfHMetrics&&(B=x.readUshort(r,b),b+=2,D=x.readShort(r,b),b+=2),S.aWidth.push(B),S.lsBearing.push(D);return S},A.kern={},A.kern.parse=function(r,b,C,I){var x=A._bin,S=x.readUshort(r,b);if(b+=2,1==S)return A.kern.parseV1(r,b-2,C,I);var B=x.readUshort(r,b);b+=2;for(var D={glyph1:[],rval:[]},R=0;R<B;R++){b+=2,C=x.readUshort(r,b),b+=2;var F=x.readUshort(r,b);b+=2;var N=F>>>8;if(0!=(N&=15))throw"unknown kern table format: "+N;b=A.kern.readFormat0(r,b,D)}return D},A.kern.parseV1=function(r,b,C,I){var x=A._bin;x.readFixed(r,b),b+=4;var S=x.readUint(r,b);b+=4;for(var B={glyph1:[],rval:[]},D=0;D<S;D++){x.readUint(r,b),b+=4;var R=x.readUshort(r,b);b+=2,x.readUshort(r,b),b+=2;var F=R>>>8;if(0!=(F&=15))throw"unknown kern table format: "+F;b=A.kern.readFormat0(r,b,B)}return B},A.kern.readFormat0=function(r,b,C){var I=A._bin,x=-1,S=I.readUshort(r,b);b+=2,I.readUshort(r,b),b+=2,I.readUshort(r,b),b+=2,I.readUshort(r,b),b+=2;for(var B=0;B<S;B++){var D=I.readUshort(r,b);b+=2;var R=I.readUshort(r,b);b+=2;var F=I.readShort(r,b);b+=2,D!=x&&(C.glyph1.push(D),C.rval.push({glyph2:[],vals:[]}));var N=C.rval[C.rval.length-1];N.glyph2.push(R),N.vals.push(F),x=D}return b},A.loca={},A.loca.parse=function(r,b,C,I){var x=A._bin,S=[],B=I.head.indexToLocFormat,D=I.maxp.numGlyphs+1;if(0==B)for(var R=0;R<D;R++)S.push(x.readUshort(r,b+(R<<1))<<1);if(1==B)for(R=0;R<D;R++)S.push(x.readUint(r,b+(R<<2)));return S},A.maxp={},A.maxp.parse=function(r,b,C){var I=A._bin,x={},S=I.readUint(r,b);return b+=4,x.numGlyphs=I.readUshort(r,b),b+=2,65536==S&&(x.maxPoints=I.readUshort(r,b),b+=2,x.maxContours=I.readUshort(r,b),b+=2,x.maxCompositePoints=I.readUshort(r,b),b+=2,x.maxCompositeContours=I.readUshort(r,b),b+=2,x.maxZones=I.readUshort(r,b),b+=2,x.maxTwilightPoints=I.readUshort(r,b),b+=2,x.maxStorage=I.readUshort(r,b),b+=2,x.maxFunctionDefs=I.readUshort(r,b),b+=2,x.maxInstructionDefs=I.readUshort(r,b),b+=2,x.maxStackElements=I.readUshort(r,b),b+=2,x.maxSizeOfInstructions=I.readUshort(r,b),b+=2,x.maxComponentElements=I.readUshort(r,b),b+=2,x.maxComponentDepth=I.readUshort(r,b),b+=2),x},A.name={},A.name.parse=function(r,b,C){var I=A._bin,x={};I.readUshort(r,b),b+=2;var S=I.readUshort(r,b);b+=2,I.readUshort(r,b);for(var B,D=["copyright","fontFamily","fontSubfamily","ID","fullName","version","postScriptName","trademark","manufacturer","designer","description","urlVendor","urlDesigner","licence","licenceURL","---","typoFamilyName","typoSubfamilyName","compatibleFull","sampleText","postScriptCID","wwsFamilyName","wwsSubfamilyName","lightPalette","darkPalette"],R=b+=2,F=0;F<S;F++){var N=I.readUshort(r,b);b+=2;var Q=I.readUshort(r,b);b+=2;var H=I.readUshort(r,b);b+=2;var G=I.readUshort(r,b);b+=2;var j=I.readUshort(r,b);b+=2;var V=I.readUshort(r,b);b+=2;var W,X=D[G],Y=R+12*S+V;if(0==N)W=I.readUnicode(r,Y,j/2);else if(3==N&&0==Q)W=I.readUnicode(r,Y,j/2);else if(0==Q)W=I.readASCII(r,Y,j);else if(1==Q)W=I.readUnicode(r,Y,j/2);else if(3==Q)W=I.readUnicode(r,Y,j/2);else{if(1!=N)throw"unknown encoding "+Q+", platformID: "+N;W=I.readASCII(r,Y,j),console.debug("reading unknown MAC encoding "+Q+" as ASCII")}var K="p"+N+","+H.toString(16);null==x[K]&&(x[K]={}),x[K][void 0!==X?X:G]=W,x[K]._lang=H}for(var q in x)if(null!=x[q].postScriptName&&1033==x[q]._lang)return x[q];for(var q in x)if(null!=x[q].postScriptName&&0==x[q]._lang)return x[q];for(var q in x)if(null!=x[q].postScriptName&&3084==x[q]._lang)return x[q];for(var q in x)if(null!=x[q].postScriptName)return x[q];for(var q in x){B=q;break}return console.debug("returning name table with languageID "+x[B]._lang),x[B]},A["OS/2"]={},A["OS/2"].parse=function(r,b,C){var I=A._bin.readUshort(r,b);b+=2;var x={};if(0==I)A["OS/2"].version0(r,b,x);else if(1==I)A["OS/2"].version1(r,b,x);else if(2==I||3==I||4==I)A["OS/2"].version2(r,b,x);else{if(5!=I)throw"unknown OS/2 table version: "+I;A["OS/2"].version5(r,b,x)}return x},A["OS/2"].version0=function(r,b,C){var I=A._bin;return C.xAvgCharWidth=I.readShort(r,b),b+=2,C.usWeightClass=I.readUshort(r,b),b+=2,C.usWidthClass=I.readUshort(r,b),b+=2,C.fsType=I.readUshort(r,b),b+=2,C.ySubscriptXSize=I.readShort(r,b),b+=2,C.ySubscriptYSize=I.readShort(r,b),b+=2,C.ySubscriptXOffset=I.readShort(r,b),b+=2,C.ySubscriptYOffset=I.readShort(r,b),b+=2,C.ySuperscriptXSize=I.readShort(r,b),b+=2,C.ySuperscriptYSize=I.readShort(r,b),b+=2,C.ySuperscriptXOffset=I.readShort(r,b),b+=2,C.ySuperscriptYOffset=I.readShort(r,b),b+=2,C.yStrikeoutSize=I.readShort(r,b),b+=2,C.yStrikeoutPosition=I.readShort(r,b),b+=2,C.sFamilyClass=I.readShort(r,b),b+=2,C.panose=I.readBytes(r,b,10),b+=10,C.ulUnicodeRange1=I.readUint(r,b),b+=4,C.ulUnicodeRange2=I.readUint(r,b),b+=4,C.ulUnicodeRange3=I.readUint(r,b),b+=4,C.ulUnicodeRange4=I.readUint(r,b),b+=4,C.achVendID=[I.readInt8(r,b),I.readInt8(r,b+1),I.readInt8(r,b+2),I.readInt8(r,b+3)],b+=4,C.fsSelection=I.readUshort(r,b),b+=2,C.usFirstCharIndex=I.readUshort(r,b),b+=2,C.usLastCharIndex=I.readUshort(r,b),b+=2,C.sTypoAscender=I.readShort(r,b),b+=2,C.sTypoDescender=I.readShort(r,b),b+=2,C.sTypoLineGap=I.readShort(r,b),b+=2,C.usWinAscent=I.readUshort(r,b),b+=2,C.usWinDescent=I.readUshort(r,b),b+2},A["OS/2"].version1=function(r,b,C){var I=A._bin;return b=A["OS/2"].version0(r,b,C),C.ulCodePageRange1=I.readUint(r,b),b+=4,C.ulCodePageRange2=I.readUint(r,b),b+4},A["OS/2"].version2=function(r,b,C){var I=A._bin;return b=A["OS/2"].version1(r,b,C),C.sxHeight=I.readShort(r,b),b+=2,C.sCapHeight=I.readShort(r,b),b+=2,C.usDefault=I.readUshort(r,b),b+=2,C.usBreak=I.readUshort(r,b),b+=2,C.usMaxContext=I.readUshort(r,b),b+2},A["OS/2"].version5=function(r,b,C){var I=A._bin;return b=A["OS/2"].version2(r,b,C),C.usLowerOpticalPointSize=I.readUshort(r,b),b+=2,C.usUpperOpticalPointSize=I.readUshort(r,b),b+2},A.post={},A.post.parse=function(r,b,C){var I=A._bin,x={};return x.version=I.readFixed(r,b),b+=4,x.italicAngle=I.readFixed(r,b),b+=4,x.underlinePosition=I.readShort(r,b),b+=2,x.underlineThickness=I.readShort(r,b),b+=2,x},null==A&&(A={}),null==A.U&&(A.U={}),A.U.codeToGlyph=function(r,A){var b=r.cmap,C=-1;if(null!=b.p0e4?C=b.p0e4:null!=b.p3e1?C=b.p3e1:null!=b.p1e0?C=b.p1e0:null!=b.p0e3&&(C=b.p0e3),-1==C)throw"no familiar platform and encoding!";var I=b.tables[C];if(0==I.format)return A>=I.map.length?0:I.map[A];if(4==I.format){for(var x=-1,S=0;S<I.endCount.length;S++)if(A<=I.endCount[S]){x=S;break}return-1==x||I.startCount[x]>A?0:65535&(0!=I.idRangeOffset[x]?I.glyphIdArray[A-I.startCount[x]+(I.idRangeOffset[x]>>1)-(I.idRangeOffset.length-x)]:A+I.idDelta[x])}if(12==I.format){if(A>I.groups[I.groups.length-1][1])return 0;for(S=0;S<I.groups.length;S++){var B=I.groups[S];if(B[0]<=A&&A<=B[1])return B[2]+(A-B[0])}return 0}throw"unknown cmap table format "+I.format},A.U.glyphToPath=function(r,b){var C={cmds:[],crds:[]};if(r.SVG&&r.SVG.entries[b]){var I=r.SVG.entries[b];return null==I?C:("string"==typeof I&&(I=A.SVG.toPath(I),r.SVG.entries[b]=I),I)}if(r.CFF){var x={x:0,y:0,stack:[],nStems:0,haveWidth:!1,width:r.CFF.Private?r.CFF.Private.defaultWidthX:0,open:!1},S=r.CFF,B=r.CFF.Private;if(S.ROS){for(var D=0;S.FDSelect[D+2]<=b;)D+=2;B=S.FDArray[S.FDSelect[D+1]].Private}A.U._drawCFF(r.CFF.CharStrings[b],x,S,B,C)}else r.glyf&&A.U._drawGlyf(b,r,C);return C},A.U._drawGlyf=function(r,b,C){var I=b.glyf[r];null==I&&(I=b.glyf[r]=A.glyf._parseGlyf(b,r)),null!=I&&(I.noc>-1?A.U._simpleGlyph(I,C):A.U._compoGlyph(I,b,C))},A.U._simpleGlyph=function(r,b){for(var C=0;C<r.noc;C++){for(var I=0==C?0:r.endPts[C-1]+1,x=r.endPts[C],S=I;S<=x;S++){var B=S==I?x:S-1,D=S==x?I:S+1,R=1&r.flags[S],F=1&r.flags[B],N=1&r.flags[D],Q=r.xs[S],H=r.ys[S];if(S==I)if(R){if(!F){A.U.P.moveTo(b,Q,H);continue}A.U.P.moveTo(b,r.xs[B],r.ys[B])}else F?A.U.P.moveTo(b,r.xs[B],r.ys[B]):A.U.P.moveTo(b,(r.xs[B]+Q)/2,(r.ys[B]+H)/2);R?F&&A.U.P.lineTo(b,Q,H):N?A.U.P.qcurveTo(b,Q,H,r.xs[D],r.ys[D]):A.U.P.qcurveTo(b,Q,H,(Q+r.xs[D])/2,(H+r.ys[D])/2)}A.U.P.closePath(b)}},A.U._compoGlyph=function(r,b,C){for(var I=0;I<r.parts.length;I++){var x={cmds:[],crds:[]},S=r.parts[I];A.U._drawGlyf(S.glyphIndex,b,x);for(var B=S.m,D=0;D<x.crds.length;D+=2){var R=x.crds[D],F=x.crds[D+1];C.crds.push(R*B.a+F*B.b+B.tx),C.crds.push(R*B.c+F*B.d+B.ty)}for(D=0;D<x.cmds.length;D++)C.cmds.push(x.cmds[D])}},A.U._getGlyphClass=function(r,b){var C=A._lctf.getInterval(b,r);return-1==C?0:b[C+2]},A.U._applySubs=function(r,b,C,I){for(var x=r.length-b-1,S=0;S<C.tabs.length;S++)if(null!=C.tabs[S]){var B,D=C.tabs[S];if(!D.coverage||-1!=(B=A._lctf.coverageIndex(D.coverage,r[b])))if(1==C.ltype)r[b],1==D.fmt?r[b]=r[b]+D.delta:r[b]=D.newg[B];else if(4==C.ltype)for(var R=D.vals[B],F=0;F<R.length;F++){var N=R[F],Q=N.chain.length;if(!(Q>x)){for(var H=!0,G=0,j=0;j<Q;j++){for(;-1==r[b+G+(1+j)];)G++;N.chain[j]!=r[b+G+(1+j)]&&(H=!1)}if(H){for(r[b]=N.nglyph,j=0;j<Q+G;j++)r[b+j+1]=-1;break}}}else if(5==C.ltype&&2==D.fmt)for(var V=A._lctf.getInterval(D.cDef,r[b]),W=D.cDef[V+2],X=D.scset[W],Y=0;Y<X.length;Y++){var K=X[Y],q=K.input;if(!(q.length>x)){for(H=!0,j=0;j<q.length;j++){var Z=A._lctf.getInterval(D.cDef,r[b+1+j]);if(-1==V&&D.cDef[Z+2]!=q[j]){H=!1;break}}if(H){var J=K.substLookupRecords;for(F=0;F<J.length;F+=2)J[F],J[F+1]}}}else if(6==C.ltype&&3==D.fmt){if(!A.U._glsCovered(r,D.backCvg,b-D.backCvg.length))continue;if(!A.U._glsCovered(r,D.inptCvg,b))continue;if(!A.U._glsCovered(r,D.ahedCvg,b+D.inptCvg.length))continue;var $=D.lookupRec;for(Y=0;Y<$.length;Y+=2){V=$[Y];var ee=I[$[Y+1]];A.U._applySubs(r,b+V,ee,I)}}}},A.U._glsCovered=function(r,b,C){for(var I=0;I<b.length;I++)if(-1==A._lctf.coverageIndex(b[I],r[C+I]))return!1;return!0},A.U.glyphsToPath=function(r,b,C){for(var I={cmds:[],crds:[]},x=0,S=0;S<b.length;S++){var B=b[S];if(-1!=B){for(var D=S<b.length-1&&-1!=b[S+1]?b[S+1]:0,R=A.U.glyphToPath(r,B),F=0;F<R.crds.length;F+=2)I.crds.push(R.crds[F]+x),I.crds.push(R.crds[F+1]);for(C&&I.cmds.push(C),F=0;F<R.cmds.length;F++)I.cmds.push(R.cmds[F]);C&&I.cmds.push("X"),x+=r.hmtx.aWidth[B],S<b.length-1&&(x+=A.U.getPairAdjustment(r,B,D))}}return I},A.U.P={},A.U.P.moveTo=function(r,A,b){r.cmds.push("M"),r.crds.push(A,b)},A.U.P.lineTo=function(r,A,b){r.cmds.push("L"),r.crds.push(A,b)},A.U.P.curveTo=function(r,A,b,C,I,x,S){r.cmds.push("C"),r.crds.push(A,b,C,I,x,S)},A.U.P.qcurveTo=function(r,A,b,C,I){r.cmds.push("Q"),r.crds.push(A,b,C,I)},A.U.P.closePath=function(r){r.cmds.push("Z")},A.U._drawCFF=function(r,b,C,I,x){for(var S=b.stack,B=b.nStems,D=b.haveWidth,R=b.width,F=b.open,N=0,Q=b.x,H=b.y,G=0,j=0,V=0,W=0,X=0,Y=0,K=0,q=0,Z=0,J=0,$={val:0,size:0};N<r.length;){A.CFF.getCharString(r,N,$);var ee=$.val;if(N+=$.size,"o1"==ee||"o18"==ee)S.length%2!=0&&!D&&(R=S.shift()+I.nominalWidthX),B+=S.length>>1,S.length=0,D=!0;else if("o3"==ee||"o23"==ee)S.length%2!=0&&!D&&(R=S.shift()+I.nominalWidthX),B+=S.length>>1,S.length=0,D=!0;else if("o4"==ee)S.length>1&&!D&&(R=S.shift()+I.nominalWidthX,D=!0),F&&A.U.P.closePath(x),H+=S.pop(),A.U.P.moveTo(x,Q,H),F=!0;else if("o5"==ee)for(;S.length>0;)Q+=S.shift(),H+=S.shift(),A.U.P.lineTo(x,Q,H);else if("o6"==ee||"o7"==ee)for(var te=S.length,se="o6"==ee,ie=0;ie<te;ie++){var ne=S.shift();se?Q+=ne:H+=ne,se=!se,A.U.P.lineTo(x,Q,H)}else if("o8"==ee||"o24"==ee){te=S.length;for(var re=0;re+6<=te;)G=Q+S.shift(),j=H+S.shift(),V=G+S.shift(),W=j+S.shift(),Q=V+S.shift(),H=W+S.shift(),A.U.P.curveTo(x,G,j,V,W,Q,H),re+=6;"o24"==ee&&(Q+=S.shift(),H+=S.shift(),A.U.P.lineTo(x,Q,H))}else{if("o11"==ee)break;if("o1234"==ee||"o1235"==ee||"o1236"==ee||"o1237"==ee)"o1234"==ee&&(j=H,V=(G=Q+S.shift())+S.shift(),J=W=j+S.shift(),Y=W,q=H,Q=(K=(X=(Z=V+S.shift())+S.shift())+S.shift())+S.shift(),A.U.P.curveTo(x,G,j,V,W,Z,J),A.U.P.curveTo(x,X,Y,K,q,Q,H)),"o1235"==ee&&(G=Q+S.shift(),j=H+S.shift(),V=G+S.shift(),W=j+S.shift(),Z=V+S.shift(),J=W+S.shift(),X=Z+S.shift(),Y=J+S.shift(),K=X+S.shift(),q=Y+S.shift(),Q=K+S.shift(),H=q+S.shift(),S.shift(),A.U.P.curveTo(x,G,j,V,W,Z,J),A.U.P.curveTo(x,X,Y,K,q,Q,H)),"o1236"==ee&&(G=Q+S.shift(),j=H+S.shift(),V=G+S.shift(),J=W=j+S.shift(),Y=W,K=(X=(Z=V+S.shift())+S.shift())+S.shift(),q=Y+S.shift(),Q=K+S.shift(),A.U.P.curveTo(x,G,j,V,W,Z,J),A.U.P.curveTo(x,X,Y,K,q,Q,H)),"o1237"==ee&&(G=Q+S.shift(),j=H+S.shift(),V=G+S.shift(),W=j+S.shift(),Z=V+S.shift(),J=W+S.shift(),X=Z+S.shift(),Y=J+S.shift(),K=X+S.shift(),q=Y+S.shift(),Math.abs(K-Q)>Math.abs(q-H)?Q=K+S.shift():H=q+S.shift(),A.U.P.curveTo(x,G,j,V,W,Z,J),A.U.P.curveTo(x,X,Y,K,q,Q,H));else if("o14"==ee){if(S.length>0&&!D&&(R=S.shift()+C.nominalWidthX,D=!0),4==S.length){var ae=S.shift(),oe=S.shift(),le=S.shift(),he=S.shift(),de=A.CFF.glyphBySE(C,le),ce=A.CFF.glyphBySE(C,he);A.U._drawCFF(C.CharStrings[de],b,C,I,x),b.x=ae,b.y=oe,A.U._drawCFF(C.CharStrings[ce],b,C,I,x)}F&&(A.U.P.closePath(x),F=!1)}else if("o19"==ee||"o20"==ee)S.length%2!=0&&!D&&(R=S.shift()+I.nominalWidthX),B+=S.length>>1,S.length=0,D=!0,N+=B+7>>3;else if("o21"==ee)S.length>2&&!D&&(R=S.shift()+I.nominalWidthX,D=!0),H+=S.pop(),Q+=S.pop(),F&&A.U.P.closePath(x),A.U.P.moveTo(x,Q,H),F=!0;else if("o22"==ee)S.length>1&&!D&&(R=S.shift()+I.nominalWidthX,D=!0),Q+=S.pop(),F&&A.U.P.closePath(x),A.U.P.moveTo(x,Q,H),F=!0;else if("o25"==ee){for(;S.length>6;)Q+=S.shift(),H+=S.shift(),A.U.P.lineTo(x,Q,H);G=Q+S.shift(),j=H+S.shift(),V=G+S.shift(),W=j+S.shift(),Q=V+S.shift(),H=W+S.shift(),A.U.P.curveTo(x,G,j,V,W,Q,H)}else if("o26"==ee)for(S.length%2&&(Q+=S.shift());S.length>0;)G=Q,j=H+S.shift(),Q=V=G+S.shift(),H=(W=j+S.shift())+S.shift(),A.U.P.curveTo(x,G,j,V,W,Q,H);else if("o27"==ee)for(S.length%2&&(H+=S.shift());S.length>0;)j=H,V=(G=Q+S.shift())+S.shift(),W=j+S.shift(),Q=V+S.shift(),H=W,A.U.P.curveTo(x,G,j,V,W,Q,H);else if("o10"==ee||"o29"==ee){var ue="o10"==ee?I:C;if(0==S.length)console.debug("error: empty stack");else{var pe=S.pop(),Ae=ue.Subrs[pe+ue.Bias];b.x=Q,b.y=H,b.nStems=B,b.haveWidth=D,b.width=R,b.open=F,A.U._drawCFF(Ae,b,C,I,x),Q=b.x,H=b.y,B=b.nStems,D=b.haveWidth,R=b.width,F=b.open}}else if("o30"==ee||"o31"==ee){var ge=S.length,fe=(re=0,"o31"==ee);for(re+=ge-(te=-3&ge);re<te;)fe?(j=H,V=(G=Q+S.shift())+S.shift(),H=(W=j+S.shift())+S.shift(),te-re==5?(Q=V+S.shift(),re++):Q=V,fe=!1):(G=Q,j=H+S.shift(),V=G+S.shift(),W=j+S.shift(),Q=V+S.shift(),te-re==5?(H=W+S.shift(),re++):H=W,fe=!0),A.U.P.curveTo(x,G,j,V,W,Q,H),re+=4}else{if("o"==(ee+"").charAt(0))throw console.debug("Unknown operation: "+ee,r),ee;S.push(ee)}}}b.x=Q,b.y=H,b.nStems=B,b.haveWidth=D,b.width=R,b.open=F};var b=A,C={Typr:b};return r.Typr=b,r.default=C,Object.defineProperty(r,"__esModule",{value:!0}),r}({}).Typr}
/*!
Custom bundle of woff2otf (https://github.com/arty-name/woff2otf) with fflate
(https://github.com/101arrowz/fflate) for use in Troika text rendering. 
Original licenses apply: 
- fflate: https://github.com/101arrowz/fflate/blob/master/LICENSE (MIT)
- woff2otf.js: https://github.com/arty-name/woff2otf/blob/master/woff2otf.js (Apache2)
*/,function(){return function(r){var A=Uint8Array,b=Uint16Array,C=Uint32Array,I=new A([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),x=new A([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),S=new A([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),f=function(r,A){for(var I=new b(31),x=0;x<31;++x)I[x]=A+=1<<r[x-1];var S=new C(I[30]);for(x=1;x<30;++x)for(var B=I[x];B<I[x+1];++B)S[B]=B-I[x]<<5|x;return[I,S]},B=f(I,2),D=B[0],R=B[1];D[28]=258,R[258]=28;for(var F=f(x,0)[0],N=new b(32768),Q=0;Q<32768;++Q){var H=(43690&Q)>>>1|(21845&Q)<<1;H=(61680&(H=(52428&H)>>>2|(13107&H)<<2))>>>4|(3855&H)<<4,N[Q]=((65280&H)>>>8|(255&H)<<8)>>>1}var w=function(r,A,C){for(var I=r.length,x=0,S=new b(A);x<I;++x)++S[r[x]-1];var B,D=new b(A);for(x=0;x<A;++x)D[x]=D[x-1]+S[x-1]<<1;B=new b(1<<A);var R=15-A;for(x=0;x<I;++x)if(r[x])for(var F=x<<4|r[x],Q=A-r[x],H=D[r[x]-1]++<<Q,G=H|(1<<Q)-1;H<=G;++H)B[N[H]>>>R]=F;return B},G=new A(288);for(Q=0;Q<144;++Q)G[Q]=8;for(Q=144;Q<256;++Q)G[Q]=9;for(Q=256;Q<280;++Q)G[Q]=7;for(Q=280;Q<288;++Q)G[Q]=8;var j=new A(32);for(Q=0;Q<32;++Q)j[Q]=5;var V=w(G,9),W=w(j,5),y=function(r){for(var A=r[0],b=1;b<r.length;++b)r[b]>A&&(A=r[b]);return A},L=function(r,A,b){var C=A/8|0;return(r[C]|r[C+1]<<8)>>(7&A)&b},U=function(r,A){var b=A/8|0;return(r[b]|r[b+1]<<8|r[b+2]<<16)>>(7&A)},X=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],T=function(r,A,b){var C=new Error(A||X[r]);if(C.code=r,Error.captureStackTrace&&Error.captureStackTrace(C,T),!b)throw C;return C},O=function(r,B,R){var N=r.length;if(!N||R&&!R.l&&N<5)return B||new A(0);var Q=!B||R,H=!R||R.i;R||(R={}),B||(B=new A(3*N));var G,d=function(r){var b=B.length;if(r>b){var C=new A(Math.max(2*b,r));C.set(B),B=C}},j=R.f||0,X=R.p||0,Y=R.b||0,K=R.l,q=R.d,Z=R.m,J=R.n,$=8*N;do{if(!K){R.f=j=L(r,X,1);var ee=L(r,X+1,3);if(X+=3,!ee){var te=r[(ue=((G=X)/8|0)+(7&G&&1)+4)-4]|r[ue-3]<<8,se=ue+te;if(se>N){H&&T(0);break}Q&&d(Y+te),B.set(r.subarray(ue,se),Y),R.b=Y+=te,R.p=X=8*se;continue}if(1==ee)K=V,q=W,Z=9,J=5;else if(2==ee){var ie=L(r,X,31)+257,ne=L(r,X+10,15)+4,re=ie+L(r,X+5,31)+1;X+=14;for(var ae=new A(re),oe=new A(19),le=0;le<ne;++le)oe[S[le]]=L(r,X+3*le,7);X+=3*ne;var he=y(oe),de=(1<<he)-1,ce=w(oe,he);for(le=0;le<re;){var ue,pe=ce[L(r,X,de)];if(X+=15&pe,(ue=pe>>>4)<16)ae[le++]=ue;else{var Ae=0,ge=0;for(16==ue?(ge=3+L(r,X,3),X+=2,Ae=ae[le-1]):17==ue?(ge=3+L(r,X,7),X+=3):18==ue&&(ge=11+L(r,X,127),X+=7);ge--;)ae[le++]=Ae}}var fe=ae.subarray(0,ie),me=ae.subarray(ie);Z=y(fe),J=y(me),K=w(fe,Z),q=w(me,J)}else T(1);if(X>$){H&&T(0);break}}Q&&d(Y+131072);for(var _e=(1<<Z)-1,be=(1<<J)-1,ye=X;;ye=X){var ve=(Ae=K[U(r,X)&_e])>>>4;if((X+=15&Ae)>$){H&&T(0);break}if(Ae||T(2),ve<256)B[Y++]=ve;else{if(256==ve){ye=X,K=null;break}var Ce=ve-254;if(ve>264){var we=I[le=ve-257];Ce=L(r,X,(1<<we)-1)+D[le],X+=we}var Ee=q[U(r,X)&be],Ie=Ee>>>4;if(Ee||T(3),X+=15&Ee,me=F[Ie],Ie>3&&(we=x[Ie],me+=U(r,X)&(1<<we)-1,X+=we),X>$){H&&T(0);break}Q&&d(Y+131072);for(var Te=Y+Ce;Y<Te;Y+=4)B[Y]=B[Y-me],B[Y+1]=B[Y+1-me],B[Y+2]=B[Y+2-me],B[Y+3]=B[Y+3-me];Y=Te}}R.l=K,R.p=ye,R.b=Y,K&&(j=1,R.m=Z,R.d=q,R.n=J)}while(!j);return Y==B.length?B:function(r,I,x){(null==x||x>r.length)&&(x=r.length);var S=new(r instanceof b?b:r instanceof C?C:A)(x-0);return S.set(r.subarray(0,x)),S}(B,0,Y)},Y=new A(0),K="undefined"!=typeof TextDecoder&&new TextDecoder;try{K.decode(Y,{stream:!0})}catch(r){}return r.convert_streams=function(r){var A=new DataView(r),b=0;function t(){var r=A.getUint16(b);return b+=2,r}function a(){var r=A.getUint32(b);return b+=4,r}function i(r){H.setUint16(G,r),G+=2}function o(r){H.setUint32(G,r),G+=4}for(var C={signature:a(),flavor:a(),length:a(),numTables:t(),reserved:t(),totalSfntSize:a(),majorVersion:t(),minorVersion:t(),metaOffset:a(),metaLength:a(),metaOrigLength:a(),privOffset:a(),privLength:a()},I=0;Math.pow(2,I)<=C.numTables;)I++;I--;for(var x=16*Math.pow(2,I),S=16*C.numTables-x,B=12,D=[],R=0;R<C.numTables;R++)D.push({tag:a(),offset:a(),compLength:a(),origLength:a(),origChecksum:a()}),B+=16;var F,N=new Uint8Array(12+16*D.length+D.reduce((function(r,A){return r+A.origLength+4}),0)),Q=N.buffer,H=new DataView(Q),G=0;return o(C.flavor),i(C.numTables),i(x),i(I),i(S),D.forEach((function(r){o(r.tag),o(r.origChecksum),o(B),o(r.origLength),r.outOffset=B,(B+=r.origLength)%4!=0&&(B+=4-B%4)})),D.forEach((function(A){var b,C=r.slice(A.offset,A.offset+A.compLength);if(A.compLength!=A.origLength){var I=new Uint8Array(A.origLength);b=new Uint8Array(C,2),O(b,I)}else I=new Uint8Array(C);N.set(I,A.outOffset);var x=0;(B=A.outOffset+A.origLength)%4!=0&&(x=4-B%4),N.set(new Uint8Array(x).buffer,A.outOffset+A.origLength),F=B+x})),Q.slice(0,F)},Object.defineProperty(r,"__esModule",{value:!0}),r}({}).convert_streams},function(r,A){const b={M:2,L:2,Q:4,C:6,Z:0},C={C:"18g,ca,368,1kz",D:"17k,6,2,2+4,5+c,2+6,2+1,10+1,9+f,j+11,2+1,a,2,2+1,15+2,3,j+2,6+3,2+8,2,2,2+1,w+a,4+e,3+3,2,3+2,3+5,23+w,2f+4,3,2+9,2,b,2+3,3,1k+9,6+1,3+1,2+2,2+d,30g,p+y,1,1+1g,f+x,2,sd2+1d,jf3+4,f+3,2+4,2+2,b+3,42,2,4+2,2+1,2,3,t+1,9f+w,2,el+2,2+g,d+2,2l,2+1,5,3+1,2+1,2,3,6,16wm+1v",R:"17m+3,2,2,6+3,m,15+2,2+2,h+h,13,3+8,2,2,3+1,2,p+1,x,5+4,5,a,2,2,3,u,c+2,g+1,5,2+1,4+1,5j,6+1,2,b,2+2,f,2+1,1s+2,2,3+1,7,1ez0,2,2+1,4+4,b,4,3,b,42,2+2,4,3,2+1,2,o+3,ae,ep,x,2o+2,3+1,3,5+1,6",L:"x9u,jff,a,fd,jv",T:"4t,gj+33,7o+4,1+1,7c+18,2,2+1,2+1,2,21+a,2,1b+k,h,2u+6,3+5,3+1,2+3,y,2,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,3,7,6+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+d,1,1+1,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,ek,3+1,r+4,1e+4,6+5,2p+c,1+3,1,1+2,1+b,2db+2,3y,2p+v,ff+3,30+1,n9x,1+2,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,5s,6y+2,ea,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+9,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2,2b+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,470+8,at4+4,1o+6,t5,1s+3,2a,f5l+1,2+3,43o+2,a+7,1+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,1,gzau,v+2n,3l+6n"},I=1,x=2,S=4,B=8,D=16,R=32;let F;function getCharJoiningType(r){if(!F){const r={R:x,L:I,D:S,C:D,U:R,T:B};F=new Map;for(let A in C){let b=0;C[A].split(",").forEach((C=>{let[I,x]=C.split("+");I=parseInt(I,36),x=x?parseInt(x,36):0,F.set(b+=I,r[A]);for(let C=x;C--;)F.set(++b,r[A])}))}}return F.get(r)||R}const N=1,Q=2,H=3,G=4,j=[null,"isol","init","fina","medi"];function detectJoiningForms(r){const A=new Uint8Array(r.length);let b=R,C=N,F=-1;for(let j=0;j<r.length;j++){const V=r.codePointAt(j);let W=0|getCharJoiningType(V),X=N;W&B||(b&(I|S|D)?W&(x|S|D)?(X=H,C!==N&&C!==H||A[F]++):W&(I|R)&&(C!==Q&&C!==G||A[F]--):b&(x|R)&&(C!==Q&&C!==G||A[F]--),C=A[j]=X,b=W,F=j,V>65535&&j++)}return A}function getGlyphClass(A,b){const C=A.GDEF&&A.GDEF.glyphClassDef;return C?r.U._getGlyphClass(b,C):0}function firstNum(...r){for(let A=0;A<r.length;A++)if("number"==typeof r[A])return r[A]}function wrapFontObj(A){const C=Object.create(null),I=A["OS/2"],x=A.hhea,S=A.head.unitsPerEm,B=firstNum(I&&I.sTypoAscender,x&&x.ascender,S),D={unitsPerEm:S,ascender:B,descender:firstNum(I&&I.sTypoDescender,x&&x.descender,0),capHeight:firstNum(I&&I.sCapHeight,B),xHeight:firstNum(I&&I.sxHeight,B),lineGap:firstNum(I&&I.sTypoLineGap,x&&x.lineGap),supportsCodePoint:b=>r.U.codeToGlyph(A,b)>0,forEachGlyph(I,x,S,B){let R=0;const F=1/D.unitsPerEm*x,N=function(A,b){const C=[];for(let I=0;I<b.length;I++){const x=b.codePointAt(I);x>65535&&I++,C.push(r.U.codeToGlyph(A,x))}const I=A.GSUB;if(I){const{lookupList:A,featureList:x}=I;let S;const B=/^(rlig|liga|mset|isol|init|fina|medi|half|pres|blws|ccmp)$/,D=[];x.forEach((I=>{if(B.test(I.tag))for(let x=0;x<I.tab.length;x++){if(D[I.tab[x]])continue;D[I.tab[x]]=!0;const B=A[I.tab[x]],R=/^(isol|init|fina|medi)$/.test(I.tag);R&&!S&&(S=detectJoiningForms(b));for(let b=0;b<C.length;b++)S&&R&&j[S[b]]!==I.tag||r.U._applySubs(C,b,B,A)}}))}return C}(A,I);let Q=0;const H=function(A,b){const C=new Int16Array(3*b.length);let I=0;for(;I<b.length;I++){const x=b[I];if(-1===x)continue;C[3*I+2]=A.hmtx.aWidth[x];const S=A.GPOS;if(S){const B=S.lookupList;for(let S=0;S<B.length;S++){const D=B[S];for(let S=0;S<D.tabs.length;S++){const B=D.tabs[S];if(1===D.ltype){if(-1!==r._lctf.coverageIndex(B.coverage,x)&&B.pos){applyValueRecord(B.pos,I);break}}else if(2===D.ltype){let A=null,C=getPrevGlyphIndex();if(-1!==C){const S=r._lctf.coverageIndex(B.coverage,b[C]);if(-1!==S){if(1===B.fmt){const r=B.pairsets[S];for(let b=0;b<r.length;b++)r[b].gid2===x&&(A=r[b])}else if(2===B.fmt){const I=r.U._getGlyphClass(b[C],B.classDef1),S=r.U._getGlyphClass(x,B.classDef2);A=B.matrix[I][S]}if(A){A.val1&&applyValueRecord(A.val1,C),A.val2&&applyValueRecord(A.val2,I);break}}}}else if(4===D.ltype){const A=r._lctf.coverageIndex(B.markCoverage,x);if(-1!==A){const x=getPrevGlyphIndex(isBaseGlyph),S=-1===x?-1:r._lctf.coverageIndex(B.baseCoverage,b[x]);if(-1!==S){const r=B.markArray[A],b=B.baseArray[S][r.markClass];C[3*I]=b.x-r.x+C[3*x]-C[3*x+2],C[3*I+1]=b.y-r.y+C[3*x+1];break}}}else if(6===D.ltype){const S=r._lctf.coverageIndex(B.mark1Coverage,x);if(-1!==S){const x=getPrevGlyphIndex();if(-1!==x){const D=b[x];if(3===getGlyphClass(A,D)){const A=r._lctf.coverageIndex(B.mark2Coverage,D);if(-1!==A){const r=B.mark1Array[S],b=B.mark2Array[A][r.markClass];C[3*I]=b.x-r.x+C[3*x]-C[3*x+2],C[3*I+1]=b.y-r.y+C[3*x+1];break}}}}}}}}else if(A.kern&&!A.cff){const r=getPrevGlyphIndex();if(-1!==r){const I=A.kern.glyph1.indexOf(b[r]);if(-1!==I){const b=A.kern.rval[I].glyph2.indexOf(x);-1!==b&&(C[3*r+2]+=A.kern.rval[I].vals[b])}}}}return C;function getPrevGlyphIndex(r){for(let A=I-1;A>=0;A--)if(-1!==b[A]&&(!r||r(b[A])))return A;return-1}function isBaseGlyph(r){return 1===getGlyphClass(A,r)}function applyValueRecord(r,A){for(let b=0;b<3;b++)C[3*A+b]+=r[b]||0}}(A,N);return N.forEach(((D,N)=>{if(-1!==D){let I=C[D];if(!I){const{cmds:x,crds:S}=r.U.glyphToPath(A,D);let B,R,F,N,Q="",H=0;for(let r=0,A=x.length;r<A;r++){const A=b[x[r]];Q+=x[r];for(let r=1;r<=A;r++)Q+=(r>1?",":"")+S[H++]}if(S.length){B=R=1/0,F=N=-1/0;for(let r=0,A=S.length;r<A;r+=2){let A=S[r],b=S[r+1];A<B&&(B=A),b<R&&(R=b),A>F&&(F=A),b>N&&(N=b)}}else B=F=R=N=0;I=C[D]={index:D,advanceWidth:A.hmtx.aWidth[D],xMin:B,yMin:R,xMax:F,yMax:N,path:Q}}B.call(null,I,R+H[3*N]*F,H[3*N+1]*F,Q),R+=H[3*N+2]*F,S&&(R+=S*x)}Q+=I.codePointAt(Q)>65535?2:1})),R}};return D}return function(b){const C=new Uint8Array(b,0,4),I=r._bin.readASCII(C,0,4);if("wOFF"===I)b=A(b);else if("wOF2"===I)throw new Error("woff2 fonts not supported");return wrapFontObj(r.parse(b)[0])}}],init:(r,A,b)=>b(r(),A())}),Cr=defineWorkerModule({name:"FontResolver",dependencies:[function(r,A){const b=Object.create(null),C=Object.create(null);function loadFont(A,I){let x=b[A];x?I(x):C[A]?C[A].push(I):(C[A]=[I],function(A,b){const onError=r=>{console.error(`Failure loading font ${A}`,r)};try{const C=new XMLHttpRequest;C.open("get",A,!0),C.responseType="arraybuffer",C.onload=function(){if(C.status>=400)onError(new Error(C.statusText));else if(C.status>0)try{const I=r(C.response);I.src=A,b(I)}catch(r){onError(r)}},C.onerror=onError,C.send()}catch(r){onError(r)}}(A,(r=>{r.src=A,b[A]=r,C[A].forEach((A=>A(r))),delete C[A]})))}return function(r,C,{lang:I,fonts:x=[],style:S="normal",weight:B="normal",unicodeFontsURL:D}={}){const R=new Uint8Array(r.length),F=[];r.length||allDone();const N=new Map,Q=[];if("italic"!==S&&(S="normal"),"number"!=typeof B&&(B="bold"===B?700:400),x&&!Array.isArray(x)&&(x=[x]),(x=x.slice().filter((r=>!r.lang||r.lang.test(I))).reverse()).length){const A=1,C=2;let I=0;!function resolveUserFonts(S=0){for(let B=S,D=r.length;B<D;B++){const S=r.codePointAt(B);if(I===A&&F[R[B-1]].supportsCodePoint(S)||/\s/.test(r[B]))R[B]=R[B-1],I===C&&(Q[Q.length-1][1]=B);else for(let r=R[B],D=x.length;r<=D;r++)if(r===D)(I===C?Q[Q.length-1]:Q[Q.length]=[B,B])[1]=B,I=C;else{R[B]=r;const{src:C,unicodeRange:D}=x[r];if(!D||isCodeInRanges(S,D)){const r=b[C];if(!r)return void loadFont(C,(()=>{resolveUserFonts(B)}));if(r.supportsCodePoint(S)){let b=N.get(r);"number"!=typeof b&&(b=F.length,F.push(r),N.set(r,b)),R[B]=b,I=A;break}}}S>65535&&B+1<D&&(R[B+1]=R[B],B++,I===C&&(Q[Q.length-1][1]=B))}resolveFallbacks()}()}else Q.push([0,r.length-1]),resolveFallbacks();function resolveFallbacks(){if(Q.length){const b=Q.map((A=>r.substring(A[0],A[1]+1))).join("\n");A.getFontsForString(b,{lang:I||void 0,style:S,weight:B,dataUrl:D}).then((({fontUrls:r,chars:A})=>{const b=F.length;let C=0;Q.forEach((r=>{for(let I=0,x=r[1]-r[0];I<=x;I++)R[r[0]+I]=A[C++]+b;C++}));let I=0;r.forEach(((A,C)=>{loadFont(A,(A=>{F[C+b]=A,++I===r.length&&allDone()}))}))}))}else allDone()}function allDone(){C({chars:R,fonts:F})}function isCodeInRanges(r,A){for(let b=0;b<A.length;b++){const[C,I=C]=A[b];if(C<=r&&r<=I)return!0}return!1}}},vr,function(){return function(r){var n=function(){this.buckets=new Map};n.prototype.add=function(r){var A=r>>5;this.buckets.set(A,(this.buckets.get(A)||0)|1<<(31&r))},n.prototype.has=function(r){var A=this.buckets.get(r>>5);return void 0!==A&&0!=(A&1<<(31&r))},n.prototype.serialize=function(){var r=[];return this.buckets.forEach((function(A,b){r.push((+b).toString(36)+":"+A.toString(36))})),r.join(",")},n.prototype.deserialize=function(r){var A=this;this.buckets.clear(),r.split(",").forEach((function(r){var b=r.split(":");A.buckets.set(parseInt(b[0],36),parseInt(b[1],36))}))};var A=Math.pow(2,8),b=A-1,C=~b;function a(r){var b=function(r){return r&C}(r).toString(16),I=function(r){return(r&C)+A-1}(r).toString(16);return"codepoint-index/plane"+(r>>16)+"/"+b+"-"+I+".json"}function i(r,A){var C=r&b,I=A.codePointAt(C/6|0);return 0!=((I=(I||48)-48)&1<<C%6)}function c(r,A){!function(r,A){var b;(b=r,b.replace(/U\+/gi,"").replace(/^,+|,+$/g,"").split(/,+/).map((function(r){return r.split("-").map((function(r){return parseInt(r.trim(),16)}))}))).forEach((function(r){var b=r[0],C=r[1];void 0===C&&(C=b),A(b,C)}))}(r,(function(r,b){for(var C=r;C<=b;C++)A(C)}))}var I={},x={},S=new WeakMap,B="https://cdn.jsdelivr.net/gh/lojjic/unicode-font-resolver@v1.0.1/packages/data";function d(r){var A=S.get(r);return A||(A=new n,c(r.ranges,(function(r){return A.add(r)})),S.set(r,A)),A}var D,R=new Map;function g(r,A,b){return r[A]?A:r[b]?b:function(r){for(var A in r)return A}(r)}function w(r,A){var b=A;if(!r.includes(b)){b=1/0;for(var C=0;C<r.length;C++)Math.abs(r[C]-A)<Math.abs(b-A)&&(b=r[C])}return b}function k(r){return D||(D=new Set,c("9-D,20,85,A0,1680,2000-200A,2028-202F,205F,3000",(function(r){D.add(r)}))),D.has(r)}return r.CodePointSet=n,r.clearCache=function(){I={},x={}},r.getFontsForString=function(r,A){void 0===A&&(A={});var b,C=A.lang;void 0===C&&(C=/\p{Script=Hangul}/u.test(b=r)?"ko":/\p{Script=Hiragana}|\p{Script=Katakana}/u.test(b)?"ja":"en");var S=A.category;void 0===S&&(S="sans-serif");var D=A.style;void 0===D&&(D="normal");var F=A.weight;void 0===F&&(F=400);var N=(A.dataUrl||B).replace(/\/$/g,""),Q=new Map,H=new Uint8Array(r.length),G={},j={},V=new Array(r.length),W=new Map,X=!1;function M(r){var A=R.get(r);return A||(A=fetch(N+"/"+r).then((function(r){if(!r.ok)throw new Error(r.statusText);return r.json().then((function(r){if(!Array.isArray(r)||1!==r[0])throw new Error("Incorrect schema version; need 1, got "+r[0]);return r[1]}))})).catch((function(A){if(N!==B)return X||(console.error('unicode-font-resolver: Failed loading from dataUrl "'+N+'", trying default CDN. '+A.message),X=!0),N=B,R.delete(r),M(r);throw A})),R.set(r,A)),A}for(var P=function(A){var b=r.codePointAt(A),C=a(b);V[A]=C,I[C]||W.has(C)||W.set(C,M(C).then((function(r){I[C]=r}))),b>65535&&(A++,Y=A)},Y=0;Y<r.length;Y++)P(Y);return Promise.all(W.values()).then((function(){W.clear();for(var n=function(b){var S=r.codePointAt(b),B=null,D=I[V[b]],R=void 0;for(var F in D){var N=j[F];if(void 0===N&&(N=j[F]=new RegExp(F).test(C||"en")),N){for(var Q in R=F,D[F])if(i(S,D[F][Q])){B=Q;break}break}}if(!B)e:for(var H in D)if(H!==R)for(var G in D[H])if(i(S,D[H][G])){B=G;break e}B||(console.debug("No font coverage for U+"+S.toString(16)),B="latin"),V[b]=B,x[B]||W.has(B)||W.set(B,M("font-meta/"+B+".json").then((function(r){x[B]=r}))),S>65535&&(b++,A=b)},A=0;A<r.length;A++)n(A);return Promise.all(W.values())})).then((function(){for(var A,b=null,C=0;C<r.length;C++){var I=r.codePointAt(C);if(b&&(k(I)||d(b).has(I)))H[C]=H[C-1];else{b=x[V[C]];var B=G[b.id];if(!B){var R=b.typeforms,j=g(R,S,"sans-serif"),W=g(R[j],D,"normal"),X=w(null===(A=R[j])||void 0===A?void 0:A[W],F);B=G[b.id]=N+"/font-files/"+b.id+"/"+j+"."+W+"."+X+".woff"}var Y=Q.get(B);null==Y&&(Y=Q.size,Q.set(B,Y)),H[C]=Y}I>65535&&(C++,H[C]=H[C-1])}return{fontUrls:Array.from(Q.keys()),chars:H}}))},Object.defineProperty(r,"__esModule",{value:!0}),r}({})}],init:(r,A,b)=>r(A,b())}),now=()=>(self.performance||Date).now(),wr=SDFGenerator();let Er;const Ir=[];let Tr=0;function nextChunk(){const r=now();for(;Ir.length&&now()-r<5;)Ir.shift()();Tr=Ir.length?setTimeout(nextChunk,0):0}const generateSDF_GL=(...r)=>new Promise(((A,b)=>{Ir.push((()=>{const C=now();try{wr.webgl.generateIntoCanvas(...r),A({timing:now()-C})}catch(r){b(r)}})),Tr||(Tr=setTimeout(nextChunk,0))})),xr=4,Sr=2e3,Br={};let Dr=0;function generateSDF_JS_Worker(r,A,b,C,I,x,S,B,D,R){const F="TroikaTextSDFGenerator_JS_"+Dr++%xr;let N=Br[F];return N||(N=Br[F]={workerModule:defineWorkerModule({name:F,workerId:F,dependencies:[SDFGenerator,now],init(r,A){const b=r().javascript.generate;return function(...r){const C=A();return{textureData:b(...r),timing:A()-C}}},getTransferables:r=>[r.textureData.buffer]}),requests:0,idleTimer:null}),N.requests++,clearTimeout(N.idleTimer),N.workerModule(r,A,b,C,I,x).then((({textureData:b,timing:C})=>{const I=now(),x=new Uint8Array(4*b.length);for(let r=0;r<b.length;r++)x[4*r+R]=b[r];return wr.webglUtils.renderImageData(S,x,B,D,r,A,1<<3-R),C+=now()-I,0==--N.requests&&(N.idleTimer=setTimeout((()=>{!function(r){dr[r]&&dr[r].forEach((function(r){r()})),hr[r]&&(hr[r].terminate(),delete hr[r])}(F)}),Sr)),{timing:C}}))}const Pr=wr.webglUtils.resizeWebGLCanvasWithoutClearing,Mr={defaultFontURL:null,unicodeFontsURL:null,sdfGlyphSize:64,sdfMargin:1/16,sdfExponent:9,textureWidth:2048},kr=new Q;let Rr=!1;function now$1(){return(self.performance||Date).now()}const Fr=Object.create(null);function getTextRenderInfo(r,A){Rr=!0,r=assign({},r);const b=now$1(),{defaultFontURL:C}=Mr,I=[];if(C&&I.push({label:"default",src:toAbsoluteURL(C)}),r.font&&I.push({label:"user",src:toAbsoluteURL(r.font)}),r.font=I,r.text=""+r.text,r.sdfGlyphSize=r.sdfGlyphSize||Mr.sdfGlyphSize,r.unicodeFontsURL=r.unicodeFontsURL||Mr.unicodeFontsURL,null!=r.colorRanges){let A={};for(let b in r.colorRanges)if(r.colorRanges.hasOwnProperty(b)){let C=r.colorRanges[b];"number"!=typeof C&&(C=kr.set(C).getHex()),A[b]=C}r.colorRanges=A}Object.freeze(r);const{textureWidth:x,sdfExponent:S}=Mr,{sdfGlyphSize:B}=r,D=x/B*4;let R=Fr[B];if(!R){const r=document.createElement("canvas");r.width=x,r.height=256*B/D,R=Fr[B]={glyphCount:0,sdfGlyphSize:B,sdfCanvas:r,sdfTexture:new be(r,void 0,void 0,void 0,fe,fe),contextLost:!1,glyphsByFont:new Map},R.sdfTexture.generateMipmaps=!1,function(r){const A=r.sdfCanvas;A.addEventListener("webglcontextlost",(A=>{console.log("Context Lost",A),A.preventDefault(),r.contextLost=!0})),A.addEventListener("webglcontextrestored",(A=>{console.log("Context Restored",A),r.contextLost=!1;const b=[];r.glyphsByFont.forEach((A=>{A.forEach((A=>{b.push(generateGlyphSDF(A,r,!0))}))})),Promise.all(b).then((()=>{safariPre15Workaround(r),r.sdfTexture.needsUpdate=!0}))}))}(R)}const{sdfTexture:F,sdfCanvas:N}=R;Ur(r).then((C=>{const{glyphIds:I,glyphFontIndices:Q,fontData:H,glyphPositions:G,fontSize:j,timings:V}=C,W=[],X=new Float32Array(4*I.length);let Y=0,K=0;const q=now$1(),Z=H.map((r=>{let A=R.glyphsByFont.get(r.src);return A||R.glyphsByFont.set(r.src,A=new Map),A}));I.forEach(((r,A)=>{const b=Q[A],{src:x,unitsPerEm:S}=H[b];let D=Z[b].get(r);if(!D){const{path:A,pathBounds:I}=C.glyphData[x][r],S=Math.max(I[2]-I[0],I[3]-I[1])/B*(Mr.sdfMargin*B+.5),F=R.glyphCount++,N=[I[0]-S,I[1]-S,I[2]+S,I[3]+S];Z[b].set(r,D={path:A,atlasIndex:F,sdfViewBox:N}),W.push(D)}const{sdfViewBox:F}=D,N=G[K++],V=G[K++],q=j/S;X[Y++]=N+F[0]*q,X[Y++]=V+F[1]*q,X[Y++]=N+F[2]*q,X[Y++]=V+F[3]*q,I[A]=D.atlasIndex})),V.quads=(V.quads||0)+(now$1()-q);const J=now$1();V.sdf={};const $=N.height,ee=Math.ceil(R.glyphCount/D),te=Math.pow(2,Math.ceil(Math.log2(ee*B)));te>$&&(console.info(`Increasing SDF texture size ${$}->${te}`),Pr(N,x,te),F.dispose()),Promise.all(W.map((A=>generateGlyphSDF(A,R,r.gpuAccelerateSDF).then((({timing:r})=>{V.sdf[A.atlasIndex]=r}))))).then((()=>{W.length&&!R.contextLost&&(safariPre15Workaround(R),F.needsUpdate=!0),V.sdfTotal=now$1()-J,V.total=now$1()-b,A(Object.freeze({parameters:r,sdfTexture:F,sdfGlyphSize:B,sdfExponent:S,glyphBounds:X,glyphAtlasIndices:I,glyphColors:C.glyphColors,caretPositions:C.caretPositions,chunkedBounds:C.chunkedBounds,ascender:C.ascender,descender:C.descender,lineHeight:C.lineHeight,capHeight:C.capHeight,xHeight:C.xHeight,topBaseline:C.topBaseline,blockBounds:C.blockBounds,visibleBounds:C.visibleBounds,timings:C.timings}))}))})),Promise.resolve().then((()=>{var r;R.contextLost||(r=N)._warm||(wr.webgl.isSupported(r),r._warm=!0)}))}function generateGlyphSDF({path:r,atlasIndex:A,sdfViewBox:b},{sdfGlyphSize:C,sdfCanvas:I,contextLost:x},S){if(x)return Promise.resolve({timing:-1});const{textureWidth:B,sdfExponent:D}=Mr,R=Math.max(b[2]-b[0],b[3]-b[1]),F=Math.floor(A/4);return function(r,A,b,C,I,x,S,B,D,R,F=!0){return F?generateSDF_GL(r,A,b,C,I,x,S,B,D,R).then(null,(F=>(Er||(console.warn("WebGL SDF generation failed, falling back to JS",F),Er=!0),generateSDF_JS_Worker(r,A,b,C,I,x,S,B,D,R)))):generateSDF_JS_Worker(r,A,b,C,I,x,S,B,D,R)}(C,C,r,b,R,D,I,F%(B/C)*C,Math.floor(F/(B/C))*C,A%4,S)}function assign(r,A){for(let b in A)A.hasOwnProperty(b)&&(r[b]=A[b]);return r}let Lr;function toAbsoluteURL(r){return Lr||(Lr="undefined"==typeof document?{}:document.createElement("a")),Lr.href=r,Lr.href}function safariPre15Workaround(r){if("function"!=typeof createImageBitmap){console.info("Safari<15: applying SDF canvas workaround");const{sdfCanvas:A,sdfTexture:b}=r,{width:C,height:I}=A,x=r.sdfCanvas.getContext("webgl");let S=b.image.data;S&&S.length===C*I*4||(S=new Uint8Array(C*I*4),b.image={width:C,height:I,data:S},b.flipY=!1,b.isDataTexture=!0),x.readPixels(0,0,C,I,x.RGBA,x.UNSIGNED_BYTE,S)}}const Or=defineWorkerModule({name:"Typesetter",dependencies:[function(r,A){const b=1/0,C=/[\u00AD\u034F\u061C\u115F-\u1160\u17B4-\u17B5\u180B-\u180E\u200B-\u200F\u202A-\u202E\u2060-\u206F\u3164\uFE00-\uFE0F\uFEFF\uFFA0\uFFF0-\uFFF8]/,I="[^\\S\\u00A0]",x=new RegExp(`${I}|[\\-\\u007C\\u00AD\\u2010\\u2012-\\u2014\\u2027\\u2056\\u2E17\\u2E40]`);function typeset({text:S="",font:B,lang:D,sdfGlyphSize:R=64,fontSize:F=400,fontWeight:N=1,fontStyle:Q="normal",letterSpacing:H=0,lineHeight:G="normal",maxWidth:j=b,direction:V,textAlign:W="left",textIndent:X=0,whiteSpace:Y="normal",overflowWrap:K="normal",anchorX:q=0,anchorY:Z=0,metricsOnly:J=!1,unicodeFontsURL:$,preResolvedFonts:ee=null,includeCaretPositions:te=!1,chunkedBoundsSize:se=8192,colorRanges:ie=null},ne){const re=now(),ae={fontLoad:0,typesetting:0};S.indexOf("\r")>-1&&(console.info("Typesetter: got text with \\r chars; normalizing to \\n"),S=S.replace(/\r\n/g,"\n").replace(/\r/g,"\n")),F=+F,H=+H,j=+j,G=G||"normal",X=+X,function({text:A,lang:b,fonts:C,style:I,weight:x,preResolvedFonts:S,unicodeFontsURL:B},D){const onResolved=({chars:r,fonts:A})=>{let b,C;const I=[];for(let x=0;x<r.length;x++)r[x]!==C?(C=r[x],I.push(b={start:x,end:x,fontObj:A[r[x]]})):b.end=x;D(I)};S?onResolved(S):r(A,onResolved,{lang:b,fonts:C,style:I,weight:x,unicodeFontsURL:B})}({text:S,lang:D,style:Q,weight:N,fonts:"string"==typeof B?[{src:B}]:B,unicodeFontsURL:$,preResolvedFonts:ee},(r=>{ae.fontLoad=now()-re;const B=isFinite(j);let D=null,R=null,N=null,Q=null,$=null,ee=null,oe=null,le=null,he=0,de=0,ce="nowrap"!==Y;const ue=new Map,pe=now();let Ae=X,ge=0,fe=new TextLine;const me=[fe];r.forEach((r=>{const{fontObj:A}=r,{ascender:b,descender:D,unitsPerEm:R,lineGap:N,capHeight:Q,xHeight:V}=A;let W=ue.get(A);if(!W){const r=F/R,C="normal"===G?(b-D+N)*r:G*F,I=(C-(b-D)*r)/2,x=Math.min(C,(b-D)*r),S=(b+D)/2*r+x/2;W={index:ue.size,src:A.src,fontObj:A,fontSizeMult:r,unitsPerEm:R,ascender:b*r,descender:D*r,capHeight:Q*r,xHeight:V*r,lineHeight:C,baseline:-I-b*r,caretTop:S,caretBottom:S-x},ue.set(A,W)}const{fontSizeMult:Y}=W,q=S.slice(r.start,r.end+1);let Z,J;A.forEachGlyph(q,F,H,((A,b,D,R)=>{b+=ge,R+=r.start,Z=b,J=A;const N=S.charAt(R),Q=A.advanceWidth*Y,G=fe.count;let V;if("isEmpty"in A||(A.isWhitespace=!!N&&new RegExp(I).test(N),A.canBreakAfter=!!N&&x.test(N),A.isEmpty=A.xMin===A.xMax||A.yMin===A.yMax||C.test(N)),A.isWhitespace||A.isEmpty||de++,ce&&B&&!A.isWhitespace&&b+Q+Ae>j&&G){if(fe.glyphAt(G-1).glyphObj.canBreakAfter)V=new TextLine,Ae=-b;else for(let r=G;r--;){if(0===r&&"break-word"===K){V=new TextLine,Ae=-b;break}if(fe.glyphAt(r).glyphObj.canBreakAfter){V=fe.splitAt(r+1);const A=V.glyphAt(0).x;Ae-=A;for(let r=V.count;r--;)V.glyphAt(r).x-=A;break}}V&&(fe.isSoftWrapped=!0,fe=V,me.push(fe),he=j)}let q=fe.glyphAt(fe.count);q.glyphObj=A,q.x=b+Ae,q.y=D,q.width=Q,q.charIndex=R,q.fontData=W,"\n"===N&&(fe=new TextLine,me.push(fe),Ae=-(b+Q+H*F)+X)})),ge=Z+J.advanceWidth*Y+H*F}));let _e=0;me.forEach((r=>{let A=!0;for(let b=r.count;b--;){const C=r.glyphAt(b);A&&!C.glyphObj.isWhitespace&&(r.width=C.x+C.width,r.width>he&&(he=r.width),A=!1);let{lineHeight:I,capHeight:x,xHeight:S,baseline:B}=C.fontData;I>r.lineHeight&&(r.lineHeight=I);const D=B-r.baseline;D<0&&(r.baseline+=D,r.cap+=D,r.ex+=D),r.cap=Math.max(r.cap,r.baseline+x),r.ex=Math.max(r.ex,r.baseline+S)}r.baseline-=_e,r.cap-=_e,r.ex-=_e,_e+=r.lineHeight}));let be=0,ye=0;if(q&&("number"==typeof q?be=-q:"string"==typeof q&&(be=-he*("left"===q?0:"center"===q?.5:"right"===q?1:parsePercent(q)))),Z&&("number"==typeof Z?ye=-Z:"string"==typeof Z&&(ye="top"===Z?0:"top-baseline"===Z?-me[0].baseline:"top-cap"===Z?-me[0].cap:"top-ex"===Z?-me[0].ex:"middle"===Z?_e/2:"bottom"===Z?_e:"bottom-baseline"===Z?-me[me.length-1].baseline:parsePercent(Z)*_e)),!J){const r=A.getEmbeddingLevels(S,V);D=new Uint16Array(de),R=new Uint8Array(de),N=new Float32Array(2*de),Q={},oe=[b,b,-b,-b],le=[],te&&(ee=new Float32Array(4*S.length)),ie&&($=new Uint8Array(3*de));let C,I,x=0,B=-1,F=-1;if(me.forEach(((H,G)=>{let{count:j,width:V}=H;if(j>0){let G=0;for(let r=j;r--&&H.glyphAt(r).glyphObj.isWhitespace;)G++;let X=0,Y=0;if("center"===W)X=(he-V)/2;else if("right"===W)X=he-V;else if("justify"===W&&H.isSoftWrapped){let r=0;for(let A=j-G;A--;)H.glyphAt(A).glyphObj.isWhitespace&&r++;Y=(he-V)/r}if(Y||X){let r=0;for(let A=0;A<j;A++){let b=H.glyphAt(A);const C=b.glyphObj;b.x+=X+r,0!==Y&&C.isWhitespace&&A<j-G&&(r+=Y,b.width+=Y)}}const K=A.getReorderSegments(S,r,H.glyphAt(0).charIndex,H.glyphAt(H.count-1).charIndex);for(let r=0;r<K.length;r++){const[A,b]=K[r];let C=1/0,I=-1/0;for(let r=0;r<j;r++)if(H.glyphAt(r).charIndex>=A){let A=r,x=r;for(;x<j;x++){let r=H.glyphAt(x);if(r.charIndex>b)break;x<j-G&&(C=Math.min(C,r.x),I=Math.max(I,r.x+r.width))}for(let r=A;r<x;r++){const A=H.glyphAt(r);A.x=I-(A.x+A.width-C)}break}}let q;const setGlyphObj=r=>q=r;for(let G=0;G<j;G++){const j=H.glyphAt(G);q=j.glyphObj;const V=q.index,W=1&r.levels[j.charIndex];if(W){const r=A.getMirroredCharacter(S[j.charIndex]);r&&j.fontData.fontObj.forEachGlyph(r,0,0,setGlyphObj)}if(te){const{charIndex:r,fontData:A}=j,b=j.x+be,C=j.x+j.width+be;ee[4*r]=W?C:b,ee[4*r+1]=W?b:C,ee[4*r+2]=H.baseline+A.caretBottom+ye,ee[4*r+3]=H.baseline+A.caretTop+ye;const I=r-B;I>1&&fillLigatureCaretPositions(ee,B,I),B=r}if(ie){const{charIndex:r}=j;for(;r>F;)F++,ie.hasOwnProperty(F)&&(I=ie[F])}if(!q.isWhitespace&&!q.isEmpty){const r=x++,{fontSizeMult:A,src:S,index:B}=j.fontData,F=Q[S]||(Q[S]={});F[V]||(F[V]={path:q.path,pathBounds:[q.xMin,q.yMin,q.xMax,q.yMax]});const G=j.x+be,W=j.y+H.baseline+ye;N[2*r]=G,N[2*r+1]=W;const X=G+q.xMin*A,Y=W+q.yMin*A,K=G+q.xMax*A,Z=W+q.yMax*A;X<oe[0]&&(oe[0]=X),Y<oe[1]&&(oe[1]=Y),K>oe[2]&&(oe[2]=K),Z>oe[3]&&(oe[3]=Z),r%se==0&&(C={start:r,end:r,rect:[b,b,-b,-b]},le.push(C)),C.end++;const J=C.rect;if(X<J[0]&&(J[0]=X),Y<J[1]&&(J[1]=Y),K>J[2]&&(J[2]=K),Z>J[3]&&(J[3]=Z),D[r]=V,R[r]=B,ie){const A=3*r;$[A]=I>>16&255,$[A+1]=I>>8&255,$[A+2]=255&I}}}}})),ee){const r=S.length-B;r>1&&fillLigatureCaretPositions(ee,B,r)}}const ve=[];ue.forEach((({index:r,src:A,unitsPerEm:b,ascender:C,descender:I,lineHeight:x,capHeight:S,xHeight:B})=>{ve[r]={src:A,unitsPerEm:b,ascender:C,descender:I,lineHeight:x,capHeight:S,xHeight:B}})),ae.typesetting=now()-pe,ne({glyphIds:D,glyphFontIndices:R,glyphPositions:N,glyphData:Q,fontData:ve,caretPositions:ee,glyphColors:$,chunkedBounds:le,fontSize:F,topBaseline:ye+me[0].baseline,blockBounds:[be,ye-_e,be+he,ye],visibleBounds:oe,timings:ae})}))}function parsePercent(r){let A=r.match(/^([\d.]+)%$/),b=A?parseFloat(A[1]):NaN;return isNaN(b)?0:b/100}function fillLigatureCaretPositions(r,A,b){const C=r[4*A],I=r[4*A+1],x=r[4*A+2],S=r[4*A+3],B=(I-C)/b;for(let I=0;I<b;I++){const b=4*(A+I);r[b]=C+B*I,r[b+1]=C+B*(I+1),r[b+2]=x,r[b+3]=S}}function now(){return(self.performance||Date).now()}function TextLine(){this.data=[]}const S=["glyphObj","x","y","width","charIndex","fontData"];return TextLine.prototype={width:0,lineHeight:0,baseline:0,cap:0,ex:0,isSoftWrapped:!1,get count(){return Math.ceil(this.data.length/S.length)},glyphAt(r){let A=TextLine.flyweight;return A.data=this.data,A.index=r,A},splitAt(r){let A=new TextLine;return A.data=this.data.splice(r*S.length),A}},TextLine.flyweight=S.reduce(((r,A,b,C)=>(Object.defineProperty(r,A,{get(){return this.data[this.index*S.length+b]},set(r){this.data[this.index*S.length+b]=r}}),r)),{data:null,index:0}),{typeset:typeset,measure:function(r,A){typeset({...r,metricsOnly:!0},(r=>{const[b,C,I,x]=r.blockBounds;A({width:I-b,height:x-C})}))}}},Cr,function(){var r=function(r){var A={R:"13k,1a,2,3,3,2+1j,ch+16,a+1,5+2,2+n,5,a,4,6+16,4+3,h+1b,4mo,179q,2+9,2+11,2i9+7y,2+68,4,3+4,5+13,4+3,2+4k,3+29,8+cf,1t+7z,w+17,3+3m,1t+3z,16o1+5r,8+30,8+mc,29+1r,29+4v,75+73",EN:"1c+9,3d+1,6,187+9,513,4+5,7+9,sf+j,175h+9,qw+q,161f+1d,4xt+a,25i+9",ES:"17,2,6dp+1,f+1,av,16vr,mx+1,4o,2",ET:"z+2,3h+3,b+1,ym,3e+1,2o,p4+1,8,6u,7c,g6,1wc,1n9+4,30+1b,2n,6d,qhx+1,h0m,a+1,49+2,63+1,4+1,6bb+3,12jj",AN:"16o+5,2j+9,2+1,35,ed,1ff2+9,87+u",CS:"18,2+1,b,2u,12k,55v,l,17v0,2,3,53,2+1,b",B:"a,3,f+2,2v,690",S:"9,2,k",WS:"c,k,4f4,1vk+a,u,1j,335",ON:"x+1,4+4,h+5,r+5,r+3,z,5+3,2+1,2+1,5,2+2,3+4,o,w,ci+1,8+d,3+d,6+8,2+g,39+1,9,6+1,2,33,b8,3+1,3c+1,7+1,5r,b,7h+3,sa+5,2,3i+6,jg+3,ur+9,2v,ij+1,9g+9,7+a,8m,4+1,49+x,14u,2+2,c+2,e+2,e+2,e+1,i+n,e+e,2+p,u+2,e+2,36+1,2+3,2+1,b,2+2,6+5,2,2,2,h+1,5+4,6+3,3+f,16+2,5+3l,3+81,1y+p,2+40,q+a,m+13,2r+ch,2+9e,75+hf,3+v,2+2w,6e+5,f+6,75+2a,1a+p,2+2g,d+5x,r+b,6+3,4+o,g,6+1,6+2,2k+1,4,2j,5h+z,1m+1,1e+f,t+2,1f+e,d+3,4o+3,2s+1,w,535+1r,h3l+1i,93+2,2s,b+1,3l+x,2v,4g+3,21+3,kz+1,g5v+1,5a,j+9,n+v,2,3,2+8,2+1,3+2,2,3,46+1,4+4,h+5,r+5,r+a,3h+2,4+6,b+4,78,1r+24,4+c,4,1hb,ey+6,103+j,16j+c,1ux+7,5+g,fsh,jdq+1t,4,57+2e,p1,1m,1m,1m,1m,4kt+1,7j+17,5+2r,d+e,3+e,2+e,2+10,m+4,w,1n+5,1q,4z+5,4b+rb,9+c,4+c,4+37,d+2g,8+b,l+b,5+1j,9+9,7+13,9+t,3+1,27+3c,2+29,2+3q,d+d,3+4,4+2,6+6,a+o,8+6,a+2,e+6,16+42,2+1i",BN:"0+8,6+d,2s+5,2+p,e,4m9,1kt+2,2b+5,5+5,17q9+v,7k,6p+8,6+1,119d+3,440+7,96s+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+1,1ekf+75,6p+2rz,1ben+1,1ekf+1,1ekf+1",NSM:"lc+33,7o+6,7c+18,2,2+1,2+1,2,21+a,1d+k,h,2u+6,3+5,3+1,2+3,10,v+q,2k+a,1n+8,a,p+3,2+8,2+2,2+4,18+2,3c+e,2+v,1k,2,5+7,5,4+6,b+1,u,1n,5+3,9,l+1,r,3+1,1m,5+1,5+1,3+2,4,v+1,4,c+1,1m,5+4,2+1,5,l+1,n+5,2,1n,3,2+3,9,8+1,c+1,v,1q,d,1f,4,1m+2,6+2,2+3,8+1,c+1,u,1n,g+1,l+1,t+1,1m+1,5+3,9,l+1,u,21,8+2,2,2j,3+6,d+7,2r,3+8,c+5,23+1,s,2,2,1k+d,2+4,2+1,6+a,2+z,a,2v+3,2+5,2+1,3+1,q+1,5+2,h+3,e,3+1,7,g,jk+2,qb+2,u+2,u+1,v+1,1t+1,2+6,9,3+a,a,1a+2,3c+1,z,3b+2,5+1,a,7+2,64+1,3,1n,2+6,2,2,3+7,7+9,3,1d+g,1s+3,1d,2+4,2,6,15+8,d+1,x+3,3+1,2+2,1l,2+1,4,2+2,1n+7,3+1,49+2,2+c,2+6,5,7,4+1,5j+1l,2+4,k1+w,2db+2,3y,2p+v,ff+3,30+1,n9x+3,2+9,x+1,29+1,7l,4,5,q+1,6,48+1,r+h,e,13+7,q+a,1b+2,1d,3+3,3+1,14,1w+5,3+1,3+1,d,9,1c,1g,2+2,3+1,6+1,2,17+1,9,6n,3,5,fn5,ki+f,h+f,r2,6b,46+4,1af+2,2+1,6+3,15+2,5,4m+1,fy+3,as+1,4a+a,4x,1j+e,1l+2,1e+3,3+1,1y+2,11+4,2+7,1r,d+1,1h+8,b+3,3,2o+2,3,2+1,7,4h,4+7,m+1,1m+1,4,12+6,4+4,5g+7,3+2,2,o,2d+5,2,5+1,2+1,6n+3,7+1,2+1,s+1,2e+7,3,2+1,2z,2,3+5,2,2u+2,3+3,2+4,78+8,2+1,75+1,2,5,41+3,3+1,5,x+5,3+1,15+5,3+3,9,a+5,3+2,1b+c,2+1,bb+6,2+5,2d+l,3+6,2+1,2+1,3f+5,4,2+1,2+6,2,21+1,4,2,9o+1,f0c+4,1o+6,t5,1s+3,2a,f5l+1,43t+2,i+7,3+6,v+3,45+2,1j0+1i,5+1d,9,f,n+4,2+e,11t+6,2+g,3+6,2+1,2+4,7a+6,c6+3,15t+6,32+6,gzhy+6n",AL:"16w,3,2,e+1b,z+2,2+2s,g+1,8+1,b+m,2+t,s+2i,c+e,4h+f,1d+1e,1bwe+dp,3+3z,x+c,2+1,35+3y,2rm+z,5+7,b+5,dt+l,c+u,17nl+27,1t+27,4x+6n,3+d",LRO:"6ct",RLO:"6cu",LRE:"6cq",RLE:"6cr",PDF:"6cs",LRI:"6ee",RLI:"6ef",FSI:"6eg",PDI:"6eh"},b={},C={};b.L=1,C[1]="L",Object.keys(A).forEach((function(r,A){b[r]=1<<A+1,C[b[r]]=r})),Object.freeze(b);var I=b.LRI|b.RLI|b.FSI,x=b.L|b.R|b.AL,S=b.B|b.S|b.WS|b.ON|b.FSI|b.LRI|b.RLI|b.PDI,B=b.BN|b.RLE|b.LRE|b.RLO|b.LRO|b.PDF,D=b.S|b.WS|b.B|I|b.PDI|B,R=null;function getBidiCharType(r){return function(){if(!R){R=new Map;var loop=function(r){if(A.hasOwnProperty(r)){var C=0;A[r].split(",").forEach((function(A){var I=A.split("+"),x=I[0],S=I[1];x=parseInt(x,36),S=S?parseInt(S,36):0,R.set(C+=x,b[r]);for(var B=0;B<S;B++)R.set(++C,b[r])}))}};for(var r in A)loop(r)}}(),R.get(r.codePointAt(0))||b.L}var F,N,Q,H={pairs:"14>1,1e>2,u>2,2wt>1,1>1,1ge>1,1wp>1,1j>1,f>1,hm>1,1>1,u>1,u6>1,1>1,+5,28>1,w>1,1>1,+3,b8>1,1>1,+3,1>3,-1>-1,3>1,1>1,+2,1s>1,1>1,x>1,th>1,1>1,+2,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,4q>1,1e>2,u>2,2>1,+1",canonical:"6f1>-6dx,6dy>-6dx,6ec>-6ed,6ee>-6ed,6ww>2jj,-2ji>2jj,14r4>-1e7l,1e7m>-1e7l,1e7m>-1e5c,1e5d>-1e5b,1e5c>-14qx,14qy>-14qx,14vn>-1ecg,1ech>-1ecg,1edu>-1ecg,1eci>-1ecg,1eda>-1ecg,1eci>-1ecg,1eci>-168q,168r>-168q,168s>-14ye,14yf>-14ye"};function parseCharacterMap(r,A){var b,C=0,I=new Map,x=A&&new Map;return r.split(",").forEach((function visit(r){if(-1!==r.indexOf("+"))for(var S=+r;S--;)visit(b);else{b=r;var B=r.split(">"),D=B[0],R=B[1];D=String.fromCodePoint(C+=parseInt(D,36)),R=String.fromCodePoint(C+=parseInt(R,36)),I.set(D,R),A&&x.set(R,D)}})),{map:I,reverseMap:x}}function parse$1(){if(!F){var r=parseCharacterMap(H.pairs,!0),A=r.map,b=r.reverseMap;F=A,N=b,Q=parseCharacterMap(H.canonical,!1).map}}function openingToClosingBracket(r){return parse$1(),F.get(r)||null}function closingToOpeningBracket(r){return parse$1(),N.get(r)||null}function getCanonicalBracket(r){return parse$1(),Q.get(r)||null}var G,j=b.L,V=b.R,W=b.EN,X=b.ES,Y=b.ET,K=b.AN,q=b.CS,Z=b.B,J=b.S,$=b.ON,ee=b.BN,te=b.NSM,se=b.AL,ie=b.LRO,ne=b.RLO,re=b.LRE,ae=b.RLE,oe=b.PDF,le=b.LRI,he=b.RLI,de=b.FSI,ce=b.PDI;function getMirroredCharacter(r){return function(){if(!G){var r=parseCharacterMap("14>1,j>2,t>2,u>2,1a>g,2v3>1,1>1,1ge>1,1wd>1,b>1,1j>1,f>1,ai>3,-2>3,+1,8>1k0,-1jq>1y7,-1y6>1hf,-1he>1h6,-1h5>1ha,-1h8>1qi,-1pu>1,6>3u,-3s>7,6>1,1>1,f>1,1>1,+2,3>1,1>1,+13,4>1,1>1,6>1eo,-1ee>1,3>1mg,-1me>1mk,-1mj>1mi,-1mg>1mi,-1md>1,1>1,+2,1>10k,-103>1,1>1,4>1,5>1,1>1,+10,3>1,1>8,-7>8,+1,-6>7,+1,a>1,1>1,u>1,u6>1,1>1,+5,26>1,1>1,2>1,2>2,8>1,7>1,4>1,1>1,+5,b8>1,1>1,+3,1>3,-2>1,2>1,1>1,+2,c>1,3>1,1>1,+2,h>1,3>1,a>1,1>1,2>1,3>1,1>1,d>1,f>1,3>1,1a>1,1>1,6>1,7>1,13>1,k>1,1>1,+19,4>1,1>1,+2,2>1,1>1,+18,m>1,a>1,1>1,lk>1,1>1,4>1,2>1,f>1,3>1,1>1,+3,db>1,1>1,+3,3>1,1>1,+2,14qm>1,1>1,+1,6>1,4j>1,j>2,t>2,u>2,2>1,+1",!0),A=r.map;r.reverseMap.forEach((function(r,b){A.set(b,r)})),G=A}}(),G.get(r)||null}function getReorderSegments(r,A,b,C){var I=r.length;b=Math.max(0,null==b?0:+b),C=Math.min(I-1,null==C?I-1:+C);var x=[];return A.paragraphs.forEach((function(I){var S=Math.max(b,I.start),B=Math.min(C,I.end);if(S<B){for(var R=A.levels.slice(S,B+1),F=B;F>=S&&getBidiCharType(r[F])&D;F--)R[F]=I.level;for(var N=I.level,Q=1/0,H=0;H<R.length;H++){var G=R[H];G>N&&(N=G),G<Q&&(Q=1|G)}for(var j=N;j>=Q;j--)for(var V=0;V<R.length;V++)if(R[V]>=j){for(var W=V;V+1<R.length&&R[V+1]>=j;)V++;V>W&&x.push([W+S,V+S])}}})),x}function getReorderedIndices(r,A,b,C){for(var I=getReorderSegments(r,A,b,C),x=[],S=0;S<r.length;S++)x[S]=S;return I.forEach((function(r){for(var A=r[0],b=r[1],C=x.slice(A,b+1),I=C.length;I--;)x[b-I]=C[I]})),x}return r.closingToOpeningBracket=closingToOpeningBracket,r.getBidiCharType=getBidiCharType,r.getBidiCharTypeName=function(r){return C[getBidiCharType(r)]},r.getCanonicalBracket=getCanonicalBracket,r.getEmbeddingLevels=function(r,A){for(var b=new Uint32Array(r.length),C=0;C<r.length;C++)b[C]=getBidiCharType(r[C]);var R=new Map;function changeCharType(r,A){var C=b[r];b[r]=A,R.set(C,R.get(C)-1),C&S&&R.set(S,R.get(S)-1),R.set(A,(R.get(A)||0)+1),A&S&&R.set(S,(R.get(S)||0)+1)}for(var F=new Uint8Array(r.length),N=new Map,Q=[],H=null,G=0;G<r.length;G++)H||Q.push(H={start:G,end:r.length-1,level:"rtl"===A?1:"ltr"===A?0:determineAutoEmbedLevel(G,!1)}),b[G]&Z&&(H.end=G,H=null);for(var ue=ae|re|ne|ie|I|ce|oe|Z,nextEven=function(r){return r+(1&r?1:2)},nextOdd=function(r){return r+(1&r?2:1)},pe=0;pe<Q.length;pe++){var Ae=[{_level:(H=Q[pe]).level,_override:0,_isolate:0}],ge=void 0,fe=0,me=0,_e=0;R.clear();for(var be=H.start;be<=H.end;be++){var ye=b[be];if(ge=Ae[Ae.length-1],R.set(ye,(R.get(ye)||0)+1),ye&S&&R.set(S,(R.get(S)||0)+1),ye&ue)if(ye&(ae|re)){F[be]=ge._level;var ve=(ye===ae?nextOdd:nextEven)(ge._level);ve<=125&&!fe&&!me?Ae.push({_level:ve,_override:0,_isolate:0}):fe||me++}else if(ye&(ne|ie)){F[be]=ge._level;var Ce=(ye===ne?nextOdd:nextEven)(ge._level);Ce<=125&&!fe&&!me?Ae.push({_level:Ce,_override:ye&ne?V:j,_isolate:0}):fe||me++}else if(ye&I){ye&de&&(ye=1===determineAutoEmbedLevel(be+1,!0)?he:le),F[be]=ge._level,ge._override&&changeCharType(be,ge._override);var we=(ye===he?nextOdd:nextEven)(ge._level);we<=125&&0===fe&&0===me?(_e++,Ae.push({_level:we,_override:0,_isolate:1,_isolInitIndex:be})):fe++}else if(ye&ce){if(fe>0)fe--;else if(_e>0){for(me=0;!Ae[Ae.length-1]._isolate;)Ae.pop();var Ee=Ae[Ae.length-1]._isolInitIndex;null!=Ee&&(N.set(Ee,be),N.set(be,Ee)),Ae.pop(),_e--}ge=Ae[Ae.length-1],F[be]=ge._level,ge._override&&changeCharType(be,ge._override)}else ye&oe?(0===fe&&(me>0?me--:!ge._isolate&&Ae.length>1&&(Ae.pop(),ge=Ae[Ae.length-1])),F[be]=ge._level):ye&Z&&(F[be]=H.level);else F[be]=ge._level,ge._override&&ye!==ee&&changeCharType(be,ge._override)}for(var Ie=[],Te=null,xe=H.start;xe<=H.end;xe++){var Se=b[xe];if(!(Se&B)){var Be=F[xe],De=Se&I,Pe=Se===ce;Te&&Be===Te._level?(Te._end=xe,Te._endsWithIsolInit=De):Ie.push(Te={_start:xe,_end:xe,_level:Be,_startsWithPDI:Pe,_endsWithIsolInit:De})}}for(var Me=[],ke=0;ke<Ie.length;ke++){var Re=Ie[ke];if(!Re._startsWithPDI||Re._startsWithPDI&&!N.has(Re._start)){for(var Fe=[Te=Re],Le=void 0;Te&&Te._endsWithIsolInit&&null!=(Le=N.get(Te._end));)for(var Oe=ke+1;Oe<Ie.length;Oe++)if(Ie[Oe]._start===Le){Fe.push(Te=Ie[Oe]);break}for(var Ue=[],Ne=0;Ne<Fe.length;Ne++)for(var Qe=Fe[Ne],He=Qe._start;He<=Qe._end;He++)Ue.push(He);for(var Ge=F[Ue[0]],je=H.level,Ve=Ue[0]-1;Ve>=0;Ve--)if(!(b[Ve]&B)){je=F[Ve];break}var ze=Ue[Ue.length-1],We=F[ze],Xe=H.level;if(!(b[ze]&I))for(var Ye=ze+1;Ye<=H.end;Ye++)if(!(b[Ye]&B)){Xe=F[Ye];break}Me.push({_seqIndices:Ue,_sosType:Math.max(je,Ge)%2?V:j,_eosType:Math.max(Xe,We)%2?V:j})}}for(var Ke=0;Ke<Me.length;Ke++){var qe=Me[Ke],Ze=qe._seqIndices,Je=qe._sosType,$e=qe._eosType,et=1&F[Ze[0]]?V:j;if(R.get(te))for(var tt=0;tt<Ze.length;tt++){var st=Ze[tt];if(b[st]&te){for(var it=Je,nt=tt-1;nt>=0;nt--)if(!(b[Ze[nt]]&B)){it=b[Ze[nt]];break}changeCharType(st,it&(I|ce)?$:it)}}if(R.get(W))for(var rt=0;rt<Ze.length;rt++){var at=Ze[rt];if(b[at]&W)for(var ot=rt-1;ot>=-1;ot--){var lt=-1===ot?Je:b[Ze[ot]];if(lt&x){lt===se&&changeCharType(at,K);break}}}if(R.get(se))for(var ht=0;ht<Ze.length;ht++){var dt=Ze[ht];b[dt]&se&&changeCharType(dt,V)}if(R.get(X)||R.get(q))for(var ct=1;ct<Ze.length-1;ct++){var ut=Ze[ct];if(b[ut]&(X|q)){for(var pt=0,At=0,gt=ct-1;gt>=0&&(pt=b[Ze[gt]])&B;gt--);for(var ft=ct+1;ft<Ze.length&&(At=b[Ze[ft]])&B;ft++);pt===At&&(b[ut]===X?pt===W:pt&(W|K))&&changeCharType(ut,pt)}}if(R.get(W))for(var mt=0;mt<Ze.length;mt++){var _t=Ze[mt];if(b[_t]&W){for(var bt=mt-1;bt>=0&&b[Ze[bt]]&(Y|B);bt--)changeCharType(Ze[bt],W);for(mt++;mt<Ze.length&&b[Ze[mt]]&(Y|B|W);mt++)b[Ze[mt]]!==W&&changeCharType(Ze[mt],W)}}if(R.get(Y)||R.get(X)||R.get(q))for(var yt=0;yt<Ze.length;yt++){var vt=Ze[yt];if(b[vt]&(Y|X|q)){changeCharType(vt,$);for(var Ct=yt-1;Ct>=0&&b[Ze[Ct]]&B;Ct--)changeCharType(Ze[Ct],$);for(var wt=yt+1;wt<Ze.length&&b[Ze[wt]]&B;wt++)changeCharType(Ze[wt],$)}}if(R.get(W))for(var Et=0,It=Je;Et<Ze.length;Et++){var Tt=Ze[Et],xt=b[Tt];xt&W?It===j&&changeCharType(Tt,j):xt&x&&(It=xt)}if(R.get(S)){for(var St=V|W|K,Bt=St|j,Dt=[],Pt=[],Mt=0;Mt<Ze.length;Mt++)if(b[Ze[Mt]]&S){var kt=r[Ze[Mt]],Rt=void 0;if(null!==openingToClosingBracket(kt)){if(!(Pt.length<63))break;Pt.push({char:kt,seqIndex:Mt})}else if(null!==(Rt=closingToOpeningBracket(kt)))for(var Ft=Pt.length-1;Ft>=0;Ft--){var Lt=Pt[Ft].char;if(Lt===Rt||Lt===closingToOpeningBracket(getCanonicalBracket(kt))||openingToClosingBracket(getCanonicalBracket(Lt))===kt){Dt.push([Pt[Ft].seqIndex,Mt]),Pt.length=Ft;break}}}Dt.sort((function(r,A){return r[0]-A[0]}));for(var Ot=0;Ot<Dt.length;Ot++){for(var Ut=Dt[Ot],Nt=Ut[0],Qt=Ut[1],Ht=!1,Gt=0,jt=Nt+1;jt<Qt;jt++){var Vt=Ze[jt];if(b[Vt]&Bt){Ht=!0;var zt=b[Vt]&St?V:j;if(zt===et){Gt=zt;break}}}if(Ht&&!Gt){Gt=Je;for(var Wt=Nt-1;Wt>=0;Wt--){var Xt=Ze[Wt];if(b[Xt]&Bt){var Yt=b[Xt]&St?V:j;Gt=Yt!==et?Yt:et;break}}}if(Gt){if(b[Ze[Nt]]=b[Ze[Qt]]=Gt,Gt!==et)for(var Kt=Nt+1;Kt<Ze.length;Kt++)if(!(b[Ze[Kt]]&B)){getBidiCharType(r[Ze[Kt]])&te&&(b[Ze[Kt]]=Gt);break}if(Gt!==et)for(var qt=Qt+1;qt<Ze.length;qt++)if(!(b[Ze[qt]]&B)){getBidiCharType(r[Ze[qt]])&te&&(b[Ze[qt]]=Gt);break}}}for(var Zt=0;Zt<Ze.length;Zt++)if(b[Ze[Zt]]&S){for(var Jt=Zt,$t=Zt,es=Je,ts=Zt-1;ts>=0;ts--){if(!(b[Ze[ts]]&B)){es=b[Ze[ts]]&St?V:j;break}Jt=ts}for(var ss=$e,is=Zt+1;is<Ze.length;is++){if(!(b[Ze[is]]&(S|B))){ss=b[Ze[is]]&St?V:j;break}$t=is}for(var ns=Jt;ns<=$t;ns++)b[Ze[ns]]=es===ss?es:et;Zt=$t}}}for(var rs=H.start;rs<=H.end;rs++){var as=F[rs],os=b[rs];if(1&as?os&(j|W|K)&&F[rs]++:os&V?F[rs]++:os&(K|W)&&(F[rs]+=2),os&B&&(F[rs]=0===rs?H.level:F[rs-1]),rs===H.end||getBidiCharType(r[rs])&(J|Z))for(var ls=rs;ls>=0&&getBidiCharType(r[ls])&D;ls--)F[ls]=H.level}}return{levels:F,paragraphs:Q};function determineAutoEmbedLevel(A,C){for(var x=A;x<r.length;x++){var S=b[x];if(S&(V|se))return 1;if(S&(Z|j)||C&&S===ce)return 0;if(S&I){var B=indexOfMatchingPDI(x);x=-1===B?r.length:B}}return 0}function indexOfMatchingPDI(A){for(var C=1,x=A+1;x<r.length;x++){var S=b[x];if(S&Z)break;if(S&ce){if(0==--C)return x}else S&I&&C++}return-1}},r.getMirroredCharacter=getMirroredCharacter,r.getMirroredCharactersMap=function(r,A,b,C){var I=r.length;b=Math.max(0,null==b?0:+b),C=Math.min(I-1,null==C?I-1:+C);for(var x=new Map,S=b;S<=C;S++)if(1&A[S]){var B=getMirroredCharacter(r[S]);null!==B&&x.set(S,B)}return x},r.getReorderSegments=getReorderSegments,r.getReorderedIndices=getReorderedIndices,r.getReorderedString=function(r,A,b,C){var I=getReorderedIndices(r,A,b,C),x=[].concat(r);return I.forEach((function(b,C){x[C]=(1&A.levels[b]?getMirroredCharacter(r[b]):null)||r[b]})),x.join("")},r.openingToClosingBracket=openingToClosingBracket,Object.defineProperty(r,"__esModule",{value:!0}),r}({});return r}],init:(r,A,b)=>r(A,b())}),Ur=defineWorkerModule({name:"Typesetter",dependencies:[Or],init:r=>function(A){return new Promise((b=>{r.typeset(A,b)}))},getTransferables(r){const A=[];for(let b in r)r[b]&&r[b].buffer&&A.push(r[b].buffer);return A}}),Nr={},Qr="aTroikaGlyphIndex";class GlyphsGeometry extends it{constructor(){super(),this.detail=1,this.curveRadius=0,this.groups=[{start:0,count:1/0,materialIndex:0},{start:0,count:1/0,materialIndex:1}],this.boundingSphere=new V,this.boundingBox=new x}computeBoundingSphere(){}computeBoundingBox(){}setSide(r){const A=this.getIndex().count;this.setDrawRange(r===nt?A/2:0,r===G?A:A/2)}set detail(r){if(r!==this._detail){this._detail=r,("number"!=typeof r||r<1)&&(r=1);let A=function(r){let A=Nr[r];if(!A){const b=new rt(1,1,r,r),C=b.clone(),I=b.attributes,x=C.attributes,S=new Ie,B=I.uv.count;for(let r=0;r<B;r++)x.position.array[3*r]*=-1,x.normal.array[3*r+2]*=-1;["position","normal","uv"].forEach((r=>{S.setAttribute(r,new at([...I[r].array,...x[r].array],I[r].itemSize))})),S.setIndex([...b.index.array,...C.index.array.map((r=>r+B))]),S.translate(.5,.5,0),A=Nr[r]=S}return A}(r);["position","normal","uv"].forEach((r=>{this.attributes[r]=A.attributes[r].clone()})),this.setIndex(A.getIndex().clone())}}get detail(){return this._detail}set curveRadius(r){r!==this._curveRadius&&(this._curveRadius=r,this._updateBounds())}get curveRadius(){return this._curveRadius}updateGlyphs(r,A,b,C,I){updateBufferAttr(this,"aTroikaGlyphBounds",r,4),updateBufferAttr(this,Qr,A,1),updateBufferAttr(this,"aTroikaGlyphColor",I,3),this._blockBounds=b,this._chunkedBounds=C,this.instanceCount=A.length,this._updateBounds()}_updateBounds(){const r=this._blockBounds;if(r){const{curveRadius:A,boundingBox:b}=this;if(A){const{PI:C,floor:I,min:x,max:S,sin:B,cos:D}=Math,R=C/2,F=2*C,N=Math.abs(A),Q=r[0]/N,H=r[2]/N,G=I((Q+R)/F)!==I((H+R)/F)?-N:x(B(Q)*N,B(H)*N),j=I((Q-R)/F)!==I((H-R)/F)?N:S(B(Q)*N,B(H)*N),V=I((Q+C)/F)!==I((H+C)/F)?2*N:S(N-D(Q)*N,N-D(H)*N);b.min.set(G,r[1],A<0?-V:0),b.max.set(j,r[3],A<0?0:V)}else b.min.set(r[0],r[1],0),b.max.set(r[2],r[3],0);b.getBoundingSphere(this.boundingSphere)}}applyClipRect(r){let A=this.getAttribute(Qr).count,b=this._chunkedBounds;if(b)for(let C=b.length;C--;){A=b[C].end;let I=b[C].rect;if(I[1]<r.w&&I[3]>r.y&&I[0]<r.z&&I[2]>r.x)break}this.instanceCount=A}}function updateBufferAttr(r,A,b,C){const I=r.getAttribute(A);b?I&&I.array.length===b.length?(I.array.set(b),I.needsUpdate=!0):(r.setAttribute(A,new de(b,C)),delete r._maxInstanceCount,r.dispose()):I&&r.deleteAttribute(A)}function createTextDerivedMaterial(r){const A=createDerivedMaterial(r,{chained:!0,extensions:{derivatives:!0},uniforms:{uTroikaSDFTexture:{value:null},uTroikaSDFTextureSize:{value:new b},uTroikaSDFGlyphSize:{value:0},uTroikaSDFExponent:{value:0},uTroikaTotalBounds:{value:new F(0,0,0,0)},uTroikaClipRect:{value:new F(0,0,0,0)},uTroikaDistanceOffset:{value:0},uTroikaOutlineOpacity:{value:0},uTroikaFillOpacity:{value:1},uTroikaPositionOffset:{value:new b},uTroikaCurveRadius:{value:0},uTroikaBlurRadius:{value:0},uTroikaStrokeWidth:{value:0},uTroikaStrokeColor:{value:new Q},uTroikaStrokeOpacity:{value:1},uTroikaOrient:{value:new Ve},uTroikaUseGlyphColors:{value:!0},uTroikaSDFDebug:{value:!1}},vertexDefs:"\nuniform vec2 uTroikaSDFTextureSize;\nuniform float uTroikaSDFGlyphSize;\nuniform vec4 uTroikaTotalBounds;\nuniform vec4 uTroikaClipRect;\nuniform mat3 uTroikaOrient;\nuniform bool uTroikaUseGlyphColors;\nuniform float uTroikaDistanceOffset;\nuniform float uTroikaBlurRadius;\nuniform vec2 uTroikaPositionOffset;\nuniform float uTroikaCurveRadius;\nattribute vec4 aTroikaGlyphBounds;\nattribute float aTroikaGlyphIndex;\nattribute vec3 aTroikaGlyphColor;\nvarying vec2 vTroikaGlyphUV;\nvarying vec4 vTroikaTextureUVBounds;\nvarying float vTroikaTextureChannel;\nvarying vec3 vTroikaGlyphColor;\nvarying vec2 vTroikaGlyphDimensions;\n",vertexTransform:"\nvec4 bounds = aTroikaGlyphBounds;\nbounds.xz += uTroikaPositionOffset.x;\nbounds.yw -= uTroikaPositionOffset.y;\n\nvec4 outlineBounds = vec4(\n  bounds.xy - uTroikaDistanceOffset - uTroikaBlurRadius,\n  bounds.zw + uTroikaDistanceOffset + uTroikaBlurRadius\n);\nvec4 clippedBounds = vec4(\n  clamp(outlineBounds.xy, uTroikaClipRect.xy, uTroikaClipRect.zw),\n  clamp(outlineBounds.zw, uTroikaClipRect.xy, uTroikaClipRect.zw)\n);\n\nvec2 clippedXY = (mix(clippedBounds.xy, clippedBounds.zw, position.xy) - bounds.xy) / (bounds.zw - bounds.xy);\n\nposition.xy = mix(bounds.xy, bounds.zw, clippedXY);\n\nuv = (position.xy - uTroikaTotalBounds.xy) / (uTroikaTotalBounds.zw - uTroikaTotalBounds.xy);\n\nfloat rad = uTroikaCurveRadius;\nif (rad != 0.0) {\n  float angle = position.x / rad;\n  position.xz = vec2(sin(angle) * rad, rad - cos(angle) * rad);\n  normal.xz = vec2(sin(angle), cos(angle));\n}\n  \nposition = uTroikaOrient * position;\nnormal = uTroikaOrient * normal;\n\nvTroikaGlyphUV = clippedXY.xy;\nvTroikaGlyphDimensions = vec2(bounds[2] - bounds[0], bounds[3] - bounds[1]);\n\n\nfloat txCols = uTroikaSDFTextureSize.x / uTroikaSDFGlyphSize;\nvec2 txUvPerSquare = uTroikaSDFGlyphSize / uTroikaSDFTextureSize;\nvec2 txStartUV = txUvPerSquare * vec2(\n  mod(floor(aTroikaGlyphIndex / 4.0), txCols),\n  floor(floor(aTroikaGlyphIndex / 4.0) / txCols)\n);\nvTroikaTextureUVBounds = vec4(txStartUV, vec2(txStartUV) + txUvPerSquare);\nvTroikaTextureChannel = mod(aTroikaGlyphIndex, 4.0);\n",fragmentDefs:"\nuniform sampler2D uTroikaSDFTexture;\nuniform vec2 uTroikaSDFTextureSize;\nuniform float uTroikaSDFGlyphSize;\nuniform float uTroikaSDFExponent;\nuniform float uTroikaDistanceOffset;\nuniform float uTroikaFillOpacity;\nuniform float uTroikaOutlineOpacity;\nuniform float uTroikaBlurRadius;\nuniform vec3 uTroikaStrokeColor;\nuniform float uTroikaStrokeWidth;\nuniform float uTroikaStrokeOpacity;\nuniform bool uTroikaSDFDebug;\nvarying vec2 vTroikaGlyphUV;\nvarying vec4 vTroikaTextureUVBounds;\nvarying float vTroikaTextureChannel;\nvarying vec2 vTroikaGlyphDimensions;\n\nfloat troikaSdfValueToSignedDistance(float alpha) {\n  // Inverse of exponential encoding in webgl-sdf-generator\n  \n  float maxDimension = max(vTroikaGlyphDimensions.x, vTroikaGlyphDimensions.y);\n  float absDist = (1.0 - pow(2.0 * (alpha > 0.5 ? 1.0 - alpha : alpha), 1.0 / uTroikaSDFExponent)) * maxDimension;\n  float signedDist = absDist * (alpha > 0.5 ? -1.0 : 1.0);\n  return signedDist;\n}\n\nfloat troikaGlyphUvToSdfValue(vec2 glyphUV) {\n  vec2 textureUV = mix(vTroikaTextureUVBounds.xy, vTroikaTextureUVBounds.zw, glyphUV);\n  vec4 rgba = texture2D(uTroikaSDFTexture, textureUV);\n  float ch = floor(vTroikaTextureChannel + 0.5); //NOTE: can't use round() in WebGL1\n  return ch == 0.0 ? rgba.r : ch == 1.0 ? rgba.g : ch == 2.0 ? rgba.b : rgba.a;\n}\n\nfloat troikaGlyphUvToDistance(vec2 uv) {\n  return troikaSdfValueToSignedDistance(troikaGlyphUvToSdfValue(uv));\n}\n\nfloat troikaGetAADist() {\n  \n  #if defined(GL_OES_standard_derivatives) || __VERSION__ >= 300\n  return length(fwidth(vTroikaGlyphUV * vTroikaGlyphDimensions)) * 0.5;\n  #else\n  return vTroikaGlyphDimensions.x / 64.0;\n  #endif\n}\n\nfloat troikaGetFragDistValue() {\n  vec2 clampedGlyphUV = clamp(vTroikaGlyphUV, 0.5 / uTroikaSDFGlyphSize, 1.0 - 0.5 / uTroikaSDFGlyphSize);\n  float distance = troikaGlyphUvToDistance(clampedGlyphUV);\n \n  // Extrapolate distance when outside bounds:\n  distance += clampedGlyphUV == vTroikaGlyphUV ? 0.0 : \n    length((vTroikaGlyphUV - clampedGlyphUV) * vTroikaGlyphDimensions);\n\n  \n\n  return distance;\n}\n\nfloat troikaGetEdgeAlpha(float distance, float distanceOffset, float aaDist) {\n  #if defined(IS_DEPTH_MATERIAL) || defined(IS_DISTANCE_MATERIAL)\n  float alpha = step(-distanceOffset, -distance);\n  #else\n\n  float alpha = smoothstep(\n    distanceOffset + aaDist,\n    distanceOffset - aaDist,\n    distance\n  );\n  #endif\n\n  return alpha;\n}\n",fragmentColorTransform:"\nfloat aaDist = troikaGetAADist();\nfloat fragDistance = troikaGetFragDistValue();\nfloat edgeAlpha = uTroikaSDFDebug ?\n  troikaGlyphUvToSdfValue(vTroikaGlyphUV) :\n  troikaGetEdgeAlpha(fragDistance, uTroikaDistanceOffset, max(aaDist, uTroikaBlurRadius));\n\n#if !defined(IS_DEPTH_MATERIAL) && !defined(IS_DISTANCE_MATERIAL)\nvec4 fillRGBA = gl_FragColor;\nfillRGBA.a *= uTroikaFillOpacity;\nvec4 strokeRGBA = uTroikaStrokeWidth == 0.0 ? fillRGBA : vec4(uTroikaStrokeColor, uTroikaStrokeOpacity);\nif (fillRGBA.a == 0.0) fillRGBA.rgb = strokeRGBA.rgb;\ngl_FragColor = mix(fillRGBA, strokeRGBA, smoothstep(\n  -uTroikaStrokeWidth - aaDist,\n  -uTroikaStrokeWidth + aaDist,\n  fragDistance\n));\ngl_FragColor.a *= edgeAlpha;\n#endif\n\nif (edgeAlpha == 0.0) {\n  discard;\n}\n",customRewriter({vertexShader:r,fragmentShader:A}){let b=/\buniform\s+vec3\s+diffuse\b/;return b.test(A)&&(A=A.replace(b,"varying vec3 vTroikaGlyphColor").replace(/\bdiffuse\b/g,"vTroikaGlyphColor"),b.test(r)||(r=r.replace(ur,"uniform vec3 diffuse;\n$&\nvTroikaGlyphColor = uTroikaUseGlyphColors ? aTroikaGlyphColor / 255.0 : diffuse;\n"))),{vertexShader:r,fragmentShader:A}}});return A.transparent=!0,Object.defineProperties(A,{isTroikaTextMaterial:{value:!0},shadowSide:{get(){return this.side},set(){}}}),A}const Hr=new H({color:16777215,side:G,transparent:!0}),Gr=8421504,jr=new S,Vr=new A,zr=new A,Wr=[],Xr=new A,Yr="+x+y";function first(r){return Array.isArray(r)?r[0]:r}let getFlatRaycastMesh=()=>{const r=new D(new rt(1,1),Hr);return getFlatRaycastMesh=()=>r,r},getCurvedRaycastMesh=()=>{const r=new D(new rt(1,1,32,1),Hr);return getCurvedRaycastMesh=()=>r,r};const Kr={type:"syncstart"},qr={type:"synccomplete"},Zr=["font","fontSize","fontStyle","fontWeight","lang","letterSpacing","lineHeight","maxWidth","overflowWrap","text","direction","textAlign","textIndent","whiteSpace","anchorX","anchorY","colorRanges","sdfGlyphSize"],Jr=Zr.concat("material","color","depthOffset","clipRect","curveRadius","orientation","glyphGeometryDetail");class Text extends D{constructor(){super(new GlyphsGeometry,null),this.text="",this.anchorX=0,this.anchorY=0,this.curveRadius=0,this.direction="auto",this.font=null,this.unicodeFontsURL=null,this.fontSize=.1,this.fontWeight="normal",this.fontStyle="normal",this.lang=null,this.letterSpacing=0,this.lineHeight="normal",this.maxWidth=1/0,this.overflowWrap="normal",this.textAlign="left",this.textIndent=0,this.whiteSpace="normal",this.material=null,this.color=null,this.colorRanges=null,this.outlineWidth=0,this.outlineColor=0,this.outlineOpacity=1,this.outlineBlur=0,this.outlineOffsetX=0,this.outlineOffsetY=0,this.strokeWidth=0,this.strokeColor=Gr,this.strokeOpacity=1,this.fillOpacity=1,this.depthOffset=0,this.clipRect=null,this.orientation=Yr,this.glyphGeometryDetail=1,this.sdfGlyphSize=null,this.gpuAccelerateSDF=!0,this.debugSDF=!1}sync(r){this._needsSync&&(this._needsSync=!1,this._isSyncing?(this._queuedSyncs||(this._queuedSyncs=[])).push(r):(this._isSyncing=!0,this.dispatchEvent(Kr),getTextRenderInfo({text:this.text,font:this.font,lang:this.lang,fontSize:this.fontSize||.1,fontWeight:this.fontWeight||"normal",fontStyle:this.fontStyle||"normal",letterSpacing:this.letterSpacing||0,lineHeight:this.lineHeight||"normal",maxWidth:this.maxWidth,direction:this.direction||"auto",textAlign:this.textAlign,textIndent:this.textIndent,whiteSpace:this.whiteSpace,overflowWrap:this.overflowWrap,anchorX:this.anchorX,anchorY:this.anchorY,colorRanges:this.colorRanges,includeCaretPositions:!0,sdfGlyphSize:this.sdfGlyphSize,gpuAccelerateSDF:this.gpuAccelerateSDF,unicodeFontsURL:this.unicodeFontsURL},(A=>{this._isSyncing=!1,this._textRenderInfo=A,this.geometry.updateGlyphs(A.glyphBounds,A.glyphAtlasIndices,A.blockBounds,A.chunkedBounds,A.glyphColors);const b=this._queuedSyncs;b&&(this._queuedSyncs=null,this._needsSync=!0,this.sync((()=>{b.forEach((r=>r&&r()))}))),this.dispatchEvent(qr),r&&r()}))))}onBeforeRender(r,A,b,C,I,x){this.sync(),I.isTroikaTextMaterial&&this._prepareForRender(I),I._hadOwnSide=I.hasOwnProperty("side"),this.geometry.setSide(I._actualSide=I.side),I.side=Te}onAfterRender(r,A,b,C,I,x){I._hadOwnSide?I.side=I._actualSide:delete I.side}dispose(){this.geometry.dispose()}get textRenderInfo(){return this._textRenderInfo||null}get material(){let r=this._derivedMaterial;const A=this._baseMaterial||this._defaultMaterial||(this._defaultMaterial=Hr.clone());if(r&&r.baseMaterial===A||(r=this._derivedMaterial=createTextDerivedMaterial(A),A.addEventListener("dispose",(function onDispose(){A.removeEventListener("dispose",onDispose),r.dispose()}))),this.outlineWidth||this.outlineBlur||this.outlineOffsetX||this.outlineOffsetY){let A=r._outlineMtl;return A||(A=r._outlineMtl=Object.create(r,{id:{value:r.id+.1}}),A.isTextOutlineMaterial=!0,A.depthWrite=!1,A.map=null,r.addEventListener("dispose",(function onDispose(){r.removeEventListener("dispose",onDispose),A.dispose()}))),[A,r]}return r}set material(r){r&&r.isTroikaTextMaterial?(this._derivedMaterial=r,this._baseMaterial=r.baseMaterial):this._baseMaterial=r}get glyphGeometryDetail(){return this.geometry.detail}set glyphGeometryDetail(r){this.geometry.detail=r}get curveRadius(){return this.geometry.curveRadius}set curveRadius(r){this.geometry.curveRadius=r}get customDepthMaterial(){return first(this.material).getDepthMaterial()}get customDistanceMaterial(){return first(this.material).getDistanceMaterial()}_prepareForRender(r){const A=r.isTextOutlineMaterial,b=r.uniforms,C=this.textRenderInfo;if(C){const{sdfTexture:r,blockBounds:I}=C;b.uTroikaSDFTexture.value=r,b.uTroikaSDFTextureSize.value.set(r.image.width,r.image.height),b.uTroikaSDFGlyphSize.value=C.sdfGlyphSize,b.uTroikaSDFExponent.value=C.sdfExponent,b.uTroikaTotalBounds.value.fromArray(I),b.uTroikaUseGlyphColors.value=!A&&!!C.glyphColors;let x,S,B,D=0,R=0,F=0,N=0,Q=0;if(A){let{outlineWidth:r,outlineOffsetX:A,outlineOffsetY:b,outlineBlur:C,outlineOpacity:I}=this;D=this._parsePercent(r)||0,R=Math.max(0,this._parsePercent(C)||0),x=I,N=this._parsePercent(A)||0,Q=this._parsePercent(b)||0}else F=Math.max(0,this._parsePercent(this.strokeWidth)||0),F&&(B=this.strokeColor,b.uTroikaStrokeColor.value.set(null==B?Gr:B),S=this.strokeOpacity,null==S&&(S=1)),x=this.fillOpacity;b.uTroikaDistanceOffset.value=D,b.uTroikaPositionOffset.value.set(N,Q),b.uTroikaBlurRadius.value=R,b.uTroikaStrokeWidth.value=F,b.uTroikaStrokeOpacity.value=S,b.uTroikaFillOpacity.value=null==x?1:x,b.uTroikaCurveRadius.value=this.curveRadius||0;let H=this.clipRect;if(H&&Array.isArray(H)&&4===H.length)b.uTroikaClipRect.value.fromArray(H);else{const r=100*(this.fontSize||.1);b.uTroikaClipRect.value.set(I[0]-r,I[1]-r,I[2]+r,I[3]+r)}this.geometry.applyClipRect(b.uTroikaClipRect.value)}b.uTroikaSDFDebug.value=!!this.debugSDF,r.polygonOffset=!!this.depthOffset,r.polygonOffsetFactor=r.polygonOffsetUnits=this.depthOffset||0;const I=A?this.outlineColor||0:this.color;if(null==I)delete r.color;else{const A=r.hasOwnProperty("color")?r.color:r.color=new Q;I===A._input&&"object"!=typeof I||A.set(A._input=I)}let x=this.orientation||Yr;if(x!==r._orientation){let A=b.uTroikaOrient.value;x=x.replace(/[^-+xyz]/g,"");let C=x!==Yr&&x.match(/^([-+])([xyz])([-+])([xyz])$/);if(C){let[,r,b,I,x]=C;Vr.set(0,0,0)[b]="-"===r?1:-1,zr.set(0,0,0)[x]="-"===I?-1:1,jr.lookAt(Xr,Vr.cross(zr),zr),A.setFromMatrix4(jr)}else A.identity();r._orientation=x}}_parsePercent(r){if("string"==typeof r){let A=r.match(/^(-?[\d.]+)%$/),b=A?parseFloat(A[1]):NaN;r=(isNaN(b)?0:b/100)*this.fontSize}return r}localPositionToTextCoords(r,A=new b){A.copy(r);const C=this.curveRadius;return C&&(A.x=Math.atan2(r.x,Math.abs(C)-Math.abs(r.z))*Math.abs(C)),A}worldPositionToTextCoords(r,A=new b){return Vr.copy(r),this.localPositionToTextCoords(this.worldToLocal(Vr),A)}raycast(r,A){const{textRenderInfo:b,curveRadius:C}=this;if(b){const I=b.blockBounds,x=C?getCurvedRaycastMesh():getFlatRaycastMesh(),S=x.geometry,{position:B,uv:D}=S.attributes;for(let r=0;r<D.count;r++){let A=I[0]+D.getX(r)*(I[2]-I[0]);const b=I[1]+D.getY(r)*(I[3]-I[1]);let x=0;C&&(x=C-Math.cos(A/C)*C,A=Math.sin(A/C)*C),B.setXYZ(r,A,b,x)}S.boundingSphere=this.geometry.boundingSphere,S.boundingBox=this.geometry.boundingBox,x.matrixWorld=this.matrixWorld,x.material.side=this.material.side,Wr.length=0,x.raycast(r,Wr);for(let r=0;r<Wr.length;r++)Wr[r].object=this,A.push(Wr[r])}}copy(r){const A=this.geometry;return super.copy(r),this.geometry=A,Jr.forEach((A=>{this[A]=r[A]})),this}clone(){return(new this.constructor).copy(this)}}function getCaretAtPoint(r,A,b){let C=null;const I=function(r){let A=ea.get(r);if(!A){A=[];const{caretPositions:b}=r;let C;const visitCaret=(r,b,I,x)=>{(!C||I<(C.top+C.bottom)/2)&&A.push(C={bottom:b,top:I,carets:[]}),I>C.top&&(C.top=I),b<C.bottom&&(C.bottom=b),C.carets.push({x:r,y:b,height:I-b,charIndex:x})};let I=0;for(;I<b.length;I+=4)visitCaret(b[I],b[I+2],b[I+3],I/4);visitCaret(b[I-3],b[I-2],b[I-1],I/4)}return ea.set(r,A),A}(r);let x=null;return I.forEach((r=>{(!x||Math.abs(b-(r.top+r.bottom)/2)<Math.abs(b-(x.top+x.bottom)/2))&&(x=r)})),x.carets.forEach((r=>{(!C||Math.abs(A-r.x)<Math.abs(A-C.x))&&(C=r)})),C}Zr.forEach((r=>{const A="_private_"+r;Object.defineProperty(Text.prototype,r,{get(){return this[A]},set(r){r!==this[A]&&(this[A]=r,this._needsSync=!0)}})}));const $r=new WeakMap,ea=new WeakMap;var ta=Object.freeze({__proto__:null,GlyphsGeometry:GlyphsGeometry,Text:Text,configureTextBuilder:function(r){Rr?console.warn("configureTextBuilder called after first font request; will be ignored."):assign(Mr,r)},createTextDerivedMaterial:createTextDerivedMaterial,dumpSDFTextures:function(){Object.keys(Fr).forEach((r=>{const A=Fr[r].sdfCanvas,{width:b,height:C}=A;console.log("%c.",`\n      background: url(${A.toDataURL()});\n      background-size: ${b}px ${C}px;\n      color: transparent;\n      font-size: 0;\n      line-height: ${C}px;\n      padding-left: ${b}px;\n    `)}))},fontResolverWorkerModule:Cr,getCaretAtPoint:getCaretAtPoint,getSelectionRects:function(r,A,b){let C;if(r){let I=$r.get(r);if(I&&I.start===A&&I.end===b)return I.rects;const{caretPositions:x}=r;if(b<A){const r=A;A=b,b=r}A=Math.max(A,0),b=Math.min(b,x.length+1),C=[];let S=null;for(let r=A;r<b;r++){const A=x[4*r],b=x[4*r+1],I=Math.min(A,b),B=Math.max(A,b),D=x[4*r+2],R=x[4*r+3];(!S||D!==S.bottom||R!==S.top||I>S.right||B<S.left)&&(S={left:1/0,right:-1/0,bottom:D,top:R},C.push(S)),S.left=Math.min(I,S.left),S.right=Math.max(B,S.right)}C.sort(((r,A)=>A.bottom-r.bottom||r.left-A.left));for(let r=C.length-1;r-- >0;){const A=C[r],b=C[r+1];A.bottom===b.bottom&&A.top===b.top&&A.left<=b.right&&A.right>=b.left&&(b.left=Math.min(b.left,A.left),b.right=Math.max(b.right,A.right),C.splice(r,1))}$r.set(r,{start:A,end:b,rects:C})}return C},getTextRenderInfo:getTextRenderInfo,preloadFont:function({font:r,characters:A,sdfGlyphSize:b},C){getTextRenderInfo({font:r,sdfGlyphSize:b,text:Array.isArray(A)?A.join("\n"):""+A},C)},typesetterWorkerModule:Or});class Checkbox extends InteractableComponent{constructor(...r){super(...r),this._defaults.backgroundVisible=!0,this._defaults.borderMaterial.color.set(5197647),this._defaults.borderMaterial.opacity=.9,this._defaults.borderWidth=.002,this._defaults.color=16777215,this._defaults.height=.08,this._defaults.width=.08,this._text=new Text,this._content.add(this._text),this._text.text=" ",this._text.color=this.color,this._text.lineHeight=1,this._text.textAlign="center",this._text.anchorX="center",this._text.anchorY="middle",this.onClick=this.onTouch=()=>this._change(),"visible"!=this.overflow&&(this._text.material.clippingPlanes=this._getClippingPlanes()),this.updateLayout()}updateLayout(){super.updateLayout(),this._text.fontSize=.65*Math.min(this.computedHeight,this.computedWidth)}_updateMaterialOffset(r){super._updateMaterialOffset(r),this._text.depthOffset=-1*this._materialOffset-1,this._text.renderOrder=this._materialOffset+1}_change(){this._checked=!this._checked,this._checked?(this._text.text="✔",this.material.color.set(12543),this._text.sync()):(this._text.text="",this.material.color.set(16777215)),this._onChange&&this._onChange(this._checked)}get checked(){return this._checked}get onChange(){return this._onChange}set checked(r){r!=this._checked&&(this._checked=r,r?(this._text.text="✔",this.material.color.set(12543)):(this._text.text="",this.material.color.set(16777215)),this._text.sync())}set onChange(r){this._onChange=r}}class Div extends ScrollableComponent{constructor(...r){super(...r),this.updateLayout()}}const sa=new r.Vector3;let ia=class extends InteractableComponent{constructor(r,...A){super(...A),this._defaults.backgroundVisible=!0,this._defaults.textureFit="fill",this._imageHeight=0,this._imageWidth=0,this.updateLayout(),this.updateTexture(r)}_handleStyleUpdateForTextureFit(){this._updateFit(-1,1)}_computeDimension(r){if("auto"!=this[r])return super._computeDimension(r);let A="height"==r?"width":"height",b=capitalizeFirstLetter(r),C=capitalizeFirstLetter(A),I="computed"+b;if("auto"==this[A])this[I]=this["_image"+b]/100;else{"height"==r&&this._computeDimension("width");let A=this["computed"+C]/this["_image"+C];this[I]=this["_image"+b]*A||0}return this._computeUnpaddedAndMarginedDimensions(r,this[I]),this[I]}updateLayout(){let r=this.computedHeight,A=this.computedWidth;super.updateLayout(),this._updateFit(r,A)}_updateFit(r,A){let b=this.computedHeight,C=this.computedWidth;if((r!=this.computedHeight||A!=this.computedWidth)&&this?._texture?.image)if("cover"==this.textureFit){let I=C/b;if(I!=A/r){let r=this._texture.image.width/this._texture.image.height;I<r?(this._texture.repeat.x=I/r,this._texture.repeat.y=1,this._texture.offset.x=(1-this._texture.repeat.x)/2,this._texture.offset.y=0):(this._texture.repeat.x=1,this._texture.repeat.y=r/I,this._texture.offset.x=0,this._texture.offset.y=(1-this._texture.repeat.y)/2)}}else this._texture.repeat.x=1,this._texture.repeat.y=1,this._texture.offset.x=0,this._texture.offset.y=0}updateTexture(A){A?A instanceof r.Texture?this._updateTexture(A.bypassCloning?A:A.clone()):(new r.TextureLoader).load(A,(A=>{A.colorSpace=r.SRGBColorSpace,this._updateTexture(A)}),(()=>{}),(()=>{console.error("Couldn't load image :(")})):(this._texture&&this._texture.dispose(),this._texture=null,this.material.map=null,this.material.needsUpdate=!0)}_updateTexture(r){let A=this._texture;this._texture=r,this._imageWidth=r.image.width,this._imageHeight=r.image.height,this.material.map=r,this.material.needsUpdate=!0,this.updateLayout(),this._updateFit(-1,1),A&&A.dispose()}_createBackground(){super._createBackground();let r=this.computedWidth/2,A=this.computedHeight/2,b=this._background.geometry.attributes.position,C=this._background.geometry.attributes.uv;for(let I=0;I<b.count;I++)sa.fromBufferAttribute(b,I),C.setXY(I,(sa.x+r)/this.computedWidth,(sa.y+A)/this.computedHeight)}};class HueSaturationWheel extends ia{constructor(r,...A){super(r,...A)}_createBackground(){this._defaults.borderRadius=Math.min(this.computedHeight,this.computedHeight)/2,super._createBackground()}}const na=new r.Plane,ra=new r.Vector3,aa=256,oa=128;class HSLColor{constructor(r){this._hue=171,this._saturation=1,this._lightness=.5,this._radius=r||.1,this._createTextures(),this._createCursors()}_createTextures(){let A=2*this._radius,b=document.createElement("canvas"),C=document.createElement("canvas");b.width=256,b.height=256,C.width=1,C.height=aa,this._colorContext=b.getContext("2d"),this._lightnessContext=C.getContext("2d"),this._updateColorWheel(),this._updateLightnessBar(),this._colorTexture=new r.CanvasTexture(b),this._colorTexture.colorSpace=r.SRGBColorSpace,this._colorTexture.bypassCloning=!0,this._lightnessTexture=new r.CanvasTexture(C),this._lightnessTexture.colorSpace=r.SRGBColorSpace,this._lightnessTexture.bypassCloning=!0,this.hueSaturationWheel=new HueSaturationWheel(this._colorTexture,{height:A,width:A}),this.lightnessBar=new ia(this._lightnessTexture,{borderRadius:A/20,height:A,width:A/10}),this.hueSaturationWheel.pointerInteractable.addEventListener("down",(r=>this.hueSaturationWheel.pointerInteractable.capture(r.owner))),this.hueSaturationWheel.onClick=r=>{this._handleColorCursorDrag(r),this._onBlur&&this._onBlur(this.getColor())},this.hueSaturationWheel.onDrag=r=>{this._handleColorCursorDrag(r)},this.lightnessBar.pointerInteractable.addEventListener("down",(r=>this.lightnessBar.pointerInteractable.capture(r.owner))),this.lightnessBar.onClick=r=>{this._handleLightnessCursorDrag(r),this._onBlur&&this._onBlur(this.getColor())},this.lightnessBar.onDrag=r=>{this._handleLightnessCursorDrag(r)}}_updateColorWheel(){let r=this._colorContext.getImageData(0,0,256,256),A=r.data;this._drawColorWheel(A),this._colorContext.putImageData(r,0,0)}_drawColorWheel(r){let A=this._lightness;for(let b=-128;b<=oa;b++){let C=b*b,I=Math.ceil(Math.sqrt(16384-C));for(let C=-I;C<=I;C++){let[I,x]=cartesianToPolar(b,C);if(I>oa)continue;let S=4*(b+oa+256*(C+oa)),B=radiansToDegrees(x),D=I/oa,[R,F,N]=hslToRGB(B,D,A);r[S]=R,r[S+1]=F,r[S+2]=N,r[S+3]=255}}}_updateLightnessBar(){let r=this._lightnessContext.getImageData(0,0,1,aa),A=r.data;for(let r=0;r<1;r++)for(let b=0;b<aa;b++){let C=4*(r+1*b),I=this._hue,x=this._saturation,S=1-b/aa,[B,D,R]=hslToRGB(I,x,S);A[C]=B,A[C+1]=D,A[C+2]=R,A[C+3]=255}this._lightnessContext.putImageData(r,0,0)}_handleColorCursorDrag(r){let{owner:A,point:b}=r;b||(na.set(ra.set(0,0,1),0),na.applyMatrix4(this.hueSaturationWheel.matrixWorld),b=A.raycaster.ray.intersectPlane(na,ra)),ra.copy(b),this.hueSaturationWheel.worldToLocal(ra);let C=this.selectColorFromXY(ra.x,ra.y);null!=C&&this._onChange&&(this._onChange(C),this._updateColorCursor(),this._colorCursor.visible||(this._colorCursor.visible=!0))}_handleLightnessCursorDrag(r){let{owner:A,point:b}=r;b||(na.set(ra.set(0,0,1),0),na.applyMatrix4(this.lightnessBar.matrixWorld),b=A.raycaster.ray.intersectPlane(na,ra)),ra.copy(b),this.lightnessBar.worldToLocal(ra);let C=this.selectLightnessFromXY(ra.x,ra.y);null!=C&&this._onChange&&(this._onChange(C),this._updateLightnessCursor(),this._lightnessCursor.visible||(this._lightnessCursor.visible=!0))}_createCursors(){let A=new r.RingGeometry(this._radius/12,this._radius/10,16),b=new r.MeshBasicMaterial({color:16777215,side:r.FrontSide,transparent:!0,polygonOffset:!0,polygonOffsetFactor:-10,polygonOffsetUnits:-10});this._colorCursor=new r.Mesh(A,b),this._colorCursor.position.setZ(2e-8),this.hueSaturationWheel.add(this._colorCursor),this._colorCursor.visible=!1,A=new r.RingGeometry(this._radius/9,this._radius/7.5,4,1,Math.PI/4);let C=A.getAttribute("position");for(let r=0;r<C.count;r++){let A=C.getY(r);A>0&&C.setY(r,A-this._radius/20),A<0&&C.setY(r,A+this._radius/20)}this._lightnessCursor=new r.Mesh(A,b),this._lightnessCursor.position.setZ(2e-8),this.lightnessBar.add(this._lightnessCursor),this._lightnessCursor.visible=!1}_updateColorCursor(){let[r,A]=this.getXY(this._radius);ra.set(r,-A,0),this._colorCursor.position.setX(ra.x),this._colorCursor.position.setY(ra.y);let b=this._colorCursor.material,C=this.hueSaturationWheel._materialOffset+1;b.polygonOffsetFactor!=-1*C&&(b.polygonOffsetFactor=-1*C,b.polygonOffsetUnits=-1*C,this._colorCursor.renderOrder=C)}_updateLightnessCursor(){let r=this.getLightness(this._radius);ra.set(0,(r-.5)*this._radius*2,0),this._lightnessCursor.position.setX(ra.x),this._lightnessCursor.position.setY(ra.y)}getColorTexture(){return this._colorTexture}getLightnessTexture(){return this._lightnessTexture}getXY(A){return polarToCartesian(this._saturation*A,r.MathUtils.degToRad(this._hue+180))}getLightness(){return this._lightness}setFromHSL(r){this._hue=360*r.h,this._saturation=r.s,this._lightness=r.l,this._updateColorWheel(),this._updateColorCursor(),this._updateLightnessBar(),this._updateLightnessCursor(),this._colorTexture.needsUpdate=!0,this._lightnessTexture.needsUpdate=!0}selectColorFromXY(r,A){let[b,C]=cartesianToPolar(r,A);b>this._radius&&(b=this._radius);let I=radiansToDegrees(-C),x=b/this._radius;return this._hue=I,this._saturation=x,this._updateLightnessBar(),this._lightnessTexture.needsUpdate=!0,this.getColor()}selectLightnessFromXY(r,A){let b=A/(2*this._radius)+.5;return b<0&&(b=0),b>1&&(b=1),this._lightness=b,this._updateColorWheel(),this._colorTexture.needsUpdate=!0,this.getColor()}getColor(){let[r,A,b]=hslToRGB(this._hue,this._saturation,this._lightness);return rgbToHex(r,A,b)}isDragging(){return this.hueSaturationWheel.pointerInteractable.state==nn.SELECTED||nn.SELECTED==this.lightnessBar.pointerInteractable.state}get onBlur(){return this._onBlur}get onChange(){return this._onChange}get radius(){return this._radius}set onBlur(r){this._onBlur=r}set onChange(r){this._onChange=r}set radius(r){this._radius=r}}class Span extends ScrollableComponent{constructor(...r){super(...r),this._defaults.contentDirection="row",this.updateLayout()}}class TextComponent extends LayoutComponent{constructor(r,...A){super(...A),this._defaults.color=0,this._defaults.fontSize=.1,this._defaults.textAlign="left",this._text=new Text,this._content.add(this._text),this.font&&(this._text.font=this.font),this._text.color=this.color,this._text.fontSize=this.fontSize,this._text.textAlign=this.textAlign,this._text.anchorX="center",this._text.anchorY="middle",this._text.overflowWrap="break-word",typeof this.maxWidth==Number&&(this._text.maxWidth=this.maxWidth),this._text.addEventListener("synccomplete",(()=>this.updateLayout())),this._text.sync(),this._text.text=r||"",this._text.sync(),"visible"!=this.overflow&&(this._text.material.clippingPlanes=this._getClippingPlanes())}_handleStyleUpdateForColor(){this._text.color=this.color}_handleStyleUpdateForFont(){this._text.font=this.font,"auto"!=this.width&&"auto"!=this.height||this.updateLayout()}_handleStyleUpdateForFontSize(){this._text.fontSize=this.fontSize,"auto"!=this.width&&"auto"!=this.height||this.updateLayout()}_handleStyleUpdateForTextAlign(){this._text.textAlign=this.textAlign}_handleStyleUpdateForMaxWidth(){null!=this.maxWidth?"number"==typeof this.maxWidth&&(this._text.maxWidth=this.maxWidth):this._text.maxWidth=null,super._handleStyleUpdateForMaxWidth()}_computeDimension(r,A){if("auto"!=this[A||r]){let b=super._computeDimension(r,A);return"width"==r&&(this._text.maxWidth=b),b}let b=capitalizeFirstLetter(r),C="computed"+b,I="max"+b,x="min"+b,S=this._text.textRenderInfo;if(S){let A=S.blockBounds;this[C]="width"==r?Math.abs(A[0]-A[2]):Math.abs(A[1]-A[3])}if(A)return this[C];if(0==this[C]&&null!=this[x])this._computeDimension(r,x);else if("width"==r&&this[I]){let A=this[C];this._computeDimension(r,I),this._text.maxWidth=this[C],A<this[C]&&(this[C]=A)}return this._computeUnpaddedAndMarginedDimensions(r,this[C]),this[C]}_updateMaterialOffset(r){super._updateMaterialOffset(r),this._text.depthOffset=-1*this._materialOffset-1,this._text.renderOrder=this._materialOffset+1}get text(){return this._text.text}get troikaText(){return this._text}set text(r){this._text.text=r,this._text.sync()}}const la={name:"English",pages:[{style:{padding:.01},rows:[{keys:["q","w",{text:"e",type:"key",value:"e",additionalCharacters:["è","é","ë","ê"]},"r","t","y",{text:"u",type:"key",value:"u",additionalCharacters:["ù","ú","ü","û"]},{text:"i",type:"key",value:"i",additionalCharacters:["ì","í","ï","î"]},{text:"o",type:"key",value:"o",additionalCharacters:["ò","ó","ö","ô","ø"]},"p"]},{keys:[{text:"a",type:"key",value:"a",additionalCharacters:["à","á","ä","â"]},"s","d","f","g","h","j","k","l"]},{keys:[{text:"⇧",type:"shift",style:{width:.155}},"z","x",{text:"c",type:"key",value:"c",additionalCharacters:["ç"]},"v","b",{text:"n",type:"key",value:"n",additionalCharacters:["ñ"]},"m",{text:"⌫",type:"key",value:"Backspace",style:{width:.155}}]},{keys:[{text:"123",type:"page",page:1,style:{width:.155}},",",{text:"space",type:"key",value:" ",style:{width:.539}},".",{text:"⏎",type:"key",value:"Enter",style:{width:.155}}]}]},{style:{padding:.01},rows:[{keys:["1","2","3","4","5","6","7","8","9","0"]},{keys:["-","/",":",";","(",")","$","&","@",'"']},{keys:[{text:"#+=",type:"page",page:2,style:{width:.155,marginRight:.115}},".",",","?","!","'",{text:"⌫",type:"key",value:"Backspace",style:{width:.155,marginLeft:.115}}]},{keys:[{text:"ABC",type:"page",page:0,style:{width:.155}},{text:"space",type:"key",value:" ",style:{width:.759}},{text:"⏎",type:"key",value:"Enter",style:{width:.155}}]}]},{style:{padding:.01},rows:[{keys:["[","]","{","}","#","%","^","*","+","="]},{keys:["_","\\","|","~","<",">","€","£","¥","•"]},{style:{justifyContent:"spaceBetween",width:"100%"},keys:[{text:"123",type:"page",page:1,style:{width:.155,marginRight:.115}},".",",","?","!","'",{text:"⌫",type:"key",value:"Backspace",style:{width:.155,marginLeft:.115}}]},{keys:[{text:"ABC",type:"page",page:0,style:{width:.155}},{text:"space",type:"key",value:" ",style:{width:.759}},{text:"⏎",type:"key",value:"Enter",style:{width:.155}}]}]}]},ha={name:"Numbers",pages:[{style:{padding:.01},rows:[{keys:["1","2","3"]},{keys:["4","5","6"]},{keys:["7","8","9"]},{keys:[".","0",{text:"⌫",type:"key",value:"Backspace"}]},{keys:["±",{text:"⏎",type:"key",value:"Enter",style:{width:.21}}]}]}]},da={name:"русский",pages:[{style:{padding:.01},rows:[{keys:["й","ц","у","к","е","н","г","ш","щ","з","х","ъ"]},{keys:["ф","ы","в","а","п","р","о","л","д","ж","э","ë"]},{keys:[{text:"⇧",type:"shift",style:{width:.155}},"я","ч","с","м","и","т","ь","б","ю",{text:"⌫",type:"key",value:"Backspace",style:{width:.155}}]},{keys:[{text:"123",type:"page",page:1,style:{width:.155}},",",{text:"space",type:"key",value:" ",style:{width:.539}},".",{text:"⏎",type:"key",value:"Enter",style:{width:.155}}]}]},{style:{padding:.01,marginLeft:.11,marginRight:.11},rows:[{keys:["1","2","3","4","5","6","7","8","9","0"]},{keys:["@","#",":",";","%","-","+","=","(",")"]},{keys:[{text:"~[<",type:"page",page:2,style:{width:.155}},".",",","?","!",'"',"'","₽",{text:"⌫",type:"key",value:"Backspace",style:{width:.155}}]},{keys:[{text:"АБВ",type:"page",page:0,style:{width:.155}},"\\",{text:"space",type:"key",value:" ",style:{width:.539}},"/",{text:"⏎",type:"key",value:"Enter",style:{width:.155}}]}]},{style:{padding:.01,marginLeft:.11,marginRight:.11},rows:[{keys:["[","]","{","}","`","^","*","&","«","»"]},{keys:["$","€","£","¥","•","_","|","~","<",">"]},{style:{justifyContent:"spaceBetween",width:"100%"},keys:[{text:"123",type:"page",page:1,style:{width:.155}},".",",","?","!",'"',"'","₽",{text:"⌫",type:"key",value:"Backspace",style:{width:.155}}]},{keys:[{text:"АБВ",type:"page",page:0,style:{width:.155}},"\\",{text:"space",type:"key",value:" ",style:{width:.539}},"/",{text:"⏎",type:"key",value:"Enter",style:{width:.155}}]}]}]},ca={name:"😀",pages:[{style:{padding:.01},rows:[{keys:["😀","😃","😄","😁","😆","😅","🤣","😂","🙂","🙃"]},{keys:["🫠","😉","😊","😇","🥰","😍","🤩","😘","😗","☺"]},{keys:["😚","😙","🥲","😋","😛","😜","🤪","😝","🤑","🤗"]},{keys:[{text:"←",type:"page",page:3,style:{width:.155}},{text:"→",type:"page",page:1,style:{width:.155}},{text:"space",type:"key",value:" ",style:{width:.429}},{text:"⏎",type:"key",value:"Enter",style:{width:.155}},{text:"⌫",type:"key",value:"Backspace",style:{width:.155}}]}]},{style:{padding:.01},rows:[{keys:["🤭","🫢","🫣","🤫","🤔","🫡","🤐","🤨","😐","😑"]},{keys:["😶","🫥","😶‍🌫","😏","😒","🙄","😬","😮‍💨","🤥","😌"]},{keys:["😔","😪","🤤","😴","😷","🤒","🤕","🤢","🤮","🤧"]},{keys:[{text:"←",type:"page",page:0,style:{width:.155}},{text:"→",type:"page",page:2,style:{width:.155}},{text:"space",type:"key",value:" ",style:{width:.429}},{text:"⏎",type:"key",value:"Enter",style:{width:.155}},{text:"⌫",type:"key",value:"Backspace",style:{width:.155}}]}]},{style:{padding:.01},rows:[{keys:["🥵","🥶","🥴","😵","😵‍💫","🤯","🤠","🥳","🥸","😎"]},{keys:["🤓","🧐","😕","🫤","😟","🙁","☹","😮","😯","😲"]},{keys:["😳","🥺","🥹","😦","😧","😨","😰","😥","😢","😭"]},{keys:[{text:"←",type:"page",page:1,style:{width:.155}},{text:"→",type:"page",page:3,style:{width:.155}},{text:"space",type:"key",value:" ",style:{width:.429}},{text:"⏎",type:"key",value:"Enter",style:{width:.155}},{text:"⌫",type:"key",value:"Backspace",style:{width:.155}}]}]},{style:{padding:.01},rows:[{keys:["😱","😖","😣","😞","😓","😩","😫","🥱","😤","😡"]},{keys:["😠","🤬","😈","👿","💀","☠","💩","","",""]},{keys:["","","","","","","","","",""]},{keys:[{text:"←",type:"page",page:2,style:{width:.155}},{text:"→",type:"page",page:0,style:{width:.155}},{text:"space",type:"key",value:" ",style:{width:.429}},{text:"⏎",type:"key",value:"Enter",style:{width:.155}},{text:"⌫",type:"key",value:"Backspace",style:{width:.155}}]}]}]},ua=new Style({backgroundVisible:!0,borderRadius:.01,height:.1,justifyContent:"center",margin:.005,paddingLeft:.02,paddingRight:.02,width:.1}),pa=new Style({material:new r.MeshBasicMaterial({color:15790320,side:r.DoubleSide,transparent:!0,polygonOffset:!0,polygonOffsetFactor:1,polygonOffsetUnits:1})}),Aa={fontSize:.065},ga="UNSHIFTED",fa="SHIFTED",ma="CAPS_LOCK";function getComponentBody(r){for(;r&&!(r instanceof Body);)r=r.parent;return r}let _a=new class extends InteractableComponent{constructor(...r){super(...r),this.bypassContentPositioning=!0,this._defaults.backgroundVisible=!0,this._defaults.materialColor=12633550,this._layouts={},this._keyboardPageLayouts=[],this._timeoutIds=new Map,this._updateListeners=new Map,this._setupGrabBar(),this._createOptionsPanel(),this._addLayout(la),this._addLayout(da),this._addLayout(ca),this._setLayout(la),this.types={NUMBER:"NUMBER"},this.onClick=()=>{},this.updateLayout()}_createBackground(){this._defaults.borderRadius=Math.min(this.computedHeight,this.computedHeight)/20,super._createBackground()}_createOptionsPanel(){this._optionsPanelParent=new r.Object3D,this.add(this._optionsPanelParent),this._optionsPanel=new Div({backgroundVisible:!0,borderRadius:.06,height:.12,justifyContent:"center",materialColor:12633550,width:.12});let A=new Div({backgroundVisible:!0,borderRadius:.05,height:.1,justifyContent:"center",width:.1}),b=new TextComponent("🌐",Aa);this._optionsPanel.add(A),A.add(b),A.pointerInteractable.addHoveredCallback((r=>{r?A.addStyle(pa):A.removeStyle(pa)})),A.onClick=A.onTouch=()=>{this._setLanguagesPage()}}_addOptionsPanel(){this._optionsPanelParent.add(this._optionsPanel),this._optionsPanelParent.position.x=this.computedWidth/-2-.1}_addLayout(r){this._layouts[r.name]=r}_setLayout(r){if("string"!=typeof r||(r=this._layouts[r])){for(let r of this._content.children)r instanceof LayoutComponent&&this.remove(r);this._keyboardLayout=r,this._keyboardPageLayouts=[],this._keyboardPage=null,this._shiftState=ga,this._setPage(0)}}_setPage(r){if(this._keyboardPage==r)return;for(let r of this._content.children)r instanceof LayoutComponent&&this.remove(r);if(this._keyboardPage=r,this._keyboardPageLayouts[r])return this.add(this._keyboardPageLayouts[r]),void this._addOptionsPanel();let A=new Div(this._keyboardLayout.pages[r].style);for(let b of this._keyboardLayout.pages[r].rows){let C=new Span(b.style);for(let A of b.keys){let b=new Div(ua,A.style),I=A;"string"!=typeof A&&(I=A.text);let x=new TextComponent(I,Aa);b.add(x),C.add(b),b.pointerInteractable.addHoveredCallback((r=>{r?b.addStyle(pa):b.removeStyle(pa)})),"string"!=typeof A&&A.additionalCharacters&&this._addAdditionalCharacters(b,A);let listener=()=>{if(this._registeredComponent)if("string"==typeof A){let A=this._shiftState==ga?I:I.toUpperCase();this._registeredComponent.handleKey(A),this._shiftState==fa&&A!=I&&(this._shiftState=ga,this._shiftCase(r,!1))}else if("key"==A.type){let b=this._shiftState==ga||A.value.length>1?A.value:A.value.toUpperCase();this._registeredComponent.handleKey(b),this._shiftState==fa&&b!=A.value&&(this._shiftState=ga,this._shiftCase(r,!1))}else"page"==A.type?(this._shiftState!=ga&&(this._shiftState=ga,this._shiftCase(r,!1)),this._setPage(A.page)):"shift"==A.type&&(this._shiftState==ga?(this._shiftState=fa,this._shiftCase(r,!0)):this._shiftState==fa?this._shiftState=ma:this._shiftState==ma&&(this._shiftState=ga,this._shiftCase(r,!1)))};b.pointerInteractable.addEventListener("click",listener),b.touchInteractable.addEventListener("click",listener)}A.add(C)}this._keyboardPageLayouts[r]=A,this.add(A),this._addOptionsPanel(),this._reposition()}_addAdditionalCharacters(r,A){r.pointerInteractable.addEventListener("down",(b=>{let C=b.owner;if(b.additionalCharactersOwner)return;this._timeoutIds.set(C,setTimeout((()=>{this._displayAdditionalCharacters(r,A),this._timeoutIds.delete(C)}),500)),r.additionalCharactersOwner=C;let outCallback=A=>{A.owner==C&&(this._timeoutIds.has(C)&&(clearTimeout(this._timeoutIds.get(C)),this._timeoutIds.delete(C),Ji.remove(this._updateListeners.get(C)),delete r.additionalCharactersOwner),r.pointerInteractable.removeEventListener("out",outCallback))};r.pointerInteractable.addEventListener("out",outCallback),this._updateListeners.set(C,(()=>{let A;A="XR"==an.active?this._isXRControllerPressed(C):"POINTER"==an.active?$n.isPointerPressed():$n.isScreenTouched(),A||(this._timeoutIds.has(C)&&(clearTimeout(this._timeoutIds.get(C)),this._timeoutIds.delete(C)),r.additionalCharactersSpan&&r.remove(r.additionalCharactersSpan),r.pointerInteractable.removeEventListener("out",outCallback),Ji.remove(this._updateListeners.get(C)),delete r.additionalCharactersOwner)})),Ji.add(this._updateListeners.get(C))}))}_isXRControllerPressed(r){let A=r.object.xrInputDeviceType,b=r.object.handedness;if(A==ln.HAND){let r=$n.getXRControllerModel(A,b);return 1==r?.motionController?.isPinching}{let r=$n.getXRGamepad(b);return null!=r?.buttons&&r.buttons[0].pressed}}_displayAdditionalCharacters(r,A){if(r.additionalCharactersSpan)return r.additionalCharactersSpan.borderRadius=this.borderRadius,r.additionalCharactersSpan._updateMaterialOffset(r._materialOffset+1),void r.add(r.additionalCharactersSpan);let b=A.additionalCharacters,C=new Span({backgroundVisible:!0,materialColor:12633550});C.bypassContentPositioning=!0,C.position.y=r.computedHeight;for(let r of b){let b=new Div(ua,A.style),I=new TextComponent(r,Aa);this._shiftState!=ga&&(I.text=I.text.toUpperCase()),b.add(I),C.add(b),b.pointerInteractable.addEventListener("over",(()=>{b.addStyle(pa)})),b.pointerInteractable.addEventListener("out",(()=>{b.removeStyle(pa)})),b.pointerInteractable.addEventListener("up",(()=>{let A=this._shiftState==ga?r:r.toUpperCase();this._registeredComponent.handleKey(A),this._shiftState==fa&&(this._shiftState=ga,this._shiftCase(this._keyboardPage,!1))}))}C.borderRadius=this.borderRadius;let I=r?.parentComponent?.parentComponent?.padding;I&&(C.padding=I,C.position.y+=I),C._updateMaterialOffset(r._materialOffset+1),r.additionalCharactersSpan=C,r.add(C)}_setLanguagesPage(){for(let r of this._content.children)r instanceof LayoutComponent&&this.remove(r);let r,A=0,b=new Div({padding:.01});for(let C in this._layouts){A%2==0&&(r=new Span,b.add(r)),A++;let I=new Div(ua,{width:.3}),x=new TextComponent(C,Aa);I.add(x),r.add(I),I.pointerInteractable.addHoveredCallback((r=>{r?I.addStyle(pa):I.removeStyle(pa)})),I.onClick=I.onTouch=()=>{this._setLayout(C)}}this.add(b),this._optionsPanelParent.remove(this._optionsPanel),this._reposition()}_setNumberPage(){this._lastKeyboardLayout||(this._lastKeyboardLayout=this._keyboardLayout),this._setLayout(ha),this._optionsPanelParent.remove(this._optionsPanel)}_shiftCase(r,A){let b=A?"toUpperCase":"toLowerCase";for(let A of this._keyboardPageLayouts[r]._content.children)for(let r of A._content.children){let A=r._content.children[0];if(1==A.text.length&&(A.text=A.text[b]()),r.additionalCharactersSpan){let A=r.additionalCharactersSpan._content.children;for(let r of A){let A=r._content.children[0];A.text=A.text[b]()}}}}_reposition(){if(this._placeGrabBar(),!this._onPopup&&this._registeredComponent){let r=getComponentBody(this._registeredComponent);if(r||(r=this._registeredComponent),this.parent!=r)return;this.position.set(0,(-r.computedHeight-this.computedHeight*this.scale.y)/2-.025,0)}}register(r,A){this._registeredComponent&&this._registeredComponent.blur(),this._registeredComponent=r;let b=getComponentBody(r);A==this.types.NUMBER&&this._setNumberPage(),this._placeGrabBar(),this._onPopup?this._onPopup(r,b):(b||(b=r),this.position.set(0,(-b.computedHeight-this.computedHeight*this.scale.y)/2-.025,0),this.rotation.set(0,0,0),b.add(this),this._updateMaterialOffset(r._materialOffset))}unregister(r){this._registeredComponent==r&&(this._registeredComponent=null,this.parent&&this.parent.remove(this),this._grabBarOwner=this._priorParent=null),this._lastKeyboardLayout&&(this._setLayout(this._lastKeyboardLayout),this._lastKeyboardLayout=null)}_placeGrabBar(){this._grabBar.position.y=-this.computedHeight/2-.025}_setupGrabBar(){this._grabBar=new Body({backgroundVisible:!1,borderRadius:.025,height:.05,justifyContent:"center",width:.21});let r=new Div({backgroundVisible:!0,borderRadius:.01,height:.02,materialColor:12633550,width:.2});this._grabBar.pointerInteractable.addHoveredCallback((A=>{r.material.color.set(A?16777215:12633550)})),this._grabBar.pointerInteractable.addEventListener("down",(r=>{this._grabBarOwner||(this._priorParent=this.parent),this._grabBarOwner=r.owner,r.owner.object.attach(this),this._grabBar.pointerInteractable.capture(r.owner)})),this._grabBar.pointerInteractable.addEventListener("click",(r=>{this.parent==r.owner.object&&(this._priorParent.attach(this),this._grabBarOwner=this._priorParent=null)})),this._grabBar.add(r),this.add(this._grabBar)}get onPopup(){return this._onPopup}set onPopup(r){this._onPopup=r}},ba=new class{constructor(){this._listeners=new Set}setup(){"XR"!=an.active&&(this._eventType="TOUCH_SCREEN"==an.active?"touchend":"click",this._clickListener=()=>{setTimeout((()=>{for(let r of this._listeners)r(),this._listeners.delete(r)}),30)},document.addEventListener(this._eventType,this._clickListener))}trigger(r){this._listeners.add(r)}};var ya,va;(va=ya||(ya={}))[va.HIGH_SURROGATE_START=55296]="HIGH_SURROGATE_START",va[va.HIGH_SURROGATE_END=56319]="HIGH_SURROGATE_END",va[va.LOW_SURROGATE_START=56320]="LOW_SURROGATE_START",va[va.REGIONAL_INDICATOR_START=127462]="REGIONAL_INDICATOR_START",va[va.REGIONAL_INDICATOR_END=127487]="REGIONAL_INDICATOR_END",va[va.FITZPATRICK_MODIFIER_START=127995]="FITZPATRICK_MODIFIER_START",va[va.FITZPATRICK_MODIFIER_END=127999]="FITZPATRICK_MODIFIER_END",va[va.VARIATION_MODIFIER_START=65024]="VARIATION_MODIFIER_START",va[va.VARIATION_MODIFIER_END=65039]="VARIATION_MODIFIER_END",va[va.DIACRITICAL_MARKS_START=8400]="DIACRITICAL_MARKS_START",va[va.DIACRITICAL_MARKS_END=8447]="DIACRITICAL_MARKS_END",va[va.SUBDIVISION_INDICATOR_START=127988]="SUBDIVISION_INDICATOR_START",va[va.TAGS_START=917504]="TAGS_START",va[va.TAGS_END=917631]="TAGS_END",va[va.ZWJ=8205]="ZWJ";const Ca=Object.freeze([776,2359,2367,2984,3007,3021,3633,3635,3648,3657,4352,4449,4520]);var wa;function runes(r){if("string"!=typeof r)throw new TypeError("string cannot be undefined or null");const A=[];let b=0,C=0;for(;b<r.length;)C+=nextUnits(b+C,r),isGrapheme(r[b+C])&&C++,isVariationSelector(r[b+C])&&C++,isDiacriticalMark(r[b+C])&&C++,isZeroWidthJoiner(r[b+C])?C++:(A.push(r.substring(b,b+C)),b+=C,C=0);return A}function nextUnits(r,A){const b=A[r];if(!function(r){return r&&betweenInclusive(r[0].charCodeAt(0),55296,56319)}(b)||r===A.length-1)return 1;const C=b+A[r+1];let I=A.substring(r+2,r+5);return isRegionalIndicator(C)&&isRegionalIndicator(I)?4:function(r){return betweenInclusive(codePointFromSurrogatePair(r),127988,127988)}(C)&&function(r){const A=r.codePointAt(0);return"string"==typeof r&&"number"==typeof A&&betweenInclusive(A,917504,917631)}(I)?A.slice(r).indexOf(String.fromCodePoint(917631))+2:function(r){return betweenInclusive(codePointFromSurrogatePair(r),127995,127999)}(I)?4:2}function isRegionalIndicator(r){return betweenInclusive(codePointFromSurrogatePair(r),127462,127487)}function isVariationSelector(r){return"string"==typeof r&&betweenInclusive(r.charCodeAt(0),65024,65039)}function isDiacriticalMark(r){return"string"==typeof r&&betweenInclusive(r.charCodeAt(0),8400,8447)}function isGrapheme(r){return"string"==typeof r&&Ca.includes(r.charCodeAt(0))}function isZeroWidthJoiner(r){return"string"==typeof r&&8205===r.charCodeAt(0)}function codePointFromSurrogatePair(r){return(r.charCodeAt(0)-55296<<10)+(r.charCodeAt(1)-56320)+65536}function betweenInclusive(r,A,b){return r>=A&&r<=b}!function(r){r[r.unit_1=1]="unit_1",r[r.unit_2=2]="unit_2",r[r.unit_4=4]="unit_4"}(wa||(wa={}));const Ea=new r.Vector3,Ia=new Set,Ta=new Set;Ia.add("ArrowLeft"),Ia.add("ArrowRight"),Ia.add("ArrowUp"),Ia.add("ArrowDown"),Ta.add("Alt"),Ta.add("Backspace"),Ta.add("CapsLock"),Ta.add("Control"),Ta.add("Enter"),Ta.add("Escape"),Ta.add("Meta"),Ta.add("Shift"),Ta.add("Tab");class TextArea extends ScrollableComponent{constructor(...r){super(...r),this._defaults.alignItems="start",this._defaults.backgroundVisible=!0,this._defaults.borderMaterial.color.set(5197647),this._defaults.borderWidth=.002,this._defaults.color=0,this._defaults.contentDirection="row",this._defaults.justifyContent="start",this._defaults.fontSize=.06,this._defaults.overflow="scroll",this._defaults.paddingLeft=.01,this._defaults.height=.1,this._defaults.width=.4,this._latestValue.overflow=null,this._value=[],this._runeLengths=[],this._textStyle=new Style({color:this.color,fontSize:this.fontSize,textAlign:"left",maxWidth:0,minHeight:0}),this._text=new TextComponent("",this._textStyle),this._placeholder=new TextComponent("",this._textStyle,{color:8421504}),this._placeholder.troikaText.material.opacity=.75,this._content.add(this._text),this._content.add(this._placeholder),this._createCaret(),this.onClick=r=>this._select(r),this.onTouch=r=>this._selectTouch(r),this._keyListener=r=>this.handleKey(r.key),this._pasteListener=r=>this._handlePaste(r),this._downListener=r=>{let A=r.target;for(;A;){if(A==_a||A==this)return;A=A.parent}this.blur()},this._syncCompleteListener=()=>{this._updateCaret(),this._checkForCaretScroll()},this.updateLayout(),"visible"==this.overflow||this.clippingPlanes||this._createClippingPlanes()}_handleStyleUpdateForColor(){this._textStyle.color=this.color}_handleStyleUpdateForFontSize(){this._textStyle.fontSize=this.fontSize}_computeUnpaddedAndMarginedDimensions(r,A){super._computeUnpaddedAndMarginedDimensions(r,A),"width"==r&&this._textStyle.maxWidth!=this.unpaddedWidth&&(this._textStyle.maxWidth=this.unpaddedWidth)}_updateMaterialOffset(r){super._updateMaterialOffset(r),this._caret._updateMaterialOffset(this._materialOffset+1)}_selectTouch(r){let A=this.touchInteractable.getClosestPointTo(r.owner.object),b=A[1].object,C=b.bvhGeometry.index.array[3*A[1].faceIndex],I=b.bvhGeometry.getAttribute("position");Ea.fromBufferAttribute(I,C),b.localToWorld(Ea),this._select({point:Ea})}_select(r){let{point:A}=r;if(!A)return;this._textStyle.minHeight!=this._caret.computedHeight&&(this._textStyle.minHeight=this._caret.computedHeight),this._text._content.add(this._caretParent);let b=this._text._text;b.worldToLocal(Ea.copy(A));let C=getCaretAtPoint(b.textRenderInfo,Ea.x,Ea.y);this._setCaretIndexFromCharIndex(C.charIndex),this._updateCaret(),this._hasListeners||this._addListeners()}_addListeners(){this._hasListeners=!0,"XR"==an.active?(_a.register(this),tr.addEventListener("down",this._downListener)):"TOUCH_SCREEN"==an.active?this._displayMobileTextArea():(document.addEventListener("keydown",this._keyListener),document.addEventListener("paste",this._pasteListener),tr.addEventListener("down",this._downListener)),this._text._text.addEventListener("synccomplete",this._syncCompleteListener),this._onFocus&&this._onFocus()}_removeListeners(){this._hasListeners=!1,"XR"==an.active?(_a.unregister(this),tr.removeEventListener("down",this._downListener)):"TOUCH_SCREEN"==an.active?document.body.removeChild(this._mobileTextAreaParent):(document.removeEventListener("keydown",this._keyListener),document.removeEventListener("paste",this._pasteListener),tr.removeEventListener("down",this._downListener)),this._text._text.removeEventListener("synccomplete",this._syncCompleteListener),this._text._content.remove(this._caretParent),this._triggerBlurCallback()}_triggerBlurCallback(){this._onBlur&&this._onBlur(this._text.text)}_triggerChangeCallback(){this._onChange&&this._onChange(this._text.text)}_displayMobileTextArea(){if(!this._mobileTextArea){let r=document.createElement("div"),A=document.createElement("textarea");A.rows=5,A.style.fontSize="16px",A.style.minWidth="250px",A.style.width="33%",r.style.width="100%",r.style.height="100%",r.style.position="fixed",r.style.top="0px",r.style.left="0px",r.style.display="flex",r.style.justifyContent="center",r.style.alignItems="center",r.style.backgroundColor="#00000069",r.appendChild(A),r.onclick=b=>{b.target==r&&(this._text.text=A.value,this.blur())},A.onblur=()=>{this._text.text=A.value,this.blur()},A.addEventListener("compositionend",(()=>{this._text.text!=A.value&&(this._text.text=A.value,this._triggerChangeCallback())})),A.onkeyup=()=>{this._text.text!=A.value&&(this._text.text=A.value,this._triggerChangeCallback())},this._mobileTextAreaParent=r,this._mobileTextArea=A}document.body.appendChild(this._mobileTextAreaParent),ba.trigger((()=>this._mobileTextArea.click()))}_createCaret(){this._caretParent=new r.Object3D,this._caret=new TextComponent("|",this._textStyle),this._caret._text.fillOpacity=.75,this._caretParent.add(this._caret)}_getCharIndex(r=this._caretIndex){let A=0;for(let b=0;b<r;b++)A+=this._runeLengths[b];return A}_setCaretIndexFromCharIndex(r=0){let A,b=0,C=0;for(A=0;A<this._runeLengths.length&&b<r;A++)C=b,b+=this._runeLengths[A];let I=Math.abs(r-b),x=Math.abs(r-C);this._caretIndex=b==r||I<x?A:A-1}_updateCaret(){let r=this._getCharIndex(),A=4*r,b=0;if(r==this._text.text.length){if(0==r)return void this._caretParent.position.set(0,0,0);A-=4,b=1}let C=this._text._text.textRenderInfo.caretPositions,I=C[A+b],x=(C[A+2]+C[A+3])/2;isNaN(x)||this._caretParent.position.set(I,x,0)}handleKey(r){$n.isKeyPressed("Control")||$n.isKeyPressed("Meta")||("Backspace"==r?this._deleteChar():"Enter"==r?this.insertContent("\n"):"Escape"==r?this.blur():Ia.has(r)?this._moveCaret(r):Ta.has(r)||this.insertContent(r))}_handlePaste(r){if(r.clipboardData.types.indexOf("text/plain")<0)return;let A=r.clipboardData.getData("text/plain");this.insertContent(A),r.preventDefault()}_moveCaret(r){if("ArrowLeft"==r)this._caretIndex>0&&(this._caretIndex--,this._updateCaret());else if("ArrowRight"==r)this._caretIndex<this._value.length&&(this._caretIndex++,this._updateCaret());else{let A=this._getCharIndex(),b=this._text.text,C="ArrowUp"==r?1:-1,I=4*A,x=0;this._caretIndex==b.length&&0!=this._caretIndex&&(I-=4,x=1);let S=this._text._text,B=S.textRenderInfo.caretPositions,D=B[I+x],R=(B[I+2]+B[I+3])/2,F=Math.abs(B[I+2]-B[I+3]),N=getCaretAtPoint(S.textRenderInfo,D,R+C*F);this._setCaretIndexFromCharIndex(N.charIndex),this._updateCaret()}this._checkForCaretScroll()}_deleteChar(){0!=this._caretIndex&&(this._value.splice(this._caretIndex-1,1),this._runeLengths.splice(this._caretIndex-1,1),this._text.text=this._value.join(""),this._caretIndex--,this._updateCaret(),0!=this._value.length||this._placeholder.parentComponent||this._content.add(this._placeholder),this._triggerChangeCallback())}_checkForCaretScroll(){if(!this._scrollable&&0!=this._content.position.y)return void(this._content.position.y=0);Ea.copy(this._caretParent.position),this._caretParent.parent.localToWorld(Ea),this.worldToLocal(Ea);let r=this.computedHeight/2,A=this._caret.computedHeight/2;Ea.y+A>r?this._content.position.y+=r-Ea.y-A:Ea.y-A<this.computedHeight/-2&&(this._content.position.y+=-r-Ea.y+A)}_sanitizeText(){}blur(){this._hasListeners&&this._removeListeners()}insertContent(r){let A=runes(r);this._value.splice(this._caretIndex,0,...A),this._text.text=this._value.join("");for(let r=0;r<A.length;r++)this._runeLengths.splice(this._caretIndex,0,A[r].length),this._caretIndex++;this._sanitizeText(),this._placeholder.parentComponent&&this._content.remove(this._placeholder),this._triggerChangeCallback()}get onBlur(){return this._onBlur}get onChange(){return this._onChange}get onFocus(){return this._onFocus}get placeholder(){return this._placeholder.text}get value(){return this._text.text}set onBlur(r){this._onBlur=r}set onChange(r){this._onChange=r}set onFocus(r){this._onFocus=r}set placeholder(r){this._placeholder.text=r}set value(r){r||(r=""),this._value=runes(r),this._text.text=r,this._runeLengths=[];for(let r=0;r<this._value.length;r++)this._runeLengths.push(this._value[r].length);0==this._value.length?this._placeholder.parentComponent||this._content.add(this._placeholder):this._placeholder.parentComponent&&this._content.remove(this._placeholder)}}const xa=new r.Vector3,Sa=new Set,Ba=new Set;Sa.add("ArrowLeft"),Sa.add("ArrowRight"),Ba.add("ArrowUp"),Ba.add("ArrowDown"),Ba.add("Alt"),Ba.add("Backspace"),Ba.add("CapsLock"),Ba.add("Control"),Ba.add("Enter"),Ba.add("Escape"),Ba.add("Meta"),Ba.add("Shift"),Ba.add("Tab");class TextInput extends TextArea{constructor(...r){super(...r),this._defaults.alignItems="center",this._latestValue.alignItems=null,this._text._overrideStyle.maxWidth=null,this._text._text.whiteSpace="nowrap",this.updateLayout()}_displayMobileTextArea(){if(!this._mobileTextArea){let r=document.createElement("div"),A=document.createElement("input");A.type="text",A.style.fontSize="16px",A.style.minWidth="250px",A.style.width="33%",r.style.width="100%",r.style.height="100%",r.style.position="fixed",r.style.top="0px",r.style.left="0px",r.style.display="flex",r.style.justifyContent="center",r.style.alignItems="center",r.style.backgroundColor="#00000069",r.appendChild(A),r.onclick=b=>{b.target==r&&(this._text.text=A.value,this.blur())},A.onblur=()=>{this._text.text=A.value,this.blur()},A.addEventListener("compositionend",(()=>{this._text.text!=A.value&&(this._text.text=A.value,this._triggerChangeCallback())})),A.onkeyup=r=>{"Enter"!=r.code?this._text.text!=A.value&&(this._text.text=A.value,this._triggerChangeCallback()):this._onEnter&&this._onEnter(this._text.text)},this._mobileTextAreaParent=r,this._mobileTextArea=A}document.body.appendChild(this._mobileTextAreaParent),ba.trigger((()=>this._mobileTextArea.click()))}handleKey(r){$n.isKeyPressed("Control")||$n.isKeyPressed("Meta")||("Backspace"==r?this._deleteChar():"Enter"==r?this._onEnter&&this._onEnter(this._text.text):"Escape"==r?this.blur():Sa.has(r)?this._moveCaret(r):Ba.has(r)||this.insertContent(r))}_handlePaste(r){if(r.clipboardData.types.indexOf("text/plain")<0)return;let A=r.clipboardData.getData("text/plain");this.insertContent(A.replaceAll("\n"," ")),r.preventDefault()}_moveCaret(r){"ArrowLeft"==r?this._caretIndex>0&&(this._caretIndex--,this._updateCaret()):"ArrowRight"==r&&this._caretIndex<this._value.length&&(this._caretIndex++,this._updateCaret()),this._checkForCaretScroll()}_checkForCaretScroll(){if(!this._scrollable&&0!=this._content.position.x)return void(this._content.position.x=0);xa.copy(this._caretParent.position),this._caretParent.parent.localToWorld(xa),this.worldToLocal(xa);let r=this.computedWidth/2,A=this._caret.computedWidth/2;xa.x+A>r?this._content.position.x+=r-xa.x-A:xa.x-A<this.computedWidth/-2&&(this._content.position.x+=-r-xa.x+A)}get onEnter(){return this._onEnter}get value(){return super.value}set onEnter(r){this._onEnter=r}set value(r){r||(r=""),r=r.replaceAll("\n"," "),super.value=r}}const Da=new r.Vector3,Pa=new Set,Ma=new Set;Pa.add("ArrowLeft"),Pa.add("ArrowRight"),Ma.add("e"),Ma.add("E"),Ma.add("+");class NumberInput extends TextInput{constructor(...r){super(...r),this._defaults.alignItems="center",this._latestValue.alignItems=null,this._text._overrideStyle.maxWidth=null,this._text._text.whiteSpace="nowrap",this._minValue=-1/0,this._maxValue=1/0,this._lastValidValue="",this.updateLayout()}_addListeners(){this._hasListeners=!0,"XR"==an.active?(_a.register(this,_a.types.NUMBER),tr.addEventListener("down",this._downListener)):"TOUCH_SCREEN"==an.active?this._displayMobileTextArea():(document.addEventListener("keydown",this._keyListener),document.addEventListener("paste",this._pasteListener),tr.addEventListener("down",this._downListener)),this._text._text.addEventListener("synccomplete",this._syncCompleteListener),this._onFocus&&this._onFocus()}_displayMobileTextArea(){if(!this._mobileTextArea){let r=document.createElement("div"),A=document.createElement("input");A.type="text",A.inputMode="decimal",A.style.fontSize="16px",A.style.minWidth="250px",A.style.width="33%",r.style.width="100%",r.style.height="100%",r.style.position="fixed",r.style.top="0px",r.style.left="0px",r.style.display="flex",r.style.justifyContent="center",r.style.alignItems="center",r.style.backgroundColor="#00000069",r.appendChild(A),r.onclick=b=>{b.target==r&&(this._text.text=A.value,this.blur())},A.onblur=()=>{this._text.text=A.value,this.blur()},A.onkeydown=r=>{(Ma.has(r.key)||A.value.includes(".")&&"."==r.key||!r.key.match(/^[0-9.-]*$/)&&"Backspace"!=r.key&&"Enter"!=r.key)&&r.preventDefault()},A.onkeyup=r=>{"Enter"!=r.key?this._text.text!=A.value&&(this._text.text=A.value,this._triggerChangeCallback()):this._onEnter&&this._onEnter(this._text.text)},this._mobileTextAreaParent=r,this._mobileTextArea=A}document.body.appendChild(this._mobileTextAreaParent),ba.trigger((()=>this._mobileTextArea.click()))}handleKey(r){$n.isKeyPressed("Control")||$n.isKeyPressed("Meta")||("Backspace"==r?this._deleteChar():"Enter"==r?this._onEnter&&this._onEnter(this._text.text):"Escape"==r?this.blur():"±"==r?this._negate():Pa.has(r)?this._moveCaret(r):r.match(/^[0-9.-]*$/)&&this.insertContent(r))}_handlePaste(r){if(r.clipboardData.types.indexOf("text/plain")<0)return;let A=r.clipboardData.getData("text/plain");this.insertContent(A),r.preventDefault()}_checkForCaretScroll(){if(!this._scrollable&&0!=this._content.position.x)return void(this._content.position.x=0);Da.copy(this._caretParent.position),this._caretParent.parent.localToWorld(Da),this.worldToLocal(Da);let r=this.computedWidth/2,A=this._caret.computedWidth/2;Da.x+A>r?this._content.position.x+=r-Da.x-A:Da.x-A<this.computedWidth/-2&&(this._content.position.x+=-r-Da.x+A)}_triggerBlurCallback(){let r=Number.parseFloat(this._text.text);isNaN(r)?this.value=this._lastValidValue:"number"==typeof this._minValue&&r<this._minValue?this.value=this._minValue:"number"==typeof this._maxValue&&r>this._maxValue&&(this.value=this._maxValue),this._lastValidValue=this._text.text,this._onBlur&&this._onBlur(this._text.text)}_triggerChangeCallback(){let r=Number.parseFloat(this._text.text);isNaN(r)||"number"==typeof this._minValue&&r<this._minValue||"number"==typeof this._maxValue&&r>this._maxValue||(this._lastValidValue=this._text.text,this._onChange&&this._onChange(this._text.text))}_sanitizeIncomingText(r,A){let b=!1,C=!1;return r=r.replaceAll(/[^0-9.-]/g,""),A&&(-1!=A.indexOf(".")&&(b=!0),-1!=A.indexOf("-")&&(C=!0)),b?r=r.replaceAll(".",""):-1!=r.indexOf(".")&&(r=r.split(".")[0]+"."+r.split(".").slice(1).join("")),C?r=r.replaceAll("-",""):-1!=r.indexOf("-")&&(r="-"+r.replaceAll("-","")),r}_negate(){this._text.text.indexOf("-")>=0?(this.value=this._text.text.replaceAll("-",""),this._moveCaret("ArrowLeft")):(this.value="-"+this.value,this._moveCaret("ArrowRight"))}_sanitizeScientificNotation(r){let A=r.toString().split("e"),b=A[0].replaceAll(".",""),C=Math.abs(A[1])-1,I="0."+"0".repeat(C)+b;return I.indexOf("-")>-1&&(I="-"+I.replace("-","")),I}_sanitizeText(){this._text.text.indexOf("-")>0&&(this.value="-"+this._text.text.replaceAll("-",""))}insertContent(r){r=this._sanitizeIncomingText(r,this._text.text),super.insertContent(r)}get maxValue(){return this._maxValue}get minValue(){return this._minValue}get onEnter(){return this._onEnter}get value(){return super.value}set maxValue(r){this._maxValue=r}set minValue(r){this._minValue=r}set onEnter(r){this._onEnter=r}set value(r){null==r&&(r=Math.max(this._minValue,0)),r=Math.abs(r)<=1e-7?this._sanitizeScientificNotation(r):this._sanitizeIncomingText(String(r)),super.value=r,this._lastValidValue=this._text.text}}const ka={},Ra=new r.MeshBasicMaterial({color:12543,side:r.DoubleSide,transparent:!0,polygonOffset:!0,polygonOffsetFactor:1,polygonOffsetUnits:1});const Fa=new r.MeshBasicMaterial({color:12543,side:r.DoubleSide,transparent:!0,polygonOffset:!0,polygonOffsetFactor:1,polygonOffsetUnits:1}),La=new r.Vector3,Oa=new r.Plane;class Select extends ScrollableComponent{constructor(...r){super(...r),this._defaults.backgroundVisible=!0,this._defaults.borderMaterial.color.set(5197647),this._defaults.borderWidth=.002,this._defaults.height=.1,this._defaults.width=.4,this._optionsDivStyle=new Style({backgroundVisible:this.backgroundVisible,borderMaterial:this.borderMaterial.clone(),borderWidth:this.borderWidth,overflow:"scroll",paddingBottom:this.borderWidth,paddingTop:this.borderWidth,width:this.width}),this._optionsDiv=new Div(this._optionsDivStyle),this._optionsDiv._content.position.z*=3,this._optionsStyle=new Style({backgroundVisible:this.backgroundVisible,width:"90%"}),this.pointerInteractableClassOverride&&(this._optionsStyle.pointerInteractableClassOverride=this.pointerInteractableClassOverride),this._optionsTextStyle=new Style({maxWidth:"100%"}),this.padding&&(this._optionsTextStyle.padding=this.padding),this._value,this._options=[],this._textSpan=new Span({alignItems:"start",justifyContent:"spaceBetween",height:"100%",overflow:"hidden",width:"90%"}),this._text=new TextComponent(" ",this._optionsTextStyle,{maxWidth:"85%",minWidth:"85%"}),this._text._text.lineHeight=1/.55,this._caret=new TextComponent("⌄"),this._caret._text.anchorY="85%",this._content.add(this._textSpan),this._textSpan.add(this._text),this._textSpan.add(this._caret),this._downListener=r=>{let A=r.target;for(;A;){if(A==this)return;A=A.parent}this.hideOptions()},this.onClick=this.onTouch=()=>this._select(),this.updateLayout()}updateLayout(){super.updateLayout(),this._optionsStyle.minHeight!=this.computedHeight&&(this._optionsStyle.minHeight=this.computedHeight),this._optionsTextStyle.minWidth!=.9*this.unpaddedWidth&&(this._optionsTextStyle.minWidth=.9*this.unpaddedWidth),this._optionsTextStyle.fontSize!=.55*this.unpaddedHeight&&(this._optionsTextStyle.fontSize=.55*this.unpaddedHeight,this._caret.fontSize=.8*this.unpaddedHeight)}_handleStyleUpdateForWidth(){super._handleStyleUpdateForWidth(),this._optionsDivStyle.width=this.width}_select(){this.remove(this._textSpan),this.add(this._optionsDiv),this._optionsDiv._updateMaterialOffset(this._materialOffset+3),this.onClick=this.onTouch=null,tr.addEventListener("down",this._downListener)}_selectOption(r){let A=this._value!=r;this._value=r,this._text.text=r,this.hideOptions(),A&&this._onChange&&this._onChange(this._value)}addOptions(...r){for(let A of r){let r=new Span(this._optionsStyle),b=new TextComponent(A,this._optionsTextStyle);r.onClick=r.onTouch=()=>this._selectOption(b.text),r.add(b),r.pointerInteractable.addStateCallback((A=>{A==nn.HOVERED?r.material.color.set(30207):A==nn.IDLE&&r.material.color.set(16777215)})),this._optionsDiv.add(r)}}hideOptions(){this.remove(this._optionsDiv),this.add(this._textSpan),this.onClick=this.onTouch=()=>this._select(),tr.removeEventListener("down",this._downListener)}get maxDisplayOptions(){return this._maxDisplayOptions}get onChange(){return this._onChange}get value(){return this._value}set maxDisplayOptions(r){this._maxDisplayOptions=r,this._optionsDivStyle.maxHeight=null==r?null:100*this._maxDisplayOptions+"%"}set onChange(r){this._onChange=r}set value(r){this._value=r,this._text.text=r}}const Ua=new r.MeshBasicMaterial({color:16777215,side:r.DoubleSide,transparent:!0,polygonOffset:!0,polygonOffsetFactor:1,polygonOffsetUnits:1});class Toggle extends InteractableComponent{constructor(...r){super(...r),this._defaults.backgroundVisible=!0,this._defaults.color=16777215,this._defaults.height=.08,this._defaults.materialColor=13421772,this._defaults.width=.14,this._toggleMaterial=Ua.clone(),this.onClick=this.onTouch=()=>this._change(),this.updateLayout()}_createBackground(){super._createBackground(),this._toggleChild?.parent&&this._toggleChild.parent.remove(this._toggleChild);let A=this.borderRadius||0,b=numberOr(this.borderTopLeftRadius,A),C=numberOr(this.borderTopRightRadius,A),I=numberOr(this.borderBottomLeftRadius,A),x=numberOr(this.borderBottomRightRadius,A),S=.24*this.computedHeight,B=this.computedHeight-S,D=(this.computedWidth-S)/2;this._toggleOffset=(this.computedWidth-D-S)/2,b=Math.max(b-S/2,0),C=Math.max(C-S/2,0),I=Math.max(I-S/2,0),x=Math.max(x-S/2,0);let R=this._materialOffset+1,F=Toggle.createShape(D,B,b,C,I,x),N=new r.ShapeGeometry(F);this._toggleChild=new r.Mesh(N,this._toggleMaterial),this._toggleChild.renderOrder=R,this._background.add(this._toggleChild),this._checked?this._toggleChild.position.setX(this._toggleOffset):this._toggleChild.position.setX(-this._toggleOffset)}_updateMaterialOffset(r){super._updateMaterialOffset(r),this._toggleMaterial.polygonOffsetFactor=this._toggleMaterial.polygonOffsetUnits=-1*this._materialOffset-1,this._toggleChild&&(this._toggleChild.renderOrder=this._materialOffset+1)}_change(){this._checked=!this._checked,this._checked?(this.material.color.set(12543),this._toggleChild.position.setX(this._toggleOffset)):(this.material.color.set(13421772),this._toggleChild.position.setX(-this._toggleOffset)),this._onChange&&this._onChange(this._checked)}get checked(){return this._checked}get onChange(){return this._onChange}set checked(r){r!=this._checked&&(this._checked=r,r?(this.material.color.set(12543),this._toggleChild.position.setX(this._toggleOffset)):(this.material.color.set(13421772),this._toggleChild.position.setX(-this._toggleOffset)))}set onChange(r){this._onChange=r}}const Na=new r.Vector3;class GripInteractable extends Interactable{constructor(r){super(r),r&&(r.gripInteractable=this),this._createBoundingObject()}_createBoundingObject(){this._boundingBox=new r.Box3}_getBoundingObject(){return this._boundingBox.setFromObject(this._object),this._boundingBox}intersectsSphere(r){let A,b=this._getBoundingObject();return A=!!b&&r.intersectsBox(b),A}distanceToSphere(r){return r.distanceToPoint(this._boundingBox.getCenter(Na))}}let Qa=new class extends InteractableHandler{constructor(){super()}init(A){super.init(),this._scene=A,this._sphere=new r.Sphere,this._box3=new r.Box3}_getBoundingSphere(r){return r?(this._box3.setFromObject(r).getBoundingSphere(this._sphere),this._sphere):null}_isXRControllerPressed(r,A){if(r==ln.HAND){let b=$n.getXRControllerModel(r,A);return 1==b?.motionController?.isGrabbing}{let r=$n.getXRGamepad(A);return null!=r?.buttons&&r.buttons[1].pressed}}_scopeInteractables(r,A){let b=r.boundingSphere;if(null!=b)for(let C of A)if(0!=C.children.size&&this._scopeInteractables(r,C.children),null!=C.object&&!C.isOnlyGroup()&&C.intersectsSphere(b)){let A=C.distanceToSphere(b);A<r.closestPointDistance&&(r.closestPointDistance=A,r.closestInteractable=C)}}_updateInteractables(r){let A=r.owner,b=r.isPressed,C=this._hoveredInteractables.get(A),I=this._selectedInteractables.get(A),x=this._overInteractables.get(A),S=r.closestInteractable;S!=C&&(C&&(C.removeHoveredBy(A),this._hoveredInteractables.delete(A)),!S||(I||b)&&S!=I||(S.addHoveredBy(A),this._hoveredInteractables.set(A,S),C=S));let B={owner:A};I?(b||(I.removeSelectedBy(A),this._selectedInteractables.delete(A)),I==S?(x!=S&&(x&&x.out(B),S.over(B),this._overInteractables.set(A,S)),S.move(B),S.drag(B),b||(this._trigger("up",B,S),S.click(B))):I.isCapturedBy(A)?(I!=x&&(x&&x.out(B),I.over(B),this._overInteractables.set(A,I),x=I),I.move(B),I.drag(B),b||(this._trigger("up",B,I),I.click(B),x&&x.out(B),S?(S.over(B),this._overInteractables.set(A,S)):this._overInteractables.delete(A))):S?(x!=S&&(x&&x.out(B),S.over(B),this._overInteractables.set(A,S)),S.move(B),b||this._trigger("up",B,S)):x&&(x.out(B),this._overInteractables.delete(A))):S?(x!=S&&(x&&x.out(B),S.over(B),this._overInteractables.set(A,S)),S.move(B),b&&!this._wasPressed.get(A)?(this._trigger("down",B,S),S.addSelectedBy(A),this._selectedInteractables.set(A,S)):!b&&this._wasPressed.get(A)&&this._trigger("up",B,S)):(x&&(x.out(B),this._overInteractables.delete(A)),b?this._wasPressed.get(A)||this._trigger("down",B):this._wasPressed.get(A)&&this._trigger("up",B)),this._wasPressed.set(A,b)}_updateForXR(){for(let r in on){let A=!1;for(let b of[ln.CONTROLLER,ln.HAND]){let C=$n.getXRController(b,r,"grip"),I=$n.getXRControllerModel(b,r);if(C||(C=$n.getXRController(b,r,"targetRay")),!C)continue;let x,S,B=this._getOwner(C),D=isDescendant(this._scene,C);D&&(b==ln.CONTROLLER?A=!0:A&&(D=!1)),D&&(x=isDescendant(C,I)?this._getBoundingSphere(I):this._getBoundingSphere(C),S=this._isXRControllerPressed(b,r));let R={owner:B,boundingSphere:x,isPressed:S,closestPointDistance:Number.MAX_SAFE_INTEGER},F=!1;this._toolHandlers[this._tool]&&(F=this._toolHandlers[this._tool](R)),F||(this._scopeInteractables(R,this._interactables),this._updateInteractables(R))}}}};!function(r,A){"object"==typeof exports&&"object"==typeof module?module.exports=A():"function"==typeof define&&define.amd?define("nipplejs",[],A):"object"==typeof exports?exports.nipplejs=A():r.nipplejs=A()}(window,(function(){return function(r){var A={};function e(b){if(A[b])return A[b].exports;var C=A[b]={i:b,l:!1,exports:{}};return r[b].call(C.exports,C,C.exports,e),C.l=!0,C.exports}return e.m=r,e.c=A,e.d=function(r,A,b){e.o(r,A)||Object.defineProperty(r,A,{enumerable:!0,get:b})},e.r=function(r){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(r,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(r,"__esModule",{value:!0})},e.t=function(r,A){if(1&A&&(r=e(r)),8&A)return r;if(4&A&&"object"==typeof r&&r&&r.__esModule)return r;var b=Object.create(null);if(e.r(b),Object.defineProperty(b,"default",{enumerable:!0,value:r}),2&A&&"string"!=typeof r)for(var C in r)e.d(b,C,function(A){return r[A]}.bind(null,C));return b},e.n=function(r){var A=r&&r.__esModule?function(){return r.default}:function(){return r};return e.d(A,"a",A),A},e.o=function(r,A){return Object.prototype.hasOwnProperty.call(r,A)},e.p="",e(e.s=0)}([function(r,A,b){b.r(A);var C,n=function(r,A){var b=A.x-r.x,C=A.y-r.y;return Math.sqrt(b*b+C*C)},s=function(r){return r*(Math.PI/180)},I=new Map,a=function(r){I.has(r)&&clearTimeout(I.get(r)),I.set(r,setTimeout(r,100))},p=function(r,A,b){for(var C,I=A.split(/[ ,]+/g),x=0;x<I.length;x+=1)C=I[x],r.addEventListener?r.addEventListener(C,b,!1):r.attachEvent&&r.attachEvent(C,b)},c=function(r,A,b){for(var C,I=A.split(/[ ,]+/g),x=0;x<I.length;x+=1)C=I[x],r.removeEventListener?r.removeEventListener(C,b):r.detachEvent&&r.detachEvent(C,b)},l=function(r){return r.preventDefault(),r.type.match(/^touch/)?r.changedTouches:r},h=function(){return{x:void 0!==window.pageXOffset?window.pageXOffset:(document.documentElement||document.body.parentNode||document.body).scrollLeft,y:void 0!==window.pageYOffset?window.pageYOffset:(document.documentElement||document.body.parentNode||document.body).scrollTop}},u=function(r,A){A.top||A.right||A.bottom||A.left?(r.style.top=A.top,r.style.right=A.right,r.style.bottom=A.bottom,r.style.left=A.left):(r.style.left=A.x+"px",r.style.top=A.y+"px")},f=function(r,A,b){var C=y(r);for(var I in C)if(C.hasOwnProperty(I))if("string"==typeof A)C[I]=A+" "+b;else{for(var x="",S=0,B=A.length;S<B;S+=1)x+=A[S]+" "+b+", ";C[I]=x.slice(0,-2)}return C},y=function(r){var A={};return A[r]="",["webkit","Moz","o"].forEach((function(b){A[b+r.charAt(0).toUpperCase()+r.slice(1)]=""})),A},m=function(r,A){for(var b in A)A.hasOwnProperty(b)&&(r[b]=A[b]);return r},v=function(r,A){if(r.length)for(var b=0,C=r.length;b<C;b+=1)A(r[b]);else A(r)},x=!!("ontouchstart"in window),S=!!window.PointerEvent,B=!!window.MSPointerEvent,D={start:"mousedown",move:"mousemove",end:"mouseup"},R={};function _(){}S?C={start:"pointerdown",move:"pointermove",end:"pointerup, pointercancel"}:B?C={start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:x?(C={start:"touchstart",move:"touchmove",end:"touchend, touchcancel"},R=D):C=D,_.prototype.on=function(r,A){var b,C=r.split(/[ ,]+/g);this._handlers_=this._handlers_||{};for(var I=0;I<C.length;I+=1)b=C[I],this._handlers_[b]=this._handlers_[b]||[],this._handlers_[b].push(A);return this},_.prototype.off=function(r,A){return this._handlers_=this._handlers_||{},void 0===r?this._handlers_={}:void 0===A?this._handlers_[r]=null:this._handlers_[r]&&this._handlers_[r].indexOf(A)>=0&&this._handlers_[r].splice(this._handlers_[r].indexOf(A),1),this},_.prototype.trigger=function(r,A){var b,C=this,I=r.split(/[ ,]+/g);C._handlers_=C._handlers_||{};for(var x=0;x<I.length;x+=1)b=I[x],C._handlers_[b]&&C._handlers_[b].length&&C._handlers_[b].forEach((function(r){r.call(C,{type:b,target:C},A)}))},_.prototype.config=function(r){this.options=this.defaults||{},r&&(this.options=function(r,A){var b={};for(var C in r)r.hasOwnProperty(C)&&A.hasOwnProperty(C)?b[C]=A[C]:r.hasOwnProperty(C)&&(b[C]=r[C]);return b}(this.options,r))},_.prototype.bindEvt=function(r,A){var b=this;return b._domHandlers_=b._domHandlers_||{},b._domHandlers_[A]=function(){"function"==typeof b["on"+A]?b["on"+A].apply(b,arguments):console.warn('[WARNING] : Missing "on'+A+'" handler.')},p(r,C[A],b._domHandlers_[A]),R[A]&&p(r,R[A],b._domHandlers_[A]),b},_.prototype.unbindEvt=function(r,A){return this._domHandlers_=this._domHandlers_||{},c(r,C[A],this._domHandlers_[A]),R[A]&&c(r,R[A],this._domHandlers_[A]),delete this._domHandlers_[A],this};var F=_;function k(r,A){return this.identifier=A.identifier,this.position=A.position,this.frontPosition=A.frontPosition,this.collection=r,this.defaults={size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,mode:"dynamic",zone:document.body,lockX:!1,lockY:!1,shape:"circle"},this.config(A),"dynamic"===this.options.mode&&(this.options.restOpacity=0),this.id=k.id,k.id+=1,this.buildEl().stylize(),this.instance={el:this.ui.el,on:this.on.bind(this),off:this.off.bind(this),show:this.show.bind(this),hide:this.hide.bind(this),add:this.addToDom.bind(this),remove:this.removeFromDom.bind(this),destroy:this.destroy.bind(this),setPosition:this.setPosition.bind(this),resetDirection:this.resetDirection.bind(this),computeDirection:this.computeDirection.bind(this),trigger:this.trigger.bind(this),position:this.position,frontPosition:this.frontPosition,ui:this.ui,identifier:this.identifier,id:this.id,options:this.options},this.instance}k.prototype=new F,k.constructor=k,k.id=0,k.prototype.buildEl=function(r){return this.ui={},this.options.dataOnly||(this.ui.el=document.createElement("div"),this.ui.back=document.createElement("div"),this.ui.front=document.createElement("div"),this.ui.el.className="nipple collection_"+this.collection.id,this.ui.back.className="back",this.ui.front.className="front",this.ui.el.setAttribute("id","nipple_"+this.collection.id+"_"+this.id),this.ui.el.appendChild(this.ui.back),this.ui.el.appendChild(this.ui.front)),this},k.prototype.stylize=function(){if(this.options.dataOnly)return this;var r=this.options.fadeTime+"ms",A=function(r,A){var b=y("borderRadius");for(var C in b)b.hasOwnProperty(C)&&(b[C]="50%");return b}(),b=f("transition","opacity",r),C={};return C.el={position:"absolute",opacity:this.options.restOpacity,display:"block",zIndex:999},C.back={position:"absolute",display:"block",width:this.options.size+"px",height:this.options.size+"px",marginLeft:-this.options.size/2+"px",marginTop:-this.options.size/2+"px",background:this.options.color,opacity:".5"},C.front={width:this.options.size/2+"px",height:this.options.size/2+"px",position:"absolute",display:"block",marginLeft:-this.options.size/4+"px",marginTop:-this.options.size/4+"px",background:this.options.color,opacity:".5",transform:"translate(0px, 0px)"},m(C.el,b),"circle"===this.options.shape&&m(C.back,A),m(C.front,A),this.applyStyles(C),this},k.prototype.applyStyles=function(r){for(var A in this.ui)if(this.ui.hasOwnProperty(A))for(var b in r[A])this.ui[A].style[b]=r[A][b];return this},k.prototype.addToDom=function(){return this.options.dataOnly||document.body.contains(this.ui.el)||this.options.zone.appendChild(this.ui.el),this},k.prototype.removeFromDom=function(){return this.options.dataOnly||!document.body.contains(this.ui.el)||this.options.zone.removeChild(this.ui.el),this},k.prototype.destroy=function(){clearTimeout(this.removeTimeout),clearTimeout(this.showTimeout),clearTimeout(this.restTimeout),this.trigger("destroyed",this.instance),this.removeFromDom(),this.off()},k.prototype.show=function(r){var A=this;return A.options.dataOnly||(clearTimeout(A.removeTimeout),clearTimeout(A.showTimeout),clearTimeout(A.restTimeout),A.addToDom(),A.restCallback(),setTimeout((function(){A.ui.el.style.opacity=1}),0),A.showTimeout=setTimeout((function(){A.trigger("shown",A.instance),"function"==typeof r&&r.call(this)}),A.options.fadeTime)),A},k.prototype.hide=function(r){var A=this;if(A.options.dataOnly)return A;if(A.ui.el.style.opacity=A.options.restOpacity,clearTimeout(A.removeTimeout),clearTimeout(A.showTimeout),clearTimeout(A.restTimeout),A.removeTimeout=setTimeout((function(){var b="dynamic"===A.options.mode?"none":"block";A.ui.el.style.display=b,"function"==typeof r&&r.call(A),A.trigger("hidden",A.instance)}),A.options.fadeTime),A.options.restJoystick){var b=A.options.restJoystick,C={};C.x=!0===b||!1!==b.x?0:A.instance.frontPosition.x,C.y=!0===b||!1!==b.y?0:A.instance.frontPosition.y,A.setPosition(r,C)}return A},k.prototype.setPosition=function(r,A){var b=this;b.frontPosition={x:A.x,y:A.y};var C=b.options.fadeTime+"ms",I={};I.front=f("transition",["transform"],C);var x={front:{}};x.front={transform:"translate("+b.frontPosition.x+"px,"+b.frontPosition.y+"px)"},b.applyStyles(I),b.applyStyles(x),b.restTimeout=setTimeout((function(){"function"==typeof r&&r.call(b),b.restCallback()}),b.options.fadeTime)},k.prototype.restCallback=function(){var r={};r.front=f("transition","none",""),this.applyStyles(r),this.trigger("rested",this.instance)},k.prototype.resetDirection=function(){this.direction={x:!1,y:!1,angle:!1}},k.prototype.computeDirection=function(r){var A,b,C,I=r.angle.radian,x=Math.PI/4,S=Math.PI/2;if(I>x&&I<3*x&&!r.lockX?A="up":I>-x&&I<=x&&!r.lockY?A="left":I>3*-x&&I<=-x&&!r.lockX?A="down":r.lockY||(A="right"),r.lockY||(b=I>-S&&I<S?"left":"right"),r.lockX||(C=I>0?"up":"down"),r.force>this.options.threshold){var B,D={};for(B in this.direction)this.direction.hasOwnProperty(B)&&(D[B]=this.direction[B]);var R={};for(B in this.direction={x:b,y:C,angle:A},r.direction=this.direction,D)D[B]===this.direction[B]&&(R[B]=!0);if(R.x&&R.y&&R.angle)return r;R.x&&R.y||this.trigger("plain",r),R.x||this.trigger("plain:"+b,r),R.y||this.trigger("plain:"+C,r),R.angle||this.trigger("dir dir:"+A,r)}else this.resetDirection();return r};var N=k;function E(r,A){this.nipples=[],this.idles=[],this.actives=[],this.ids=[],this.pressureIntervals={},this.manager=r,this.id=E.id,E.id+=1,this.defaults={zone:document.body,multitouch:!1,maxNumberOfNipples:10,mode:"dynamic",position:{top:0,left:0},catchDistance:200,size:100,threshold:.1,color:"white",fadeTime:250,dataOnly:!1,restJoystick:!0,restOpacity:.5,lockX:!1,lockY:!1,shape:"circle",dynamicPage:!1,follow:!1},this.config(A),"static"!==this.options.mode&&"semi"!==this.options.mode||(this.options.multitouch=!1),this.options.multitouch||(this.options.maxNumberOfNipples=1);var b=getComputedStyle(this.options.zone.parentElement);return b&&"flex"===b.display&&(this.parentIsFlex=!0),this.updateBox(),this.prepareNipples(),this.bindings(),this.begin(),this.nipples}E.prototype=new F,E.constructor=E,E.id=0,E.prototype.prepareNipples=function(){var r=this.nipples;r.on=this.on.bind(this),r.off=this.off.bind(this),r.options=this.options,r.destroy=this.destroy.bind(this),r.ids=this.ids,r.id=this.id,r.processOnMove=this.processOnMove.bind(this),r.processOnEnd=this.processOnEnd.bind(this),r.get=function(A){if(void 0===A)return r[0];for(var b=0,C=r.length;b<C;b+=1)if(r[b].identifier===A)return r[b];return!1}},E.prototype.bindings=function(){this.bindEvt(this.options.zone,"start"),this.options.zone.style.touchAction="none",this.options.zone.style.msTouchAction="none"},E.prototype.begin=function(){var r=this.options;if("static"===r.mode){var A=this.createNipple(r.position,this.manager.getIdentifier());A.add(),this.idles.push(A)}},E.prototype.createNipple=function(r,A){var b=this.manager.scroll,C={},I=this.options,x=this.parentIsFlex?b.x:b.x+this.box.left,S=this.parentIsFlex?b.y:b.y+this.box.top;if(r.x&&r.y)C={x:r.x-x,y:r.y-S};else if(r.top||r.right||r.bottom||r.left){var B=document.createElement("DIV");B.style.display="hidden",B.style.top=r.top,B.style.right=r.right,B.style.bottom=r.bottom,B.style.left=r.left,B.style.position="absolute",I.zone.appendChild(B);var D=B.getBoundingClientRect();I.zone.removeChild(B),C=r,r={x:D.left+b.x,y:D.top+b.y}}var R=new N(this,{color:I.color,size:I.size,threshold:I.threshold,fadeTime:I.fadeTime,dataOnly:I.dataOnly,restJoystick:I.restJoystick,restOpacity:I.restOpacity,mode:I.mode,identifier:A,position:r,zone:I.zone,frontPosition:{x:0,y:0},shape:I.shape});return I.dataOnly||(u(R.ui.el,C),u(R.ui.front,R.frontPosition)),this.nipples.push(R),this.trigger("added "+R.identifier+":added",R),this.manager.trigger("added "+R.identifier+":added",R),this.bindNipple(R),R},E.prototype.updateBox=function(){this.box=this.options.zone.getBoundingClientRect()},E.prototype.bindNipple=function(r){var A,b=this,o=function(r,C){A=r.type+" "+C.id+":"+r.type,b.trigger(A,C)};r.on("destroyed",b.onDestroyed.bind(b)),r.on("shown hidden rested dir plain",o),r.on("dir:up dir:right dir:down dir:left",o),r.on("plain:up plain:right plain:down plain:left",o)},E.prototype.pressureFn=function(r,A,b){var C=this,I=0;clearInterval(C.pressureIntervals[b]),C.pressureIntervals[b]=setInterval(function(){var b=r.force||r.pressure||r.webkitForce||0;b!==I&&(A.trigger("pressure",b),C.trigger("pressure "+A.identifier+":pressure",b),I=b)}.bind(C),100)},E.prototype.onstart=function(r){var A=this,b=A.options,C=r;return r=l(r),A.updateBox(),v(r,(function(I){A.actives.length<b.maxNumberOfNipples?A.processOnStart(I):C.type.match(/^touch/)&&(Object.keys(A.manager.ids).forEach((function(b){if(Object.values(C.touches).findIndex((function(r){return r.identifier===b}))<0){var I=[r[0]];I.identifier=b,A.processOnEnd(I)}})),A.actives.length<b.maxNumberOfNipples&&A.processOnStart(I))})),A.manager.bindDocument(),!1},E.prototype.processOnStart=function(r){var A,b=this,C=b.options,I=b.manager.getIdentifier(r),x=r.force||r.pressure||r.webkitForce||0,S={x:r.pageX,y:r.pageY},B=b.getOrCreate(I,S);B.identifier!==I&&b.manager.removeIdentifier(B.identifier),B.identifier=I;var p=function(A){A.trigger("start",A),b.trigger("start "+A.id+":start",A),A.show(),x>0&&b.pressureFn(r,A,A.identifier),b.processOnMove(r)};if((A=b.idles.indexOf(B))>=0&&b.idles.splice(A,1),b.actives.push(B),b.ids.push(B.identifier),"semi"!==C.mode)p(B);else{if(!(n(S,B.position)<=C.catchDistance))return B.destroy(),void b.processOnStart(r);p(B)}return B},E.prototype.getOrCreate=function(r,A){var b,C=this.options;return/(semi|static)/.test(C.mode)?(b=this.idles[0])?(this.idles.splice(0,1),b):"semi"===C.mode?this.createNipple(A,r):(console.warn("Coudln't find the needed nipple."),!1):b=this.createNipple(A,r)},E.prototype.processOnMove=function(r){var A=this.options,b=this.manager.getIdentifier(r),C=this.nipples.get(b),I=this.manager.scroll;if(function(r){return isNaN(r.buttons)?0!==r.pressure:0!==r.buttons}(r)){if(!C)return console.error("Found zombie joystick with ID "+b),void this.manager.removeIdentifier(b);if(A.dynamicPage){var x=C.el.getBoundingClientRect();C.position={x:I.x+x.left,y:I.y+x.top}}C.identifier=b;var S=C.options.size/2,B={x:r.pageX,y:r.pageY};A.lockX&&(B.y=C.position.y),A.lockY&&(B.x=C.position.x);var D,R,F,N,Q,H,G,j,V,W,X=n(B,C.position),Y=(D=B,F=(R=C.position).x-D.x,N=R.y-D.y,function(r){return r*(180/Math.PI)}(Math.atan2(N,F))),K=s(Y),q=X/S,Z={distance:X,position:B};if("circle"===C.options.shape?(Q=Math.min(X,S),G=C.position,j=Q,W={x:0,y:0},V=s(V=Y),W.x=G.x-j*Math.cos(V),W.y=G.y-j*Math.sin(V),H=W):(H=function(r,A,b){return{x:Math.min(Math.max(r.x,A.x-b),A.x+b),y:Math.min(Math.max(r.y,A.y-b),A.y+b)}}(B,C.position,S),Q=n(H,C.position)),A.follow){if(X>S){var J=B.x-H.x,$=B.y-H.y;C.position.x+=J,C.position.y+=$,C.el.style.top=C.position.y-(this.box.top+I.y)+"px",C.el.style.left=C.position.x-(this.box.left+I.x)+"px",X=n(B,C.position)}}else B=H,X=Q;var ee=B.x-C.position.x,te=B.y-C.position.y;C.frontPosition={x:ee,y:te},A.dataOnly||(C.ui.front.style.transform="translate("+ee+"px,"+te+"px)");var se={identifier:C.identifier,position:B,force:q,pressure:r.force||r.pressure||r.webkitForce||0,distance:X,angle:{radian:K,degree:Y},vector:{x:ee/S,y:-te/S},raw:Z,instance:C,lockX:A.lockX,lockY:A.lockY};(se=C.computeDirection(se)).angle={radian:s(180-Y),degree:180-Y},C.trigger("move",se),this.trigger("move "+C.id+":move",se)}else this.processOnEnd(r)},E.prototype.processOnEnd=function(r){var A=this,b=A.options,C=A.manager.getIdentifier(r),I=A.nipples.get(C),x=A.manager.removeIdentifier(I.identifier);I&&(b.dataOnly||I.hide((function(){"dynamic"===b.mode&&(I.trigger("removed",I),A.trigger("removed "+I.id+":removed",I),A.manager.trigger("removed "+I.id+":removed",I),I.destroy())})),clearInterval(A.pressureIntervals[I.identifier]),I.resetDirection(),I.trigger("end",I),A.trigger("end "+I.id+":end",I),A.ids.indexOf(I.identifier)>=0&&A.ids.splice(A.ids.indexOf(I.identifier),1),A.actives.indexOf(I)>=0&&A.actives.splice(A.actives.indexOf(I),1),/(semi|static)/.test(b.mode)?A.idles.push(I):A.nipples.indexOf(I)>=0&&A.nipples.splice(A.nipples.indexOf(I),1),A.manager.unbindDocument(),/(semi|static)/.test(b.mode)&&(A.manager.ids[x.id]=x.identifier))},E.prototype.onDestroyed=function(r,A){this.nipples.indexOf(A)>=0&&this.nipples.splice(this.nipples.indexOf(A),1),this.actives.indexOf(A)>=0&&this.actives.splice(this.actives.indexOf(A),1),this.idles.indexOf(A)>=0&&this.idles.splice(this.idles.indexOf(A),1),this.ids.indexOf(A.identifier)>=0&&this.ids.splice(this.ids.indexOf(A.identifier),1),this.manager.removeIdentifier(A.identifier),this.manager.unbindDocument()},E.prototype.destroy=function(){for(var r in this.unbindEvt(this.options.zone,"start"),this.nipples.forEach((function(r){r.destroy()})),this.pressureIntervals)this.pressureIntervals.hasOwnProperty(r)&&clearInterval(this.pressureIntervals[r]);this.trigger("destroyed",this.nipples),this.manager.unbindDocument(),this.off()};var Q=E;function z(r){var A=this;A.ids={},A.index=0,A.collections=[],A.scroll=h(),A.config(r),A.prepareCollections();var e=function(){var r;A.collections.forEach((function(b){b.forEach((function(b){r=b.el.getBoundingClientRect(),b.position={x:A.scroll.x+r.left,y:A.scroll.y+r.top}}))}))};p(window,"resize",(function(){a(e)}));var o=function(){A.scroll=h()};return p(window,"scroll",(function(){a(o)})),A.collections}z.prototype=new F,z.constructor=z,z.prototype.prepareCollections=function(){var r=this;r.collections.create=r.create.bind(r),r.collections.on=r.on.bind(r),r.collections.off=r.off.bind(r),r.collections.destroy=r.destroy.bind(r),r.collections.get=function(A){var b;return r.collections.every((function(r){return!(b=r.get(A))})),b}},z.prototype.create=function(r){return this.createCollection(r)},z.prototype.createCollection=function(r){var A=new Q(this,r);return this.bindCollection(A),this.collections.push(A),A},z.prototype.bindCollection=function(r){var A,b=this,o=function(r,C){A=r.type+" "+C.id+":"+r.type,b.trigger(A,C)};r.on("destroyed",b.onDestroyed.bind(b)),r.on("shown hidden rested dir plain",o),r.on("dir:up dir:right dir:down dir:left",o),r.on("plain:up plain:right plain:down plain:left",o)},z.prototype.bindDocument=function(){this.binded||(this.bindEvt(document,"move").bindEvt(document,"end"),this.binded=!0)},z.prototype.unbindDocument=function(r){Object.keys(this.ids).length&&!0!==r||(this.unbindEvt(document,"move").unbindEvt(document,"end"),this.binded=!1)},z.prototype.getIdentifier=function(r){var A;return r?void 0===(A=void 0===r.identifier?r.pointerId:r.identifier)&&(A=this.latest||0):A=this.index,void 0===this.ids[A]&&(this.ids[A]=this.index,this.index+=1),this.latest=A,this.ids[A]},z.prototype.removeIdentifier=function(r){var A={};for(var b in this.ids)if(this.ids[b]===r){A.id=b,A.identifier=this.ids[b],delete this.ids[b];break}return A},z.prototype.onmove=function(r){return this.onAny("move",r),!1},z.prototype.onend=function(r){return this.onAny("end",r),!1},z.prototype.oncancel=function(r){return this.onAny("end",r),!1},z.prototype.onAny=function(r,A){var b,C=this,I="processOn"+r.charAt(0).toUpperCase()+r.slice(1);A=l(A);var s=function(r,A,b){b.ids.indexOf(A)>=0&&(b[I](r),r._found_=!0)};return v(A,(function(r){b=C.getIdentifier(r),v(C.collections,s.bind(null,r,b)),r._found_||C.removeIdentifier(b)})),!1},z.prototype.destroy=function(){this.unbindDocument(!0),this.ids={},this.index=0,this.collections.forEach((function(r){r.destroy()})),this.off()},z.prototype.onDestroyed=function(r,A){if(this.collections.indexOf(A)<0)return!1;this.collections.splice(this.collections.indexOf(A),1)};var H=new z;A.default={create:function(r){return H.create(r)},factory:H}}]).default}));const{computeBoundsTree:Ha,disposeBoundsTree:Ga,acceleratedRaycast:ja}=qi;r.BufferGeometry.prototype.computeBoundsTree=Ha,r.BufferGeometry.prototype.disposeBoundsTree=Ga,r.Mesh.prototype.raycast=ja;const init=async(r,A,b,C,I,x)=>{I||(await async function(){if(navigator.userAgent){let r=navigator.userAgent.toLowerCase();if(r.indexOf("iphone")>=0||r.indexOf("ipad")>=0)return!1}return"xr"in navigator&&(await navigator.xr.isSessionSupported("immersive-vr")||await navigator.xr.isSessionSupported("immersive-ar"))}()?(I="XR",A.xr.enabled||(A.xr.enabled=!0)):I="ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0?"TOUCH_SCREEN":"POINTER"),an.active=I,A.localClippingEnabled=!0,$n.init(r,A),tr.init(A,b,C,x),Qa.init(b),ir.init(b),"XR"!=I&&ba.setup()};var Va=Object.freeze({__proto__:null,Body:Body,Checkbox:Checkbox,DelayedClickHandler:ba,DeviceTypes:an,Div:Div,GripInteractable:GripInteractable,GripInteractableHandler:Qa,HSLColor:HSLColor,Handedness:on,Image:ia,InputHandler:$n,Interactable:Interactable,InteractableStates:nn,InteractionToolHandler:sn,Keyboard:_a,NumberInput:NumberInput,PointerInteractable:PointerInteractable,PointerInteractableHandler:tr,Radio:class Radio extends InteractableComponent{constructor(r,...A){super(...A),this._defaults.backgroundVisible=!0,this._defaults.borderMaterial.color.set(5197647),this._defaults.borderWidth=.002,this._defaults.height=.08,this._defaults.materialColor=16777215,this._defaults.width=.08,this._name=r,this._toggleMaterial=Ra.clone(),this.onClick=this.onTouch=()=>this._select(),this.updateLayout(),r in ka||(ka[r]=new Set),ka[r].add(this)}_createBackground(){this._defaults.borderRadius=Math.min(this.computedHeight,this.computedHeight)/2,super._createBackground(),this._toggleChild?.parent&&this._toggleChild.parent.remove(this._toggleChild),this._toggleChild=new r.Mesh(this._background.geometry,this._toggleMaterial),this._background.add(this._toggleChild),this._toggleChild.scale.set(.75,.75,.75),this._toggleChild.visible=!!this._selected,this.borderMaterial.color.set(this._selected?12543:5197647)}_updateMaterialOffset(r){super._updateMaterialOffset(r),this._toggleMaterial.polygonOffsetFactor=this._toggleMaterial.polygonOffsetUnits=-1*this._materialOffset-1,this._toggleChild&&(this._toggleChild.renderOrder=this._materialOffset+1)}_select(r){for(let r of ka[this._name])r!=this&&r.unselect();this._selected=!0,this.borderMaterial.color.set(12543),this._toggleChild.visible=!0,r||(this._onChange&&this._onChange(this._selected),this._onSelect&&this._onSelect())}_unselect(r){this._selected=!1,this.borderMaterial.color.set(5197647),this._toggleChild.visible=!1,this._onChange&&!r&&this._onChange(this._selected)}select(){this._select()}unselect(){this._unselect()}get onChange(){return this._onChange}get onSelect(){return this._onSelect}get selected(){return this._selected}set onChange(r){this._onChange=r}set onSelect(r){this._onSelect=r}set selected(r){r!=this._selected&&(r?this._select(!0):this.unselect(!0))}},Range:class Range extends InteractableComponent{constructor(...r){super(...r),this._defaults.backgroundVisible=!0,this._defaults.borderMaterial.color.set(5197647),this._defaults.borderWidth=.002,this._defaults.height=.02,this._defaults.materialColor=16777215,this._defaults.width=.4,this._value=0,this._scrubberMaterial=Fa.clone(),this._scrubbingOwner,this.pointerInteractable.addEventListener("down",(r=>this.pointerInteractable.capture(r.owner))),this.onClick=r=>this._select(r),this.onTouch=r=>this._touchSelect(r),this.onDrag=r=>this._drag(r),this.onTouchDrag=r=>this._touchDrag(r),this.updateLayout()}_createBackground(){this._defaults.borderRadius=Math.min(this.computedHeight,this.computedWidth)/2,super._createBackground(),this._scrubberChild?.parent&&this._scrubberChild.parent.remove(this._scrubberChild),this._scrubberValue?.parent&&this._scrubberValue.parent.remove(this._scrubberValue);let A=new r.CircleGeometry(1.5*this.computedHeight);this._scrubberChild=new r.Mesh(A,this._scrubberMaterial),this._scrubberValue=new r.Mesh(this._background.geometry,this._scrubberMaterial),this._background.add(this._scrubberChild),this._background.add(this._scrubberValue),this._updateScrubber()}_updateScrubber(){this._scrubberChild.position.setX((this._value-.5)*this.width),this._scrubberValue.scale.setX(this._value),this._scrubberValue.position.setX(this.width*(this._value-1)/2)}_updateMaterialOffset(r){super._updateMaterialOffset(r),this._scrubberMaterial.polygonOffsetFactor=this._scrubberMaterial.polygonOffsetUnits=-1*this._materialOffset-1,this._scrubberChild&&(this._scrubberChild.renderOrder=this._materialOffset+1)}_select(r){let{owner:A,point:b}=r;this._scrubbingOwner==A&&(this._updateValue(A,b),this._scrubbingOwner=null,this._onBlur&&this._onBlur(this._value))}_touchSelect(r){this._scrubbingOwner==r.owner&&(this._scrubbingOwner=null,this._onBlur&&this._onBlur(this._value))}_drag(r){let{owner:A,point:b}=r;this._updateValue(A,b)&&this._onChange&&this._onChange(this._value)}_touchDrag(r){let A=r.owner;this._updateValueFromTouch(A)&&this._onChange&&this._onChange(this._value)}_updateValue(r,A){if(this._scrubbingOwner){if(this._scrubbingOwner!=r)return!1}else this._scrubbingOwner=r;if(A?A=La.copy(A):(Oa.set(La.set(0,0,1),0),Oa.applyMatrix4(this.matrixWorld),A=r.raycaster.ray.intersectPlane(Oa,La)),A){let r=(A=this.worldToLocal(A)).x/this.width+.5;r=Math.max(0,Math.min(r,1));let b=this._value!=r;return this._value=r,b&&this._updateScrubber(),b}return!1}_updateValueFromTouch(r){if(this._scrubbingOwner){if(this._scrubbingOwner!=r)return!1}else{this._scrubbingOwner=r;let A=this.touchInteractable.getClosestPointTo(r.object);this._touchController=A[1].object,this._scrollVertex=this._touchController.bvhGeometry.index.array[3*A[1].faceIndex]}let A=this._touchController.bvhGeometry.getAttribute("position");La.fromBufferAttribute(A,this._scrollVertex),this._touchController.localToWorld(La),this.worldToLocal(La);let b=La.x/this.width+.5;b=Math.max(0,Math.min(b,1));let C=this._value!=b;return this._value=b,C&&this._updateScrubber(),C}get onBlur(){return this._onBlur}get onChange(){return this._onChange}get value(){return this._value}set onBlur(r){this._onBlur=r}set onChange(r){this._onChange=r}set value(r){this._value=Math.max(0,Math.min(r,1)),this._updateScrubber()}},Select:Select,Span:Span,Style:Style,Text:TextComponent,TextArea:TextArea,TextInput:TextInput,ThreeMeshBVH:qi,Toggle:Toggle,TouchInteractable:TouchInteractable,TouchInteractableHandler:ir,TroikaThreeText:ta,UpdateHandler:Ji,XRInputDeviceTypes:ln,addGripInteractable:r=>{Qa.addInteractable(r)},addPointerInteractable:r=>{tr.addInteractable(r)},addTouchInteractable:r=>{ir.addInteractable(r)},init:init,removeGripInteractable:r=>{Qa.removeInteractable(r)},removePointerInteractable:r=>{tr.removeInteractable(r)},removeTouchInteractable:r=>{ir.removeInteractable(r)},update:r=>{"XR"==an.active&&($n.update(r),Qa.update(),ir.update()),tr.update(),Ji.update()},utils:Zi,version:"0.1.5"});let za=["audio","checkmark","component","ellipsis","hamburger","headphones","home","image","lightbulb","material","microphone","object","pencil","search","shapes","system","text","texture","trash","undo","redo","video"],Wa={},Xa=uuidv4();Mt.loadingLocks.add(Xa);for(let r of za)Wa[r]=uuidv4(),Mt.loadingLocks.add(Wa[r]);const Ya={audioIcon:(new r.TextureLoader).load("data:image/png;base64,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",(function(){Mt.loadingLocks.delete(Wa.audio)})),checkmarkIcon:(new r.TextureLoader).load("data:image/png;base64,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",(function(){Mt.loadingLocks.delete(Wa.checkmark)})),componentIcon:(new r.TextureLoader).load("data:image/png;base64,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",(function(){Mt.loadingLocks.delete(Wa.component)})),ellipsisIcon:(new r.TextureLoader).load("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAAAAXNSR0IArs4c6QAACTtJREFUeF7t3NFuG0cQRFHr/z9agZAoMQw7FFs73Jmq41erCdSt7qslZevthz8IIFBL4K02ueAIIPCDACwBAsUECKC4fNERIAA7gEAxAQIoLl90BAjADiBQTIAAissXHQECsAMIFBMggOLyRUeAAOwAAsUECKC4fNERIAA7gEAxAQIoLl90BAjADiBQTIAAissXHQECsAMIFBMggOLyRUeAAOwAAsUECKC4fNERIAA7gEAxAQIoLl90BAjADiBQTIAAissXHQECsAMIFBMggOLyRUeAAOwAAsUECKC4fNERIAA7gEAxAQIoLl90BAjADiBQTIAAissXHQECsAMIFBMggOLyRUeAAOwAAsUECKC4fNERIAA7gEAxAQIoLl90BAjADiBQTIAAissXHQECsAMIFBMggOLyRUeAAOwAAsUECKC4fNERIAA7gEAxAQIoLl90BAjADiBQTIAAissXHQECsAMIFBMggOLyRUeAAOwAAsUECKC4fNERIAA7gEAxAQIoLl90BAjADiBQTIAAissXHQECsAMIFBMggOLyRUeAAOwAAsUECKC4fNERIAA7gEAxAQIoLl90BAjADiBQTIAAissXHQECsAMIFBMggOLyRUeAAOwAAsUECKC4fNERIAA7gEAxAQIoLl90BAjADiBQTIAAissXHQECsAMIFBMggOLyRUeAAOwAAsUECKC4fNERIAA7gEAxAQIoLl90BAjADiBQTIAAissXHQECsAMIFBMggOLyRUeAAOwAAsUECKC4fNERIAA7gEAxAQIoLl90BAjADiBQTIAAissXHQECsAMIFBMggOLyRUeAAOwAAsUECKC4fNERIAA7gEAxAQIoLl90BAjADiBQTIAAissXHQECsAMIFBMggOLyRUeAAOwAAsUECKC4fNERIAA7gEAxAQIoLl90BAjADiBQTIAAissXHQECsAMIFBMggOLyRUegRgDv7+/vz9T99vYWxUb+7v7/tPtRS/67kM8u/q+vcboI5H/u8NP6f/RNL1IA3136P9rykKcC+b939Kf3/+jof/77OAGsWv5PaLs/Eci/5vhP6f+Z4//42hgBrF783R8N5V97+Lv3/+zh/yu06eBOc69e/t2+G8j/2uPfrf/v3OLxTwB3Lf8uSyD/Pce/S//fOf7j3wLcvfx3L4H89x7/3f1/9/iPFsAuy3/XEsi/x/Hf1f8Vx08AV1H8+DT1xT8iJAACuGJ9j/wMYLflf/V3Afn3Ov5X93/F4R/7U4Bdl/9VSyD/nsf/qv6vPP4j3wI4gO4DaO+fAJ78Tz1XA3v0eqs/C2g/gPb8j/bv2b8/6jOA3ctf/Rgo/95PP6v7f/a4v/L1BPAVSk9+zaqnAAIggCdX8eGXHyOAU5Z/1XcB+c84/lX9P7zk4RcQwBDco7GrnwIIgAAe7dzk7wlgQu0LMwRw7W9UahfgF1Zu9CUEMML2eIgACODxltz/FQSwqAMCIIBFq3XpyxLApTj/ezECIIBFq3XpyxLApTgJYNWn4D4DWLOoBLCG6+X/O7D9ANrzL1rTc34nYPsCyO/HgCsk4AlgBdUFvx+AAAhgxaoSwAqqBOAt0It/Qcx0jQlgSu7BnJ8C+CnAotW69GWPEcBH6lMeg68+/s/G5T/jbcCq/i+9/H9ejAAWUF21AARAAFev61ECOOEpYNXxn/IUIP+1b32uPvhfX48ALibsANYewO5PQav7v3hdz/l3AL4D/k2g/QDa89cLYOcjeJX9dz0C+dc+/Vx9/B+vd9xbgF2fBF61/PLv+ST06v6vkgEBXETy1Quw21OA/Od99z/6CWCntwKvXv7dngLkP/P4jxfADhK4a/l3kYD85x5/hADulMDdy3+3BOQ/+/hjBHCHBHZZ/rskIP/5xx8lgFcdwm6L/+tnmKs/HJQ/4/A/9+bYnwL834f3q45g9+VfLUH5s44/8gng6u+Ipyz9n4T4XRnKn3f0P+9K5BPA747h2UM4ffG/K0L5sw8/+i3ARf+2x8sgEE+g5gkgvkkBERgQIIABNCMIpBAggJQm5UBgQIAABtCMIJBCgABSmpQDgQEBAhhAM4JACgECSGlSDgQGBAhgAM0IAikECCClSTkQGBAggAE0IwikECCAlCblQGBAgAAG0IwgkEKAAFKalAOBAQECGEAzgkAKAQJIaVIOBAYECGAAzQgCKQQIIKVJORAYECCAATQjCKQQIICUJuVAYECAAAbQjCCQQoAAUpqUA4EBAQIYQDOCQAoBAkhpUg4EBgQIYADNCAIpBAggpUk5EBgQIIABNCMIpBAggJQm5UBgQIAABtCMIJBCgABSmpQDgQEBAhhAM4JACgECSGlSDgQGBAhgAM0IAikECCClSTkQGBAggAE0IwikECCAlCblQGBAgAAG0IwgkEKAAFKalAOBAQECGEAzgkAKAQJIaVIOBAYECGAAzQgCKQQIIKVJORAYECCAATQjCKQQIICUJuVAYECAAAbQjCCQQoAAUpqUA4EBAQIYQDOCQAoBAkhpUg4EBgQIYADNCAIpBAggpUk5EBgQIIABNCMIpBAggJQm5UBgQIAABtCMIJBCgABSmpQDgQEBAhhAM4JACgECSGlSDgQGBAhgAM0IAikECCClSTkQGBAggAE0IwikECCAlCblQGBAgAAG0IwgkEKAAFKalAOBAQECGEAzgkAKAQJIaVIOBAYECGAAzQgCKQQIIKVJORAYECCAATQjCKQQIICUJuVAYECAAAbQjCCQQoAAUpqUA4EBAQIYQDOCQAoBAkhpUg4EBgQIYADNCAIpBAggpUk5EBgQIIABNCMIpBAggJQm5UBgQIAABtCMIJBCgABSmpQDgQEBAhhAM4JACgECSGlSDgQGBAhgAM0IAikECCClSTkQGBAggAE0IwikECCAlCblQGBAgAAG0IwgkEKAAFKalAOBAQECGEAzgkAKAQJIaVIOBAYECGAAzQgCKQQIIKVJORAYECCAATQjCKQQIICUJuVAYECAAAbQjCCQQoAAUpqUA4EBAQIYQDOCQAoBAkhpUg4EBgQIYADNCAIpBAggpUk5EBgQIIABNCMIpBAggJQm5UBgQIAABtCMIJBCgABSmpQDgQEBAhhAM4JACgECSGlSDgQGBAhgAM0IAikECCClSTkQGBD4C9goER8tauZoAAAAAElFTkSuQmCC",(function(){Mt.loadingLocks.delete(Wa.ellipsis)})),hamburgerIcon:(new r.TextureLoader).load("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAQAAAAHUWYVAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA75o43NsAAAAHdElNRQflBwgBKRc7nqR1AAAAAW9yTlQBz6J3mgAAAQpJREFUeNrt3bEKgzAUQNFY/P8f7mBnoVMN9UbO2RN43jE8HAMAAAAAAAAAAAAAAAAAAAAAAACANW2T79uP990j/dc2+Qu+7h6IM0FiBIkRJEaQGEFiBIkRJEaQGEFiBIkRJEaQGEFiBIkRJEaQGEFiZgc57h4IAAAAAAAAACaZvRY9xv7zySvv8Sue/cqe+kX21B9OkBhBYgSJESRGkBhBYgSJESRGkBhBYgSJESRGkBhBYgSJESRGkBhBAAAAAAAAAIAl2FO/yJ76wwkSI0iMIDGCxAgSI0iMIDGCxAgSI0iMIDGCxAgSI0iMIDGCxAgS43/qAAAAAAAAAAAAAAAAAAAAAAAAADDFB0xaDHVXaSV/AAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIxLTA3LTA4VDAxOjQxOjIzKzAwOjAw09nK7wAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMS0wNy0wOFQwMTo0MToyMyswMDowMKKEclMAAAAASUVORK5CYII=",(function(){Mt.loadingLocks.delete(Wa.hamburger)})),headphonesIcon:(new r.TextureLoader).load("data:image/png;base64,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",(function(){Mt.loadingLocks.delete(Wa.headphones)})),homeIcon:(new r.TextureLoader).load("data:image/png;base64,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",(function(){Mt.loadingLocks.delete(Wa.home)})),imageIcon:(new r.TextureLoader).load("data:image/png;base64,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",(function(){Mt.loadingLocks.delete(Wa.image)})),lightbulbIcon:(new r.TextureLoader).load("data:image/png;base64,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",(function(){Mt.loadingLocks.delete(Wa.lightbulb)})),materialIcon:(new r.TextureLoader).load("data:image/png;base64,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",(function(){Mt.loadingLocks.delete(Wa.material)})),microphoneIcon:(new r.TextureLoader).load("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAYAAABccqhmAAAAAXNSR0IArs4c6QAADzlJREFUeF7tnOuaWykMBOP3f+jZbzaZJOP4ApySEFD7N9BHtFpljp3N7Yf/benAx8fHB3mw2+12I/XUquGATa3RB6QKeuifFSUMkHaVEBEAJdowXkTW0AuD8R5V3ikAKnfnSW2zh14YLBiaJyULgIV6WXXw7y30FWGdUAmARXq1yvB/2SkE1giWACjep9UG39tA8UDdlScAivZr9cEXBEWDJQDqN2a34fe1oG7mvAEU682uwy8EigXtVzkCoFBfdh9+IVAobAKgTjNOGXy/F6iTud8wrlfSWRWdOvzeBmrk3FeAiX04ffiFwMTw+Qow13yH/7v//sWhOXn0BjDH9x8CQABMit63xwqACV1w+B+b7i0gP4wCINlzh/+14UIgN5ACINFvh7/NbCHQ5hOxSgAQLjZoVBr+ZwO2Qo0NVrukwwEB0GHWlaUzh2v0E3XFmq/06MS9AiCh6zMGaXTon9mxwxkSWr3cIwRAQssyh4ce/Ht7djpLQuvLP0IABLcoa2CiB38WCLLPFRyHcvICILglGQCYNSQ7ny04FmXkBUBgK04YkBPOGBiR6dICIKgF0YMx61N/1peE1c4bFJt0WQEQZHkkAKoOw4lnDopPmqwACLL6xGE48cxB8UmTFQABVp88CCefPSBK4ZICIMDiqCGoevXP+olwlfMHRCpMUgAEWBsBgNXCrwcBwQqQFACwqRHB/yxRAPxs1Go+wPHC5QQAbGkEAFYNvV7A4QqQEwCwqYb+j6F6AYcrQE4AwKbSoV/10//LVv2AAwbLCQDQUDrsO7zz6gkYsAApAQCaatj/NVNPwIAFSAkA0FQ67Ktf/30NAMMVJCUAQGMFwGMz9QUMGSwlAEBDDboAAOOUIiUAQJsFgAAA45QiJQBAmwWAAADjlCIlAECbBYAAAOOUIiUAQJtJAOzyC0DELwG7eQNGsFtKAHRb9nyDANAbME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVICALRZAAgAME4pUgIAtFkACAAwTilSAgC0WQAIADBOKVLbAuDZMN5ut7AzC4D1ATAjNymT/uQhYcMw61A9Q0jDoOfZ7/yha3v3vOg/r+xNT2279WUrAPQ08ivwZENHnv9s8Mi6ooe7Rb+qNyN17dSbbQAw0kgaAldquB+inUL2ebaK3lypaZf+bAGAK40kIUDUQdbT8smctaaaN0Q9O0BgeQAQjfwcAqKZVC1UPVnD3fKcat5Q9RC5afEvao0A+MvZq82kQiUAXsfdPnE4EAACgEvTC6VKcKxUS4r5Lx4iAARASgYrDV2lWlLM3xUAZCOJazdZz9Vr7uxg3T+/kjdkLURuZvZq6RtAtUaS9QiA52Nx1RuyTwJgIr6q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",(function(){Mt.loadingLocks.delete(Wa.microphone)})),objectIcon:(new r.TextureLoader).load("data:image/png;base64,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",(function(){Mt.loadingLocks.delete(Wa.object)})),pencilIcon:(new r.TextureLoader).load("data:image/png;base64,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",(function(){Mt.loadingLocks.delete(Wa.pencil)})),searchIcon:(new r.TextureLoader).load("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAAEACAMAAABrrFhUAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAALxUExURUdwTP///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9wLB8UAAAD6dFJOUwD9+gT7AwL+AfyNlpUFB/aD9RnzCSMR+fL3C63wwzOy7+l4cHlrORX4KApD7VeaG+7O8WjnJsj0CAadQGRZ4xR2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",(function(){Mt.loadingLocks.delete(Wa.search)})),shapesIcon:(new r.TextureLoader).load("data:image/png;base64,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",(function(){Mt.loadingLocks.delete(Wa.shapes)})),systemIcon:(new r.TextureLoader).load("data:image/png;base64,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",(function(){Mt.loadingLocks.delete(Wa.system)})),textIcon:(new r.TextureLoader).load("data:image/png;base64,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",(function(){Mt.loadingLocks.delete(Wa.text)})),textureIcon:(new r.TextureLoader).load("data:image/png;base64,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",(function(){Mt.loadingLocks.delete(Wa.texture)})),trashIcon:(new r.TextureLoader).load("data:image/png;base64,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",(function(){Mt.loadingLocks.delete(Wa.trash)})),undoIcon:(new r.TextureLoader).load("data:image/png;base64,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",(function(){Mt.loadingLocks.delete(Wa.undo)})),redoIcon:(new r.TextureLoader).load("data:image/png;base64,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",(function(){Mt.loadingLocks.delete(Wa.redo)})),videoIcon:(new r.TextureLoader).load("data:image/png;base64,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",(function(){Mt.loadingLocks.delete(Wa.video)})),blackPixel:(new r.TextureLoader).load("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAAAAAA6fptVAAAACXBIWXMAAAsTAAALEwEAmpwYAAAACklEQVQIHWNgAAAAAgABz8g15QAAAABJRU5ErkJggg==",(function(){Mt.loadingLocks.delete(Xa)}))},Ka={defaultMeshMaterial:new r.MeshLambertMaterial({color:65280,side:r.DoubleSide})},qa={black:new r.Color(0),blue:new r.Color(255),green:new r.Color(65280),red:new r.Color(16711680),white:new r.Color(16777215),yellow:new r.Color(16776960),defaultIdle:new r.Color(9868950),hoveredButton:new r.Color(6514283),defaultMenuBackground:new r.Color(0)},Za=.03,Ja=.02;let $a=new Style({color:qa.white,fontSize:Za,height:.05}),eo=new Style({materialColor:qa.hoveredButton}),to=new Style({backgroundVisible:!0,borderRadius:.01,height:.04,justifyContent:"center",materialColor:qa.defaultIdle,width:.04}),so=new Style({backgroundVisible:!0,borderRadius:.01,height:.035,justifyContent:"center",materialColor:qa.defaultIdle,width:.3}),io=new Style({borderRadius:.01,height:.035,justifyContent:"center",textureFit:"cover",width:.3});const ro={bodyText:new Style({color:qa.white,fontSize:Ja}),headerText:new Style({color:qa.white,fontSize:Za}),title:$a,hoveredButton:eo,smallButton:to,wideButton:so,wideImageButton:io};const ao=[new r.Vector3,new r.Vector3,new r.Vector3],oo=new r.Vector2,lo=new r.Euler,ho=new r.Quaternion,co=new r.Matrix4;let uo=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),po=new r.BufferGeometry;po.setIndex(new r.BufferAttribute(uo,1)),po.setAttribute("position",new r.Float32BufferAttribute([1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],3));const Ao={geometry:po,material:new r.LineBasicMaterial({color:qa.yellow,toneMapped:!1})},go={None:r.NoColorSpace,sRGB:r.SRGBColorSpace,"Linear sRGB":r.LinearSRGBColorSpace},fo={Multiply:r.MultiplyOperation,Mix:r.MixOperation,Add:r.AddOperation},mo={Linear:"linear",Inverse:"inverse",Exponential:"exponential"},_o={Reflection:r.CubeReflectionMapping,Refraction:r.CubeRefractionMapping},bo={Tangent:r.TangentSpaceNormalMap,Object:r.ObjectSpaceNormalMap},yo={"Front Side":r.FrontSide,"Back Side":r.BackSide,"Both Sides":r.DoubleSide},vo={Clamp:r.ClampToEdgeWrapping,Repeat:r.RepeatWrapping,Mirrored:r.MirroredRepeatWrapping};function toTrianglesDrawMode(r,A){if(A===ze)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),r;if(A===We||A===Xe){let b=r.getIndex();if(null===b){const A=[],C=r.getAttribute("position");if(void 0===C)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),r;for(let r=0;r<C.count;r++)A.push(r);r.setIndex(A),b=r.getIndex()}const C=b.count-2,I=[];if(A===We)for(let r=1;r<=C;r++)I.push(b.getX(0)),I.push(b.getX(r)),I.push(b.getX(r+1));else for(let r=0;r<C;r++)r%2==0?(I.push(b.getX(r)),I.push(b.getX(r+1)),I.push(b.getX(r+2))):(I.push(b.getX(r+2)),I.push(b.getX(r+1)),I.push(b.getX(r)));I.length/3!==C&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const x=r.clone();return x.setIndex(I),x.clearGroups(),x}return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",A),r}class GLTFLoader extends ee{constructor(r){super(r),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register((function(r){return new GLTFMaterialsClearcoatExtension(r)})),this.register((function(r){return new GLTFMaterialsDispersionExtension(r)})),this.register((function(r){return new GLTFTextureBasisUExtension(r)})),this.register((function(r){return new GLTFTextureWebPExtension(r)})),this.register((function(r){return new GLTFTextureAVIFExtension(r)})),this.register((function(r){return new GLTFMaterialsSheenExtension(r)})),this.register((function(r){return new GLTFMaterialsTransmissionExtension(r)})),this.register((function(r){return new GLTFMaterialsVolumeExtension(r)})),this.register((function(r){return new GLTFMaterialsIorExtension(r)})),this.register((function(r){return new GLTFMaterialsEmissiveStrengthExtension(r)})),this.register((function(r){return new GLTFMaterialsSpecularExtension(r)})),this.register((function(r){return new GLTFMaterialsIridescenceExtension(r)})),this.register((function(r){return new GLTFMaterialsAnisotropyExtension(r)})),this.register((function(r){return new GLTFMaterialsBumpExtension(r)})),this.register((function(r){return new GLTFLightsExtension(r)})),this.register((function(r){return new GLTFMeshoptCompression(r)})),this.register((function(r){return new GLTFMeshGpuInstancing(r)}))}load(r,A,b,C){const I=this;let x;if(""!==this.resourcePath)x=this.resourcePath;else if(""!==this.path){const A=te.extractUrlBase(r);x=te.resolveURL(A,this.path)}else x=te.extractUrlBase(r);this.manager.itemStart(r);const _onError=function(A){C?C(A):console.error(A),I.manager.itemError(r),I.manager.itemEnd(r)},S=new se(this.manager);S.setPath(this.path),S.setResponseType("arraybuffer"),S.setRequestHeader(this.requestHeader),S.setWithCredentials(this.withCredentials),S.load(r,(function(b){try{I.parse(b,x,(function(b){A(b),I.manager.itemEnd(r)}),_onError)}catch(r){_onError(r)}}),b,_onError)}setDRACOLoader(r){return this.dracoLoader=r,this}setKTX2Loader(r){return this.ktx2Loader=r,this}setMeshoptDecoder(r){return this.meshoptDecoder=r,this}register(r){return-1===this.pluginCallbacks.indexOf(r)&&this.pluginCallbacks.push(r),this}unregister(r){return-1!==this.pluginCallbacks.indexOf(r)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(r),1),this}parse(r,A,b,C){let I;const x={},S={},B=new TextDecoder;if("string"==typeof r)I=JSON.parse(r);else if(r instanceof ArrayBuffer){if(B.decode(new Uint8Array(r,0,4))===wo){try{x[Co.KHR_BINARY_GLTF]=new GLTFBinaryExtension(r)}catch(r){return void(C&&C(r))}I=JSON.parse(x[Co.KHR_BINARY_GLTF].content)}else I=JSON.parse(B.decode(r))}else I=r;if(void 0===I.asset||I.asset.version[0]<2)return void(C&&C(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported.")));const D=new GLTFParser(I,{path:A||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});D.fileLoader.setRequestHeader(this.requestHeader);for(let r=0;r<this.pluginCallbacks.length;r++){const A=this.pluginCallbacks[r](D);A.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),S[A.name]=A,x[A.name]=!0}if(I.extensionsUsed)for(let r=0;r<I.extensionsUsed.length;++r){const A=I.extensionsUsed[r],b=I.extensionsRequired||[];switch(A){case Co.KHR_MATERIALS_UNLIT:x[A]=new GLTFMaterialsUnlitExtension;break;case Co.KHR_DRACO_MESH_COMPRESSION:x[A]=new GLTFDracoMeshCompressionExtension(I,this.dracoLoader);break;case Co.KHR_TEXTURE_TRANSFORM:x[A]=new GLTFTextureTransformExtension;break;case Co.KHR_MESH_QUANTIZATION:x[A]=new GLTFMeshQuantizationExtension;break;default:b.indexOf(A)>=0&&void 0===S[A]&&console.warn('THREE.GLTFLoader: Unknown extension "'+A+'".')}}D.setExtensions(x),D.setPlugins(S),D.parse(b,C)}parseAsync(r,A){const b=this;return new Promise((function(C,I){b.parse(r,A,C,I)}))}}function GLTFRegistry(){let r={};return{get:function(A){return r[A]},add:function(A,b){r[A]=b},remove:function(A){delete r[A]},removeAll:function(){r={}}}}const Co={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"};class GLTFLightsExtension{constructor(r){this.parser=r,this.name=Co.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const r=this.parser,A=this.parser.json.nodes||[];for(let b=0,C=A.length;b<C;b++){const C=A[b];C.extensions&&C.extensions[this.name]&&void 0!==C.extensions[this.name].light&&r._addNodeRef(this.cache,C.extensions[this.name].light)}}_loadLight(r){const A=this.parser,b="light:"+r;let C=A.cache.get(b);if(C)return C;const I=A.json,x=((I.extensions&&I.extensions[this.name]||{}).lights||[])[r];let S;const B=new Q(16777215);void 0!==x.color&&B.setRGB(x.color[0],x.color[1],x.color[2],ie);const D=void 0!==x.range?x.range:0;switch(x.type){case"directional":S=new ae(B),S.target.position.set(0,0,-1),S.add(S.target);break;case"point":S=new re(B),S.distance=D;break;case"spot":S=new ne(B),S.distance=D,x.spot=x.spot||{},x.spot.innerConeAngle=void 0!==x.spot.innerConeAngle?x.spot.innerConeAngle:0,x.spot.outerConeAngle=void 0!==x.spot.outerConeAngle?x.spot.outerConeAngle:Math.PI/4,S.angle=x.spot.outerConeAngle,S.penumbra=1-x.spot.innerConeAngle/x.spot.outerConeAngle,S.target.position.set(0,0,-1),S.add(S.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+x.type)}return S.position.set(0,0,0),S.decay=2,assignExtrasToUserData(S,x),void 0!==x.intensity&&(S.intensity=x.intensity),S.name=A.createUniqueName(x.name||"light_"+r),C=Promise.resolve(S),A.cache.add(b,C),C}getDependency(r,A){if("light"===r)return this._loadLight(A)}createNodeAttachment(r){const A=this,b=this.parser,C=b.json.nodes[r],I=(C.extensions&&C.extensions[this.name]||{}).light;return void 0===I?null:this._loadLight(I).then((function(r){return b._getNodeRef(A.cache,I,r)}))}}class GLTFMaterialsUnlitExtension{constructor(){this.name=Co.KHR_MATERIALS_UNLIT}getMaterialType(){return H}extendParams(r,A,b){const C=[];r.color=new Q(1,1,1),r.opacity=1;const I=A.pbrMetallicRoughness;if(I){if(Array.isArray(I.baseColorFactor)){const A=I.baseColorFactor;r.color.setRGB(A[0],A[1],A[2],ie),r.opacity=A[3]}void 0!==I.baseColorTexture&&C.push(b.assignTexture(r,"map",I.baseColorTexture,oe))}return Promise.all(C)}}class GLTFMaterialsEmissiveStrengthExtension{constructor(r){this.parser=r,this.name=Co.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(r,A){const b=this.parser.json.materials[r];if(!b.extensions||!b.extensions[this.name])return Promise.resolve();const C=b.extensions[this.name].emissiveStrength;return void 0!==C&&(A.emissiveIntensity=C),Promise.resolve()}}class GLTFMaterialsClearcoatExtension{constructor(r){this.parser=r,this.name=Co.KHR_MATERIALS_CLEARCOAT}getMaterialType(r){const A=this.parser.json.materials[r];return A.extensions&&A.extensions[this.name]?le:null}extendMaterialParams(r,A){const C=this.parser,I=C.json.materials[r];if(!I.extensions||!I.extensions[this.name])return Promise.resolve();const x=[],S=I.extensions[this.name];if(void 0!==S.clearcoatFactor&&(A.clearcoat=S.clearcoatFactor),void 0!==S.clearcoatTexture&&x.push(C.assignTexture(A,"clearcoatMap",S.clearcoatTexture)),void 0!==S.clearcoatRoughnessFactor&&(A.clearcoatRoughness=S.clearcoatRoughnessFactor),void 0!==S.clearcoatRoughnessTexture&&x.push(C.assignTexture(A,"clearcoatRoughnessMap",S.clearcoatRoughnessTexture)),void 0!==S.clearcoatNormalTexture&&(x.push(C.assignTexture(A,"clearcoatNormalMap",S.clearcoatNormalTexture)),void 0!==S.clearcoatNormalTexture.scale)){const r=S.clearcoatNormalTexture.scale;A.clearcoatNormalScale=new b(r,r)}return Promise.all(x)}}class GLTFMaterialsDispersionExtension{constructor(r){this.parser=r,this.name=Co.KHR_MATERIALS_DISPERSION}getMaterialType(r){const A=this.parser.json.materials[r];return A.extensions&&A.extensions[this.name]?le:null}extendMaterialParams(r,A){const b=this.parser.json.materials[r];if(!b.extensions||!b.extensions[this.name])return Promise.resolve();const C=b.extensions[this.name];return A.dispersion=void 0!==C.dispersion?C.dispersion:0,Promise.resolve()}}class GLTFMaterialsIridescenceExtension{constructor(r){this.parser=r,this.name=Co.KHR_MATERIALS_IRIDESCENCE}getMaterialType(r){const A=this.parser.json.materials[r];return A.extensions&&A.extensions[this.name]?le:null}extendMaterialParams(r,A){const b=this.parser,C=b.json.materials[r];if(!C.extensions||!C.extensions[this.name])return Promise.resolve();const I=[],x=C.extensions[this.name];return void 0!==x.iridescenceFactor&&(A.iridescence=x.iridescenceFactor),void 0!==x.iridescenceTexture&&I.push(b.assignTexture(A,"iridescenceMap",x.iridescenceTexture)),void 0!==x.iridescenceIor&&(A.iridescenceIOR=x.iridescenceIor),void 0===A.iridescenceThicknessRange&&(A.iridescenceThicknessRange=[100,400]),void 0!==x.iridescenceThicknessMinimum&&(A.iridescenceThicknessRange[0]=x.iridescenceThicknessMinimum),void 0!==x.iridescenceThicknessMaximum&&(A.iridescenceThicknessRange[1]=x.iridescenceThicknessMaximum),void 0!==x.iridescenceThicknessTexture&&I.push(b.assignTexture(A,"iridescenceThicknessMap",x.iridescenceThicknessTexture)),Promise.all(I)}}class GLTFMaterialsSheenExtension{constructor(r){this.parser=r,this.name=Co.KHR_MATERIALS_SHEEN}getMaterialType(r){const A=this.parser.json.materials[r];return A.extensions&&A.extensions[this.name]?le:null}extendMaterialParams(r,A){const b=this.parser,C=b.json.materials[r];if(!C.extensions||!C.extensions[this.name])return Promise.resolve();const I=[];A.sheenColor=new Q(0,0,0),A.sheenRoughness=0,A.sheen=1;const x=C.extensions[this.name];if(void 0!==x.sheenColorFactor){const r=x.sheenColorFactor;A.sheenColor.setRGB(r[0],r[1],r[2],ie)}return void 0!==x.sheenRoughnessFactor&&(A.sheenRoughness=x.sheenRoughnessFactor),void 0!==x.sheenColorTexture&&I.push(b.assignTexture(A,"sheenColorMap",x.sheenColorTexture,oe)),void 0!==x.sheenRoughnessTexture&&I.push(b.assignTexture(A,"sheenRoughnessMap",x.sheenRoughnessTexture)),Promise.all(I)}}class GLTFMaterialsTransmissionExtension{constructor(r){this.parser=r,this.name=Co.KHR_MATERIALS_TRANSMISSION}getMaterialType(r){const A=this.parser.json.materials[r];return A.extensions&&A.extensions[this.name]?le:null}extendMaterialParams(r,A){const b=this.parser,C=b.json.materials[r];if(!C.extensions||!C.extensions[this.name])return Promise.resolve();const I=[],x=C.extensions[this.name];return void 0!==x.transmissionFactor&&(A.transmission=x.transmissionFactor),void 0!==x.transmissionTexture&&I.push(b.assignTexture(A,"transmissionMap",x.transmissionTexture)),Promise.all(I)}}class GLTFMaterialsVolumeExtension{constructor(r){this.parser=r,this.name=Co.KHR_MATERIALS_VOLUME}getMaterialType(r){const A=this.parser.json.materials[r];return A.extensions&&A.extensions[this.name]?le:null}extendMaterialParams(r,A){const b=this.parser,C=b.json.materials[r];if(!C.extensions||!C.extensions[this.name])return Promise.resolve();const I=[],x=C.extensions[this.name];A.thickness=void 0!==x.thicknessFactor?x.thicknessFactor:0,void 0!==x.thicknessTexture&&I.push(b.assignTexture(A,"thicknessMap",x.thicknessTexture)),A.attenuationDistance=x.attenuationDistance||Infinity;const S=x.attenuationColor||[1,1,1];return A.attenuationColor=(new Q).setRGB(S[0],S[1],S[2],ie),Promise.all(I)}}class GLTFMaterialsIorExtension{constructor(r){this.parser=r,this.name=Co.KHR_MATERIALS_IOR}getMaterialType(r){const A=this.parser.json.materials[r];return A.extensions&&A.extensions[this.name]?le:null}extendMaterialParams(r,A){const b=this.parser.json.materials[r];if(!b.extensions||!b.extensions[this.name])return Promise.resolve();const C=b.extensions[this.name];return A.ior=void 0!==C.ior?C.ior:1.5,Promise.resolve()}}class GLTFMaterialsSpecularExtension{constructor(r){this.parser=r,this.name=Co.KHR_MATERIALS_SPECULAR}getMaterialType(r){const A=this.parser.json.materials[r];return A.extensions&&A.extensions[this.name]?le:null}extendMaterialParams(r,A){const b=this.parser,C=b.json.materials[r];if(!C.extensions||!C.extensions[this.name])return Promise.resolve();const I=[],x=C.extensions[this.name];A.specularIntensity=void 0!==x.specularFactor?x.specularFactor:1,void 0!==x.specularTexture&&I.push(b.assignTexture(A,"specularIntensityMap",x.specularTexture));const S=x.specularColorFactor||[1,1,1];return A.specularColor=(new Q).setRGB(S[0],S[1],S[2],ie),void 0!==x.specularColorTexture&&I.push(b.assignTexture(A,"specularColorMap",x.specularColorTexture,oe)),Promise.all(I)}}class GLTFMaterialsBumpExtension{constructor(r){this.parser=r,this.name=Co.EXT_MATERIALS_BUMP}getMaterialType(r){const A=this.parser.json.materials[r];return A.extensions&&A.extensions[this.name]?le:null}extendMaterialParams(r,A){const b=this.parser,C=b.json.materials[r];if(!C.extensions||!C.extensions[this.name])return Promise.resolve();const I=[],x=C.extensions[this.name];return A.bumpScale=void 0!==x.bumpFactor?x.bumpFactor:1,void 0!==x.bumpTexture&&I.push(b.assignTexture(A,"bumpMap",x.bumpTexture)),Promise.all(I)}}class GLTFMaterialsAnisotropyExtension{constructor(r){this.parser=r,this.name=Co.KHR_MATERIALS_ANISOTROPY}getMaterialType(r){const A=this.parser.json.materials[r];return A.extensions&&A.extensions[this.name]?le:null}extendMaterialParams(r,A){const b=this.parser,C=b.json.materials[r];if(!C.extensions||!C.extensions[this.name])return Promise.resolve();const I=[],x=C.extensions[this.name];return void 0!==x.anisotropyStrength&&(A.anisotropy=x.anisotropyStrength),void 0!==x.anisotropyRotation&&(A.anisotropyRotation=x.anisotropyRotation),void 0!==x.anisotropyTexture&&I.push(b.assignTexture(A,"anisotropyMap",x.anisotropyTexture)),Promise.all(I)}}class GLTFTextureBasisUExtension{constructor(r){this.parser=r,this.name=Co.KHR_TEXTURE_BASISU}loadTexture(r){const A=this.parser,b=A.json,C=b.textures[r];if(!C.extensions||!C.extensions[this.name])return null;const I=C.extensions[this.name],x=A.options.ktx2Loader;if(!x){if(b.extensionsRequired&&b.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return A.loadTextureImage(r,I.source,x)}}class GLTFTextureWebPExtension{constructor(r){this.parser=r,this.name=Co.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(r){const A=this.name,b=this.parser,C=b.json,I=C.textures[r];if(!I.extensions||!I.extensions[A])return null;const x=I.extensions[A],S=C.images[x.source];let B=b.textureLoader;if(S.uri){const r=b.options.manager.getHandler(S.uri);null!==r&&(B=r)}return this.detectSupport().then((function(I){if(I)return b.loadTextureImage(r,x.source,B);if(C.extensionsRequired&&C.extensionsRequired.indexOf(A)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return b.loadTexture(r)}))}detectSupport(){return this.isSupported||(this.isSupported=new Promise((function(r){const A=new Image;A.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",A.onload=A.onerror=function(){r(1===A.height)}}))),this.isSupported}}class GLTFTextureAVIFExtension{constructor(r){this.parser=r,this.name=Co.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(r){const A=this.name,b=this.parser,C=b.json,I=C.textures[r];if(!I.extensions||!I.extensions[A])return null;const x=I.extensions[A],S=C.images[x.source];let B=b.textureLoader;if(S.uri){const r=b.options.manager.getHandler(S.uri);null!==r&&(B=r)}return this.detectSupport().then((function(I){if(I)return b.loadTextureImage(r,x.source,B);if(C.extensionsRequired&&C.extensionsRequired.indexOf(A)>=0)throw new Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return b.loadTexture(r)}))}detectSupport(){return this.isSupported||(this.isSupported=new Promise((function(r){const A=new Image;A.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",A.onload=A.onerror=function(){r(1===A.height)}}))),this.isSupported}}class GLTFMeshoptCompression{constructor(r){this.name=Co.EXT_MESHOPT_COMPRESSION,this.parser=r}loadBufferView(r){const A=this.parser.json,b=A.bufferViews[r];if(b.extensions&&b.extensions[this.name]){const r=b.extensions[this.name],C=this.parser.getDependency("buffer",r.buffer),I=this.parser.options.meshoptDecoder;if(!I||!I.supported){if(A.extensionsRequired&&A.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return C.then((function(A){const b=r.byteOffset||0,C=r.byteLength||0,x=r.count,S=r.byteStride,B=new Uint8Array(A,b,C);return I.decodeGltfBufferAsync?I.decodeGltfBufferAsync(x,S,B,r.mode,r.filter).then((function(r){return r.buffer})):I.ready.then((function(){const A=new ArrayBuffer(x*S);return I.decodeGltfBuffer(new Uint8Array(A),x,S,B,r.mode,r.filter),A}))}))}return null}}class GLTFMeshGpuInstancing{constructor(r){this.name=Co.EXT_MESH_GPU_INSTANCING,this.parser=r}createNodeMesh(r){const b=this.parser.json,C=b.nodes[r];if(!C.extensions||!C.extensions[this.name]||void 0===C.mesh)return null;const I=b.meshes[C.mesh];for(const r of I.primitives)if(r.mode!==xo.TRIANGLES&&r.mode!==xo.TRIANGLE_STRIP&&r.mode!==xo.TRIANGLE_FAN&&void 0!==r.mode)return null;const x=C.extensions[this.name].attributes,B=[],D={};for(const r in x)B.push(this.parser.getDependency("accessor",x[r]).then((A=>(D[r]=A,D[r]))));return B.length<1?null:(B.push(this.parser.createNodeMesh(r)),Promise.all(B).then((r=>{const b=r.pop(),C=b.isGroup?b.children:[b],I=r[0].count,x=[];for(const r of C){const b=new S,C=new A,B=new N,R=new A(1,1,1),F=new he(r.geometry,r.material,I);for(let r=0;r<I;r++)D.TRANSLATION&&C.fromBufferAttribute(D.TRANSLATION,r),D.ROTATION&&B.fromBufferAttribute(D.ROTATION,r),D.SCALE&&R.fromBufferAttribute(D.SCALE,r),F.setMatrixAt(r,b.compose(C,B,R));for(const A in D)if("_COLOR_0"===A){const r=D[A];F.instanceColor=new de(r.array,r.itemSize,r.normalized)}else"TRANSLATION"!==A&&"ROTATION"!==A&&"SCALE"!==A&&r.geometry.setAttribute(A,D[A]);ce.prototype.copy.call(F,r),this.parser.assignFinalMaterial(F),x.push(F)}return b.isGroup?(b.clear(),b.add(...x),b):x[0]})))}}const wo="glTF",Eo=1313821514,Io=5130562;class GLTFBinaryExtension{constructor(r){this.name=Co.KHR_BINARY_GLTF,this.content=null,this.body=null;const A=new DataView(r,0,12),b=new TextDecoder;if(this.header={magic:b.decode(new Uint8Array(r.slice(0,4))),version:A.getUint32(4,!0),length:A.getUint32(8,!0)},this.header.magic!==wo)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const C=this.header.length-12,I=new DataView(r,12);let x=0;for(;x<C;){const A=I.getUint32(x,!0);x+=4;const C=I.getUint32(x,!0);if(x+=4,C===Eo){const C=new Uint8Array(r,12+x,A);this.content=b.decode(C)}else if(C===Io){const b=12+x;this.body=r.slice(b,b+A)}x+=A}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class GLTFDracoMeshCompressionExtension{constructor(r,A){if(!A)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=Co.KHR_DRACO_MESH_COMPRESSION,this.json=r,this.dracoLoader=A,this.dracoLoader.preload()}decodePrimitive(r,A){const b=this.json,C=this.dracoLoader,I=r.extensions[this.name].bufferView,x=r.extensions[this.name].attributes,S={},B={},D={};for(const r in x){const A=Mo[r]||r.toLowerCase();S[A]=x[r]}for(const A in r.attributes){const C=Mo[A]||A.toLowerCase();if(void 0!==x[A]){const I=b.accessors[r.attributes[A]],x=So[I.componentType];D[C]=x.name,B[C]=!0===I.normalized}}return A.getDependency("bufferView",I).then((function(r){return new Promise((function(A,b){C.decodeDracoFile(r,(function(r){for(const A in r.attributes){const b=r.attributes[A],C=B[A];void 0!==C&&(b.normalized=C)}A(r)}),S,D,ie,b)}))}))}}class GLTFTextureTransformExtension{constructor(){this.name=Co.KHR_TEXTURE_TRANSFORM}extendTexture(r,A){return void 0!==A.texCoord&&A.texCoord!==r.channel||void 0!==A.offset||void 0!==A.rotation||void 0!==A.scale?(r=r.clone(),void 0!==A.texCoord&&(r.channel=A.texCoord),void 0!==A.offset&&r.offset.fromArray(A.offset),void 0!==A.rotation&&(r.rotation=A.rotation),void 0!==A.scale&&r.repeat.fromArray(A.scale),r.needsUpdate=!0,r):r}}class GLTFMeshQuantizationExtension{constructor(){this.name=Co.KHR_MESH_QUANTIZATION}}class GLTFCubicSplineInterpolant extends Ye{constructor(r,A,b,C){super(r,A,b,C)}copySampleValue_(r){const A=this.resultBuffer,b=this.sampleValues,C=this.valueSize,I=r*C*3+C;for(let r=0;r!==C;r++)A[r]=b[I+r];return A}interpolate_(r,A,b,C){const I=this.resultBuffer,x=this.sampleValues,S=this.valueSize,B=2*S,D=3*S,R=C-A,F=(b-A)/R,N=F*F,Q=N*F,H=r*D,G=H-D,j=-2*Q+3*N,V=Q-N,W=1-j,X=V-N+F;for(let r=0;r!==S;r++){const A=x[G+r+S],b=x[G+r+B]*R,C=x[H+r+S],D=x[H+r]*R;I[r]=W*A+X*b+j*C+V*D}return I}}const To=new N;class GLTFCubicSplineQuaternionInterpolant extends GLTFCubicSplineInterpolant{interpolate_(r,A,b,C){const I=super.interpolate_(r,A,b,C);return To.fromArray(I).normalize().toArray(I),I}}const xo={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},So={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},Bo={9728:q,9729:fe,9984:Ke,9985:qe,9986:Ze,9987:me},Do={33071:Je,33648:$e,10497:_e},Po={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Mo={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},ko={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Ro={CUBICSPLINE:void 0,LINEAR:Ne,STEP:et},Fo="OPAQUE",Lo="MASK",Oo="BLEND";function addUnknownExtensionsToUserData(r,A,b){for(const C in b.extensions)void 0===r[C]&&(A.userData.gltfExtensions=A.userData.gltfExtensions||{},A.userData.gltfExtensions[C]=b.extensions[C])}function assignExtrasToUserData(r,A){void 0!==A.extras&&("object"==typeof A.extras?Object.assign(r.userData,A.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+A.extras))}function updateMorphTargets(r,A){if(r.updateMorphTargets(),void 0!==A.weights)for(let b=0,C=A.weights.length;b<C;b++)r.morphTargetInfluences[b]=A.weights[b];if(A.extras&&Array.isArray(A.extras.targetNames)){const b=A.extras.targetNames;if(r.morphTargetInfluences.length===b.length){r.morphTargetDictionary={};for(let A=0,C=b.length;A<C;A++)r.morphTargetDictionary[b[A]]=A}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function createPrimitiveKey(r){let A;const b=r.extensions&&r.extensions[Co.KHR_DRACO_MESH_COMPRESSION];if(A=b?"draco:"+b.bufferView+":"+b.indices+":"+createAttributesKey(b.attributes):r.indices+":"+createAttributesKey(r.attributes)+":"+r.mode,void 0!==r.targets)for(let b=0,C=r.targets.length;b<C;b++)A+=":"+createAttributesKey(r.targets[b]);return A}function createAttributesKey(r){let A="";const b=Object.keys(r).sort();for(let C=0,I=b.length;C<I;C++)A+=b[C]+":"+r[b[C]]+";";return A}function getNormalizedComponentScale(r){switch(r){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}const Uo=new S;class GLTFParser{constructor(r={},A={}){this.json=r,this.extensions={},this.plugins={},this.options=A,this.cache=new GLTFRegistry,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let b=!1,C=-1,I=!1,x=-1;if("undefined"!=typeof navigator){const r=navigator.userAgent;b=!0===/^((?!chrome|android).)*safari/i.test(r);const A=r.match(/Version\/(\d+)/);C=b&&A?parseInt(A[1],10):-1,I=r.indexOf("Firefox")>-1,x=I?r.match(/Firefox\/([0-9]+)\./)[1]:-1}"undefined"==typeof createImageBitmap||b&&C<17||I&&x<98?this.textureLoader=new ue(this.options.manager):this.textureLoader=new pe(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new se(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(r){this.extensions=r}setPlugins(r){this.plugins=r}parse(r,A){const b=this,C=this.json,I=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll((function(r){return r._markDefs&&r._markDefs()})),Promise.all(this._invokeAll((function(r){return r.beforeRoot&&r.beforeRoot()}))).then((function(){return Promise.all([b.getDependencies("scene"),b.getDependencies("animation"),b.getDependencies("camera")])})).then((function(A){const x={scene:A[0][C.scene||0],scenes:A[0],animations:A[1],cameras:A[2],asset:C.asset,parser:b,userData:{}};return addUnknownExtensionsToUserData(I,x,C),assignExtrasToUserData(x,C),Promise.all(b._invokeAll((function(r){return r.afterRoot&&r.afterRoot(x)}))).then((function(){for(const r of x.scenes)r.updateMatrixWorld();r(x)}))})).catch(A)}_markDefs(){const r=this.json.nodes||[],A=this.json.skins||[],b=this.json.meshes||[];for(let b=0,C=A.length;b<C;b++){const C=A[b].joints;for(let A=0,b=C.length;A<b;A++)r[C[A]].isBone=!0}for(let A=0,C=r.length;A<C;A++){const C=r[A];void 0!==C.mesh&&(this._addNodeRef(this.meshCache,C.mesh),void 0!==C.skin&&(b[C.mesh].isSkinnedMesh=!0)),void 0!==C.camera&&this._addNodeRef(this.cameraCache,C.camera)}}_addNodeRef(r,A){void 0!==A&&(void 0===r.refs[A]&&(r.refs[A]=r.uses[A]=0),r.refs[A]++)}_getNodeRef(r,A,b){if(r.refs[A]<=1)return b;const C=b.clone(),updateMappings=(r,A)=>{const b=this.associations.get(r);null!=b&&this.associations.set(A,b);for(const[b,C]of r.children.entries())updateMappings(C,A.children[b])};return updateMappings(b,C),C.name+="_instance_"+r.uses[A]++,C}_invokeOne(r){const A=Object.values(this.plugins);A.push(this);for(let b=0;b<A.length;b++){const C=r(A[b]);if(C)return C}return null}_invokeAll(r){const A=Object.values(this.plugins);A.unshift(this);const b=[];for(let C=0;C<A.length;C++){const I=r(A[C]);I&&b.push(I)}return b}getDependency(r,A){const b=r+":"+A;let C=this.cache.get(b);if(!C){switch(r){case"scene":C=this.loadScene(A);break;case"node":C=this._invokeOne((function(r){return r.loadNode&&r.loadNode(A)}));break;case"mesh":C=this._invokeOne((function(r){return r.loadMesh&&r.loadMesh(A)}));break;case"accessor":C=this.loadAccessor(A);break;case"bufferView":C=this._invokeOne((function(r){return r.loadBufferView&&r.loadBufferView(A)}));break;case"buffer":C=this.loadBuffer(A);break;case"material":C=this._invokeOne((function(r){return r.loadMaterial&&r.loadMaterial(A)}));break;case"texture":C=this._invokeOne((function(r){return r.loadTexture&&r.loadTexture(A)}));break;case"skin":C=this.loadSkin(A);break;case"animation":C=this._invokeOne((function(r){return r.loadAnimation&&r.loadAnimation(A)}));break;case"camera":C=this.loadCamera(A);break;default:if(C=this._invokeOne((function(b){return b!=this&&b.getDependency&&b.getDependency(r,A)})),!C)throw new Error("Unknown type: "+r)}this.cache.add(b,C)}return C}getDependencies(r){let A=this.cache.get(r);if(!A){const b=this,C=this.json[r+("mesh"===r?"es":"s")]||[];A=Promise.all(C.map((function(A,C){return b.getDependency(r,C)}))),this.cache.add(r,A)}return A}loadBuffer(r){const A=this.json.buffers[r],b=this.fileLoader;if(A.type&&"arraybuffer"!==A.type)throw new Error("THREE.GLTFLoader: "+A.type+" buffer type is not supported.");if(void 0===A.uri&&0===r)return Promise.resolve(this.extensions[Co.KHR_BINARY_GLTF].body);const C=this.options;return new Promise((function(r,I){b.load(te.resolveURL(A.uri,C.path),r,void 0,(function(){I(new Error('THREE.GLTFLoader: Failed to load buffer "'+A.uri+'".'))}))}))}loadBufferView(r){const A=this.json.bufferViews[r];return this.getDependency("buffer",A.buffer).then((function(r){const b=A.byteLength||0,C=A.byteOffset||0;return r.slice(C,C+b)}))}loadAccessor(r){const A=this,b=this.json,C=this.json.accessors[r];if(void 0===C.bufferView&&void 0===C.sparse){const r=Po[C.type],A=So[C.componentType],b=!0===C.normalized,I=new A(C.count*r);return Promise.resolve(new $(I,r,b))}const I=[];return void 0!==C.bufferView?I.push(this.getDependency("bufferView",C.bufferView)):I.push(null),void 0!==C.sparse&&(I.push(this.getDependency("bufferView",C.sparse.indices.bufferView)),I.push(this.getDependency("bufferView",C.sparse.values.bufferView))),Promise.all(I).then((function(r){const I=r[0],x=Po[C.type],S=So[C.componentType],B=S.BYTES_PER_ELEMENT,D=B*x,R=C.byteOffset||0,F=void 0!==C.bufferView?b.bufferViews[C.bufferView].byteStride:void 0,N=!0===C.normalized;let Q,H;if(F&&F!==D){const r=Math.floor(R/F),b="InterleavedBuffer:"+C.bufferView+":"+C.componentType+":"+r+":"+C.count;let D=A.cache.get(b);D||(Q=new S(I,r*F,C.count*F/B),D=new Ae(Q,F/B),A.cache.add(b,D)),H=new ge(D,x,R%F/B,N)}else Q=null===I?new S(C.count*x):new S(I,R,C.count*x),H=new $(Q,x,N);if(void 0!==C.sparse){const A=Po.SCALAR,b=So[C.sparse.indices.componentType],B=C.sparse.indices.byteOffset||0,D=C.sparse.values.byteOffset||0,R=new b(r[1],B,C.sparse.count*A),F=new S(r[2],D,C.sparse.count*x);null!==I&&(H=new $(H.array.slice(),H.itemSize,H.normalized)),H.normalized=!1;for(let r=0,A=R.length;r<A;r++){const A=R[r];if(H.setX(A,F[r*x]),x>=2&&H.setY(A,F[r*x+1]),x>=3&&H.setZ(A,F[r*x+2]),x>=4&&H.setW(A,F[r*x+3]),x>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}H.normalized=N}return H}))}loadTexture(r){const A=this.json,b=this.options,C=A.textures[r].source,I=A.images[C];let x=this.textureLoader;if(I.uri){const r=b.manager.getHandler(I.uri);null!==r&&(x=r)}return this.loadTextureImage(r,C,x)}loadTextureImage(r,A,b){const C=this,I=this.json,x=I.textures[r],S=I.images[A],B=(S.uri||S.bufferView)+":"+x.sampler;if(this.textureCache[B])return this.textureCache[B];const D=this.loadImageSource(A,b).then((function(A){A.flipY=!1,A.name=x.name||S.name||"",""===A.name&&"string"==typeof S.uri&&!1===S.uri.startsWith("data:image/")&&(A.name=S.uri);const b=(I.samplers||{})[x.sampler]||{};return A.magFilter=Bo[b.magFilter]||fe,A.minFilter=Bo[b.minFilter]||me,A.wrapS=Do[b.wrapS]||_e,A.wrapT=Do[b.wrapT]||_e,C.associations.set(A,{textures:r}),A})).catch((function(){return null}));return this.textureCache[B]=D,D}loadImageSource(r,A){const b=this,C=this.json,I=this.options;if(void 0!==this.sourceCache[r])return this.sourceCache[r].then((r=>r.clone()));const x=C.images[r],S=self.URL||self.webkitURL;let B=x.uri||"",D=!1;if(void 0!==x.bufferView)B=b.getDependency("bufferView",x.bufferView).then((function(r){D=!0;const A=new Blob([r],{type:x.mimeType});return B=S.createObjectURL(A),B}));else if(void 0===x.uri)throw new Error("THREE.GLTFLoader: Image "+r+" is missing URI and bufferView");const R=Promise.resolve(B).then((function(r){return new Promise((function(b,C){let x=b;!0===A.isImageBitmapLoader&&(x=function(r){const A=new be(r);A.needsUpdate=!0,b(A)}),A.load(te.resolveURL(r,I.path),x,void 0,C)}))})).then((function(r){return!0===D&&S.revokeObjectURL(B),assignExtrasToUserData(r,x),r.userData.mimeType=x.mimeType||function getImageURIMimeType(r){return r.search(/\.jpe?g($|\?)/i)>0||0===r.search(/^data\:image\/jpeg/)?"image/jpeg":r.search(/\.webp($|\?)/i)>0||0===r.search(/^data\:image\/webp/)?"image/webp":"image/png"}(x.uri),r})).catch((function(r){throw console.error("THREE.GLTFLoader: Couldn't load texture",B),r}));return this.sourceCache[r]=R,R}assignTexture(r,A,b,C){const I=this;return this.getDependency("texture",b.index).then((function(x){if(!x)return null;if(void 0!==b.texCoord&&b.texCoord>0&&((x=x.clone()).channel=b.texCoord),I.extensions[Co.KHR_TEXTURE_TRANSFORM]){const r=void 0!==b.extensions?b.extensions[Co.KHR_TEXTURE_TRANSFORM]:void 0;if(r){const A=I.associations.get(x);x=I.extensions[Co.KHR_TEXTURE_TRANSFORM].extendTexture(x,r),I.associations.set(x,A)}}return void 0!==C&&(x.colorSpace=C),r[A]=x,x}))}assignFinalMaterial(r){const A=r.geometry;let b=r.material;const C=void 0===A.attributes.tangent,I=void 0!==A.attributes.color,x=void 0===A.attributes.normal;if(r.isPoints){const r="PointsMaterial:"+b.uuid;let A=this.cache.get(r);A||(A=new ye,ve.prototype.copy.call(A,b),A.color.copy(b.color),A.map=b.map,A.sizeAttenuation=!1,this.cache.add(r,A)),b=A}else if(r.isLine){const r="LineBasicMaterial:"+b.uuid;let A=this.cache.get(r);A||(A=new Ce,ve.prototype.copy.call(A,b),A.color.copy(b.color),A.map=b.map,this.cache.add(r,A)),b=A}if(C||I||x){let r="ClonedMaterial:"+b.uuid+":";C&&(r+="derivative-tangents:"),I&&(r+="vertex-colors:"),x&&(r+="flat-shading:");let A=this.cache.get(r);A||(A=b.clone(),I&&(A.vertexColors=!0),x&&(A.flatShading=!0),C&&(A.normalScale&&(A.normalScale.y*=-1),A.clearcoatNormalScale&&(A.clearcoatNormalScale.y*=-1)),this.cache.add(r,A),this.associations.set(A,this.associations.get(b))),b=A}r.material=b}getMaterialType(){return we}loadMaterial(r){const A=this,C=this.json,I=this.extensions,x=C.materials[r];let S;const B={},D=[];if((x.extensions||{})[Co.KHR_MATERIALS_UNLIT]){const r=I[Co.KHR_MATERIALS_UNLIT];S=r.getMaterialType(),D.push(r.extendParams(B,x,A))}else{const b=x.pbrMetallicRoughness||{};if(B.color=new Q(1,1,1),B.opacity=1,Array.isArray(b.baseColorFactor)){const r=b.baseColorFactor;B.color.setRGB(r[0],r[1],r[2],ie),B.opacity=r[3]}void 0!==b.baseColorTexture&&D.push(A.assignTexture(B,"map",b.baseColorTexture,oe)),B.metalness=void 0!==b.metallicFactor?b.metallicFactor:1,B.roughness=void 0!==b.roughnessFactor?b.roughnessFactor:1,void 0!==b.metallicRoughnessTexture&&(D.push(A.assignTexture(B,"metalnessMap",b.metallicRoughnessTexture)),D.push(A.assignTexture(B,"roughnessMap",b.metallicRoughnessTexture))),S=this._invokeOne((function(A){return A.getMaterialType&&A.getMaterialType(r)})),D.push(Promise.all(this._invokeAll((function(A){return A.extendMaterialParams&&A.extendMaterialParams(r,B)}))))}!0===x.doubleSided&&(B.side=G);const R=x.alphaMode||Fo;if(R===Oo?(B.transparent=!0,B.depthWrite=!1):(B.transparent=!1,R===Lo&&(B.alphaTest=void 0!==x.alphaCutoff?x.alphaCutoff:.5)),void 0!==x.normalTexture&&S!==H&&(D.push(A.assignTexture(B,"normalMap",x.normalTexture)),B.normalScale=new b(1,1),void 0!==x.normalTexture.scale)){const r=x.normalTexture.scale;B.normalScale.set(r,r)}if(void 0!==x.occlusionTexture&&S!==H&&(D.push(A.assignTexture(B,"aoMap",x.occlusionTexture)),void 0!==x.occlusionTexture.strength&&(B.aoMapIntensity=x.occlusionTexture.strength)),void 0!==x.emissiveFactor&&S!==H){const r=x.emissiveFactor;B.emissive=(new Q).setRGB(r[0],r[1],r[2],ie)}return void 0!==x.emissiveTexture&&S!==H&&D.push(A.assignTexture(B,"emissiveMap",x.emissiveTexture,oe)),Promise.all(D).then((function(){const b=new S(B);return x.name&&(b.name=x.name),assignExtrasToUserData(b,x),A.associations.set(b,{materials:r}),x.extensions&&addUnknownExtensionsToUserData(I,b,x),b}))}createUniqueName(r){const A=Ee.sanitizeNodeName(r||"");return A in this.nodeNamesUsed?A+"_"+ ++this.nodeNamesUsed[A]:(this.nodeNamesUsed[A]=0,A)}loadGeometries(r){const A=this,b=this.extensions,C=this.primitiveCache;function createDracoPrimitive(r){return b[Co.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(r,A).then((function(b){return addPrimitiveAttributes(b,r,A)}))}const I=[];for(let b=0,x=r.length;b<x;b++){const x=r[b],S=createPrimitiveKey(x),B=C[S];if(B)I.push(B.promise);else{let r;r=x.extensions&&x.extensions[Co.KHR_DRACO_MESH_COMPRESSION]?createDracoPrimitive(x):addPrimitiveAttributes(new Ie,x,A),C[S]={primitive:x,promise:r},I.push(r)}}return Promise.all(I)}loadMesh(r){const A=this,b=this.json,C=this.extensions,I=b.meshes[r],x=I.primitives,S=[];for(let r=0,A=x.length;r<A;r++){const A=void 0===x[r].material?(void 0===(B=this.cache).DefaultMaterial&&(B.DefaultMaterial=new we({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:Te})),B.DefaultMaterial):this.getDependency("material",x[r].material);S.push(A)}var B;return S.push(A.loadGeometries(x)),Promise.all(S).then((function(b){const S=b.slice(0,b.length-1),B=b[b.length-1],R=[];for(let b=0,F=B.length;b<F;b++){const F=B[b],N=x[b];let Q;const H=S[b];if(N.mode===xo.TRIANGLES||N.mode===xo.TRIANGLE_STRIP||N.mode===xo.TRIANGLE_FAN||void 0===N.mode)Q=!0===I.isSkinnedMesh?new xe(F,H):new D(F,H),!0===Q.isSkinnedMesh&&Q.normalizeSkinWeights(),N.mode===xo.TRIANGLE_STRIP?Q.geometry=toTrianglesDrawMode(Q.geometry,Xe):N.mode===xo.TRIANGLE_FAN&&(Q.geometry=toTrianglesDrawMode(Q.geometry,We));else if(N.mode===xo.LINES)Q=new Se(F,H);else if(N.mode===xo.LINE_STRIP)Q=new Be(F,H);else if(N.mode===xo.LINE_LOOP)Q=new De(F,H);else{if(N.mode!==xo.POINTS)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+N.mode);Q=new Pe(F,H)}Object.keys(Q.geometry.morphAttributes).length>0&&updateMorphTargets(Q,I),Q.name=A.createUniqueName(I.name||"mesh_"+r),assignExtrasToUserData(Q,I),N.extensions&&addUnknownExtensionsToUserData(C,Q,N),A.assignFinalMaterial(Q),R.push(Q)}for(let b=0,C=R.length;b<C;b++)A.associations.set(R[b],{meshes:r,primitives:b});if(1===R.length)return I.extensions&&addUnknownExtensionsToUserData(C,R[0],I),R[0];const F=new Me;I.extensions&&addUnknownExtensionsToUserData(C,F,I),A.associations.set(F,{meshes:r});for(let r=0,A=R.length;r<A;r++)F.add(R[r]);return F}))}loadCamera(r){let A;const b=this.json.cameras[r],C=b[b.type];if(C)return"perspective"===b.type?A=new ke(Re.radToDeg(C.yfov),C.aspectRatio||1,C.znear||1,C.zfar||2e6):"orthographic"===b.type&&(A=new Fe(-C.xmag,C.xmag,C.ymag,-C.ymag,C.znear,C.zfar)),b.name&&(A.name=this.createUniqueName(b.name)),assignExtrasToUserData(A,b),Promise.resolve(A);console.warn("THREE.GLTFLoader: Missing camera parameters.")}loadSkin(r){const A=this.json.skins[r],b=[];for(let r=0,C=A.joints.length;r<C;r++)b.push(this._loadNodeShallow(A.joints[r]));return void 0!==A.inverseBindMatrices?b.push(this.getDependency("accessor",A.inverseBindMatrices)):b.push(null),Promise.all(b).then((function(r){const b=r.pop(),C=r,I=[],x=[];for(let r=0,B=C.length;r<B;r++){const B=C[r];if(B){I.push(B);const A=new S;null!==b&&A.fromArray(b.array,16*r),x.push(A)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',A.joints[r])}return new Le(I,x)}))}loadAnimation(r){const A=this.json,b=this,C=A.animations[r],I=C.name?C.name:"animation_"+r,x=[],S=[],B=[],D=[],R=[];for(let r=0,A=C.channels.length;r<A;r++){const A=C.channels[r],b=C.samplers[A.sampler],I=A.target,F=I.node,N=void 0!==C.parameters?C.parameters[b.input]:b.input,Q=void 0!==C.parameters?C.parameters[b.output]:b.output;void 0!==I.node&&(x.push(this.getDependency("node",F)),S.push(this.getDependency("accessor",N)),B.push(this.getDependency("accessor",Q)),D.push(b),R.push(I))}return Promise.all([Promise.all(x),Promise.all(S),Promise.all(B),Promise.all(D),Promise.all(R)]).then((function(r){const A=r[0],C=r[1],x=r[2],S=r[3],B=r[4],D=[];for(let r=0,I=A.length;r<I;r++){const I=A[r],R=C[r],F=x[r],N=S[r],Q=B[r];if(void 0===I)continue;I.updateMatrix&&I.updateMatrix();const H=b._createAnimationTracks(I,R,F,N,Q);if(H)for(let r=0;r<H.length;r++)D.push(H[r])}return new Oe(I,void 0,D)}))}createNodeMesh(r){const A=this.json,b=this,C=A.nodes[r];return void 0===C.mesh?null:b.getDependency("mesh",C.mesh).then((function(r){const A=b._getNodeRef(b.meshCache,C.mesh,r);return void 0!==C.weights&&A.traverse((function(r){if(r.isMesh)for(let A=0,b=C.weights.length;A<b;A++)r.morphTargetInfluences[A]=C.weights[A]})),A}))}loadNode(r){const A=this,b=this.json.nodes[r],C=A._loadNodeShallow(r),I=[],x=b.children||[];for(let r=0,b=x.length;r<b;r++)I.push(A.getDependency("node",x[r]));const S=void 0===b.skin?Promise.resolve(null):A.getDependency("skin",b.skin);return Promise.all([C,Promise.all(I),S]).then((function(r){const A=r[0],b=r[1],C=r[2];null!==C&&A.traverse((function(r){r.isSkinnedMesh&&r.bind(C,Uo)}));for(let r=0,C=b.length;r<C;r++)A.add(b[r]);return A}))}_loadNodeShallow(r){const A=this.json,b=this.extensions,C=this;if(void 0!==this.nodeCache[r])return this.nodeCache[r];const I=A.nodes[r],x=I.name?C.createUniqueName(I.name):"",B=[],D=C._invokeOne((function(A){return A.createNodeMesh&&A.createNodeMesh(r)}));return D&&B.push(D),void 0!==I.camera&&B.push(C.getDependency("camera",I.camera).then((function(r){return C._getNodeRef(C.cameraCache,I.camera,r)}))),C._invokeAll((function(A){return A.createNodeAttachment&&A.createNodeAttachment(r)})).forEach((function(r){B.push(r)})),this.nodeCache[r]=Promise.all(B).then((function(A){let B;if(B=!0===I.isBone?new Ue:A.length>1?new Me:1===A.length?A[0]:new ce,B!==A[0])for(let r=0,b=A.length;r<b;r++)B.add(A[r]);if(I.name&&(B.userData.name=I.name,B.name=x),assignExtrasToUserData(B,I),I.extensions&&addUnknownExtensionsToUserData(b,B,I),void 0!==I.matrix){const r=new S;r.fromArray(I.matrix),B.applyMatrix4(r)}else void 0!==I.translation&&B.position.fromArray(I.translation),void 0!==I.rotation&&B.quaternion.fromArray(I.rotation),void 0!==I.scale&&B.scale.fromArray(I.scale);return C.associations.has(B)||C.associations.set(B,{}),C.associations.get(B).nodes=r,B})),this.nodeCache[r]}loadScene(r){const A=this.extensions,b=this.json.scenes[r],C=this,I=new Me;b.name&&(I.name=C.createUniqueName(b.name)),assignExtrasToUserData(I,b),b.extensions&&addUnknownExtensionsToUserData(A,I,b);const x=b.nodes||[],S=[];for(let r=0,A=x.length;r<A;r++)S.push(C.getDependency("node",x[r]));return Promise.all(S).then((function(r){for(let A=0,b=r.length;A<b;A++)I.add(r[A]);return C.associations=(r=>{const A=new Map;for(const[r,b]of C.associations)(r instanceof ve||r instanceof be)&&A.set(r,b);return r.traverse((r=>{const b=C.associations.get(r);null!=b&&A.set(r,b)})),A})(I),I}))}_createAnimationTracks(r,A,b,C,I){const x=[],S=r.name?r.name:r.uuid,B=[];let D;switch(ko[I.path]===ko.weights?r.traverse((function(r){r.morphTargetInfluences&&B.push(r.name?r.name:r.uuid)})):B.push(S),ko[I.path]){case ko.weights:D=tt;break;case ko.rotation:D=Qe;break;case ko.position:case ko.scale:D=st;break;default:if(1===b.itemSize)D=tt;else D=st}const R=void 0!==C.interpolation?Ro[C.interpolation]:Ne,F=this._getArrayFromAccessor(b);for(let r=0,b=B.length;r<b;r++){const b=new D(B[r]+"."+ko[I.path],A.array,F,R);"CUBICSPLINE"===C.interpolation&&this._createCubicSplineTrackInterpolant(b),x.push(b)}return x}_getArrayFromAccessor(r){let A=r.array;if(r.normalized){const r=getNormalizedComponentScale(A.constructor),b=new Float32Array(A.length);for(let C=0,I=A.length;C<I;C++)b[C]=A[C]*r;A=b}return A}_createCubicSplineTrackInterpolant(r){r.createInterpolant=function InterpolantFactoryMethodGLTFCubicSpline(r){return new(this instanceof Qe?GLTFCubicSplineQuaternionInterpolant:GLTFCubicSplineInterpolant)(this.times,this.values,this.getValueSize()/3,r)},r.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}}function addPrimitiveAttributes(r,b,C){const I=b.attributes,S=[];function assignAttributeAccessor(A,b){return C.getDependency("accessor",A).then((function(A){r.setAttribute(b,A)}))}for(const A in I){const b=Mo[A]||A.toLowerCase();b in r.attributes||S.push(assignAttributeAccessor(I[A],b))}if(void 0!==b.indices&&!r.index){const A=C.getDependency("accessor",b.indices).then((function(A){r.setIndex(A)}));S.push(A)}return He.workingColorSpace!==ie&&"COLOR_0"in I&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${He.workingColorSpace}" not supported.`),assignExtrasToUserData(r,b),function computeBounds(r,b,C){const I=b.attributes,S=new x;if(void 0===I.POSITION)return;{const r=C.json.accessors[I.POSITION],b=r.min,x=r.max;if(void 0===b||void 0===x)return void console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");if(S.set(new A(b[0],b[1],b[2]),new A(x[0],x[1],x[2])),r.normalized){const A=getNormalizedComponentScale(So[r.componentType]);S.min.multiplyScalar(A),S.max.multiplyScalar(A)}}const B=b.targets;if(void 0!==B){const r=new A,b=new A;for(let A=0,I=B.length;A<I;A++){const I=B[A];if(void 0!==I.POSITION){const A=C.json.accessors[I.POSITION],x=A.min,S=A.max;if(void 0!==x&&void 0!==S){if(b.setX(Math.max(Math.abs(x[0]),Math.abs(S[0]))),b.setY(Math.max(Math.abs(x[1]),Math.abs(S[1]))),b.setZ(Math.max(Math.abs(x[2]),Math.abs(S[2]))),A.normalized){const r=getNormalizedComponentScale(So[A.componentType]);b.multiplyScalar(r)}r.max(b)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}S.expandByVector(r)}r.boundingBox=S;const D=new V;S.getCenter(D.center),D.radius=S.min.distanceTo(S.max)/2,r.boundingSphere=D}(r,b,C),Promise.all(S).then((function(){return void 0!==b.targets?function addMorphTargets(r,A,b){let C=!1,I=!1,x=!1;for(let r=0,b=A.length;r<b;r++){const b=A[r];if(void 0!==b.POSITION&&(C=!0),void 0!==b.NORMAL&&(I=!0),void 0!==b.COLOR_0&&(x=!0),C&&I&&x)break}if(!C&&!I&&!x)return Promise.resolve(r);const S=[],B=[],D=[];for(let R=0,F=A.length;R<F;R++){const F=A[R];if(C){const A=void 0!==F.POSITION?b.getDependency("accessor",F.POSITION):r.attributes.position;S.push(A)}if(I){const A=void 0!==F.NORMAL?b.getDependency("accessor",F.NORMAL):r.attributes.normal;B.push(A)}if(x){const A=void 0!==F.COLOR_0?b.getDependency("accessor",F.COLOR_0):r.attributes.color;D.push(A)}}return Promise.all([Promise.all(S),Promise.all(B),Promise.all(D)]).then((function(A){const b=A[0],S=A[1],B=A[2];return C&&(r.morphAttributes.position=b),I&&(r.morphAttributes.normal=S),x&&(r.morphAttributes.color=B),r.morphTargetsRelative=!0,r}))}(r,b.targets,C):r}))}function clone(r){const A=new Map,b=new Map,C=r.clone();return parallelTraverse(r,C,(function(r,C){A.set(C,r),b.set(r,C)})),C.traverse((function(r){if(!r.isSkinnedMesh)return;const C=r,I=A.get(r),x=I.skeleton.bones;C.skeleton=I.skeleton.clone(),C.bindMatrix.copy(I.bindMatrix),C.skeleton.bones=x.map((function(r){return b.get(r)})),C.bind(C.skeleton,C.bindMatrix)})),C}function parallelTraverse(r,A,b){b(r,A);for(let C=0;C<r.children.length;C++)parallelTraverse(r.children[C],A.children[C],b)}const No=["SketchfabID"];let Qo=new class LibraryHandler{constructor(){this.library={},this._blobHashMap={},this._sketchfabIdMap={}}addNewAsset(r,A,b,C){blobToHash(r).then((I=>{if(I in this._blobHashMap)return void(C&&C(this._blobHashMap[I]));let x=uuidv4();this._blobHashMap[I]=x,this.library[x]={Blob:r,Name:A,Type:b,Hash:I},this._loadAsset(x,r).then((()=>{C(x)}))}))}addNewScript(r,A,b){this._addNewScript(!1,r,A,b)}_addNewScript(r,A,b,C){blobToHash(A).then((I=>{if(I in this._blobHashMap)return void(b&&b(this._blobHashMap[I]));let x=URL.createObjectURL(A);import(x).then((x=>{let S=x.default||{},{assetId:B,assetName:D,assetType:R}=S;if(!B||!D||!R)return console.error("Module provided does not have required  static attributes (assetId, assetName, assetType)"),void(C&&C());this._blobHashMap[I]=B,this.library[B]={Name:D,Type:R,Hash:I},r?(this.library[B].URL=r,this.library[B].IsExternal=!0):this.library[B].Blob=A,Qt.publish(this._id,Rt.ASSET_ADDED,B,!0),b&&b(B)})).catch((r=>{console.error(r),C&&C()}))}))}load(r,A,b,C){try{let I=[];for(let b in r){let C,x=r[b];if(x.IsExternal)C=this.loadLibraryExternalAsset(b,x);else{let r=x.Filepath;C=A.file(r).async("arraybuffer").then((r=>this.loadLibraryAssetFromArrayBuffer(b,x,[r])))}I.push(C)}Promise.all(I).then(b).catch((r=>{console.log(r),C&&C()}))}catch(r){console.error(r),C&&C()}}loadLibraryExternalAsset(r,A){return A.Type==kt.VIDEO?this._loadLibraryExternalVideoAsset(r,A):fetch(A.URL).then((r=>r.arrayBuffer())).then((b=>this.loadLibraryAssetFromArrayBuffer(r,A,[b])))}_loadLibraryExternalVideoAsset(r,A){let b=A.URL;if(!(b in this._blobHashMap))return fetch(b,{method:"HEAD"}).then((C=>{if(!C.ok)throw new Error("URL could not be fetched");this._blobHashMap[b]=r,this.library[r]={Name:A.Name,Type:A.Type,Hash:b,IsExternal:!0,URL:b}}))}loadLibraryAssetFromArrayBuffer(r,A,b){let C,I=A.Filepath||A.URL;A.Type in Ft?C={type:"application/javascript"}:I.endsWith(".mp4")?C={type:"video/mp4"}:I.endsWith(".webm")&&(C={type:"video/webm"});let x=new Blob(b,C);return this.loadLibraryAsset(r,A,x)}loadLibraryAsset(r,A,b){return blobToHash(b).then((C=>{if(!(C in this._blobHashMap)){this._blobHashMap[C]=r,this.library[r]={Name:A.Name,Type:A.Type,Hash:C},A.IsExternal?(this.library[r].URL=A.URL,this.library[r].IsExternal=!0):this.library[r].Blob=b;for(let b of No)A[b]&&(this.library[r][b]=A[b]);return A.SketchfabID&&(this._sketchfabIdMap[A.SketchfabID]=r),this._loadAsset(r,b,!0)}}))}loadAsset(r,A,b){this._loadAssetFromURL(!1,r,A,b)}loadExternalAsset(r,A,b){this._loadAssetFromURL(!0,r,A,b)}loadBuiltIn(r){r.assetId in this.library||(this.library[r.assetId]={Name:r.assetName,Type:r.assetType,IsBuiltIn:!0})}loadPrivate(r){r.assetId in this.library||(this.library[r.assetId]={Name:r.assetName,Type:r.assetType,IsPrivate:!0})}_loadAssetFromURL(r,A,b,C){let I,x=A.split("/").pop(),S=uuidv4(),B=x.split(".").pop().toLowerCase();if(B in Lt)I=kt.AUDIO;else if(B in Ot)I=kt.IMAGE;else if(B in Ut)I=kt.MODEL;else if(B in Nt&&(I=kt.VIDEO,r))return void this._loadExternalVideo(S,A,x,b,C);fetch(A).then((r=>{if(!r.ok)throw new Error("URL could not be fetched");return r.blob()})).then((D=>{"js"!=B?blobToHash(D).then((C=>{C in this._blobHashMap?b&&b(this._blobHashMap[C]):(this._blobHashMap[C]=S,this.library[S]={Name:x,Type:I,Hash:C},r?(this.library[S].URL=A,this.library[S].IsExternal=!0):this.library[S].Blob=D,this._loadAsset(S,D).then((()=>{b&&b(S)})))})):this._addNewScript(r&&A,D,b,C)})).catch((r=>{C&&C(r)}))}_loadExternalVideo(r,A,b,C,I){A in this._blobHashMap?C&&C(this._blobHashMap[A]):fetch(A,{method:"HEAD"}).then((I=>{if(!I.ok)throw new Error("URL could not be fetched");this._blobHashMap[A]=r,this.library[r]={Name:b,Type:kt.VIDEO,Hash:A,IsExternal:!0,URL:A},Qt.publish(this._id,Rt.ASSET_ADDED,r,!0),C&&C(r)})).catch((r=>{I&&I(r)}))}_loadAsset(r,A,b){return this.library[r].Type==kt.MODEL?this._loadGLB(r,A,b):this.library[r].Type==kt.IMAGE?this._loadImage(r,A,b):this.library[r].Type==kt.AUDIO?this._loadAudio(r,A,b):this.library[r].Type==kt.VIDEO?this._loadVideo(r,A,b):this._loadScript(r,A,b)}_loadGLB(r,A,b){return new Promise(((C,I)=>{let x=URL.createObjectURL(A);(new GLTFLoader).load(x,(A=>{this.library[r].Mesh=A.scene,this.library[r].Animations=A.animations,buildBVH(A.scene),b||Qt.publish(this._id,Rt.ASSET_ADDED,r,!0),C()}),null,I)}))}_loadImage(A,b,C){return new Promise(((I,x)=>{let S=URL.createObjectURL(b);(new r.TextureLoader).load(S,(b=>{b.colorSpace=r.SRGBColorSpace,Mt.renderer.initTexture(b);let x=b.image.width,S=b.image.height;x>S?(S*=1/x,x=1):(x*=1/S,S=1);let B=new r.PlaneGeometry(x,S),D=new r.MeshBasicMaterial({map:b,side:r.DoubleSide,transparent:!0}),R=new r.Mesh(B,D);this.library[A].Mesh=R,C||Qt.publish(this._id,Rt.ASSET_ADDED,A,!0),I()}),null,x)}))}_loadAudio(A,b,C){return new Promise(((I,x)=>{let S=URL.createObjectURL(b);(new r.AudioLoader).load(S,(r=>{this.library[A].Buffer=r,C||Qt.publish(this._id,Rt.ASSET_ADDED,A,!0),I()}),null,x)}))}_loadVideo(r,A,b){return new Promise(((C,I)=>{try{let I=URL.createObjectURL(A);this.library[r].URL=I,b||Qt.publish(this._id,Rt.ASSET_ADDED,r,!0),C()}catch{I()}}))}_loadScript(r,A,b){return new Promise(((C,I)=>{let x=URL.createObjectURL(A);import(x).then((()=>{b||Qt.publish(this._id,Rt.ASSET_ADDED,r,!0),C()})).catch(I)}))}cloneMesh(r){let A=this.library[r];return A.Type==kt.IMAGE?A.Mesh.clone():A.Type==kt.MODEL?clone(A.Mesh):void 0}getAnimations(r){let A=this.library[r];return A?.Animations}getBuffer(r){if(!r)return;let A=this.library[r];return A.Type==kt.AUDIO?A.Buffer:void 0}getTexture(r){return this.library[r].Mesh.material.map}cloneTexture(r){return this.library[r].Mesh.material.map.clone()}filterAssets(r){for(let A in this.library){let b=this.library[A];r.has(A)||b.IsBuiltIn||(delete this.library[A],delete this._blobHashMap[b.Hash],delete this._sketchfabIdMap[b.SketchfabID])}}getAssetName(r){return r in this.library?this.library[r].Name:null}getAssetIdFromSketchfabId(r){return this._sketchfabIdMap[r]}getImage(r){return this.library[r].Mesh.material.map.image}getLibrary(){return this.library}getType(r){return r in this.library?this.library[r].Type:null}getUrl(r){return r in this.library?this.library[r].URL:null}registerSketchfabAsset(r,A){let b=this.library[r];b?A.uid&&(b.SketchfabID=A.uid,this._sketchfabIdMap[A.uid]=r):console.error("Asset ID not found for Sketchfab asset")}reset(){let r={};for(let A in this.library)this.library[A].IsBuiltIn&&(r[A]=this.library[A]);this.library=r,this._blobHashMap={},this._sketchfabIdMap={}}getLibraryDetails(r){let A={};for(let b of r){let r=this.library[b];if(r.IsBuiltIn||r.IsPrivate)continue;let C=r.Type;A[b]={Name:r.Name,Type:C};for(let C of No)r[C]&&(A[b][C]=r[C]);if(r.IsExternal){A[b].URL=r.URL,A[b].IsExternal=!0;continue}let I="assets/"+b+"/"+r.Name;A[b].Filepath=I}return A}};let Ho=new class Scene{constructor(){this._id="dc23454b-9d3c-4c94-b1d2-0448ec28415f",this._object=new r.Scene,new GripInteractable(this._object),new PointerInteractable(this._object),new TouchInteractable(this._object),this.children=new Set,Mt.scene=this._object}get gripInteractable(){return this._object.gripInteractable}get id(){return this._id}get name(){return"Scene"}get object(){return this._object}get pointerInteractable(){return this._object.pointerInteractable}get touchInteractable(){return this._object.touchInteractable}set gripInteractable(r){}set pointerInteractable(r){}set touchInteractable(r){}getWorldPosition(r){return r||(r=ao[0]),this._object.getWorldPosition(r),r}getWorldQuaternion(r){return r||(r=ho),this._object.getWorldQuaternion(r),r}getWorldScale(r){return r||(r=ao[0]),this._object.getWorldScale(r),r}add(r,A){r.addTo(this,A)}attach(r,A){r.attachTo(this,A)}};const Go={RIGHT:0,LEFT:1,TOP:2,BOTTOM:3,FRONT:4,BACK:5},jo=1024,Vo=[];for(let r in Go){let r=document.createElement("canvas");r.width=jo,r.height=jo,Vo.push({canvas:r,context:r.getContext("2d")})}let zo=new class Skybox{constructor(){this._id=uuidv4(),this._isAR=!1,Qt.subscribe(this._id,Rt.SESSION_STARTED,(()=>{this._isAR="AR"==Mt.xrSessionType,this._isAR&&(this._scene.background=null)})),Qt.subscribe(this._id,Rt.SESSION_ENDED,(()=>{this._isAR=!1,this._scene.background=this._background}))}init(r){this._scene=r,this._background=new yt([Vo[Go.RIGHT].canvas,Vo[Go.LEFT].canvas,Vo[Go.TOP].canvas,Vo[Go.BOTTOM].canvas,Vo[Go.FRONT].canvas,Vo[Go.BACK].canvas]),this._background.colorSpace=oe,this._isAR||(this._scene.background=this._background)}setSides(r){for(let A in r)this.setSide(A,r[A])}setSide(r,A){let b=A?Qo.getImage(A):null;this._drawImage(r,b),this._background.needsUpdate=!0}deleteSide(r){this._drawImage(r),this._background.needsUpdate=!0}_drawImage(r,A){let b=Vo[r].canvas,C=Vo[r].context;if(C.clearRect(0,0,b.width,b.height),!A)return;let I=jo/Math.max(A.width,A.height),x=(b.width-A.width*I)/2,S=(b.height-A.height*I)/2;C.drawImage(A,0,0,A.width,A.height,x,S,A.width*I,A.height*I)}};let Wo=new class SettingsHandler{constructor(){this.settings={Acknowledgements:[],Skybox:[...new Array(6)],"User Settings":{"Movement Speed":3,"User Scale":1,"Enable Flying":!0,"Swap Joysticks":!1}},this.editorSettings={"Movement Speed":3,"User Scale":1,"Enable Flying":!0,"Swap Joysticks":!1},this.settings.Skybox[Go.FRONT]=null,this.settings.Skybox[Go.BACK]=null,this.settings.Skybox[Go.LEFT]=null,this.settings.Skybox[Go.RIGHT]=null,this.settings.Skybox[Go.TOP]=null,this.settings.Skybox[Go.BOTTOM]=null,this._scene=Ho.object,zo.init(this._scene)}load(r){if(r)this.settings=r,this.settings.Acknowledgements||(this.settings.Acknowledgements=[]),this.settings["User Settings"]?(this.settings["User Settings"]["Movement Speed"]||(this.settings["User Settings"]["Movement Speed"]=3),this.settings["User Settings"]["User Scale"]||(this.settings["User Settings"]["User Scale"]=1),this.settings["User Settings"]["Enable Flying"]||(this.settings["User Settings"]["Enable Flying"]=!0),this.settings["User Settings"]["Swap Joysticks"]||(this.settings["User Settings"]["Swap Joysticks"]=!1)):this.settings["User Settings"]={"Movement Speed":3,"User Scale":1,"Enable Flying":!0,"Swap Joysticks":!1},this._updateFlyingButtons();else{for(let r in this.settings.Skybox)this.settings.Skybox[r]=null;this.settings["User Settings"]["Movement Speed"]=3,this.settings["User Settings"]["User Scale"]=1,this.settings["User Settings"]["Enable Flying"]=!0,this.settings["User Settings"]["Swap Joysticks"]=!1,this.settings.Acknowledgements=[]}zo.setSides(this.settings.Skybox)}reset(){this.load()}getAcknowledgements(){return this.settings.Acknowledgements}addAcknowledgement(r){this.settings.Acknowledgements.push(r)}getSkyboxTextures(){let r={},A=this.settings.Skybox;for(let b in A)A[b]?r[b]=Qo.getTexture(A[b]):r[b]=Ya.searchIcon;return r}setSkyboxSide(r,A,b){this.settings.Skybox[r]=A,zo.setSide(r,A),b||Qt.publish(this._id,Rt.SETTINGS_UPDATED,{settings:this.settings,keys:["Skybox",r]})}getEditorSettings(){return this.editorSettings}setEditorSetting(r,A){r in this.editorSettings&&(this.editorSettings[r]=A),this._updateFlyingButtons()}getUserSettings(){return this.settings["User Settings"]}setUserSetting(r,A,b){r in this.settings["User Settings"]&&(this.settings["User Settings"][r]=A,this._updateFlyingButtons(),b||Qt.publish(this._id,Rt.SETTINGS_UPDATED,{settings:this.settings,keys:["User Settings",r]}))}getMovementSpeed(){return Mt.isEditor?this.editorSettings["Movement Speed"]:this.settings["User Settings"]["Movement Speed"]}getUserScale(){return Mt.isEditor?this.editorSettings["User Scale"]:this.settings["User Settings"]["User Scale"]}isFlyingEnabled(){return Mt.isEditor?this.editorSettings["Enable Flying"]:this.settings["User Settings"]["Enable Flying"]}areJoysticksSwapped(){return Mt.isEditor?this.editorSettings["Swap Joysticks"]:this.settings["User Settings"]["Swap Joysticks"]}getSettings(){return this.settings}_updateFlyingButtons(){"TOUCH_SCREEN"!=Mt.deviceType||Mt.immersionDisabled||(this.isFlyingEnabled()?($n.showExtraControlsButton("mobile-flying-up-button"),$n.showExtraControlsButton("mobile-flying-down-button")):($n.hideExtraControlsButton("mobile-flying-up-button"),$n.hideExtraControlsButton("mobile-flying-down-button")))}};let Xo=new class XRPlanes extends ce{constructor(){super(),this.renderOrder=-Infinity,this._planes=new Map,this._material=new H({color:16777215,colorWrite:!1,side:G})}updatePlanes(r){let A=r.data,b=A.detectedPlanes,C=Mt.renderer.xr.getReferenceSpace();for(let[r,A]of this._planes)b.has(r)||this._deletePlane(r,A.mesh);for(let r of b){let b=this._planes.get(r);b?r.lastChangedTime!=b.lastChangedTime&&(this._deletePlane(r,b.mesh),this._addPlane(r,A,C)):this._addPlane(r,A,C)}}_addPlane(r,A,b){let C=A.getPose(r.planeSpace,b);co.fromArray(C.transform.matrix);let I=Number.MAX_SAFE_INTEGER,x=Number.MIN_SAFE_INTEGER,S=Number.MAX_SAFE_INTEGER,B=Number.MIN_SAFE_INTEGER;for(let A of r.polygon)I=Math.min(I,A.x),x=Math.max(x,A.x),S=Math.min(S,A.z),B=Math.max(B,A.z);let R=new vt(x-I,.01,B-S),F=new D(R,this._material);F.renderOrder=-Infinity,F.position.setFromMatrixPosition(co),F.quaternion.setFromRotationMatrix(co),this.add(F);let N={lastChangedTime:r.lastChangedTime,mesh:F};this._planes.set(r,N)}_deletePlane(r,A){A.geometry.dispose(),A.material.dispose(),this.remove(A),this._planes.delete(r)}},Yo=new class AudioHandler{init(){this._audioListener||(this._audioListener=new r.AudioListener,Mt.camera.add(this._audioListener))}getListener(){return this._audioListener}setListenerParent(r){r.add(this._audioListener)}resume(){this._audioListener.context.resume()}suspend(){this._audioListener.context.suspend()}};const Ko={type:"change"},qo={type:"start"},Zo={type:"end"};class OrbitControls extends Ct{constructor(r,C){super(),void 0===C&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),C===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=r,this.domElement=C,this.domElement.style.touchAction="none",this.enabled=!0,this.target=new A,this.minDistance=0,this.maxDistance=Infinity,this.minZoom=0,this.maxZoom=Infinity,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-Infinity,this.maxAzimuthAngle=Infinity,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:wt.ROTATE,MIDDLE:wt.DOLLY,RIGHT:wt.PAN},this.touches={ONE:Et.ROTATE,TWO:Et.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.rotateStartTime=0,this.rotateDelay=0,this._domElementKeyEvents=null,this.getPolarAngle=function(){return D.phi},this.getAzimuthalAngle=function(){return D.theta},this.getDistance=function(){return this.object.position.distanceTo(this.target)},this.listenToKeyEvents=function(r){r.addEventListener("keydown",onKeyDown),this._domElementKeyEvents=r},this.saveState=function(){I.target0.copy(I.target),I.position0.copy(I.object.position),I.zoom0=I.object.zoom},this.reset=function(){I.target.copy(I.target0),I.object.position.copy(I.position0),I.object.zoom=I.zoom0,I.object.updateProjectionMatrix(),I.dispatchEvent(Ko),I.update(),S=x.NONE},this.update=function(){const b=new A,C=(new N).setFromUnitVectors(r.up,new A(0,1,0)),G=C.clone().invert(),j=new A,V=new N;var W=new A;const X=2*Math.PI;return function update(){const r=I.object.position;b.copy(r).sub(I.target),b.applyQuaternion(C),D.setFromVector3(b),I.autoRotate&&S===x.NONE&&rotateLeft(function getAutoRotationAngle(){return 2*Math.PI/60/60*I.autoRotateSpeed}()),I.enableDamping?(D.theta+=R.theta*I.dampingFactor,D.phi+=R.phi*I.dampingFactor):(D.theta+=R.theta,D.phi+=R.phi);let A=I.minAzimuthAngle,N=I.maxAzimuthAngle;return isFinite(A)&&isFinite(N)&&(A<-Math.PI?A+=X:A>Math.PI&&(A-=X),N<-Math.PI?N+=X:N>Math.PI&&(N-=X),D.theta=A<=N?Math.max(A,Math.min(N,D.theta)):D.theta>(A+N)/2?Math.max(A,D.theta):Math.min(N,D.theta)),D.phi=Math.max(I.minPolarAngle,Math.min(I.maxPolarAngle,D.phi)),D.makeSafe(),D.radius*=F,D.radius=Math.max(I.minDistance,Math.min(I.maxDistance,D.radius)),!0===I.enableDamping?I.target.addScaledVector(Q,I.dampingFactor):I.target.add(Q),b.setFromSpherical(D),b.applyQuaternion(G),r.copy(I.target).add(b),W.copy(I.target),I.object.parent&&I.object.parent.localToWorld(W),I.object.lookAt(W),!0===I.enableDamping?(R.theta*=1-I.dampingFactor,R.phi*=1-I.dampingFactor,Q.multiplyScalar(1-I.dampingFactor)):(R.set(0,0,0),Q.set(0,0,0)),F=1,!!(H||j.distanceToSquared(I.object.position)>B||8*(1-V.dot(I.object.quaternion))>B)&&(I.dispatchEvent(Ko),j.copy(I.object.position),V.copy(I.object.quaternion),H=!1,!0)}}(),this.dispose=function(){I.domElement.removeEventListener("contextmenu",onContextMenu),I.domElement.removeEventListener("pointerdown",onPointerDown),I.domElement.removeEventListener("pointercancel",onPointerCancel),I.domElement.removeEventListener("wheel",onMouseWheel),I.domElement.removeEventListener("pointermove",onPointerMove),I.domElement.removeEventListener("pointerup",onPointerUp),null!==I._domElementKeyEvents&&I._domElementKeyEvents.removeEventListener("keydown",onKeyDown)};const I=this,x={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6};let S=x.NONE;const B=1e-6,D=new It,R=new It;let F=1;const Q=new A;let H=!1;const G=new b,j=new b,V=new b,W=new b,X=new b,Y=new b,K=new b,q=new b,Z=new b,J=[],$={};function getZoomScale(){return Math.pow(.95,I.zoomSpeed)}function rotateLeft(r){R.theta-=r}function rotateUp(r){R.phi-=r}const ee=function(){const r=new A;return function panLeft(A,b){r.setFromMatrixColumn(b,0),r.multiplyScalar(-A),Q.add(r)}}(),te=function(){const r=new A;return function panUp(A,b){!0===I.screenSpacePanning?r.setFromMatrixColumn(b,1):(r.setFromMatrixColumn(b,0),r.crossVectors(I.object.up,r)),r.multiplyScalar(A),Q.add(r)}}(),se=function(){const r=new A;return function pan(A,b){const C=I.domElement;if(I.object.isPerspectiveCamera){const x=I.object.position;r.copy(x).sub(I.target);let S=r.length();S*=Math.tan(I.object.fov/2*Math.PI/180),ee(2*A*S/C.clientHeight,I.object.matrix),te(2*b*S/C.clientHeight,I.object.matrix)}else I.object.isOrthographicCamera?(ee(A*(I.object.right-I.object.left)/I.object.zoom/C.clientWidth,I.object.matrix),te(b*(I.object.top-I.object.bottom)/I.object.zoom/C.clientHeight,I.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),I.enablePan=!1)}}();function dollyOut(r){I.object.isPerspectiveCamera?F/=r:I.object.isOrthographicCamera?(I.object.zoom=Math.max(I.minZoom,Math.min(I.maxZoom,I.object.zoom*r)),I.object.updateProjectionMatrix(),H=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),I.enableZoom=!1)}function dollyIn(r){I.object.isPerspectiveCamera?F*=r:I.object.isOrthographicCamera?(I.object.zoom=Math.max(I.minZoom,Math.min(I.maxZoom,I.object.zoom/r)),I.object.updateProjectionMatrix(),H=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),I.enableZoom=!1)}function handleMouseDownRotate(r){G.set(r.clientX,r.clientY),I.rotateStartTime=Date.now()}function handleMouseDownPan(r){W.set(r.clientX,r.clientY)}function handleTouchStartRotate(){if(1===J.length)G.set(J[0].pageX,J[0].pageY);else{const r=.5*(J[0].pageX+J[1].pageX),A=.5*(J[0].pageY+J[1].pageY);G.set(r,A)}}function handleTouchStartPan(){if(1===J.length)W.set(J[0].pageX,J[0].pageY);else{const r=.5*(J[0].pageX+J[1].pageX),A=.5*(J[0].pageY+J[1].pageY);W.set(r,A)}}function handleTouchStartDolly(){const r=J[0].pageX-J[1].pageX,A=J[0].pageY-J[1].pageY,b=Math.sqrt(r*r+A*A);K.set(0,b)}function handleTouchMoveRotate(r){if(1==J.length)j.set(r.pageX,r.pageY);else{const A=getSecondPointerPosition(r),b=.5*(r.pageX+A.x),C=.5*(r.pageY+A.y);j.set(b,C)}V.subVectors(j,G).multiplyScalar(I.rotateSpeed);const A=I.domElement;rotateLeft(2*Math.PI*V.x/A.clientHeight),rotateUp(2*Math.PI*V.y/A.clientHeight),G.copy(j)}function handleTouchMovePan(r){if(1===J.length)X.set(r.pageX,r.pageY);else{const A=getSecondPointerPosition(r),b=.5*(r.pageX+A.x),C=.5*(r.pageY+A.y);X.set(b,C)}Y.subVectors(X,W).multiplyScalar(I.panSpeed),se(Y.x,Y.y),W.copy(X)}function handleTouchMoveDolly(r){const A=getSecondPointerPosition(r),b=r.pageX-A.x,C=r.pageY-A.y,x=Math.sqrt(b*b+C*C);q.set(0,x),Z.set(0,Math.pow(q.y/K.y,I.zoomSpeed)),dollyOut(Z.y),K.copy(q)}function onPointerDown(r){!1!==I.enabled&&(0===J.length&&(I.domElement.setPointerCapture(r.pointerId),I.domElement.addEventListener("pointermove",onPointerMove),I.domElement.addEventListener("pointerup",onPointerUp)),function addPointer(r){J.push(r)}(r),"touch"===r.pointerType?function onTouchStart(r){switch(trackPointer(r),J.length){case 1:switch(I.touches.ONE){case Et.ROTATE:if(!1===I.enableRotate)return;handleTouchStartRotate(),S=x.TOUCH_ROTATE;break;case Et.PAN:if(!1===I.enablePan)return;handleTouchStartPan(),S=x.TOUCH_PAN;break;default:S=x.NONE}break;case 2:switch(I.touches.TWO){case Et.DOLLY_PAN:if(!1===I.enableZoom&&!1===I.enablePan)return;!function handleTouchStartDollyPan(){I.enableZoom&&handleTouchStartDolly(),I.enablePan&&handleTouchStartPan()}(),S=x.TOUCH_DOLLY_PAN;break;case Et.DOLLY_ROTATE:if(!1===I.enableZoom&&!1===I.enableRotate)return;!function handleTouchStartDollyRotate(){I.enableZoom&&handleTouchStartDolly(),I.enableRotate&&handleTouchStartRotate()}(),S=x.TOUCH_DOLLY_ROTATE;break;default:S=x.NONE}break;default:S=x.NONE}S!==x.NONE&&I.dispatchEvent(qo)}(r):function onMouseDown(r){let A;switch(r.button){case 0:A=I.mouseButtons.LEFT;break;case 1:A=I.mouseButtons.MIDDLE;break;case 2:A=I.mouseButtons.RIGHT;break;default:A=-1}switch(A){case wt.DOLLY:if(!1===I.enableZoom)return;!function handleMouseDownDolly(r){K.set(r.clientX,r.clientY)}(r),S=x.DOLLY;break;case wt.ROTATE:if(r.ctrlKey||r.metaKey||r.shiftKey){if(!1===I.enablePan)return;handleMouseDownPan(r),S=x.PAN}else{if(!1===I.enableRotate)return;handleMouseDownRotate(r),S=x.ROTATE}break;case wt.PAN:if(r.ctrlKey||r.metaKey||r.shiftKey){if(!1===I.enableRotate)return;handleMouseDownRotate(r),S=x.ROTATE}else{if(!1===I.enablePan)return;handleMouseDownPan(r),S=x.PAN}break;default:S=x.NONE}S!==x.NONE&&I.dispatchEvent(qo)}(r))}function onPointerMove(r){!1!==I.enabled&&("touch"===r.pointerType?function onTouchMove(r){switch(trackPointer(r),S){case x.TOUCH_ROTATE:if(!1===I.enableRotate)return;handleTouchMoveRotate(r),I.update();break;case x.TOUCH_PAN:if(!1===I.enablePan)return;handleTouchMovePan(r),I.update();break;case x.TOUCH_DOLLY_PAN:if(!1===I.enableZoom&&!1===I.enablePan)return;!function handleTouchMoveDollyPan(r){I.enableZoom&&handleTouchMoveDolly(r),I.enablePan&&handleTouchMovePan(r)}(r),I.update();break;case x.TOUCH_DOLLY_ROTATE:if(!1===I.enableZoom&&!1===I.enableRotate)return;!function handleTouchMoveDollyRotate(r){I.enableZoom&&handleTouchMoveDolly(r),I.enableRotate&&handleTouchMoveRotate(r)}(r),I.update();break;default:S=x.NONE}}(r):function onMouseMove(r){if(!1===I.enabled)return;switch(S){case x.ROTATE:if(!1===I.enableRotate)return;!function handleMouseMoveRotate(r){if(I.rotateDelay&&Date.now()-I.rotateStartTime<I.rotateDelay)return;j.set(r.clientX,r.clientY),V.subVectors(j,G).multiplyScalar(I.rotateSpeed);const A=I.domElement;rotateLeft(2*Math.PI*V.x/A.clientHeight),rotateUp(2*Math.PI*V.y/A.clientHeight),G.copy(j),I.update()}(r);break;case x.DOLLY:if(!1===I.enableZoom)return;!function handleMouseMoveDolly(r){q.set(r.clientX,r.clientY),Z.subVectors(q,K),Z.y>0?dollyOut(getZoomScale()):Z.y<0&&dollyIn(getZoomScale()),K.copy(q),I.update()}(r);break;case x.PAN:if(!1===I.enablePan)return;!function handleMouseMovePan(r){X.set(r.clientX,r.clientY),Y.subVectors(X,W).multiplyScalar(I.panSpeed),se(Y.x,Y.y),W.copy(X),I.update()}(r)}}(r))}function onPointerUp(r){removePointer(r),0===J.length&&(I.domElement.releasePointerCapture(r.pointerId),I.domElement.removeEventListener("pointermove",onPointerMove),I.domElement.removeEventListener("pointerup",onPointerUp)),I.dispatchEvent(Zo),S=x.NONE}function onPointerCancel(r){removePointer(r)}function onMouseWheel(r){!1!==I.enabled&&!1!==I.enableZoom&&S===x.NONE&&(r.preventDefault(),I.dispatchEvent(qo),function handleMouseWheel(r){r.deltaY<0?dollyIn(getZoomScale()):r.deltaY>0&&dollyOut(getZoomScale()),I.update()}(r),I.dispatchEvent(Zo))}function onKeyDown(r){!1!==I.enabled&&!1!==I.enablePan&&function handleKeyDown(r){let A=!1;switch(r.code){case I.keys.UP:se(0,I.keyPanSpeed),A=!0;break;case I.keys.BOTTOM:se(0,-I.keyPanSpeed),A=!0;break;case I.keys.LEFT:se(I.keyPanSpeed,0),A=!0;break;case I.keys.RIGHT:se(-I.keyPanSpeed,0),A=!0}A&&(r.preventDefault(),I.update())}(r)}function onContextMenu(r){!1!==I.enabled&&r.preventDefault()}function removePointer(r){delete $[r.pointerId];for(let A=0;A<J.length;A++)if(J[A].pointerId==r.pointerId)return void J.splice(A,1)}function trackPointer(r){let A=$[r.pointerId];void 0===A&&(A=new b,$[r.pointerId]=A),A.set(r.pageX,r.pageY)}function getSecondPointerPosition(r){const A=r.pointerId===J[0].pointerId?J[1]:J[0];return $[A.pointerId]}I.domElement.addEventListener("contextmenu",onContextMenu),I.domElement.addEventListener("pointerdown",onPointerDown),I.domElement.addEventListener("pointercancel",onPointerCancel),I.domElement.addEventListener("wheel",onMouseWheel,{passive:!1}),this.update()}}const Jo="DigitalBacon:MobileOverride",$o={AR:{optionalFeatures:["local-floor","bounded-floor","hand-tracking","layers","anchors","plane-detection"]},VR:{optionalFeatures:["local-floor","bounded-floor","hand-tracking","layers"]}};let el=new class SessionHandler{init(r,b){this._container=r,this._orbitControlsTarget=new A(0,0,0),this._onStart=b,$n.hideExtraControls(),Mt.sessionActive=!1,"XR"==Mt.deviceType?this._configureForXR():"POINTER"==Mt.deviceType?this._configureForPointer():"TOUCH_SCREEN"==Mt.deviceType&&this._configureForMobile(),this._addBakedWithLabel()}_addBakedWithLabel(){this._bakedWithLabel=document.createElement("div"),this._bakedWithLabel.style.bottom="0",this._bakedWithLabel.style.position="absolute",this._bakedWithLabel.style.width="100%";let r=document.createElement("p");r.innerHTML='Baked with <a style="color: white;" href="https://digitalbacon.io">Digital Bacon</a> &#10084;',r.style.color="rgb(255, 199, 229)",r.style.display="inline-block",r.style.fontSize="16px",this._bakedWithLabel.appendChild(r)}_configureForXR(){this._div=document.createElement("div"),Mt.vrSessionSupported&&this._createXRButton("VR"),Mt.arSessionSupported&&this._createXRButton("AR"),this._div.appendChild(this._createMobileOverrideLink()),Mt.renderer.xr.addEventListener("planesdetected",(r=>{Xo.updatePlanes(r)})),Mt.renderer.xr.addEventListener("sessionstart",(()=>{Mt.sessionActive=!0,Yo.resume(),Mt.renderer.xr.setFoveation(0),"AR"==Mt.xrSessionType&&Mt.scene.add(Xo),Qt.publish(null,Rt.SESSION_STARTED),this._onStart&&(this._onStart(),this._onStart=null)})),Mt.renderer.xr.addEventListener("sessionend",(()=>{Mt.scene.remove(Xo),Qt.publish(null,Rt.SESSION_ENDED),Mt.sessionActive=!1,Yo.suspend()}))}_createXRButton(r){let A="VR"==r,b=document.createElement("button");b.innerText=A?"ENTER VR":"START AR",this._stylizeElements(b),b.style.minWidth="150px",this._div.appendChild(b);let onSessionEnded=()=>{this._currentSession.removeEventListener("end",onSessionEnded),b.innerText=A?"ENTER VR":"START AR",this._currentSession=null},onSessionStarted=async r=>{r.addEventListener("end",onSessionEnded),await Mt.renderer.xr.setSession(r),b.innerText=A?"EXIT VR":"STOP AR",this._currentSession=r};b.addEventListener("click",(()=>{if(this._currentSession)this._currentSession.end();else{Mt.xrSessionType=r;let b=A?"immersive-vr":"immersive-ar";A||(this._update=this._createAnchor,Mt.dynamicAssets.add(this)),navigator.xr.requestSession(b,$o[r]).then(onSessionStarted)}}))}_configureForPointer(){this._div=document.createElement("div"),this._button=document.createElement("button"),this._button.innerText="CLICK TO START",this._stylizeElements(this._button),this._div.appendChild(this._button),this._controls=new OrbitControls(Mt.camera,Mt.renderer.domElement),this._controls.target=this._orbitControlsTarget,this._controls.enableKeys=!1,this._controls.maxPolarAngle=Math.PI-.3,this._controls.minPolarAngle=.3,this._controls.minDistance=.05,this._controls.enablePan=!1,this._controls.enabled=!1,this._controls.rotateDelay=20,this._controlsUpdateNumber=0,this._controls.addEventListener("change",(()=>{this._controlsUpdateNumber++})),this._button.addEventListener("click",(()=>{this._div.style.display="none",this._bakedWithLabel.style.display="none",this._controls.enabled=!0,Mt.sessionActive=!0,Yo.resume(),$n.showExtraControls(),Qt.publish(null,Rt.SESSION_STARTED),this._onStart&&(this._onStart(),this._onStart=null)}))}_configureForMobile(){this._div=document.createElement("div"),this._button=document.createElement("button"),this._button.innerText="TAP TO START",this._stylizeElements(this._button),this._div.appendChild(this._button),localStorage.getItem(Jo)&&this._div.appendChild(this._createXROverrideLink()),this._controls=new OrbitControls(Mt.camera,Mt.renderer.domElement),this._controls.target=this._orbitControlsTarget,this._controls.maxPolarAngle=Math.PI-.3,this._controls.minPolarAngle=.3,this._controls.minDistance=.05,this._controls.enablePan=!1,this._controls.enabled=!1,this._controls.rotateDelay=20,this._controlsUpdateNumber=0,this._controls.addEventListener("change",(()=>{this._controlsUpdateNumber++})),this._button.addEventListener("click",(()=>{this._div.style.display="none",this._bakedWithLabel.style.display="none",this._controls.enabled=!0,Mt.sessionActive=!0,Yo.resume(),$n.showExtraControls(),$n.showJoystick(),Qt.publish(null,Rt.SESSION_STARTED),this._onStart&&(this._onStart(),this._onStart=null)}))}_stylizeElements(r){this._div.style.position="absolute",this._div.style.top="75%",this._div.style.transform="translateY(-50%)",this._div.style.width="100%",this._div.style.textAlign="center",this._div.style.backgroundColor="rgba(0,0,0,0.5)",this._div.style.padding="10px 0",r.style.padding="12px",r.style.border="2px solid #ffc7e5",r.style.borderRadius="4px",r.style.background="none",r.style.color="#ffc7e5",r.style.font="normal 18px sans-serif",r.style.margin="0 4px",r.style.outline="none",r.style.transition="background-color .15s ease-in-out",r.onmouseenter=()=>{r.style.cursor="pointer",r.style.background="rgba(0, 0, 0, 0.5)"},r.onmouseleave=()=>{r.style.cursor="inherit",r.style.background="none"}}_createMobileOverrideLink(){let r=document.createElement("a");return r.innerText="Use Touchscreen Controls",r.href="#",r.style.display="block",r.style.paddingTop="12px",r.style.color="rgb(255, 199, 229)",r.addEventListener("click",(r=>{r.preventDefault(),localStorage.setItem(Jo,!0),window.location.reload()})),r}_createXROverrideLink(){let r=document.createElement("a");return r.innerText="Use AR/VR Controls",r.href="#",r.style.display="block",r.style.paddingTop="12px",r.style.color="rgb(255, 199, 229)",r.addEventListener("click",(r=>{r.preventDefault(),localStorage.removeItem(Jo),window.location.reload()})),r}displayButton(){this._container.appendChild(this._div),this._container.appendChild(this._bakedWithLabel)}exitXRSession(){this._currentSession.end()}enableOrbit(){this._controls&&(this._controls.enableRotate=!0)}disableOrbit(){this._controls&&(this._controls.enableRotate=!1)}getControlsUpdateNumber(){return this._controlsUpdateNumber}getCameraDistance(){if(this._controls)return this._controls.getDistance()}update(){this._update()}_createAnchor(){if(!Mt.frame||!Mt.frame.createAnchor)return;console.log("Setting up anchor");let r=new XRRigidTransform({x:0,y:0,z:0},{x:0,y:0,z:0,w:1}),A=Mt.renderer.xr.getReferenceSpace();Mt.frame.createAnchor(r,A).then((r=>this._anchor=r)),A.onreset=()=>{"AR"==Mt.xrSessionType&&Mt.dynamicAssets.add(this)},Mt.dynamicAssets.delete(this),this._update=this._updateReferenceSpace}_updateReferenceSpace(){if(!this._anchor||!Mt.frame)return;let r=Mt.renderer.xr.getReferenceSpace(),A=Mt.frame.getPose(this._anchor.anchorSpace,r);if(!A)return;let b=r.getOffsetReferenceSpace(A.transform);Mt.renderer.xr.setReferenceSpace(b),Mt.dynamicAssets.delete(this)}};class OrbitDisablingPointerInteractable extends PointerInteractable{constructor(r){super(r)}addSelectedBy(r){super.addSelectedBy(r),this._disabled||el.disableOrbit()}removeSelectedBy(r){super.removeSelectedBy(r),el.enableOrbit()}}const tl=new Style({pointerInteractableClassOverride:OrbitDisablingPointerInteractable}),addHoveredButtonCallback=r=>{r.pointerInteractable.addHoveredCallback((A=>{A?r.addStyle(ro.hoveredButton):r.removeStyle(ro.hoveredButton)}))},createSmallButton=(A,b=1)=>{let C=new Div(ro.smallButton,tl);if(addHoveredButtonCallback(C),A instanceof r.Texture){let r=Math.floor(100*b)+"%";C.add(new ia(A,{height:r,width:r}))}else"string"==typeof A&&C.add(new TextComponent(A,ro.headerText));return C},createWideButton=(r=" ")=>{let A=new Div(ro.wideButton,tl);addHoveredButtonCallback(A);let b=new TextComponent(r,ro.bodyText);return A.add(b),A.textComponent=b,A},createWideImageButton=(r=" ",A)=>{let b=new ia(A,ro.wideImageButton,tl);addHoveredButtonCallback(b);let C=new TextComponent(r,ro.bodyText);return b.add(C),b.textComponent=C,b},createTextInput=r=>{let A=new TextInput(r,tl);return A.pointerInteractable.hoveredCursor="text",A},configureOrbitDisabling=r=>{let A=r.pointerInteractable;r.pointerInteractable=new OrbitDisablingPointerInteractable(r),A.copyEventListenersTo(r.pointerInteractable),r.pointerInteractable._stateCallbacks=A._stateCallbacks,r.pointerInteractable._hoveredCallbacks=A._hoveredCallbacks;for(let b of A.children)r.pointerInteractable.addChild(b);if(A.parent&&(A.parent.addChild(r.pointerInteractable),A.parent.removeChild(A)),r instanceof Select)for(let A of r._optionsDiv._content.children)configureOrbitDisabling(A);return r};let sl=new class UndoRedoHandler{constructor(){this._currentAction={},this._disableOwners=new Set,this._disableOwners.add(this)}init(){this._setupButtons(),this._disableOwners.delete(this)}_setupButtons(){this._undoParent=new Div({height:.04,width:.04}),this._redoParent=new Div({height:.04,width:.04}),this._undoParent.bypassContentPositioning=!0,this._redoParent.bypassContentPositioning=!0,this._undoParent.position.fromArray([.249,.026,0]),this._redoParent.position.fromArray([.249,-.026,0]),this._undoButton=createSmallButton(Ya.undoIcon,.8),this._redoButton=createSmallButton(Ya.redoIcon,.8),this._undoButton.onClickAndTouch=()=>this._undo(),this._redoButton.onClickAndTouch=()=>this._redo()}addButtons(r){r.add(this._undoParent),r.add(this._redoParent)}reset(){this._currentAction={},this._disableUndo(),this._disableRedo()}addAction(r,A){let b={head:this._currentAction,undo:r,redo:A};return this._currentAction.tail=b,this._currentAction=b,0==this._disableOwners.size&&(this._enableUndo(),this._disableRedo()),b}deleteAction(r){r.head&&(r.head.tail=r.tail,r.tail&&(r.tail.head=r.head),this._currentAction==r&&(this._currentAction=r.head),this._currentAction.head||this._disableUndo())}_undo(){this._currentAction.undo&&this._currentAction.undo(),this._currentAction.head&&(this._currentAction=this._currentAction.head,this._enableRedo()),this._currentAction.head||this._disableUndo()}_redo(){this._currentAction.tail&&(this._enableUndo(),this._currentAction=this._currentAction.tail,this._currentAction.redo&&this._currentAction.redo()),this._currentAction.tail||this._disableRedo()}_enableUndo(){this._undoParent.add(this._undoButton)}_disableUndo(){this._undoParent&&this._undoParent.remove(this._undoButton)}_enableRedo(){this._redoParent.add(this._redoButton)}_disableRedo(){this._redoParent&&this._redoParent.remove(this._redoButton)}enable(r){this._disableOwners.delete(r),0==this._disableOwners.size&&(this._currentAction.head&&this._enableUndo(),this._currentAction.tail&&this._enableRedo())}disable(r){this._disableOwners.add(r),this._disableUndo(),this._disableRedo()}};let il=new class ProjectHandler{constructor(){this._id=uuidv4(),this._scene=Ho.object,this._objects=[],this._assets={},this._assetHandlers={},this._sessionAssets={},this._sessionAssets[Ho.id]=Ho}load(r,A,b){JSZipUtils.getBinaryContent(r,((r,C)=>{r?b&&b(r):JSZip.loadAsync(C).then((r=>{this.loadZip(r,(()=>{A&&A()}),(()=>{b&&b()}))}))}))}loadZip(r,A,b){Qt.publish(this._id,Rt.PROJECT_LOADING,!1,!0),this.reset();let C=uuidv4();Mt.loadingLocks.add(C),r.file("projectDetails.json").async("string").then((I=>{let x;try{this._projectDetails=JSON.parse(I),x=JSON.parse(I)}catch(r){return void this._handleLoadingError(b)}Qo.load(x.library,r,(()=>{Mt.loadingLocks.delete(C),Wo.load(this._projectDetails.settings);try{for(let r in this._assetHandlers)this._assetHandlers[r].deleteFromDiff(this._projectDetails[r.toLowerCase()+"s"]);this._loadAssets(x,!0)}catch(r){return console.error(r),void this._handleLoadingError(b)}Qt.publish(this._id,Rt.PROJECT_LOADING,!0),A&&A()}),(()=>{this._handleLoadingError(b)}))}),(()=>{this._handleLoadingError(b)}))}loadDiffZip(r,A,b){r.file("projectDetails.json").async("string").then((C=>{let I;try{I=JSON.parse(C)}catch(r){return console.error(r),void(b&&b())}let x=Object.keys(this._projectDetails.library);x.push(...Object.keys(I.library)),x=new Set(x),Qo.filterAssets(x),Qo.load(I.library,r,(()=>{try{for(let r in this._assetHandlers)this._assetHandlers[r].deleteFromDiff(I[r.toLowerCase()+"s"]);this._loadAssets(I,!0)}catch(r){return console.error(r),void(b&&b())}A&&A()}),(()=>{b&&b()}))}),(()=>{b&&b()}))}_createDependencyGraph(r){let A={};for(let b in this._assetHandlers){let C=this._assetHandlers[b];if(b=b.toLowerCase()+"s",C)for(let I in r[b])for(let x of r[b][I])A[x.id]={params:x,removedParams:{},handler:C,loaded:!1,dependsOn:new Set,dependedOnBy:new Set};else console.error("Unexpected asset type: "+b)}for(let b in this._assetHandlers){b=b.toLowerCase()+"s";for(let C in r[b])for(let I of r[b][C])this._addDependencies(A,I)}return A}_addDependencies(r,A){for(let b in A){if("id"==b)continue;let C=A[b];if(Array.isArray(C))for(let b of C)b in r&&!this._sessionAssets[b]&&(r[A.id].dependsOn.add(b),r[b].dependedOnBy.add(A.id));else"string"==typeof C&&C in r&&!this._sessionAssets[C]&&(r[A.id].dependsOn.add(C),r[C].dependedOnBy.add(A.id))}}_loadAssets(r,A){let b=this._createDependencyGraph(r),C={};for(;Object.keys(b).length>0;){let r,I=!1,x=0;for(let C in b)if(b[C].dependedOnBy.size>x&&(r=C),0==b[C].dependsOn.size){b[C].handler.loadAsset(b[C].params,A);for(let r of b[C].dependedOnBy)b[r].dependsOn.delete(C);delete b[C],I=!0}if(!I){let I=b[r];this._loadAssetWithoutDependencies(I,A);for(let A of I.dependedOnBy)b[A].dependsOn.delete(r);C[r]=I,delete b[r]}}for(let r in C){let A=C[r].removedParams,b=C[r].asset;for(let I in A){let x=A[I];Array.isArray(x)&&(x=C[r].params[I].concat(x)),"parentId"==I&&b.addTo(this._sessionAssets[x],!0),b[I]=x}}}_loadAssetWithoutDependencies(r,A){let b=r.params,C=r.removedParams;for(let A of r.dependsOn)for(let r in b){if("id"==r)continue;let I=b[r];I===A?(C[r]=b[r],delete b[r]):Array.isArray(I)&&I.includes(A)&&(C[r]||(C[r]=[]),C[r].push(A),b[r]=I.filter((r=>r!=A)))}r.asset=r.handler.loadAsset(b,A)}getAssetHandler(r){return this._assetHandlers[r]}registerAsset(r){this._assetHandlers[r.assetType].registerAsset(r)}registerAssetHandler(r,A){this._assetHandlers[A]=r}_handleLoadingError(r){Qt.publish(this._id,Rt.PROJECT_LOADING,!0),r&&r()}getObjects(){return this._objects}getAsset(r){return this._assets[r]}getAssets(){return this._assets}getAssetsForType(r){return this._assetHandlers[r].getAssets()}getAssetClassesForType(r){return this._assetHandlers[r].getAssetClasses()}getSessionAsset(r){return this._sessionAssets[r]}deleteAsset(r,A,b){let C=Qo.getType(r.assetId);this._assetHandlers[C].deleteAsset(r,A,b)}deleteAssetFromHandler(r){let A=r.id;if(this._assets[A]){if("object"in r){let A=r.object;for(let r=0;r<this._objects.length;r++)if(A==this._objects[r]){this._objects.splice(r,1);break}let b=Qo.getType(r.assetId);if(r.parent&&r.parent!=Ho&&b!=kt.INTERNAL){let b=r.parent.assetId;Qo.getType(b)==kt.INTERNAL&&this._scene.attach(A)}}r.onRemoveFromProject&&r.onRemoveFromProject(),delete this._assets[A]}}addNewAsset(r,A,b,C){let I=Qo.getType(r);return this._assetHandlers[I].addNewAsset(r,A,b,C)}addAsset(r,A,b){let C=Qo.getType(r.assetId);this._assetHandlers[C].addAsset(r,A,b)}addAssetFromHandler(r){let A=r.id;r.onAddToProject&&r.onAddToProject(),"object"in r&&(r.parent&&r.parent.object.add(r.object),this._objects.push(r.object)),this._assets[A]||(this._assets[A]=r,this._sessionAssets[A]=r)}reset(){this._sessionAssets={},this._sessionAssets[Ho.id]=Ho,Mt.immersionDisabled||sl.reset();for(let r in this._assetHandlers)this._assetHandlers[r].reset();Qo.reset(),Wo.reset()}exportDiff(){let r=new Set,A=this._getProjectDetails();storeStringValuesInSet(this._projectDetails,r);for(let b in A.library)r.has(b)&&delete A.library[b];return this._exportBlob(A)}exportProject(r){let A=this._getProjectDetails(!r);return this._exportBlob(A)}_exportBlob(r){let A=new JSZip;A.file("projectDetails.json",JSON.stringify(r));let b=Qo.getLibrary();for(let C in r.library){let I=r.library[C].Type,x=b[C].IsExternal;if(I!=kt.INTERNAL&&!x){let I=r.library[C].Filepath;A.file(I,b[C].Blob)}}return A}_getProjectDetails(r){let A=Object.keys(Qo.library),b={settings:Wo.getSettings(),version:Mt.version},C=new Set;r&&Qt.publish(this._id,Rt.SANITIZE_INTERNALS,null,!0);for(let A in this._assetHandlers){if(r&&A==kt.INTERNAL)continue;let C=this._assetHandlers[A].getAssetsDetails();C&&(b[A.toLowerCase()+"s"]=C)}return storeStringValuesInSet(b,C),r&&(A=A.filter((r=>C.has(r)))),b.library=Qo.getLibraryDetails(A),b}};let nl=new class EditorHelperFactory{constructor(){this._editorHelperClassMap={}}registerEditorHelper(r,A){this._editorHelperClassMap[A]=r}addEditorHelperTo(r){if(r.editorHelper)return;let A=r.constructor;for(;!this._editorHelperClassMap[A];)A=Object.getPrototypeOf(A);let b=this._editorHelperClassMap[A];r.editorHelper=new b(r)}};class AssetsHandler{constructor(r,A,b){this._id=uuidv4(),this._assets={},this._assetClassMap={},this._sessionAssets={},this._addedTopic=r,this._deletedTopic=A,il.registerAssetHandler(this,b)}addNewAsset(r,A,b,C){let I=new this._assetClassMap[r](A);return this.addAsset(I,b,C),I}addAsset(r,A,b){if(this._assets[r.id])return;if(this._assets[r.id]=r,this._sessionAssets[r.id]=r,Mt.isEditor&&nl.addEditorHelperTo(r),r.update&&Mt.dynamicAssets.add(r),il.addAssetFromHandler(r),b||sl.addAction((()=>{this.deleteAsset(r,A,!0)}),(()=>{this.addAsset(r,A,!0)})),A)return;let C=this._addedTopic+":"+r.assetId+":"+r.id;Qt.publish(this._id,C,r,!0)}deleteAsset(r,A,b){if(!(r.id in this._assets))return;let C;if(b||(C=sl.addAction((()=>{this.addAsset(r,A,!0)}),(()=>{this.deleteAsset(r,A,!0)}))),delete this._assets[r.id],il.deleteAssetFromHandler(r),r.update&&Mt.dynamicAssets.delete(r),A)return;let I=this._deletedTopic+":"+r.assetId+":"+r.id;Qt.publish(this._id,I,{asset:r,undoRedoAction:C},!0)}deleteFromDiff(r){let A=[];for(let b in this._assets){let C=this._assets[b],I=C.assetId;I in r&&r[I].some((r=>r.id==b))||A.push(C)}for(let r of A)this.deleteAsset(r,!0,!0)}loadAsset(r,A){if(r.assetId in this._assetClassMap)return A&&this._assets[r.id]?(this._assets[r.id].updateFromParams(r),this._assets[r.id]):this.addNewAsset(r.assetId,r,!0,!0);console.error("Unrecognized asset found")}registerAsset(r){this._assetClassMap[r.assetId],this._assetClassMap[r.assetId]=r}getAssets(){return this._assets}getAsset(r){return this._assets[r]}getAssetClass(r){return this._assetClassMap[r]}getAssetClasses(){return Object.values(this._assetClassMap)}getSessionAsset(r){return this._sessionAssets[r]}reset(){for(let r in this._assets)this.deleteAsset(this._assets[r],!0,!0);this._assets={},this._sessionAssets={};let r=Qo.library;for(let A in this._assetClassMap)r[A]&&!r[A].Blob||delete this._assetClassMap[A]}getAssetsDetails(){let r={};for(let A in this._assets){let b=this._assets[A],C=b.assetId,I=b.exportParams();C in r||(r[C]=[]),r[C].push(I)}return r}}let rl=new class ComponentsHandler extends AssetsHandler{constructor(){super(Rt.COMPONENT_ADDED,Rt.COMPONENT_DELETED,kt.COMPONENT)}};new class CustomAssetsHandler extends AssetsHandler{constructor(){super(Rt.CUSTOM_ASSET_ADDED,Rt.CUSTOM_ASSET_DELETED,kt.CUSTOM_ASSET)}};new class InternalAssetsHandler extends AssetsHandler{constructor(){super(Rt.INTERNAL_ADDED,Rt.INTERNAL_DELETED,kt.INTERNAL)}addAsset(r,A){if(this._assets[r.id])return;if(this._assets[r.id]=r,this._sessionAssets[r.id]=r,il.addAssetFromHandler(r),A)return;let b=this._addedTopic+":"+r.assetId;Qt.publish(this._id,b,r,!0)}deleteAsset(r,A){if(!(r.id in this._assets))return;if(delete this._assets[r.id],il.deleteAssetFromHandler(r),A)return;let b=this._deletedTopic+":"+r.assetId+":"+r.id;Qt.publish(this._id,b,{asset:r},!0)}deleteFromDiff(){}loadAsset(r){if(r.assetId in this._assetClassMap)return this._assets[r.id]?(this._assets[r.id].updateFromParams(r),this._assets[r.id]):this._sessionAssets[r.id]?(this.addAsset(this._sessionAssets[r.id],!0,!0),this._assets[r.id]):this.addNewAsset(r.assetId,r,!0,!0);console.error("Unrecognized asset found")}reset(){for(let r in this._assets){let A=this._assets[r];this.deleteAsset(A,!0,!0),this.addAsset(A,!0,!0)}}};class Asset{constructor(r={}){this._id=r.id||uuidv4(),this._idBytes=uuidToBytes(this._id),this._assetId=r.assetId,this._name="name"in r?r.name:this._getDefaultName(),this._components=new Set,this._isPrivate=r.isPrivate||!1,r.components&&r.components.forEach((r=>this.addComponent(r)))}_getDefaultName(){console.error("Asset._getDefaultName() should be overridden")}exportParams(){let r=[];for(let A of this._components)r.push(A.id);return{id:this._id,name:this._name,assetId:this._assetId,components:r,isPrivate:this._isPrivate}}updateFromParams(r){for(let A in r)this[A]!=r[A]&&(this[A]=r[A])}get assetId(){return this._assetId}get components(){let r=[];for(let A of this._components)r.push(A.id);return r}get id(){return this._id}get name(){return this._name}get isPrivate(){return this._isPrivate||this.constructor.isPrivate}set components(r){for(let A of this._components){let b=A.id;r.includes(b)||this.removeComponent(b,!0)}for(let A of r){let r=il.getAsset(A);this._components.has(r)||this.addComponent(A,!0)}}set name(r){null!=r&&this._name!=r&&(this._name=r)}set isPrivate(r){this._isPrivate=r}addComponent(r,A){let b=il.getAsset(r);if(!b)return;if(this._components.add(b),A)return b;let C=b.assetId,I=Rt.COMPONENT_ATTACHED+":"+C;return Qt.publish(this._id,I,{id:this._id,componentId:r,componentAssetId:C}),b}removeComponent(r,A){let b=il.getAsset(r);if(!b)return;if(this._components.delete(b),A)return b;let C=b.constructor.assetId,I=Rt.COMPONENT_DETACHED+":"+C;return Qt.publish(this._id,I,{id:this._id,componentId:r,componentAssetId:C}),b}}const al=1,ol=2,ll=3,hl=4,dl=5,cl=6,ul=7,pl=8,Al=9,gl=10,fl=11,ml={iceServers:[{urls:["stun:stun1.l.google.com:19302","stun:stun2.l.google.com:19302","stun:stun3.l.google.com:19302","stun:stun4.l.google.com:19302"]}]};class RTCPeer{constructor(r,A,b,C,I){this._peerId=r,this._polite=A,this._socket=b,this._onTimeout=I,this._myAudioStream=C,this._myAudioTrack=C.getAudioTracks()[0],this._peerAudioTrack,this._connection=new RTCPeerConnection(ml),this._audio=function createAudioElement$1(){let r=document.createElement("audio");return r.autoplay=!0,document.body.appendChild(r),r}(),this._makingOffer=!1,this._ignoreOffer=!1,this._isSettingRemoteAnswerPending=!1,this._hasConnected=!1,this._dataChannel=null,A||(this._timeoutId=setTimeout((()=>this._timeout()),2e4)),this._setupConnection(),this._sendDataQueue=new Queue,this._polite||this._setupDataChannel()}_setupConnection(){this._connection.ontrack=r=>{this._peerAudioTrack=r.track,r.track.onunmute=()=>{this._audio.srcObject||(this._audio.srcObject=r.streams[0])}},this._connection.onicecandidate=r=>{this._socket.send({topic:"candidate",to:this._peerId,candidate:r.candidate})},this._connection.onnegotiationneeded=async()=>{try{this._makingOffer=!0,await this._connection.setLocalDescription(),this._socket.send({topic:"description",to:this._peerId,description:this._connection.localDescription})}catch(r){console.error(r)}finally{this._makingOffer=!1}},this._connection.ondatachannel=r=>{this._polite&&(this._dataChannel=r.channel,this._dataChannel.binaryType="arraybuffer",this._dataChannel.bufferedAmountLowThreshold=65536,this._dataChannel.onopen=r=>{this._onSendDataChannelOpen&&this._onSendDataChannelOpen(r)},this._dataChannel.onclose=r=>{this._onSendDataChannelClose&&this._onSendDataChannelClose(r)},this._dataChannel.onmessage=r=>{this._onMessage&&this._onMessage(r.data)})},this._connection.onconnectionstatechange=r=>{let A=this._connection.connectionState;"connected"!=A||this._hasConnected?"disconnected"!=A&&"failed"!=A||(this._polite||(clearTimeout(this._timeoutId),!this._hasConnected&&this._onFailedImpoliteConnect&&this._onFailedImpoliteConnect()),this._onDisconnect&&this._onDisconnect()):(this._hasConnected=!0,this._myAudioTrack&&this._addAudioTrack(),this._polite||clearTimeout(this._timeoutId))}}_setupDataChannel(){this._dataChannel=this._connection.createDataChannel(this._peerId),this._dataChannel.binaryType="arraybuffer",this._dataChannel.bufferedAmountLowThreshold=65536,this._dataChannel.onopen=r=>{this._onSendDataChannelOpen&&this._onSendDataChannelOpen(r)},this._dataChannel.onclose=r=>{this._onSendDataChannelClose&&this._onSendDataChannelClose(r)},this._dataChannel.onmessage=r=>{this._onMessage&&this._onMessage(r.data)}}_timeout(){this._onTimeout&&(this._onFailedImpoliteConnect=null,this._onTimeout())}toggleMyselfMuted(r){this._myAudioTrack&&(this._myAudioTrack.enabled=!r)}togglePeerMuted(r){this._peerAudioTrack&&(this._peerAudioTrack.enabled=!r)}_addAudioTrack(){this._connection.addTrack(this._myAudioTrack,this._myAudioStream)}close(){this._connection.close(),this._audio.srcObject=null,this._audio.parentNode&&document.body.removeChild(this._audio),this._onDisconnect&&this._onDisconnect()}getPeerId(){return this._peerId}setPeerId(r){this._peerId=r}async handleCandidate(r){try{await this._connection.addIceCandidate(r.candidate)}catch(r){this._ignoreOffer||console.error(r)}}async handleDescription(r){let A=r.description;try{let r=!this._makingOffer&&("stable"==this._connection.signalingState||this._isSettingRemoteAnswerPending),b="offer"==A.type&&!r;if(this._ignoreOffer=!this._polite&&b,this._ignoreOffer)return;this._isSettingRemoteAnswerPending="answer"==A.type,await this._connection.setRemoteDescription(A),this._isSettingRemoteAnswerPending=!1,"offer"==A.type&&(await this._connection.setLocalDescription(),this._socket.send({topic:"description",to:this._peerId,description:this._connection.localDescription}))}catch(r){console.error(r)}}isConnected(){return this._hasConnected}sendData(r){this._sendDataQueue.enqueue(r),this._dataChannel.onbufferedamountlow||1==this._sendDataQueue.length&&this._sendData()}_sendData(){let r=this._dataChannel;for(;r.bufferedAmount<=r.bufferedAmountLowThreshold;){try{r.send(this._sendDataQueue.dequeue())}catch(r){if(!r.message.includes("readyState is not 'open'")&&!r.message.includes("object is in an invalid state"))throw r}if(0==this._sendDataQueue.length)return}r.onbufferedamountlow=()=>{r.onbufferedamountlow=null,this._sendData()}}setOnDisconnect(r){this._onDisconnect=r}setOnFailedImpoliteConnect(r){this._onFailedImpoliteConnect=r}setOnMessage(r){this._onMessage=r}setOnSendDataChannelOpen(r){this._onSendDataChannelOpen=r}setOnSendDataChannelClose(r){this._onSendDataChannelClose=r}}const _l={audio:!0,video:!1};let bl=new class Party{constructor(){this._id=uuidv4(),this._peers={},this._userAudio=function createAudioElement(){let r=document.createElement("audio");return r.autoplay=!0,document.body.appendChild(r),r}(),this._userAudio.defaultMuted=!0,this._userAudio.muted=!0,this._pingIntervalId=null,this._authIntervalId=null,navigator.permissions.query({name:"microphone"}).then((r=>{this._needPromptMicPermissions="prompt"==r.state}))}host(r,A,b){this._fetchAuthToken((()=>{this.connect(!0,r,A,b)}),b)}join(r,A,b){this._fetchAuthToken((()=>{this.connect(!1,r,A,b)}),b)}connect(r,A,b,C){this._socket&&this.disconnect(),this._isHost=r,this._roomId=window.location.pathname+"_"+A,this._successCallback=b,this._errorCallback=C,this._userAudio.srcObject?this._setupWebSocket():this._setupUserMedia()}disconnect(){this._socket&&this._socket.close(),this._replacementSocket&&this._replacementSocket.close(),this._pingIntervalId&&(clearInterval(this._pingIntervalId),this._pingIntervalId=null),this._authIntervalId&&(clearInterval(this._authIntervalId),this._authIntervalId=null),this._socket=null,this._isHost=!1;for(let r in this._peers)this._peers[r].close();this._peers={},this._onDisconnect&&this._onDisconnect()}bootPeer(r){this._socket.send({topic:"boot-peer",peerId:r})}designateHost(r){this._socket.send({topic:"designate-host",peerId:r})}setOnPeerIdUpdate(r){this._onPeerIdUpdate=r}setOnSetupPeer(r){this._onSetupPeer=r}setOnDisconnect(r){this._onDisconnect=r}_fetchAuthToken(r,A){fetch(Mt.authUrl,{cache:"no-store"}).then((r=>r.json())).then((b=>{if(!b.authToken)return this.disconnect(),void(A&&A({topic:"bad-auth"}));this._authToken=b.authToken,r&&r()})).catch((()=>{this.disconnect(),A&&A({topic:"bad-auth"})}))}_initiateUpdateSocket(){this._socket.send({topic:"update-connection",initiate:!0})}_updateSocket(r){this._replacementSocket.send({topic:"update-connection",code:r})}_updateSocketSuccess(){let r=this._socket;this._socket=this._replacementSocket,this._socket.send=r=>{r.authToken=this._authToken,this._socket._send(JSON.stringify(r))},r.onclose=()=>{},r.close(),this._replacementSocket=null}_replacePeerId(r,A){this._peers[r].setPeerId(A),this._peers[A]=this._peers[r],delete this._peers[r],this._onPeerIdUpdate&&this._onPeerIdUpdate(r,A)}_setupUserMedia(){"XR"==Mt.deviceType&&this._needPromptMicPermissions&&el.exitXRSession(),navigator.mediaDevices.getUserMedia(_l).then((r=>{this._userAudio.srcObject=r,this._setupWebSocket()})).catch((()=>{this._userAudio.srcObject=new MediaStream,this._setupWebSocket()}))}_setupWebSocket(){this._socket=new WebSocket(Mt.socketUrl),this._socket.onopen=r=>{this._onSocketOpen()},this._socket.onclose=r=>{this._onSocketClose()},this._socket.onmessage=r=>{this._onSocketMessage(r)},this._socket.onerror=r=>{this._onSocketError(r)},this._socket._send=this._socket.send,this._socket.send=r=>{r.authToken=this._authToken,this._socket._send(JSON.stringify(r))}}_setupReplacementSocket(){this._replacementSocket=new WebSocket(Mt.socketUrl),this._replacementSocket.onopen=()=>{this._initiateUpdateSocket()},this._replacementSocket.onclose=this._socket.onclose,this._replacementSocket.onmessage=this._socket.onmessage,this._replacementSocket.onerror=this._socket.onerror,this._replacementSocket._send=this._replacementSocket.send,this._replacementSocket.send=r=>{r.authToken=this._authToken,this._replacementSocket._send(JSON.stringify(r))}}_onSocketOpen(){this._socket.send({topic:"identify",roomId:this._roomId,isHost:this._isHost}),this._pingIntervalId=setInterval((()=>{this._socket.send({topic:"ping"})}),54e4),this._authIntervalId=setInterval((()=>{this._fetchAuthToken((()=>{this._setupReplacementSocket()}),(()=>{Qt.publish(this._id,Rt.MENU_NOTIFICATION,{text:"Could not authenticate with Server"})}))}),3e6)}_onSocketClose(){this._socket&&this.disconnect()}_onSocketMessage(r){let A=JSON.parse(r.data),b=A.topic;"initiate"==b?this._setupRTCPeer(A):"candidate"==b?this._peers[A.from].handleCandidate(A):"description"==b?this._peers[A.from].handleDescription(A):"hosting"==b?this._successCallback&&this._successCallback():"update-connection-ready"==b?this._updateSocket(A.code):"update-connection-success"==b?this._updateSocketSuccess():"replace-connection"==b?this._replacePeerId(A.oldPeerId,A.newPeerId):"designate-host"==b?Qt.publish(this._id,Rt.BECOME_PARTY_HOST):"boot-peer"==b?Qt.publish(this._id,Rt.BOOT_PEER,A.peerId):"disconnect"==b?this.disconnect():"error"==b&&"boot-peer"==A.requestTopic?Qt.publish(this._id,Rt.MENU_NOTIFICATION,{text:"Error: Couldn't kick out user"}):"error"==b&&"designate-host"==A.requestTopic?(Qt.publish(this._id,Rt.BECOME_PARTY_HOST),Qt.publish(this._id,Rt.MENU_NOTIFICATION,{text:"Error: Couldn't make user host"})):"error"==b&&"update-connection"==A.requestTopic?(Qt.publish(this._id,Rt.MENU_NOTIFICATION,{text:"Could not reinitiate connection with Server"}),this.disconnect()):(this.disconnect(),this._errorCallback&&this._errorCallback(A))}_onSocketError(r){this.disconnect(),this._errorCallback&&this._errorCallback(r)}_onRTCTimeout(){this._socket&&this._onSocketError({topic:"rtc-timeout"})}_setupRTCPeer(r){let A=r.peerId,b=r.polite;this._peers[A]=new RTCPeer(r.peerId,b,this._socket,this._userAudio.srcObject.clone(),(()=>this._onRTCTimeout())),this._onSetupPeer&&this._onSetupPeer(this._peers[A])}};const yl=16384,vl={asset_added:"_handleAssetAdded",user_controller:"_handleUserController",username:"_handleUsername"},Cl={[al]:"_handleBufferAssetAdded",[fl]:"_handleUserPerspective"},wl={instance_added:"_handleInstanceAdded",instance_deleted:"_handleInstanceDeleted",instance_updated:"_handleInstanceUpdated",instance_attached:"_handleInstanceAttached",instance_detached:"_handleInstanceDetached",loaded_diff:"_handleLoadedDiff",sanitize_internals:"_handleSanitizeInternals",settings_updated:"_handleSettingsUpdated"},El={[cl]:"_handleEntityPosition",[ul]:"_handleEntityRotation",[pl]:"_handleEntityScale",[Al]:"_handleEntityTransformation",[ol]:"_handleComponentAttached",[ll]:"_handleComponentDetached",[hl]:"_handleEntityAdded",[dl]:"_handleEntityAttached"};let Il=new class PartyMessageHelper{constructor(){this._id="44a9d6b3-2bf7-4e36-b8d1-10bb69de95cc",this._idBytes=uuidToBytes(this._id),this._handlingLocks=new Set,this._handleQueue=new Queue,this._publishQueue=new Queue}init(r){this._partyHandler=r;for(let r in vl){let handler=(A,b)=>this[vl[r]](A,b);this._partyHandler.addInternalMessageHandler(r,handler,!0)}for(let r in Cl){let handler=(A,b)=>this[Cl[r]](A,b);this._partyHandler.addInternalBufferMessageHandler(r,handler,!0)}for(let r in wl){let handler=(A,b)=>this[wl[r]](A,b);this._partyHandler.addInternalMessageHandler(r,handler)}for(let r in El){let handler=(A,b)=>this[El[r]](A,b);this._partyHandler.addInternalBufferMessageHandler(r,handler)}}registerHandler(r,A){console.warn("registerHandler(...) is deprecated"),this._partyHandler.addMessageHandler(r,A)}registerBlockableHandler(r,A){console.warn("registerBlockableHandler(...) is deprecated");this._partyHandler.addMessageHandler(r,((r,b)=>{this._handleBlockable(A,r,b)}))}publish(r){this._partyHandler._sendToAllPeers(r)}queuePublish(r){console.warn("PartyMessageHelper.queuePublish(...) is deprecated"),"function"==typeof r?this._publishQueue.enqueue(r):this._publishQueue.enqueue((()=>(this._partyHandler._sendToAllPeers(r),Promise.resolve())))}notifyDiffError(){Qt.publish(this._id,Rt.MENU_NOTIFICATION,{text:"An unexpected error occured when loading the host's state"})}_handleUserController(r,A){if(!r.controller){let b=A.controllerParams;this._handleUsername(r,b.username);let C=il.getSessionAsset(b.id);C?(il.addAsset(C),C.setDisplayingUsername(this._partyHandler.getDisplayingUsernames())):(b.displayingUsername=this._partyHandler.getDisplayingUsernames(),C=il.addNewAsset(b.assetId,b,!0,!0)),C.peer&&C.peer!=r&&(C.peer.controller=null),r.controller=C,C.peer=r}}_handleAssetAdded(r,A){let b=this._partyHandler.addMessageHandlerLock();if(A.isExternal){let{assetId:r,name:C,type:I,url:x,sketchfabId:S}=A,B={Name:C,Type:I,IsExternal:!0,URL:x,SketchfabID:S};Qo.loadLibraryExternalAsset(r,B).then((()=>{Qt.publish(this._id,Rt.ASSET_ADDED,r),this._partyHandler.removeMessageHandlerLock(b)}))}else A.lock=b,A.parts=[],r.assetAddedDetails=A}_handleBufferAssetAdded(r,A){if(!r.assetAddedDetails)return void console.error("Unexpected call to _handleBufferAssetAdded() before _handleAssetAdded()");let{parts:b,partsLength:C,assetId:I,name:x,type:S,lock:B,sketchfabId:D}=r.assetAddedDetails;if(b.push(A),b.length==C){let r={Name:x,Type:S,SketchfabID:D};Qo.loadLibraryAssetFromArrayBuffer(I,r,b).then((()=>{Qt.publish(this._id,Rt.ASSET_ADDED,I),this._partyHandler.removeMessageHandlerLock(B)}))}}_handleBlockable(r,A,b){this._handlingLocks.size>0?this._handleQueue.enqueue((()=>{r(A,b)})):r(A,b)}_handleComponentAttached(r,A){let b=new Uint8Array(A);A={id:uuidFromBytes(b.subarray(0,16)),componentId:uuidFromBytes(b.subarray(16,32)),componentAssetId:uuidFromBytes(b.subarray(32,48))};let C=il.getSessionAsset(A.id);C&&(C.editorHelper?C.editorHelper.addComponent(A.componentId,!0,!0):C.addComponent(A.componentId,!0),Qt.publish(this._id,Rt.COMPONENT_ATTACHED+":"+A.componentAssetId,A))}_handleComponentDetached(r,A){let b=new Uint8Array(A);A={id:uuidFromBytes(b.subarray(0,16)),componentId:uuidFromBytes(b.subarray(16,32)),componentAssetId:uuidFromBytes(b.subarray(32,48))};let C=il.getSessionAsset(A.id);C&&(C.editorHelper?C.editorHelper.removeComponent(A.componentId,!0,!0):C.removeComponent(A.componentId,!0),Qt.publish(this._id,Rt.COMPONENT_DETACHED+":"+A.componentAssetId,A))}_handleEntityAdded(r,A){let b=new Uint8Array(A);A={parentId:uuidFromBytes(b.subarray(0,16)),childId:uuidFromBytes(b.subarray(16,32)),position:Array.from(new Float64Array(A,32,3)),rotation:Array.from(new Float64Array(A,56,3))};let C=il.getSessionAsset(A.parentId),I=il.getSessionAsset(A.childId);if(I){I.editorHelper?I.editorHelper.addTo(C,!0,!0):I.addTo(C,!0);let r=I.object;r.position.fromArray(A.position),r.rotation.fromArray(A.rotation),Qt.publish(this._id,Rt.ENTITY_ADDED,A)}else console.error("Missing child in message for _handleEntityAdded()")}_handleEntityAttached(r,A){let b=new Uint8Array(A);A={parentId:uuidFromBytes(b.subarray(0,16)),childId:uuidFromBytes(b.subarray(16,32)),position:Array.from(new Float64Array(A,32,3)),rotation:Array.from(new Float64Array(A,56,3))};let C=il.getSessionAsset(A.parentId),I=il.getSessionAsset(A.childId);if(I){I.editorHelper?I.editorHelper.attachTo(C,!0,!0):I.attachTo(C,!0);let r=I.object;r.position.fromArray(A.position),r.rotation.fromArray(A.rotation),Qt.publish(this._id,Rt.ENTITY_ATTACHED,A)}else console.error("Missing child from entity_attached message")}_handleEntityPosition(r,A){let b=uuidFromBytes(new Uint8Array(A,0,16)),C=Array.from(new Float64Array(A,16,3)),I=il.getSessionAsset(b);I?I.position=C:console.error("Missing asset in message for _handleEntityPosition()")}_handleEntityRotation(r,A){let b=uuidFromBytes(new Uint8Array(A,0,16)),C=Array.from(new Float64Array(A,16,3)),I=il.getSessionAsset(b);I?I.rotation=C:console.error("Missing asset in message for _handleEntityRotation()")}_handleEntityScale(r,A){let b=uuidFromBytes(new Uint8Array(A,0,16)),C=Array.from(new Float64Array(A,16,3)),I=il.getSessionAsset(b);I?I.scale=C:console.error("Missing asset in message for _handleEntityScale()")}_handleEntityTransformation(r,A){let b=uuidFromBytes(new Uint8Array(A,0,16)),C=Array.from(new Float64Array(A,16,3)),I=Array.from(new Float64Array(A,40,3)),x=Array.from(new Float64Array(A,64,3)),S=il.getSessionAsset(b);S?(S.position=C,S.rotation=I,S.scale=x):console.error("Missing asset in message for _handleEntityTransformation()")}_handleInstanceAdded(r,A){let b=il.getSessionAsset(A.asset.id);if(b)il.addAsset(b,!0,!0);else{b=il.addNewAsset(A.asset.assetId,A.asset,!0,!0);let r=b.parentId;if(r){let A=il.getSessionAsset(r);A&&b.addTo(A,!0)}}let C=A.assetType+"_ADDED:"+b.assetId+":"+b.id;Qt.publish(this._id,C,b)}_handleInstanceDeleted(r,A){let b=il.getAsset(A.id);if(b){il.deleteAsset(b,!0,!0);let r=A.assetType+"_DELETED:"+A.assetId+":"+A.id;Qt.publish(this._id,r,{asset:b})}else console.error("Asset to delete does not exist")}_handleInstanceUpdated(r,A){let b=il.getSessionAsset(A.params.id);b&&this._handleAssetUpdate(b,A.params,A.extraData,A.assetType+"_UPDATED")}_handleInstanceAttached(r,A){let b=il.getSessionAsset(A.id);if(b){let C=b.editorHelper;C&&C.attachToPeer(r,A)}}_handleInstanceDetached(r,A){let b=il.getSessionAsset(A.id);if(b){let C=b.editorHelper;C&&C.detachFromPeer(r,A)}}_handleLoadedDiff(r){Qt.publish(this._id,Rt.PEER_READY,{peer:r}),r.readyForUpdates=!0}_handleSanitizeInternals(){Qt.publish(this._id,Rt.SANITIZE_INTERNALS,null,!0)}_handleSettingsUpdated(r,A){for(let r in A){let b;if("User Settings"==r)b="setUserSetting";else{if("Skybox"!=r)return void console.error("Unknown setting updated: "+r);b="setSkyboxSide"}for(let C in A[r])Wo[b](C,A[r][C],!0)}Qt.publish(this._id,Rt.SETTINGS_UPDATED,{settings:A})}_handleAssetUpdate(r,A,b,C){let I=[];for(let C in A)"id"!=C&&(I.push(C),b?.[C]?"useFunction"==b[C].type&&r[b[C].funcName](b[C].value):C in r&&(r[C]=A[C]),r.editorHelper&&r.editorHelper.updateMenuField(C));let x={asset:r,fields:I};b&&(x.extraData=b),Qt.publish(this._id,C,x)}_handleUsername(r,A){r.username!=A&&(r.username=A,r.controller&&(r.controller.username=A),Qt.publish(this._id,Rt.PEER_USERNAME_UPDATED,{peer:r}))}_handleUserPerspective(r,A){let b=new Uint8Array(A)[0];r.controller&&r.controller.setFirstPerson(1==b)}handlePartyStarted(){Qt.publish(this._id,Rt.PARTY_STARTED)}handlePartyEnded(){Qt.publish(this._id,Rt.PARTY_ENDED)}handlePeerConnected(r){Qt.publish(this._id,Rt.PEER_CONNECTED,{peer:r})}handlePeerDisconnected(r){let A=Rt.PEER_DISCONNECTED+":"+r.id;Qt.publish(this._id,A,{peer:r})}handleDiffLoaded(){this._partyHandler._sendToAllPeers(JSON.stringify({topic:"loaded_diff"})),Qt.publish(this._id,Rt.USER_READY)}_removeHandlingLock(r){for(this._handlingLocks.delete(r);this._handleQueue.length>0&&0==this._handlingLocks.size;)this._handleQueue.dequeue()()}_publishAssetAdded(r){let A=Qo.getLibrary()[r];A.IsExternal?this._partyHandler.publishInternalMessage("asset_added",{assetId:r,name:A.Name,type:A.Type,url:A.URL,sketchfabId:A.SketchfabID,isExternal:!0},!0):this._partyHandler.publishFromFunction((()=>new Promise((A=>{let b=Qo.getLibrary()[r];b.Blob.arrayBuffer().then((C=>{let I=[],x=Math.ceil(C.byteLength/yl);for(let r=0;r<x;r++){let A=r*yl,b=(r+1)*yl;I.push(C.slice(A,b))}this._partyHandler.publishInternalMessage("asset_added",{assetId:r,name:b.Name,type:b.Type,sketchfabId:b.SketchfabID,partsLength:I.length},!0);for(let r of I)this._partyHandler.publishInternalBufferMessage(al,r,!0);A()}))}))))}_publishComponentAttachedDetached(r,A){let b=concatenateArrayBuffers(uuidToBytes(A.id),uuidToBytes(A.componentId),uuidToBytes(A.componentAssetId));this._partyHandler.publishInternalBufferMessage(r,b)}_publishEntityAdded(r){let A=il.getSessionAsset(r.childId),b=concatenateArrayBuffers(uuidToBytes(r.parentId),uuidToBytes(r.childId),new Float64Array(A.position),new Float64Array(A.rotation));this._partyHandler.publishInternalBufferMessage(hl,b)}_publishEntityAttached(r){let A=il.getSessionAsset(r.childId),b=concatenateArrayBuffers(uuidToBytes(r.parentId),uuidToBytes(r.childId),new Float64Array(A.position),new Float64Array(A.rotation));this._partyHandler.publishInternalBufferMessage(dl,b)}_publishInstanceAdded(r,A){let b={asset:r.exportParams(),assetType:A};this._partyHandler.publishInternalMessage("instance_added",b)}_publishInstanceDeleted(r,A){let b={id:r.id,assetId:r.assetId,assetType:A};this._partyHandler.publishInternalMessage("instance_deleted",b)}_publishInstanceUpdated(r,A){let b={};b.id=r.asset.id;for(let A of r.fields)b[A]=r.asset[A],void 0===b[A]&&(b[A]=null);let C={params:b,assetType:A};r.extraData&&(C.extraData=r.extraData),this._partyHandler.publishInternalMessage("instance_updated",C)}_publishInstanceAttached(r){let A={id:r.instance.id,assetId:r.instance.assetId,ownerId:r.ownerId,type:r.type};"XR"==Mt.deviceType&&(A.position=r.position,A.rotation=r.rotation,A.scale=r.scale,A.twoHandScaling=r.twoHandScaling,A.isXR=!0),this._partyHandler.publishInternalMessage("instance_attached",A)}_publishInstanceDetached(r){let A={id:r.instance.id,assetId:r.instance.assetId,ownerId:r.ownerId,type:r.type};"XR"==Mt.deviceType&&(A.position=r.position,A.rotation=r.rotation,A.scale=r.scale,A.twoHandScaling=r.twoHandScaling,A.isXR=!0),this._partyHandler.publishInternalMessage("instance_detached",A)}_publishSettingsUpdated(r){let A=r.settings,b=r.keys,C={};C[b[0]]={},C[b[0]][b[1]]=A[b[0]][b[1]],this._partyHandler.publishInternalMessage("settings_updated",C)}_publishUserPerspectiveChanged(r){let A=new Uint8Array([r]);this._partyHandler.publishInternalBufferMessage(fl,A)}_publishUsernameUpdated(r){this._partyHandler.publishInternalMessage("username",r)}addSubscriptions(){Qt.subscribe(this._id,Rt.ASSET_ADDED,(r=>{this._publishAssetAdded(r)})),Qt.subscribe(this._id,Rt.BECOME_PARTY_HOST,(()=>{this._partyHandler.setIsHost(!0)})),Qt.subscribe(this._id,Rt.BOOT_PEER,(r=>{this._partyHandler.bootPeer(r)})),Qt.subscribe(this._id,Rt.COMPONENT_ATTACHED,(r=>{this._publishComponentAttachedDetached(ol,r)})),Qt.subscribe(this._id,Rt.COMPONENT_DETACHED,(r=>{this._publishComponentAttachedDetached(ll,r)})),Qt.subscribe(this._id,Rt.ENTITY_ADDED,(r=>{this._publishEntityAdded(r)})),Qt.subscribe(this._id,Rt.ENTITY_ATTACHED,(r=>{this._publishEntityAttached(r)})),Qt.subscribe(this._id,Rt.INSTANCE_ATTACHED,(r=>{this._publishInstanceAttached(r)})),Qt.subscribe(this._id,Rt.INSTANCE_DETACHED,(r=>{this._publishInstanceDetached(r)})),Qt.subscribe(this._id,Rt.SANITIZE_INTERNALS,(()=>{this._publishQueue.enqueue((()=>(this._partyHandler._sendToAllPeers(JSON.stringify({topic:"sanitize_internals"})),Promise.resolve())))})),Qt.subscribe(this._id,Rt.SETTINGS_UPDATED,(r=>{this._publishSettingsUpdated(r)})),Qt.subscribe(this._id,Rt.USER_PERSPECTIVE_CHANGED,(r=>{this._publishUserPerspectiveChanged(r)})),Qt.subscribe(this._id,Rt.USERNAME_UPDATED,(r=>{this._publishUsernameUpdated(r)}));for(let r in kt){let A=Rt[r+"_ADDED"],b=Rt[r+"_DELETED"],C=Rt[r+"_UPDATED"];Qt.subscribe(this._id,A,(A=>{this._publishInstanceAdded(A,r)})),Qt.subscribe(this._id,b,(A=>{this._publishInstanceDeleted(A.asset,r)})),Qt.subscribe(this._id,C,(A=>{this._publishInstanceUpdated(A,r)}))}}removeSubscriptions(){Qt.unsubscribe(this._id,Rt.ASSET_ADDED),Qt.unsubscribe(this._id,Rt.BECOME_PARTY_HOST),Qt.unsubscribe(this._id,Rt.BOOT_PEER),Qt.unsubscribe(this._id,Rt.COMPONENT_ATTACHED),Qt.unsubscribe(this._id,Rt.COMPONENT_DETACHED),Qt.unsubscribe(this._id,Rt.ENTITY_ADDED),Qt.unsubscribe(this._id,Rt.ENTITY_ATTACHED),Qt.unsubscribe(this._id,Rt.INSTANCE_ATTACHED),Qt.unsubscribe(this._id,Rt.INSTANCE_DETACHED),Qt.unsubscribe(this._id,Rt.SANITIZE_INTERNALS),Qt.unsubscribe(this._id,Rt.SETTINGS_UPDATED),Qt.unsubscribe(this._id,Rt.USER_PERSPECTIVE_CHANGED),Qt.unsubscribe(this._id,Rt.USERNAME_UPDATED);for(let r in kt)Qt.unsubscribe(this._id,Rt[r+"_ADDED"]),Qt.unsubscribe(this._id,Rt[r+"_DELETED"]),Qt.unsubscribe(this._id,Rt[r+"_UPDATED"])}update(){this._isPublishing||0==this._publishQueue.length||(this._isPublishing=!0,this._publishQueue.dequeue()().then((()=>this._isPublishing=!1)))}};const Tl=16384,xl=65536,Sl=new Uint8Array([0]);let Bl=new class PartyHandler{constructor(){this._peers={},this._partyActive=!1,this._displayingUsernames=!1,this._username=function generateRandomUsername$1(){return String.fromCharCode(97+Math.floor(26*Math.random()))+Math.floor(100*Math.random())}(),this._handleLocks=new Set,this._handleQueue=new Queue,this._publishQueue=new Queue,this._messageHandlers={},this._bufferMessageHandlers={},this.addInternalMessageHandler("project",((r,A)=>this._handleProject(r,A)),!0),this.addInternalBufferMessageHandler(gl,((r,A)=>this._handleProjectPart(r,A)),!0),Il.init(this),bl.setOnPeerIdUpdate(((r,A)=>{this._updatePeerId(r,A)})),bl.setOnSetupPeer((r=>{this._registerPeer(r)})),bl.setOnDisconnect((()=>{this._onDisconnect()}))}_onDisconnect(){this._partyActive=!1,Il.removeSubscriptions();for(let r in this._peers){let A=this._peers[r];A.rtc&&A.rtc.close(),Il.handlePeerDisconnected(A)}this._peers={},Il.handlePartyEnded()}_deleteInternal(r){Il._handleInstanceDeleted(null,{id:r.id,assetId:r.assetId,assetType:kt.INTERNAL})}_registerPeer(r){let A={id:r.getPeerId(),jitterBuffer:new Queue,messageBacklog:[],readyForUpdates:!1};this._peers[A.id]=A,r.setOnSendDataChannelOpen((()=>{if(this._successCallback&&this._successCallback(),A.rtc=r,this._sendUserInfo(r),Il.handlePeerConnected(A),this._isHost){let r=Mt.isEditor?il.exportProject(!0):il.exportDiff();this._sendProjectZip(r,A)}})),r.setOnSendDataChannelClose((()=>{delete A.rtc})),r.setOnDisconnect((()=>{if(A.controller){for(let r of A.controller.getXRDevices())this._deleteInternal(r);let r=A.controller.avatar;r&&this._deleteInternal(r),this._deleteInternal(A.controller)}A.id in this._peers&&(delete this._peers[A.id],Il.handlePeerDisconnected(A))})),r.setOnFailedImpoliteConnect((()=>{this._errorCallback&&this._errorCallback({topic:"could-not-connect"}),bl.disconnect()})),r.setOnMessage((r=>{"string"==typeof r?this._handleJSON(A,JSON.parse(r)):this._handleArrayBuffer(A,r)}))}_sendUserInfo(r){r.sendData(JSON.stringify({id:"Iuser_controller",body:{controllerParams:Mt.userController.exportParams(),isXR:"XR"==Mt.deviceType}}));let A=Mt.userController.avatar;r.sendData(JSON.stringify({id:"Iinstance_added",body:{asset:A.exportParams(),assetType:A.constructor.assetType}}));for(let A in on){let b=Mt.userController.getController(A),C=Mt.userController.getHand(A);for(let A of[b,C])A&&A.isInScene()&&r.sendData(JSON.stringify({id:"Iinstance_added",body:{asset:A.exportParams(),assetType:A.constructor.assetType}}))}}_updatePeerId(r,A){this._peers[r].id=A,this._peers[A]=this._peers[r],delete this._peers[r]}_handleJSON(r,A){A.id in this._messageHandlers&&this._messageHandlers[A.id](r,A.body)}_handleArrayBuffer(r,A){if(r.handleEventArrayBuffer)return void r.handleEventArrayBuffer(r,A);let b,C=new Uint8Array(A,0,1)[0];0!=C?(C%2==0?(b=new Uint8Array(A,1,1)[0],A=A.slice(2)):(b=uuidFromBytes(new Uint8Array(A,1,16)),A=A.slice(17)),b=(C<3?"I":"U")+b,b in this._bufferMessageHandlers&&this._bufferMessageHandlers[b](r,A)):r.jitterBuffer.enqueue(A.slice(1))}_getNextJitterBufferMessage(r,A){let b=r.peek();if(!b)return null;let C,I=this._getMessageTimestamp(b),x=A-I;if(x=(x%xl+xl)%xl,x<=50)return null;do{if(b=r.dequeue(),C=r.peek(),!C)return b;I=this._getMessageTimestamp(C),x=A-I,x=(x%xl+xl)%xl}while(x>50);return b}_getMessageTimestamp(r){return new Uint16Array(r,0,1)[0]}_sendProjectZip(r,...A){r.generateAsync({type:"arraybuffer"}).then((r=>{let b=[],C=Math.ceil(r.byteLength/Tl);for(let A=0;A<C;A++){let C=A*Tl,I=(A+1)*Tl;b.push(r.slice(C,I))}this._sendProjectParts(b,...A)}))}_sendProjectParts(r,...A){for(let b of A)b.rtc&&b.rtc.sendData(JSON.stringify({id:"Iproject",body:{partsLength:r.length}}));for(let b of r){let r=concatenateArrayBuffers(new Uint8Array([2,gl]),b);for(let b of A)b.rtc&&b.rtc.sendData(r)}}_handleProject(r,A){A.lock=this.addMessageHandlerLock(),A.parts=[],r.incomingProjectDetails=A}_handleProjectPart(r,A){if(!r.incomingProjectDetails)return void console.error("Unexpected call to _handleProjectPart() before _handleProject()");let{parts:b,partsLength:C,lock:I}=r.incomingProjectDetails;if(b.push(A),b.length==C){let r=concatenateArrayBuffersFromList(b);(new JSZip).loadAsync(r).then((r=>{Mt.isEditor?il.loadZip(r,(()=>{this.publishInternalMessage("loaded_diff");for(let r in this._peers)this._peers[r].readyForUpdates=!0;this.removeMessageHandlerLock(I)}),(()=>{this.removeMessageHandlerLock(I),bl.disconnect(),Il.notifyDiffError()})):il.loadDiffZip(r,(()=>{this.publishInternalMessage("loaded_diff");for(let r in this._peers)this._peers[r].readyForUpdates=!0;this.removeMessageHandlerLock(I)}),(()=>{this.removeMessageHandlerLock(I),bl.disconnect(),Il.notifyDiffError()}))}))}}addMessageHandlerLock(){let r=uuidv4();return this._handleLocks.add(r),r}removeMessageHandlerLock(r){for(this._handleLocks.delete(r);this._handleQueue.length>0&&0==this._handleLocks.size;)this._handleQueue.dequeue()()}_handleBlockable(r,A,b){this._handleLocks.size>0?this._handleQueue.enqueue((()=>r(A,b))):r(A,b)}addMessageHandler(r,A,b){this._messageHandlers["U"+r]=b?A:(r,b)=>this._handleBlockable(A,r,b)}addInternalMessageHandler(r,A,b){this._messageHandlers["I"+r]=b?A:(r,b)=>this._handleBlockable(A,r,b)}addBufferMessageHandler(r,A,b){this._bufferMessageHandlers["U"+r]=b?A:(r,b)=>this._handleBlockable(A,r,b)}addInternalBufferMessageHandler(r,A,b){this._bufferMessageHandlers["I"+r]=b?A:(r,b)=>this._handleBlockable(A,r,b)}publishFromFunction(r,A){A?r():this._publishQueue.enqueue(r)}_publishMessage(r,A,...b){A?this._sendToPeers(r,...b):this._publishQueue.enqueue({message:r,peerList:b})}publishMessage(r,A,b,...C){this._publishMessage(JSON.stringify({id:"U"+r,body:A}),b,...C)}publishInternalMessage(r,A,b,...C){this._publishMessage(JSON.stringify({id:"I"+r,body:A}),b,...C)}_publishBufferMessage(r,A,b,C,...I){let x=new Uint8Array(1);r instanceof Uint8Array?x[0]=C:"number"==typeof r?(x[0]=C+1,r=new Uint8Array([r])):(x[0]=C,r=uuidToBytes(r)),A=concatenateArrayBuffers(x,r,A),this._publishMessage(A,b,...I)}publishBufferMessage(r,A,b,...C){this._publishBufferMessage(r,A,b,3,...C)}publishInternalBufferMessage(r,A,b,...C){this._publishBufferMessage(r,A,b,1,...C)}bootPeer(r){let A=this._peers[r];A&&A.rtc?A.rtc.close():console.warn("Warn: couldn't boot peer because peer's rtc connection does not exist. Likely a race condition where the peer disconnecting from their end already closed the connection")}getDisplayingUsernames(){return this._displayingUsernames}getPeer(r){return this._peers[r]}getPeers(){return this._peers}sendProject(){let r=[];for(let A in this._peers)r.push(this._peers[A]);let A=il.exportProject(!0);this._sendProjectZip(A,...r)}setDisplayingUsernames(r){if(this._displayingUsernames!=r){this._displayingUsernames=!this._displayingUsernames;for(let r in this._peers){let A=this._peers[r].controller;A&&A.setDisplayingUsername(this._displayingUsernames)}}}setIsHost(r){this._isHost=r}isHost(){return this._isHost}isPartyActive(){return this._partyActive}host(r,A,b){this._isHost=!0,this._successCallback=A,this._errorCallback=b,bl.host(r,A,b),Il.addSubscriptions(),this._partyActive=!0,Il.handlePartyStarted()}join(r,A,b){this._isHost=!1,this._successCallback=A,this._errorCallback=b,bl.join(r,A,b),Il.addSubscriptions(),this._partyActive=!0,Il.handlePartyStarted()}_sendToPeers(r,...A){0==A.length&&(A=this._peers);for(let A in this._peers)if(this._peers[A].readyForUpdates){let b=this._peers[A].rtc;b&&b.sendData(r)}else this._peers[A].messageBacklog.push(r)}setEventBufferHandler(r,A){r.handleEventArrayBuffer=A}update(r){if(!this._partyActive)return;let A=(new Date).getTime()%xl,b=new Uint16Array([A]).buffer;b=concatenateArrayBuffers(Sl,b,...Mt.userController.getDataForRTC());for(let C in this._peers){let I=this._peers[C];if(I.controller){let b=this._getNextJitterBufferMessage(I.jitterBuffer,A);b&&I.controller.processMessage(b),I.controller.update(r)}if(I.rtc&&I.readyForUpdates){if(I.messageBacklog.length>0){for(let r of I.messageBacklog)I.rtc.sendData(r);I.messageBacklog=[]}I.rtc.sendData(b)}}for(;this._publishQueue.length>0&&!this._isPublishing;){let r=this._publishQueue.dequeue();if("function"==typeof r){this._isPublishing=!0;let A=r();A instanceof Promise?A.then((()=>this._isPublishing=!1)):(console.error("PartyHandler.publishFromFunction(<function>, true) expects a function that returns a Promise object. No Promise object found"),this._isPublishing=!1)}else this._sendToPeers(r.message,...r.peerList)}}};const Dl=["pointerInteractable","gripInteractable","touchInteractable"];class AssetEntity extends Asset{constructor(A={}){super(A),this._object=A.object||new r.Object3D,this._object.asset=this,this._object.addEventListener("added",(()=>this._onAdded())),this._object.addEventListener("removed",(()=>this._onRemoved())),this._parentId="parentId"in A?A.parentId:Ho.id,this.children=new Set,this.parent=il.getSessionAsset(this._parentId),this.parent&&!A.isPreview&&this.parent.children.add(this);let b=A.position?A.position:[0,0,0],C=A.rotation?A.rotation:[0,0,0],I=A.scale?A.scale:[1,1,1];this._visualEdit=A.visualEdit||!1,this._renderOrder=A.renderOrder||0,this._object.position.fromArray(b),this._object.rotation.fromArray(C),this._object.scale.fromArray(I),new GripInteractable(this._object),new PointerInteractable(this._object),new TouchInteractable(this._object),this._positionBytes=new Float64Array(3),this._rotationBytes=new Float64Array(3),this._scaleBytes=new Float64Array(3),this._transformationBytes=new Float64Array(9)}_getDefaultName(){return"Object"}_configureMesh(){this._mesh&&(this._mesh.renderOrder=this._renderOrder)}_fetchCloneParams(r){let A=this.exportParams(),b=null!=r?r:this._visualEdit;return A.visualEdit=b,delete A.id,A}clone(r,A){let b=this._fetchCloneParams(A),C=il.addNewAsset(this._assetId,b);if(r)for(let r of this.children)C.add(r.clone(!0));return C}preview(){let r=this.exportParams();return r.visualEdit=!1,r.isPreview=!0,delete r.id,delete r.parentId,new this.constructor(r)}exportParams(){let r=super.exportParams();return r.parentId=this._parentId,r.position=this.position,r.renderOrder=this._renderOrder,r.rotation=this.rotation,r.scale=this.scale,r.visualEdit=this._visualEdit,r}_updateBVH(){Zi.updateBVHForComplexObject(this._object)}get gripInteractable(){return this._object.gripInteractable}get object(){return this._object}get parentId(){return this._parentId}get pointerInteractable(){return this._object.pointerInteractable}get position(){return this._object.position.toArray()}get renderOrder(){return this._renderOrder}get rotation(){let r=this._object.rotation.toArray();return r.pop(),r}get scale(){return this._object.scale.toArray()}get touchInteractable(){return this._object.touchInteractable}get visualEdit(){return this._visualEdit}getWorldPosition(r){return r||(r=ao[0]),this._object.getWorldPosition(r),r}getWorldQuaternion(r){return r||(r=ho),this._object.getWorldQuaternion(r),r}getWorldScale(r){return r||(r=ao[0]),this._object.getWorldScale(r),r}set parentId(r){if(this._parentId==r)return;let A=il.getSessionAsset(r);A?null!=this._parentId?this.attachTo(A,!0):this.addTo(A,!0):(this._object.parent&&this._object.parent.remove(this._object),this.parent&&this.parent.children.delete(this),this.parent=null),this._parentId=r}set position(r){this._object.position.fromArray(r)}set renderOrder(r){this._renderOrder=r,this._configureMesh()}set rotation(r){this._object.rotation.fromArray(r)}set scale(r){this._object.scale.fromArray(r)}set visualEdit(r){this._visualEdit=r}setRotationFromQuaternion(r){ho.fromArray(r),this._object.setRotationFromQuaternion(ho)}publishPosition(){this._positionBytes.set(this._object.position.toArray());let r=concatenateArrayBuffers(this._idBytes,this._positionBytes);Bl.publishInternalBufferMessage(cl,r)}publishRotation(){this._rotationBytes.set(this.rotation);let r=concatenateArrayBuffers(this._idBytes,this._rotationBytes);Bl.publishInternalBufferMessage(ul,r)}publishScale(){this._scaleBytes.set(this._object.scale.toArray());let r=concatenateArrayBuffers(this._idBytes,this._scaleBytes);Bl.publishInternalBufferMessage(pl,r)}publishTransformation(){this._transformationBytes.set(this._object.position.toArray()),this._transformationBytes.set(this.rotation,3),this._transformationBytes.set(this._object.scale.toArray(),6);let r=concatenateArrayBuffers(this._idBytes,this._transformationBytes);Bl.publishInternalBufferMessage(Al,r)}add(r,A){r.addTo(this,A)}addTo(r,A){r&&(this.parent&&this.parent.children.delete(this),this.parent=r,r.children.add(this),this._parentId=r.id,il.getAsset(this._id)&&r.object.add(this._object),A||Qt.publish(this._id,Rt.ENTITY_ADDED,{parentId:r.id,childId:this._id},!0))}attach(r,A){r.attachTo(this,A)}attachTo(r,A){r&&(this.parent&&this.parent.children.delete(this),this.parent=r,r.children.add(this),this._parentId=r.id,il.getAsset(this._id)&&r.object.attach(this._object),A||Qt.publish(this._id,Rt.ENTITY_ATTACHED,{parentId:r.id,childId:this._id},!0))}_onAdded(){for(let r of Dl){let A=this._object[r];this._object.parent?.[r]?this._object.parent?.[r].addChild(A):A.parent&&A.parent.removeChild(A)}}_onRemoved(){for(let r of Dl){let A=this._object[r];A.parent&&A.parent.removeChild(A)}}onRemoveFromProject(){this._object.parent&&(this._object.parent.remove(this._object),fullDispose(this._object))}}const Pl=0,Ml=1,kl=2;class PlayableMediaEntity extends AssetEntity{constructor(r={}){super(r),this._autoplay=r.autoplay||!1,this._loop=r.loop||!1,this.playTopic=r.playTopic||"",this.pauseTopic=r.pauseTopic||"",this.stopTopic=r.stopTopic||""}_getDefaultName(){return Qo.getAssetName(this._assetId)}exportParams(){let r=super.exportParams();return r.autoplay=this._autoplay,r.loop=this._loop,r.pauseTopic=this._pauseTopic,r.playTopic=this._playTopic,r.stopTopic=this._stopTopic,r}get media(){return this._media}get autoplay(){return this._autoplay}get loop(){return this._loop}get playTopic(){return this._playTopic}get pauseTopic(){return this._pauseTopic}get stopTopic(){return this._stopTopic}get isPlaying(){return console.error("get PlayableMediaAsset.isPlaying should be overridden"),!1}get progress(){return console.error("get PlayableMediaAsset.progress should be overridden"),0}set autoplay(r){this._autoplay=r,Mt.isEditor||(this._media.autoplay=r)}set loop(r){this._loop=r}set playTopic(r){this._playTopic&&Qt.unsubscribe(this._id,this._playTopic),this._playTopic=r,this._playTopic&&Qt.subscribe(this._id,this._playTopic,(()=>{Mt.isEditor||this.play(null,!0)}))}set pauseTopic(r){this._pauseTopic&&Qt.unsubscribe(this._id,this._pauseTopic),this._pauseTopic=r,this._pauseTopic&&Qt.subscribe(this._id,this._pauseTopic,(()=>{Mt.isEditor||this.pause(null,!0)}))}set progress(r){console.error("set PlayableMediaAsset.progress should be overridden")}set stopTopic(r){this._stopTopic&&Qt.unsubscribe(this._id,this._stopTopic),this._stopTopic=r,this._stopTopic&&Qt.subscribe(this._id,this._stopTopic,(()=>{Mt.isEditor||this.stop(!0)}))}publishPartyMessage(r,A,b){let C,I=new Uint8Array([r]);C=A?concatenateArrayBuffers(I,A):I,b?Bl.publishInternalBufferMessage(this._idBytes,C,!1,b):Bl.publishInternalBufferMessage(this._idBytes,C)}play(r,A){this.progress=r,this._media.play(),A||(r=new Float64Array([this.progress]),this.publishPartyMessage(Pl,r))}pause(r,A){this._media.pause(),this.progress=r,A||(r=new Float64Array([this.progress]),this.publishPartyMessage(Ml,r))}stop(r){this._media.pause(),this.progress=0,r||this.publishPartyMessage(kl)}_addPartySubscriptions(){Qt.subscribe(this._id,Rt.PEER_READY,(r=>{this._onPeerReady(r.peer)})),Qt.subscribe(this._id,Rt.PARTY_STARTED,(()=>{this._onPartyStarted(Bl.isHost())})),Qt.subscribe(this._id,Rt.SESSION_STARTED,(()=>{this._autoplay&&!this._alreadyAutoplayed&&(this.play(null,!0),this._alreadyAutoplayed=!0)})),Bl.addInternalBufferMessageHandler(this._id,((r,A)=>{let b=new Uint8Array(A,0,1);if(b[0]==Pl){let r=new Float64Array(A.slice(1));this.play(r[0],!0)}else if(b[0]==Ml){let r=new Float64Array(A.slice(1));this.pause(r[0],!0)}else b[0]==kl&&this.stop(!0)}))}_onPeerReady(r){if(!Bl.isHost())return;let A=this.isPlaying?Pl:Ml,b=new Float64Array([this.progress]);this.publishPartyMessage(A,b,r)}_onPartyStarted(r){r||this.stop(!0)}onRemoveFromProject(){this.stop(!0),super.onRemoveFromProject()}}class AudioAsset extends PlayableMediaEntity{constructor(r={}){super(r),this._coneInnerAngle=numberOr$1(r.coneInner,360),this._coneOuterAngle=r.coneOuterAngle||0,this._coneOuterGain=r.coneOuterGain||0,this._distanceModel=r.distanceModel||"inverse",this._maxDistance=numberOr$1(r.maxDistance,100),this._refDistance=numberOr$1(r.refDistance,1),this._rolloffFactor=numberOr$1(r.rolloffFactor,1),this._volume=numberOr$1(r.volume,1),this._createMesh(r.assetId),Mt.isEditor||this._addPartySubscriptions()}_createMesh(A){let b=Qo.getBuffer(A);this._media=new r.PositionalAudio(Yo.getListener()),this._media.setDirectionalCone(this._coneInnerAngle,this._coneOuterAngle,this._coneOuterGain),this._media.setDistanceModel(this._distanceModel),this._media.setLoop(this._loop),this._media.setMaxDistance(this._maxDistance),this._media.setRefDistance(this._refDistance),this._media.setRolloffFactor(this._rolloffFactor),this._media.setVolume(this._volume),this._media.setBuffer(b),this._object.add(this._media)}_getDefaultName(){return super._getDefaultName()||"Audio"}exportParams(){let r=super.exportParams();return r.coneInnerAngle=this._coneInnerAngle,r.coneOuterAngle=this._coneOuterAngle,r.coneOuterGain=this._coneOuterGain,r.distanceModel=this._distanceModel,r.maxDistance=this._maxDistance,r.refDistance=this._refDistance,r.rolloffFactor=this._rolloffFactor,r.volume=this._volume,r}get audio(){return this._media}get coneInnerAngle(){return this._coneInnerAngle}get coneOuterAngle(){return this._coneOuterAngle}get coneOuterGain(){return this._coneOuterGain}get distanceModel(){return this._distanceModel}get isPlaying(){return this._media.isPlaying}get loop(){return super.loop}get maxDistance(){return this._maxDistance}get progress(){return this._media.isPlaying&&(this._media.pause(),this._media.play()),this._media._progress}get refDistance(){return this._refDistance}get rolloffFactor(){return this._rolloffFactor}get volume(){return this._volume}set coneInnerAngle(r){this._coneInnerAngle=r,this._media.setDirectionalCone(r,this._coneOuterAngle,this._coneOuterGain)}set coneOuterAngle(r){this._coneOuterAngle=r,this._media.setDirectionalCone(this._coneInnerAngle,r,this._coneOuterGain)}set coneOuterGain(r){this._coneOuterGain=r,this._media.setDirectionalCone(this._coneInnerAngle,this._coneOuterAngle,r)}set distanceModel(r){this._distanceModel=r,this._media.setDistanceModel(r)}set loop(r){super.loop=r,this._media.setLoop(r)}set maxDistance(r){this._maxDistance=r,this._media.setMaxDistance(r)}set progress(r){null!=r&&(this._media._progress=r||0)}set refDistance(r){this._refDistance=r,this._media.setRefDistance(r)}set rolloffFactor(r){this._rolloffFactor=r,this._media.setRolloffFactor(r)}set volume(r){this._volume=r,this._media.setVolume(r)}play(r,A){this._media.isPlaying&&this._media.pause(),super.play(r,A)}static assetType=kt.AUDIO}new class AudioHandler extends AssetsHandler{constructor(){super(Rt.AUDIO_ADDED,Rt.AUDIO_DELETED,kt.AUDIO)}addNewAsset(r,A,b,C){let I=new AudioAsset(A||{assetId:r});return this.addAsset(I,b,C),I}loadAsset(r,A){if(r.assetId in Qo.library)return A&&this._assets[r.id]?(this._assets[r.id].updateFromParams(r),this._assets[r.id]):this.addNewAsset(r.assetId,r,!0,!0);console.error("Unrecognized asset found")}};class ImageAsset extends AssetEntity{constructor(A={}){super(A),this._createMesh(A.assetId);let b=numberOr$1(A.side,r.DoubleSide);b!=r.DoubleSide&&(this.side=b),this._side=b}_createMesh(r){this._mesh=Qo.cloneMesh(r),this._object.add(this._mesh),this._updateBVH(),this._configureMesh()}_getDefaultName(){return Qo.getAssetName(this._assetId)||"Image"}exportParams(){let r=super.exportParams();return r.side=this._mesh.material.side,r}get side(){return this._mesh.material.side}set side(r){r!=this._side&&(this._materialAlreadyCloned||(this._mesh.material=this._mesh.material.clone(),this._materialAlreadyCloned=!0),this._side=r,this._mesh.material.side=r,this._mesh.material.needsUpdate=!0)}static assetType=kt.IMAGE}new class ImagesHandler extends AssetsHandler{constructor(){super(Rt.IMAGE_ADDED,Rt.IMAGE_DELETED,kt.IMAGE)}addNewAsset(r,A,b,C){let I=new ImageAsset(A||{assetId:r});return this.addAsset(I,b,C),I}loadAsset(r,A){if(r.assetId in Qo.library)return A&&this._assets[r.id]?(this._assets[r.id].updateFromParams(r),this._assets[r.id]):this.addNewAsset(r.assetId,r,!0,!0);console.error("Unrecognized asset found")}};new class LightsHandler extends AssetsHandler{constructor(){super(Rt.LIGHT_ADDED,Rt.LIGHT_DELETED,kt.LIGHT)}};let Rl=new class MaterialsHandler extends AssetsHandler{constructor(){super(Rt.MATERIAL_ADDED,Rt.MATERIAL_DELETED,kt.MATERIAL)}addAsset(r,A,b){super.addAsset(r,A,b),r.editorHelper&&r.editorHelper.undoDispose()}deleteAsset(r,A,b){super.deleteAsset(r,A,b),r.dispose(),r.editorHelper&&r.editorHelper.dispose()}};class ModelAsset extends AssetEntity{constructor(r={}){super(r),this._createMesh(r.assetId)}_createMesh(r){this._mesh=Qo.cloneMesh(r),this._object.add(this._mesh),this._updateBVH(),this._configureMesh()}_configureMesh(){this._mesh&&(this._mesh.renderOrder=this._renderOrder),this._mesh.traverse((A=>{A instanceof r.Mesh&&(A.renderOrder=this._renderOrder)}))}_getDefaultName(){return Qo.getAssetName(this._assetId)||super._getDefaultName()}static assetType=kt.MODEL}new class ModelsHandler extends AssetsHandler{constructor(){super(Rt.MODEL_ADDED,Rt.MODEL_DELETED,kt.MODEL)}addNewAsset(r,A,b,C){let I=new ModelAsset(A||{assetId:r});return this.addAsset(I,b,C),I}loadAsset(r,A){if(r.assetId in Qo.library)return A&&this._assets[r.id]?(this._assets[r.id].updateFromParams(r),this._assets[r.id]):this.addNewAsset(r.assetId,r,!0,!0);console.error("Unrecognized asset found")}};new class ShapesHandler extends AssetsHandler{constructor(){super(Rt.SHAPE_ADDED,Rt.SHAPE_DELETED,kt.SHAPE)}};new class SystemsHandler extends AssetsHandler{constructor(){super(Rt.SYSTEM_ADDED,Rt.SYSTEM_DELETED,kt.SYSTEM)}};new class TextsHandler extends AssetsHandler{constructor(){super(Rt.TEXT_ADDED,Rt.TEXT_DELETED,kt.TEXT)}};let Fl=new class TexturesHandler extends AssetsHandler{constructor(){super(Rt.TEXTURE_ADDED,Rt.TEXTURE_DELETED,kt.TEXTURE)}deleteAsset(r,A,b){super.deleteAsset(r,A,b),r.dispose()}getTextureType(r){return this._assets[r].textureType}getTexturesAssetIds(){let r=new Set;for(let A in this._assets){let b=this._assets[A].assetIds;for(let A of b)r.add(A)}return r}};class VideoAsset extends PlayableMediaEntity{constructor(A={}){super(A),this._side=numberOr$1(A.side,r.DoubleSide),this._createMesh(A.assetId),Mt.isEditor||this._addPartySubscriptions()}_createMesh(A){this._material=new r.MeshBasicMaterial({side:this._side,transparent:!1});let b=Qo.getUrl(A);b&&(this._media=document.createElement("video"),this._media.onloadedmetadata=()=>{let A=new r.VideoTexture(this._media);A.colorSpace=r.SRGBColorSpace;let b=this._media.videoWidth,C=this._media.videoHeight;b>C?(C*=1/b,b=1):(b*=1/C,C=1);let I=new r.PlaneGeometry(b,C);this._material.map=A,this._material.needsUpdate=!0;let x=new r.Mesh(I,this._material);this._object.add(x)},this._media.crossOrigin="anonymous",this._media.src=b,this._media.loop=this._loop,this._updateBVH())}_getDefaultName(){return super._getDefaultName()||"Video"}exportParams(){let r=super.exportParams();return r.side=this._material.side,r}get isPlaying(){return!this._media.paused&&!this._media.ended&&this._media.currentTime>0&&this._media.readyState>2}get loop(){return super.loop}get progress(){return this._media.currentTime}get side(){return this._material.side}get video(){return this._media}set loop(r){super.loop=r,this._media.loop=r}set progress(r){null!=r&&(this._media.currentTime=r||0)}set side(r){r!=this._side&&(this._side=r,this._material.side=r,this._material.needsUpdate=!0)}static assetType=kt.VIDEO}new class VideosHandler extends AssetsHandler{constructor(){super(Rt.VIDEO_ADDED,Rt.VIDEO_DELETED,kt.VIDEO)}addNewAsset(r,A,b,C){let I=new VideoAsset(A||{assetId:r});return this.addAsset(I,b,C),I}loadAsset(r,A){if(r.assetId in Qo.library)return A&&this._assets[r.id]?(this._assets[r.id].updateFromParams(r),this._assets[r.id]):this.addNewAsset(r.assetId,r,!0,!0);console.error("Unrecognized asset found")}};class InternalAssetEntity extends AssetEntity{constructor(r={}){super(r)}onRemoveFromProject(){let r=this.parent;for(;r.constructor.assetType==kt.INTERNAL;)r=r.parent;this.promoteExternalAssets(r,this.children),super.onRemoveFromProject()}promoteExternalAssets(r,A){for(let b of A)b.constructor.assetType==kt.INTERNAL?this.promoteExternalAssets(r,b.children):b.attachTo(r,!0)}static assetType=kt.INTERNAL}const Ll={AVATAR:1,LEFT_CONTROLLER:2,RIGHT_CONTROLLER:4,LEFT_HAND:8,RIGHT_HAND:16,USER_VELOCITY:32,USER_POSITION:64};class PeerController extends InternalAssetEntity{constructor(A={}){A.assetId=PeerController.assetId,super(A),this._velocity=new r.Vector3,this._positionError=new r.Vector3,this._errorFixFrame=30,this._isXR=A.isXR,this._username=A.username||"...",this._displayingUsername=A.displayingUsername,this._xrControllers={},this._xrHands={},this._xrDevices=new Set,this._setup()}_setup(){let A={color:qa.white,fontSize:.06,maxWidth:.5};this._usernameBlock=new r.Object3D;let b=new TextComponent(this._username,A),C=new TextComponent(this._username,A);b.rotateY(Math.PI),b.troikaText.material.side=r.FrontSide,C.troikaText.material.side=r.FrontSide,this._usernameBlock.position.setY(.15),this._usernameBlock.add(b),this._usernameBlock.add(C),this._usernameBlock.frontTextComponent=b,this._usernameBlock.backTextComponent=C,this._displayingUsername&&this._avatar&&this._avatar.object.add(this._usernameBlock)}_updateAvatarData(r,A){if(!this._avatar)return;let b=this._avatar.object;this._isXR&&b.position.fromArray(r,A);let C=r.slice(A+3,A+6);b.rotation.fromArray(C)}_updateVelocity(r,A){if(this._velocity.fromArray(r,A),!this._isXR&&!this._firstPerson){if(!this._avatar)return;let r=this._avatar.object;if(ao[0].copy(this._velocity).setY(0).multiplyScalar(-1),ao[0].length()<.001)return;r.getWorldPosition(ao[1]).add(ao[0]),r.lookAt(ao[1])}}_updatePosition(r,A){this._positionError.fromArray(r,A).sub(this._object.position),this._errorFixFrame=0}exportParams(){let r=super.exportParams();return r.isXR=this._isXR,r.username=this._username,r}get avatar(){return this._avatar}get isXR(){return this._isXR}get username(){return this._username}set avatar(r){this._avatar=r}set isXR(r){this._isXR=r}set username(r){if(this._username==r)return;this._username=r;let A=r=stringWithMaxLength(r||"...",17);this._usernameBlock.frontTextComponent.text=A,this._usernameBlock.backTextComponent.text=A}getController(r){return this._xrControllers[r]}getHand(r){return this._xrHands[r]}getXRDevices(){return this._xrDevices}registerAvatar(r){this._avatar=r,this._displayingUsername&&this._avatar&&this._avatar.object.add(this._usernameBlock)}registerXRController(r,A){this._xrControllers[r]=A,this._xrDevices.add(A)}registerXRHand(r,A){this._xrHands[r]=A,this._xrDevices.add(A)}registerXRDevice(r){this._xrDevices.add(r)}setDisplayingUsername(r){this._displayingUsername!=r&&(this._displayingUsername=r,this._avatar&&(this._displayingUsername?this._avatar.object.add(this._usernameBlock):this._avatar.object.remove(this._usernameBlock)))}setFirstPerson(r){this._firstPerson=r}update(r){this._object.position.addScaledVector(this._velocity,r),this._errorFixFrame<30&&(this._object.position.addScaledVector(this._positionError,.03333333333333333),this._errorFixFrame++)}processMessage(r){let A=new Uint8Array(r.slice(2,3))[0],b=new Float32Array(r.slice(3)),C=0;if(Ll.AVATAR&A&&(this._updateAvatarData(b,C),C+=6),Ll.LEFT_CONTROLLER&A){let r=this._xrControllers[on.LEFT];r&&r.processFromRTC(b,C),C+=6}if(Ll.RIGHT_CONTROLLER&A){let r=this._xrControllers[on.RIGHT];r&&r.processFromRTC(b,C),C+=6}if(Ll.LEFT_HAND&A){let r=this._xrHands[on.LEFT];r&&r.processFromRTC(b,C),C+=6}if(Ll.RIGHT_HAND&A){let r=this._xrHands[on.RIGHT];r&&r.processFromRTC(b,C),C+=6}Ll.USER_VELOCITY&A?(this._updateVelocity(b,C),C+=3):this._velocity.set(0,0,0),Ll.USER_POSITION&A&&(this._updatePosition(b,C),C+=3)}static assetId="ac0ff650-6ad5-4c00-a234-0a320d5a8bef";static assetName="Peer"}il.registerAsset(PeerController),Qo.loadBuiltIn(PeerController);const Ol=new r.Vector3;let Ul;class TextAsset extends AssetEntity{constructor(A={}){super(A),this._fontColor=new r.Color(numberOr$1(A.fontColor,16777215)),this._fontSize=numberOr$1(A.fontSize,.1),this._text=A.text||"Hi :)",this._textAlign=A.textAlign||"left","XR"==Mt.deviceType&&(this.update=this._update)}_createMesh(){this._textComponent=new TextComponent(this._text,{color:this._fontColor,fontSize:this._fontSize,textAlign:this._textAlign})}exportParams(){let r=super.exportParams();return r.fontColor=this._fontColor.getHex(),r.fontSize=this._fontSize,r.text=this._text,r.textAlign=this._textAlign,r}get fontColor(){return this._fontColor.getHex()}get fontSize(){return this._fontSize}get text(){return this._text}get textAlign(){return this._textAlign}set fontColor(r){this._fontColor.set(r),this._textComponent.color=this._fontColor}set fontSize(r){this._fontSize=r,this._textComponent.fontSize=r}set text(r){this._text=r,this._textComponent.text=r}set textAlign(r){this._textAlign=r,this._textComponent.textAlign=r}_update(){if(this._skipFrame)return void this._skipFrame--;Ul!=Mt.renderer.info.render.frame&&(Ul=Mt.renderer.info.render.frame,Mt.camera.getWorldPosition(Ol));let r=this.getWorldPosition().distanceTo(Ol),A=Math.max(...this.getWorldScale().toArray());r>200*(this._fontSize*A)?(this._skipFrame=30,this._textComponent.visible=!1):(this._skipFrame=15,this._textComponent.visible=!0)}static assetType=kt.TEXT}class PlainText extends TextAsset{constructor(r={}){r.assetId=PlainText.assetId,super(r),this._maxWidth=numberOr$1(r.maxWidth,0),this._createMesh()}_createMesh(){this._textComponent=new TextComponent(this._text,{color:this._fontColor,fontSize:this._fontSize,textAlign:this._textAlign,maxWidth:this._maxWidth||Infinity}),this._object.add(this._textComponent),this._configureMesh()}_configureMesh(){this._textComponent&&this._textComponent._updateMaterialOffset(this._renderOrder-2)}_getDefaultName(){return PlainText.assetName}exportParams(){let r=super.exportParams();return r.maxWidth=this._maxWidth,r}get maxWidth(){return this._maxWidth}set maxWidth(r){this._maxWidth=r,this._textComponent.maxWidth=r||Infinity}static assetId="c03485a9-1962-4ce6-9cc6-f61546a0e143";static assetName="Plain Text"}il.registerAsset(PlainText),Qo.loadBuiltIn(PlainText);class TextOverlay extends TextAsset{constructor(A={}){A.assetId=TextOverlay.assetId,super(A),this._backgroundColor=new r.Color(numberOr$1(A.backgroundColor,0)),this._backgroundOpacity=numberOr$1(A.backgroundOpacity,1),this._borderRadius=numberOr$1(A.borderRadius,.1),this._justifyContent=A.justifyContent||"center",this._padding=numberOr$1(A.padding,0),this._width=numberOr$1(A.width,1),this._height=numberOr$1(A.height,1),this._createMesh()}_createMesh(){this._block=new Body({borderRadius:this._borderRadius,height:this._height||"auto",justifyContent:this._justifyContent,materialColor:this._backgroundColor,opacity:this._backgroundOpacity,padding:this._padding,width:this._width||"auto"}),this._textComponent=new TextComponent(this._text,{color:this._fontColor,fontSize:this._fontSize,maxWidth:this._width||Infinity,textAlign:this._textAlign,width:this._width?"100%":"auto"}),this._block.add(this._textComponent),this._object.add(this._block),this._configureMesh()}_configureMesh(){this._block&&this._block._updateMaterialOffset(this._renderOrder-1)}_getDefaultName(){return TextOverlay.assetName}exportParams(){let r=super.exportParams();return r.backgroundColor=this._backgroundColor.getHex(),r.backgroundOpacity=this._backgroundOpacity,r.borderRadius=this._borderRadius,r.height=this._height,r.justifyContent=this._justifyContent,r.padding=this._padding,r.width=this._width,r}get backgroundColor(){return this._backgroundColor.getHex()}get backgroundOpacity(){return this._backgroundOpacity}get borderRadius(){return this._borderRadius}get justifyContent(){return this._justifyContent}get padding(){return this._padding}get height(){return this._height}get width(){return this._width}set backgroundColor(r){this._backgroundColor.set(r),this._block.materialColor=this._backgroundColor}set backgroundOpacity(r){this._backgroundOpacity=r,this._block.opacity=r}set borderRadius(r){this._borderRadius=r,this._block.borderRadius=r}set justifyContent(r){this._justifyContent=r,this._block.justifyContent=r}set padding(r){this._padding=r,this._block.padding=r}set height(r){this._height=r,this._block.height=r||"auto"}set width(r){this._width=r,this._block.width=r||"auto",this._textComponent.maxWidth=r||Infinity,this._textComponent.width=r?"100%":"auto"}static assetId="4feae9c5-95a9-4dd1-b4eb-b52bb47babd9";static assetName="Text Overlay"}il.registerAsset(TextOverlay),Qo.loadBuiltIn(TextOverlay);class Component extends Asset{constructor(r={}){super(r)}supports(r){return!0}static assetType=kt.COMPONENT}class PublishComponent extends Component{constructor(r={}){r.assetId=PublishComponent.assetId,super(r),this._topic=r.topic||"",this._pointerEvent=r.pointerEvent||"click",this._gripEvent=r.gripEvent||"none",this._touchEvent=r.touchEvent||"none"}_getDefaultName(){return PublishComponent.assetName}exportParams(){let r=super.exportParams();return r.topic=this._topic,r.pointerEvent=this._pointerEvent,r.gripEvent=this._gripEvent,r.touchEvent=this._touchEvent,r}get topic(){return this._topic}get pointerEvent(){return this._pointerEvent}get gripEvent(){return this._gripEvent}get touchEvent(){return this._touchEvent}set topic(r){this._topic=r}set pointerEvent(r){this._pointerEvent=r}set gripEvent(r){this._gripEvent=r}set touchEvent(r){this._touchEvent=r}supports(r){return r instanceof AssetEntity}static assetId="2a310a93-3f00-465a-862f-2bf8de118984";static assetName="Publish Component"}il.registerAsset(PublishComponent),Qo.loadBuiltIn(PublishComponent);class Light extends AssetEntity{constructor(r={}){super(r),this._color=numberOr$1(r.color,16777215),this._intensity=numberOr$1(r.intensity,1)}_getDefaultName(){return"Light"}exportParams(){let r=super.exportParams();return r.color=this._light.color.getHex(),r.intensity=this._intensity,r}get color(){return this._color}get intensity(){return this._intensity}set color(r){this._color!=r&&(this._color=r,this._light.color.setHex(r))}set intensity(r){this._intensity!=r&&(this._intensity=r,this._light.intensity=r)}static assetType=kt.LIGHT}class AmbientLight extends Light{constructor(r={}){r.assetId=AmbientLight.assetId,r.visualEdit=!1,super(r),this._createLight()}_createLight(){this._light=new r.AmbientLight(this._color,this._intensity),this._object.add(this._light)}_getDefaultName(){return AmbientLight.assetName}static assetId="7605bff2-8ca3-4a47-b6f7-311d745507de";static assetName="Ambient Light"}il.registerAsset(AmbientLight),Qo.loadBuiltIn(AmbientLight);class Shape extends AssetEntity{constructor(r={}){super(r),this._materialId=r.materialId}_updateGeometry(){console.error("Shape._updateGeometry() should be overridden")}_getMaterial(){let r=il.getAsset(this._materialId);return r?r.material:Ka.defaultMeshMaterial}exportParams(){let r=super.exportParams();return r.materialId=this._materialId,r}get materialId(){return this._materialId}get mesh(){return this._mesh}set materialId(r){this._materialId=r;let A=this._mesh.material,b=this._getMaterial();this._mesh.material=b,A.dispose()}static assetType=kt.SHAPE}class BoxShape extends Shape{constructor(r={}){r.assetId=BoxShape.assetId,super(r),this._width=numberOr$1(r.width,.1),this._height=numberOr$1(r.height,.1),this._depth=numberOr$1(r.depth,.1),this._widthSegments=r.widthSegments||1,this._heightSegments=r.heightSegments||1,this._depthSegments=r.depthSegments||1,this._createMesh()}_createMesh(){let A=new r.BoxGeometry(this._width,this._height,this._depth,this._widthSegments,this._heightSegments,this._depthSegments);this._mesh=new r.Mesh(A,this._getMaterial()),this._object.add(this._mesh),this._updateBVH(),this._configureMesh()}_getDefaultName(){return BoxShape.assetName}_updateGeometry(){let A=this._mesh.geometry,b=new r.BoxGeometry(this._width,this._height,this._depth,this._widthSegments,this._heightSegments,this._depthSegments);this._mesh.geometry=b,A.dispose()}exportParams(){let r=super.exportParams();return r.width=this._width,r.height=this._height,r.depth=this._depth,r.widthSegments=this._widthSegments,r.heightSegments=this._heightSegments,r.depthSegments=this._depthSegments,r}get depth(){return this._depth}get height(){return this._height}get width(){return this._width}get depthSegments(){return this._depthSegments}get heightSegments(){return this._heightSegments}get widthSegments(){return this._widthSegments}set depth(r){this._depth!=r&&(this._depth=r,this._updateGeometry())}set height(r){this._height!=r&&(this._height=r,this._updateGeometry())}set width(r){this._width!=r&&(this._width=r,this._updateGeometry())}set depthSegments(r){this._depthSegments!=r&&(this._depthSegments=r,this._updateGeometry())}set heightSegments(r){this._heightSegments!=r&&(this._heightSegments=r,this._updateGeometry())}set widthSegments(r){this._widthSegments!=r&&(this._widthSegments=r,this._updateGeometry())}static assetId="a6ffffc9-2cd0-4fb7-a7b1-7f334930af51";static assetName="Box"}il.registerAsset(BoxShape),Qo.loadBuiltIn(BoxShape);class CircleShape extends Shape{constructor(r={}){r.assetId=CircleShape.assetId,super(r),this._radius=numberOr$1(r.radius,.1),this._segments=r.segments||32,this._thetaLength=numberOr$1(r.thetaLength,360),this._createMesh()}_createMesh(){let A=this._thetaLength*Math.PI/180,b=new r.CircleGeometry(this._radius,this._segments,0,A);this._mesh=new r.Mesh(b,this._getMaterial()),this._object.add(this._mesh),this._updateBVH(),this._configureMesh()}_getDefaultName(){return CircleShape.assetName}_updateGeometry(){let A=this._thetaLength*Math.PI/180,b=this._mesh.geometry,C=new r.CircleGeometry(this._radius,this._segments,0,A);this._mesh.geometry=C,b.dispose()}exportParams(){let r=super.exportParams();return r.radius=this._radius,r.segments=this._segments,r.thetaLength=this._thetaLength,r}get radius(){return this._radius}get segments(){return this._segments}get thetaLength(){return this._thetaLength}set radius(r){this._radius!=r&&(this._radius=r,this._updateGeometry())}set segments(r){this._segments!=r&&(this._segments=r,this._updateGeometry())}set thetaLength(r){this._thetaLength!=r&&(this._thetaLength=r,this._updateGeometry())}static assetId="0a0c7c21-d834-4a88-9234-0d9b5cf705f6";static assetName="Circle"}il.registerAsset(CircleShape),Qo.loadBuiltIn(CircleShape);class ConeShape extends Shape{constructor(r={}){r.assetId=ConeShape.assetId,super(r),this._height=numberOr$1(r.height,.2),this._radius=numberOr$1(r.radius,.1),this._radialSegments=r.radialSegments||32,this._heightSegments=r.heightSegments||1,this._thetaLength=numberOr$1(r.thetaLength,360),this._openEnded=r.openEnded||!1,this._createMesh()}_createMesh(){let A=this._thetaLength*Math.PI/180,b=new r.ConeGeometry(this._radius,this._height,this._radialSegments,this._heightSegments,this._openEnded,0,A);this._mesh=new r.Mesh(b,this._getMaterial()),this._object.add(this._mesh),this._updateBVH(),this._configureMesh()}_getDefaultName(){return ConeShape.assetName}_updateGeometry(){let A=this._thetaLength*Math.PI/180,b=this._mesh.geometry,C=new r.ConeGeometry(this._radius,this._height,this._radialSegments,this._heightSegments,this._openEnded,0,A);this._mesh.geometry=C,b.dispose()}exportParams(){let r=super.exportParams();return r.height=this._height,r.radius=this._radius,r.radialSegments=this._radialSegments,r.heightSegments=this._heightSegments,r.thetaLength=this._thetaLength,r.openEnded=this._openEnded,r}get height(){return this._height}get radius(){return this._radius}get radialSegments(){return this._radialSegments}get heightSegments(){return this._heightSegments}get thetaLength(){return this._thetaLength}get openEnded(){return this._openEnded}set height(r){this._height!=r&&(this._height=r,this._updateGeometry())}set radius(r){this._radius!=r&&(this._radius=r,this._updateGeometry())}set radialSegments(r){this._radialSegments!=r&&(this._radialSegments=r,this._updateGeometry())}set heightSegments(r){this._heightSegments!=r&&(this._heightSegments=r,this._updateGeometry())}set thetaLength(r){this._thetaLength!=r&&(this._thetaLength=r,this._updateGeometry())}set openEnded(r){this._openEnded!=r&&(this._openEnded=r,this._updateGeometry())}static assetId="42779f01-e2cc-495a-a4b3-b286197fa762";static assetName="Cone"}il.registerAsset(ConeShape),Qo.loadBuiltIn(ConeShape);class CylinderShape extends Shape{constructor(r={}){r.assetId=CylinderShape.assetId,super(r),this._height=numberOr$1(r.height,.2),this._radiusTop=numberOr$1(r.radiusTop,.1),this._radiusBottom=numberOr$1(r.radiusBottom,.1),this._radialSegments=r.radialSegments||32,this._heightSegments=r.heightSegments||1,this._thetaLength=numberOr$1(r.thetaLength,360),this._openEnded=r.openEnded||!1,this._createMesh()}_createMesh(){let A=this._thetaLength*Math.PI/180,b=new r.CylinderGeometry(this._radiusTop,this._radiusBottom,this._height,this._radialSegments,this._heightSegments,this._openEnded,0,A);this._mesh=new r.Mesh(b,this._getMaterial()),this._object.add(this._mesh),this._updateBVH(),this._configureMesh()}_getDefaultName(){return CylinderShape.assetName}_updateGeometry(){let A=this._thetaLength*Math.PI/180,b=this._mesh.geometry,C=new r.CylinderGeometry(this._radiusTop,this._radiusBottom,this._height,this._radialSegments,this._heightSegments,this._openEnded,0,A);this._mesh.geometry=C,b.dispose()}exportParams(){let r=super.exportParams();return r.height=this._height,r.radiusTop=this._radiusTop,r.radiusBottom=this._radiusBottom,r.radialSegments=this._radialSegments,r.heightSegments=this._heightSegments,r.thetaLength=this._thetaLength,r.openEnded=this._openEnded,r}get height(){return this._height}get radiusTop(){return this._radiusTop}get radiusBottom(){return this._radiusBottom}get radialSegments(){return this._radialSegments}get heightSegments(){return this._heightSegments}get thetaLength(){return this._thetaLength}get openEnded(){return this._openEnded}set height(r){this._height!=r&&(this._height=r,this._updateGeometry())}set radiusTop(r){this._radiusTop!=r&&(this._radiusTop=r,this._updateGeometry())}set radiusBottom(r){this._radiusBottom!=r&&(this._radiusBottom=r,this._updateGeometry())}set radialSegments(r){this._radialSegments!=r&&(this._radialSegments=r,this._updateGeometry())}set heightSegments(r){this._heightSegments!=r&&(this._heightSegments=r,this._updateGeometry())}set thetaLength(r){this._thetaLength!=r&&(this._thetaLength=r,this._updateGeometry())}set openEnded(r){this._openEnded!=r&&(this._openEnded=r,this._updateGeometry())}static assetId="f4efc996-0d50-48fe-9313-3c7b1a5c1754";static assetName="Cylinder"}il.registerAsset(CylinderShape),Qo.loadBuiltIn(CylinderShape);class PlaneShape extends Shape{constructor(r={}){r.assetId=PlaneShape.assetId,super(r),this._width=numberOr$1(r.width,.1),this._height=numberOr$1(r.height,.1),this._widthSegments=r.widthSegments||1,this._heightSegments=r.heightSegments||1,this._createMesh()}_createMesh(){let A=new r.PlaneGeometry(this._width,this._height,this._widthSegments,this._heightSegments);this._mesh=new r.Mesh(A,this._getMaterial()),this._object.add(this._mesh),this._updateBVH(),this._configureMesh()}_getDefaultName(){return PlaneShape.assetName}_updateGeometry(){let A=this._mesh.geometry,b=new r.PlaneGeometry(this._width,this._height,this._widthSegments,this._heightSegments);this._mesh.geometry=b,A.dispose()}exportParams(){let r=super.exportParams();return r.width=this._width,r.height=this._height,r.widthSegments=this._widthSegments,r.heightSegments=this._heightSegments,r}get height(){return this._height}get width(){return this._width}get heightSegments(){return this._heightSegments}get widthSegments(){return this._widthSegments}set height(r){this._height!=r&&(this._height=r,this._updateGeometry())}set width(r){this._width!=r&&(this._width=r,this._updateGeometry())}set heightSegments(r){this._heightSegments!=r&&(this._heightSegments=r,this._updateGeometry())}set widthSegments(r){this._widthSegments!=r&&(this._widthSegments=r,this._updateGeometry())}static assetId="936bd538-9cb8-44f5-b21f-6b4a7eccfff4";static assetName="Plane"}il.registerAsset(PlaneShape),Qo.loadBuiltIn(PlaneShape);class PointLight extends Light{constructor(r={}){r.assetId=PointLight.assetId,super(r),this._distance=numberOr$1(r.distance,0),this._decay=numberOr$1(r.decay,2),this._createLight()}_createLight(){this._light=new r.PointLight(this._color,this._intensity,this._distance,this._decay),this._object.add(this._light)}_getDefaultName(){return PointLight.assetName}exportParams(){let r=super.exportParams();return r.distance=this._distance,r.decay=this._decay,r}get distance(){return this._distance}get decay(){return this._decay}set distance(r){this._distance!=r&&(this._distance=r,this._light.distance=r)}set decay(r){this._decay!=r&&(this._decay=r,this._light.decay=r)}static assetId="944a6b29-05d2-47d9-9b33-60e7a3e18b7d";static assetName="Basic Light"}il.registerAsset(PointLight),Qo.loadBuiltIn(PointLight);class RingShape extends Shape{constructor(r={}){r.assetId=RingShape.assetId,super(r),this._innerRadius=numberOr$1(r.innerRadius,.05),this._outerRadius=numberOr$1(r.outerRadius,.1),this._thetaSegments=r.thetaSegments||32,this._phiSegments=r.phiSegments||1,this._thetaLength=numberOr$1(r.thetaLength,360),this._createMesh()}_createMesh(){let A=this._thetaLength*Math.PI/180,b=new r.RingGeometry(this._innerRadius,this._outerRadius,this._thetaSegments,this._phiSegments,0,A);this._mesh=new r.Mesh(b,this._getMaterial()),this._object.add(this._mesh),this._updateBVH(),this._configureMesh()}_getDefaultName(){return RingShape.assetName}_updateGeometry(){let A=this._thetaLength*Math.PI/180,b=this._mesh.geometry,C=new r.RingGeometry(this._innerRadius,this._outerRadius,this._thetaSegments,this._phiSegments,0,A);this._mesh.geometry=C,b.dispose()}exportParams(){let r=super.exportParams();return r.innerRadius=this._innerRadius,r.outerRadius=this._outerRadius,r.thetaSegments=this._thetaSegments,r.phiSegments=this._phiSegments,r.thetaLength=this._thetaLength,r}get innerRadius(){return this._innerRadius}get outerRadius(){return this._outerRadius}get thetaSegments(){return this._thetaSegments}get phiSegments(){return this._phiSegments}get thetaLength(){return this._thetaLength}set innerRadius(r){this._innerRadius!=r&&(this._innerRadius=r,this._updateGeometry())}set outerRadius(r){this._outerRadius!=r&&(this._outerRadius=r,this._updateGeometry())}set thetaSegments(r){this._thetaSegments!=r&&(this._thetaSegments=r,this._updateGeometry())}set phiSegments(r){this._phiSegments!=r&&(this._phiSegments=r,this._updateGeometry())}set thetaLength(r){this._thetaLength!=r&&(this._thetaLength=r,this._updateGeometry())}static assetId="534f29c3-1e85-4510-bb84-459011de6722";static assetName="Ring"}il.registerAsset(RingShape),Qo.loadBuiltIn(RingShape);class SphereShape extends Shape{constructor(r={}){r.assetId=SphereShape.assetId,super(r),this._radius=numberOr$1(r.radius,.1),this._widthSegments=r.widthSegments||32,this._heightSegments=r.heightSegments||16,this._phiLength=numberOr$1(r.phiLength,360),this._thetaLength=numberOr$1(r.thetaLength,180),this._createMesh()}_createMesh(){let A=this._phiLength*Math.PI/180,b=this._thetaLength*Math.PI/180,C=new r.SphereGeometry(this._radius,this._widthSegments,this._heightSegments,0,A,0,b);this._mesh=new r.Mesh(C,this._getMaterial()),this._object.add(this._mesh),this._updateBVH(),this._configureMesh()}_getDefaultName(){return SphereShape.assetName}_updateGeometry(){let A=this._phiLength*Math.PI/180,b=this._thetaLength*Math.PI/180,C=this._mesh.geometry,I=new r.SphereGeometry(this._radius,this._widthSegments,this._heightSegments,0,A,0,b);this._mesh.geometry=I,C.dispose()}exportParams(){let r=super.exportParams();return r.radius=this._radius,r.widthSegments=this._widthSegments,r.heightSegments=this._heightSegments,r.phiLength=this._phiLength,r.thetaLength=this._thetaLength,r}get radius(){return this._radius}get widthSegments(){return this._widthSegments}get heightSegments(){return this._heightSegments}get phiLength(){return this._phiLength}get thetaLength(){return this._thetaLength}set radius(r){this._radius!=r&&(this._radius=r,this._updateGeometry())}set widthSegments(r){this._widthSegments!=r&&(this._widthSegments=r,this._updateGeometry())}set heightSegments(r){this._heightSegments!=r&&(this._heightSegments=r,this._updateGeometry())}set phiLength(r){this._phiLength!=r&&(this._phiLength=r,this._updateGeometry())}set thetaLength(r){this._thetaLength!=r&&(this._thetaLength=r,this._updateGeometry())}static assetId="423c9506-52f4-4725-b848-69913cce2b00";static assetName="Sphere"}il.registerAsset(SphereShape),Qo.loadBuiltIn(SphereShape);class SpotLight extends Light{constructor(r={}){r.intensity=numberOr$1(r.intensity,10),r.assetId=SpotLight.assetId,super(r),this._createLight(r)}_createLight(A){this._angle=numberOr$1(A.angle,60);let b=this._angle*Math.PI/360,C=numberOr$1(A.decay,2),I=numberOr$1(A.distance,0),x=numberOr$1(A.penumbra,.5);this._light=new r.SpotLight(this._color,this._intensity,I,b,x,C),this._light.position.fromArray([0,0,0]),this._light.target.position.fromArray([0,-1,0]),this._light.add(this._light.target),this._object.add(this._light),this.mapId=A.mapId}_getDefaultName(){return SpotLight.assetName}exportParams(){let r=super.exportParams();return r.angle=this._angle,r.decay=this.decay,r.distance=this.distance,r.penumbra=this.penumbra,r.mapId=this._mapId,r}get angle(){return this._angle}get decay(){return this._light.decay}get distance(){return this._light.distance}get mapId(){return this._mapId}get penumbra(){return this._light.penumbra}set angle(r){this._angle=r,r*=Math.PI/360,this._light.angle=r}set decay(r){this._light.decay=r}set distance(r){this._light.distance=r}set mapId(r){let A=this._mapId;this._mapId=r;let b=il.getAsset(r);if(this._light.map=b?b.texture:null,A!=r){if(A){let r=Rt.TEXTURE_RECREATED+":"+A;Qt.unsubscribe(this._id,r)}if(r){let A=Rt.TEXTURE_RECREATED+":"+r;Qt.subscribe(this._id,A,(()=>this.mapId=r))}}}set penumbra(r){this._light.penumbra=r}static assetId="50d0ddbf-571f-4328-922c-a52cf8d27704";static assetName="Spot Light"}il.registerAsset(SpotLight),Qo.loadBuiltIn(SpotLight);class TorusShape extends Shape{constructor(r={}){r.assetId=TorusShape.assetId,super(r),this._radius=numberOr$1(r.radius,.1),this._tube=numberOr$1(r.tube,.05),this._radialSegments=r.radialSegments||16,this._tubularSegments=r.tubularSegments||32,this._arc=numberOr$1(r.arc,360),this._createMesh()}_createMesh(){let A=this._arc*Math.PI/180,b=new r.TorusGeometry(this._radius,this._tube,this._radialSegments,this._tubularSegments,A);this._mesh=new r.Mesh(b,this._getMaterial()),this._object.add(this._mesh),this._updateBVH(),this._configureMesh()}_getDefaultName(){return TorusShape.assetName}_updateGeometry(){let A=this._arc*Math.PI/180,b=this._mesh.geometry,C=new r.TorusGeometry(this._radius,this._tube,this._radialSegments,this._tubularSegments,A);this._mesh.geometry=C,b.dispose()}exportParams(){let r=super.exportParams();return r.radius=this._radius,r.tube=this._tube,r.radialSegments=this._radialSegments,r.tubularSegments=this._tubularSegments,r.arc=this._arc,r}get radius(){return this._radius}get tube(){return this._tube}get radialSegments(){return this._radialSegments}get tubularSegments(){return this._tubularSegments}get arc(){return this._arc}set radius(r){this._radius!=r&&(this._radius=r,this._updateGeometry())}set tube(r){this._tube!=r&&(this._tube=r,this._updateGeometry())}set radialSegments(r){this._radialSegments!=r&&(this._radialSegments=r,this._updateGeometry())}set tubularSegments(r){this._tubularSegments!=r&&(this._tubularSegments=r,this._updateGeometry())}set arc(r){this._arc!=r&&(this._arc=r,this._updateGeometry())}static assetId="6b8bcbf1-49b0-42ce-9d60-9a7db6e425bf";static assetName="Torus"}il.registerAsset(TorusShape),Qo.loadBuiltIn(TorusShape);class DirectionalLight extends Light{constructor(r={}){r.assetId=DirectionalLight.assetId,r.visualEdit=!1,r.position=[0,0,0],r.rotation=[0,0,0],super(r);let A=r.direction||[0,-1,0];this._createLight(),this.direction=A}_createLight(){this._light=new r.DirectionalLight(this._color,this._intensity),this._light.add(this._light.target),this._object.add(this._light)}_getDefaultName(){return DirectionalLight.assetName}exportParams(){let r=super.exportParams();return r.direction=this.direction,r}get direction(){return this._light.target.position.toArray()}set direction(r){this._light.target.position.fromArray(r)}static assetId="495a9c3f-fa4f-4c55-9a38-74f4f34450cc";static assetName="Directional Light"}il.registerAsset(DirectionalLight),Qo.loadBuiltIn(DirectionalLight);class HemisphereLight extends Light{constructor(r={}){r.assetId=HemisphereLight.assetId,r.position=[0,1,0],r.visualEdit=!1,super(r),this._groundColor=numberOr$1(r.groundColor,16777215),this._createLight()}_createLight(){this._light=new r.HemisphereLight(this._color,this._groundColor,this._intensity),this._object.add(this._light)}_getDefaultName(){return HemisphereLight.assetName}exportParams(){let r=super.exportParams();return r.groundColor=this._light.groundColor.getHex(),r}get groundColor(){return this._groundColor}set groundColor(r){this._groundColor!=r&&(this._groundColor=r,this._light.groundColor.setHex(r))}static assetId="1589e804-9177-405f-9598-874cfe00c93c";static assetName="Hemisphere Light"}il.registerAsset(HemisphereLight),Qo.loadBuiltIn(HemisphereLight);class Material extends Asset{constructor(A={}){super(A),this._textureSubscriptions={},this._opacity=numberOr$1(A.opacity,1),this._side=A.side||r.FrontSide,this._transparent=A.transparent||!1}_getDefaultName(){return"Material"}_createMaterial(){console.error("Material._createMaterial() should be overridden")}_setTexture(r,A){let b=this["_"+r+"Id"];this["_"+r+"Id"]=A;let C=il.getAsset(A);if(this._material[r]=C?C.texture:null,this._material.needsUpdate=!0,b!=A){if(b&&b in this._textureSubscriptions&&(this._textureSubscriptions[b].delete(r),0==this._textureSubscriptions[b].size)){let r=Rt.TEXTURE_RECREATED+":"+b;Qt.unsubscribe(this._id,r),delete this._textureSubscriptions[b]}A&&this._subscribeFor(r,A)}}_subscribeFor(r,A){if(!this._textureSubscriptions[A]){let r=Rt.TEXTURE_RECREATED+":"+A;Qt.subscribe(this._id,r,(()=>this._updateRecreatedTextures(A))),this._textureSubscriptions[A]=new Set}this._textureSubscriptions[A].add(r)}_updateRecreatedTextures(r){if(this._textureSubscriptions[r])for(let A of this._textureSubscriptions[r])this._setTexture(A,r)}exportParams(){let r=super.exportParams();return r.opacity=this._material.opacity,r.side=this._material.side,r.transparent=this._material.transparent,r}_updateMaterialParamsWithMaps(r,A){for(let b of A)if(this["_"+b+"Id"]){let A=il.getAsset(this["_"+b+"Id"]);A&&(r[b]=A.texture,this._subscribeFor(b,this["_"+b+"Id"]))}}dispose(){disposeMaterial(this._material)}getMaps(){return[]}getSampleTexture(){return null}get material(){return this._material}get opacity(){return this._opacity}get side(){return this._side}get transparent(){return this._transparent}set opacity(r){this._opacity!=r&&(this._opacity=r,this._material.opacity=r)}set side(r){this._side!=r&&(this._side=r,this._material.side=r,this._material.needsUpdate=!0)}set transparent(r){this._transparent!=r&&(this._transparent=r,this._material.transparent=r,this._material.needsUpdate=!0)}static assetType=kt.MATERIAL}const Nl=["map","alphaMap","envMap"];class BasicMaterial extends Material{constructor(A={}){A.assetId=BasicMaterial.assetId,super(A),this._alphaMapId=A.alphaMapId,this._color=numberOr$1(A.color,4036976),this._combine=A.combine||r.MultiplyOperation,this._envMapId=A.envMapId,this._mapId=A.mapId,this._reflectivity=numberOr$1(A.reflectivity,1),this._refractionRatio=numberOr$1(A.refractionRatio,.98),this._wireframe=A.wireframe||!1,this._createMaterial()}_getDefaultName(){return BasicMaterial.assetName}_createMaterial(){let A={color:this._color,combine:this._combine,reflectivity:this._reflectivity,refractionRatio:this._refractionRatio,side:this._side,transparent:this._transparent,opacity:this._opacity,wireframe:this._wireframe};this._updateMaterialParamsWithMaps(A,Nl),this._material=new r.MeshBasicMaterial(A)}getMaps(){return Nl}getSampleTexture(){return this._material.map}exportParams(){let r=super.exportParams();return r.alphaMapId=this._alphaMapId,r.color=this._color,r.combine=this._combine,r.envMapId=this._envMapId,r.mapId=this._mapId,r.reflectivity=this._reflectivity,r.refractionRatio=this._refractionRatio,r.wireframe=this._wireframe,r}get alphaMapId(){return this._alphaMapId}get color(){return this._color}get combine(){return this._combine}get envMapId(){return this._envMapId}get mapId(){return this._mapId}get reflectivity(){return this._reflectivity}get refractionRatio(){return this._refractionRatio}get wireframe(){return this._wireframe}set alphaMapId(r){this._alphaMapId!=r&&this._setTexture("alphaMap",r)}set color(r){this._color!=r&&(this._color=r,this._material.color.setHex(r))}set combine(r){this._combine!=r&&(this._combine=r,this._material.combine=r,this._material.needsUpdate=!0)}set envMapId(r){this._envMapId!=r&&this._setTexture("envMap",r)}set mapId(r){this._mapId!=r&&this._setTexture("map",r)}set reflectivity(r){this._reflectivity!=r&&(this._reflectivity=r,this._material.reflectivity=r)}set refractionRatio(r){this._refractionRatio!=r&&(this._refractionRatio=r,this._material.refractionRatio=r)}set wireframe(r){this._wireframe!=r&&(this._wireframe=r,this._material.wireframe=r,this._material.needsUpdate=!0)}static assetId="943b7a57-7e8f-4717-9bc6-0ba2637d9e3b";static assetName="Basic Material"}il.registerAsset(BasicMaterial),Qo.loadBuiltIn(BasicMaterial);const Ql=["map","alphaMap","bumpMap","displacementMap","emissiveMap","envMap","metalnessMap","normalMap","roughnessMap"];class StandardMaterial extends Material{constructor(A={}){A.assetId=StandardMaterial.assetId,super(A),this._color=numberOr$1(A.color,4036976),this._alphaMapId=A.alphaMapId,this._bumpMapId=A.bumpMapId,this._bumpScale=numberOr$1(A.bumpScale,1),this._displacementMapId=A.displacementMapId,this._displacementScale=numberOr$1(A.displacementScale,1),this._displacementBias=numberOr$1(A.displacementBias,0),this._emissive=A.emissive||0,this._emissiveMapId=A.emissiveMapId,this._emissiveIntensity=numberOr$1(A.emissiveIntensity,1),this._envMapId=A.envMapId,this._envMapIntensity=numberOr$1(A.envMapIntensity,1),this._flatShading=A.flatShading||!1,this._mapId=A.mapId,this._metalness=numberOr$1(A.metalness,0),this._metalnessMapId=A.metalnessMapId,this._normalMapId=A.normalMapId,this._normalMapType=A.normalMapType||r.TangentSpaceNormalMap,this._normalScale=A.normalScale||[1,1],this._roughness=numberOr$1(A.roughness,1),this._roughnessMapId=A.roughnessMapId,this._wireframe=A.wireframe||!1,this._createMaterial()}_getDefaultName(){return StandardMaterial.assetName}_createMaterial(){let A={color:this._color,bumpScale:this._bumpScale,displacementScale:this._displacementScale,displacementBias:this._displacementBias,emissive:this._emissive,emissiveIntensity:this._emissiveIntensity,envMapIntensity:this._envMapIntensity,flatShading:this._flatShading,metalness:this._metalness,normalMapType:this._normalMapType,opacity:this._opacity,side:this._side,transparent:this._transparent,roughness:this._roughness,wireframe:this._wireframe};this._updateMaterialParamsWithMaps(A,Ql),this._material=new r.MeshStandardMaterial(A),this._material.normalScale.fromArray(this._normalScale)}getMaps(){return Ql}getSampleTexture(){return this._material.map}exportParams(){let r=super.exportParams();return r.alphaMapId=this._alphaMapId,r.bumpMapId=this._bumpMapId,r.bumpScale=this._bumpScale,r.color=this._material.color.getHex(),r.displacementMapId=this._displacementMapId,r.displacementScale=this._displacementScale,r.displacementBias=this._displacementBias,r.emissive=this._material.emissive.getHex(),r.emissiveMapId=this._emissiveMapId,r.emissiveIntensity=this._emissiveIntensity,r.envMapId=this._envMapId,r.envMapIntensity=this._envMapIntensity,r.flatShading=this._flatShading,r.mapId=this._mapId,r.metalness=this._metalness,r.metalnessMapId=this._metalnessMapId,r.normalMapId=this._normalMapId,r.normalMapType=this._normalMapType,r.normalScale=this._normalScale,r.roughness=this._roughness,r.roughnessMapId=this._roughnessMapId,r.wireframe=this._wireframe,r}get alphaMapId(){return this._alphaMapId}get bumpMapId(){return this._bumpMapId}get bumpScale(){return this._bumpScale}get color(){return this._color}get displacementBias(){return this._displacementBias}get displacementMapId(){return this._displacementMapId}get displacementScale(){return this._displacementScale}get emissive(){return this._emissive}get emissiveIntensity(){return this._emissiveIntensity}get emissiveMapId(){return this._emissiveMapId}get envMapId(){return this._envMapId}get envMapIntensity(){return this._envMapIntensity}get flatShading(){return this._flatShading}get mapId(){return this._mapId}get metalness(){return this._metalness}get metalnessMapId(){return this._metalnessMapId}get normalMapId(){return this._normalMapId}get normalMapType(){return this._normalMapType}get normalScale(){return this._normalScale}get roughness(){return this._roughness}get roughnessMapId(){return this._roughnessMapId}get wireframe(){return this._wireframe}set alphaMapId(r){this._alphaMapId!=r&&this._setTexture("alphaMap",r)}set bumpMapId(r){this._bumpMapId!=r&&this._setTexture("bumpMap",r)}set bumpScale(r){this._bumpScale!=r&&(this._bumpScale=r,this._material.bumpScale=r)}set color(r){this._color!=r&&(this._color=r,this._material.color.setHex(r))}set displacementBias(r){this._displacementBias!=r&&(this._displacementBias=r,this._material.displacementBias=r)}set displacementMapId(r){this._displacementMapId!=r&&this._setTexture("displacementMap",r)}set displacementScale(r){this._displacementScale!=r&&(this._displacementScale=r,this._material.displacementScale=r)}set emissive(r){this._emissive!=r&&(this._emissive=r,this._material.emissive.setHex(r))}set emissiveIntensity(r){this._emissiveIntensity!=r&&(this._emissiveIntensity=r,this._material.emissiveIntensity=r)}set emissiveMapId(r){this._emissiveMapId!=r&&this._setTexture("emissiveMap",r)}set envMapId(r){this._envMapId!=r&&this._setTexture("envMap",r)}set envMapIntensity(r){this._envMapIntensity!=r&&(this._envMapIntensity=r,this._material.envMapIntensity=r)}set flatShading(r){this._flatShading!=r&&(this._flatShading=r,this._material.flatShading=r,this._material.needsUpdate=!0)}set mapId(r){this._mapId!=r&&this._setTexture("map",r)}set metalness(r){this._metalness!=r&&(this._metalness=r,this._material.metalness=r)}set metalnessMapId(r){this._metalnessMapId!=r&&this._setTexture("metalnessMap",r)}set normalMapId(r){this._normalMapId!=r&&this._setTexture("normalMap",r)}set normalMapType(r){this._normalMapType!=r&&(this._normalMapType=r,this._material.normalMapType=r,this._material.needsUpdate=!0)}set normalScale(r){this._normalScale=r,this._material.normalScale.fromArray(r)}set roughness(r){this._roughness!=r&&(this._roughness=r,this._material.roughness=r)}set roughnessMapId(r){this._roughnessMapId!=r&&this._setTexture("roughnessMap",r)}set wireframe(r){this._wireframe!=r&&(this._wireframe=r,this._material.wireframe=r,this._material.needsUpdate=!0)}static assetId="a6a1aa81-50a6-4773-aaf5-446d418c9817";static assetName="Standard Material"}il.registerAsset(StandardMaterial),Qo.loadBuiltIn(StandardMaterial);const Hl=["map","alphaMap","bumpMap","displacementMap","emissiveMap","normalMap"];class ToonMaterial extends Material{constructor(A={}){A.assetId=ToonMaterial.assetId,super(A),this._alphaMapId=A.alphaMapId,this._color=numberOr$1(A.color,4036976),this._bumpMapId=A.bumpMapId,this._bumpScale=numberOr$1(A.bumpScale,1),this._displacementMapId=A.displacementMapId,this._displacementScale=numberOr$1(A.displacementScale,1),this._displacementBias=numberOr$1(A.displacementBias,0),this._emissive=A.emissive||0,this._emissiveMapId=A.emissiveMapId,this._emissiveIntensity=numberOr$1(A.emissiveIntensity,1),this._mapId=A.mapId,this._normalMapId=A.normalMapId,this._normalMapType=A.normalMapType||r.TangentSpaceNormalMap,this._normalScale=A.normalScale||[1,1],this._wireframe=A.wireframe||!1,this._createMaterial()}_getDefaultName(){return ToonMaterial.assetName}_createMaterial(){let A={bumpScale:this._bumpScale,color:this._color,displacementScale:this._displacementScale,displacementBias:this._displacementBias,emissive:this._emissive,emissiveIntensity:this._emissiveIntensity,normalMapType:this._normalMapType,opacity:this._opacity,side:this._side,transparent:this._transparent,wireframe:this._wireframe};this._updateMaterialParamsWithMaps(A,Hl),this._material=new r.MeshToonMaterial(A),this._material.normalScale.fromArray(this._normalScale)}getMaps(){return Hl}getSampleTexture(){return this._material.map}exportParams(){let r=super.exportParams();return r.alphaMapId=this._alphaMapId,r.bumpMapId=this._bumpMapId,r.bumpScale=this._bumpScale,r.color=this._material.color.getHex(),r.displacementMapId=this._displacementMapId,r.displacementScale=this._displacementScale,r.displacementBias=this._displacementBias,r.emissive=this._material.emissive.getHex(),r.emissiveMapId=this._emissiveMapId,r.emissiveIntensity=this._emissiveIntensity,r.mapId=this._mapId,r.normalMapId=this._normalMapId,r.normalMapType=this._normalMapType,r.normalScale=this._normalScale,r.wireframe=this._wireframe,r}get alphaMapId(){return this._alphaMapId}get bumpMapId(){return this._bumpMapId}get bumpScale(){return this._bumpScale}get color(){return this._color}get displacementBias(){return this._displacementBias}get displacementMapId(){return this._displacementMapId}get displacementScale(){return this._displacementScale}get emissive(){return this._emissive}get emissiveIntensity(){return this._emissiveIntensity}get emissiveMapId(){return this._emissiveMapId}get mapId(){return this._mapId}get normalMapId(){return this._normalMapId}get normalMapType(){return this._normalMapType}get normalScale(){return this._normalScale}get wireframe(){return this._wireframe}set alphaMapId(r){this._alphaMapId!=r&&this._setTexture("alphaMap",r)}set bumpMapId(r){this._bumpMapId!=r&&this._setTexture("bumpMap",r)}set bumpScale(r){this._bumpScale!=r&&(this._bumpScale=r,this._material.bumpScale=r)}set color(r){this._color!=r&&(this._color=r,this._material.color.setHex(r))}set displacementBias(r){this._displacementBias!=r&&(this._displacementBias=r,this._material.displacementBias=r)}set displacementMapId(r){this._displacementMapId!=r&&this._setTexture("displacementMap",r)}set displacementScale(r){this._displacementScale!=r&&(this._displacementScale=r,this._material.displacementScale=r)}set emissive(r){this._emissive!=r&&(this._emissive=r,this._material.emissive.setHex(r))}set emissiveIntensity(r){this._emissiveIntensity!=r&&(this._emissiveIntensity=r,this._material.emissiveIntensity=r)}set emissiveMapId(r){this._emissiveMapId!=r&&this._setTexture("emissiveMap",r)}set mapId(r){this._mapId!=r&&this._setTexture("map",r)}set normalMapId(r){this._normalMapId!=r&&this._setTexture("normalMap",r)}set normalMapType(r){this._normalMapType!=r&&(this._normalMapType=r,this._material.normalMapType=r,this._material.needsUpdate=!0)}set normalScale(r){this._normalScale=r,this._material.normalScale.fromArray(r)}set wireframe(r){this._wireframe!=r&&(this._wireframe=r,this._material.wireframe=r,this._material.needsUpdate=!0)}static assetId="be461019-0fc2-4c88-bee4-290ee3a585eb";static assetName="Toon Material"}il.registerAsset(ToonMaterial),Qo.loadBuiltIn(ToonMaterial);let Gl={};Qt.subscribe("SYSTEM_MODULE",Rt.COMPONENT_ATTACHED,(r=>{r.componentAssetId in Gl||(Gl[r.componentAssetId]={}),Gl[r.componentAssetId][r.id]=r})),Qt.subscribe("SYSTEM_MODULE",Rt.COMPONENT_DETACHED,(r=>{r.componentAssetId in Gl&&delete Gl[r.componentAssetId][r.id]})),Qt.subscribe("SYSTEM_MODULE",Rt.PROJECT_LOADING,(r=>{r||(Gl={})}));class System extends Asset{constructor(r={}){super(r),this._subscriptionTopics=[]}_getDefaultName(){return"System"}_addSystemSubscriptions(){Qt.subscribe(this._id,Rt.USER_READY,(()=>{this._onUserReady()})),Qt.subscribe(this._id,Rt.PEER_READY,(r=>{this._onPeerReady(r.peer)})),Qt.subscribe(this._id,Rt.PEER_DISCONNECTED,(r=>{this._onPeerDisconnected(r.peer)})),Qt.subscribe(this._id,Rt.PARTY_STARTED,(()=>{this._onPartyStarted(Bl.isHost())})),Qt.subscribe(this._id,Rt.PARTY_ENDED,(()=>{this._onPartyEnded()})),this._subscriptionTopics.push(Rt.USER_READY),this._subscriptionTopics.push(Rt.PEER_READY),this._subscriptionTopics.push(Rt.PARTY_STARTED),this._subscriptionTopics.push(Rt.PARTY_ENDED)}_removeSystemSubscriptions(){for(let r of this._subscriptionTopics)Qt.unsubscribe(this._id,r);this._subscriptionTopics=[]}_listenForComponentAdded(r,A){if(!r||!A)return;let b=Rt.COMPONENT_ADDED+":"+r;Qt.subscribe(this._id,b,(r=>{A(r)})),this._subscriptionTopics.push(b)}_listenForComponentAttached(r,A){if(!r||!A)return;let b=Rt.COMPONENT_ATTACHED+":"+r;if(Qt.subscribe(this._id,b,(r=>{A(r)})),this._subscriptionTopics.push(b),r in Gl)for(let b in Gl[r])A(Gl[r][b])}_listenForComponentDeleted(r,A){if(!r||!A)return;let b=Rt.COMPONENT_DELETED+":"+r;Qt.subscribe(this._id,b,(r=>{A(r)})),this._subscriptionTopics.push(b)}_listenForComponentDetached(r,A){if(!r||!A)return;let b=Rt.COMPONENT_DETACHED+":"+r;Qt.subscribe(this._id,b,(r=>{A(r)})),this._subscriptionTopics.push(b)}_listenForComponentUpdated(r,A){if(!r||!A)return;let b=Rt.COMPONENT_UPDATED+":"+r;Qt.subscribe(this._id,b,(r=>{A(r)})),this._subscriptionTopics.push(b)}_onUserReady(){}_onPeerReady(){}_onPeerDisconnected(){}_onPeerMessage(r,A){}_onPeerBufferMessage(r,A){}_onPartyStarted(){}_onPartyEnded(){}_publishPeerMessage(r,A){Bl.publishInternalMessage(this._id,r,A)}_publishPeerBufferMessage(r,A){Bl.publishInternalBufferMessage(this._idBytes,r,A)}get description(){return console.error("get System.description should be overridden"),""}needsUpdates(){return!1}onAddToProject(){this._addSystemSubscriptions(),Bl.addInternalMessageHandler(this._id,((r,A)=>this._onPeerMessage(r,A))),Bl.addInternalBufferMessageHandler(this._id,((r,A)=>this._onPeerBufferMessage(r,A)))}onRemoveFromProject(){this._removeSystemSubscriptions()}static assetType=kt.SYSTEM}const jl="https://d1a370nemizbjq.cloudfront.net/6a141c79-d6e5-4b0d-aa0d-524a8b9b54a4.glb";class Avatar extends InternalAssetEntity{constructor(A={}){A.assetId=Avatar.assetId,super(A),null==A&&(A={}),this._avatarParent=new r.Object3D,this._avatarUrl=A.avatarUrl||jl,this._verticalOffset=A.verticalOffset||0,this._object.position.setY(this._verticalOffset),this._object.add(this._avatarParent),this._createMesh(this._avatarUrl);let b=il.getSessionAsset(this._parentId);b&&b.registerAvatar&&b.registerAvatar(this)}_createMesh(A){if(/\.glb/.test(A)){(new GLTFLoader).load(A,(r=>{if(r.scene.rotateY(Math.PI),r.scene.children[0].name.includes("AvatarRoot")){let A=new Set;r.scene.traverse((r=>{r.name.toLowerCase().includes("hand")&&A.add(r)})),A.forEach((r=>{r.parent.remove(r)})),r.scene.position.setY(-.65)}this._avatarParent.add(r.scene),this._saveOriginalTransparencyStates(),this._dimensions=3}),(()=>{}),(r=>{console.log(r),A!=jl?this._createMesh(jl):console.error("Can't display default avatar :(")}))}else/\.png$|\.jpg$|\.jpeg$/.test(A)?(new r.TextureLoader).load(A,(A=>{let b=A.image.width,C=A.image.height;if(b>C){let r=.3/b;b=.3,C*=r}else{let r=.3/C;C=.3,b*=r}let I=new r.MeshBasicMaterial({map:A,side:r.DoubleSide,transparent:!0}),x=new r.PlaneGeometry(b,C);x.rotateY(Math.PI);let S=new r.Mesh(x,I);this._avatarParent.add(S),this._saveOriginalTransparencyStates(),this._dimensions=2}),(()=>{}),(()=>{A!=jl?this._createMesh(jl):console.error("Can't display default avatar :(")})):A!=jl?this._createMesh(jl):console.error("Default avatar URL is invalid :(")}_saveOriginalTransparencyStates(){this._avatarParent.traverse((function(A){if(A instanceof r.Mesh&&A.material)if(Array.isArray(A.material))for(let r=0;r<A.material.length;r++){let b=A.material[r];b.userData.transparent=b.transparent,b.userData.opacity=b.opacity}else{let r=A.material;r.userData.transparent=r.transparent,r.userData.opacity=r.opacity}}))}fade(A){this._isFading=!0,this._avatarParent.traverse((function(b){if(b instanceof r.Mesh&&b.material)if(b.renderOrder=Infinity,Array.isArray(b.material))for(let r=0;r<b.material.length;r++){let C=b.material[r];C.transparent||(C.transparent=!0,C.needsUpdate=!0),C.opacity=C.userData.opacity*A}else{let r=b.material;r.transparent||(r.transparent=!0,r.needsUpdate=!0),r.opacity=r.userData.opacity*A}}))}endFade(){this._isFading&&(this._isFading=!1,this._avatarParent.traverse((function(A){if(A instanceof r.Mesh&&A.material)if(Array.isArray(A.material))for(let r=0;r<A.material.length;r++){let b=A.material[r];b.transparent!=b.userData.transparent&&(b.transparent=b.userData.transparent,b.needsUpdate=!0),b.opacity=b.userData.opacity}else{let r=A.material;r.transparent!=r.userData.transparent&&(r.transparent=r.userData.transparent,r.needsUpdate=!0),r.opacity=r.userData.opacity}})))}lookAtLocal(r){this._object.parent&&(ao[0].copy(r),this._object.parent.localToWorld(ao[0]),this._object.lookAt(ao[0]))}updateSourceUrl(r){for(;this._avatarParent.children[0];){let r=this._avatarParent.children[0];this._avatarParent.remove(r),fullDispose(r,!0)}this._avatarUrl=r,this._createMesh(r)}get avatarUrl(){return this._avatarUrl}get verticalOffset(){return this._verticalOffset}set avatarUrl(r){this.updateSourceUrl(r)}set verticalOffset(r){this._verticalOffset=r,this._object.position.setY(r)}displayAvatar(){this._object.add(this._avatarParent)}hideAvatar(){this._object.remove(this._avatarParent)}isDisplayingAvatar(){return this._avatarParent.parent==this._object}exportParams(){let r=super.exportParams();return r.avatarUrl=this._avatarUrl,r.verticalOffset=this._verticalOffset,r}static assetId="8cad6685-035d-416f-b085-7cb05583bb49";static assetName="Avatar"}il.registerAsset(Avatar),Qo.loadBuiltIn(Avatar);class BasicMovement{constructor(A){null==A&&(A={}),this._avatar=A.Avatar,this._userObj=A["User Object"],this._velocity=new r.Vector3,this._verticalVelocity=0,this._worldVelocity=new r.Vector3,this._snapRotationTriggered=!1,this._disabled=!1}_setupMobileFlyingButtons(){this._mobileUp=!1,this._mobileDown=!1;let r=$n.addExtraControlsButton("mobile-flying-up-button","UP"),A=$n.addExtraControlsButton("mobile-flying-down-button","DOWN");r.addEventListener("touchstart",(()=>{this._mobileUp=!0})),r.addEventListener("touchend",(()=>{this._mobileUp=!1})),A.addEventListener("touchstart",(()=>{this._mobileDown=!0})),A.addEventListener("touchend",(()=>{this._mobileDown=!1}))}_moveForward(r,A){ao[0].setFromMatrixColumn(Mt.camera.matrixWorld,0),ao[0].crossVectors(this._userObj.up,ao[0]),ao[0].multiplyScalar(r),this._worldVelocity.add(ao[0]),ao[0].multiplyScalar(A),this._userObj.position.add(ao[0])}_moveRight(r,A){ao[0].setFromMatrixColumn(Mt.camera.matrixWorld,0),ao[0].y=0,ao[0].multiplyScalar(r),this._worldVelocity.add(ao[0]),ao[0].multiplyScalar(A),this._userObj.position.add(ao[0])}_moveUp(r,A){r=this._userObj.scale.y*r,this._worldVelocity.setY(r),ao[0].fromArray([0,r*A,0]),this._userObj.position.add(ao[0])}_snapLeft(){this._userObj.rotateY(Math.PI/8),Qt.publish(this._id,Rt.INTERNAL_UPDATED,{asset:Mt.userController,fields:["rotation"]})}_snapRight(){this._userObj.rotateY(-Math.PI/8),Qt.publish(this._id,Rt.INTERNAL_UPDATED,{asset:Mt.userController,fields:["rotation"]})}disable(){this._disabled=!0}enable(){this._enabled=!0}getWorldVelocity(){return this._worldVelocity}setPerspective(r){this._perspective=r}update(r){"XR"==Mt.deviceType?(this._updatePositionVR(r),this.update=this._updatePositionVR):"POINTER"==Mt.deviceType?(this._updatePosition(r),this.update=this._updatePosition):"TOUCH_SCREEN"==Mt.deviceType&&(this._setupMobileFlyingButtons(),this._updatePositionMobile(r),this.update=this._updatePositionMobile)}_updatePosition(r){if(this._worldVelocity.set(0,0,0),this._disabled||r>1)return;let A=Wo.getMovementSpeed(),b=Wo.isFlyingEnabled(),C=.88*(1-r);this._velocity.x*=C,b&&(this._verticalVelocity*=C),this._velocity.z*=C,Mt.sessionActive&&!Mt.keyboardLock&&(($n.isKeyCodePressed("ArrowUp")||$n.isKeyCodePressed("KeyW"))&&(this._velocity.z+=A/4),($n.isKeyCodePressed("ArrowDown")||$n.isKeyCodePressed("KeyS"))&&(this._velocity.z-=A/4),($n.isKeyCodePressed("ArrowLeft")||$n.isKeyCodePressed("KeyA"))&&(this._velocity.x-=A/4),($n.isKeyCodePressed("ArrowRight")||$n.isKeyCodePressed("KeyD"))&&(this._velocity.x+=A/4),b&&$n.isKeyCodePressed("Space")!=$n.isKeyPressed("Shift")&&!$n.isKeyPressed("Meta")&&(this._verticalVelocity=$n.isKeyCodePressed("Space")?A:-A)),this._velocity.length()>A&&this._velocity.normalize().multiplyScalar(A),this._avatar?(this._moveRight(this._velocity.x,r),ao[1].copy(ao[0]),this._moveForward(this._velocity.z,r),ao[1].add(ao[0]),1!=this._perspective&&ao[1].length()>.001*Wo.getUserScale()&&(ao[1].multiplyScalar(-2).add(this._avatar.object.position),this._avatar.lookAtLocal(ao[1])),b&&this._moveUp(this._verticalVelocity,r)):(this._moveRight(this._velocity.x,r),this._moveForward(this._velocity.z,r)),this._userObj.updateMatrixWorld(!0)}_updatePositionMobile(r){if(this._worldVelocity.set(0,0,0),this._disabled||r>1)return;let A=Wo.getMovementSpeed(),b=Wo.isFlyingEnabled();if(this._velocity.x=0,b&&(this._verticalVelocity*=.88*(1-r)),this._velocity.z=0,Mt.sessionActive&&!Mt.keyboardLock){let r=$n.getJoystickAngle(),C=A*$n.getJoystickDistance();this._velocity.x=C*Math.cos(r),this._velocity.z=C*Math.sin(r),b&&this._mobileUp!=this._mobileDown&&(this._verticalVelocity=this._mobileUp?A:-A)}this._velocity.length()>A&&this._velocity.normalize().multiplyScalar(A),this._avatar?(this._moveRight(this._velocity.x,r),ao[1].copy(ao[0]),this._moveForward(this._velocity.z,r),ao[1].add(ao[0]),1!=this._perspective&&ao[1].length()>.001*Wo.getUserScale()&&(ao[1].multiplyScalar(-2).add(this._avatar.object.position),this._avatar.lookAtLocal(ao[1])),b&&this._moveUp(this._verticalVelocity,r)):(this._moveRight(this._velocity.x,r),this._moveForward(this._velocity.z,r)),this._userObj.updateMatrixWorld(!0)}_updatePositionVR(r){if(this._worldVelocity.set(0,0,0),this._disabled||"AR"==Mt.xrSessionType||r>1)return;let A,b,C=Wo.getMovementSpeed(),I=Wo.isFlyingEnabled(),x=Mt.userController.getHand(on.LEFT),S=x?._handMenu;if(Wo.areJoysticksSwapped()?(A=$n.getXRGamepad(on.RIGHT),b=$n.getXRGamepad(on.LEFT)):(A=$n.getXRGamepad(on.LEFT),b=$n.getXRGamepad(on.RIGHT)),this._velocity.x=0,this._velocity.y=0,this._velocity.z=0,A){let b=A.axes;this._velocity.z=-1*C*b[3],this._velocity.x=C*b[2],this._moveRight(this._velocity.x,r),this._moveForward(this._velocity.z,r)}else if(S?.walkingTool?.owner){let A=S.calculateWalkingDirection();this._worldVelocity.x=A.x*C,this._worldVelocity.z=A.z*C,this._userObj.position.x+=this._worldVelocity.x*r,this._userObj.position.z+=this._worldVelocity.z*r}if(b){let A=b.axes[3],x=b.axes[2];Math.abs(x)>.7?this._snapRotationTriggered||(this._snapRotationTriggered=!0,x>0?this._snapRight():this._snapLeft()):this._snapRotationTriggered=!1,I&&Math.abs(A)>.2&&(this._velocity.y=-1*C*A,this._moveUp(this._velocity.y,r))}else if(S?.open){let A=S.flyingUp-S.flyingDown;I&&A&&(this._velocity.y=C*A,this._moveUp(this._velocity.y,r)),this._snapRotationTriggered?S.snapLeft||S.snapRight||(this._snapRotationTriggered=!1):S.snapLeft?(this._snapRotationTriggered=!0,this._snapLeft()):S.snapRight&&(this._snapRotationTriggered=!0,this._snapRight())}else this._snapRotationTriggered=!1;this._userObj.updateMatrixWorld(!0)}}class XRDevice extends InternalAssetEntity{constructor(r={}){r.assetId||(r.assetId=XRDevice.assetId),super(r),this._ttl=5,this._modelUrl=r.modelUrl,this._modelUrl&&this._loadModelFromUrl(),this._vector3=new A,this._euler=new Tt,this._quaternion=new N,this._registerOwner(r)}_loadModelFromUrl(){(new GLTFLoader).load(this._modelUrl,(r=>{this._modelObject=r.scene,this._object.add(r.scene)}))}_registerOwner(r){let A=il.getSessionAsset(r.parentId);A.registerXRDevice&&A.registerXRDevice(this)}_enableARMask(){this._isAR="AR"==Mt.xrSessionType,this._isAR&&this._setARMask(),Qt.subscribe(this._id,Rt.SESSION_STARTED,(()=>{let r="AR"==Mt.xrSessionType;this._isAR!=r&&(this._isAR=r,r?this._setARMask():this._removeARMask())}))}_setARMask(){this._object.traverse((r=>{r instanceof D&&(r.renderOrder=-Infinity,r.material&&(Array.isArray(r.material)?r.material.forEach((r=>{r.colorWrite=!1})):r.material.colorWrite=!1))}))}_removeARMask(){this._object.traverse((r=>{r instanceof D&&(r.renderOrder=0,r.material&&(Array.isArray(r.material)?r.material.forEach((r=>{r.colorWrite=!0})):r.material.colorWrite=!0))}))}exportParams(){let r=super.exportParams();return r.modelUrl=this._modelUrl,r}isInScene(){return null!=this._object.parent}get modelUrl(){return this._modelUrl}getModelObject(){return this._modelObject}getWorldPosition(){return this._object.getWorldPosition(this._vector3),this._vector3}getWorldRotation(){return this._object.getWorldQuaternion(this._quaternion),this._quaternion.normalize(),this._euler.setFromQuaternion(this._quaternion),this._euler}getWorldQuaternion(){return this._object.getWorldQuaternion(this._quaternion),this._quaternion}set modelUrl(r){this._modelUrl=r}decrementTTL(r){this._ttl-=r,this._ttl<0&&il.deleteAsset(this)}resetTTL(){this._ttl=5}pushDataForRTC(r){let A=this._object.position.toArray(),b=this._object.rotation.toArray();b.pop(),r.push(...A),r.push(...b)}processFromRTC(r,A){this._object.position.fromArray(r,A);let b=r.slice(A+3,A+6);this._object.rotation.fromArray(b)}onAddToProject(){this._live=!0}onRemoveFromProject(){super.onRemoveFromProject(),this._live=!1}static assetId="0a90fe9c-be4d-4298-a896-9bd99abad8e6";static assetName="XR Device"}il.registerAsset(XRDevice),Qo.loadBuiltIn(XRDevice);class XRController extends XRDevice{constructor(r={}){r.assetId=XRController.assetId,super(r);let b=r.controllerModel;if(b&&(this._object.add(b),this._modelObject=b,this._modelUrl=b.motionController.assetUrl),this._handedness=r.handedness,!(this._handedness in on))throw new Error("hand must be LEFT or RIGHT");this._raycasterOrigin=new A,this._raycasterDirection=new A}_registerOwner(r){let A=il.getSessionAsset(r.parentId);A.registerXRController&&A.registerXRController(r.handedness,this)}exportParams(){let r=super.exportParams();return r.handedness=this._handedness,r}addFromTargetRay(r,A,b){let C=$n.getXRController(ln.CONTROLLER,this._handedness,"targetRay"),I=r.object;C&&(C.add(I),A&&I.position.fromArray(A),b&&I.rotation.fromArray(b),r.attachTo(this))}get handedness(){return this._handedness}getTargetRayDirection(){let r=$n.getXRController(ln.CONTROLLER,this._handedness,"targetRay");return r?(r.getWorldDirection(this._raycasterDirection).negate().normalize(),this._raycasterDirection):null}getRaycaster(){let r=$n.getXRController(ln.CONTROLLER,this._handedness,"targetRay");return r?(r.getWorldPosition(this._raycasterOrigin),r.getWorldDirection(this._raycasterDirection).negate().normalize(),new xt(this._raycasterOrigin,this._raycasterDirection,.01,50)):null}isButtonPressed(r){let A=$n.getXRGamepad(this._handedness);return null!=A&&A.buttons[r].pressed}static assetId="c7e118a4-6c74-4e41-bf1d-36f83516e7c3";static assetName="XR Controller"}il.registerAsset(XRController),Qo.loadBuiltIn(XRController);const Vl=new Style({borderRadius:.01,borderWidth:.001,height:.13,justifyContent:"spaceAround",materialColor:qa.defaultMenuBackground,opacity:.7,width:.1}),zl=new Style({borderRadius:.005,borderWidth:5e-4,height:.018,opacity:0,width:.085}),Wl=new Style({color:qa.white,fontSize:.01});let Xl=256,Yl=document.createElement("canvas");Yl.width=Xl,Yl.height=Xl;let Kl=Yl.getContext("2d");function drawArrow(r){r.fillRect(116,72,24,24),r.beginPath(),r.moveTo(128,44),r.lineTo(156,76),r.lineTo(100,76),r.fill()}Kl.fillStyle="#ffffff",Kl.fillRect(0,0,Xl,Xl),Kl.fillStyle="#19b932";for(let r=0;r<4;r++)Kl.translate(128,128),Kl.rotate(r*Math.PI/2),Kl.translate(-128,-128),drawArrow(Kl);Kl.fillRect(0,0,Xl,8),Kl.fillRect(0,248,Xl,8);class HandMenu extends Body{constructor(){super(Vl),this._open=!1,this._createWalkingTool(),this._addButtons(),this._walkingDirection=new r.Vector3,this.onClick=()=>{}}_addButtons(){this.flyingUp=!1,this.flyingDown=!1,this.snapLeft=!1,this.snapRight=!1,this._createMenuButton(),this._createWalkingToolButton(),this._createFlyingButtons(),this._createSnapRotationButtons()}_createMenuButton(){let r=createWideButton("Menu");r.addStyle(zl),r.textComponent.addStyle(Wl),r.onClick=()=>Mt.menuController._openMenu(),r.onTouch=r=>{r.owner.object!=this.parent&&Mt.menuController._openMenu()},this.add(r)}_createWalkingToolButton(){let r=createWideButton("Walking Tool");r.addStyle(zl),r.textComponent.addStyle(Wl),r.onClick=()=>{this.walkingTool.position.set(0,0,.05),this.localToWorld(this.walkingTool.position),this.walkingTool.rotation.set(0,0,0),Ho.object.add(this.walkingTool),Ho.gripInteractable.addChild(this.walkingTool.gripInteractable)},r.onTouch=r=>{r.owner.object!=this.parent&&(this.walkingTool.position.set(0,0,.05),this.localToWorld(this.walkingTool.position),this.walkingTool.rotation.set(0,0,0),Ho.object.add(this.walkingTool),Ho.gripInteractable.addChild(this.walkingTool.gripInteractable))},this.add(r)}_createFlyingButtons(){let r=new Span({height:.018,justifyContent:"spaceBetween",width:.085}),A=[];for(let r of["down","up"]){let b=createWideButton("down"==r?"<":">"),C="flying"+r.substring(0,1).toUpperCase()+r.substring(1);b.addStyle(zl),b.addStyle(new Style({width:.018})),b.rotation.z=Math.PI/2,b.textComponent.addStyle(Wl),b.pointerInteractable.addEventListener("down",(r=>{this[C]=!0,b.pointerInteractable.capture(r.owner)})),b.pointerInteractable.addEventListener("up",(()=>{this[C]=!1})),b.touchInteractable.addEventListener("down",(r=>{r.owner.object!=this.parent&&(this[C]=!0)})),b.touchInteractable.addEventListener("up",(r=>{r.owner.object!=this.parent&&(this[C]=!1)})),A.push(b)}r.add(A[0]);let b=new TextComponent("Fly",Wl);r.add(b),r.add(A[1]),this.add(r)}_createSnapRotationButtons(){let r=new Span({height:.018,justifyContent:"spaceBetween",width:.085}),A=[];for(let r of["left","right"]){let b=createWideButton("left"==r?"<":">"),C="snap"+r.substring(0,1).toUpperCase()+r.substring(1);b.addStyle(zl),b.addStyle(new Style({width:.018})),b.textComponent.addStyle(Wl),b.pointerInteractable.addEventListener("down",(r=>{this[C]=!0,b.pointerInteractable.capture(r.owner)})),b.pointerInteractable.addEventListener("up",(()=>{this[C]=!1})),b.touchInteractable.addEventListener("down",(r=>{r.owner.object!=this.parent&&(this[C]=!0)})),b.touchInteractable.addEventListener("up",(r=>{r.owner.object!=this.parent&&(this[C]=!1)})),A.push(b)}r.add(A[0]);let b=new TextComponent("Rotate",Wl);r.add(b),r.add(A[1]),this.add(r)}_createWalkingTool(){let A=new r.CanvasTexture(Yl);A.repeat.set(4,2),A.offset.set(.5,-.5),A.wrapS=r.RepeatWrapping;let b=new r.SphereGeometry(.05),C=new r.MeshLambertMaterial({map:A,side:r.DoubleSide,transparent:!0});this.walkingTool=new r.Mesh(b,C),this.walkingTool.renderOrder=Infinity,this.walkingToolLabel=new TextComponent("Grab and Point",Wl),this.walkingToolLabel.position.y=.07,this.walkingTool.add(this.walkingToolLabel);let I=new GripInteractable(this.walkingTool);I.addEventListener("down",(r=>{this.walkingTool.owner||(I.capture(r.owner),this.walkingTool.owner=r.owner,this.walkingToolLabel.visible=!1,r.owner.object.attach(this.walkingTool),C.opacity=.5)})),I.addEventListener("up",(r=>{this.walkingTool.owner==r.owner&&(Ho.object.attach(this.walkingTool),this.walkingTool.owner=null,this.walkingToolLabel.visible=!0,C.opacity=1)}))}calculateWalkingDirection(){let r=this.walkingTool.owner.object?.asset?._modelObject?.motionController?.bones;if(r)return r[8].getWorldPosition(ao[0]),r[9].getWorldPosition(this._walkingDirection),this._walkingDirection.sub(ao[0]),this._walkingDirection.normalize(),this._walkingDirection}removeWalkingTool(){this.walkingTool.parent&&this.walkingTool.parent.remove(this.walkingTool),Ho.gripInteractable.removeChild(this.walkingTool.gripInteractable)}update(r){this._opening&&(this._scale+=3*r,this._scale>1&&(this._scale=1,this._opening=!1),this.scale.setScalar(this._scale))}get open(){return this._open}set open(r){this._open!=r&&(r?(this._opening=!0,this._scale=.01,this.scale.setScalar(this._scale)):(this.flyingUp=!1,this.flyingDown=!1,this.snapLeft=!1,this.snapRight=!1),this._open=r)}}const ql=[[5,6,7],[5,6,9],[10,11,12],[10,11,14],[15,16,17],[15,16,19],[20,21,22],[20,21,24]],Zl=new N(.6023779,.6023779,.4015853,.336171);window.trbq=Zl;class XRHand extends XRDevice{constructor(r={}){if(r.assetId=XRHand.assetId,super(r),this._handedness=r.handedness,!(this._handedness in on))throw new Error("hand must be LEFT or RIGHT");this._isTargetRayBased=r.isTargetRayBased;let b=r.controllerModel;b&&(this._object.add(b),this._modelObject=b,this._modelUrl="https://cdn.jsdelivr.net/npm/@webxr-input-profiles/assets@1.0/dist/profiles/generic-hand/"+this._handedness.toLowerCase()+".glb",this._isUsers=!0,this._enableARMask()),this._palmDirection=new A,this._raycasterOrigin=new A,this._raycasterDirection=new A}_registerOwner(r){let A=il.getSessionAsset(r.parentId);A.registerXRHand&&A.registerXRHand(r.handedness,this)}exportParams(){let r=super.exportParams();return r.handedness=this._handedness,r.isTargetRayBased=this._isTargetRayBased,r}addFromTargetRay(r,A,b){let C=$n.getXRController(ln.HAND,this._handedness,"targetRay"),I=r.object;C&&(C.add(I),A&&I.position.fromArray(A),b&&I.rotation.fromArray(b),r.attachTo(this))}get handedness(){return this._handedness}getTargetRayDirection(){let r=$n.getXRController(ln.HAND,this._handedness,"targetRay");return r?(r.getWorldDirection(this._raycasterDirection).negate().normalize(),this._raycasterDirection):null}getRaycaster(){let r=$n.getXRController(ln.HAND,this._handedness,"targetRay");return r?(r.getWorldPosition(this._raycasterOrigin),r.getWorldDirection(this._raycasterDirection).negate().normalize(),new xt(this._raycasterOrigin,this._raycasterDirection,.01,50)):null}getPalmDirection(){return this._isUsers?this._palmDirection.copy(this._modelObject.motionController.palmDirection):this._handedness==on.LEFT?(this._palmDirection.set(.9750661112291139,-.10431964344732528,.1958660688459766),this._object.localToWorld(this._palmDirection).sub(this.getWorldPosition())):(this._palmDirection.set(-.9750665315668015,-.1043194340529684,.19586401335899684),this._object.localToWorld(this._palmDirection).sub(this.getWorldPosition())),this._palmDirection}isButtonPressed(r){return 0==r?this._modelObject.motionController.isPinching:1==r&&this._modelObject.motionController.isGrabbing}processFromRTC(r,A){super.processFromRTC(r,A),this._isTargetRayBased&&this._object.quaternion.multiply(Zl)}_updateHandData(r,A,b){if(!b)return;let C=b.object;C.position.fromArray(r,A);let I=r.slice(A+3,A+6);C.rotation.fromArray(I)}createHandMenu(){this._handMenu||(this._handMenu=new HandMenu,this._isTargetRayBased&&this._handMenu.position.set(0,.05,-.05))}updateHandMenu(r){if(!this._handMenu)return;let A=this._modelObject.motionController.bones,b=!0;for(let r of ql)if(ao[0].subVectors(A[r[0]].position,A[r[1]].position),ao[1].subVectors(A[r[2]].position,A[r[1]].position),ao[0].angleTo(ao[1])<2.6){b=!1;break}if(b&&(this._plane1||(this._plane1=new C,this._plane2=new C),this._plane1.setFromCoplanarPoints(A[0].position,A[6].position,A[11].position),this._plane2.setFromCoplanarPoints(A[0].position,A[2].position,A[6].position),this._plane1.normal.angleTo(this._plane2.normal)>.2?b=!1:(Mt.camera.getWorldPosition(ao[0]).sub(this.getWorldPosition()),this.getPalmDirection().angleTo(ao[0])>.7&&(b=!1))),b!=this._handMenu.open&&(this._handMenu.open=b,this._object[b?"add":"remove"](this._handMenu)),b){let A=this.getPalmDirection().add(this.getWorldPosition());this._handMenu.lookAt(A),this._handMenu.update(r)}}onRemoveFromProject(){super.onRemoveFromProject(),this._handMenu&&this._handMenu.removeWalkingTool()}static assetId="d26f490e-dc3a-4f96-82d4-ab9f3bdb92b2";static assetName="XR Hand"}il.registerAsset(XRHand),Qo.loadBuiltIn(XRHand);const Jl="DigitalBacon:Avatar",$l="DigitalBacon:Username";class UserController extends InternalAssetEntity{constructor(r={}){r.assetId=UserController.assetId,super(r),this._isXR=!1,this._username=localStorage.getItem($l)||function generateRandomUsername(){return String.fromCharCode(97+Math.floor(26*Math.random()))+Math.floor(100*Math.random())}(),this._avatarUrl=localStorage.getItem(Jl)||"https://d1a370nemizbjq.cloudfront.net/6a141c79-d6e5-4b0d-aa0d-524a8b9b54a4.glb",this._avatarFadeUpdateNumber=0,this._xrControllers={},this._xrHands={},this._xrDevices=new Set,this._rtcCounter=0}init(){"XR"==Mt.deviceType&&(this.isXR=!0);let r=Wo.getUserScale();this.scale=[r,r,r],this._setup()}_setup(){"XR"!=Mt.deviceType?(this._avatar=new Avatar({avatarUrl:this._avatarUrl,parentId:this._id,verticalOffset:Mt.cameraFocus.position.y}),Yo.setListenerParent(this._avatar.object)):this._avatar=new Avatar({object:Mt.camera,parentId:this._id,avatarUrl:this._avatarUrl}),this._avatar.parent=this,il.addAsset(this._avatar),this._basicMovement=new BasicMovement({"User Object":this._object,Avatar:this._avatar})}get avatar(){return this._avatar}get isXR(){return this._isXR}get scale(){return super.scale}get username(){return this._username}set avatarUrl(r){localStorage.setItem(Jl,r),this._avatarUrl=r,this._avatar.updateSourceUrl(r),Qt.publish(this._id,Rt.INTERNAL_UPDATED,{asset:this._avatar,fields:["avatarUrl"]})}set isXR(r){this._isXR=r}set scale(r){super.scale=r,Mt.camera.scale.set(1,1,1);let A=Mt.camera.parent;for(;A;)Mt.camera.scale.divide(A.scale),A=A.parent;Mt.camera.near=.1/Mt.camera.scale.x,Mt.camera.far=Math.max(1e3,1e3/Mt.camera.scale.x),Mt.camera.updateProjectionMatrix(),Qt.publish(this._id,Rt.INTERNAL_UPDATED,{asset:this,fields:["scale"]})}set username(r){localStorage.setItem($l,r),this._username=r,Qt.publish(this._id,Rt.USERNAME_UPDATED,this._username)}getController(r){return this._xrControllers[r]}getHand(r){return this._xrHands[r]}getXRDevices(){return this._xrDevices}registerXRController(r,A){this._xrControllers[r]=A,this._xrDevices.add(A)}registerXRHand(r,A){this._xrHands[r]=A,this._xrDevices.add(A)}registerXRDevice(r){this._xrDevices.add(r)}disableBasicMovement(){this._basicMovement.disable()}enableBasicMovement(){this._basicMovement.enable()}getDistanceBetweenHands(){if("XR"!=Mt.deviceType)return;let r=this._xrControllers[on.LEFT],A=this._xrControllers[on.RIGHT];if(!(r&&A||(r=this._xrHands[on.LEFT],A=this._xrHands[on.RIGHT],r&&A)))return;if(!r.isInScene()||!A.isInScene())return;let b=r.getWorldPosition(),C=A.getWorldPosition();return b.distanceTo(C)}getDataForRTC(){let r=0,A=[];return this._rtcCounter++,"XR"==Mt.deviceType?(r+=this._pushAvatarDataForRTC(A),r+=this._pushHandsDataForRTC(A)):this._avatar.isDisplayingAvatar()||(r+=this._pushAvatarDataForRTC(A)),this._basicMovement.getWorldVelocity().length()>=1e-5&&(A.push(...this._basicMovement.getWorldVelocity().toArray()),r+=Ll.USER_VELOCITY),this._rtcCounter%300==0&&(this._object.getWorldPosition(ao[0]),A.push(...ao[0].toArray()),r+=Ll.USER_POSITION),[new Uint8Array([r]).buffer,Float32Array.from(A).buffer]}_pushAvatarDataForRTC(r){let A=Mt.camera.position.toArray(),b=Mt.camera.rotation.toArray();return b.pop(),r.push(...A),r.push(...b),Ll.AVATAR}_pushHandsDataForRTC(r){let A=0;for(let b of["CONTROLLER","HAND"]){let C="CONTROLLER"==b?"_xrControllers":"_xrHands";for(let I of[on.LEFT,on.RIGHT]){let x=this[C][I];x&&x.isInScene()&&(x.pushDataForRTC(r),A+=Ll[I+"_"+b])}}return A}hasChild(r){return r.parent==this._object}exportParams(){let r=super.exportParams();return r.isXR=this._isXR,r.username=this._username,r}_updateAvatar(){if(!this._avatar.isDisplayingAvatar()){let r=[];this._pushAvatarDataForRTC(r);let A=r.slice(3,6);this._avatar.object.rotation.fromArray(A)}let r=el.getControlsUpdateNumber();if(this._avatarFadeUpdateNumber==r)return;this._avatarFadeUpdateNumber=r;let A=el.getCameraDistance();if(A>1.2)return;let b=A-this._avatarFadeCameraDistance;if(Math.abs(b)<1e-11)return;this._avatarFadeCameraDistance=A;let C=Math.max(A,.2);C=(C-.2)/.39999999999999997,0!=C?(this._avatar.isDisplayingAvatar()||(this._basicMovement.setPerspective(3),Qt.publish(this._id,Rt.USER_PERSPECTIVE_CHANGED,3),this._avatar.displayAvatar()),C<1?this._avatar.fade(C):this._avatar.endFade()):this._avatar.isDisplayingAvatar()&&(this._basicMovement.setPerspective(1),Qt.publish(this._id,Rt.USER_PERSPECTIVE_CHANGED,1),this._avatar.hideAvatar())}update(r){"XR"==Mt.deviceType?this._updateHands(r):this._avatar&&this._updateAvatar(),this._basicMovement.update(r)}_getControllerModelUrl(r){if(r&&r.motionController)return r.motionController.assetUrl}_updateHands(r){for(let A in on)this._updateHand(r,ln.CONTROLLER,A),this._updateHand(r,ln.HAND,A)}_updateHand(r,A,b){let C=A==ln.HAND?this._xrHands[b]:this._xrControllers[b],I=$n.getXRControllerModel(A,b),x=$n.getXRInputSource(A,b);if(C&&C._live)x?(C.resetTTL(),A==ln.HAND&&b==on.LEFT&&C.updateHandMenu(r)):C.decrementTTL(r);else if(x&&this._getControllerModelUrl(I))if(C)il.addAsset(C,!1,!0);else{if(0==I.children.length)return;let r=A==ln.HAND?XRHand:XRController,x=$n.getXRController(A,b,"grip"),S=!1;x||(x=$n.getXRController(A,b,"targetRay"),S=!0),C=new r({id:x.uuid,handedness:b,parentId:this._id,controllerModel:I,object:x,isTargetRayBased:S}),il.addAsset(C,!1,!0),A==ln.HAND&&b==on.LEFT&&C.createHandMenu()}}static assetId="ac0ff650-6ad5-4c00-a234-0a320d5a8bef";static assetName="User"}let eh=new UserController;const th="2a310a93-3f00-465a-862f-2bf8de118984";class PublishSystem extends System{constructor(r={}){r.assetId=PublishSystem.assetId,super(r),this._actions={},this._addSubscriptions()}_getDefaultName(){return PublishSystem.assetName}get description(){return"Publishes events when assets are selected"}_addSubscriptions(){Mt.isEditor||(this._listenForComponentAttached(th,(r=>{let A=r.id+":"+r.componentId;if(this._actions[A])return;let b=il.getSessionAsset(r.id),C=il.getSessionAsset(r.componentId),callback=()=>{Qt.publish(this._id,C.topic,{asset:b,userController:eh}),this._publish(C.topic,b.id)};"none"!=C.pointerEvent&&b.pointerInteractable.addEventListener(C.pointerEvent,callback),"none"!=C.gripEvent&&b.gripInteractable.addEventListener(C.gripEvent,callback),"none"!=C.touchEvent&&b.touchInteractable.addEventListener(C.touchEvent,callback),this._actions[A]={callback:callback,pointerEvent:C.pointerEvent,gripEvent:C.gripEvent,touchEvent:C.touchEvent}})),this._listenForComponentDetached(th,(r=>{let A=r.id+":"+r.componentId,b=this._actions[A];if(!b)return;let C=il.getSessionAsset(r.id);"none"!=b.pointerEvent&&C.pointerInteractable.removeEventListener(b.pointerEvent,b.callback),"none"!=b.gripEvent&&C.gripInteractable.removeEventListener(b.gripEvent,b.callback),"none"!=b.touchEvent&&C.touchInteractable.removeEventListener(b.touchEvent,b.callback),delete this._actions[A]})))}_onPeerMessage(r,A){let b=il.getSessionAsset(A.id);Qt.publish(this._id,A.pubSubTopic,{asset:b,userController:r.controller})}_publish(r,A){let b={pubSubTopic:r,id:A};this._publishPeerMessage(b)}static assetId="a94b683c-8176-486a-98fc-b44a8bebae57";static assetName="Publish System"}il.registerAsset(PublishSystem),Qo.loadBuiltIn(PublishSystem);class Texture extends Asset{constructor(A={}){super(A),this._colorSpace=stringOr(A.colorSpace,r.SRGBColorSpace)}_getDefaultName(){return"Texture"}_createTexture(){console.error("Texture._createTexture() should be overridden")}exportParams(){let r=super.exportParams();return r.colorSpace=this._colorSpace,r}_updateTexture(){let r=this._texture;this._createTexture(),setTimeout((()=>{r.dispose()}),20),Qt.publish(this._id,Rt.TEXTURE_RECREATED+":"+this._id)}dispose(){setTimeout((()=>{this._texture.dispose()}),20)}get colorSpace(){return this._colorSpace}get texture(){return this._texture}get previewTexture(){return this._texture}get assetIds(){return console.error("get Texture.assetIds should be overridden"),[]}get textureType(){return console.error("get Texture.textureType should be overridden"),null}set colorSpace(r){this._colorSpace=r,this._texture.colorSpace=r,this._updateTexture()}static assetType=kt.TEXTURE}const sh="BASIC",ih="CUBE";class BasicTexture extends Texture{constructor(A={}){A.assetId=BasicTexture.assetId,super(A),this._image=A.image,this._wrapS=A.wrapS||r.ClampToEdgeWrapping,this._wrapT=A.wrapT||r.ClampToEdgeWrapping,this._repeat=A.repeat||[1,1],this._offset=A.offset||[0,0],this._createTexture()}_getDefaultName(){return BasicTexture.assetName}_createTexture(){this._image?this._texture=Qo.cloneTexture(this._image):this._texture=Ya.blackPixel.clone(),this._texture.wrapS=this._wrapS,this._texture.wrapT=this._wrapT,this._texture.repeat.fromArray(this._repeat),this._texture.offset.fromArray(this._offset),this._texture.needsUpdate=!0,this._texture.colorSpace=this._colorSpace}exportParams(){let r=super.exportParams();return r.image=this._image,r.wrapS=this._texture.wrapS,r.wrapT=this._texture.wrapT,r.repeat=this._texture.repeat.toArray(),r.offset=this._offset,r}get assetIds(){return this._image?[this._image]:[]}get image(){return this._image}get offset(){return this._offset}get repeat(){return this._repeat}get textureType(){return BasicTexture.textureType}get wrapS(){return this._wrapS}get wrapT(){return this._wrapT}set image(r){this._image!=r&&(this._image=r,this._updateTexture())}set offset(r){this._offset=r,this._texture.offset.fromArray(r)}set repeat(r){this._repeat=r,this._texture.repeat.fromArray(r)}set wrapS(r){this._wrapS!=r&&(this._wrapS=r,this._texture.wrapS=r,this._texture.needsUpdate=!0)}set wrapT(r){this._wrapT!=r&&(this._wrapT=r,this._texture.wrapT=r,this._texture.needsUpdate=!0)}static assetId="95f63d4b-06d1-4211-912b-556b6ce7bf5f";static assetName="Basic Texture";static textureType=sh}il.registerAsset(BasicTexture),Qo.loadBuiltIn(BasicTexture);class CubeTexture extends Texture{constructor(A={}){A.assetId=CubeTexture.assetId,super(A),this._images=A.images||[...new Array(6)],this._mapping=A.mapping||r.CubeReflectionMapping,this._createTexture()}_getDefaultName(){return CubeTexture.assetName}_createTexture(){let A=this._images.map((r=>r?Qo.getImage(r):Ya.blackPixel.image));this._validateImageList(A)||(A=Array(6).fill(Ya.blackPixel.image)),this._texture=new r.CubeTexture(A,this._mapping),this._texture.needsUpdate=!0,this._texture.colorSpace=this._colorSpace}_validateImageList(r){let A,b=!0;for(let I of r)if(I!=Ya.blackPixel.image){if(I.width!=I.height)return Qt.publish(this._id,Rt.MENU_NOTIFICATION,{text:"Images must be of same width and height",sustainTime:3}),!1;if(!(C=I.width)||C&C-1)return Qt.publish(this._id,Rt.MENU_NOTIFICATION,{text:"Image lengths must be a power of 2",sustainTime:3}),!1;if(A&&I.width!=A)return Qt.publish(this._id,Rt.MENU_NOTIFICATION,{text:"All images must be the same size",sustainTime:3}),!1;A=I.width}else b=!1;var C;return b}exportParams(){let r=super.exportParams();return r.images=this._images,r.mapping=this._texture.mapping,r}get assetIds(){let r=[];for(let A of this._images)A&&r.push(A);return r}get images(){return[...this._images]}get mapping(){return this._mapping}get previewTexture(){let r=this._images[Go.FRONT];return r?Qo.getTexture(r):Ya.blackPixel}get textureType(){return CubeTexture.textureType}set images(r){let A=!1;for(let b in this._images)this._images[b]!=r[b]&&(this._images[b]=r[b],A=!0);A&&this._updateTexture()}set mapping(r){this._mapping!=r&&(this._mapping=r,this._updateTexture())}static assetId="8f95c544-ff6a-42d3-b1e7-03a1e772b3b2";static assetName="Cube Texture";static textureType=ih}il.registerAsset(CubeTexture),Qo.loadBuiltIn(CubeTexture);const nh="COPY_PASTE",rh="DELETE",ah="EDIT",oh="PLACE",lh="ROTATE",hh="SCALE",dh="TRANSLATE";let ch=new class CopyPasteControlsHandler{constructor(){this._id=uuidv4(),this._assetAlreadyPastedByGrip={},this._copiedAssets={},this._previewAssets={},Qa.registerToolHandler(nh,(r=>this._toolHandler(r))),sn.addUpdateListener((()=>{Object.keys(this._copiedAssets).length>0&&this._clear(),this._assetAlreadyPastedByGrip={}})),Qt.subscribe(this._id,Rt.PROJECT_LOADING,(()=>{Object.keys(this._copiedAssets).length>0&&this._clear(),this._assetAlreadyPastedByGrip={}}))}copy(r,A){this._previewAssets[r]&&this._previewAssets[r].onRemoveFromProject(),this._copiedAssets[r]=A,this._previewAssets[r]=A.editorHelper.preview();let b=this._previewAssets[r].object;A.parent.object.add(b),il.getAsset(r).object.attach(b)}_paste(r){let A=this._previewAssets[r],b=A.object;A.parent.object.attach(b),A.clone(!1,this._copiedAssets[r].visualEdit),il.getAsset(r).object.attach(b),this._assetAlreadyPastedByGrip[r]=!0}_toolHandler(r){let A=r.owner.id;if(!this._copiedAssets[A])return!1;let b=Boolean(this._assetAlreadyPastedByGrip[A]);return r.isPressed!=b&&(r.isPressed?this._paste(A):this._assetAlreadyPastedByGrip[A]=!1),!0}_clear(){for(let r in this._previewAssets)this._previewAssets[r].onRemoveFromProject();this._copiedAssets={},this._previewAssets={}}};const uh={AUDIO:"AUDIO",CUSTOM_ASSET:"CUSTOM_ASSET",IMAGE:"IMAGE",LIGHT:"LIGHT",MODEL:"MODEL",SHAPE:"SHAPE",TEXT:"TEXT",VIDEO:"VIDEO"},ph={glb:"glb",jpg:"jpg",jpeg:"jpeg",js:"js",mp3:"mp3",mp4:"mp4",png:"png",wav:"wav",webm:"webm"};let Ah=new class UploadHandler{constructor(){this._input=document.createElement("input"),this._input.type="file",this._locks=new Set,this._assetIds=[],this._addEventListeners()}_addEventListeners(){this._input.addEventListener("change",(()=>this._upload())),"XR"!=Mt.deviceType&&this._input.addEventListener("click",(r=>{r.stopPropagation()}))}_uploadProjectFile(){this._input.files.length>0&&this._callback&&(this._callback(this._input.files[0]),this._callback=null)}_uploadAssets(){this.uploadFiles(this._input.files,this._callback),this._callback=null}uploadFiles(r,A){let b=uuidv4();this._locks.add(b);for(let b of r){let r=b.name.split(".").pop().toLowerCase();if(r in ph){let C=uuidv4();if("js"==r)this._locks.add(C),Qo.addNewScript(b,(r=>{this._addAcknowledgement(r),this._libraryCallback(r,C,A)}),(()=>{console.log("TODO: Tell user an error occurred"),this._libraryErrorCallback(C,A)}));else{let I;r in Ot?I=kt.IMAGE:r in Ut?I=kt.MODEL:r in Lt?I=kt.AUDIO:r in Nt&&(I=kt.VIDEO),this._locks.add(C),Qo.addNewAsset(b,b.name,I,(r=>{this._libraryCallback(r,C,A)}))}}else console.log("TODO: Tell user invalid filetype, and list valid ones")}this._input.value="",this._locks.delete(b),0==this._locks.size&&(A&&A(this._assetIds),this._assetIds=[])}_addAcknowledgement(r){let A=Qo.getType(r),b=il.getAssetHandler(A).getAssetClass(r);if(b.author||b.license||b.sourceUrl){let A={};A.Asset=b.assetName,A["Asset ID"]=b.assetId,b.author&&(A.Author=b.author),b.license&&(A.License=b.license),b.sourceUrl&&(A["Source URL"]=b.sourceUrl);let C=Wo.getAcknowledgements();for(let b of C)if(b["Asset ID"]==r)return b.Asset=A.Asset,b.Author=A.Author,b.License=A.License,void(b["Source URL"]=A["Source URL"]);Wo.addAcknowledgement(A,!0)}}_libraryCallback(r,A,b){this._assetIds.push(r),this._locks.delete(A),0==this._locks.size&&(b&&b(this._assetIds),this._assetIds=[])}_libraryErrorCallback(r,A){this._locks.delete(r),0==this._locks.size&&(A&&A(this._assetIds),this._assetIds=[])}triggerAssetsUpload(r,A,b){this._callback=r,this._input.multiple=A,this._upload=this._uploadAssets,this._input.accept=b==kt.IMAGE?"image/*":b==kt.MODEL?".glb":b==kt.AUDIO?".mp3,.wav":"","XR"==Mt.deviceType?(el.exitXRSession(),this._input.click()):ba.trigger((()=>this._input.click()))}triggerProjectFileUpload(r){this._callback=r,this._input.multiple=!1,this._input.accept=".zip",this._input.value="",this._upload=this._uploadProjectFile,"XR"==Mt.deviceType?(el.exitXRSession(),this._input.click()):ba.trigger((()=>this._input.click()))}};const gh=new xt,fh=new A,mh=new A,_h=new N,bh={X:new A(1,0,0),Y:new A(0,1,0),Z:new A(0,0,1)},yh={type:"change"},vh={type:"mouseDown",mode:null},Ch={type:"mouseUp",mode:null},wh={type:"objectChange"};class TransformControls extends St{constructor(r,b=null){super(void 0,b);const C=new TransformControlsRoot(this);this._root=C;const I=new TransformControlsGizmo;this._gizmo=I,C.add(I);const x=new TransformControlsPlane;this._plane=x,C.add(x);const S=this;function defineProperty(r,A){let b=A;Object.defineProperty(S,r,{get:function(){return void 0!==b?b:A},set:function(A){b!==A&&(b=A,x[r]=A,I[r]=A,S.dispatchEvent({type:r+"-changed",value:A}),S.dispatchEvent(yh))}}),S[r]=A,x[r]=A,I[r]=A}defineProperty("camera",r),defineProperty("object",void 0),defineProperty("enabled",!0),defineProperty("axis",null),defineProperty("mode","translate"),defineProperty("translationSnap",null),defineProperty("rotationSnap",null),defineProperty("scaleSnap",null),defineProperty("space","world"),defineProperty("size",1),defineProperty("dragging",!1),defineProperty("showX",!0),defineProperty("showY",!0),defineProperty("showZ",!0);const B=new A,D=new A,R=new N,F=new N,Q=new A,H=new N,G=new A,j=new A,V=new A,W=new A;defineProperty("worldPosition",B),defineProperty("worldPositionStart",D),defineProperty("worldQuaternion",R),defineProperty("worldQuaternionStart",F),defineProperty("cameraPosition",Q),defineProperty("cameraQuaternion",H),defineProperty("pointStart",G),defineProperty("pointEnd",j),defineProperty("rotationAxis",V),defineProperty("rotationAngle",0),defineProperty("eye",W),this._offset=new A,this._startNorm=new A,this._endNorm=new A,this._cameraScale=new A,this._parentPosition=new A,this._parentQuaternion=new N,this._parentQuaternionInv=new N,this._parentScale=new A,this._worldScaleStart=new A,this._worldQuaternionInv=new N,this._worldScale=new A,this._positionStart=new A,this._quaternionStart=new N,this._scaleStart=new A,this._getPointer=getPointer.bind(this),this._onPointerDown=onPointerDown.bind(this),this._onPointerHover=onPointerHover.bind(this),this._onPointerMove=onPointerMove.bind(this),this._onPointerUp=onPointerUp.bind(this),null!==b&&this.connect()}connect(){this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointermove",this._onPointerHover),this.domElement.addEventListener("pointerup",this._onPointerUp),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerHover),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.style.touchAction="auto"}getHelper(){return this._root}pointerHover(r){if(void 0===this.object||!0===this.dragging)return;null!==r&&gh.setFromCamera(r,this.camera);const A=intersectObjectWithRay(this._gizmo.picker[this.mode],gh);this.axis=A?A.object.name:null}pointerDown(r){if(void 0!==this.object&&!0!==this.dragging&&(null==r||0===r.button)&&null!==this.axis){null!==r&&gh.setFromCamera(r,this.camera);const A=intersectObjectWithRay(this._plane,gh,!0);A&&(this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),this._positionStart.copy(this.object.position),this._quaternionStart.copy(this.object.quaternion),this._scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this._worldScaleStart),this.pointStart.copy(A.point).sub(this.worldPositionStart)),this.dragging=!0,vh.mode=this.mode,this.dispatchEvent(vh)}}pointerMove(r){const A=this.axis,b=this.mode,C=this.object;let I=this.space;if("scale"===b?I="local":"E"!==A&&"XYZE"!==A&&"XYZ"!==A||(I="world"),void 0===C||null===A||!1===this.dragging||null!==r&&-1!==r.button)return;null!==r&&gh.setFromCamera(r,this.camera);const x=intersectObjectWithRay(this._plane,gh,!0);if(x){if(this.pointEnd.copy(x.point).sub(this.worldPositionStart),"translate"===b)this._offset.copy(this.pointEnd).sub(this.pointStart),"local"===I&&"XYZ"!==A&&this._offset.applyQuaternion(this._worldQuaternionInv),-1===A.indexOf("X")&&(this._offset.x=0),-1===A.indexOf("Y")&&(this._offset.y=0),-1===A.indexOf("Z")&&(this._offset.z=0),"local"===I&&"XYZ"!==A?this._offset.applyQuaternion(this._quaternionStart).divide(this._parentScale):this._offset.applyQuaternion(this._parentQuaternionInv).divide(this._parentScale),C.position.copy(this._offset).add(this._positionStart),this.translationSnap&&("local"===I&&(C.position.applyQuaternion(_h.copy(this._quaternionStart).invert()),-1!==A.search("X")&&(C.position.x=Math.round(C.position.x/this.translationSnap)*this.translationSnap),-1!==A.search("Y")&&(C.position.y=Math.round(C.position.y/this.translationSnap)*this.translationSnap),-1!==A.search("Z")&&(C.position.z=Math.round(C.position.z/this.translationSnap)*this.translationSnap),C.position.applyQuaternion(this._quaternionStart)),"world"===I&&(C.parent&&C.position.add(fh.setFromMatrixPosition(C.parent.matrixWorld)),-1!==A.search("X")&&(C.position.x=Math.round(C.position.x/this.translationSnap)*this.translationSnap),-1!==A.search("Y")&&(C.position.y=Math.round(C.position.y/this.translationSnap)*this.translationSnap),-1!==A.search("Z")&&(C.position.z=Math.round(C.position.z/this.translationSnap)*this.translationSnap),C.parent&&C.position.sub(fh.setFromMatrixPosition(C.parent.matrixWorld))));else if("scale"===b){if(-1!==A.search("XYZ")){let r=this.pointEnd.length()/this.pointStart.length();this.pointEnd.dot(this.pointStart)<0&&(r*=-1),mh.set(r,r,r)}else fh.copy(this.pointStart),mh.copy(this.pointEnd),fh.applyQuaternion(this._worldQuaternionInv),mh.applyQuaternion(this._worldQuaternionInv),mh.divide(fh),-1===A.search("X")&&(mh.x=1),-1===A.search("Y")&&(mh.y=1),-1===A.search("Z")&&(mh.z=1);C.scale.copy(this._scaleStart).multiply(mh),this.scaleSnap&&(-1!==A.search("X")&&(C.scale.x=Math.round(C.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==A.search("Y")&&(C.scale.y=Math.round(C.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==A.search("Z")&&(C.scale.z=Math.round(C.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if("rotate"===b){this._offset.copy(this.pointEnd).sub(this.pointStart);const r=20/this.worldPosition.distanceTo(fh.setFromMatrixPosition(this.camera.matrixWorld));let b=!1;"XYZE"===A?(this.rotationAxis.copy(this._offset).cross(this.eye).normalize(),this.rotationAngle=this._offset.dot(fh.copy(this.rotationAxis).cross(this.eye))*r):"X"!==A&&"Y"!==A&&"Z"!==A||(this.rotationAxis.copy(bh[A]),fh.copy(bh[A]),"local"===I&&fh.applyQuaternion(this.worldQuaternion),fh.cross(this.eye),0===fh.length()?b=!0:this.rotationAngle=this._offset.dot(fh.normalize())*r),("E"===A||b)&&(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this._startNorm.copy(this.pointStart).normalize(),this._endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=this._endNorm.cross(this._startNorm).dot(this.eye)<0?1:-1),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),"local"===I&&"E"!==A&&"XYZE"!==A?(C.quaternion.copy(this._quaternionStart),C.quaternion.multiply(_h.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this._parentQuaternionInv),C.quaternion.copy(_h.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),C.quaternion.multiply(this._quaternionStart).normalize())}this.dispatchEvent(yh),this.dispatchEvent(wh)}}pointerUp(r){null!==r&&0!==r.button||(this.dragging&&null!==this.axis&&(Ch.mode=this.mode,this.dispatchEvent(Ch)),this.dragging=!1,this.axis=null)}dispose(){this.disconnect(),this.traverse((function(r){r.geometry&&r.geometry.dispose(),r.material&&r.material.dispose()}))}attach(r){return this.object=r,this._root.visible=!0,this}detach(){return this.object=void 0,this.axis=null,this._root.visible=!1,this}reset(){this.enabled&&this.dragging&&(this.object.position.copy(this._positionStart),this.object.quaternion.copy(this._quaternionStart),this.object.scale.copy(this._scaleStart),this.dispatchEvent(yh),this.dispatchEvent(wh),this.pointStart.copy(this.pointEnd))}getRaycaster(){return gh}getMode(){return this.mode}setMode(r){this.mode=r}setTranslationSnap(r){this.translationSnap=r}setRotationSnap(r){this.rotationSnap=r}setScaleSnap(r){this.scaleSnap=r}setSize(r){this.size=r}setSpace(r){this.space=r}}function getPointer(r){if(this.domElement.ownerDocument.pointerLockElement)return{x:0,y:0,button:r.button};{const A=this.domElement.getBoundingClientRect();return{x:(r.clientX-A.left)/A.width*2-1,y:-(r.clientY-A.top)/A.height*2+1,button:r.button}}}function onPointerHover(r){if(this.enabled)switch(r.pointerType){case"mouse":case"pen":this.pointerHover(this._getPointer(r))}}function onPointerDown(r){this.enabled&&(document.pointerLockElement||this.domElement.setPointerCapture(r.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.pointerHover(this._getPointer(r)),this.pointerDown(this._getPointer(r)))}function onPointerMove(r){this.enabled&&this.pointerMove(this._getPointer(r))}function onPointerUp(r){this.enabled&&(this.domElement.releasePointerCapture(r.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.pointerUp(this._getPointer(r)))}function intersectObjectWithRay(r,A,b){const C=A.intersectObject(r,!0);for(let r=0;r<C.length;r++)if(C[r].object.visible||b)return C[r];return!1}const Eh=new Tt,Ih=new A(0,1,0),Th=new A(0,0,0),xh=new S,Sh=new N,Bh=new N,Dh=new A,Ph=new S,Mh=new A(1,0,0),kh=new A(0,1,0),Rh=new A(0,0,1),Fh=new A,Lh=new A,Oh=new A;class TransformControlsRoot extends ce{constructor(r){super(),this.isTransformControlsRoot=!0,this.controls=r,this.visible=!1}updateMatrixWorld(r){const A=this.controls;void 0!==A.object&&(A.object.updateMatrixWorld(),null===A.object.parent?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):A.object.parent.matrixWorld.decompose(A._parentPosition,A._parentQuaternion,A._parentScale),A.object.matrixWorld.decompose(A.worldPosition,A.worldQuaternion,A._worldScale),A._parentQuaternionInv.copy(A._parentQuaternion).invert(),A._worldQuaternionInv.copy(A.worldQuaternion).invert()),A.camera.updateMatrixWorld(),A.camera.matrixWorld.decompose(A.cameraPosition,A.cameraQuaternion,A._cameraScale),A.camera.isOrthographicCamera?A.camera.getWorldDirection(A.eye).negate():A.eye.copy(A.cameraPosition).sub(A.worldPosition).normalize(),super.updateMatrixWorld(r)}}class TransformControlsGizmo extends ce{constructor(){super(),this.isTransformControlsGizmo=!0,this.type="TransformControlsGizmo";const r=new H({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),A=new Ce({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),b=r.clone();b.opacity=.15;const C=A.clone();C.opacity=.5;const I=r.clone();I.color.setHex(16711680);const x=r.clone();x.color.setHex(65280);const S=r.clone();S.color.setHex(255);const B=r.clone();B.color.setHex(16711680),B.opacity=.5;const R=r.clone();R.color.setHex(65280),R.opacity=.5;const F=r.clone();F.color.setHex(255),F.opacity=.5;const N=r.clone();N.opacity=.25;const Q=r.clone();Q.color.setHex(16776960),Q.opacity=.25;r.clone().color.setHex(16776960);const G=r.clone();G.color.setHex(7895160);const j=new Bt(0,.04,.1,12);j.translate(0,.05,0);const V=new vt(.08,.08,.08);V.translate(0,.04,0);const W=new Ie;W.setAttribute("position",new at([0,0,0,1,0,0],3));const X=new Bt(.0075,.0075,.5,3);function CircleGeometry(r,A){const b=new Pt(r,.0075,3,64,A*Math.PI*2);return b.rotateY(Math.PI/2),b.rotateX(Math.PI/2),b}X.translate(0,.25,0);const Y={X:[[new D(j,I),[.5,0,0],[0,0,-Math.PI/2]],[new D(j,I),[-.5,0,0],[0,0,Math.PI/2]],[new D(X,I),[0,0,0],[0,0,-Math.PI/2]]],Y:[[new D(j,x),[0,.5,0]],[new D(j,x),[0,-.5,0],[Math.PI,0,0]],[new D(X,x)]],Z:[[new D(j,S),[0,0,.5],[Math.PI/2,0,0]],[new D(j,S),[0,0,-.5],[-Math.PI/2,0,0]],[new D(X,S),null,[Math.PI/2,0,0]]],XYZ:[[new D(new Dt(.1,0),N.clone()),[0,0,0]]],XY:[[new D(new vt(.15,.15,.01),F.clone()),[.15,.15,0]]],YZ:[[new D(new vt(.15,.15,.01),B.clone()),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new D(new vt(.15,.15,.01),R.clone()),[.15,0,.15],[-Math.PI/2,0,0]]]},K={X:[[new D(new Bt(.2,0,.6,4),b),[.3,0,0],[0,0,-Math.PI/2]],[new D(new Bt(.2,0,.6,4),b),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new D(new Bt(.2,0,.6,4),b),[0,.3,0]],[new D(new Bt(.2,0,.6,4),b),[0,-.3,0],[0,0,Math.PI]]],Z:[[new D(new Bt(.2,0,.6,4),b),[0,0,.3],[Math.PI/2,0,0]],[new D(new Bt(.2,0,.6,4),b),[0,0,-.3],[-Math.PI/2,0,0]]],XYZ:[[new D(new Dt(.2,0),b)]],XY:[[new D(new vt(.2,.2,.01),b),[.15,.15,0]]],YZ:[[new D(new vt(.2,.2,.01),b),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new D(new vt(.2,.2,.01),b),[.15,0,.15],[-Math.PI/2,0,0]]]},q={START:[[new D(new Dt(.01,2),C),null,null,null,"helper"]],END:[[new D(new Dt(.01,2),C),null,null,null,"helper"]],DELTA:[[new Be(function TranslateHelperGeometry(){const r=new Ie;return r.setAttribute("position",new at([0,0,0,1,1,1],3)),r}(),C),null,null,null,"helper"]],X:[[new Be(W,C.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new Be(W,C.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new Be(W,C.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},Z={XYZE:[[new D(CircleGeometry(.5,1),G),null,[0,Math.PI/2,0]]],X:[[new D(CircleGeometry(.5,.5),I)]],Y:[[new D(CircleGeometry(.5,.5),x),null,[0,0,-Math.PI/2]]],Z:[[new D(CircleGeometry(.5,.5),S),null,[0,Math.PI/2,0]]],E:[[new D(CircleGeometry(.75,1),Q),null,[0,Math.PI/2,0]]]},J={AXIS:[[new Be(W,C.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},$={XYZE:[[new D(new Ge(.25,10,8),b)]],X:[[new D(new Pt(.5,.1,4,24),b),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new D(new Pt(.5,.1,4,24),b),[0,0,0],[Math.PI/2,0,0]]],Z:[[new D(new Pt(.5,.1,4,24),b),[0,0,0],[0,0,-Math.PI/2]]],E:[[new D(new Pt(.75,.1,2,24),b)]]},ee={X:[[new D(V,I),[.5,0,0],[0,0,-Math.PI/2]],[new D(X,I),[0,0,0],[0,0,-Math.PI/2]],[new D(V,I),[-.5,0,0],[0,0,Math.PI/2]]],Y:[[new D(V,x),[0,.5,0]],[new D(X,x)],[new D(V,x),[0,-.5,0],[0,0,Math.PI]]],Z:[[new D(V,S),[0,0,.5],[Math.PI/2,0,0]],[new D(X,S),[0,0,0],[Math.PI/2,0,0]],[new D(V,S),[0,0,-.5],[-Math.PI/2,0,0]]],XY:[[new D(new vt(.15,.15,.01),F),[.15,.15,0]]],YZ:[[new D(new vt(.15,.15,.01),B),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new D(new vt(.15,.15,.01),R),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new D(new vt(.1,.1,.1),N.clone())]]},te={X:[[new D(new Bt(.2,0,.6,4),b),[.3,0,0],[0,0,-Math.PI/2]],[new D(new Bt(.2,0,.6,4),b),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new D(new Bt(.2,0,.6,4),b),[0,.3,0]],[new D(new Bt(.2,0,.6,4),b),[0,-.3,0],[0,0,Math.PI]]],Z:[[new D(new Bt(.2,0,.6,4),b),[0,0,.3],[Math.PI/2,0,0]],[new D(new Bt(.2,0,.6,4),b),[0,0,-.3],[-Math.PI/2,0,0]]],XY:[[new D(new vt(.2,.2,.01),b),[.15,.15,0]]],YZ:[[new D(new vt(.2,.2,.01),b),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new D(new vt(.2,.2,.01),b),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new D(new vt(.2,.2,.2),b),[0,0,0]]]},se={X:[[new Be(W,C.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new Be(W,C.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new Be(W,C.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]};function setupGizmo(r){const A=new ce;for(const b in r)for(let C=r[b].length;C--;){const I=r[b][C][0].clone(),x=r[b][C][1],S=r[b][C][2],B=r[b][C][3],D=r[b][C][4];I.name=b,I.tag=D,x&&I.position.set(x[0],x[1],x[2]),S&&I.rotation.set(S[0],S[1],S[2]),B&&I.scale.set(B[0],B[1],B[2]),I.updateMatrix();const R=I.geometry.clone();R.applyMatrix4(I.matrix),I.geometry=R,I.renderOrder=Infinity,I.position.set(0,0,0),I.rotation.set(0,0,0),I.scale.set(1,1,1),A.add(I)}return A}this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=setupGizmo(Y)),this.add(this.gizmo.rotate=setupGizmo(Z)),this.add(this.gizmo.scale=setupGizmo(ee)),this.add(this.picker.translate=setupGizmo(K)),this.add(this.picker.rotate=setupGizmo($)),this.add(this.picker.scale=setupGizmo(te)),this.add(this.helper.translate=setupGizmo(q)),this.add(this.helper.rotate=setupGizmo(J)),this.add(this.helper.scale=setupGizmo(se)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}updateMatrixWorld(r){const A="local"===("scale"===this.mode?"local":this.space)?this.worldQuaternion:Bh;this.gizmo.translate.visible="translate"===this.mode,this.gizmo.rotate.visible="rotate"===this.mode,this.gizmo.scale.visible="scale"===this.mode,this.helper.translate.visible="translate"===this.mode,this.helper.rotate.visible="rotate"===this.mode,this.helper.scale.visible="scale"===this.mode;let b=[];b=b.concat(this.picker[this.mode].children),b=b.concat(this.gizmo[this.mode].children),b=b.concat(this.helper[this.mode].children);for(let r=0;r<b.length;r++){const C=b[r];let I;if(C.visible=!0,C.rotation.set(0,0,0),C.position.copy(this.worldPosition),I=this.camera.isOrthographicCamera?(this.camera.top-this.camera.bottom)/this.camera.zoom:this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),C.scale.set(1,1,1).multiplyScalar(I*this.size/4),"helper"!==C.tag){if(C.quaternion.copy(A),"translate"===this.mode||"scale"===this.mode){const r=.99,b=.2;"X"===C.name&&Math.abs(Ih.copy(Mh).applyQuaternion(A).dot(this.eye))>r&&(C.scale.set(1e-10,1e-10,1e-10),C.visible=!1),"Y"===C.name&&Math.abs(Ih.copy(kh).applyQuaternion(A).dot(this.eye))>r&&(C.scale.set(1e-10,1e-10,1e-10),C.visible=!1),"Z"===C.name&&Math.abs(Ih.copy(Rh).applyQuaternion(A).dot(this.eye))>r&&(C.scale.set(1e-10,1e-10,1e-10),C.visible=!1),"XY"===C.name&&Math.abs(Ih.copy(Rh).applyQuaternion(A).dot(this.eye))<b&&(C.scale.set(1e-10,1e-10,1e-10),C.visible=!1),"YZ"===C.name&&Math.abs(Ih.copy(Mh).applyQuaternion(A).dot(this.eye))<b&&(C.scale.set(1e-10,1e-10,1e-10),C.visible=!1),"XZ"===C.name&&Math.abs(Ih.copy(kh).applyQuaternion(A).dot(this.eye))<b&&(C.scale.set(1e-10,1e-10,1e-10),C.visible=!1)}else"rotate"===this.mode&&(Sh.copy(A),Ih.copy(this.eye).applyQuaternion(_h.copy(A).invert()),-1!==C.name.search("E")&&C.quaternion.setFromRotationMatrix(xh.lookAt(this.eye,Th,kh)),"X"===C.name&&(_h.setFromAxisAngle(Mh,Math.atan2(-Ih.y,Ih.z)),_h.multiplyQuaternions(Sh,_h),C.quaternion.copy(_h)),"Y"===C.name&&(_h.setFromAxisAngle(kh,Math.atan2(Ih.x,Ih.z)),_h.multiplyQuaternions(Sh,_h),C.quaternion.copy(_h)),"Z"===C.name&&(_h.setFromAxisAngle(Rh,Math.atan2(Ih.y,Ih.x)),_h.multiplyQuaternions(Sh,_h),C.quaternion.copy(_h)));C.visible=C.visible&&(-1===C.name.indexOf("X")||this.showX),C.visible=C.visible&&(-1===C.name.indexOf("Y")||this.showY),C.visible=C.visible&&(-1===C.name.indexOf("Z")||this.showZ),C.visible=C.visible&&(-1===C.name.indexOf("E")||this.showX&&this.showY&&this.showZ),C.material._color=C.material._color||C.material.color.clone(),C.material._opacity=C.material._opacity||C.material.opacity,C.material.color.copy(C.material._color),C.material.opacity=C.material._opacity,this.enabled&&this.axis&&(C.name===this.axis||this.axis.split("").some((function(r){return C.name===r})))&&(C.material.color.setHex(16776960),C.material.opacity=1)}else C.visible=!1,"AXIS"===C.name?(C.visible=!!this.axis,"X"===this.axis&&(_h.setFromEuler(Eh.set(0,0,0)),C.quaternion.copy(A).multiply(_h),Math.abs(Ih.copy(Mh).applyQuaternion(A).dot(this.eye))>.9&&(C.visible=!1)),"Y"===this.axis&&(_h.setFromEuler(Eh.set(0,0,Math.PI/2)),C.quaternion.copy(A).multiply(_h),Math.abs(Ih.copy(kh).applyQuaternion(A).dot(this.eye))>.9&&(C.visible=!1)),"Z"===this.axis&&(_h.setFromEuler(Eh.set(0,Math.PI/2,0)),C.quaternion.copy(A).multiply(_h),Math.abs(Ih.copy(Rh).applyQuaternion(A).dot(this.eye))>.9&&(C.visible=!1)),"XYZE"===this.axis&&(_h.setFromEuler(Eh.set(0,Math.PI/2,0)),Ih.copy(this.rotationAxis),C.quaternion.setFromRotationMatrix(xh.lookAt(Th,Ih,kh)),C.quaternion.multiply(_h),C.visible=this.dragging),"E"===this.axis&&(C.visible=!1)):"START"===C.name?(C.position.copy(this.worldPositionStart),C.visible=this.dragging):"END"===C.name?(C.position.copy(this.worldPosition),C.visible=this.dragging):"DELTA"===C.name?(C.position.copy(this.worldPositionStart),C.quaternion.copy(this.worldQuaternionStart),fh.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),fh.applyQuaternion(this.worldQuaternionStart.clone().invert()),C.scale.copy(fh),C.visible=this.dragging):(C.quaternion.copy(A),this.dragging?C.position.copy(this.worldPositionStart):C.position.copy(this.worldPosition),this.axis&&(C.visible=-1!==this.axis.search(C.name)))}super.updateMatrixWorld(r)}}class TransformControlsPlane extends D{constructor(){super(new rt(1e5,1e5,2,2),new H({visible:!1,wireframe:!0,side:G,transparent:!0,opacity:.1,toneMapped:!1})),this.isTransformControlsPlane=!0,this.type="TransformControlsPlane"}updateMatrixWorld(r){let A=this.space;switch(this.position.copy(this.worldPosition),"scale"===this.mode&&(A="local"),Fh.copy(Mh).applyQuaternion("local"===A?this.worldQuaternion:Bh),Lh.copy(kh).applyQuaternion("local"===A?this.worldQuaternion:Bh),Oh.copy(Rh).applyQuaternion("local"===A?this.worldQuaternion:Bh),Ih.copy(Lh),this.mode){case"translate":case"scale":switch(this.axis){case"X":Ih.copy(this.eye).cross(Fh),Dh.copy(Fh).cross(Ih);break;case"Y":Ih.copy(this.eye).cross(Lh),Dh.copy(Lh).cross(Ih);break;case"Z":Ih.copy(this.eye).cross(Oh),Dh.copy(Oh).cross(Ih);break;case"XY":Dh.copy(Oh);break;case"YZ":Dh.copy(Fh);break;case"XZ":Ih.copy(Oh),Dh.copy(Lh);break;case"XYZ":case"E":Dh.set(0,0,0)}break;default:Dh.set(0,0,0)}0===Dh.length()?this.quaternion.copy(this.cameraQuaternion):(Ph.lookAt(fh.set(0,0,0),Dh,Ih),this.quaternion.setFromRotationMatrix(Ph)),super.updateMatrixWorld(r)}}const Uh=["translate","rotate","scale"];let Nh=new class TransformControlsHandler{init(r,A,b){this._canvas=r,this._transformControls=new TransformControls(A,this._canvas),this._transformControls.setSize(1.25),this._attachedAssets={},this._peerAttachedAssets={},this._placingObject={},this._preTransformStates={},this._id=uuidv4(),this._objectChangeNumber=0;let C="XR"==Mt.deviceType?ah:null;tr.registerToolHandler(C,(r=>this._toolHandler(r))),"XR"!=Mt.deviceType&&(b.add(this._transformControls.getHelper()),this._addEventListeners()),sn.addUpdateListener((r=>{if(r!=ah)for(let r in this._attachedAssets)this.detach(r)})),Qt.subscribe(this._id,Rt.PARTY_STARTED,(()=>{if(!Bl.isHost())for(let r in this._attachedAssets)this.detach(r)})),Qt.subscribe(this._id,Rt.PEER_CONNECTED,(r=>{for(let A in this._attachedAssets){let b=this._attachedAssets[A],C=!("POINTER"==A||"TOUCH_SCREEN"==A),I=!1;if(C){let r=this._otherOption(Mt.userController,A);b==this._attachedAssets[r]&&(I=!0)}Bl.publishInternalMessage("instance_attached",{id:b.id,assetId:b.assetId,ownerId:A,position:b.position,rotation:b.rotation,isXR:C,twoHandScaling:I},!1,r.peer)}}));for(let r in uh)Qt.subscribe(this._id,r+"_DELETED",(r=>{for(let A in this._attachedAssets)this._attachedAssets[A]==r.asset&&this._detachDeleted(A)})),Qt.subscribe(this._id,Rt.SANITIZE_INTERNALS,(()=>{for(let r in this._attachedAssets){let A=this._attachedAssets[r];A&&(A.object.parent.asset.constructor.assetType==kt.INTERNAL&&this.detach(r))}for(let r in this._peerAttachedAssets){let A=this._peerAttachedAssets[r].asset,b=this._peerAttachedAssets[r].peer;this.detachFromPeer(b,A,{ownerId:r})}})),Qt.subscribe(this._id,r+"_UPDATED",(r=>{for(let A in this._attachedAssets)this._attachedAssets[A]==r.asset&&(r.fields.includes("visualEdit")||r.fields.includes("parentId"))&&("XR"==Mt.deviceType?this._detachDeleted(A):this.detach(A),r.asset.editorHelper&&(r.asset.editorHelper._enableParam("position"),r.asset.editorHelper._enableParam("rotation"),r.asset.editorHelper._enableParam("scale")))}));Qt.subscribe(this._id,Rt.PROJECT_LOADING,(()=>{for(let r in this._attachedAssets)this._detachDeleted(r)})),window.addEventListener("paste",(r=>{this._paste(r)}))}_addEventListeners(){this._transformControls.addEventListener("mouseDown",(()=>{el.disableOrbit();let r=this._attachedAssets[Mt.deviceType];this._preTransformStates[r.id]=r.editorHelper.getObjectTransformation()})),this._transformControls.addEventListener("mouseUp",(()=>{el.enableOrbit();let r=this._attachedAssets[Mt.deviceType],A=r.editorHelper;A.roundAttributes(!0);let b=this._preTransformStates[r.id],C=A.getObjectTransformation();A.setObjectTransformation(b,C,!1,!1,!0)})),this._transformControls.addEventListener("objectChange",(()=>{this._objectChangeNumber++,this._objectChangeNumber%3==0&&this._attachedAssets[Mt.deviceType].editorHelper.roundAttributes()}));let r=document.getElementById("place-button");r.addEventListener("click",(()=>{this._placingObject[Mt.deviceType]=!this._placingObject[Mt.deviceType],this._clearSelected(),this._placingObject[Mt.deviceType]?(r.classList.add("selected"),this._transformControls.detach()):(document.getElementById(this._transformControls.mode+"-button").classList.add("selected"),this._transformControls.attach(this._attachedAssets[Mt.deviceType].object))})),document.getElementById("clone-button").addEventListener("click",(()=>{this._clone()})),document.getElementById("delete-button").addEventListener("click",(()=>{this._delete()})),document.getElementById("close-button").addEventListener("click",(()=>{this.detach()}));for(let r of Uh){let A=document.getElementById(r+"-button");A.addEventListener("click",(()=>{this._clearSelected(),A.classList.add("selected"),this._transformControls.setMode(r),this._placingObject[Mt.deviceType]=!1,this._transformControls.attach(this._attachedAssets[Mt.deviceType].object)}))}window.addEventListener("copy",(r=>{this._copy(r)})),this._canvas.addEventListener("keydown",(r=>{"Backspace"!=r.code||Mt.keyboardLock?"Escape"==r.code&&this.detach():this._delete()}))}_clearSelected(){let r=document.querySelectorAll("#digital-bacon-transform-controls > button");for(let A of r)A.classList.remove("selected")}_copy(r){let A=Mt.deviceType,b=this._attachedAssets[A];if(b){let A="assetId:"+b.assetId+":instanceId:"+b.id;r.clipboardData.setData("text/digitalbacon",A),r.preventDefault()}}_paste(r){Mt.isEditor&&(r.clipboardData.types.indexOf("Files")>=0&&this._pasteFiles(r.clipboardData.files),r.clipboardData.types.indexOf("text/digitalbacon")>=0&&this._pasteDigitalBaconData(r))}_pasteDigitalBaconData(r){let A=r.clipboardData.getData("text/digitalbacon");if(!A.includes("assetId:")||!A.includes(":instanceId:"))return;let[,,,b]=A.split(":"),C=il.getAsset(b),I=il.getSessionAsset(b);if(I){let A=I.clone();C&&!this._isDragging(C)&&this._offsetClone(A),r.preventDefault()}}_pasteFiles(r){Ah.uploadFiles(r,(r=>{Mt.camera.getWorldPosition(ao[0]),Mt.camera.getWorldDirection(ao[1]),ao[1].normalize().multiplyScalar(11/12),ao[0].add(ao[1]);let A=ao[0].toArray();ao[0].set(0,0,-1),ao[1].setY(0).normalize(),ho.setFromUnitVectors(ao[0],ao[1]),lo.setFromQuaternion(ho);let b=lo.toArray();for(let C of r){let r={assetId:C,position:A,rotation:b,visualEdit:!0};il.addNewAsset(C,r)}}))}_clone(r){r=r||Mt.deviceType;let A=this._attachedAssets[r];if(A){let r=A.clone();this._isDragging(A)||this._offsetClone(r)}}_offsetClone(r){let A=r.object;ao[0].fromArray([0,1,0]),ao[1].setFromMatrixColumn(Mt.camera.matrixWorld,0),ao[1].y=0,ao[1].setLength(.2),ao[1].applyAxisAngle(ao[0],-Math.PI/4),A.position.add(ao[1]),r.editorHelper.roundAttributes(!0),r.publishPosition()}_delete(r){r=r||Mt.deviceType;let A=this._attachedAssets[r];A&&(this.detach(r),il.deleteAsset(A))}_checkPlacement(r){let A=r.owner.id,b=r.raycaster;b.firstHitOnly=!0,b.far=Infinity;let C=r.isPressed,I=this._attachedAssets[A],x="XR"==Mt.deviceType?intersectRelevantObjects(b,il.getObjects(),I.object):b.intersectObjects(il.getObjects(),!0);if(x.length>0&&(r.closestPoint=x[0].point,C)){"XR"==Mt.deviceType?I.attachTo(I.parent,!0):(this._clearSelected(),document.getElementById(this._transformControls.mode+"-button").classList.add("selected"),this._transformControls.attach(I.object),this._placingObject[A]=!1);let r=I.editorHelper,b=r.getObjectTransformation();if(r.place(x[0]),"XR"==Mt.deviceType)return void this.detach(A);r.roundAttributes(!0);let C=r.getObjectTransformation();r.setObjectTransformation(b,C,!1,!1,!0)}}_scaleWithTwoHands(){let r=Mt.userController.getDistanceBetweenHands();if(null==r)return;let A,b=r/this._initialScalingDistance;for(let r in this._attachedAssets){A=this._attachedAssets[r];break}A.object.scale.set(b*this._initialScalingValues.x,b*this._initialScalingValues.y,b*this._initialScalingValues.z),this._objectChangeNumber++,this._objectChangeNumber%6==0&&A.editorHelper._publish(["scale"])}_toolHandler(r){return this._twoHandScaling?(this._scaleWithTwoHands(),!0):!("XR"==Mt.deviceType||!this._placingObject[r.owner.id])&&(this._checkPlacement(r),!0)}_otherOption(r,A){let b=il.getAsset(A),C=b.handedness,I=on.otherHand(C),x="XRHand"==b.constructor.name?r.getHand(I):r.getController(I);return x?x.id:null}attach(r,A){let b={instance:r,ownerId:A=A||Mt.deviceType};if(!(Object.keys(this._attachedAssets).length>1)){if(this._attachedAssets[A]=r,"XR"==Mt.deviceType){this._placingObject[A]=!0;let C=this._otherOption(Mt.userController,A);r==this._attachedAssets[C]?(r.attachTo(r.parent,!0),b.twoHandScaling=!0,this._twoHandScaling=!0,this._initialScalingDistance=Mt.userController.getDistanceBetweenHands(),this._initialScalingValues=r.object.scale.clone()):(this._preTransformStates[r.id]=r.editorHelper.getObjectTransformation(),il.getAsset(A).object.attach(r.object),r.editorHelper.makeTranslucent()),b.position=r.position,b.rotation=r.rotation,sl.disable(this._id)}else r.editorHelper._disableParam("position"),r.editorHelper._disableParam("rotation"),r.editorHelper._disableParam("scale"),this._transformControls.attach(r.object),document.getElementById("digital-bacon-transform-controls").classList.remove("hidden"),this._clearSelected(),document.getElementById(this._transformControls.mode+"-button").classList.add("selected");Qt.publish(this._id,Rt.INSTANCE_ATTACHED,b)}}attachToPeer(r,A,b){this._peerAttachedAssets[b.ownerId]={asset:A,peer:r},b.twoHandScaling?(A.attachTo(A.parent,!0),A.position=b.position,A.rotation=b.rotation):(il.getAsset(b.ownerId).object.attach(A.object),A.position=b.position,A.rotation=b.rotation)}detach(r){let A,b,C;r=r||Mt.deviceType;let I=this._attachedAssets[r];if(!I)return;let x={instance:I,ownerId:r};if("XR"==Mt.deviceType){I.attachTo(I.parent,!0);let S=this._otherOption(Mt.userController,r);this._attachedAssets[S]==I?(il.getAsset(S).object.attach(I.object),x.twoHandScaling=!0,this._twoHandScaling=!1):(I.editorHelper.returnTransparency(),A=I.editorHelper,A.roundAttributes(!0),b=this._preTransformStates[I.id],C=A.getObjectTransformation()),x.position=I.position,x.rotation=I.rotation,1==Object.keys(this._attachedAssets).length&&sl.enable(this._id)}else I.editorHelper._enableParam("position"),I.editorHelper._enableParam("rotation"),I.editorHelper._enableParam("scale");delete this._attachedAssets[r],this._placingObject[r]=!1,this._transformControls.detach(),document.getElementById("digital-bacon-transform-controls").classList.add("hidden"),Qt.publish(this._id,Rt.INSTANCE_DETACHED,x),A&&b&&C&&A.setObjectTransformation(b,C,!1,!1,!0)}detachFromPeer(r,A,b){if(delete this._peerAttachedAssets[b.ownerId],b.twoHandScaling){let C=this._otherOption(r.controller,b.ownerId);il.getAsset(C).object.attach(A.object),A.position=b.position,A.rotation=b.rotation}else A.attachTo(A.parent,!0),b.position&&(A.position=b.position),b.rotation&&(A.rotation=b.rotation)}_detachDeleted(r){let A=this._attachedAssets[r];if(A){if("XR"==Mt.deviceType){let b=this._otherOption(Mt.userController,r);if(this._attachedAssets[b]==A)this._twoHandScaling=!1;else{A.attachTo(A.parent),A.editorHelper.returnTransparency();let r=this._preTransformStates[A.id],b=A.editorHelper;for(let b in r)A.object[b].fromArray(r[b]);b._publish(["position","rotation","scale"])}1==Object.keys(this._attachedAssets).length&&sl.enable(this._id)}else{this._transformControls.detach(),document.getElementById("digital-bacon-transform-controls").classList.add("hidden");let r=this._preTransformStates[A.id],b=A.editorHelper;for(let b in r)A.object[b].fromArray(r[b]);b._publish(["position","rotation","scale"])}delete this._attachedAssets[r],this._placingObject[r]=!1}}initiateDrag(){let r=$n.getPointerPosition(),A={x:r.x,y:r.y,button:0},b=this._transformControls._plane;b.axis="XYZ",b.updateMatrixWorld(),b.axis=null,this._transformControls.axis="XYZ",this._transformControls.pointerDown(A)}_isDragging(r){return r?this._transformControls.dragging&&r.object==this.getObject():this._transformControls.dragging}getObject(){return this._transformControls.object}};let Qh=new class PlaceHandler{constructor(){this._id=uuidv4(),this._controllerAlreadyPressed={},this._grabbedAssets={},tr.registerToolHandler(oh,(r=>this._toolHandler(r))),sn.addUpdateListener((()=>{Object.keys(this._grabbedAssets).length>0&&this._clear(),this._controllerAlreadyPressed={}})),Qt.subscribe(this._id,Rt.PROJECT_LOADING,(()=>{Object.keys(this._grabbedAssets).length>0&&this._clear(),this._controllerAlreadyPressed={}}))}grab(r,A){this._grabbedAssets[r]&&this._resetAsset(r);for(let r in this._grabbedAssets)this._grabbedAssets[r].asset==A&&this._resetAsset(r);let b={asset:A,ownerId:r,preState:A.editorHelper.getObjectTransformation()};this._grabbedAssets[r]=b,this._controllerAlreadyPressed[r]=!0,A.editorHelper._disableParam("position"),A.editorHelper._disableParam("rotation"),A.editorHelper._disableParam("scale")}_checkPlacement(r,A){let b=r.owner.id,C=this._grabbedAssets[b],I=C.asset,x=I.editorHelper,S=r.raycaster;S.firstHitOnly=!0,S.far=Infinity;let B=intersectRelevantObjects(S,il.getObjects(),I.object);if(B.length>0){r.closestPoint=B[0].point,x.place(B[0]);let I=x.getObjectTransformation();A?(x.roundAttributes(!0),x.setObjectTransformation(C.preState,I,!1,!1,!0),x._enableParam("position"),x._enableParam("rotation"),x._enableParam("scale"),delete this._grabbedAssets[b]):x.setObjectTransformation(C.preState,I,!1,!0,!0)}else x._updateParameter("position",C.preState.position,!1,!0,null,!0),x._updateParameter("rotation",C.preState.rotation,!1,!0,null,!0)}_toolHandler(r){let A=r.owner.id;if(!this._grabbedAssets[A])return!1;let b=!1;return r.isPressed!=this._controllerAlreadyPressed[A]&&(this._controllerAlreadyPressed[A]=r.isPressed,r.isPressed&&(b=!0)),this._checkPlacement(r,b),!0}_resetAsset(r){let A=this._grabbedAssets[r];A.asset.position=A.preState.position,A.asset.rotation=A.preState.rotation,A.asset.editorHelper._publish(["position","rotation"]),delete this._grabbedAssets[r]}_clear(){for(let r in this._grabbedAssets)this._resetAsset(r);this._grabbedAssets={}}};let Hh=new class RotateHandler{constructor(){this._id=uuidv4(),this._heldAssets={},this._quaternion=new N,this._euler1=new Tt,this._euler2=new Tt,sn.addUpdateListener((()=>{for(let r in this._heldAssets){let A=this._heldAssets[r];A.preTransformState&&this.detach(A.ownerId)}})),Qt.subscribe(this._id,Rt.PARTY_STARTED,(()=>{Bl.isHost()||(this._heldAssets={})})),Qt.subscribe(this._id,Rt.PEER_CONNECTED,(r=>{for(let A in this._heldAssets){let b=this._heldAssets[A],C=b.asset;b.preTransformState&&Bl.publishInternalMessage("instance_attached",{id:C.id,assetId:C.assetId,ownerId:A,type:"rotate",rotation:b.rotationDifference,isXR:!0},!1,r.peer)}}));for(let r in uh)Qt.subscribe(this._id,r+"_DELETED",(r=>{for(let A in this._heldAssets){let b=this._heldAssets[A];if(b.asset==r.asset){let r=b.asset.editorHelper,C=b.asset.object;b.preTransformState&&(C.quaternion.fromArray(b.preTransformState),C.rotation.setFromQuaternion(C.quaternion),r._publish(["rotation"])),delete this._heldAssets[A]}}})),Qt.subscribe(this._id,r+"_UPDATED",(r=>{for(let A in this._heldAssets){let b=this._heldAssets[A];if(b.asset==r.asset){let C=b.asset.editorHelper,I=b.asset.object;r.fields.includes("visualEdit")&&b.preTransformState&&(I.quaternion.fromArray(b.preTransformState),I.rotation.setFromQuaternion(I.quaternion),C._publish(["rotation"])),delete this._heldAssets[A]}}}));Qt.subscribe(this._id,Rt.PROJECT_LOADING,(()=>{for(let r in this._heldAssets)delete this._heldAssets[r]}))}_otherOwner(r,A){for(let b in this._heldAssets)if(this._heldAssets[b].asset==A&&b!=r)return b}attach(r,A,b){let C=this._otherOwner(r,A);if(C)this._swapToOwner(r,C,b);else{let C={asset:A,ownerId:r};if(b)C.rotationDifference=b,this._subscribeToDeletionOf(r);else{let b=A.getWorldQuaternion();C.preTransformState=A.object.quaternion.toArray(),C.rotationDifference=il.getAsset(r).getWorldQuaternion().conjugate().multiply(b).toArray()}this._heldAssets[r]=C}if(!b){let b=this._heldAssets[r];Qt.publish(this._id,Rt.INSTANCE_ATTACHED,{instance:A,ownerId:r,type:"rotate",rotation:b.rotationDifference})}}detach(r,A){let b=this._heldAssets[r];if(b)if(delete this._heldAssets[r],A)b.asset.setRotationFromQuaternion(A),this._unsubscribeFromDeletionOf(r);else{A=this._update(b);let C=b.asset.editorHelper;this._quaternion.fromArray(b.preTransformState),this._euler1.setFromQuaternion(this._quaternion),this._quaternion.fromArray(A),this._euler2.setFromQuaternion(this._quaternion);let I=this._euler1.toArray(),x=this._euler2.toArray();C._updateParameter("rotation",x,!1,!1,I,!0),Qt.publish(this._id,Rt.INSTANCE_DETACHED,{instance:b.asset,ownerId:r,type:"rotate",rotation:A})}}update(){for(let r in this._heldAssets){let A=this._heldAssets[r];this._update(A)}}_update(r){if(!r)return;let A=il.getAsset(r.ownerId);if(!A)return;let b=A.getWorldQuaternion();this._quaternion.fromArray(r.rotationDifference);let C=b.multiply(this._quaternion);if(r.asset.parent){r.asset.parent.object.getWorldQuaternion(this._quaternion).conjugate(),this._quaternion.multiply(C)}return r.asset.setRotationFromQuaternion(this._quaternion.toArray()),this._quaternion.toArray()}_swapToOwner(r,A,b){let C=this._heldAssets[A];if(C.ownerId=r,this._heldAssets[r]=C,delete this._heldAssets[A],b)C.rotationDifference=b,this._unsubscribeFromDeletionOf(A),this._subscribeToDeletionOf(r);else{let A=C.asset.getWorldQuaternion();C.rotationDifference=il.getAsset(r).getWorldQuaternion().conjugate().multiply(A).toArray()}}_subscribeToDeletionOf(r){let A=il.getSessionAsset(r),b="INTERNAL_DELETED:"+A.assetId+":"+A.id;Qt.subscribe(this._id,b,(r=>{for(let A in this._heldAssets)r.asset.id==A&&delete this._heldAssets[A]}))}_unsubscribeFromDeletionOf(r){let A=il.getSessionAsset(r),b="INTERNAL_DELETED:"+A.assetId+":"+A.id;Qt.unsubscribe(this._id,b)}};let Gh=new class ScaleHandler{constructor(){this._id=uuidv4(),this._heldAssets={},sn.addUpdateListener((()=>{for(let r in this._heldAssets){let A=this._heldAssets[r];A.preTransformState&&this.detach(A.ownerId)}})),Qt.subscribe(this._id,Rt.PARTY_STARTED,(()=>{Bl.isHost()||(this._heldAssets={})})),Qt.subscribe(this._id,Rt.PEER_CONNECTED,(r=>{for(let A in this._heldAssets){let b=this._heldAssets[A],C=b.asset;b.preTransformState&&Bl.publishInternalMessage("instance_attached",{id:C.id,assetId:C.assetId,ownerId:A,type:"scale",scale:b.scaleIdentity,isXR:!0},!1,r.peer)}}));for(let r in uh)Qt.subscribe(this._id,r+"_DELETED",(r=>{for(let A in this._heldAssets){let b=this._heldAssets[A];if(b.asset==r.asset){let r=b.asset.editorHelper,C=b.asset.object;b.preTransformState&&(C.scale.fromArray(b.preTransformState),r._publish(["scale"])),delete this._heldAssets[A]}}})),Qt.subscribe(this._id,r+"_UPDATED",(r=>{for(let A in this._heldAssets){let b=this._heldAssets[A];if(b.asset==r.asset){let C=b.asset.editorHelper,I=b.asset.object;r.fields.includes("visualEdit")&&b.preTransformState&&(I.scale.fromArray(b.preTransformState),C._publish(["scale"])),delete this._heldAssets[A]}}}));Qt.subscribe(this._id,Rt.PROJECT_LOADING,(()=>{for(let r in this._heldAssets)delete this._heldAssets[r]}))}_otherOwner(r,A){for(let b in this._heldAssets)if(this._heldAssets[b].asset==A&&b!=r)return b}attach(r,A,b){let C=this._otherOwner(r,A);if(C)this._swapToOwner(r,C,b);else{let C={asset:A,ownerId:r};if(b)C.scaleIdentity=b,this._subscribeToDeletionOf(r);else{let b=il.getAsset(r).getWorldPosition().distanceTo(A.getWorldPosition()),I=A.getWorldScale();C.preTransformState=A.scale,C.scaleIdentity=I.divideScalar(b).toArray()}this._heldAssets[r]=C}if(!b){let b=this._heldAssets[r];Qt.publish(this._id,Rt.INSTANCE_ATTACHED,{instance:A,ownerId:r,type:"scale",scale:b.scaleIdentity})}}detach(r,A){let b=this._heldAssets[r];if(b)if(delete this._heldAssets[r],A)b.asset.scale=A,this._unsubscribeFromDeletionOf(r);else{A=this._update(b);let C=b.asset.editorHelper,I=b.preTransformState,x=A;C._updateParameter("scale",x,!1,!1,I,!0),Qt.publish(this._id,Rt.INSTANCE_DETACHED,{instance:b.asset,ownerId:r,type:"scale",scale:A})}}update(){for(let r in this._heldAssets){let A=this._heldAssets[r];this._update(A)}}_update(r){if(!r)return;let A=il.getAsset(r.ownerId);if(!A)return;let b=r.asset.getWorldPosition().distanceTo(A.getWorldPosition()),C=[r.scaleIdentity[0]*b,r.scaleIdentity[1]*b,r.scaleIdentity[2]*b];if(r.asset.scale=C,r.asset.parent){let A=r.asset.parent.getWorldScale();r.asset.object.scale.divide(A),C=r.asset.scale}return C}_swapToOwner(r,A,b){let C=this._heldAssets[A];if(C.ownerId=r,this._heldAssets[r]=C,delete this._heldAssets[A],b)C.scaleIdentity=b,this._unsubscribeFromDeletionOf(A),this._subscribeToDeletionOf(r);else{let A=il.getAsset(r).getWorldPosition().distanceTo(C.asset.getWorldPosition()),b=C.asset.getWorldScale();C.scaleIdentity=b.divideScalar(A).toArray()}}_subscribeToDeletionOf(r){let A=il.getSessionAsset(r),b="INTERNAL_DELETED:"+A.assetId+":"+A.id;Qt.subscribe(this._id,b,(r=>{for(let A in this._heldAssets)r.asset.id==A&&delete this._heldAssets[A]}))}_unsubscribeFromDeletionOf(r){let A=il.getSessionAsset(r),b="INTERNAL_DELETED:"+A.assetId+":"+A.id;Qt.unsubscribe(this._id,b)}};let jh=new class TranslateHandler{constructor(){this._id=uuidv4(),this._heldAssets={},sn.addUpdateListener((()=>{for(let r in this._heldAssets){let A=this._heldAssets[r];A.preTransformState&&this.detach(A.ownerId)}})),Qt.subscribe(this._id,Rt.PARTY_STARTED,(()=>{Bl.isHost()||(this._heldAssets={})})),Qt.subscribe(this._id,Rt.PEER_CONNECTED,(r=>{for(let A in this._heldAssets){let b=this._heldAssets[A],C=b.asset;b.preTransformState&&Bl.publishInternalMessage("instance_attached",{id:C.id,assetId:C.assetId,ownerId:A,type:"translate",position:b.positionDifference,isXR:!0},!1,r.peer)}}));for(let r in uh)Qt.subscribe(this._id,r+"_DELETED",(r=>{for(let A in this._heldAssets){let b=this._heldAssets[A];if(b.asset==r.asset){let r=b.asset.editorHelper,C=b.asset.object;b.preTransformState&&(C.position.fromArray(b.preTransformState),r._publish(["position"])),delete this._heldAssets[A]}}})),Qt.subscribe(this._id,r+"_UPDATED",(r=>{for(let A in this._heldAssets){let b=this._heldAssets[A];if(b.asset==r.asset){let C=b.asset.editorHelper,I=b.asset.object;r.fields.includes("visualEdit")&&b.preTransformState&&(I.position.fromArray(b.preTransformState),C._publish(["position"])),delete this._heldAssets[A]}}}));Qt.subscribe(this._id,Rt.PROJECT_LOADING,(()=>{for(let r in this._heldAssets)delete this._heldAssets[r]}))}_otherOwner(r,A){for(let b in this._heldAssets)if(this._heldAssets[b].asset==A&&b!=r)return b}attach(r,A,b){let C=this._otherOwner(r,A);if(C)this._swapToOwner(r,C,b);else{let C={asset:A,ownerId:r};if(b)C.positionDifference=b,this._subscribeToDeletionOf(r);else{let b=A.getWorldPosition();C.preTransformState=A.position,C.positionDifference=b.sub(il.getAsset(r).getWorldPosition()).toArray()}this._heldAssets[r]=C}if(!b){let b=this._heldAssets[r];Qt.publish(this._id,Rt.INSTANCE_ATTACHED,{instance:A,ownerId:r,type:"translate",position:b.positionDifference})}}detach(r,A){let b=this._heldAssets[r];if(b)if(delete this._heldAssets[r],A)b.asset.position=A,this._unsubscribeFromDeletionOf(r);else{A=this._update(b);let C=b.asset.editorHelper,I=b.preTransformState,x=A;C._updateParameter("position",x,!1,!1,I,!0),Qt.publish(this._id,Rt.INSTANCE_DETACHED,{instance:b.asset,ownerId:r,type:"translate",position:A})}}update(){for(let r in this._heldAssets){let A=this._heldAssets[r];this._update(A)}}_update(r){if(!r)return;let A=il.getAsset(r.ownerId);if(!A)return;let b=A.getWorldPosition(),C=[r.positionDifference[0]+b.x,r.positionDifference[1]+b.y,r.positionDifference[2]+b.z];if(r.asset.position=C,r.asset.parent){r.asset.parent.object.worldToLocal(r.asset.object.position),C=r.asset.position}return C}_swapToOwner(r,A,b){let C=this._heldAssets[A];if(C.ownerId=r,this._heldAssets[r]=C,delete this._heldAssets[A],b)C.positionDifference=b,this._unsubscribeFromDeletionOf(A),this._subscribeToDeletionOf(r);else{let A=C.asset.getWorldPosition();C.positionDifference=A.sub(il.getAsset(r).getWorldPosition()).toArray()}}_subscribeToDeletionOf(r){let A=il.getSessionAsset(r),b="INTERNAL_DELETED:"+A.assetId+":"+A.id;Qt.subscribe(this._id,b,(r=>{for(let A in this._heldAssets)r.asset.id==A&&delete this._heldAssets[A]}))}_unsubscribeFromDeletionOf(r){let A=il.getSessionAsset(r),b="INTERNAL_DELETED:"+A.assetId+":"+A.id;Qt.unsubscribe(this._id,b)}};class Box3Helper extends Se{constructor(r){super(Ao.geometry,Ao.material),this.box=r,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(r){const A=this.box;A.isEmpty()||(A.getCenter(this.position),A.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(r))}}const Vh={ACKNOWLEDGEMENTS:"ACKNOWLEDGEMENTS",ASSET:"ASSET",ASSETS:"ASSETS",ASSET_SELECT:"ASSET_SELECT",ASSET_SET:"ASSET_SET",COLOR_WHEEL:"COLOR_WHEEL",COMPONENT:"COMPONENT",COMPONENTS:"COMPONENTS",EDIT_ACKNOWLEDGEMENTS:"EDIT_ACKNOWLEDGEMENTS",EDITOR_SETTINGS:"EDITOR_SETTINGS",HANDS:"HANDS",HOST_PARTY:"HOST_PARTY",JOIN_PARTY:"JOIN_PARTY",LIBRARY:"LIBRARY",LIBRARY_SEARCH:"LIBRARY_SEARCH",LIST_COMPONENTS:"LIST_COMPONENTS",LOAD_GDRIVE:"LOAD_GDRIVE",MATERIAL:"MATERIAL",MATERIALS:"MATERIALS",MESSAGE:"MESSAGE",NAVIGATION:"NAVIGATION",NEW_ASSET:"NEW_ASSET",PARTY:"PARTY",PEER:"PEER",PROJECT:"PROJECT",SETTINGS:"SETTINGS",SKETCHFAB_ASSET:"SKETCHFAB_ASSET",SKETCHFAB_LOGIN:"SKETCHFAB_LOGIN",SKETCHFAB_SEARCH:"SKETCHFAB_SEARCH",SKYBOX:"SKYBOX",SYSTEM:"SYSTEM",SYSTEMS:"SYSTEMS",TEXTURE:"TEXTURE",TEXTURES:"TEXTURES",TEXT:"TEXT",TEXT_INPUT:"TEXT_INPUT",TWO_BUTTON:"TWO_BUTTON",USER_SETTINGS:"USER_SETTINGS"},zh=new Style({justifyContent:"spaceBetween",minHeight:.05,width:.31});class MenuField extends Span{constructor(r={}){super(zh),this._id=uuidv4(),this._disabled=!1,this._getFromSource=r.getFromSource,this._onUpdate=r.onUpdate}_addTitle(r,A=.13){let b=new TextComponent(r,ro.bodyText,{maxWidth:A});return this.add(b),b}deactivate(){}updateFromSource(){}get disabled(){return this._disabled}set disabled(r){this._disabled=r}}let Wh=class AssetEntityField extends MenuField{constructor(r){super(r),this._lastValue=r.initialValue,this._exclude=r.exclude,this._filter=r.filter,this._privateIds=r.privateIds||new Set,this._includeScene=r.includeScene;let A=r.title||"Missing Field Name...";this._createInputs(A),this._updateAssetEntity(this._lastValue)}_createInputs(r){this._addTitle(r),this._buttonsSpan=new Span({height:.03,width:.17}),this._assetEntitySelection=createWideButton(""),this._assetEntitySelection.textComponent.fontSize=.017,this._assetEntitySelection.height=.03,this._assetEntitySelection.width=.13,this._editButton=createSmallButton(Ya.pencilIcon),this._editButton.marginLeft=.01,this._editButton.height=.03,this._editButton.width=.03,this._buttonsSpan.add(this._assetEntitySelection),this._buttonsSpan.add(this._editButton),this._updateAssetEntity(),this.add(this._buttonsSpan),this._assetEntitySelection.onClickAndTouch=()=>{let r=il.getAssets(),A={"null\n":{Name:"Blank"}};this._includeScene&&(A[Ho.id]={Name:"Scene"});for(let b in r){if(this._exclude==b)continue;let C=r[b];if(!(C instanceof InternalAssetEntity)&&C instanceof AssetEntity){if((C.isPrivate||C.constructor.isPrivate)&&!this._privateIds.has(b))continue;if(this._filter&&!this._filter(C))continue;A[b]={Name:C.name}}}Mt.menuController.getPage(Vh.ASSET_SELECT).setContent(A,(r=>{"null\n"==r&&(r=null),this._handleAssetSelection(r)})),Mt.menuController.pushPage(Vh.ASSET_SELECT)},this._editButton.onClickAndTouch=()=>{if(!this._lastValue)return;let r=il.getAsset(this._lastValue);if(!r)return;let A=r.constructor.assetType;Mt.menuController.getPage(A).setAsset(r),Mt.menuController.pushPage(A)}}_handleAssetSelection(r){"null\n"==r&&(r=null),this._lastValue!=r&&(this._onUpdate&&this._onUpdate(r),this._updateAssetEntity(r)),Mt.menuController.back()}_updateAssetEntity(r){this._lastValue=r;let A=il.getAsset(this._lastValue),b=A?A.name:Ho.id==this._lastValue?"Scene":" ";b=stringWithMaxLength(b,16),this._assetEntitySelection.textComponent.text=b,A?this._buttonsSpan.add(this._editButton):this._buttonsSpan.remove(this._editButton)}updateFromSource(){if(!this._getFromSource)return;let r=this._getFromSource();this._lastValue!=r&&this._updateAssetEntity(r)}};class AssetSetField extends MenuField{constructor(r){super(r),this._lastValue=r.initialValue;let A=r.title||"Missing Field Name...";this._getOptions=r.getOptions,this._getNewOptions=r.getNewOptions,this._onAdd=r.onAdd,this._onRemove=r.onRemove,this._createInputs(A)}_createInputs(r){this._addTitle(r);let A=createWideButton("Update");A.textComponent.fontSize=.017,A.height=.03,A.width=.17,this.add(A),A.onClickAndTouch=()=>{let A=this._getOptions?this._getOptions():[],b=this._getNewOptions?this._getNewOptions():[];Mt.menuController.getPage(Vh.ASSET_SET).setContent(r,this._getFromSource,A,b,this._onAdd,this._onRemove),Mt.menuController.pushPage(Vh.ASSET_SET)}}_handleSelection(r){this._lastValue!=r&&(this._onUpdate&&this._onUpdate(r),this._lastValue=r)}updateFromSource(){if(!this._getFromSource)return;let r=this._getFromSource();r!=this._lastValue&&(this._lastValue=r)}}class AudioField extends MenuField{constructor(r){super(r),this._lastValue=r.initialValue;let A=r.title||"Missing Field Name...";this._createInputs(A),this._updateAudio(this._lastValue)}_createInputs(r){this._addTitle(r),this._audioSelection=createWideButton(""),this._audioSelection.textComponent.fontSize=.017,this._audioSelection.height=.03,this._audioSelection.width=.17,this._updateAudio(),this.add(this._audioSelection),this._audioSelection.onClickAndTouch=()=>{let r=Qo.getLibrary(),A={"null\n":{Name:"Blank"}};for(let b in r){let C=r[b];C.Type==kt.AUDIO&&(A[b]=C)}Mt.menuController.getPage(Vh.ASSET_SELECT).setContent(A,(r=>{"null\n"==r&&(r=null),this._handleAssetSelection(r)}),(()=>{Ah.triggerAssetsUpload((r=>{r.length>0&&this._handleAssetSelection(r[0])}),!1,kt.AUDIO)})),Mt.menuController.pushPage(Vh.ASSET_SELECT)}}_handleAssetSelection(r){"null\n"==r?r=null:Qo.getType(r)!=kt.AUDIO&&(r=this._lastValue),this._lastValue!=r&&(this._onUpdate&&this._onUpdate(r),this._updateAudio(r)),Mt.menuController.back()}_updateAudio(r){this._lastValue=r;let A=this._lastValue?Qo.getAssetName(this._lastValue):" ";A=stringWithMaxLength(A,16),this._audioSelection.textComponent.text=A}updateFromSource(){if(!this._getFromSource)return;let r=this._getFromSource();this._lastValue!=r&&this._updateAudio(r)}}let Xh=class CheckboxField extends MenuField{constructor(r){super(r);let A=r.initialValue||!1,b=r.title||"Missing Field Name...",C=r.titleWidth||.14,I=r.swapOrder||!1;this._suppressMenuFocusEvent=r.suppressMenuFocusEvent,this._createInputs(A,b,C,I)}_createInputs(r,A,b,C){this._checkbox=new Checkbox({height:.04,pointerInteractableClassOverride:OrbitDisablingPointerInteractable,width:.04}),C?(this.add(this._checkbox),this._addTitle(A,b).textAlign="right"):(this._addTitle(A,b),this.add(this._checkbox)),this._checkbox.checked=r,this._checkbox.onChange=r=>{this._onUpdate&&this._onUpdate(r)}}updateFromSource(){this._getFromSource&&this._getFromSource()!=this._checkbox.checked&&(this._checkbox.checked=!this._checkbox.checked)}},Yh=class ColorField extends MenuField{constructor(A){super(A);let b=A.title||"Missing Field Name...";this._lastValue=numberOr$1(A.initialValue,2800597),this._color=new r.Color(this._lastValue),this._onBlur=A.onBlur,this._createInputs(b)}_createInputs(r){this._addTitle(r,.14),this._colorBlock=new Span({backgroundVisible:!0,borderRadius:.01,height:.04,pointerInteractableClassOverride:OrbitDisablingPointerInteractable,width:.08}),this._colorBlock.material.color=this._color,this.add(this._colorBlock),this._colorBlock.onClickAndTouch=()=>{let r=Mt.menuController.getPage(Vh.COLOR_WHEEL);r.setContent(this._id,this._color,(r=>{this._color.getHex()!=r&&(this._color.setHex(r),this._onUpdate&&this._onUpdate(r))}),(()=>{if(r.isDragging())return;let A=this._lastValue,b=this._color.getHex();this._onBlur&&this._onBlur(A,b),this._lastValue=b,this._color.setHex(this._lastValue)})),Mt.menuController.pushPage(Vh.COLOR_WHEEL)}}updateFromSource(){if(this._getFromSource){this._lastValue=this._getFromSource(),this._color.setHex(this._lastValue),Mt.menuController.getPage(Vh.COLOR_WHEEL).updateColor(this._id,this._color)}}};const Kh=[Go.TOP,Go.LEFT,Go.FRONT,Go.RIGHT,Go.BACK,Go.BOTTOM],qh={};qh[Go.TOP]=0,qh[Go.LEFT]=1,qh[Go.FRONT]=2,qh[Go.RIGHT]=3,qh[Go.BACK]=4,qh[Go.BOTTOM]=5;let Zh=class CubeImageField extends MenuField{constructor(r){super(r),this.height=r.title?.244:.196,this.contentDirection="column",this._lastValue=r.initialValue?[...new Array(6)]:[...r.initialValue];let A=r.title||null;this._buttons=[],this._createInputs(A);for(let r=0;r<6;r++)this._updateImage(r,this._lastValue[r])}_createInputs(r){r&&(this._addTitle(r,.31).height=.04);let A=new Span({height:.06,justifyContent:"spaceBetween",width:.264});for(let r=0;r<Kh.length;r++){let b=new ia(Ya.searchIcon,{height:.06,width:.06});b.pointerInteractable=new OrbitDisablingPointerInteractable(b),b.onClickAndTouch=()=>this._handleInteractable(Kh[r]),0==r?(b.marginRight=.068,this.add(b),this.add(A)):r<5?A.add(b):(b.marginRight=.068,this.add(b)),this._buttons.push(b)}}_handleInteractable(r){let A=Qo.getLibrary(),b={"null\n":{Name:"Blank"}};for(let r in A){let C=A[r];C.Type==kt.IMAGE&&(b[r]=C)}Mt.menuController.getPage(Vh.ASSET_SELECT).setContent(b,(A=>{"null\n"==A&&(A=null),this._handleAssetSelection(r,A)}),(()=>{this._fileUploadSide=r,Ah.triggerAssetsUpload((r=>{r.length>0&&this._handleAssetSelection(this._fileUploadSide,r[0])}),!1,kt.IMAGE)})),Mt.menuController.pushPage(Vh.ASSET_SELECT)}_handleAssetSelection(r,A){"null\n"==A&&(A=null),this._lastValue[r]!=A&&(this._updateImage(r,A),this._onUpdate&&this._onUpdate([...this._lastValue])),Mt.menuController.back()}_updateImage(r,A){let b=qh[r];this._lastValue[r]=A,A?this._buttons[b].updateTexture(Qo.getTexture(A)):this._buttons[b].updateTexture(Ya.searchIcon)}updateFromSource(){if(!this._getFromSource)return;let r=this._getFromSource();for(let A=0;A<6;A++)this._lastValue[A]!=r[A]&&this._updateImage(A,r[A])}},Jh=class EnumField extends MenuField{constructor(r){super(r),this._lastValue=r.initialValue;let A=r.title||"Missing Field Name...",b=r.options||[];this._createInputs(A,b)}_createInputs(r,A){this._addTitle(r),this._selectBox=new Select({height:.03,pointerInteractableClassOverride:OrbitDisablingPointerInteractable,width:.17}),this._selectBox.addOptions(...A),this._selectBox.value=this._lastValue,this._selectBox.onChange=r=>this._handleSelection(r),this.add(this._selectBox)}_handleSelection(r){this._lastValue!=r&&(this._onUpdate&&this._onUpdate(r),this._lastValue=r)}deactivate(){this._hideOptions}updateFromSource(){if(!this._getFromSource)return;let r=this._getFromSource();r!=this._lastValue&&(this._lastValue=r,this._selectBox.value=r)}},$h=class EulerField extends MenuField{constructor(r){super(r),this.height=.11,this._onBlur=r.onBlur,this._lastValue=r.initialValue||[0,0,0];let A=r.title||"Missing Field Name...";this._createInputs(A)}_createInputs(r){this._addTitle(r,.09);let A=new Div({alignItems:"end",height:.11,justifyContent:"center",width:.22});this._addInputRow("x",toDegrees(this._lastValue[0]),A),this._addInputRow("y",toDegrees(this._lastValue[1]),A),this._addInputRow("z",toDegrees(this._lastValue[2]),A),this.add(A)}_addInputRow(r,A,b){let C=new Span({height:.03}),I=new TextComponent(r.toUpperCase(),ro.bodyText,{marginRight:.008}),x=new NumberInput({fontSize:Ja,height:.03,pointerInteractableClassOverride:OrbitDisablingPointerInteractable,width:.17});x.pointerInteractable.hoveredCursor="text",x.onBlur=()=>this._blur(),x.onChange=()=>this._update(),x.onEnter=()=>x.blur(),x.onFocus=()=>{Mt.keyboardLock=!0},x.value=A,C.add(I),C.add(x),b.add(C),this["_"+r+"Input"]=x}_update(){let r=[this.getX(),this.getY(),this.getZ()];r.forEach(((A,b)=>r[b]=Re.degToRad(A))),this._onUpdate&&this._onUpdate(r)}_blur(){Mt.keyboardLock=!1;let r=[this.getX(),this.getY(),this.getZ()];r.forEach(((A,b)=>r[b]=Re.degToRad(A))),this._onBlur&&this._onBlur(this._lastValue,r),this._lastValue=r}getX(){return Number.parseFloat(this._xInput.value)}getY(){return Number.parseFloat(this._yInput.value)}getZ(){return Number.parseFloat(this._zInput.value)}deactivate(){this._xInput.blur(),this._yInput.blur(),this._zInput.blur()}updateFromSource(){if(!this._getFromSource)return;let r=this._getFromSource();r[0]==this._lastValue[0]&&r[1]==this._lastValue[1]&&r[2]==this._lastValue[2]||(this._lastValue=r,this._xInput.value=toDegrees(r[0]),this._yInput.value=toDegrees(r[1]),this._zInput.value=toDegrees(r[2]))}get disabled(){return this._disabled}set disabled(r){if(this._disabled=r,r)for(let r of[this._xInput,this._yInput,this._zInput])r.blur(),r.pointerInteractable.disabled=!0,r.touchInteractable.disabled=!0;else for(let r of[this._xInput,this._yInput,this._zInput])r.pointerInteractable.disabled=!1,r.touchInteractable.disabled=!1}};function toDegrees(r){return String(roundWithPrecision(Re.radToDeg(r),5))}let ed=class ImageField extends MenuField{constructor(r){super(r),this._lastValue=r.initialValue;let A=r.title||"Missing Field Name...";this._createInputs(A),this._updateImage(this._lastValue)}_createInputs(r){this._addTitle(r),this._materialColorStyle=new Style({materialColor:16777215}),this._imageSelection=createWideImageButton(),this._imageSelection.addStyle(this._materialColorStyle),this._imageSelection.textComponent.fontSize=.017,this._imageSelection.height=.03,this._imageSelection.width=.17,this._updateImage(),this.add(this._imageSelection),this._imageSelection.onClickAndTouch=()=>{let r=Qo.getLibrary(),A={"null\n":{Name:"Blank"}};for(let b in r){let C=r[b];C.Type==kt.IMAGE&&(A[b]=C)}Mt.menuController.getPage(Vh.ASSET_SELECT).setContent(A,(r=>{"null\n"==r&&(r=null),this._handleAssetSelection(r)}),(()=>{Ah.triggerAssetsUpload((r=>{r.length>0&&this._handleAssetSelection(r[0])}),!1,kt.IMAGE)})),Mt.menuController.pushPage(Vh.ASSET_SELECT)}}_handleAssetSelection(r){"null\n"==r&&(r=null),this._lastValue!=r&&(this._onUpdate&&this._onUpdate(r),this._updateImage(r)),Mt.menuController.back()}_updateImage(r){let A=r?Qo.getAssetName(r):" ";A=stringWithMaxLength(A,16),this._imageSelection.textComponent.text=A,this._lastValue!=r&&(this._lastValue=r,r?(this._imageSelection.updateTexture(Qo.getTexture(this._lastValue)),this._materialColorStyle.materialColor=qa.white):(this._imageSelection.updateTexture(),this._materialColorStyle.materialColor=qa.defaultIdle))}updateFromSource(){if(!this._getFromSource)return;let r=this._getFromSource();this._lastValue!=r&&this._updateImage(r)}};const td={};let sd=class MaterialField extends MenuField{constructor(r){super(r),this._lastValue=r.initialValue;let A=r.title||"Missing Field Name...";this._privateIds=r.privateIds||new Set,this._createInputs(A),this._updateMaterial(this._lastValue)}_createInputs(r){this._addTitle(r),this._buttonsSpan=new Span({height:.03,width:.17}),this._materialColorStyle=new Style({materialColor:16777215}),this._materialSelection=createWideImageButton(""),this._materialSelection.addStyle(this._materialColorStyle),this._materialSelection.textComponent.fontSize=.017,this._materialSelection.height=.03,this._materialSelection.width=.13,this._editButton=createSmallButton(Ya.pencilIcon),this._editButton.marginLeft=.01,this._editButton.height=.03,this._editButton.width=.03,this._buttonsSpan.add(this._materialSelection),this._buttonsSpan.add(this._editButton),this.add(this._buttonsSpan),this._materialSelection.onClickAndTouch=()=>{let r=Rl.getAssets(),A={"null\n":{Name:"Blank"}};for(let b in r){let C=r[b];(!C.isPrivate&&!C.constructor.isPrivate||this._privateIds.has(b))&&(A[b]={Name:C.name})}Mt.menuController.getPage(Vh.ASSET_SELECT).setContent(A,(r=>{"null\n"==r&&(r=null),this._handleMaterialSelection(r)}),(()=>{this._selectNewMaterial()})),Mt.menuController.pushPage(Vh.ASSET_SELECT)},this._editButton.onClickAndTouch=()=>{if(!this._lastValue)return;let r=Rl.getAsset(this._lastValue);Mt.menuController.getPage(Vh.MATERIAL).setAsset(r),Mt.menuController.pushPage(Vh.MATERIAL)}}_selectNewMaterial(){let r=Mt.menuController.getCurrentPage();Mt.menuController.getPage(Vh.NEW_ASSET).setContent(kt.MATERIAL,(A=>{if(this._handleMaterialSelection(A.id,r),r!=Mt.menuController.getCurrentPage())return;Mt.menuController.getPage(Vh.MATERIAL).setAsset(A),Mt.menuController.pushPage(Vh.MATERIAL)})),Mt.menuController.pushPage(Vh.NEW_ASSET)}_handleMaterialSelection(r,A){"null\n"==r&&(r=null),this._lastValue!=r&&(this._onUpdate&&this._onUpdate(r),this._updateMaterial(r)),A&&A!=Mt.menuController.getCurrentPage()||Mt.menuController.back()}_updateMaterial(r){this._lastValue=r;let A=Rl.getAsset(this._lastValue),b=A?A.name:" ";if(b=stringWithMaxLength(b,12),this._materialSelection.textComponent.text=b,A){let r=A.material.color||qa.white;this._updateTextureAndColor(A.getSampleTexture(),r),this._buttonsSpan.add(this._editButton)}else this._updateTextureAndColor(null,qa.defaultIdle),this._buttonsSpan.remove(this._editButton)}_updateTextureAndColor(r,A){let b=this._materialSelection.material;b.map?.image!=r?.image&&this._materialSelection.updateTexture(r),b.color.equals(A)||(this._materialColorStyle.materialColor=A),b.color.getHSL(td);let C=!r&&td.l>.85?qa.black:qa.white;this._materialSelection.textComponent.color.equals(C)||(this._materialSelection.textComponent.color=C)}_addSubscriptions(){Qt.subscribe(this._id,Rt.MATERIAL_UPDATED,(r=>{this._lastValue==r.asset.id&&this.updateFromSource()}))}_removeSubscriptions(){Qt.unsubscribe(this._id,Rt.MATERIAL_UPDATED)}updateFromSource(){this._getFromSource&&this._updateMaterial(this._getFromSource())}_onAdded(){this.updateFromSource(),this._addSubscriptions(),super._onAdded()}_onRemoved(){this._removeSubscriptions(),super._onRemoved()}},id=class NumberField extends MenuField{constructor(r){super(r),this._onBlur=r.onBlur,this._minValue=numberOr$1(r.minValue,-Infinity),this._maxValue=numberOr$1(r.maxValue,Infinity),this._lastValue=r.initialValue||0;let A=r.title||"Missing Field Name...";this._createInput(A)}_createInput(r){this._addTitle(r),this._numberInput=new NumberInput({fontSize:Ja,height:.03,pointerInteractableClassOverride:OrbitDisablingPointerInteractable,width:.17}),this._numberInput.pointerInteractable.hoveredCursor="text",this._numberInput.onBlur=()=>this._blur(),this._numberInput.onChange=()=>this._update(),this._numberInput.onEnter=()=>this._numberInput.blur(),this._numberInput.onFocus=()=>{Mt.keyboardLock=!0},this._numberInput.minValue=this._minValue,this._numberInput.maxValue=this._maxValue,this._numberInput.value=this._lastValue,this.add(this._numberInput)}_update(){let r=this.getValue();this._onUpdate&&this._onUpdate(r)}_blur(){Mt.keyboardLock=!1;let r=this.getValue();this._onBlur&&this._onBlur(this._lastValue,r),this._lastValue=r}getValue(){return Number.parseFloat(this._numberInput.value)}deactivate(){this._numberInput.blur()}updateFromSource(){this._getFromSource&&(this._numberInput.value=this._lastValue=this._getFromSource())}get disabled(){return this._disabled}set disabled(r){this._disabled=r,r?(this._numberInput.blur(),this._numberInput.pointerInteractable.disabled=!0,this._numberInput.touchInteractable.disabled=!0):(this._numberInput.pointerInteractable.disabled=!1,this._numberInput.touchInteractable.disabled=!1)}},nd=class TextField extends MenuField{constructor(r){super(r),this._onBlur=r.onBlur,this._singleLine=r.singleLine||!1,this._lastValue=r.initialValue||"";let A=r.title||"Missing Field Name...";this._singleLine||(this.height=.1),this._createInput(A)}_createInput(r){this._addTitle(r),this._singleLine?this._textInput=new TextInput({fontSize:Ja,height:.03,pointerInteractableClassOverride:OrbitDisablingPointerInteractable,width:.17}):this._textInput=new TextArea({fontSize:Ja,height:.09,pointerInteractableClassOverride:OrbitDisablingPointerInteractable,width:.17}),this._textInput.pointerInteractable.hoveredCursor="text",this._textInput.onBlur=()=>this._blur(),this._textInput.onChange=()=>this._update(),this._textInput.onEnter=()=>this._textInput.blur(),this._textInput.onFocus=()=>{Mt.keyboardLock=!0},this.add(this._textInput)}_update(){this._onUpdate&&this._onUpdate(this.getValue())}_blur(){Mt.keyboardLock=!1;let r=this.getValue();this._onBlur&&this._onBlur(this._lastValue,r),this._lastValue=r}getValue(){return this._textInput.value}deactivate(){this._textInput.blur()}updateFromSource(){this._getFromSource&&(this._lastValue=this._getFromSource(),this._textInput.value=this._lastValue)}},rd=class TextureField extends MenuField{constructor(r){super(r),this._lastValue=r.initialValue,this._filter=r.filter;let A=r.title||"Missing Field Name...";this._privateIds=r.privateIds||new Set,this._createInputs(A),this._updateTexture(this._lastValue)}_createInputs(r){this._addTitle(r),this._buttonsSpan=new Span({height:.03,width:.17}),this._textureColorStyle=new Style({materialColor:16777215}),this._textureSelection=createWideImageButton(""),this._textureSelection.addStyle(this._textureColorStyle),this._textureSelection.textComponent.fontSize=.017,this._textureSelection.height=.03,this._textureSelection.width=.13,this._editButton=createSmallButton(Ya.pencilIcon),this._editButton.marginLeft=.01,this._editButton.height=.03,this._editButton.width=.03,this._buttonsSpan.add(this._textureSelection),this._buttonsSpan.add(this._editButton),this.add(this._buttonsSpan),this._textureSelection.onClickAndTouch=()=>{let r=Fl.getAssets(),A={"null\n":{Name:"Blank"}};for(let b in r){if(this._filter&&!this._filter.includes(r[b].textureType))continue;let C=r[b];(!C.isPrivate&&!C.constructor.isPrivate||this._privateIds.has(b))&&(A[b]={Name:C.name})}Mt.menuController.getPage(Vh.ASSET_SELECT).setContent(A,(r=>{"null\n"==r&&(r=null),this._handleTextureSelection(r)}),(()=>{this._selectNewTexture()})),Mt.menuController.pushPage(Vh.ASSET_SELECT)},this._editButton.onClickAndTouch=()=>{if(!this._lastValue)return;let r=Fl.getAsset(this._lastValue);Mt.menuController.getPage(Vh.TEXTURE).setAsset(r),Mt.menuController.pushPage(Vh.TEXTURE)}}_selectNewTexture(){let r=Mt.menuController.getCurrentPage(),A=Fl.getAssetClasses();if(this._filter&&(A=A.filter((r=>this._filter.includes(r.textureType)))),1==A.length){let r=Fl.addNewAsset(A[0].assetId);this._handleTextureSelection(r.id),Mt.menuController.getPage(Vh.TEXTURE).setAsset(r),Mt.menuController.pushPage(Vh.TEXTURE)}else{Mt.menuController.getPage(Vh.NEW_ASSET).setContent(kt.TEXTURE,(A=>{if(this._handleTextureSelection(A.id,r),r!=Mt.menuController.getCurrentPage())return;Mt.menuController.getPage(Vh.TEXTURE).setAsset(A),Mt.menuController.pushPage(Vh.TEXTURE)})),Mt.menuController.pushPage(Vh.NEW_ASSET)}}_handleTextureSelection(r,A){"null\n"==r&&(r=null),this._lastValue!=r&&(this._onUpdate&&this._onUpdate(r),this._updateTexture(r)),A&&A!=Mt.menuController.getCurrentPage()||Mt.menuController.back()}_updateTexture(r){this._lastValue=r;let A=Fl.getAsset(this._lastValue),b=A?A.name:" ";b=stringWithMaxLength(b,12),this._textureSelection.textComponent.text=b,A?(this._updateTextureAndColor(A.previewTexture,qa.white),this._buttonsSpan.add(this._editButton)):(this._updateTextureAndColor(null,qa.defaultIdle),this._buttonsSpan.remove(this._editButton))}_updateTextureAndColor(r,A){let b=this._textureSelection.material;b.map?.image!=r?.image&&this._textureSelection.updateTexture(r),b.color.equals(A)||(this._textureColorStyle.materialColor=A)}updateFromSource(){this._getFromSource&&this._updateTexture(this._getFromSource())}},ad=class Vector2Field extends MenuField{constructor(r){super(r),this.height=.085,this._onBlur=r.onBlur,this._lastValue=r.initialValue||[0,0];let A=r.title||"Missing Field Name...";this._createInputs(A)}_createInputs(r){this._addTitle(r,.09);let A=new Div({alignItems:"end",height:.085,justifyContent:"center",width:.22});this._addInputRow("x",this._lastValue[0],A),this._addInputRow("y",this._lastValue[1],A),this.add(A)}_addInputRow(r,A,b){let C=new Span({height:.03}),I=new TextComponent(r.toUpperCase(),ro.bodyText,{marginRight:.008}),x=new NumberInput({fontSize:Ja,height:.03,pointerInteractableClassOverride:OrbitDisablingPointerInteractable,width:.17});x.pointerInteractable.hoveredCursor="text",x.onBlur=()=>this._blur(),x.onChange=()=>this._update(),x.onEnter=()=>x.blur(),x.onFocus=()=>{Mt.keyboardLock=!0},x.value=A,C.add(I),C.add(x),b.add(C),this["_"+r+"Input"]=x}_update(){let r=[this.getX(),this.getY()];this._onUpdate&&this._onUpdate(r)}_blur(){Mt.keyboardLock=!1;let r=[this.getX(),this.getY()];this._onBlur&&this._onBlur(this._lastValue,r),this._lastValue=r}getX(){return Number.parseFloat(this._xInput.value)}getY(){return Number.parseFloat(this._yInput.value)}deactivate(){this._xInput.blur(),this._yInput.blur()}updateFromSource(){if(!this._getFromSource)return;let r=this._getFromSource();r[0]==this._lastValue[0]&&r[1]==this._lastValue[1]||(this._lastValue=r,this._xInput.value=r[0],this._yInput.value=r[1])}},od=class Vector3Field extends MenuField{constructor(r){super(r),this.height=.11,this._onBlur=r.onBlur,this._lastValue=r.initialValue||[0,0,0];let A=r.title||"Missing Field Name...";this._createInputs(A)}_createInputs(r){this._addTitle(r,.09);let A=new Div({alignItems:"end",height:.11,justifyContent:"center",width:.22});this._addInputRow("x",this._lastValue[0],A),this._addInputRow("y",this._lastValue[1],A),this._addInputRow("z",this._lastValue[2],A),this.add(A)}_addInputRow(r,A,b){let C=new Span({height:.03}),I=new TextComponent(r.toUpperCase(),ro.bodyText,{marginRight:.008}),x=new NumberInput({fontSize:Ja,height:.03,pointerInteractableClassOverride:OrbitDisablingPointerInteractable,width:.17});x.pointerInteractable.hoveredCursor="text",x.onBlur=()=>this._blur(),x.onChange=()=>this._update(),x.onEnter=()=>x.blur(),x.onFocus=()=>{Mt.keyboardLock=!0},x.value=A,C.add(I),C.add(x),b.add(C),this["_"+r+"Input"]=x}_update(){let r=[this.getX(),this.getY(),this.getZ()];this._onUpdate&&this._onUpdate(r)}_blur(){Mt.keyboardLock=!1;let r=[this.getX(),this.getY(),this.getZ()];this._onBlur&&this._onBlur(this._lastValue,r),this._lastValue=r}getX(){return Number.parseFloat(this._xInput.value)}getY(){return Number.parseFloat(this._yInput.value)}getZ(){return Number.parseFloat(this._zInput.value)}deactivate(){this._xInput.blur(),this._yInput.blur(),this._zInput.blur()}updateFromSource(){if(!this._getFromSource)return;let r=this._getFromSource();r[0]==this._lastValue[0]&&r[1]==this._lastValue[1]&&r[2]==this._lastValue[2]||(this._lastValue=r,this._xInput.value=r[0],this._yInput.value=r[1],this._zInput.value=r[2])}get disabled(){return this._disabled}set disabled(r){if(this._disabled=r,r)for(let r of[this._xInput,this._yInput,this._zInput])r.blur(),r.pointerInteractable.disabled=!0,r.touchInteractable.disabled=!0;else for(let r of[this._xInput,this._yInput,this._zInput])r.pointerInteractable.disabled=!1,r.touchInteractable.disabled=!1}};const ld={AssetEntityField:"_createAssetEntityField",AssetSetField:"_createAssetSetField",AudioField:"_createAudioField",CheckboxField:"_createCheckboxField",ColorField:"_createColorField",CubeImageField:"_createCubeImageField",EnumField:"_createEnumField",EulerField:"_createEulerField",ImageField:"_createImageField",MaterialField:"_createMaterialField",NumberField:"_createNumberField",TextField:"_createTextField",TextureField:"_createTextureField",Vector2Field:"_createVector2Field",Vector3Field:"_createVector3Field"};class EditorHelper{constructor(r,A){this._asset=r,this._id=r.id,this._updatedTopic=A+":"+r.assetId+":"+this._id,this._deletedAssetSetValues=new Set,this._deletedAttachedComponents=new Set,this._disabledParams=new Set,this._addComponentSubscriptions()}_publish(r,A){let b={asset:this._asset,fields:r,extraData:A};Qt.publish(this._id,this._updatedTopic,b)}_updateParameter(r,A,b,C,I,x){let S=this._asset[r];this._disabledParams.has(r)&&!x||this._parameterValuesEqual(S,A)||(this._asset[r]=A,b||this._publish([r])),null==I&&(I=S),C||this._parameterValuesEqual(I,A)||sl.addAction((()=>{this._updateParameter(r,I,b,!0),this.updateMenuField(r)}),(()=>{this._updateParameter(r,A,b,!0),this.updateMenuField(r)}))}_parameterValuesEqual(r,A){return Array.isArray(r)||Array.isArray(A)?r.reduce(((r,b,C)=>r&&A[C]==b),!0):r==A}_addToParameter(r,A,b,C,I,x){let S=il.getAsset(C);if(S)this._asset[A](C),this.updateMenuField(r);else{if(S=il.getSessionAsset(C),!S)return;this._subscribeToAssetAdded(S,r,A,C)}I||this._publish([r],{[r]:{type:"useFunction",funcName:A,value:C}}),x||sl.addAction((()=>{this._removeFromParameter(r,b,A,C,I,!0)}),(()=>{this._addToParameter(r,A,b,C,I,!0)}))}_removeFromParameter(r,A,b,C,I,x){let S=il.getAsset(C);if(S)this._asset[A](C),this.updateMenuField(r);else if(S=il.getSessionAsset(C),!S)return;this._unsubscribeFromAssetAdded(S),I||this._publish([r],{[r]:{type:"useFunction",funcName:A,value:C}}),x||sl.addAction((()=>{this._addToParameter(r,b,A,C,I,!0)}),(()=>{this._removeFromParameter(r,A,b,C,I,!0)}))}_subscribeToAssetAdded(r,A,b,C){this._deletedAssetSetValues.add(r);let I=r.constructor.assetType+"_ADDED:"+r.assetId+":"+r.id;Qt.subscribe(this._id,I,(r=>{this._deletedAssetSetValues.has(r)&&this._addToParameter(A,b,null,C,!0,!0)}))}_unsubscribeFromAssetAdded(r){if(!this._deletedAssetSetValues.has(r))return;this._deletedAssetSetValues.delete(r);let A=assetType+"_ADDED:"+r.assetId+":"+r.id;Qt.unsubscribe(this._id,A)}updateMenuField(r){if(!this._menuFields)return;let A=this._menuFieldsMap[r];A&&A.updateFromSource()}updateName(r,A){let b=this._asset.name;b!=r&&(this._asset.name=r,this._publish(["name"]),A||sl.addAction((()=>{this.updateName(b,!0)}),(()=>{this.updateName(r,!0)})))}addComponent(r,A,b){let C=this._asset.addComponent(r,A);if(!C){if(C=il.getSessionAsset(r),!C)return;this._deletedAttachedComponents.add(C),A||this._publishComponentAttachment(Rt.COMPONENT_ATTACHED,C)}return b||sl.addAction((()=>{this.removeComponent(r,A,!0)}),(()=>{this.addComponent(r,A,!0)})),C}removeComponent(r,A,b){let C=this._asset.removeComponent(r,A);if(!C){if(C=il.getSessionAsset(r),!C)return;this._deletedAttachedComponents.delete(C),A||this._publishComponentAttachment(Rt.COMPONENT_DETACHED,C)}return b||sl.addAction((()=>{this.addComponent(r,A,!0)}),(()=>{this.removeComponent(r,A,!0)})),C}_publishComponentAttachment(r,A){let b=A.assetId,C=r+":"+b;Qt.publish(this._id,C,{id:this._id,componentId:A.id,componentAssetId:b})}_addComponentSubscriptions(){Qt.subscribe(this._id,Rt.COMPONENT_ADDED,(r=>{this._deletedAttachedComponents.has(r)&&(this._deletedAttachedComponents.delete(r),this._asset._components.add(r))})),Qt.subscribe(this._id,Rt.COMPONENT_DELETED,(r=>{let A=r.asset;this._asset._components.has(A)&&(this._deletedAttachedComponents.add(A),this._asset._components.delete(A))}))}_disableParam(r){this._disabledParams.add(r),this._menuFields&&(this._menuFieldsMap[r].disabled=!0)}_enableParam(r){this._disabledParams.has(r)&&(this._disabledParams.delete(r),this._menuFields&&(this._menuFieldsMap[r].disabled=!1))}getMenuFields(){let r=this.constructor;if(!r.fields)return[];if(this._menuFields)return this._menuFields;this._menuFieldsMap=this._getMenuFieldsMap(r);let A=[];for(let b of r.fields){let r="string"==typeof b?b:b.parameter;r in this._menuFieldsMap&&A.push(this._menuFieldsMap[r])}return this._menuFields=A,A}_getMenuFieldsMap(r){if(!r)return{};let A=Object.getPrototypeOf(r),b=this._getMenuFieldsMap(A);if(!r.fields)return b;for(let A of r.fields)if("string"!=typeof A&&!(A.parameter in b)){let r=this._createStandardField(A);r&&(b[A.parameter]=r)}return b}_createStandardField(r){if(r.type.name in ld)return this[ld[r.type.name]](r)}_createAssetEntityField(r){return new Wh({title:r.name,exclude:r.includeSelf?null:this._id,filter:"function"==typeof r.filter?r.filter:null,privateIds:r.privateIdsParameter?this._asset[r.privateIdsParameter]:null,includeScene:r.includeScene,initialValue:this._asset[r.parameter],getFromSource:()=>this._asset[r.parameter],onUpdate:A=>{this._updateParameter(r.parameter,A)}})}_createAssetSetField(r){return new AssetSetField({title:r.name,getOptions:r.optionsFunction,getNewOptions:r.newOptionsFunction,initialValue:this._asset[r.parameter],getFromSource:()=>this._asset[r.parameter],onAdd:A=>{this._addToParameter(r.parameter,r.addFunction,r.removeFunction,A)},onRemove:(A,b)=>{this._removeFromParameter(r.parameter,r.removeFunction,r.addFunction,A)}})}_createAudioField(r){return new AudioField({title:r.name,initialValue:this._asset[r.parameter],getFromSource:()=>this._asset[r.parameter],onUpdate:A=>{this._updateParameter(r.parameter,A)}})}_createCheckboxField(r){return new Xh({title:r.name,initialValue:this._asset[r.parameter],suppressMenuFocusEvent:1==r.suppressMenuFocusEvent,getFromSource:()=>this._asset[r.parameter],onUpdate:A=>{this._updateParameter(r.parameter,A)}})}_createColorField(r){return new Yh({title:r.name,initialValue:this._asset[r.parameter],getFromSource:()=>this._asset[r.parameter],onBlur:(A,b)=>{this._updateParameter(r.parameter,b,!1,!1,A)},onUpdate:A=>{this._updateParameter(r.parameter,A,!1,!0)}})}_createCubeImageField(r){return new Zh({title:r.name,initialValue:this._asset[r.parameter],getFromSource:()=>this._asset[r.parameter],onUpdate:A=>{this._updateParameter(r.parameter,A)}})}_createEnumField(r){return new Jh({title:r.name,initialValue:this._getKeyFromValue(r.map,this._asset[r.parameter]),options:Object.keys(r.map),getFromSource:()=>this._getKeyFromValue(r.map,this._asset[r.parameter]),onUpdate:A=>{this._updateParameter(r.parameter,r.map[A])}})}_createEulerField(r){return new $h({title:r.name,initialValue:this._asset[r.parameter],getFromSource:()=>this._asset[r.parameter],onBlur:(A,b)=>{this._updateParameter(r.parameter,b,!1,!1,A)},onUpdate:A=>{this._updateParameter(r.parameter,A,!1,!0)}})}_createImageField(r){return new ed({title:r.name,initialValue:this._asset[r.parameter],getFromSource:()=>this._asset[r.parameter],onUpdate:A=>{this._updateParameter(r.parameter,A)}})}_createMaterialField(r){return new sd({title:r.name,initialValue:this._asset[r.parameter],getFromSource:()=>this._asset[r.parameter],onUpdate:A=>{this._updateParameter(r.parameter,A)}})}_createNumberField(r){return new id({title:r.name,minValue:r.min,maxValue:r.max,initialValue:this._asset[r.parameter],getFromSource:()=>this._asset[r.parameter],onBlur:(A,b)=>{this._updateParameter(r.parameter,b,!1,!1,A)},onUpdate:A=>{this._updateParameter(r.parameter,A,!1,!0)}})}_createTextField(r){return new nd({title:r.name,initialValue:this._asset[r.parameter],getFromSource:()=>this._asset[r.parameter],singleLine:r.singleLine,onBlur:(A,b)=>{this._updateParameter(r.parameter,b,!1,!1,A)},onUpdate:A=>{this._updateParameter(r.parameter,A,!1,!0)}})}_createTextureField(r){return new rd({title:r.name,filter:Array.isArray(r.filter)?r.filter:null,initialValue:this._asset[r.parameter],getFromSource:()=>this._asset[r.parameter],onUpdate:A=>{this._updateParameter(r.parameter,A)}})}_createVector2Field(r){return new ad({title:r.name,initialValue:this._asset[r.parameter],getFromSource:()=>this._asset[r.parameter],onBlur:(A,b)=>{this._updateParameter(r.parameter,b,!1,!1,A)},onUpdate:A=>{this._updateParameter(r.parameter,A,!1,!0)}})}_createVector3Field(r){return new od({title:r.name,initialValue:this._asset[r.parameter],getFromSource:()=>this._asset[r.parameter],onBlur:(A,b)=>{this._updateParameter(r.parameter,b,!1,!1,A)},onUpdate:A=>{this._updateParameter(r.parameter,A,!1,!0)}})}_getKeyFromValue(r,A){for(let b in r)if(r[b]==A)return b}static FieldTypes={AssetEntityField:Wh,AssetSetField:AssetSetField,AudioField:AudioField,CheckboxField:Xh,ColorField:Yh,CubeImageField:Zh,EnumField:Jh,EulerField:$h,ImageField:ed,MaterialField:sd,NumberField:id,TextField:nd,TextureField:rd,Vector2Field:ad,Vector3Field:od}}nl.registerEditorHelper(EditorHelper,Asset);const{AssetEntityField:hd,CheckboxField:dd,EulerField:cd,NumberField:ud,Vector3Field:pd}=EditorHelper.FieldTypes,Ad=["position","rotation","scale"],gd={position:"publishPosition",rotation:"publishRotation",scale:"publishScale"},fd=[{handler:jh,tool:dh},{handler:Hh,tool:lh},{handler:Gh,tool:hh}];class AssetEntityHelper extends EditorHelper{constructor(A,b){super(A,b),this._object=A.object,this._attachedPeers=new Set,this._eventListeners=[],this._actionsAdded=!1,this._boundingBox="XR"==Mt.deviceType?this._asset.gripInteractable._boundingBox:new r.Box3,this._boundingBoxObj=new Box3Helper(this._boundingBox),this._overwriteAssetFunctions(),this._addDeleteSubscriptionForPromotions(),this._createActions()}_createActions(){if("XR"==Mt.deviceType){this._asset.gripInteractable.addHoveredCallback((r=>{r?Mt.scene.add(this._boundingBoxObj):Mt.scene.remove(this._boundingBoxObj)})),this._eventListeners.push({type:"grip",callback:r=>{this._disableParam("position"),this._disableParam("rotation"),this._disableParam("scale"),this._asset.gripInteractable.capture(r.owner),Nh.attach(this._asset,r.owner.id)},tool:ah,topic:"down"}),this._eventListeners.push({type:"grip",callback:r=>{let A=Nh._twoHandScaling;Nh.detach(r.owner.id),A||(this._enableParam("position"),this._enableParam("rotation"),this._enableParam("scale"))},tool:ah,topic:"click"}),this._eventListeners.push({type:"grip",callback:r=>{il.deleteAsset(this._asset)},tool:rh,topic:"down"}),this._eventListeners.push({type:"pointer",callback:r=>{il.deleteAsset(this._asset)},tool:rh,topic:"down"}),this._eventListeners.push({type:"pointer",callback:r=>{ch.copy(r.owner.id,this._asset)},tool:nh,topic:"click"}),this._eventListeners.push({type:"grip",callback:r=>{Qh.grab(r.owner.id,this._asset)},tool:oh,topic:"down"});for(let r of fd){let A=r.handler,b=r.tool;this._eventListeners.push({type:"grip",callback:r=>{this._disableParam("position"),this._disableParam("rotation"),this._disableParam("scale"),this._asset.gripInteractable.capture(r.owner),A.attach(r.owner.id,this._asset)},tool:b,topic:"down"}),this._eventListeners.push({type:"grip",callback:r=>{A.detach(r.owner.id),this._enableParam("position"),this._enableParam("rotation"),this._enableParam("scale")},tool:b,topic:"click"})}}else this._asset.pointerInteractable.addStateCallback((r=>{r==nn.HOVERED?(this._boundingBox.setFromObject(this._object),Mt.scene.add(this._boundingBoxObj)):(r!=nn.SELECTED||this._object!=Nh.getObject()||Nh._isDragging()||Nh.initiateDrag(),Mt.scene.remove(this._boundingBoxObj))})),this._eventListeners.push({type:"pointer",callback:r=>{Nh.detach(),Nh.attach(this._asset)},tool:ah,topic:"click"})}_addActions(){if(!this._actionsAdded){for(let r of this._eventListeners)this._asset[r.type+"Interactable"].addEventListener(r.topic,r.callback,{tool:r.tool});this._actionsAdded=!0}}_removeActions(){if(this._actionsAdded){for(let r of this._eventListeners)this._asset[r.type+"Interactable"].removeEventListener(r.topic,r.callback);this._attachedPeers=new Set,this._actionsAdded=!1}}updateVisualEdit(r){r!=this._asset._visualEdit&&(this._asset._visualEdit=r,r?this._object.parent&&0==this._attachedPeers.size&&this._addActions():this._removeActions())}attachToPeer(r,A){this._attachedPeers.add(A.ownerId),this._disableParam("position"),this._disableParam("rotation"),this._disableParam("scale"),A.twoHandScaling||this._subscribeToPeerDisconnected(r.id),A.isXR&&("translate"==A.type?jh.attach(A.ownerId,this._asset,A.position):"rotate"==A.type?Hh.attach(A.ownerId,this._asset,A.rotation):"scale"==A.type?Gh.attach(A.ownerId,this._asset,A.scale):Nh.attachToPeer(r,this._asset,A)),this._asset.visualEdit&&this._removeActions()}detachFromPeer(r,A){if(this._attachedPeers.delete(A.ownerId),A.isXR)if("translate"==A.type)jh.detach(A.ownerId,A.position);else if("rotate"==A.type)Hh.detach(A.ownerId,A.rotation);else if("scale"==A.type)Gh.detach(A.ownerId,A.scale);else if(Nh.detachFromPeer(r,this._asset,A),A.twoHandScaling)return;this._enableParam("position"),this._enableParam("rotation"),this._enableParam("scale"),this._unsubscribeFromPeerDisconnected(r.id),this._asset.visualEdit&&this._addActions()}_subscribeToPeerDisconnected(r){let A=this.getObjectTransformation();Qt.subscribe(this._id,"PEER_DISCONNECTED:"+r,(()=>{for(let r in A)this._asset[r]=A[r];this._asset.addTo(this._asset.parent),this._enableParam("position"),this._enableParam("rotation"),this._enableParam("scale"),this._asset.visualEdit&&this._addActions(),this._unsubscribeFromPeerDisconnected(r)}))}_unsubscribeFromPeerDisconnected(r){Qt.unsubscribe(this._id,"PEER_DISCONNECTED:"+r)}makeTranslucent(){this._object.traverse((function(A){if(A instanceof r.Mesh&&A.material)if(Array.isArray(A.material))for(let r=0;r<A.material.length;r++){let b=A.material[r],C=b.clone();makeMaterialTranslucent(C),C.userData.oldMaterial=b,A.material[r]=C}else{let r=A.material.clone();makeMaterialTranslucent(r),r.userData.oldMaterial=A.material,A.material=r}}))}returnTransparency(){this._object.traverse((function(A){if(A instanceof r.Mesh&&A.material)if(Array.isArray(A.material))for(let r=0;r<A.material.length;r++){let b=A.material[r];b.userData.oldMaterial&&(A.material[r]=b.userData.oldMaterial,disposeMaterial(b))}else{let r=A.material,b=A.material.userData;b.oldMaterial&&(A.material=b.oldMaterial,disposeMaterial(r))}}))}getObjectTransformation(){return{position:this._object.position.toArray(),rotation:this._object.rotation.toArray(),scale:this._object.scale.toArray()}}setObjectTransformation(r,A,b,C,I){let x=[];for(let b of Ad)if(!this._disabledParams.has(b)||I||Nh.getObject()==this._object&&!Nh._isDragging()){let C=r?r[b]:this._object[b].toArray(),I=A[b];if(C.reduce(((r,A,b)=>r&&I[b]==A),!0))continue;this._object[b].fromArray(I),this.updateMenuField(b),x.push(b)}0!=x.length&&(b||this._publish(x),C||sl.addAction((()=>{this.setObjectTransformation(null,r,b,!0)}),(()=>{this.setObjectTransformation(null,A,b,!0)})))}roundAttributes(r){let A=[];for(let r of Ad)this._object[r].roundWithPrecision(5)&&(A.push(r),this.updateMenuField(r));0!=A.length&&(r||(1==A.length?this._asset[gd[A[0]]]():this._asset.publishTransformation()))}place(r){let A=r.point;this._object.position.copy(this._object.parent.worldToLocal(A)),this.roundAttributes(!0)}preview(){let r=this._asset.exportParams();r.visualEdit=!1,delete r.id;let A=new this._asset.constructor(r);return A.makeTranslucent=this.makeTranslucent,A.makeTranslucent(),A}_overwriteAssetFunctions(){this._asset.onAddToProject=()=>this.onAddToProject(),this._asset._onRemoveFromProject=this._asset.onRemoveFromProject,this._asset.onRemoveFromProject=()=>{this._asset._onRemoveFromProject(),this.onRemoveFromProject()},Object.defineProperty(this._asset,"visualEdit",{get:function(){return this._visualEdit},set:r=>{this.updateVisualEdit(r)}})}_addDeleteSubscriptionForPromotions(){let r=this._asset.constructor.assetType+"_DELETED:"+this._asset.assetId+":"+this._id;Qt.subscribe(this._id,r,(r=>{if(r.asset!=this._asset)return;this._enableParam("position"),this._enableParam("rotation"),this._enableParam("scale");let A=r.undoRedoAction;if(!A||A.promotionUpdateAdded)return;this._promoteChildren(A);let b=A.undo,C=A.redo;A.undo=()=>{b(),this._demoteChildren(A)},A.redo=()=>{C(),this._promoteChildren(A)},A.promotionUpdateAdded=!0}))}_promoteChildren(r){r.promotedChildren=new Set;for(let A of this._asset.children)r.promotedChildren.add(A);for(let A of r.promotedChildren)A.object.applyMatrix4(this._object.matrix),A.addTo(this._asset.parent)}_demoteChildren(r){let A=this._object.matrix.clone().invert();for(let b of r.promotedChildren)if(b.parent==this._asset.parent){b.attachTo(this._asset);let r=b.object;r.parent||r.applyMatrix4(A)}}addTo(r,A,b){let C=this._asset.parent;this._asset.addTo(r,A),C!=r&&(b||sl.addAction((()=>{this.addTo(C,A,!0)}),(()=>{this.addTo(r,A,!0)})))}attachTo(r,A,b){let C=this._asset.parent;this._asset.attachTo(r,A),C!=r&&(b||sl.addAction((()=>{this.attachTo(C,A,!0)}),(()=>{this.attachTo(r,A,!0)})))}onAddToProject(){!this._asset.visualEdit||this._attachedPeers.size>0||this._addActions()}onRemoveFromProject(){this._attachedPeers.clear(),Mt.scene.remove(this._boundingBoxObj),fullDispose(this._boundingBoxObj),this._removeActions()}static fields=[{parameter:"parentId",name:"Parent",includeScene:!0,type:hd},{parameter:"position",name:"Position",type:pd},{parameter:"rotation",name:"Rotation",type:cd},{parameter:"scale",name:"Scale",type:pd},{parameter:"visualEdit",name:"Visually Edit",type:dd},{parameter:"renderOrder",name:"Render Order",type:ud}]}function makeMaterialTranslucent(r){r.opacity=.5,r.transparent=!0}nl.registerEditorHelper(AssetEntityHelper,AssetEntity);const{CheckboxField:md,TextField:_d}=AssetEntityHelper.FieldTypes;class PlayableMediaAssetHelper extends AssetEntityHelper{constructor(r,A){super(r,A),this._createPreviewFunctions()}_createPreviewFunctions(){this._previewMedia=!1,Object.defineProperty(this._asset,"previewMedia",{get:()=>this._previewMedia,set:r=>{this._previewMedia=r,r?il.getAsset(this._id)&&this._asset.play(null,!0):this._asset.stop(!0)}})}static fields=["visualEdit",{parameter:"previewMedia",name:"Preview Media",suppressMenuFocusEvent:!0,type:md},{parameter:"autoplay",name:"Auto Play",suppressMenuFocusEvent:!0,type:md},{parameter:"loop",name:"Loop",suppressMenuFocusEvent:!0,type:md},{parameter:"playTopic",name:"Play Event",singleLine:!0,type:_d},{parameter:"pauseTopic",name:"Pause Event",singleLine:!0,type:_d},{parameter:"stopTopic",name:"Stop Event",singleLine:!0,type:_d},"parentId","position","rotation","scale"]}nl.registerEditorHelper(PlayableMediaAssetHelper,PlayableMediaEntity);const{EnumField:bd,NumberField:yd}=PlayableMediaAssetHelper.FieldTypes;nl.registerEditorHelper(class AudioAssetHelper extends PlayableMediaAssetHelper{constructor(r){super(r,Rt.AUDIO_UPDATED),this._createMesh()}_createMesh(){let A=new r.SphereGeometry(.07),b=new r.MeshLambertMaterial({color:qa.blue});this._mesh=new r.Mesh(A,b),this._asset.visualEdit&&this._object.add(this._mesh)}updateVisualEdit(r){r?this._object.add(this._mesh):(this._object.remove(this._mesh),fullDispose(this._mesh)),super.updateVisualEdit(r)}static fields=["visualEdit","previewMedia","autoplay",{parameter:"coneInnerAngle",name:"Cone Inner Angle",min:0,max:360,type:yd},{parameter:"coneOuterAngle",name:"Cone Outer Angle",min:0,max:360,type:yd},{parameter:"coneOuterGain",name:"Cone Outer Gain",min:0,max:1,type:yd},{parameter:"distanceModel",name:"Distance Model",map:mo,type:bd},"loop",{parameter:"maxDistance",name:"Max Rolloff Distance",min:.01,type:yd},{parameter:"refDistance",name:"Min Rolloff Distance",min:0,type:yd},{parameter:"rolloffFactor",name:"Rolloff Factor",min:0,type:yd},{parameter:"volume",name:"Volume",min:0,type:yd},"playTopic","pauseTopic","stopTopic","parentId","position","rotation","scale"]},AudioAsset);const{CheckboxField:vd,EnumField:Cd,NumberField:wd}=EditorHelper.FieldTypes;class MaterialHelper extends EditorHelper{constructor(r){super(r,Rt.MATERIAL_UPDATED)}_addSubscriptions(){let r=this._asset.getMaps();Qt.subscribe(this._id,Rt.TEXTURE_DELETED,(A=>{let b=[];for(let C of r)this._asset[C+"Id"]==A.asset.id&&(this._updateParameter(C+"Id",null,!1,!0),this.updateMenuField(C+"Id"),b.push(C));if(A.undoRedoAction&&b.length>0){let r=A.undoRedoAction.undo;A.undoRedoAction.undo=()=>{r();for(let r of b)this._updateParameter(r+"Id",A.asset.id,!1,!0),this.updateMenuField(r+"Id")}}})),Qt.subscribe(this._id,Rt.TEXTURE_UPDATED,(A=>{let b=A.asset.id;this._updateMapIfUsed(b,r)})),Qt.subscribe(this._id,Rt.TEXTURE_ADDED,(A=>{let b=A.id;this._updateMapIfUsed(b,r)}))}_updateMapIfUsed(r,A){for(let b of A)this._asset[b+"Id"]==r&&(this._asset._setTexture(b,r),this.updateMenuField(b+"Id"))}_removeSubscriptions(){Qt.unsubscribe(this._id,Rt.TEXTURE_DELETED),Qt.unsubscribe(this._id,Rt.TEXTURE_UPDATED)}dispose(){this._removeSubscriptions()}undoDispose(){this._addSubscriptions()}static fields=[{parameter:"transparent",name:"Transparent",type:vd},{parameter:"opacity",name:"Opacity",min:0,max:1,type:wd},{parameter:"side",name:"Display",map:yo,type:Cd}]}nl.registerEditorHelper(MaterialHelper,Material);const{CheckboxField:Ed,ColorField:Id,EnumField:Td,NumberField:xd,TextureField:Sd}=MaterialHelper.FieldTypes;nl.registerEditorHelper(class BasicMaterialHelper extends MaterialHelper{constructor(r){super(r)}static fields=[{parameter:"color",name:"Color",type:Id},{parameter:"mapId",name:"Texture Map",filter:[sh],type:Sd},"side","transparent","opacity",{parameter:"alphaMapId",name:"Alpha Map",filter:[sh],type:Sd},{parameter:"wireframe",name:"Wireframe",type:Ed},{parameter:"envMapId",name:"Environment Map",filter:[ih],type:Sd},{parameter:"combine",name:"Color & Environment Blend",map:fo,type:Td},{parameter:"reflectivity",name:"Reflectivity",min:0,max:1,type:xd},{parameter:"refractionRatio",name:"Refraction Ratio",min:0,max:1,type:xd}]},BasicMaterial);const{EnumField:Bd}=EditorHelper.FieldTypes;class TextureHelper extends EditorHelper{constructor(r){super(r,Rt.TEXTURE_UPDATED)}static fields=[{parameter:"colorSpace",name:"Color Space",map:go,type:Bd}]}nl.registerEditorHelper(TextureHelper,Texture);const{EnumField:Dd,ImageField:Pd,Vector2Field:Md}=TextureHelper.FieldTypes;nl.registerEditorHelper(class BasicTextureHelper extends TextureHelper{constructor(r){super(r)}static fields=[{parameter:"image",name:"Image",type:Pd},{parameter:"wrapS",name:"Horizontal Wrapping",map:vo,type:Dd},{parameter:"wrapT",name:"Vertical Wrapping",map:vo,type:Dd},{parameter:"repeat",name:"Repeat",type:Md},{parameter:"offset",name:"Offset",type:Md},"colorSpace"]},BasicTexture);class ComponentHelper extends EditorHelper{constructor(r){super(r,Rt.COMPONENT_UPDATED)}}nl.registerEditorHelper(ComponentHelper,Component);const{EnumField:kd,TextField:Rd}=ComponentHelper.FieldTypes,Fd={None:"none",Click:"click",Drag:"drag",Down:"down",Up:"up",Move:"move",Over:"over",Out:"out"},Ld={None:"none",Click:"click",Drag:"drag",Down:"down",Up:"up"};nl.registerEditorHelper(class PublishComponentHelper extends ComponentHelper{constructor(r){super(r)}static fields=[{parameter:"topic",name:"Event",singleLine:!0,type:Rd},{parameter:"pointerEvent",name:"Pointer Action",map:Fd,type:kd},{parameter:"gripEvent",name:"Grip Action",map:Fd,type:kd},{parameter:"touchEvent",name:"Touch Action",map:Ld,type:kd}]},PublishComponent);const{EnumField:Od}=AssetEntityHelper.FieldTypes;nl.registerEditorHelper(class ImageAssetHelper extends AssetEntityHelper{constructor(r){super(r,Rt.IMAGE_UPDATED)}place(r){let{object:A,point:b}=r;A.updateMatrixWorld();let C=r.face.normal.clone().transformDirection(A.matrixWorld).clampLength(0,.001);Mt.camera.getWorldDirection(ao[0]).dot(C)>0&&C.negate(),b.add(C),this._object.position.copy(b),this._object.parent.worldToLocal(this._object.position),b.add(C),this._object.lookAt(b),this.roundAttributes(!0)}static fields=["visualEdit",{parameter:"side",name:"Display",map:yo,type:Od},"parentId","position","rotation","scale","renderOrder"]},ImageAsset);const{EnumField:Ud}=PlayableMediaAssetHelper.FieldTypes;nl.registerEditorHelper(class VideoAssetHelper extends PlayableMediaAssetHelper{constructor(r){super(r,Rt.VIDEO_UPDATED)}place(r){let{object:A,point:b}=r;A.updateMatrixWorld();let C=r.face.normal.clone().transformDirection(A.matrixWorld).clampLength(0,.001);Mt.camera.getWorldDirection(ao[0]).dot(C)>0&&C.negate(),b.add(C),this._object.position.copy(b),this._object.parent.worldToLocal(this._object.position),b.add(C),this._object.lookAt(b),this.roundAttributes(!0)}static fields=["visualEdit","previewMedia",{parameter:"side",name:"Display",map:yo,type:Ud},"autoplay","loop","playTopic","pauseTopic","stopTopic","parentId","position","rotation","scale"]},VideoAsset);const{EnumField:Nd,CubeImageField:Qd}=TextureHelper.FieldTypes;nl.registerEditorHelper(class CubeTextureHelper extends TextureHelper{constructor(r){super(r)}static fields=[{parameter:"images",name:"Images",type:Qd},{parameter:"mapping",name:"Mapping",map:_o,type:Nd},"colorSpace"]},CubeTexture);class CustomAsset extends Asset{constructor(r={}){super(r)}static assetType=kt.CUSTOM_ASSET}class CustomAssetHelper extends EditorHelper{constructor(r){super(r,Rt.CUSTOM_ASSET_UPDATED)}}nl.registerEditorHelper(CustomAssetHelper,CustomAsset);nl.registerEditorHelper(class ModelAssetHelper extends AssetEntityHelper{constructor(r){super(r,Rt.MODEL_UPDATED)}static fields=["visualEdit","parentId","position","rotation","scale","renderOrder"]},ModelAsset);const{ColorField:Hd,NumberField:Gd}=AssetEntityHelper.FieldTypes;class LightHelper extends AssetEntityHelper{constructor(r){super(r,Rt.LIGHT_UPDATED)}static fields=["visualEdit",{parameter:"intensity",name:"Intensity",min:0,type:Gd},{parameter:"color",name:"Color",type:Hd},"parentId","position","rotation","scale"]}nl.registerEditorHelper(LightHelper,Light);nl.registerEditorHelper(class AmbientLightHelper extends LightHelper{constructor(r){super(r)}static fields=["intensity","color"]},AmbientLight);const{ColorField:jd,EnumField:Vd,NumberField:zd,TextField:Wd}=AssetEntityHelper.FieldTypes;class TextAssetHelper extends AssetEntityHelper{constructor(r){super(r,Rt.TEXT_UPDATED)}place(r){let{object:A,point:b}=r;A.updateMatrixWorld();let C=r.face.normal.clone().transformDirection(A.matrixWorld).clampLength(0,.001);Mt.camera.getWorldDirection(ao[0]).dot(C)>0&&C.negate(),b.add(C),this._object.position.copy(b),this._object.parent.worldToLocal(this._object.position),b.add(C),this._object.lookAt(b),this.roundAttributes(!0)}static fields=[{parameter:"text",name:"Text",type:Wd},{parameter:"fontSize",name:"Font Size",min:0,type:zd},{parameter:"fontColor",name:"Font Color",type:jd},{parameter:"textAlign",name:"Text Alignment",map:{Left:"left",Center:"center",Right:"right"},type:Vd}]}nl.registerEditorHelper(TextAssetHelper,TextAsset);const{NumberField:Xd}=TextAssetHelper.FieldTypes;nl.registerEditorHelper(class PlainTextHelper extends TextAssetHelper{constructor(r){super(r)}static fields=["visualEdit","text","fontSize",{parameter:"maxWidth",name:"Max Width",min:0,type:Xd},"fontColor","textAlign","position","rotation","scale","renderOrder"]},PlainText);const{ColorField:Yd,EnumField:Kd,NumberField:qd}=TextAssetHelper.FieldTypes;nl.registerEditorHelper(class TextOverlayHelper extends TextAssetHelper{constructor(r){super(r)}static fields=["visualEdit","text","fontSize",{parameter:"width",name:"Width",min:0,type:qd},{parameter:"height",name:"Height",min:0,type:qd},"fontColor",{parameter:"backgroundColor",name:"Background Color",type:Yd},{parameter:"backgroundOpacity",name:"Background Opacity",min:0,type:qd},{parameter:"borderRadius",name:"Border Radius",min:0,type:qd},{parameter:"padding",name:"Padding",min:0,type:qd},{parameter:"justifyContent",name:"Justify Content",map:{Start:"start",Center:"center",End:"end"},type:Kd},"textAlign","position","rotation","scale","renderOrder"]},TextOverlay);const{MaterialField:Zd}=AssetEntityHelper.FieldTypes;class ShapeHelper extends AssetEntityHelper{constructor(r){super(r,Rt.SHAPE_UPDATED),this._overwriteSetMaterial()}_overwriteSetMaterial(){Object.defineProperty(this._asset,"materialId",{get:function(){return this._materialId},set:r=>{let A=this._asset.mesh.material.userData.oldMaterial;A&&this.returnTransparency(),this._asset._materialId=r;let b=this._asset._mesh.material,C=this._asset._getMaterial();this._asset._mesh.material=C,b.dispose(),A&&this.makeTranslucent()}})}_addSubscriptions(){Qt.subscribe(this._id,Rt.MATERIAL_DELETED,(r=>{if(this._asset.materialId==r.asset.id&&(this._updateParameter("materialId",null,!1,!0),this.updateMenuField("materialId"),r.undoRedoAction)){let A=r.undoRedoAction.undo;r.undoRedoAction.undo=()=>{A(),this._updateParameter("materialId",r.asset.id,!1,!0),this.updateMenuField("materialId")}}})),Qt.subscribe(this._id,Rt.MATERIAL_ADDED,(r=>{this._asset.materialId==r.id&&(this._asset.materialId=r.id)}))}_removeSubscriptions(){Qt.unsubscribe(this._id,Rt.MATERIAL_DELETED)}onAddToProject(){super.onAddToProject(),this._addSubscriptions()}onRemoveFromProject(){super.onRemoveFromProject(),this._removeSubscriptions()}static fields=[{parameter:"materialId",name:"Material",type:Zd}]}nl.registerEditorHelper(ShapeHelper,Shape);const{NumberField:Jd}=ShapeHelper.FieldTypes;nl.registerEditorHelper(class BoxShapeHelper extends ShapeHelper{constructor(r){super(r)}static fields=["visualEdit","materialId",{parameter:"width",name:"Width",min:0,type:Jd},{parameter:"height",name:"Height",min:0,type:Jd},{parameter:"depth",name:"Depth",min:0,type:Jd},{parameter:"widthSegments",name:"Width Segments",min:1,type:Jd},{parameter:"heightSegments",name:"Height Segments",min:1,type:Jd},{parameter:"depthSegments",name:"Depth Segments",min:1,type:Jd},"parentId","position","rotation","scale","renderOrder"]},BoxShape);const{NumberField:$d}=ShapeHelper.FieldTypes;nl.registerEditorHelper(class CircleShapeHelper extends ShapeHelper{constructor(r){super(r)}place(r){let{object:A,point:b}=r;A.updateMatrixWorld();let C=r.face.normal.clone().transformDirection(A.matrixWorld).clampLength(0,.001);Mt.camera.getWorldDirection(ao[0]).dot(C)>0&&C.negate(),b.add(C),this._object.position.copy(b),this._object.parent.worldToLocal(this._object.position),b.add(C),this._object.lookAt(b),this.roundAttributes(!0)}static fields=["visualEdit","materialId",{parameter:"radius",name:"Radius",min:0,type:$d},{parameter:"segments",name:"Sides",min:3,type:$d},{parameter:"thetaLength",name:"Degrees",min:0,max:360,type:$d},"parentId","position","rotation","scale","renderOrder"]},CircleShape);const{CheckboxField:ec,NumberField:tc}=ShapeHelper.FieldTypes;nl.registerEditorHelper(class ConeShapeHelper extends ShapeHelper{constructor(r){super(r)}static fields=["visualEdit","materialId",{parameter:"height",name:"Height",min:0,type:tc},{parameter:"radius",name:"Radius",min:0,type:tc},{parameter:"radialSegments",name:"Sides",min:3,type:tc},{parameter:"heightSegments",name:"Height Segments",min:1,type:tc},{parameter:"thetaLength",name:"Degrees",min:0,max:360,type:tc},{parameter:"openEnded",name:"Open Ended",type:ec},"parentId","position","rotation","scale","renderOrder"]},ConeShape);const{CheckboxField:sc,NumberField:ic}=ShapeHelper.FieldTypes;nl.registerEditorHelper(class CylinderShapeHelper extends ShapeHelper{constructor(r){super(r)}static fields=["visualEdit","materialId",{parameter:"height",name:"Height",min:0,type:ic},{parameter:"radiusTop",name:"Top Radius",min:0,type:ic},{parameter:"radiusBottom",name:"Bottom Radius",min:0,type:ic},{parameter:"radialSegments",name:"Sides",min:3,type:ic},{parameter:"heightSegments",name:"Height Segments",min:1,type:ic},{parameter:"thetaLength",name:"Degrees",min:0,max:360,type:ic},{parameter:"openEnded",name:"Open Ended",type:sc},"parentId","position","rotation","scale","renderOrder"]},CylinderShape);const{Vector3Field:nc}=LightHelper.FieldTypes;nl.registerEditorHelper(class DirectionalLightHelper extends LightHelper{constructor(r){super(r)}static fields=["intensity","color",{parameter:"direction",name:"Direction",type:nc}]},DirectionalLight);const{ColorField:rc}=LightHelper.FieldTypes;nl.registerEditorHelper(class HemisphereLightHelper extends LightHelper{constructor(r){super(r)}static fields=["intensity","color",{parameter:"groundColor",name:"Ground Color",type:rc}]},HemisphereLight);const{NumberField:ac,TextureField:oc}=LightHelper.FieldTypes;nl.registerEditorHelper(class SpotLightHelper extends LightHelper{constructor(r){super(r),this._createMesh()}_createMesh(){let A=new r.ConeGeometry(.07,.14,8);A.translate(0,-.07,0);let b=new r.MeshBasicMaterial({color:qa.yellow});this._mesh=new r.Mesh(A,b),this._asset.visualEdit&&this._object.add(this._mesh)}updateVisualEdit(r){r?this._object.add(this._mesh):(this._object.remove(this._mesh),fullDispose(this._mesh)),super.updateVisualEdit(r)}static fields=["visualEdit","color","intensity",{parameter:"angle",name:"Angle",min:0,max:180,type:ac},{parameter:"distance",name:"Distance",min:0,type:ac},{parameter:"decay",name:"Decay",min:0,type:ac},{parameter:"penumbra",name:"Penumbra",min:0,max:1,type:ac},{parameter:"mapId",name:"Texture",type:oc},"parentId","position","rotation","scale"]},SpotLight);const{NumberField:lc}=ShapeHelper.FieldTypes;nl.registerEditorHelper(class PlaneShapeHelper extends ShapeHelper{constructor(r){super(r)}place(r){let{object:A,point:b}=r;A.updateMatrixWorld();let C=r.face.normal.clone().transformDirection(A.matrixWorld).clampLength(0,.001);Mt.camera.getWorldDirection(ao[0]).dot(C)>0&&C.negate(),b.add(C),this._object.position.copy(b),this._object.parent.worldToLocal(this._object.position),b.add(C),this._object.lookAt(b),this.roundAttributes(!0)}static fields=["visualEdit","materialId",{parameter:"width",name:"Width",min:0,type:lc},{parameter:"height",name:"Height",min:0,type:lc},{parameter:"widthSegments",name:"Width Segments",min:1,type:lc},{parameter:"heightSegments",name:"Height Segments",min:1,type:lc},"parentId","position","rotation","scale","renderOrder"]},PlaneShape);const{NumberField:hc}=LightHelper.FieldTypes;nl.registerEditorHelper(class PointLightHelper extends LightHelper{constructor(r){super(r),this._createMesh()}_createMesh(){let A=new r.SphereGeometry(.07),b=new r.MeshBasicMaterial({color:qa.yellow});this._mesh=new r.Mesh(A,b),this._asset.visualEdit&&this._object.add(this._mesh)}updateVisualEdit(r){r?this._object.add(this._mesh):(this._object.remove(this._mesh),fullDispose(this._mesh)),super.updateVisualEdit(r)}static fields=["visualEdit","color","intensity",{parameter:"distance",name:"Distance",min:0,type:hc},{parameter:"decay",name:"Decay",min:0,type:hc},"parentId","position","rotation","scale"]},PointLight);const{NumberField:dc}=ShapeHelper.FieldTypes;nl.registerEditorHelper(class RingShapeHelper extends ShapeHelper{constructor(r){super(r)}place(r){let{object:A,point:b}=r;A.updateMatrixWorld();let C=r.face.normal.clone().transformDirection(A.matrixWorld).clampLength(0,.001);Mt.camera.getWorldDirection(ao[0]).dot(C)>0&&C.negate(),b.add(C),this._object.position.copy(b),this._object.parent.worldToLocal(this._object.position),b.add(C),this._object.lookAt(b),this.roundAttributes(!0)}static fields=["visualEdit","materialId",{parameter:"innerRadius",name:"Inner Radius",min:0,type:dc},{parameter:"outerRadius",name:"Outer Radius",min:0,type:dc},{parameter:"thetaSegments",name:"Sides",min:3,type:dc},{parameter:"phiSegments",name:"Radius Segments",min:1,type:dc},{parameter:"thetaLength",name:"Degrees",min:0,max:360,type:dc},"parentId","position","rotation","scale","renderOrder"]},RingShape);const{NumberField:cc}=ShapeHelper.FieldTypes;nl.registerEditorHelper(class SphereShapeHelper extends ShapeHelper{constructor(r){super(r)}static fields=["visualEdit","materialId",{parameter:"radius",name:"Radius",min:0,type:cc},{parameter:"widthSegments",name:"Horizontal Sides",min:3,type:cc},{parameter:"heightSegments",name:"Vertical Sides",min:2,type:cc},{parameter:"phiLength",name:"Horizontal Degrees",min:0,max:360,type:cc},{parameter:"thetaLength",name:"Vertical Degrees",min:0,max:180,type:cc},"parentId","position","rotation","scale","renderOrder"]},SphereShape);const{NumberField:uc}=ShapeHelper.FieldTypes;nl.registerEditorHelper(class TorusShapeHelper extends ShapeHelper{constructor(r){super(r)}static fields=["visualEdit","materialId",{parameter:"radius",name:"Radius",min:0,type:uc},{parameter:"tube",name:"Tube Radius",min:0,type:uc},{parameter:"radialSegments",name:"Radial Sides",min:2,type:uc},{parameter:"tubularSegments",name:"Tubular Sides",min:3,type:uc},{parameter:"arc",name:"Degrees",min:0,max:360,type:uc},"parentId","position","rotation","scale","renderOrder"]},TorusShape);const{CheckboxField:pc,ColorField:Ac,EnumField:gc,NumberField:fc,TextureField:mc,Vector2Field:_c}=MaterialHelper.FieldTypes;nl.registerEditorHelper(class StandardMaterialHelper extends MaterialHelper{constructor(r){super(r)}static fields=[{parameter:"color",name:"Color",type:Ac},{parameter:"mapId",name:"Texture Map",filter:[sh],type:mc},"side","transparent","opacity",{parameter:"alphaMapId",name:"Alpha Map",filter:[sh],type:mc},{parameter:"flatShading",name:"Flat Shading",type:pc},{parameter:"wireframe",name:"Wireframe",type:pc},{parameter:"bumpMapId",name:"Bump Map",filter:[sh],type:mc},{parameter:"bumpScale",name:"Bump Scale",min:0,max:1,type:fc},{parameter:"displacementMapId",name:"Displacement Map",filter:[sh],type:mc},{parameter:"displacementScale",name:"Displacement Scale",type:fc},{parameter:"displacementBias",name:"Displacement Bias",type:fc},{parameter:"emissive",name:"Emissive Color",type:Ac},{parameter:"emissiveMapId",name:"Emissive Map",filter:[sh],type:mc},{parameter:"emissiveIntensity",name:"Emissive Intensity",min:0,type:fc},{parameter:"envMapId",name:"Environment Map",filter:[ih],type:mc},{parameter:"envMapIntensity",name:"Environment Intensity",min:0,type:fc},{parameter:"metalness",name:"Metalness",min:0,max:1,type:fc},{parameter:"metalnessMapId",name:"Metalness Map",filter:[sh],type:mc},{parameter:"normalMapId",name:"Normal Map",filter:[sh],type:mc},{parameter:"normalMapType",name:"Normal Type",map:bo,type:gc},{parameter:"normalScale",name:"Normal Scale",min:0,max:1,type:_c},{parameter:"roughness",name:"Roughness",min:0,max:1,type:fc},{parameter:"roughnessMapId",name:"Roughness Map",filter:[sh],type:mc}]},StandardMaterial);class SystemHelper extends EditorHelper{constructor(r){super(r,Rt.SYSTEM_UPDATED)}}nl.registerEditorHelper(SystemHelper,System);const{CheckboxField:bc,ColorField:yc,EnumField:vc,NumberField:Cc,TextureField:wc,Vector2Field:Ec}=MaterialHelper.FieldTypes;nl.registerEditorHelper(class ToonMaterialHelper extends MaterialHelper{constructor(r){super(r)}static fields=[{parameter:"color",name:"Color",type:yc},{parameter:"mapId",name:"Texture Map",filter:[sh],type:wc},"side","transparent","opacity",{parameter:"alphaMapId",name:"Alpha Map",filter:[sh],type:wc},{parameter:"wireframe",name:"Wireframe",type:bc},{parameter:"bumpMapId",name:"Bump Map",filter:[sh],type:wc},{parameter:"bumpScale",name:"Bump Scale",min:0,max:1,type:Cc},{parameter:"displacementMapId",name:"Displacement Map",filter:[sh],type:wc},{parameter:"displacementScale",name:"Displacement Scale",type:Cc},{parameter:"displacementBias",name:"Displacement Bias",type:Cc},{parameter:"emissive",name:"Emissive Color",type:yc},{parameter:"emissiveMapId",name:"Emissive Map",filter:[sh],type:wc},{parameter:"emissiveIntensity",name:"Emissive Intensity",min:0,type:Cc},{parameter:"normalMapId",name:"Normal Map",filter:[sh],type:wc},{parameter:"normalMapType",name:"Normal Type",map:bo,type:vc},{parameter:"normalScale",name:"Normal Scale",min:0,max:1,type:Ec}]},ToonMaterial);var Ic="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0;function download(r,A,b){var C=new XMLHttpRequest;C.open("GET",r),C.responseType="blob",C.onload=function(){Sc(C.response,A,b)},C.onerror=function(){console.error("could not download file")},C.send()}function corsEnabled(r){var A=new XMLHttpRequest;A.open("HEAD",r,!1);try{A.send()}catch(r){}return A.status>=200&&A.status<=299}function click(r){try{r.dispatchEvent(new MouseEvent("click"))}catch(b){var A=document.createEvent("MouseEvents");A.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),r.dispatchEvent(A)}}var Tc,xc=Ic.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),Sc=Ic.saveAs||("object"!=typeof window||window!==Ic?function saveAs(){}:"download"in HTMLAnchorElement.prototype&&!xc?function saveAs(r,A,b){var C=Ic.URL||Ic.webkitURL,I=document.createElement("a");A=A||r.name||"download",I.download=A,I.rel="noopener","string"==typeof r?(I.href=r,I.origin!==location.origin?corsEnabled(I.href)?download(r,A,b):click(I,I.target="_blank"):click(I)):(I.href=C.createObjectURL(r),setTimeout((function(){C.revokeObjectURL(I.href)}),4e4),setTimeout((function(){click(I)}),0))}:"msSaveOrOpenBlob"in navigator?function saveAs(r,A,b){if(A=A||r.name||"download","string"==typeof r)if(corsEnabled(r))download(r,A,b);else{var C=document.createElement("a");C.href=r,C.target="_blank",setTimeout((function(){click(C)}))}else navigator.msSaveOrOpenBlob(function bom(r,A){return void 0===A?A={autoBom:!1}:"object"!=typeof A&&(console.warn("Deprecated: Expected third argument to be a object"),A={autoBom:!A}),A.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(r.type)?new Blob([String.fromCharCode(65279),r],{type:r.type}):r}(r,b),A)}:function saveAs(r,A,b,C){if((C=C||open("","_blank"))&&(C.document.title=C.document.body.innerText="downloading..."),"string"==typeof r)return download(r,A,b);var I="application/octet-stream"===r.type,x=/constructor/i.test(Ic.HTMLElement)||Ic.safari,S=/CriOS\/[\d]+/.test(navigator.userAgent);if((S||I&&x||xc)&&"undefined"!=typeof FileReader){var B=new FileReader;B.onloadend=function(){var r=B.result;r=S?r:r.replace(/^data:[^;]*;/,"data:attachment/file;"),C?C.location.href=r:location=r,C=null},B.readAsDataURL(r)}else{var D=Ic.URL||Ic.webkitURL,R=D.createObjectURL(r);C?C.location=R:location.href=R,C=null,setTimeout((function(){D.revokeObjectURL(R)}),4e4)}});Ic.saveAs=Sc.saveAs=Sc,"undefined"!=typeof module&&(module.exports=Sc)
/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/,function(r){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=r();else if("function"==typeof define&&define.amd)define([],r);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).JSZip=r()}}((function(){return function e(r,A,b){function s(I,x){if(!A[I]){if(!r[I]){var S="function"==typeof require&&require;if(!x&&S)return S(I,!0);if(C)return C(I,!0);var B=new Error("Cannot find module '"+I+"'");throw B.code="MODULE_NOT_FOUND",B}var D=A[I]={exports:{}};r[I][0].call(D.exports,(function(A){var b=r[I][1][A];return s(b||A)}),D,D.exports,e,r,A,b)}return A[I].exports}for(var C="function"==typeof require&&require,I=0;I<b.length;I++)s(b[I]);return s}({1:[function(r,A,b){var C=r("./utils"),I=r("./support"),x="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";b.encode=function(r){for(var A,b,I,S,B,D,R,F=[],N=0,Q=r.length,H=Q,G="string"!==C.getTypeOf(r);N<r.length;)H=Q-N,G?(A=r[N++],b=N<Q?r[N++]:0,I=N<Q?r[N++]:0):(A=r.charCodeAt(N++),b=N<Q?r.charCodeAt(N++):0,I=N<Q?r.charCodeAt(N++):0),S=A>>2,B=(3&A)<<4|b>>4,D=H>1?(15&b)<<2|I>>6:64,R=H>2?63&I:64,F.push(x.charAt(S)+x.charAt(B)+x.charAt(D)+x.charAt(R));return F.join("")},b.decode=function(r){var A,b,C,S,B,D,R=0,F=0,N="data:";if(r.substr(0,5)===N)throw new Error("Invalid base64 input, it looks like a data url.");var Q,H=3*(r=r.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(r.charAt(r.length-1)===x.charAt(64)&&H--,r.charAt(r.length-2)===x.charAt(64)&&H--,H%1!=0)throw new Error("Invalid base64 input, bad content length.");for(Q=I.uint8array?new Uint8Array(0|H):new Array(0|H);R<r.length;)A=x.indexOf(r.charAt(R++))<<2|(S=x.indexOf(r.charAt(R++)))>>4,b=(15&S)<<4|(B=x.indexOf(r.charAt(R++)))>>2,C=(3&B)<<6|(D=x.indexOf(r.charAt(R++))),Q[F++]=A,64!==B&&(Q[F++]=b),64!==D&&(Q[F++]=C);return Q}},{"./support":30,"./utils":32}],2:[function(r,A,b){var C=r("./external"),I=r("./stream/DataWorker"),x=r("./stream/Crc32Probe"),S=r("./stream/DataLengthProbe");function CompressedObject(r,A,b,C,I){this.compressedSize=r,this.uncompressedSize=A,this.crc32=b,this.compression=C,this.compressedContent=I}CompressedObject.prototype={getContentWorker:function(){var r=new I(C.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new S("data_length")),A=this;return r.on("end",(function(){if(this.streamInfo.data_length!==A.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")})),r},getCompressedWorker:function(){return new I(C.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},CompressedObject.createWorkerFrom=function(r,A,b){return r.pipe(new x).pipe(new S("uncompressedSize")).pipe(A.compressWorker(b)).pipe(new S("compressedSize")).withStreamInfo("compression",A)},A.exports=CompressedObject},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(r,A,b){var C=r("./stream/GenericWorker");b.STORE={magic:"\0\0",compressWorker:function(){return new C("STORE compression")},uncompressWorker:function(){return new C("STORE decompression")}},b.DEFLATE=r("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(r,A,b){var C=r("./utils");var I=function makeTable(){for(var r,A=[],b=0;b<256;b++){r=b;for(var C=0;C<8;C++)r=1&r?3988292384^r>>>1:r>>>1;A[b]=r}return A}();A.exports=function crc32wrapper(r,A){return void 0!==r&&r.length?"string"!==C.getTypeOf(r)?function crc32(r,A,b,C){var x=I,S=C+b;r^=-1;for(var B=C;B<S;B++)r=r>>>8^x[255&(r^A[B])];return-1^r}(0|A,r,r.length,0):function crc32str(r,A,b,C){var x=I,S=C+b;r^=-1;for(var B=C;B<S;B++)r=r>>>8^x[255&(r^A.charCodeAt(B))];return-1^r}(0|A,r,r.length,0):0}},{"./utils":32}],5:[function(r,A,b){b.base64=!1,b.binary=!1,b.dir=!1,b.createFolders=!0,b.date=null,b.compression=null,b.compressionOptions=null,b.comment=null,b.unixPermissions=null,b.dosPermissions=null},{}],6:[function(r,A,b){var C=null;C="undefined"!=typeof Promise?Promise:r("lie"),A.exports={Promise:C}},{lie:37}],7:[function(r,A,b){var C="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,I=r("pako"),x=r("./utils"),S=r("./stream/GenericWorker"),B=C?"uint8array":"array";function FlateWorker(r,A){S.call(this,"FlateWorker/"+r),this._pako=null,this._pakoAction=r,this._pakoOptions=A,this.meta={}}b.magic="\b\0",x.inherits(FlateWorker,S),FlateWorker.prototype.processChunk=function(r){this.meta=r.meta,null===this._pako&&this._createPako(),this._pako.push(x.transformTo(B,r.data),!1)},FlateWorker.prototype.flush=function(){S.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},FlateWorker.prototype.cleanUp=function(){S.prototype.cleanUp.call(this),this._pako=null},FlateWorker.prototype._createPako=function(){this._pako=new I[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var r=this;this._pako.onData=function(A){r.push({data:A,meta:r.meta})}},b.compressWorker=function(r){return new FlateWorker("Deflate",r)},b.uncompressWorker=function(){return new FlateWorker("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(r,A,b){var C=r("../utils"),I=r("../stream/GenericWorker"),x=r("../utf8"),S=r("../crc32"),B=r("../signature"),decToHex=function(r,A){var b,C="";for(b=0;b<A;b++)C+=String.fromCharCode(255&r),r>>>=8;return C},generateZipParts=function(r,A,b,I,D,R){var F,N,Q=r.file,H=r.compression,G=R!==x.utf8encode,j=C.transformTo("string",R(Q.name)),V=C.transformTo("string",x.utf8encode(Q.name)),W=Q.comment,X=C.transformTo("string",R(W)),Y=C.transformTo("string",x.utf8encode(W)),K=V.length!==Q.name.length,q=Y.length!==W.length,Z="",J="",$="",ee=Q.dir,te=Q.date,se={crc32:0,compressedSize:0,uncompressedSize:0};A&&!b||(se.crc32=r.crc32,se.compressedSize=r.compressedSize,se.uncompressedSize=r.uncompressedSize);var ie=0;A&&(ie|=8),G||!K&&!q||(ie|=2048);var ne,re,ae,oe=0,le=0;ee&&(oe|=16),"UNIX"===D?(le=798,oe|=(ne=Q.unixPermissions,re=ee,ae=ne,ne||(ae=re?16893:33204),(65535&ae)<<16)):(le=20,oe|=63&(Q.dosPermissions||0)),F=te.getUTCHours(),F<<=6,F|=te.getUTCMinutes(),F<<=5,F|=te.getUTCSeconds()/2,N=te.getUTCFullYear()-1980,N<<=4,N|=te.getUTCMonth()+1,N<<=5,N|=te.getUTCDate(),K&&(J=decToHex(1,1)+decToHex(S(j),4)+V,Z+="up"+decToHex(J.length,2)+J),q&&($=decToHex(1,1)+decToHex(S(X),4)+Y,Z+="uc"+decToHex($.length,2)+$);var he="";return he+="\n\0",he+=decToHex(ie,2),he+=H.magic,he+=decToHex(F,2),he+=decToHex(N,2),he+=decToHex(se.crc32,4),he+=decToHex(se.compressedSize,4),he+=decToHex(se.uncompressedSize,4),he+=decToHex(j.length,2),he+=decToHex(Z.length,2),{fileRecord:B.LOCAL_FILE_HEADER+he+j+Z,dirRecord:B.CENTRAL_FILE_HEADER+decToHex(le,2)+he+decToHex(X.length,2)+"\0\0\0\0"+decToHex(oe,4)+decToHex(I,4)+j+Z+X}},generateDataDescriptors=function(r){return B.DATA_DESCRIPTOR+decToHex(r.crc32,4)+decToHex(r.compressedSize,4)+decToHex(r.uncompressedSize,4)};function ZipFileWorker(r,A,b,C){I.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=A,this.zipPlatform=b,this.encodeFileName=C,this.streamFiles=r,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}C.inherits(ZipFileWorker,I),ZipFileWorker.prototype.push=function(r){var A=r.meta.percent||0,b=this.entriesCount,C=this._sources.length;this.accumulate?this.contentBuffer.push(r):(this.bytesWritten+=r.data.length,I.prototype.push.call(this,{data:r.data,meta:{currentFile:this.currentFile,percent:b?(A+100*(b-C-1))/b:100}}))},ZipFileWorker.prototype.openedSource=function(r){this.currentSourceOffset=this.bytesWritten,this.currentFile=r.file.name;var A=this.streamFiles&&!r.file.dir;if(A){var b=generateZipParts(r,A,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:b.fileRecord,meta:{percent:0}})}else this.accumulate=!0},ZipFileWorker.prototype.closedSource=function(r){this.accumulate=!1;var A=this.streamFiles&&!r.file.dir,b=generateZipParts(r,A,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(b.dirRecord),A)this.push({data:generateDataDescriptors(r),meta:{percent:100}});else for(this.push({data:b.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},ZipFileWorker.prototype.flush=function(){for(var r=this.bytesWritten,A=0;A<this.dirRecords.length;A++)this.push({data:this.dirRecords[A],meta:{percent:100}});var b=this.bytesWritten-r,I=function(r,A,b,I,x){var S=C.transformTo("string",x(I));return B.CENTRAL_DIRECTORY_END+"\0\0\0\0"+decToHex(r,2)+decToHex(r,2)+decToHex(A,4)+decToHex(b,4)+decToHex(S.length,2)+S}(this.dirRecords.length,b,r,this.zipComment,this.encodeFileName);this.push({data:I,meta:{percent:100}})},ZipFileWorker.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},ZipFileWorker.prototype.registerPrevious=function(r){this._sources.push(r);var A=this;return r.on("data",(function(r){A.processChunk(r)})),r.on("end",(function(){A.closedSource(A.previous.streamInfo),A._sources.length?A.prepareNextSource():A.end()})),r.on("error",(function(r){A.error(r)})),this},ZipFileWorker.prototype.resume=function(){return!!I.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},ZipFileWorker.prototype.error=function(r){var A=this._sources;if(!I.prototype.error.call(this,r))return!1;for(var b=0;b<A.length;b++)try{A[b].error(r)}catch(r){}return!0},ZipFileWorker.prototype.lock=function(){I.prototype.lock.call(this);for(var r=this._sources,A=0;A<r.length;A++)r[A].lock()},A.exports=ZipFileWorker},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(r,A,b){var C=r("../compressions"),I=r("./ZipFileWorker");b.generateWorker=function(r,A,b){var x=new I(A.streamFiles,b,A.platform,A.encodeFileName),S=0;try{r.forEach((function(r,b){S++;var I=function(r,A){var b=r||A,I=C[b];if(!I)throw new Error(b+" is not a valid compression method !");return I}(b.options.compression,A.compression),B=b.options.compressionOptions||A.compressionOptions||{},D=b.dir,R=b.date;b._compressWorker(I,B).withStreamInfo("file",{name:r,dir:D,date:R,comment:b.comment||"",unixPermissions:b.unixPermissions,dosPermissions:b.dosPermissions}).pipe(x)})),x.entriesCount=S}catch(r){x.error(r)}return x}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(r,A,b){function JSZip(){if(!(this instanceof JSZip))return new JSZip;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var r=new JSZip;for(var A in this)"function"!=typeof this[A]&&(r[A]=this[A]);return r}}JSZip.prototype=r("./object"),JSZip.prototype.loadAsync=r("./load"),JSZip.support=r("./support"),JSZip.defaults=r("./defaults"),JSZip.version="3.10.1",JSZip.loadAsync=function(r,A){return(new JSZip).loadAsync(r,A)},JSZip.external=r("./external"),A.exports=JSZip},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(r,A,b){var C=r("./utils"),I=r("./external"),x=r("./utf8"),S=r("./zipEntries"),B=r("./stream/Crc32Probe"),D=r("./nodejsUtils");function checkEntryCRC32(r){return new I.Promise((function(A,b){var C=r.decompressed.getContentWorker().pipe(new B);C.on("error",(function(r){b(r)})).on("end",(function(){C.streamInfo.crc32!==r.decompressed.crc32?b(new Error("Corrupted zip : CRC32 mismatch")):A()})).resume()}))}A.exports=function(r,A){var b=this;return A=C.extend(A||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:x.utf8decode}),D.isNode&&D.isStream(r)?I.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):C.prepareContent("the loaded zip file",r,!0,A.optimizedBinaryString,A.base64).then((function(r){var b=new S(A);return b.load(r),b})).then((function checkCRC32(r){var b=[I.Promise.resolve(r)],C=r.files;if(A.checkCRC32)for(var x=0;x<C.length;x++)b.push(checkEntryCRC32(C[x]));return I.Promise.all(b)})).then((function addFiles(r){for(var I=r.shift(),x=I.files,S=0;S<x.length;S++){var B=x[S],D=B.fileNameStr,R=C.resolve(B.fileNameStr);b.file(R,B.decompressed,{binary:!0,optimizedBinaryString:!0,date:B.date,dir:B.dir,comment:B.fileCommentStr.length?B.fileCommentStr:null,unixPermissions:B.unixPermissions,dosPermissions:B.dosPermissions,createFolders:A.createFolders}),B.dir||(b.file(R).unsafeOriginalName=D)}return I.zipComment.length&&(b.comment=I.zipComment),b}))}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(r,A,b){var C=r("../utils"),I=r("../stream/GenericWorker");function NodejsStreamInputAdapter(r,A){I.call(this,"Nodejs stream input adapter for "+r),this._upstreamEnded=!1,this._bindStream(A)}C.inherits(NodejsStreamInputAdapter,I),NodejsStreamInputAdapter.prototype._bindStream=function(r){var A=this;this._stream=r,r.pause(),r.on("data",(function(r){A.push({data:r,meta:{percent:0}})})).on("error",(function(r){A.isPaused?this.generatedError=r:A.error(r)})).on("end",(function(){A.isPaused?A._upstreamEnded=!0:A.end()}))},NodejsStreamInputAdapter.prototype.pause=function(){return!!I.prototype.pause.call(this)&&(this._stream.pause(),!0)},NodejsStreamInputAdapter.prototype.resume=function(){return!!I.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},A.exports=NodejsStreamInputAdapter},{"../stream/GenericWorker":28,"../utils":32}],13:[function(r,A,b){var C=r("readable-stream").Readable;function NodejsStreamOutputAdapter(r,A,b){C.call(this,A),this._helper=r;var I=this;r.on("data",(function(r,A){I.push(r)||I._helper.pause(),b&&b(A)})).on("error",(function(r){I.emit("error",r)})).on("end",(function(){I.push(null)}))}r("../utils").inherits(NodejsStreamOutputAdapter,C),NodejsStreamOutputAdapter.prototype._read=function(){this._helper.resume()},A.exports=NodejsStreamOutputAdapter},{"../utils":32,"readable-stream":16}],14:[function(r,A,b){A.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(r,A){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(r,A);if("number"==typeof r)throw new Error('The "data" argument must not be a number');return new Buffer(r,A)},allocBuffer:function(r){if(Buffer.alloc)return Buffer.alloc(r);var A=new Buffer(r);return A.fill(0),A},isBuffer:function(r){return Buffer.isBuffer(r)},isStream:function(r){return r&&"function"==typeof r.on&&"function"==typeof r.pause&&"function"==typeof r.resume}}},{}],15:[function(r,A,b){var C=r("./utf8"),I=r("./utils"),x=r("./stream/GenericWorker"),S=r("./stream/StreamHelper"),B=r("./defaults"),D=r("./compressedObject"),R=r("./zipObject"),F=r("./generate"),N=r("./nodejsUtils"),Q=r("./nodejs/NodejsStreamInputAdapter"),fileAdd=function(r,A,b){var C,S=I.getTypeOf(A),F=I.extend(b||{},B);F.date=F.date||new Date,null!==F.compression&&(F.compression=F.compression.toUpperCase()),"string"==typeof F.unixPermissions&&(F.unixPermissions=parseInt(F.unixPermissions,8)),F.unixPermissions&&16384&F.unixPermissions&&(F.dir=!0),F.dosPermissions&&16&F.dosPermissions&&(F.dir=!0),F.dir&&(r=forceTrailingSlash(r)),F.createFolders&&(C=parentFolder(r))&&folderAdd.call(this,C,!0);var H="string"===S&&!1===F.binary&&!1===F.base64;b&&void 0!==b.binary||(F.binary=!H),(A instanceof D&&0===A.uncompressedSize||F.dir||!A||0===A.length)&&(F.base64=!1,F.binary=!0,A="",F.compression="STORE",S="string");var G=null;G=A instanceof D||A instanceof x?A:N.isNode&&N.isStream(A)?new Q(r,A):I.prepareContent(r,A,F.binary,F.optimizedBinaryString,F.base64);var j=new R(r,G,F);this.files[r]=j},parentFolder=function(r){"/"===r.slice(-1)&&(r=r.substring(0,r.length-1));var A=r.lastIndexOf("/");return A>0?r.substring(0,A):""},forceTrailingSlash=function(r){return"/"!==r.slice(-1)&&(r+="/"),r},folderAdd=function(r,A){return A=void 0!==A?A:B.createFolders,r=forceTrailingSlash(r),this.files[r]||fileAdd.call(this,r,null,{dir:!0,createFolders:A}),this.files[r]};function isRegExp(r){return"[object RegExp]"===Object.prototype.toString.call(r)}var H={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(r){var A,b,C;for(A in this.files)C=this.files[A],(b=A.slice(this.root.length,A.length))&&A.slice(0,this.root.length)===this.root&&r(b,C)},filter:function(r){var A=[];return this.forEach((function(b,C){r(b,C)&&A.push(C)})),A},file:function(r,A,b){if(1===arguments.length){if(isRegExp(r)){var C=r;return this.filter((function(r,A){return!A.dir&&C.test(r)}))}var I=this.files[this.root+r];return I&&!I.dir?I:null}return r=this.root+r,fileAdd.call(this,r,A,b),this},folder:function(r){if(!r)return this;if(isRegExp(r))return this.filter((function(A,b){return b.dir&&r.test(A)}));var A=this.root+r,b=folderAdd.call(this,A),C=this.clone();return C.root=b.name,C},remove:function(r){r=this.root+r;var A=this.files[r];if(A||("/"!==r.slice(-1)&&(r+="/"),A=this.files[r]),A&&!A.dir)delete this.files[r];else for(var b=this.filter((function(A,b){return b.name.slice(0,r.length)===r})),C=0;C<b.length;C++)delete this.files[b[C].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(r){var A,b={};try{if((b=I.extend(r||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:C.utf8encode})).type=b.type.toLowerCase(),b.compression=b.compression.toUpperCase(),"binarystring"===b.type&&(b.type="string"),!b.type)throw new Error("No output type specified.");I.checkSupport(b.type),"darwin"!==b.platform&&"freebsd"!==b.platform&&"linux"!==b.platform&&"sunos"!==b.platform||(b.platform="UNIX"),"win32"===b.platform&&(b.platform="DOS");var B=b.comment||this.comment||"";A=F.generateWorker(this,b,B)}catch(r){(A=new x("error")).error(r)}return new S(A,b.type||"string",b.mimeType)},generateAsync:function(r,A){return this.generateInternalStream(r).accumulate(A)},generateNodeStream:function(r,A){return(r=r||{}).type||(r.type="nodebuffer"),this.generateInternalStream(r).toNodejsStream(A)}};A.exports=H},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(r,A,b){A.exports=r("stream")},{stream:void 0}],17:[function(r,A,b){var C=r("./DataReader");function ArrayReader(r){C.call(this,r);for(var A=0;A<this.data.length;A++)r[A]=255&r[A]}r("../utils").inherits(ArrayReader,C),ArrayReader.prototype.byteAt=function(r){return this.data[this.zero+r]},ArrayReader.prototype.lastIndexOfSignature=function(r){for(var A=r.charCodeAt(0),b=r.charCodeAt(1),C=r.charCodeAt(2),I=r.charCodeAt(3),x=this.length-4;x>=0;--x)if(this.data[x]===A&&this.data[x+1]===b&&this.data[x+2]===C&&this.data[x+3]===I)return x-this.zero;return-1},ArrayReader.prototype.readAndCheckSignature=function(r){var A=r.charCodeAt(0),b=r.charCodeAt(1),C=r.charCodeAt(2),I=r.charCodeAt(3),x=this.readData(4);return A===x[0]&&b===x[1]&&C===x[2]&&I===x[3]},ArrayReader.prototype.readData=function(r){if(this.checkOffset(r),0===r)return[];var A=this.data.slice(this.zero+this.index,this.zero+this.index+r);return this.index+=r,A},A.exports=ArrayReader},{"../utils":32,"./DataReader":18}],18:[function(r,A,b){var C=r("../utils");function DataReader(r){this.data=r,this.length=r.length,this.index=0,this.zero=0}DataReader.prototype={checkOffset:function(r){this.checkIndex(this.index+r)},checkIndex:function(r){if(this.length<this.zero+r||r<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+r+"). Corrupted zip ?")},setIndex:function(r){this.checkIndex(r),this.index=r},skip:function(r){this.setIndex(this.index+r)},byteAt:function(){},readInt:function(r){var A,b=0;for(this.checkOffset(r),A=this.index+r-1;A>=this.index;A--)b=(b<<8)+this.byteAt(A);return this.index+=r,b},readString:function(r){return C.transformTo("string",this.readData(r))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var r=this.readInt(4);return new Date(Date.UTC(1980+(r>>25&127),(r>>21&15)-1,r>>16&31,r>>11&31,r>>5&63,(31&r)<<1))}},A.exports=DataReader},{"../utils":32}],19:[function(r,A,b){var C=r("./Uint8ArrayReader");function NodeBufferReader(r){C.call(this,r)}r("../utils").inherits(NodeBufferReader,C),NodeBufferReader.prototype.readData=function(r){this.checkOffset(r);var A=this.data.slice(this.zero+this.index,this.zero+this.index+r);return this.index+=r,A},A.exports=NodeBufferReader},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(r,A,b){var C=r("./DataReader");function StringReader(r){C.call(this,r)}r("../utils").inherits(StringReader,C),StringReader.prototype.byteAt=function(r){return this.data.charCodeAt(this.zero+r)},StringReader.prototype.lastIndexOfSignature=function(r){return this.data.lastIndexOf(r)-this.zero},StringReader.prototype.readAndCheckSignature=function(r){return r===this.readData(4)},StringReader.prototype.readData=function(r){this.checkOffset(r);var A=this.data.slice(this.zero+this.index,this.zero+this.index+r);return this.index+=r,A},A.exports=StringReader},{"../utils":32,"./DataReader":18}],21:[function(r,A,b){var C=r("./ArrayReader");function Uint8ArrayReader(r){C.call(this,r)}r("../utils").inherits(Uint8ArrayReader,C),Uint8ArrayReader.prototype.readData=function(r){if(this.checkOffset(r),0===r)return new Uint8Array(0);var A=this.data.subarray(this.zero+this.index,this.zero+this.index+r);return this.index+=r,A},A.exports=Uint8ArrayReader},{"../utils":32,"./ArrayReader":17}],22:[function(r,A,b){var C=r("../utils"),I=r("../support"),x=r("./ArrayReader"),S=r("./StringReader"),B=r("./NodeBufferReader"),D=r("./Uint8ArrayReader");A.exports=function(r){var A=C.getTypeOf(r);return C.checkSupport(A),"string"!==A||I.uint8array?"nodebuffer"===A?new B(r):I.uint8array?new D(C.transformTo("uint8array",r)):new x(C.transformTo("array",r)):new S(r)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(r,A,b){b.LOCAL_FILE_HEADER="PK",b.CENTRAL_FILE_HEADER="PK",b.CENTRAL_DIRECTORY_END="PK",b.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",b.ZIP64_CENTRAL_DIRECTORY_END="PK",b.DATA_DESCRIPTOR="PK\b"},{}],24:[function(r,A,b){var C=r("./GenericWorker"),I=r("../utils");function ConvertWorker(r){C.call(this,"ConvertWorker to "+r),this.destType=r}I.inherits(ConvertWorker,C),ConvertWorker.prototype.processChunk=function(r){this.push({data:I.transformTo(this.destType,r.data),meta:r.meta})},A.exports=ConvertWorker},{"../utils":32,"./GenericWorker":28}],25:[function(r,A,b){var C=r("./GenericWorker"),I=r("../crc32");function Crc32Probe(){C.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}r("../utils").inherits(Crc32Probe,C),Crc32Probe.prototype.processChunk=function(r){this.streamInfo.crc32=I(r.data,this.streamInfo.crc32||0),this.push(r)},A.exports=Crc32Probe},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(r,A,b){var C=r("../utils"),I=r("./GenericWorker");function DataLengthProbe(r){I.call(this,"DataLengthProbe for "+r),this.propName=r,this.withStreamInfo(r,0)}C.inherits(DataLengthProbe,I),DataLengthProbe.prototype.processChunk=function(r){if(r){var A=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=A+r.data.length}I.prototype.processChunk.call(this,r)},A.exports=DataLengthProbe},{"../utils":32,"./GenericWorker":28}],27:[function(r,A,b){var C=r("../utils"),I=r("./GenericWorker");function DataWorker(r){I.call(this,"DataWorker");var A=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,r.then((function(r){A.dataIsReady=!0,A.data=r,A.max=r&&r.length||0,A.type=C.getTypeOf(r),A.isPaused||A._tickAndRepeat()}),(function(r){A.error(r)}))}C.inherits(DataWorker,I),DataWorker.prototype.cleanUp=function(){I.prototype.cleanUp.call(this),this.data=null},DataWorker.prototype.resume=function(){return!!I.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,C.delay(this._tickAndRepeat,[],this)),!0)},DataWorker.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(C.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},DataWorker.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var r=null,A=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":r=this.data.substring(this.index,A);break;case"uint8array":r=this.data.subarray(this.index,A);break;case"array":case"nodebuffer":r=this.data.slice(this.index,A)}return this.index=A,this.push({data:r,meta:{percent:this.max?this.index/this.max*100:0}})},A.exports=DataWorker},{"../utils":32,"./GenericWorker":28}],28:[function(r,A,b){function GenericWorker(r){this.name=r||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}GenericWorker.prototype={push:function(r){this.emit("data",r)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(r){this.emit("error",r)}return!0},error:function(r){return!this.isFinished&&(this.isPaused?this.generatedError=r:(this.isFinished=!0,this.emit("error",r),this.previous&&this.previous.error(r),this.cleanUp()),!0)},on:function(r,A){return this._listeners[r].push(A),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(r,A){if(this._listeners[r])for(var b=0;b<this._listeners[r].length;b++)this._listeners[r][b].call(this,A)},pipe:function(r){return r.registerPrevious(this)},registerPrevious:function(r){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=r.streamInfo,this.mergeStreamInfo(),this.previous=r;var A=this;return r.on("data",(function(r){A.processChunk(r)})),r.on("end",(function(){A.end()})),r.on("error",(function(r){A.error(r)})),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var r=!1;return this.generatedError&&(this.error(this.generatedError),r=!0),this.previous&&this.previous.resume(),!r},flush:function(){},processChunk:function(r){this.push(r)},withStreamInfo:function(r,A){return this.extraStreamInfo[r]=A,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var r in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,r)&&(this.streamInfo[r]=this.extraStreamInfo[r])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var r="Worker "+this.name;return this.previous?this.previous+" -> "+r:r}},A.exports=GenericWorker},{}],29:[function(r,A,b){var C=r("../utils"),I=r("./ConvertWorker"),x=r("./GenericWorker"),S=r("../base64"),B=r("../support"),D=r("../external"),R=null;if(B.nodestream)try{R=r("../nodejs/NodejsStreamOutputAdapter")}catch(r){}function accumulate(r,A){return new D.Promise((function(b,I){var x=[],B=r._internalType,D=r._outputType,R=r._mimeType;r.on("data",(function(r,b){x.push(r),A&&A(b)})).on("error",(function(r){x=[],I(r)})).on("end",(function(){try{var r=function transformZipOutput(r,A,b){switch(r){case"blob":return C.newBlob(C.transformTo("arraybuffer",A),b);case"base64":return S.encode(A);default:return C.transformTo(r,A)}}(D,function concat(r,A){var b,C=0,I=null,x=0;for(b=0;b<A.length;b++)x+=A[b].length;switch(r){case"string":return A.join("");case"array":return Array.prototype.concat.apply([],A);case"uint8array":for(I=new Uint8Array(x),b=0;b<A.length;b++)I.set(A[b],C),C+=A[b].length;return I;case"nodebuffer":return Buffer.concat(A);default:throw new Error("concat : unsupported type '"+r+"'")}}(B,x),R);b(r)}catch(r){I(r)}x=[]})).resume()}))}function StreamHelper(r,A,b){var S=A;switch(A){case"blob":case"arraybuffer":S="uint8array";break;case"base64":S="string"}try{this._internalType=S,this._outputType=A,this._mimeType=b,C.checkSupport(S),this._worker=r.pipe(new I(S)),r.lock()}catch(r){this._worker=new x("error"),this._worker.error(r)}}StreamHelper.prototype={accumulate:function(r){return accumulate(this,r)},on:function(r,A){var b=this;return"data"===r?this._worker.on(r,(function(r){A.call(b,r.data,r.meta)})):this._worker.on(r,(function(){C.delay(A,arguments,b)})),this},resume:function(){return C.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(r){if(C.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new R(this,{objectMode:"nodebuffer"!==this._outputType},r)}},A.exports=StreamHelper},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(r,A,b){if(b.base64=!0,b.array=!0,b.string=!0,b.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,b.nodebuffer="undefined"!=typeof Buffer,b.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)b.blob=!1;else{var C=new ArrayBuffer(0);try{b.blob=0===new Blob([C],{type:"application/zip"}).size}catch(r){try{var I=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);I.append(C),b.blob=0===I.getBlob("application/zip").size}catch(r){b.blob=!1}}}try{b.nodestream=!!r("readable-stream").Readable}catch(r){b.nodestream=!1}},{"readable-stream":16}],31:[function(r,A,b){for(var C=r("./utils"),I=r("./support"),x=r("./nodejsUtils"),S=r("./stream/GenericWorker"),B=new Array(256),D=0;D<256;D++)B[D]=D>=252?6:D>=248?5:D>=240?4:D>=224?3:D>=192?2:1;B[254]=B[254]=1;function Utf8DecodeWorker(){S.call(this,"utf-8 decode"),this.leftOver=null}function Utf8EncodeWorker(){S.call(this,"utf-8 encode")}b.utf8encode=function utf8encode(r){return I.nodebuffer?x.newBufferFrom(r,"utf-8"):function(r){var A,b,C,x,S,B=r.length,D=0;for(x=0;x<B;x++)55296==(64512&(b=r.charCodeAt(x)))&&x+1<B&&56320==(64512&(C=r.charCodeAt(x+1)))&&(b=65536+(b-55296<<10)+(C-56320),x++),D+=b<128?1:b<2048?2:b<65536?3:4;for(A=I.uint8array?new Uint8Array(D):new Array(D),S=0,x=0;S<D;x++)55296==(64512&(b=r.charCodeAt(x)))&&x+1<B&&56320==(64512&(C=r.charCodeAt(x+1)))&&(b=65536+(b-55296<<10)+(C-56320),x++),b<128?A[S++]=b:b<2048?(A[S++]=192|b>>>6,A[S++]=128|63&b):b<65536?(A[S++]=224|b>>>12,A[S++]=128|b>>>6&63,A[S++]=128|63&b):(A[S++]=240|b>>>18,A[S++]=128|b>>>12&63,A[S++]=128|b>>>6&63,A[S++]=128|63&b);return A}(r)},b.utf8decode=function utf8decode(r){return I.nodebuffer?C.transformTo("nodebuffer",r).toString("utf-8"):function(r){var A,b,I,x,S=r.length,D=new Array(2*S);for(b=0,A=0;A<S;)if((I=r[A++])<128)D[b++]=I;else if((x=B[I])>4)D[b++]=65533,A+=x-1;else{for(I&=2===x?31:3===x?15:7;x>1&&A<S;)I=I<<6|63&r[A++],x--;x>1?D[b++]=65533:I<65536?D[b++]=I:(I-=65536,D[b++]=55296|I>>10&1023,D[b++]=56320|1023&I)}return D.length!==b&&(D.subarray?D=D.subarray(0,b):D.length=b),C.applyFromCharCode(D)}(r=C.transformTo(I.uint8array?"uint8array":"array",r))},C.inherits(Utf8DecodeWorker,S),Utf8DecodeWorker.prototype.processChunk=function(r){var A=C.transformTo(I.uint8array?"uint8array":"array",r.data);if(this.leftOver&&this.leftOver.length){if(I.uint8array){var x=A;(A=new Uint8Array(x.length+this.leftOver.length)).set(this.leftOver,0),A.set(x,this.leftOver.length)}else A=this.leftOver.concat(A);this.leftOver=null}var S=function(r,A){var b;for((A=A||r.length)>r.length&&(A=r.length),b=A-1;b>=0&&128==(192&r[b]);)b--;return b<0||0===b?A:b+B[r[b]]>A?b:A}(A),D=A;S!==A.length&&(I.uint8array?(D=A.subarray(0,S),this.leftOver=A.subarray(S,A.length)):(D=A.slice(0,S),this.leftOver=A.slice(S,A.length))),this.push({data:b.utf8decode(D),meta:r.meta})},Utf8DecodeWorker.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:b.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},b.Utf8DecodeWorker=Utf8DecodeWorker,C.inherits(Utf8EncodeWorker,S),Utf8EncodeWorker.prototype.processChunk=function(r){this.push({data:b.utf8encode(r.data),meta:r.meta})},b.Utf8EncodeWorker=Utf8EncodeWorker},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(r,A,b){var C=r("./support"),I=r("./base64"),x=r("./nodejsUtils"),S=r("./external");function identity(r){return r}function stringToArrayLike(r,A){for(var b=0;b<r.length;++b)A[b]=255&r.charCodeAt(b);return A}r("setimmediate"),b.newBlob=function(r,A){b.checkSupport("blob");try{return new Blob([r],{type:A})}catch(b){try{var C=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return C.append(r),C.getBlob(A)}catch(r){throw new Error("Bug : can't construct the Blob.")}}};var B={stringifyByChunk:function(r,A,b){var C=[],I=0,x=r.length;if(x<=b)return String.fromCharCode.apply(null,r);for(;I<x;)"array"===A||"nodebuffer"===A?C.push(String.fromCharCode.apply(null,r.slice(I,Math.min(I+b,x)))):C.push(String.fromCharCode.apply(null,r.subarray(I,Math.min(I+b,x)))),I+=b;return C.join("")},stringifyByChar:function(r){for(var A="",b=0;b<r.length;b++)A+=String.fromCharCode(r[b]);return A},applyCanBeUsed:{uint8array:function(){try{return C.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(r){return!1}}(),nodebuffer:function(){try{return C.nodebuffer&&1===String.fromCharCode.apply(null,x.allocBuffer(1)).length}catch(r){return!1}}()}};function arrayLikeToString(r){var A=65536,C=b.getTypeOf(r),I=!0;if("uint8array"===C?I=B.applyCanBeUsed.uint8array:"nodebuffer"===C&&(I=B.applyCanBeUsed.nodebuffer),I)for(;A>1;)try{return B.stringifyByChunk(r,C,A)}catch(r){A=Math.floor(A/2)}return B.stringifyByChar(r)}function arrayLikeToArrayLike(r,A){for(var b=0;b<r.length;b++)A[b]=r[b];return A}b.applyFromCharCode=arrayLikeToString;var D={};D.string={string:identity,array:function(r){return stringToArrayLike(r,new Array(r.length))},arraybuffer:function(r){return D.string.uint8array(r).buffer},uint8array:function(r){return stringToArrayLike(r,new Uint8Array(r.length))},nodebuffer:function(r){return stringToArrayLike(r,x.allocBuffer(r.length))}},D.array={string:arrayLikeToString,array:identity,arraybuffer:function(r){return new Uint8Array(r).buffer},uint8array:function(r){return new Uint8Array(r)},nodebuffer:function(r){return x.newBufferFrom(r)}},D.arraybuffer={string:function(r){return arrayLikeToString(new Uint8Array(r))},array:function(r){return arrayLikeToArrayLike(new Uint8Array(r),new Array(r.byteLength))},arraybuffer:identity,uint8array:function(r){return new Uint8Array(r)},nodebuffer:function(r){return x.newBufferFrom(new Uint8Array(r))}},D.uint8array={string:arrayLikeToString,array:function(r){return arrayLikeToArrayLike(r,new Array(r.length))},arraybuffer:function(r){return r.buffer},uint8array:identity,nodebuffer:function(r){return x.newBufferFrom(r)}},D.nodebuffer={string:arrayLikeToString,array:function(r){return arrayLikeToArrayLike(r,new Array(r.length))},arraybuffer:function(r){return D.nodebuffer.uint8array(r).buffer},uint8array:function(r){return arrayLikeToArrayLike(r,new Uint8Array(r.length))},nodebuffer:identity},b.transformTo=function(r,A){if(A||(A=""),!r)return A;b.checkSupport(r);var C=b.getTypeOf(A);return D[C][r](A)},b.resolve=function(r){for(var A=r.split("/"),b=[],C=0;C<A.length;C++){var I=A[C];"."===I||""===I&&0!==C&&C!==A.length-1||(".."===I?b.pop():b.push(I))}return b.join("/")},b.getTypeOf=function(r){return"string"==typeof r?"string":"[object Array]"===Object.prototype.toString.call(r)?"array":C.nodebuffer&&x.isBuffer(r)?"nodebuffer":C.uint8array&&r instanceof Uint8Array?"uint8array":C.arraybuffer&&r instanceof ArrayBuffer?"arraybuffer":void 0},b.checkSupport=function(r){if(!C[r.toLowerCase()])throw new Error(r+" is not supported by this platform")},b.MAX_VALUE_16BITS=65535,b.MAX_VALUE_32BITS=-1,b.pretty=function(r){var A,b,C="";for(b=0;b<(r||"").length;b++)C+="\\x"+((A=r.charCodeAt(b))<16?"0":"")+A.toString(16).toUpperCase();return C},b.delay=function(r,A,b){setImmediate((function(){r.apply(b||null,A||[])}))},b.inherits=function(r,A){var Obj=function(){};Obj.prototype=A.prototype,r.prototype=new Obj},b.extend=function(){var r,A,b={};for(r=0;r<arguments.length;r++)for(A in arguments[r])Object.prototype.hasOwnProperty.call(arguments[r],A)&&void 0===b[A]&&(b[A]=arguments[r][A]);return b},b.prepareContent=function(r,A,x,B,D){return S.Promise.resolve(A).then((function(r){return C.blob&&(r instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(r)))&&"undefined"!=typeof FileReader?new S.Promise((function(A,b){var C=new FileReader;C.onload=function(r){A(r.target.result)},C.onerror=function(r){b(r.target.error)},C.readAsArrayBuffer(r)})):r})).then((function(A){var R=b.getTypeOf(A);return R?("arraybuffer"===R?A=b.transformTo("uint8array",A):"string"===R&&(D?A=I.decode(A):x&&!0!==B&&(A=function string2binary(r){return stringToArrayLike(r,C.uint8array?new Uint8Array(r.length):new Array(r.length))}(A))),A):S.Promise.reject(new Error("Can't read the data of '"+r+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))}))}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(r,A,b){var C=r("./reader/readerFor"),I=r("./utils"),x=r("./signature"),S=r("./zipEntry"),B=r("./support");function ZipEntries(r){this.files=[],this.loadOptions=r}ZipEntries.prototype={checkSignature:function(r){if(!this.reader.readAndCheckSignature(r)){this.reader.index-=4;var A=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+I.pretty(A)+", expected "+I.pretty(r)+")")}},isSignature:function(r,A){var b=this.reader.index;this.reader.setIndex(r);var C=this.reader.readString(4)===A;return this.reader.setIndex(b),C},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var r=this.reader.readData(this.zipCommentLength),A=B.uint8array?"uint8array":"array",b=I.transformTo(A,r);this.zipComment=this.loadOptions.decodeFileName(b)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var r,A,b,C=this.zip64EndOfCentralSize-44;0<C;)r=this.reader.readInt(2),A=this.reader.readInt(4),b=this.reader.readData(A),this.zip64ExtensibleData[r]={id:r,length:A,value:b}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var r,A;for(r=0;r<this.files.length;r++)A=this.files[r],this.reader.setIndex(A.localHeaderOffset),this.checkSignature(x.LOCAL_FILE_HEADER),A.readLocalPart(this.reader),A.handleUTF8(),A.processAttributes()},readCentralDir:function(){var r;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(x.CENTRAL_FILE_HEADER);)(r=new S({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(r);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var r=this.reader.lastIndexOfSignature(x.CENTRAL_DIRECTORY_END);if(r<0)throw!this.isSignature(0,x.LOCAL_FILE_HEADER)?new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip: can't find end of central directory");this.reader.setIndex(r);var A=r;if(this.checkSignature(x.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===I.MAX_VALUE_16BITS||this.diskWithCentralDirStart===I.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===I.MAX_VALUE_16BITS||this.centralDirRecords===I.MAX_VALUE_16BITS||this.centralDirSize===I.MAX_VALUE_32BITS||this.centralDirOffset===I.MAX_VALUE_32BITS){if(this.zip64=!0,(r=this.reader.lastIndexOfSignature(x.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(r),this.checkSignature(x.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,x.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(x.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(x.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var b=this.centralDirOffset+this.centralDirSize;this.zip64&&(b+=20,b+=12+this.zip64EndOfCentralSize);var C=A-b;if(C>0)this.isSignature(A,x.CENTRAL_FILE_HEADER)||(this.reader.zero=C);else if(C<0)throw new Error("Corrupted zip: missing "+Math.abs(C)+" bytes.")},prepareReader:function(r){this.reader=C(r)},load:function(r){this.prepareReader(r),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},A.exports=ZipEntries},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(r,A,b){var C=r("./reader/readerFor"),I=r("./utils"),x=r("./compressedObject"),S=r("./crc32"),B=r("./utf8"),D=r("./compressions"),R=r("./support");function ZipEntry(r,A){this.options=r,this.loadOptions=A}ZipEntry.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(r){var A,b;if(r.skip(22),this.fileNameLength=r.readInt(2),b=r.readInt(2),this.fileName=r.readData(this.fileNameLength),r.skip(b),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(A=function(r){for(var A in D)if(Object.prototype.hasOwnProperty.call(D,A)&&D[A].magic===r)return D[A];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+I.pretty(this.compressionMethod)+" unknown (inner file : "+I.transformTo("string",this.fileName)+")");this.decompressed=new x(this.compressedSize,this.uncompressedSize,this.crc32,A,r.readData(this.compressedSize))},readCentralPart:function(r){this.versionMadeBy=r.readInt(2),r.skip(2),this.bitFlag=r.readInt(2),this.compressionMethod=r.readString(2),this.date=r.readDate(),this.crc32=r.readInt(4),this.compressedSize=r.readInt(4),this.uncompressedSize=r.readInt(4);var A=r.readInt(2);if(this.extraFieldsLength=r.readInt(2),this.fileCommentLength=r.readInt(2),this.diskNumberStart=r.readInt(2),this.internalFileAttributes=r.readInt(2),this.externalFileAttributes=r.readInt(4),this.localHeaderOffset=r.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");r.skip(A),this.readExtraFields(r),this.parseZIP64ExtraField(r),this.fileComment=r.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var r=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0===r&&(this.dosPermissions=63&this.externalFileAttributes),3===r&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var r=C(this.extraFields[1].value);this.uncompressedSize===I.MAX_VALUE_32BITS&&(this.uncompressedSize=r.readInt(8)),this.compressedSize===I.MAX_VALUE_32BITS&&(this.compressedSize=r.readInt(8)),this.localHeaderOffset===I.MAX_VALUE_32BITS&&(this.localHeaderOffset=r.readInt(8)),this.diskNumberStart===I.MAX_VALUE_32BITS&&(this.diskNumberStart=r.readInt(4))}},readExtraFields:function(r){var A,b,C,I=r.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});r.index+4<I;)A=r.readInt(2),b=r.readInt(2),C=r.readData(b),this.extraFields[A]={id:A,length:b,value:C};r.setIndex(I)},handleUTF8:function(){var r=R.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=B.utf8decode(this.fileName),this.fileCommentStr=B.utf8decode(this.fileComment);else{var A=this.findExtraFieldUnicodePath();if(null!==A)this.fileNameStr=A;else{var b=I.transformTo(r,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(b)}var C=this.findExtraFieldUnicodeComment();if(null!==C)this.fileCommentStr=C;else{var x=I.transformTo(r,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(x)}}},findExtraFieldUnicodePath:function(){var r=this.extraFields[28789];if(r){var A=C(r.value);return 1!==A.readInt(1)||S(this.fileName)!==A.readInt(4)?null:B.utf8decode(A.readData(r.length-5))}return null},findExtraFieldUnicodeComment:function(){var r=this.extraFields[25461];if(r){var A=C(r.value);return 1!==A.readInt(1)||S(this.fileComment)!==A.readInt(4)?null:B.utf8decode(A.readData(r.length-5))}return null}},A.exports=ZipEntry},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(r,A,b){var C=r("./stream/StreamHelper"),I=r("./stream/DataWorker"),x=r("./utf8"),S=r("./compressedObject"),B=r("./stream/GenericWorker"),ZipObject=function(r,A,b){this.name=r,this.dir=b.dir,this.date=b.date,this.comment=b.comment,this.unixPermissions=b.unixPermissions,this.dosPermissions=b.dosPermissions,this._data=A,this._dataBinary=b.binary,this.options={compression:b.compression,compressionOptions:b.compressionOptions}};ZipObject.prototype={internalStream:function(r){var A=null,b="string";try{if(!r)throw new Error("No output type specified.");var I="string"===(b=r.toLowerCase())||"text"===b;"binarystring"!==b&&"text"!==b||(b="string"),A=this._decompressWorker();var S=!this._dataBinary;S&&!I&&(A=A.pipe(new x.Utf8EncodeWorker)),!S&&I&&(A=A.pipe(new x.Utf8DecodeWorker))}catch(r){(A=new B("error")).error(r)}return new C(A,b,"")},async:function(r,A){return this.internalStream(r).accumulate(A)},nodeStream:function(r,A){return this.internalStream(r||"nodebuffer").toNodejsStream(A)},_compressWorker:function(r,A){if(this._data instanceof S&&this._data.compression.magic===r.magic)return this._data.getCompressedWorker();var b=this._decompressWorker();return this._dataBinary||(b=b.pipe(new x.Utf8EncodeWorker)),S.createWorkerFrom(b,r,A)},_decompressWorker:function(){return this._data instanceof S?this._data.getContentWorker():this._data instanceof B?this._data:new I(this._data)}};for(var D=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],removedFn=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},R=0;R<D.length;R++)ZipObject.prototype[D[R]]=removedFn;A.exports=ZipObject},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(r,A,b){(function(r){var b,C,I=r.MutationObserver||r.WebKitMutationObserver;if(I){var x=0,S=new I(nextTick),B=r.document.createTextNode("");S.observe(B,{characterData:!0}),b=function(){B.data=x=++x%2}}else if(r.setImmediate||void 0===r.MessageChannel)b="document"in r&&"onreadystatechange"in r.document.createElement("script")?function(){var A=r.document.createElement("script");A.onreadystatechange=function(){nextTick(),A.onreadystatechange=null,A.parentNode.removeChild(A),A=null},r.document.documentElement.appendChild(A)}:function(){setTimeout(nextTick,0)};else{var D=new r.MessageChannel;D.port1.onmessage=nextTick,b=function(){D.port2.postMessage(0)}}var R=[];function nextTick(){var r,A;C=!0;for(var b=R.length;b;){for(A=R,R=[],r=-1;++r<b;)A[r]();b=R.length}C=!1}A.exports=function immediate(r){1!==R.push(r)||C||b()}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(r,A,b){var C=r("immediate");function INTERNAL(){}var I={},x=["REJECTED"],S=["FULFILLED"],B=["PENDING"];function Promise(r){if("function"!=typeof r)throw new TypeError("resolver must be a function");this.state=B,this.queue=[],this.outcome=void 0,r!==INTERNAL&&safelyResolveThenable(this,r)}function QueueItem(r,A,b){this.promise=r,"function"==typeof A&&(this.onFulfilled=A,this.callFulfilled=this.otherCallFulfilled),"function"==typeof b&&(this.onRejected=b,this.callRejected=this.otherCallRejected)}function unwrap(r,A,b){C((function(){var C;try{C=A(b)}catch(A){return I.reject(r,A)}C===r?I.reject(r,new TypeError("Cannot resolve promise with itself")):I.resolve(r,C)}))}function getThen(r){var A=r&&r.then;if(r&&("object"==typeof r||"function"==typeof r)&&"function"==typeof A)return function appyThen(){A.apply(r,arguments)}}function safelyResolveThenable(r,A){var b=!1;function onError(A){b||(b=!0,I.reject(r,A))}function onSuccess(A){b||(b=!0,I.resolve(r,A))}var C=tryCatch((function tryToUnwrap(){A(onSuccess,onError)}));"error"===C.status&&onError(C.value)}function tryCatch(r,A){var b={};try{b.value=r(A),b.status="success"}catch(r){b.status="error",b.value=r}return b}A.exports=Promise,Promise.prototype.finally=function(r){if("function"!=typeof r)return this;var A=this.constructor;return this.then((function resolve(b){return A.resolve(r()).then((function yes(){return b}))}),(function reject(b){return A.resolve(r()).then((function no(){throw b}))}))},Promise.prototype.catch=function(r){return this.then(null,r)},Promise.prototype.then=function(r,A){if("function"!=typeof r&&this.state===S||"function"!=typeof A&&this.state===x)return this;var b=new this.constructor(INTERNAL);this.state!==B?unwrap(b,this.state===S?r:A,this.outcome):this.queue.push(new QueueItem(b,r,A));return b},QueueItem.prototype.callFulfilled=function(r){I.resolve(this.promise,r)},QueueItem.prototype.otherCallFulfilled=function(r){unwrap(this.promise,this.onFulfilled,r)},QueueItem.prototype.callRejected=function(r){I.reject(this.promise,r)},QueueItem.prototype.otherCallRejected=function(r){unwrap(this.promise,this.onRejected,r)},I.resolve=function(r,A){var b=tryCatch(getThen,A);if("error"===b.status)return I.reject(r,b.value);var C=b.value;if(C)safelyResolveThenable(r,C);else{r.state=S,r.outcome=A;for(var x=-1,B=r.queue.length;++x<B;)r.queue[x].callFulfilled(A)}return r},I.reject=function(r,A){r.state=x,r.outcome=A;for(var b=-1,C=r.queue.length;++b<C;)r.queue[b].callRejected(A);return r},Promise.resolve=function resolve(r){if(r instanceof this)return r;return I.resolve(new this(INTERNAL),r)},Promise.reject=function reject(r){var A=new this(INTERNAL);return I.reject(A,r)},Promise.all=function all(r){var A=this;if("[object Array]"!==Object.prototype.toString.call(r))return this.reject(new TypeError("must be an array"));var b=r.length,C=!1;if(!b)return this.resolve([]);var x=new Array(b),S=0,B=-1,D=new this(INTERNAL);for(;++B<b;)allResolver(r[B],B);return D;function allResolver(r,B){A.resolve(r).then((function resolveFromAll(r){x[B]=r,++S!==b||C||(C=!0,I.resolve(D,x))}),(function(r){C||(C=!0,I.reject(D,r))}))}},Promise.race=function race(r){var A=this;if("[object Array]"!==Object.prototype.toString.call(r))return this.reject(new TypeError("must be an array"));var b=r.length,C=!1;if(!b)return this.resolve([]);var x=-1,S=new this(INTERNAL);for(;++x<b;)B=r[x],A.resolve(B).then((function(r){C||(C=!0,I.resolve(S,r))}),(function(r){C||(C=!0,I.reject(S,r))}));var B;return S}},{immediate:36}],38:[function(r,A,b){var C={};(0,r("./lib/utils/common").assign)(C,r("./lib/deflate"),r("./lib/inflate"),r("./lib/zlib/constants")),A.exports=C},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(r,A,b){var C=r("./zlib/deflate"),I=r("./utils/common"),x=r("./utils/strings"),S=r("./zlib/messages"),B=r("./zlib/zstream"),D=Object.prototype.toString,R=0,F=-1,N=0,Q=8;function Deflate(r){if(!(this instanceof Deflate))return new Deflate(r);this.options=I.assign({level:F,method:Q,chunkSize:16384,windowBits:15,memLevel:8,strategy:N,to:""},r||{});var A=this.options;A.raw&&A.windowBits>0?A.windowBits=-A.windowBits:A.gzip&&A.windowBits>0&&A.windowBits<16&&(A.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new B,this.strm.avail_out=0;var b=C.deflateInit2(this.strm,A.level,A.method,A.windowBits,A.memLevel,A.strategy);if(b!==R)throw new Error(S[b]);if(A.header&&C.deflateSetHeader(this.strm,A.header),A.dictionary){var H;if(H="string"==typeof A.dictionary?x.string2buf(A.dictionary):"[object ArrayBuffer]"===D.call(A.dictionary)?new Uint8Array(A.dictionary):A.dictionary,(b=C.deflateSetDictionary(this.strm,H))!==R)throw new Error(S[b]);this._dict_set=!0}}function deflate(r,A){var b=new Deflate(A);if(b.push(r,!0),b.err)throw b.msg||S[b.err];return b.result}Deflate.prototype.push=function(r,A){var b,S,B=this.strm,F=this.options.chunkSize;if(this.ended)return!1;S=A===~~A?A:!0===A?4:0,"string"==typeof r?B.input=x.string2buf(r):"[object ArrayBuffer]"===D.call(r)?B.input=new Uint8Array(r):B.input=r,B.next_in=0,B.avail_in=B.input.length;do{if(0===B.avail_out&&(B.output=new I.Buf8(F),B.next_out=0,B.avail_out=F),1!==(b=C.deflate(B,S))&&b!==R)return this.onEnd(b),this.ended=!0,!1;0!==B.avail_out&&(0!==B.avail_in||4!==S&&2!==S)||("string"===this.options.to?this.onData(x.buf2binstring(I.shrinkBuf(B.output,B.next_out))):this.onData(I.shrinkBuf(B.output,B.next_out)))}while((B.avail_in>0||0===B.avail_out)&&1!==b);return 4===S?(b=C.deflateEnd(this.strm),this.onEnd(b),this.ended=!0,b===R):2!==S||(this.onEnd(R),B.avail_out=0,!0)},Deflate.prototype.onData=function(r){this.chunks.push(r)},Deflate.prototype.onEnd=function(r){r===R&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=I.flattenChunks(this.chunks)),this.chunks=[],this.err=r,this.msg=this.strm.msg},b.Deflate=Deflate,b.deflate=deflate,b.deflateRaw=function deflateRaw(r,A){return(A=A||{}).raw=!0,deflate(r,A)},b.gzip=function gzip(r,A){return(A=A||{}).gzip=!0,deflate(r,A)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(r,A,b){var C=r("./zlib/inflate"),I=r("./utils/common"),x=r("./utils/strings"),S=r("./zlib/constants"),B=r("./zlib/messages"),D=r("./zlib/zstream"),R=r("./zlib/gzheader"),F=Object.prototype.toString;function Inflate(r){if(!(this instanceof Inflate))return new Inflate(r);this.options=I.assign({chunkSize:16384,windowBits:0,to:""},r||{});var A=this.options;A.raw&&A.windowBits>=0&&A.windowBits<16&&(A.windowBits=-A.windowBits,0===A.windowBits&&(A.windowBits=-15)),!(A.windowBits>=0&&A.windowBits<16)||r&&r.windowBits||(A.windowBits+=32),A.windowBits>15&&A.windowBits<48&&0==(15&A.windowBits)&&(A.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new D,this.strm.avail_out=0;var b=C.inflateInit2(this.strm,A.windowBits);if(b!==S.Z_OK)throw new Error(B[b]);this.header=new R,C.inflateGetHeader(this.strm,this.header)}function inflate(r,A){var b=new Inflate(A);if(b.push(r,!0),b.err)throw b.msg||B[b.err];return b.result}Inflate.prototype.push=function(r,A){var b,B,D,R,N,Q,H=this.strm,G=this.options.chunkSize,j=this.options.dictionary,V=!1;if(this.ended)return!1;B=A===~~A?A:!0===A?S.Z_FINISH:S.Z_NO_FLUSH,"string"==typeof r?H.input=x.binstring2buf(r):"[object ArrayBuffer]"===F.call(r)?H.input=new Uint8Array(r):H.input=r,H.next_in=0,H.avail_in=H.input.length;do{if(0===H.avail_out&&(H.output=new I.Buf8(G),H.next_out=0,H.avail_out=G),(b=C.inflate(H,S.Z_NO_FLUSH))===S.Z_NEED_DICT&&j&&(Q="string"==typeof j?x.string2buf(j):"[object ArrayBuffer]"===F.call(j)?new Uint8Array(j):j,b=C.inflateSetDictionary(this.strm,Q)),b===S.Z_BUF_ERROR&&!0===V&&(b=S.Z_OK,V=!1),b!==S.Z_STREAM_END&&b!==S.Z_OK)return this.onEnd(b),this.ended=!0,!1;H.next_out&&(0!==H.avail_out&&b!==S.Z_STREAM_END&&(0!==H.avail_in||B!==S.Z_FINISH&&B!==S.Z_SYNC_FLUSH)||("string"===this.options.to?(D=x.utf8border(H.output,H.next_out),R=H.next_out-D,N=x.buf2string(H.output,D),H.next_out=R,H.avail_out=G-R,R&&I.arraySet(H.output,H.output,D,R,0),this.onData(N)):this.onData(I.shrinkBuf(H.output,H.next_out)))),0===H.avail_in&&0===H.avail_out&&(V=!0)}while((H.avail_in>0||0===H.avail_out)&&b!==S.Z_STREAM_END);return b===S.Z_STREAM_END&&(B=S.Z_FINISH),B===S.Z_FINISH?(b=C.inflateEnd(this.strm),this.onEnd(b),this.ended=!0,b===S.Z_OK):B!==S.Z_SYNC_FLUSH||(this.onEnd(S.Z_OK),H.avail_out=0,!0)},Inflate.prototype.onData=function(r){this.chunks.push(r)},Inflate.prototype.onEnd=function(r){r===S.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=I.flattenChunks(this.chunks)),this.chunks=[],this.err=r,this.msg=this.strm.msg},b.Inflate=Inflate,b.inflate=inflate,b.inflateRaw=function inflateRaw(r,A){return(A=A||{}).raw=!0,inflate(r,A)},b.ungzip=inflate},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(r,A,b){var C="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;b.assign=function(r){for(var A=Array.prototype.slice.call(arguments,1);A.length;){var b=A.shift();if(b){if("object"!=typeof b)throw new TypeError(b+"must be non-object");for(var C in b)b.hasOwnProperty(C)&&(r[C]=b[C])}}return r},b.shrinkBuf=function(r,A){return r.length===A?r:r.subarray?r.subarray(0,A):(r.length=A,r)};var I={arraySet:function(r,A,b,C,I){if(A.subarray&&r.subarray)r.set(A.subarray(b,b+C),I);else for(var x=0;x<C;x++)r[I+x]=A[b+x]},flattenChunks:function(r){var A,b,C,I,x,S;for(C=0,A=0,b=r.length;A<b;A++)C+=r[A].length;for(S=new Uint8Array(C),I=0,A=0,b=r.length;A<b;A++)x=r[A],S.set(x,I),I+=x.length;return S}},x={arraySet:function(r,A,b,C,I){for(var x=0;x<C;x++)r[I+x]=A[b+x]},flattenChunks:function(r){return[].concat.apply([],r)}};b.setTyped=function(r){r?(b.Buf8=Uint8Array,b.Buf16=Uint16Array,b.Buf32=Int32Array,b.assign(b,I)):(b.Buf8=Array,b.Buf16=Array,b.Buf32=Array,b.assign(b,x))},b.setTyped(C)},{}],42:[function(r,A,b){var C=r("./common"),I=!0,x=!0;try{String.fromCharCode.apply(null,[0])}catch(r){I=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(r){x=!1}for(var S=new C.Buf8(256),B=0;B<256;B++)S[B]=B>=252?6:B>=248?5:B>=240?4:B>=224?3:B>=192?2:1;function buf2binstring(r,A){if(A<65537&&(r.subarray&&x||!r.subarray&&I))return String.fromCharCode.apply(null,C.shrinkBuf(r,A));for(var b="",S=0;S<A;S++)b+=String.fromCharCode(r[S]);return b}S[254]=S[254]=1,b.string2buf=function(r){var A,b,I,x,S,B=r.length,D=0;for(x=0;x<B;x++)55296==(64512&(b=r.charCodeAt(x)))&&x+1<B&&56320==(64512&(I=r.charCodeAt(x+1)))&&(b=65536+(b-55296<<10)+(I-56320),x++),D+=b<128?1:b<2048?2:b<65536?3:4;for(A=new C.Buf8(D),S=0,x=0;S<D;x++)55296==(64512&(b=r.charCodeAt(x)))&&x+1<B&&56320==(64512&(I=r.charCodeAt(x+1)))&&(b=65536+(b-55296<<10)+(I-56320),x++),b<128?A[S++]=b:b<2048?(A[S++]=192|b>>>6,A[S++]=128|63&b):b<65536?(A[S++]=224|b>>>12,A[S++]=128|b>>>6&63,A[S++]=128|63&b):(A[S++]=240|b>>>18,A[S++]=128|b>>>12&63,A[S++]=128|b>>>6&63,A[S++]=128|63&b);return A},b.buf2binstring=function(r){return buf2binstring(r,r.length)},b.binstring2buf=function(r){for(var A=new C.Buf8(r.length),b=0,I=A.length;b<I;b++)A[b]=r.charCodeAt(b);return A},b.buf2string=function(r,A){var b,C,I,x,B=A||r.length,D=new Array(2*B);for(C=0,b=0;b<B;)if((I=r[b++])<128)D[C++]=I;else if((x=S[I])>4)D[C++]=65533,b+=x-1;else{for(I&=2===x?31:3===x?15:7;x>1&&b<B;)I=I<<6|63&r[b++],x--;x>1?D[C++]=65533:I<65536?D[C++]=I:(I-=65536,D[C++]=55296|I>>10&1023,D[C++]=56320|1023&I)}return buf2binstring(D,C)},b.utf8border=function(r,A){var b;for((A=A||r.length)>r.length&&(A=r.length),b=A-1;b>=0&&128==(192&r[b]);)b--;return b<0||0===b?A:b+S[r[b]]>A?b:A}},{"./common":41}],43:[function(r,A,b){A.exports=function adler32(r,A,b,C){for(var I=65535&r|0,x=r>>>16&65535|0,S=0;0!==b;){b-=S=b>2e3?2e3:b;do{x=x+(I=I+A[C++]|0)|0}while(--S);I%=65521,x%=65521}return I|x<<16|0}},{}],44:[function(r,A,b){A.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(r,A,b){var C=function makeTable(){for(var r,A=[],b=0;b<256;b++){r=b;for(var C=0;C<8;C++)r=1&r?3988292384^r>>>1:r>>>1;A[b]=r}return A}();A.exports=function crc32(r,A,b,I){var x=C,S=I+b;r^=-1;for(var B=I;B<S;B++)r=r>>>8^x[255&(r^A[B])];return-1^r}},{}],46:[function(r,A,b){var C,I=r("../utils/common"),x=r("./trees"),S=r("./adler32"),B=r("./crc32"),D=r("./messages"),R=0,F=4,N=0,Q=-2,H=-1,G=4,j=2,V=8,W=9,X=286,Y=30,K=19,q=2*X+1,Z=15,J=3,$=258,ee=$+J+1,te=42,se=103,ie=113,ne=666,re=1,ae=2,oe=3,le=4;function err(r,A){return r.msg=D[A],A}function rank(r){return(r<<1)-(r>4?9:0)}function zero(r){for(var A=r.length;--A>=0;)r[A]=0}function flush_pending(r){var A=r.state,b=A.pending;b>r.avail_out&&(b=r.avail_out),0!==b&&(I.arraySet(r.output,A.pending_buf,A.pending_out,b,r.next_out),r.next_out+=b,A.pending_out+=b,r.total_out+=b,r.avail_out-=b,A.pending-=b,0===A.pending&&(A.pending_out=0))}function flush_block_only(r,A){x._tr_flush_block(r,r.block_start>=0?r.block_start:-1,r.strstart-r.block_start,A),r.block_start=r.strstart,flush_pending(r.strm)}function put_byte(r,A){r.pending_buf[r.pending++]=A}function putShortMSB(r,A){r.pending_buf[r.pending++]=A>>>8&255,r.pending_buf[r.pending++]=255&A}function read_buf(r,A,b,C){var x=r.avail_in;return x>C&&(x=C),0===x?0:(r.avail_in-=x,I.arraySet(A,r.input,r.next_in,x,b),1===r.state.wrap?r.adler=S(r.adler,A,x,b):2===r.state.wrap&&(r.adler=B(r.adler,A,x,b)),r.next_in+=x,r.total_in+=x,x)}function longest_match(r,A){var b,C,I=r.max_chain_length,x=r.strstart,S=r.prev_length,B=r.nice_match,D=r.strstart>r.w_size-ee?r.strstart-(r.w_size-ee):0,R=r.window,F=r.w_mask,N=r.prev,Q=r.strstart+$,H=R[x+S-1],G=R[x+S];r.prev_length>=r.good_match&&(I>>=2),B>r.lookahead&&(B=r.lookahead);do{if(R[(b=A)+S]===G&&R[b+S-1]===H&&R[b]===R[x]&&R[++b]===R[x+1]){x+=2,b++;do{}while(R[++x]===R[++b]&&R[++x]===R[++b]&&R[++x]===R[++b]&&R[++x]===R[++b]&&R[++x]===R[++b]&&R[++x]===R[++b]&&R[++x]===R[++b]&&R[++x]===R[++b]&&x<Q);if(C=$-(Q-x),x=Q-$,C>S){if(r.match_start=A,S=C,C>=B)break;H=R[x+S-1],G=R[x+S]}}}while((A=N[A&F])>D&&0!=--I);return S<=r.lookahead?S:r.lookahead}function fill_window(r){var A,b,C,x,S,B=r.w_size;do{if(x=r.window_size-r.lookahead-r.strstart,r.strstart>=B+(B-ee)){I.arraySet(r.window,r.window,B,B,0),r.match_start-=B,r.strstart-=B,r.block_start-=B,A=b=r.hash_size;do{C=r.head[--A],r.head[A]=C>=B?C-B:0}while(--b);A=b=B;do{C=r.prev[--A],r.prev[A]=C>=B?C-B:0}while(--b);x+=B}if(0===r.strm.avail_in)break;if(b=read_buf(r.strm,r.window,r.strstart+r.lookahead,x),r.lookahead+=b,r.lookahead+r.insert>=J)for(S=r.strstart-r.insert,r.ins_h=r.window[S],r.ins_h=(r.ins_h<<r.hash_shift^r.window[S+1])&r.hash_mask;r.insert&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[S+J-1])&r.hash_mask,r.prev[S&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=S,S++,r.insert--,!(r.lookahead+r.insert<J)););}while(r.lookahead<ee&&0!==r.strm.avail_in)}function deflate_fast(r,A){for(var b,C;;){if(r.lookahead<ee){if(fill_window(r),r.lookahead<ee&&A===R)return re;if(0===r.lookahead)break}if(b=0,r.lookahead>=J&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+J-1])&r.hash_mask,b=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart),0!==b&&r.strstart-b<=r.w_size-ee&&(r.match_length=longest_match(r,b)),r.match_length>=J)if(C=x._tr_tally(r,r.strstart-r.match_start,r.match_length-J),r.lookahead-=r.match_length,r.match_length<=r.max_lazy_match&&r.lookahead>=J){r.match_length--;do{r.strstart++,r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+J-1])&r.hash_mask,b=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart}while(0!=--r.match_length);r.strstart++}else r.strstart+=r.match_length,r.match_length=0,r.ins_h=r.window[r.strstart],r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+1])&r.hash_mask;else C=x._tr_tally(r,0,r.window[r.strstart]),r.lookahead--,r.strstart++;if(C&&(flush_block_only(r,!1),0===r.strm.avail_out))return re}return r.insert=r.strstart<J-1?r.strstart:J-1,A===F?(flush_block_only(r,!0),0===r.strm.avail_out?oe:le):r.last_lit&&(flush_block_only(r,!1),0===r.strm.avail_out)?re:ae}function deflate_slow(r,A){for(var b,C,I;;){if(r.lookahead<ee){if(fill_window(r),r.lookahead<ee&&A===R)return re;if(0===r.lookahead)break}if(b=0,r.lookahead>=J&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+J-1])&r.hash_mask,b=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart),r.prev_length=r.match_length,r.prev_match=r.match_start,r.match_length=J-1,0!==b&&r.prev_length<r.max_lazy_match&&r.strstart-b<=r.w_size-ee&&(r.match_length=longest_match(r,b),r.match_length<=5&&(1===r.strategy||r.match_length===J&&r.strstart-r.match_start>4096)&&(r.match_length=J-1)),r.prev_length>=J&&r.match_length<=r.prev_length){I=r.strstart+r.lookahead-J,C=x._tr_tally(r,r.strstart-1-r.prev_match,r.prev_length-J),r.lookahead-=r.prev_length-1,r.prev_length-=2;do{++r.strstart<=I&&(r.ins_h=(r.ins_h<<r.hash_shift^r.window[r.strstart+J-1])&r.hash_mask,b=r.prev[r.strstart&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=r.strstart)}while(0!=--r.prev_length);if(r.match_available=0,r.match_length=J-1,r.strstart++,C&&(flush_block_only(r,!1),0===r.strm.avail_out))return re}else if(r.match_available){if((C=x._tr_tally(r,0,r.window[r.strstart-1]))&&flush_block_only(r,!1),r.strstart++,r.lookahead--,0===r.strm.avail_out)return re}else r.match_available=1,r.strstart++,r.lookahead--}return r.match_available&&(C=x._tr_tally(r,0,r.window[r.strstart-1]),r.match_available=0),r.insert=r.strstart<J-1?r.strstart:J-1,A===F?(flush_block_only(r,!0),0===r.strm.avail_out?oe:le):r.last_lit&&(flush_block_only(r,!1),0===r.strm.avail_out)?re:ae}function Config(r,A,b,C,I){this.good_length=r,this.max_lazy=A,this.nice_length=b,this.max_chain=C,this.func=I}function DeflateState(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=V,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new I.Buf16(2*q),this.dyn_dtree=new I.Buf16(2*(2*Y+1)),this.bl_tree=new I.Buf16(2*(2*K+1)),zero(this.dyn_ltree),zero(this.dyn_dtree),zero(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new I.Buf16(Z+1),this.heap=new I.Buf16(2*X+1),zero(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new I.Buf16(2*X+1),zero(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function deflateResetKeep(r){var A;return r&&r.state?(r.total_in=r.total_out=0,r.data_type=j,(A=r.state).pending=0,A.pending_out=0,A.wrap<0&&(A.wrap=-A.wrap),A.status=A.wrap?te:ie,r.adler=2===A.wrap?0:1,A.last_flush=R,x._tr_init(A),N):err(r,Q)}function deflateReset(r){var A=deflateResetKeep(r);return A===N&&function lm_init(r){r.window_size=2*r.w_size,zero(r.head),r.max_lazy_match=C[r.level].max_lazy,r.good_match=C[r.level].good_length,r.nice_match=C[r.level].nice_length,r.max_chain_length=C[r.level].max_chain,r.strstart=0,r.block_start=0,r.lookahead=0,r.insert=0,r.match_length=r.prev_length=J-1,r.match_available=0,r.ins_h=0}(r.state),A}function deflateInit2(r,A,b,C,x,S){if(!r)return Q;var B=1;if(A===H&&(A=6),C<0?(B=0,C=-C):C>15&&(B=2,C-=16),x<1||x>W||b!==V||C<8||C>15||A<0||A>9||S<0||S>G)return err(r,Q);8===C&&(C=9);var D=new DeflateState;return r.state=D,D.strm=r,D.wrap=B,D.gzhead=null,D.w_bits=C,D.w_size=1<<D.w_bits,D.w_mask=D.w_size-1,D.hash_bits=x+7,D.hash_size=1<<D.hash_bits,D.hash_mask=D.hash_size-1,D.hash_shift=~~((D.hash_bits+J-1)/J),D.window=new I.Buf8(2*D.w_size),D.head=new I.Buf16(D.hash_size),D.prev=new I.Buf16(D.w_size),D.lit_bufsize=1<<x+6,D.pending_buf_size=4*D.lit_bufsize,D.pending_buf=new I.Buf8(D.pending_buf_size),D.d_buf=1*D.lit_bufsize,D.l_buf=3*D.lit_bufsize,D.level=A,D.strategy=S,D.method=b,deflateReset(r)}C=[new Config(0,0,0,0,(function deflate_stored(r,A){var b=65535;for(b>r.pending_buf_size-5&&(b=r.pending_buf_size-5);;){if(r.lookahead<=1){if(fill_window(r),0===r.lookahead&&A===R)return re;if(0===r.lookahead)break}r.strstart+=r.lookahead,r.lookahead=0;var C=r.block_start+b;if((0===r.strstart||r.strstart>=C)&&(r.lookahead=r.strstart-C,r.strstart=C,flush_block_only(r,!1),0===r.strm.avail_out))return re;if(r.strstart-r.block_start>=r.w_size-ee&&(flush_block_only(r,!1),0===r.strm.avail_out))return re}return r.insert=0,A===F?(flush_block_only(r,!0),0===r.strm.avail_out?oe:le):(r.strstart>r.block_start&&(flush_block_only(r,!1),r.strm.avail_out),re)})),new Config(4,4,8,4,deflate_fast),new Config(4,5,16,8,deflate_fast),new Config(4,6,32,32,deflate_fast),new Config(4,4,16,16,deflate_slow),new Config(8,16,32,32,deflate_slow),new Config(8,16,128,128,deflate_slow),new Config(8,32,128,256,deflate_slow),new Config(32,128,258,1024,deflate_slow),new Config(32,258,258,4096,deflate_slow)],b.deflateInit=function deflateInit(r,A){return deflateInit2(r,A,V,15,8,0)},b.deflateInit2=deflateInit2,b.deflateReset=deflateReset,b.deflateResetKeep=deflateResetKeep,b.deflateSetHeader=function deflateSetHeader(r,A){return r&&r.state?2!==r.state.wrap?Q:(r.state.gzhead=A,N):Q},b.deflate=function deflate(r,A){var b,I,S,D;if(!r||!r.state||A>5||A<0)return r?err(r,Q):Q;if(I=r.state,!r.output||!r.input&&0!==r.avail_in||I.status===ne&&A!==F)return err(r,0===r.avail_out?-5:Q);if(I.strm=r,b=I.last_flush,I.last_flush=A,I.status===te)if(2===I.wrap)r.adler=0,put_byte(I,31),put_byte(I,139),put_byte(I,8),I.gzhead?(put_byte(I,(I.gzhead.text?1:0)+(I.gzhead.hcrc?2:0)+(I.gzhead.extra?4:0)+(I.gzhead.name?8:0)+(I.gzhead.comment?16:0)),put_byte(I,255&I.gzhead.time),put_byte(I,I.gzhead.time>>8&255),put_byte(I,I.gzhead.time>>16&255),put_byte(I,I.gzhead.time>>24&255),put_byte(I,9===I.level?2:I.strategy>=2||I.level<2?4:0),put_byte(I,255&I.gzhead.os),I.gzhead.extra&&I.gzhead.extra.length&&(put_byte(I,255&I.gzhead.extra.length),put_byte(I,I.gzhead.extra.length>>8&255)),I.gzhead.hcrc&&(r.adler=B(r.adler,I.pending_buf,I.pending,0)),I.gzindex=0,I.status=69):(put_byte(I,0),put_byte(I,0),put_byte(I,0),put_byte(I,0),put_byte(I,0),put_byte(I,9===I.level?2:I.strategy>=2||I.level<2?4:0),put_byte(I,3),I.status=ie);else{var H=V+(I.w_bits-8<<4)<<8;H|=(I.strategy>=2||I.level<2?0:I.level<6?1:6===I.level?2:3)<<6,0!==I.strstart&&(H|=32),H+=31-H%31,I.status=ie,putShortMSB(I,H),0!==I.strstart&&(putShortMSB(I,r.adler>>>16),putShortMSB(I,65535&r.adler)),r.adler=1}if(69===I.status)if(I.gzhead.extra){for(S=I.pending;I.gzindex<(65535&I.gzhead.extra.length)&&(I.pending!==I.pending_buf_size||(I.gzhead.hcrc&&I.pending>S&&(r.adler=B(r.adler,I.pending_buf,I.pending-S,S)),flush_pending(r),S=I.pending,I.pending!==I.pending_buf_size));)put_byte(I,255&I.gzhead.extra[I.gzindex]),I.gzindex++;I.gzhead.hcrc&&I.pending>S&&(r.adler=B(r.adler,I.pending_buf,I.pending-S,S)),I.gzindex===I.gzhead.extra.length&&(I.gzindex=0,I.status=73)}else I.status=73;if(73===I.status)if(I.gzhead.name){S=I.pending;do{if(I.pending===I.pending_buf_size&&(I.gzhead.hcrc&&I.pending>S&&(r.adler=B(r.adler,I.pending_buf,I.pending-S,S)),flush_pending(r),S=I.pending,I.pending===I.pending_buf_size)){D=1;break}D=I.gzindex<I.gzhead.name.length?255&I.gzhead.name.charCodeAt(I.gzindex++):0,put_byte(I,D)}while(0!==D);I.gzhead.hcrc&&I.pending>S&&(r.adler=B(r.adler,I.pending_buf,I.pending-S,S)),0===D&&(I.gzindex=0,I.status=91)}else I.status=91;if(91===I.status)if(I.gzhead.comment){S=I.pending;do{if(I.pending===I.pending_buf_size&&(I.gzhead.hcrc&&I.pending>S&&(r.adler=B(r.adler,I.pending_buf,I.pending-S,S)),flush_pending(r),S=I.pending,I.pending===I.pending_buf_size)){D=1;break}D=I.gzindex<I.gzhead.comment.length?255&I.gzhead.comment.charCodeAt(I.gzindex++):0,put_byte(I,D)}while(0!==D);I.gzhead.hcrc&&I.pending>S&&(r.adler=B(r.adler,I.pending_buf,I.pending-S,S)),0===D&&(I.status=se)}else I.status=se;if(I.status===se&&(I.gzhead.hcrc?(I.pending+2>I.pending_buf_size&&flush_pending(r),I.pending+2<=I.pending_buf_size&&(put_byte(I,255&r.adler),put_byte(I,r.adler>>8&255),r.adler=0,I.status=ie)):I.status=ie),0!==I.pending){if(flush_pending(r),0===r.avail_out)return I.last_flush=-1,N}else if(0===r.avail_in&&rank(A)<=rank(b)&&A!==F)return err(r,-5);if(I.status===ne&&0!==r.avail_in)return err(r,-5);if(0!==r.avail_in||0!==I.lookahead||A!==R&&I.status!==ne){var G=2===I.strategy?function deflate_huff(r,A){for(var b;;){if(0===r.lookahead&&(fill_window(r),0===r.lookahead)){if(A===R)return re;break}if(r.match_length=0,b=x._tr_tally(r,0,r.window[r.strstart]),r.lookahead--,r.strstart++,b&&(flush_block_only(r,!1),0===r.strm.avail_out))return re}return r.insert=0,A===F?(flush_block_only(r,!0),0===r.strm.avail_out?oe:le):r.last_lit&&(flush_block_only(r,!1),0===r.strm.avail_out)?re:ae}(I,A):3===I.strategy?function deflate_rle(r,A){for(var b,C,I,S,B=r.window;;){if(r.lookahead<=$){if(fill_window(r),r.lookahead<=$&&A===R)return re;if(0===r.lookahead)break}if(r.match_length=0,r.lookahead>=J&&r.strstart>0&&(C=B[I=r.strstart-1])===B[++I]&&C===B[++I]&&C===B[++I]){S=r.strstart+$;do{}while(C===B[++I]&&C===B[++I]&&C===B[++I]&&C===B[++I]&&C===B[++I]&&C===B[++I]&&C===B[++I]&&C===B[++I]&&I<S);r.match_length=$-(S-I),r.match_length>r.lookahead&&(r.match_length=r.lookahead)}if(r.match_length>=J?(b=x._tr_tally(r,1,r.match_length-J),r.lookahead-=r.match_length,r.strstart+=r.match_length,r.match_length=0):(b=x._tr_tally(r,0,r.window[r.strstart]),r.lookahead--,r.strstart++),b&&(flush_block_only(r,!1),0===r.strm.avail_out))return re}return r.insert=0,A===F?(flush_block_only(r,!0),0===r.strm.avail_out?oe:le):r.last_lit&&(flush_block_only(r,!1),0===r.strm.avail_out)?re:ae}(I,A):C[I.level].func(I,A);if(G!==oe&&G!==le||(I.status=ne),G===re||G===oe)return 0===r.avail_out&&(I.last_flush=-1),N;if(G===ae&&(1===A?x._tr_align(I):5!==A&&(x._tr_stored_block(I,0,0,!1),3===A&&(zero(I.head),0===I.lookahead&&(I.strstart=0,I.block_start=0,I.insert=0))),flush_pending(r),0===r.avail_out))return I.last_flush=-1,N}return A!==F?N:I.wrap<=0?1:(2===I.wrap?(put_byte(I,255&r.adler),put_byte(I,r.adler>>8&255),put_byte(I,r.adler>>16&255),put_byte(I,r.adler>>24&255),put_byte(I,255&r.total_in),put_byte(I,r.total_in>>8&255),put_byte(I,r.total_in>>16&255),put_byte(I,r.total_in>>24&255)):(putShortMSB(I,r.adler>>>16),putShortMSB(I,65535&r.adler)),flush_pending(r),I.wrap>0&&(I.wrap=-I.wrap),0!==I.pending?N:1)},b.deflateEnd=function deflateEnd(r){var A;return r&&r.state?(A=r.state.status)!==te&&69!==A&&73!==A&&91!==A&&A!==se&&A!==ie&&A!==ne?err(r,Q):(r.state=null,A===ie?err(r,-3):N):Q},b.deflateSetDictionary=function deflateSetDictionary(r,A){var b,C,x,B,D,R,F,H,G=A.length;if(!r||!r.state)return Q;if(2===(B=(b=r.state).wrap)||1===B&&b.status!==te||b.lookahead)return Q;for(1===B&&(r.adler=S(r.adler,A,G,0)),b.wrap=0,G>=b.w_size&&(0===B&&(zero(b.head),b.strstart=0,b.block_start=0,b.insert=0),H=new I.Buf8(b.w_size),I.arraySet(H,A,G-b.w_size,b.w_size,0),A=H,G=b.w_size),D=r.avail_in,R=r.next_in,F=r.input,r.avail_in=G,r.next_in=0,r.input=A,fill_window(b);b.lookahead>=J;){C=b.strstart,x=b.lookahead-(J-1);do{b.ins_h=(b.ins_h<<b.hash_shift^b.window[C+J-1])&b.hash_mask,b.prev[C&b.w_mask]=b.head[b.ins_h],b.head[b.ins_h]=C,C++}while(--x);b.strstart=C,b.lookahead=J-1,fill_window(b)}return b.strstart+=b.lookahead,b.block_start=b.strstart,b.insert=b.lookahead,b.lookahead=0,b.match_length=b.prev_length=J-1,b.match_available=0,r.next_in=R,r.input=F,r.avail_in=D,b.wrap=B,N},b.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(r,A,b){A.exports=function GZheader(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(r,A,b){A.exports=function inflate_fast(r,A){var b,C,I,x,S,B,D,R,F,N,Q,H,G,j,V,W,X,Y,K,q,Z,J,$,ee,te;b=r.state,C=r.next_in,ee=r.input,I=C+(r.avail_in-5),x=r.next_out,te=r.output,S=x-(A-r.avail_out),B=x+(r.avail_out-257),D=b.dmax,R=b.wsize,F=b.whave,N=b.wnext,Q=b.window,H=b.hold,G=b.bits,j=b.lencode,V=b.distcode,W=(1<<b.lenbits)-1,X=(1<<b.distbits)-1;e:do{G<15&&(H+=ee[C++]<<G,G+=8,H+=ee[C++]<<G,G+=8),Y=j[H&W];t:for(;;){if(H>>>=K=Y>>>24,G-=K,0===(K=Y>>>16&255))te[x++]=65535&Y;else{if(!(16&K)){if(0==(64&K)){Y=j[(65535&Y)+(H&(1<<K)-1)];continue t}if(32&K){b.mode=12;break e}r.msg="invalid literal/length code",b.mode=30;break e}q=65535&Y,(K&=15)&&(G<K&&(H+=ee[C++]<<G,G+=8),q+=H&(1<<K)-1,H>>>=K,G-=K),G<15&&(H+=ee[C++]<<G,G+=8,H+=ee[C++]<<G,G+=8),Y=V[H&X];s:for(;;){if(H>>>=K=Y>>>24,G-=K,!(16&(K=Y>>>16&255))){if(0==(64&K)){Y=V[(65535&Y)+(H&(1<<K)-1)];continue s}r.msg="invalid distance code",b.mode=30;break e}if(Z=65535&Y,G<(K&=15)&&(H+=ee[C++]<<G,(G+=8)<K&&(H+=ee[C++]<<G,G+=8)),(Z+=H&(1<<K)-1)>D){r.msg="invalid distance too far back",b.mode=30;break e}if(H>>>=K,G-=K,Z>(K=x-S)){if((K=Z-K)>F&&b.sane){r.msg="invalid distance too far back",b.mode=30;break e}if(J=0,$=Q,0===N){if(J+=R-K,K<q){q-=K;do{te[x++]=Q[J++]}while(--K);J=x-Z,$=te}}else if(N<K){if(J+=R+N-K,(K-=N)<q){q-=K;do{te[x++]=Q[J++]}while(--K);if(J=0,N<q){q-=K=N;do{te[x++]=Q[J++]}while(--K);J=x-Z,$=te}}}else if(J+=N-K,K<q){q-=K;do{te[x++]=Q[J++]}while(--K);J=x-Z,$=te}for(;q>2;)te[x++]=$[J++],te[x++]=$[J++],te[x++]=$[J++],q-=3;q&&(te[x++]=$[J++],q>1&&(te[x++]=$[J++]))}else{J=x-Z;do{te[x++]=te[J++],te[x++]=te[J++],te[x++]=te[J++],q-=3}while(q>2);q&&(te[x++]=te[J++],q>1&&(te[x++]=te[J++]))}break}}break}}while(C<I&&x<B);C-=q=G>>3,H&=(1<<(G-=q<<3))-1,r.next_in=C,r.next_out=x,r.avail_in=C<I?I-C+5:5-(C-I),r.avail_out=x<B?B-x+257:257-(x-B),b.hold=H,b.bits=G}},{}],49:[function(r,A,b){var C=r("../utils/common"),I=r("./adler32"),x=r("./crc32"),S=r("./inffast"),B=r("./inftrees"),D=1,R=2,F=0,N=-2,Q=1,H=12,G=30,j=852,V=592;function zswap32(r){return(r>>>24&255)+(r>>>8&65280)+((65280&r)<<8)+((255&r)<<24)}function InflateState(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new C.Buf16(320),this.work=new C.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function inflateResetKeep(r){var A;return r&&r.state?(A=r.state,r.total_in=r.total_out=A.total=0,r.msg="",A.wrap&&(r.adler=1&A.wrap),A.mode=Q,A.last=0,A.havedict=0,A.dmax=32768,A.head=null,A.hold=0,A.bits=0,A.lencode=A.lendyn=new C.Buf32(j),A.distcode=A.distdyn=new C.Buf32(V),A.sane=1,A.back=-1,F):N}function inflateReset(r){var A;return r&&r.state?((A=r.state).wsize=0,A.whave=0,A.wnext=0,inflateResetKeep(r)):N}function inflateReset2(r,A){var b,C;return r&&r.state?(C=r.state,A<0?(b=0,A=-A):(b=1+(A>>4),A<48&&(A&=15)),A&&(A<8||A>15)?N:(null!==C.window&&C.wbits!==A&&(C.window=null),C.wrap=b,C.wbits=A,inflateReset(r))):N}function inflateInit2(r,A){var b,C;return r?(C=new InflateState,r.state=C,C.window=null,(b=inflateReset2(r,A))!==F&&(r.state=null),b):N}var W,X,Y=!0;function fixedtables(r){if(Y){var A;for(W=new C.Buf32(512),X=new C.Buf32(32),A=0;A<144;)r.lens[A++]=8;for(;A<256;)r.lens[A++]=9;for(;A<280;)r.lens[A++]=7;for(;A<288;)r.lens[A++]=8;for(B(D,r.lens,0,288,W,0,r.work,{bits:9}),A=0;A<32;)r.lens[A++]=5;B(R,r.lens,0,32,X,0,r.work,{bits:5}),Y=!1}r.lencode=W,r.lenbits=9,r.distcode=X,r.distbits=5}function updatewindow(r,A,b,I){var x,S=r.state;return null===S.window&&(S.wsize=1<<S.wbits,S.wnext=0,S.whave=0,S.window=new C.Buf8(S.wsize)),I>=S.wsize?(C.arraySet(S.window,A,b-S.wsize,S.wsize,0),S.wnext=0,S.whave=S.wsize):((x=S.wsize-S.wnext)>I&&(x=I),C.arraySet(S.window,A,b-I,x,S.wnext),(I-=x)?(C.arraySet(S.window,A,b-I,I,0),S.wnext=I,S.whave=S.wsize):(S.wnext+=x,S.wnext===S.wsize&&(S.wnext=0),S.whave<S.wsize&&(S.whave+=x))),0}b.inflateReset=inflateReset,b.inflateReset2=inflateReset2,b.inflateResetKeep=inflateResetKeep,b.inflateInit=function inflateInit(r){return inflateInit2(r,15)},b.inflateInit2=inflateInit2,b.inflate=function inflate(r,A){var b,j,V,W,X,Y,K,q,Z,J,$,ee,te,se,ie,ne,re,ae,oe,le,he,de,ce,ue,pe=0,Ae=new C.Buf8(4),ge=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!r||!r.state||!r.output||!r.input&&0!==r.avail_in)return N;(b=r.state).mode===H&&(b.mode=13),X=r.next_out,V=r.output,K=r.avail_out,W=r.next_in,j=r.input,Y=r.avail_in,q=b.hold,Z=b.bits,J=Y,$=K,de=F;e:for(;;)switch(b.mode){case Q:if(0===b.wrap){b.mode=13;break}for(;Z<16;){if(0===Y)break e;Y--,q+=j[W++]<<Z,Z+=8}if(2&b.wrap&&35615===q){b.check=0,Ae[0]=255&q,Ae[1]=q>>>8&255,b.check=x(b.check,Ae,2,0),q=0,Z=0,b.mode=2;break}if(b.flags=0,b.head&&(b.head.done=!1),!(1&b.wrap)||(((255&q)<<8)+(q>>8))%31){r.msg="incorrect header check",b.mode=G;break}if(8!=(15&q)){r.msg="unknown compression method",b.mode=G;break}if(Z-=4,he=8+(15&(q>>>=4)),0===b.wbits)b.wbits=he;else if(he>b.wbits){r.msg="invalid window size",b.mode=G;break}b.dmax=1<<he,r.adler=b.check=1,b.mode=512&q?10:H,q=0,Z=0;break;case 2:for(;Z<16;){if(0===Y)break e;Y--,q+=j[W++]<<Z,Z+=8}if(b.flags=q,8!=(255&b.flags)){r.msg="unknown compression method",b.mode=G;break}if(57344&b.flags){r.msg="unknown header flags set",b.mode=G;break}b.head&&(b.head.text=q>>8&1),512&b.flags&&(Ae[0]=255&q,Ae[1]=q>>>8&255,b.check=x(b.check,Ae,2,0)),q=0,Z=0,b.mode=3;case 3:for(;Z<32;){if(0===Y)break e;Y--,q+=j[W++]<<Z,Z+=8}b.head&&(b.head.time=q),512&b.flags&&(Ae[0]=255&q,Ae[1]=q>>>8&255,Ae[2]=q>>>16&255,Ae[3]=q>>>24&255,b.check=x(b.check,Ae,4,0)),q=0,Z=0,b.mode=4;case 4:for(;Z<16;){if(0===Y)break e;Y--,q+=j[W++]<<Z,Z+=8}b.head&&(b.head.xflags=255&q,b.head.os=q>>8),512&b.flags&&(Ae[0]=255&q,Ae[1]=q>>>8&255,b.check=x(b.check,Ae,2,0)),q=0,Z=0,b.mode=5;case 5:if(1024&b.flags){for(;Z<16;){if(0===Y)break e;Y--,q+=j[W++]<<Z,Z+=8}b.length=q,b.head&&(b.head.extra_len=q),512&b.flags&&(Ae[0]=255&q,Ae[1]=q>>>8&255,b.check=x(b.check,Ae,2,0)),q=0,Z=0}else b.head&&(b.head.extra=null);b.mode=6;case 6:if(1024&b.flags&&((ee=b.length)>Y&&(ee=Y),ee&&(b.head&&(he=b.head.extra_len-b.length,b.head.extra||(b.head.extra=new Array(b.head.extra_len)),C.arraySet(b.head.extra,j,W,ee,he)),512&b.flags&&(b.check=x(b.check,j,ee,W)),Y-=ee,W+=ee,b.length-=ee),b.length))break e;b.length=0,b.mode=7;case 7:if(2048&b.flags){if(0===Y)break e;ee=0;do{he=j[W+ee++],b.head&&he&&b.length<65536&&(b.head.name+=String.fromCharCode(he))}while(he&&ee<Y);if(512&b.flags&&(b.check=x(b.check,j,ee,W)),Y-=ee,W+=ee,he)break e}else b.head&&(b.head.name=null);b.length=0,b.mode=8;case 8:if(4096&b.flags){if(0===Y)break e;ee=0;do{he=j[W+ee++],b.head&&he&&b.length<65536&&(b.head.comment+=String.fromCharCode(he))}while(he&&ee<Y);if(512&b.flags&&(b.check=x(b.check,j,ee,W)),Y-=ee,W+=ee,he)break e}else b.head&&(b.head.comment=null);b.mode=9;case 9:if(512&b.flags){for(;Z<16;){if(0===Y)break e;Y--,q+=j[W++]<<Z,Z+=8}if(q!==(65535&b.check)){r.msg="header crc mismatch",b.mode=G;break}q=0,Z=0}b.head&&(b.head.hcrc=b.flags>>9&1,b.head.done=!0),r.adler=b.check=0,b.mode=H;break;case 10:for(;Z<32;){if(0===Y)break e;Y--,q+=j[W++]<<Z,Z+=8}r.adler=b.check=zswap32(q),q=0,Z=0,b.mode=11;case 11:if(0===b.havedict)return r.next_out=X,r.avail_out=K,r.next_in=W,r.avail_in=Y,b.hold=q,b.bits=Z,2;r.adler=b.check=1,b.mode=H;case H:if(5===A||6===A)break e;case 13:if(b.last){q>>>=7&Z,Z-=7&Z,b.mode=27;break}for(;Z<3;){if(0===Y)break e;Y--,q+=j[W++]<<Z,Z+=8}switch(b.last=1&q,Z-=1,3&(q>>>=1)){case 0:b.mode=14;break;case 1:if(fixedtables(b),b.mode=20,6===A){q>>>=2,Z-=2;break e}break;case 2:b.mode=17;break;case 3:r.msg="invalid block type",b.mode=G}q>>>=2,Z-=2;break;case 14:for(q>>>=7&Z,Z-=7&Z;Z<32;){if(0===Y)break e;Y--,q+=j[W++]<<Z,Z+=8}if((65535&q)!=(q>>>16^65535)){r.msg="invalid stored block lengths",b.mode=G;break}if(b.length=65535&q,q=0,Z=0,b.mode=15,6===A)break e;case 15:b.mode=16;case 16:if(ee=b.length){if(ee>Y&&(ee=Y),ee>K&&(ee=K),0===ee)break e;C.arraySet(V,j,W,ee,X),Y-=ee,W+=ee,K-=ee,X+=ee,b.length-=ee;break}b.mode=H;break;case 17:for(;Z<14;){if(0===Y)break e;Y--,q+=j[W++]<<Z,Z+=8}if(b.nlen=257+(31&q),q>>>=5,Z-=5,b.ndist=1+(31&q),q>>>=5,Z-=5,b.ncode=4+(15&q),q>>>=4,Z-=4,b.nlen>286||b.ndist>30){r.msg="too many length or distance symbols",b.mode=G;break}b.have=0,b.mode=18;case 18:for(;b.have<b.ncode;){for(;Z<3;){if(0===Y)break e;Y--,q+=j[W++]<<Z,Z+=8}b.lens[ge[b.have++]]=7&q,q>>>=3,Z-=3}for(;b.have<19;)b.lens[ge[b.have++]]=0;if(b.lencode=b.lendyn,b.lenbits=7,ce={bits:b.lenbits},de=B(0,b.lens,0,19,b.lencode,0,b.work,ce),b.lenbits=ce.bits,de){r.msg="invalid code lengths set",b.mode=G;break}b.have=0,b.mode=19;case 19:for(;b.have<b.nlen+b.ndist;){for(;ne=(pe=b.lencode[q&(1<<b.lenbits)-1])>>>16&255,re=65535&pe,!((ie=pe>>>24)<=Z);){if(0===Y)break e;Y--,q+=j[W++]<<Z,Z+=8}if(re<16)q>>>=ie,Z-=ie,b.lens[b.have++]=re;else{if(16===re){for(ue=ie+2;Z<ue;){if(0===Y)break e;Y--,q+=j[W++]<<Z,Z+=8}if(q>>>=ie,Z-=ie,0===b.have){r.msg="invalid bit length repeat",b.mode=G;break}he=b.lens[b.have-1],ee=3+(3&q),q>>>=2,Z-=2}else if(17===re){for(ue=ie+3;Z<ue;){if(0===Y)break e;Y--,q+=j[W++]<<Z,Z+=8}Z-=ie,he=0,ee=3+(7&(q>>>=ie)),q>>>=3,Z-=3}else{for(ue=ie+7;Z<ue;){if(0===Y)break e;Y--,q+=j[W++]<<Z,Z+=8}Z-=ie,he=0,ee=11+(127&(q>>>=ie)),q>>>=7,Z-=7}if(b.have+ee>b.nlen+b.ndist){r.msg="invalid bit length repeat",b.mode=G;break}for(;ee--;)b.lens[b.have++]=he}}if(b.mode===G)break;if(0===b.lens[256]){r.msg="invalid code -- missing end-of-block",b.mode=G;break}if(b.lenbits=9,ce={bits:b.lenbits},de=B(D,b.lens,0,b.nlen,b.lencode,0,b.work,ce),b.lenbits=ce.bits,de){r.msg="invalid literal/lengths set",b.mode=G;break}if(b.distbits=6,b.distcode=b.distdyn,ce={bits:b.distbits},de=B(R,b.lens,b.nlen,b.ndist,b.distcode,0,b.work,ce),b.distbits=ce.bits,de){r.msg="invalid distances set",b.mode=G;break}if(b.mode=20,6===A)break e;case 20:b.mode=21;case 21:if(Y>=6&&K>=258){r.next_out=X,r.avail_out=K,r.next_in=W,r.avail_in=Y,b.hold=q,b.bits=Z,S(r,$),X=r.next_out,V=r.output,K=r.avail_out,W=r.next_in,j=r.input,Y=r.avail_in,q=b.hold,Z=b.bits,b.mode===H&&(b.back=-1);break}for(b.back=0;ne=(pe=b.lencode[q&(1<<b.lenbits)-1])>>>16&255,re=65535&pe,!((ie=pe>>>24)<=Z);){if(0===Y)break e;Y--,q+=j[W++]<<Z,Z+=8}if(ne&&0==(240&ne)){for(ae=ie,oe=ne,le=re;ne=(pe=b.lencode[le+((q&(1<<ae+oe)-1)>>ae)])>>>16&255,re=65535&pe,!(ae+(ie=pe>>>24)<=Z);){if(0===Y)break e;Y--,q+=j[W++]<<Z,Z+=8}q>>>=ae,Z-=ae,b.back+=ae}if(q>>>=ie,Z-=ie,b.back+=ie,b.length=re,0===ne){b.mode=26;break}if(32&ne){b.back=-1,b.mode=H;break}if(64&ne){r.msg="invalid literal/length code",b.mode=G;break}b.extra=15&ne,b.mode=22;case 22:if(b.extra){for(ue=b.extra;Z<ue;){if(0===Y)break e;Y--,q+=j[W++]<<Z,Z+=8}b.length+=q&(1<<b.extra)-1,q>>>=b.extra,Z-=b.extra,b.back+=b.extra}b.was=b.length,b.mode=23;case 23:for(;ne=(pe=b.distcode[q&(1<<b.distbits)-1])>>>16&255,re=65535&pe,!((ie=pe>>>24)<=Z);){if(0===Y)break e;Y--,q+=j[W++]<<Z,Z+=8}if(0==(240&ne)){for(ae=ie,oe=ne,le=re;ne=(pe=b.distcode[le+((q&(1<<ae+oe)-1)>>ae)])>>>16&255,re=65535&pe,!(ae+(ie=pe>>>24)<=Z);){if(0===Y)break e;Y--,q+=j[W++]<<Z,Z+=8}q>>>=ae,Z-=ae,b.back+=ae}if(q>>>=ie,Z-=ie,b.back+=ie,64&ne){r.msg="invalid distance code",b.mode=G;break}b.offset=re,b.extra=15&ne,b.mode=24;case 24:if(b.extra){for(ue=b.extra;Z<ue;){if(0===Y)break e;Y--,q+=j[W++]<<Z,Z+=8}b.offset+=q&(1<<b.extra)-1,q>>>=b.extra,Z-=b.extra,b.back+=b.extra}if(b.offset>b.dmax){r.msg="invalid distance too far back",b.mode=G;break}b.mode=25;case 25:if(0===K)break e;if(ee=$-K,b.offset>ee){if((ee=b.offset-ee)>b.whave&&b.sane){r.msg="invalid distance too far back",b.mode=G;break}ee>b.wnext?(ee-=b.wnext,te=b.wsize-ee):te=b.wnext-ee,ee>b.length&&(ee=b.length),se=b.window}else se=V,te=X-b.offset,ee=b.length;ee>K&&(ee=K),K-=ee,b.length-=ee;do{V[X++]=se[te++]}while(--ee);0===b.length&&(b.mode=21);break;case 26:if(0===K)break e;V[X++]=b.length,K--,b.mode=21;break;case 27:if(b.wrap){for(;Z<32;){if(0===Y)break e;Y--,q|=j[W++]<<Z,Z+=8}if($-=K,r.total_out+=$,b.total+=$,$&&(r.adler=b.check=b.flags?x(b.check,V,$,X-$):I(b.check,V,$,X-$)),$=K,(b.flags?q:zswap32(q))!==b.check){r.msg="incorrect data check",b.mode=G;break}q=0,Z=0}b.mode=28;case 28:if(b.wrap&&b.flags){for(;Z<32;){if(0===Y)break e;Y--,q+=j[W++]<<Z,Z+=8}if(q!==(4294967295&b.total)){r.msg="incorrect length check",b.mode=G;break}q=0,Z=0}b.mode=29;case 29:de=1;break e;case G:de=-3;break e;case 31:return-4;default:return N}return r.next_out=X,r.avail_out=K,r.next_in=W,r.avail_in=Y,b.hold=q,b.bits=Z,(b.wsize||$!==r.avail_out&&b.mode<G&&(b.mode<27||4!==A))&&updatewindow(r,r.output,r.next_out,$-r.avail_out),J-=r.avail_in,$-=r.avail_out,r.total_in+=J,r.total_out+=$,b.total+=$,b.wrap&&$&&(r.adler=b.check=b.flags?x(b.check,V,$,r.next_out-$):I(b.check,V,$,r.next_out-$)),r.data_type=b.bits+(b.last?64:0)+(b.mode===H?128:0)+(20===b.mode||15===b.mode?256:0),(0===J&&0===$||4===A)&&de===F&&(de=-5),de},b.inflateEnd=function inflateEnd(r){if(!r||!r.state)return N;var A=r.state;return A.window&&(A.window=null),r.state=null,F},b.inflateGetHeader=function inflateGetHeader(r,A){var b;return r&&r.state?0==(2&(b=r.state).wrap)?N:(b.head=A,A.done=!1,F):N},b.inflateSetDictionary=function inflateSetDictionary(r,A){var b,C=A.length;return r&&r.state?0!==(b=r.state).wrap&&11!==b.mode?N:11===b.mode&&I(1,A,C,0)!==b.check?-3:updatewindow(r,A,C,C)?(b.mode=31,-4):(b.havedict=1,F):N},b.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(r,A,b){var C=r("../utils/common"),I=15,x=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],S=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],B=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],D=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];A.exports=function inflate_table(r,A,b,R,F,N,Q,H){var G,j,V,W,X,Y,K,q,Z,J=H.bits,$=0,ee=0,te=0,se=0,ie=0,ne=0,re=0,ae=0,oe=0,le=0,he=null,de=0,ce=new C.Buf16(16),ue=new C.Buf16(16),pe=null,Ae=0;for($=0;$<=I;$++)ce[$]=0;for(ee=0;ee<R;ee++)ce[A[b+ee]]++;for(ie=J,se=I;se>=1&&0===ce[se];se--);if(ie>se&&(ie=se),0===se)return F[N++]=20971520,F[N++]=20971520,H.bits=1,0;for(te=1;te<se&&0===ce[te];te++);for(ie<te&&(ie=te),ae=1,$=1;$<=I;$++)if(ae<<=1,(ae-=ce[$])<0)return-1;if(ae>0&&(0===r||1!==se))return-1;for(ue[1]=0,$=1;$<I;$++)ue[$+1]=ue[$]+ce[$];for(ee=0;ee<R;ee++)0!==A[b+ee]&&(Q[ue[A[b+ee]]++]=ee);if(0===r?(he=pe=Q,Y=19):1===r?(he=x,de-=257,pe=S,Ae-=257,Y=256):(he=B,pe=D,Y=-1),le=0,ee=0,$=te,X=N,ne=ie,re=0,V=-1,W=(oe=1<<ie)-1,1===r&&oe>852||2===r&&oe>592)return 1;for(;;){K=$-re,Q[ee]<Y?(q=0,Z=Q[ee]):Q[ee]>Y?(q=pe[Ae+Q[ee]],Z=he[de+Q[ee]]):(q=96,Z=0),G=1<<$-re,te=j=1<<ne;do{F[X+(le>>re)+(j-=G)]=K<<24|q<<16|Z|0}while(0!==j);for(G=1<<$-1;le&G;)G>>=1;if(0!==G?(le&=G-1,le+=G):le=0,ee++,0==--ce[$]){if($===se)break;$=A[b+Q[ee]]}if($>ie&&(le&W)!==V){for(0===re&&(re=ie),X+=te,ae=1<<(ne=$-re);ne+re<se&&!((ae-=ce[ne+re])<=0);)ne++,ae<<=1;if(oe+=1<<ne,1===r&&oe>852||2===r&&oe>592)return 1;F[V=le&W]=ie<<24|ne<<16|X-N|0}}return 0!==le&&(F[X+le]=$-re<<24|64<<16|0),H.bits=ie,0}},{"../utils/common":41}],51:[function(r,A,b){A.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(r,A,b){var C=r("../utils/common"),I=0,x=1;function zero(r){for(var A=r.length;--A>=0;)r[A]=0}var S=0,B=29,D=256,R=D+1+B,F=30,N=19,Q=2*R+1,H=15,G=16,j=7,V=256,W=16,X=17,Y=18,K=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],q=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],J=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],$=new Array(2*(R+2));zero($);var ee=new Array(2*F);zero(ee);var te=new Array(512);zero(te);var se=new Array(256);zero(se);var ie=new Array(B);zero(ie);var ne,re,ae,oe=new Array(F);function StaticTreeDesc(r,A,b,C,I){this.static_tree=r,this.extra_bits=A,this.extra_base=b,this.elems=C,this.max_length=I,this.has_stree=r&&r.length}function TreeDesc(r,A){this.dyn_tree=r,this.max_code=0,this.stat_desc=A}function d_code(r){return r<256?te[r]:te[256+(r>>>7)]}function put_short(r,A){r.pending_buf[r.pending++]=255&A,r.pending_buf[r.pending++]=A>>>8&255}function send_bits(r,A,b){r.bi_valid>G-b?(r.bi_buf|=A<<r.bi_valid&65535,put_short(r,r.bi_buf),r.bi_buf=A>>G-r.bi_valid,r.bi_valid+=b-G):(r.bi_buf|=A<<r.bi_valid&65535,r.bi_valid+=b)}function send_code(r,A,b){send_bits(r,b[2*A],b[2*A+1])}function bi_reverse(r,A){var b=0;do{b|=1&r,r>>>=1,b<<=1}while(--A>0);return b>>>1}function gen_codes(r,A,b){var C,I,x=new Array(H+1),S=0;for(C=1;C<=H;C++)x[C]=S=S+b[C-1]<<1;for(I=0;I<=A;I++){var B=r[2*I+1];0!==B&&(r[2*I]=bi_reverse(x[B]++,B))}}function init_block(r){var A;for(A=0;A<R;A++)r.dyn_ltree[2*A]=0;for(A=0;A<F;A++)r.dyn_dtree[2*A]=0;for(A=0;A<N;A++)r.bl_tree[2*A]=0;r.dyn_ltree[2*V]=1,r.opt_len=r.static_len=0,r.last_lit=r.matches=0}function bi_windup(r){r.bi_valid>8?put_short(r,r.bi_buf):r.bi_valid>0&&(r.pending_buf[r.pending++]=r.bi_buf),r.bi_buf=0,r.bi_valid=0}function smaller(r,A,b,C){var I=2*A,x=2*b;return r[I]<r[x]||r[I]===r[x]&&C[A]<=C[b]}function pqdownheap(r,A,b){for(var C=r.heap[b],I=b<<1;I<=r.heap_len&&(I<r.heap_len&&smaller(A,r.heap[I+1],r.heap[I],r.depth)&&I++,!smaller(A,C,r.heap[I],r.depth));)r.heap[b]=r.heap[I],b=I,I<<=1;r.heap[b]=C}function compress_block(r,A,b){var C,I,x,S,B=0;if(0!==r.last_lit)do{C=r.pending_buf[r.d_buf+2*B]<<8|r.pending_buf[r.d_buf+2*B+1],I=r.pending_buf[r.l_buf+B],B++,0===C?send_code(r,I,A):(send_code(r,(x=se[I])+D+1,A),0!==(S=K[x])&&send_bits(r,I-=ie[x],S),send_code(r,x=d_code(--C),b),0!==(S=q[x])&&send_bits(r,C-=oe[x],S))}while(B<r.last_lit);send_code(r,V,A)}function build_tree(r,A){var b,C,I,x=A.dyn_tree,S=A.stat_desc.static_tree,B=A.stat_desc.has_stree,D=A.stat_desc.elems,R=-1;for(r.heap_len=0,r.heap_max=Q,b=0;b<D;b++)0!==x[2*b]?(r.heap[++r.heap_len]=R=b,r.depth[b]=0):x[2*b+1]=0;for(;r.heap_len<2;)x[2*(I=r.heap[++r.heap_len]=R<2?++R:0)]=1,r.depth[I]=0,r.opt_len--,B&&(r.static_len-=S[2*I+1]);for(A.max_code=R,b=r.heap_len>>1;b>=1;b--)pqdownheap(r,x,b);I=D;do{b=r.heap[1],r.heap[1]=r.heap[r.heap_len--],pqdownheap(r,x,1),C=r.heap[1],r.heap[--r.heap_max]=b,r.heap[--r.heap_max]=C,x[2*I]=x[2*b]+x[2*C],r.depth[I]=(r.depth[b]>=r.depth[C]?r.depth[b]:r.depth[C])+1,x[2*b+1]=x[2*C+1]=I,r.heap[1]=I++,pqdownheap(r,x,1)}while(r.heap_len>=2);r.heap[--r.heap_max]=r.heap[1],function gen_bitlen(r,A){var b,C,I,x,S,B,D=A.dyn_tree,R=A.max_code,F=A.stat_desc.static_tree,N=A.stat_desc.has_stree,G=A.stat_desc.extra_bits,j=A.stat_desc.extra_base,V=A.stat_desc.max_length,W=0;for(x=0;x<=H;x++)r.bl_count[x]=0;for(D[2*r.heap[r.heap_max]+1]=0,b=r.heap_max+1;b<Q;b++)(x=D[2*D[2*(C=r.heap[b])+1]+1]+1)>V&&(x=V,W++),D[2*C+1]=x,C>R||(r.bl_count[x]++,S=0,C>=j&&(S=G[C-j]),B=D[2*C],r.opt_len+=B*(x+S),N&&(r.static_len+=B*(F[2*C+1]+S)));if(0!==W){do{for(x=V-1;0===r.bl_count[x];)x--;r.bl_count[x]--,r.bl_count[x+1]+=2,r.bl_count[V]--,W-=2}while(W>0);for(x=V;0!==x;x--)for(C=r.bl_count[x];0!==C;)(I=r.heap[--b])>R||(D[2*I+1]!==x&&(r.opt_len+=(x-D[2*I+1])*D[2*I],D[2*I+1]=x),C--)}}(r,A),gen_codes(x,R,r.bl_count)}function scan_tree(r,A,b){var C,I,x=-1,S=A[1],B=0,D=7,R=4;for(0===S&&(D=138,R=3),A[2*(b+1)+1]=65535,C=0;C<=b;C++)I=S,S=A[2*(C+1)+1],++B<D&&I===S||(B<R?r.bl_tree[2*I]+=B:0!==I?(I!==x&&r.bl_tree[2*I]++,r.bl_tree[2*W]++):B<=10?r.bl_tree[2*X]++:r.bl_tree[2*Y]++,B=0,x=I,0===S?(D=138,R=3):I===S?(D=6,R=3):(D=7,R=4))}function send_tree(r,A,b){var C,I,x=-1,S=A[1],B=0,D=7,R=4;for(0===S&&(D=138,R=3),C=0;C<=b;C++)if(I=S,S=A[2*(C+1)+1],!(++B<D&&I===S)){if(B<R)do{send_code(r,I,r.bl_tree)}while(0!=--B);else 0!==I?(I!==x&&(send_code(r,I,r.bl_tree),B--),send_code(r,W,r.bl_tree),send_bits(r,B-3,2)):B<=10?(send_code(r,X,r.bl_tree),send_bits(r,B-3,3)):(send_code(r,Y,r.bl_tree),send_bits(r,B-11,7));B=0,x=I,0===S?(D=138,R=3):I===S?(D=6,R=3):(D=7,R=4)}}zero(oe);var le=!1;function _tr_stored_block(r,A,b,I){send_bits(r,(S<<1)+(I?1:0),3),function copy_block(r,A,b,I){bi_windup(r),I&&(put_short(r,b),put_short(r,~b)),C.arraySet(r.pending_buf,r.window,A,b,r.pending),r.pending+=b}(r,A,b,!0)}b._tr_init=function _tr_init(r){le||(!function tr_static_init(){var r,A,b,C,I,x=new Array(H+1);for(b=0,C=0;C<B-1;C++)for(ie[C]=b,r=0;r<1<<K[C];r++)se[b++]=C;for(se[b-1]=C,I=0,C=0;C<16;C++)for(oe[C]=I,r=0;r<1<<q[C];r++)te[I++]=C;for(I>>=7;C<F;C++)for(oe[C]=I<<7,r=0;r<1<<q[C]-7;r++)te[256+I++]=C;for(A=0;A<=H;A++)x[A]=0;for(r=0;r<=143;)$[2*r+1]=8,r++,x[8]++;for(;r<=255;)$[2*r+1]=9,r++,x[9]++;for(;r<=279;)$[2*r+1]=7,r++,x[7]++;for(;r<=287;)$[2*r+1]=8,r++,x[8]++;for(gen_codes($,R+1,x),r=0;r<F;r++)ee[2*r+1]=5,ee[2*r]=bi_reverse(r,5);ne=new StaticTreeDesc($,K,D+1,R,H),re=new StaticTreeDesc(ee,q,0,F,H),ae=new StaticTreeDesc(new Array(0),Z,0,N,j)}(),le=!0),r.l_desc=new TreeDesc(r.dyn_ltree,ne),r.d_desc=new TreeDesc(r.dyn_dtree,re),r.bl_desc=new TreeDesc(r.bl_tree,ae),r.bi_buf=0,r.bi_valid=0,init_block(r)},b._tr_stored_block=_tr_stored_block,b._tr_flush_block=function _tr_flush_block(r,A,b,C){var S,B,R=0;r.level>0?(2===r.strm.data_type&&(r.strm.data_type=function detect_data_type(r){var A,b=4093624447;for(A=0;A<=31;A++,b>>>=1)if(1&b&&0!==r.dyn_ltree[2*A])return I;if(0!==r.dyn_ltree[18]||0!==r.dyn_ltree[20]||0!==r.dyn_ltree[26])return x;for(A=32;A<D;A++)if(0!==r.dyn_ltree[2*A])return x;return I}(r)),build_tree(r,r.l_desc),build_tree(r,r.d_desc),R=function build_bl_tree(r){var A;for(scan_tree(r,r.dyn_ltree,r.l_desc.max_code),scan_tree(r,r.dyn_dtree,r.d_desc.max_code),build_tree(r,r.bl_desc),A=N-1;A>=3&&0===r.bl_tree[2*J[A]+1];A--);return r.opt_len+=3*(A+1)+5+5+4,A}(r),S=r.opt_len+3+7>>>3,(B=r.static_len+3+7>>>3)<=S&&(S=B)):S=B=b+5,b+4<=S&&-1!==A?_tr_stored_block(r,A,b,C):4===r.strategy||B===S?(send_bits(r,2+(C?1:0),3),compress_block(r,$,ee)):(send_bits(r,4+(C?1:0),3),function send_all_trees(r,A,b,C){var I;for(send_bits(r,A-257,5),send_bits(r,b-1,5),send_bits(r,C-4,4),I=0;I<C;I++)send_bits(r,r.bl_tree[2*J[I]+1],3);send_tree(r,r.dyn_ltree,A-1),send_tree(r,r.dyn_dtree,b-1)}(r,r.l_desc.max_code+1,r.d_desc.max_code+1,R+1),compress_block(r,r.dyn_ltree,r.dyn_dtree)),init_block(r),C&&bi_windup(r)},b._tr_tally=function _tr_tally(r,A,b){return r.pending_buf[r.d_buf+2*r.last_lit]=A>>>8&255,r.pending_buf[r.d_buf+2*r.last_lit+1]=255&A,r.pending_buf[r.l_buf+r.last_lit]=255&b,r.last_lit++,0===A?r.dyn_ltree[2*b]++:(r.matches++,A--,r.dyn_ltree[2*(se[b]+D+1)]++,r.dyn_dtree[2*d_code(A)]++),r.last_lit===r.lit_bufsize-1},b._tr_align=function _tr_align(r){send_bits(r,2,3),send_code(r,V,$),function bi_flush(r){16===r.bi_valid?(put_short(r,r.bi_buf),r.bi_buf=0,r.bi_valid=0):r.bi_valid>=8&&(r.pending_buf[r.pending++]=255&r.bi_buf,r.bi_buf>>=8,r.bi_valid-=8)}(r)}},{"../utils/common":41}],53:[function(r,A,b){A.exports=function ZStream(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(r,A,b){(function(r){!function(r,A){if(!r.setImmediate){var b,C=1,I={},x=!1,S=r.document,B=Object.getPrototypeOf&&Object.getPrototypeOf(r);B=B&&B.setTimeout?B:r,"[object process]"==={}.toString.call(r.process)?function installNextTickImplementation(){b=function(r){process.nextTick((function(){runIfPresent(r)}))}}():!function canUsePostMessage(){if(r.postMessage&&!r.importScripts){var A=!0,b=r.onmessage;return r.onmessage=function(){A=!1},r.postMessage("","*"),r.onmessage=b,A}}()?r.MessageChannel?function installMessageChannelImplementation(){var r=new MessageChannel;r.port1.onmessage=function(r){runIfPresent(r.data)},b=function(A){r.port2.postMessage(A)}}():S&&"onreadystatechange"in S.createElement("script")?function installReadyStateChangeImplementation(){var r=S.documentElement;b=function(A){var b=S.createElement("script");b.onreadystatechange=function(){runIfPresent(A),b.onreadystatechange=null,r.removeChild(b),b=null},r.appendChild(b)}}():function installSetTimeoutImplementation(){b=function(r){setTimeout(runIfPresent,0,r)}}():function installPostMessageImplementation(){var A="setImmediate$"+Math.random()+"$",onGlobalMessage=function(b){b.source===r&&"string"==typeof b.data&&0===b.data.indexOf(A)&&runIfPresent(+b.data.slice(A.length))};r.addEventListener?r.addEventListener("message",onGlobalMessage,!1):r.attachEvent("onmessage",onGlobalMessage),b=function(b){r.postMessage(A+b,"*")}}(),B.setImmediate=function setImmediate(r){"function"!=typeof r&&(r=new Function(""+r));for(var A=new Array(arguments.length-1),x=0;x<A.length;x++)A[x]=arguments[x+1];var S={callback:r,args:A};return I[C]=S,b(C),C++},B.clearImmediate=clearImmediate}function clearImmediate(r){delete I[r]}function runIfPresent(r){if(x)setTimeout(runIfPresent,0,r);else{var b=I[r];if(b){x=!0;try{!function run(r){var b=r.callback,C=r.args;switch(C.length){case 0:b();break;case 1:b(C[0]);break;case 2:b(C[0],C[1]);break;case 3:b(C[0],C[1],C[2]);break;default:b.apply(A,C)}}(b)}finally{clearImmediate(r),x=!1}}}}}("undefined"==typeof self?void 0===r?this:r:self)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[10])(10)})),Tc=function(){return function e(r,A,b){function s(I,x){if(!A[I]){if(!r[I]){var S="function"==typeof require&&require;if(!x&&S)return S(I,!0);if(C)return C(I,!0);throw new Error("Cannot find module '"+I+"'")}var B=A[I]={exports:{}};r[I][0].call(B.exports,(function(A){var b=r[I][1][A];return s(b||A)}),B,B.exports,e,r,A,b)}return A[I].exports}for(var C="function"==typeof require&&require,I=0;I<b.length;I++)s(b[I]);return s}({1:[function(r,A,b){var C={};function createStandardXHR(){try{return new window.XMLHttpRequest}catch(r){}}C._getBinaryFromXHR=function(r){return r.response||r.responseText};var I="undefined"!=typeof window&&window.ActiveXObject?function(){return createStandardXHR()||function createActiveXHR(){try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(r){}}()}:createStandardXHR;C.getBinaryContent=function(r,A){var b,x,S,B;A||(A={}),"function"==typeof A?(B=A,A={}):"function"==typeof A.callback&&(B=A.callback),B||"undefined"==typeof Promise?(x=function(r){B(null,r)},S=function(r){B(r,null)}):b=new Promise((function(r,A){x=r,S=A}));try{var D=I();D.open("GET",r,!0),"responseType"in D&&(D.responseType="arraybuffer"),D.overrideMimeType&&D.overrideMimeType("text/plain; charset=x-user-defined"),D.onreadystatechange=function(A){if(4===D.readyState)if(200===D.status||0===D.status)try{x(C._getBinaryFromXHR(D))}catch(r){S(new Error(r))}else S(new Error("Ajax error for "+r+" : "+this.status+" "+this.statusText))},A.progress&&(D.onprogress=function(b){A.progress({path:r,originalEvent:b,percent:b.loaded/b.total*100,loaded:b.loaded,total:b.total})}),D.send()}catch(r){S(new Error(r),null)}return b},A.exports=C},{}]},{},[1])(1)},"object"==typeof exports?module.exports=Tc():"function"==typeof define&&define.amd?define(Tc):"undefined"!=typeof window?window.JSZipUtils=Tc():"undefined"!=typeof global?global.JSZipUtils=Tc():"undefined"!=typeof self&&(self.JSZipUtils=Tc());const Bc="FADE_IN",Dc="SUSTAIN",Pc="FADE_OUT",Mc=new Style({backgroundVisible:!0,borderRadius:.01,height:.04,justifyContent:"center",materialColor:qa.defaultMenuBackground,opacity:.8,width:.3});class NotificationHub extends Span{constructor(){super(Mc),this._createNotification(),this._addSubscriptions(),this.position.setZ(.01),this._notificationHeight=0,this._notifications=[]}_createNotification(){this._textComponent=new TextComponent("Placeholder",ro.bodyText),this.add(this._textComponent),this.visible=!1}setNotificationHeight(r){this._notificationHeight=r}_handleNotification(r){this._notifications.push({state:Bc,text:r.text,sustainTime:r.sustainTime||3,fadeTime:r.fadeTime||1,timeInState:0})}_addSubscriptions(){Qt.subscribe(this._id,Rt.MENU_NOTIFICATION,(r=>{this._handleNotification(r)}))}update(r){if(0==this._notifications.length)return;let A=this._notifications[0];if(A.state==Bc){if(0==A.timeInState){this.visible=!0;let r=.02*Math.ceil(A.text.length/20)+.02;this.height=r,this._textComponent.text=A.text,this.position.setY(this._notificationHeight)}A.timeInState=Math.min(A.timeInState+r,A.fadeTime);let b=A.timeInState/A.fadeTime;this.material.opacity=.8*b,this._textComponent.troikaText.material.opacity=b,1==b&&(A.state=Dc,A.timeInState=0)}else if(A.state==Dc)A.timeInState+=r,A.timeInState>=A.sustainTime&&(A.state=Pc,A.timeInState=0);else if(A.state==Pc){A.timeInState=Math.min(A.timeInState+r,A.fadeTime);let b=1-A.timeInState/A.fadeTime;this.material.opacity=.8*b,this._textComponent.troikaText.material.opacity=b,0==b&&(this._notifications.shift(),this.position.setY(0),this.visible=!1)}}}class MenuGripInteractable extends GripInteractable{constructor(r,A){super(r),r&&(r.gripInteractable=this),this._border=A}_createBoundingObject(){this._boundingPlane=new r.Plane}_getBoundingObject(){return this._object.getWorldPosition(ao[0]),this._object.getWorldQuaternion(ho),ao[1].set(0,0,1).applyQuaternion(ho),this._boundingPlane.setFromNormalAndCoplanarPoint(ao[1],ao[0]),this._boundingPlane}_displayBoundingObject(){this._object.add(this._border)}_hideBoundingObject(){this._object.remove(this._border)}intersectsSphere(r){let A,b=this._getBoundingObject();return A=!!b&&(r.intersectsPlane(b)&&r.distanceToPoint(ao[0])<.45),A}distanceToSphere(r){return this._boundingPlane.distanceToPoint(r.center)}}class MenuController{constructor(){this._id=uuidv4(),this._object=new r.Object3D,this._object.position.setZ(-100),this._object.addEventListener("added",(()=>this._onAdded())),this._object.addEventListener("removed",(()=>this._onRemoved())),this._createInteractables(),this._pages={},this._pageCalls=[],this._gripOwners=new Set,this._eventAlreadyTriggered=!1,this._addEventListeners(),this._setupNotificationHub()}_addEventListeners(){let r=document.getElementById("mobile-menu-open-button");r.addEventListener("click",(()=>{this._openMenu()})),Qt.subscribe(this._id,Rt.SESSION_STARTED,(()=>{"XR"!=Mt.deviceType&&r.classList.remove("hidden")}))}_setupNotificationHub(){this._notificationHub=new NotificationHub,this._object.add(this._notificationHub),this._notificationHub.setNotificationHeight(.18)}getCurrentPage(){return this._pages[this._pageCalls[this._pageCalls.length-1]]}getPage(r){return this._pages[r]}setPage(r){let A=this.getCurrentPage();A.parent&&A.parent.remove(A),this._pageCalls=[r],A=this.getCurrentPage(),this._object.add(A)}pushPage(r){let A=this.getCurrentPage();A.parent&&A.parent.remove(A),this._pageCalls.push(r),this._object.add(this._pages[r])}popPage(){if(this._pageCalls.length<=1)return;let r=this.getCurrentPage();r.parent&&r.parent.remove(r),this._pageCalls.pop(),r=this.getCurrentPage(),this._object.add(r)}popPagesPast(r){let A,b;do{b=this.getCurrentPage(),A=this._pageCalls[this._pageCalls.length-1],b.back()}while(A!=r)}popAllPages(){for(;this._pageCalls.length>1;){this.getCurrentPage().back()}}back(){this.getCurrentPage().back()}_createBorder(){let A=new Uint16Array([0,1,1,2,2,3,3,0]),b=new r.BufferGeometry;b.setIndex(new r.BufferAttribute(A,1)),b.setAttribute("position",new r.Float32BufferAttribute([.225,.15,0,-.225,.15,0,-.225,-.15,0,.225,-.15,0],3));let C=new r.LineSegments(b);return C.material.color.set(16776960),C}_createInteractables(){if(new OrbitDisablingPointerInteractable(this._object),new TouchInteractable(this._object),"XR"!=Mt.deviceType)return;let r=this._createBorder(),A=new MenuGripInteractable(this._object,r);A.addEventListener("down",(r=>{A.capture(r.owner);let b=il.getAsset(r.owner.id);b&&b.object.attach(this._object),this._gripOwners.add(r.owner.id)})),A.addEventListener("click",(r=>{let A=il.getAsset(r.owner.id);this._object.parent==A.object&&Ho.object.attach(this._object),this._gripOwners.delete(r.owner.id)}))}getPosition(r){return this._object.getWorldPosition(r)}getDirection(r){return this._object.getWorldDirection(r)}update(r){"XR"==Mt.deviceType?(this._updateVR(r),this.update=this._updateVR):"POINTER"==Mt.deviceType?(this._updatePointer(r),this.update=this._updatePointer):"TOUCH_SCREEN"==Mt.deviceType&&(this._updateMobile(r),this.update=this._updateMobile)}_openMenu(){let r=Wo.getUserScale();Mt.renderer.getSize(oo);let A=oo.x/oo.y,b=A>1.15?1.5:1.5*A;Mt.camera.getWorldPosition(ao[0]),Mt.camera.getWorldDirection(ao[1]),ao[1].normalize().divideScalar(b).multiplyScalar(r),this._object.position.addVectors(ao[0],ao[1]),this._object.lookAt(ao[0]),this._object.scale.set(r,r,r),Ho.object.add(this._object)}closeMenu(){this._object.parent&&this._object.parent.remove(this._object)}_updateVR(r){if(Mt.sessionActive){let r=$n.getXRGamepad(on.RIGHT),A=$n.getXRGamepad(on.LEFT);r?.buttons[4]?.pressed||A?.buttons[4]?.pressed?this._eventAlreadyTriggered||(this._eventAlreadyTriggered=!0,0==this._gripOwners.size&&this._openMenu()):this._eventAlreadyTriggered=!1}this._notificationHub.update(r)}_updatePointer(r){Mt.sessionActive&&!Mt.keyboardLock&&($n.isKeyPressed("m")||$n.isKeyPressed("M")?this._eventAlreadyTriggered||(this._eventAlreadyTriggered=!0,this._openMenu()):this._eventAlreadyTriggered=!1),this._notificationHub.update(r)}_updateMobile(r){this._notificationHub.update(r)}_onAdded(){"XR"==Mt.deviceType&&(Qa.addInteractable(this._object.gripInteractable),ir.addInteractable(this._object.touchInteractable)),tr.addInteractable(this._object.pointerInteractable)}_onRemoved(){"XR"==Mt.deviceType&&(Qa.removeInteractable(this._object.gripInteractable),ir.removeInteractable(this._object.touchInteractable)),tr.removeInteractable(this._object.pointerInteractable)}}const kc=new Style({borderRadius:.01,borderWidth:.001,height:.3,materialColor:qa.defaultMenuBackground,opacity:.7,width:.45});class MenuPage extends Body{constructor(r,A){super(kc),this._id=uuidv4(),this._controller=r,this._createCloseButton(),this._updateMaterialOffset(100),A&&this._createBackButton(),"XR"==Mt.deviceType&&(this.onClick=()=>{})}_createBackButton(){let r=createSmallButton("<");r.bypassContentPositioning=!0,r.position.fromArray([-.225,.15,.001]),r.onClickAndTouch=()=>this.back(),r._updateMaterialOffset(100),this.add(r),this._createHomeButton()}_createHomeButton(){let r=createSmallButton(Ya.homeIcon,.9);r.bypassContentPositioning=!0,r.position.fromArray([-.225,.1,.001]),r.onClickAndTouch=()=>this._controller.popAllPages(),r._updateMaterialOffset(100),this.add(r)}_createCloseButton(){let r=createSmallButton("X");r.bypassContentPositioning=!0,r.position.fromArray([.225,.15,.001]),r.onClickAndTouch=()=>this._controller.closeMenu(),r._updateMaterialOffset(100),this.add(r)}back(){this._controller.popPage()}}class AcknowledgementsPage extends MenuPage{constructor(r){super(r,!0),this._page=0,this._acknowledgements=[],this._addPageContent()}_addPageContent(){this._createPreviousAndNextButtons(),this._titleBlock=new TextComponent("",ro.title),this.add(this._titleBlock),this._noAcknowledgements=new TextComponent("No Acknowledgements to Display",ro.bodyText),this._acknowledgementsContainer=new Span({height:.2,justifyContent:"spaceEvenly",width:.45});let r=new Div({height:.2,justifyContent:"spaceBetween",width:.31});this._textureBlock=new ia(Ya.ellipsisIcon,{height:.085,textureFit:"cover",width:.1}),r.add(this._textureBlock),this._authorBlock=new TextComponent("Author: ",ro.bodyText),r.add(this._authorBlock),this._licenseBlock=new TextComponent("License: ",ro.bodyText),r.add(this._licenseBlock),this._sourceButtonParent=new Div,this._sourceButton=createWideButton("View Source"),this._sourceButtonParent.add(this._sourceButton),r.add(this._sourceButtonParent),this._sourceButton.onClickAndTouch=()=>{"XR"==Mt.deviceType&&el.exitXRSession(),window.open(this._acknowledgements[this._page]["Source URL"],"_blank")},this.add(this._acknowledgementsContainer),this._acknowledgementsContainer.add(this._previousButtonParent),this._acknowledgementsContainer.add(r),this._acknowledgementsContainer.add(this._nextButtonParent)}_createPreviousAndNextButtons(){this._previousButtonParent=new Div,this._previousButton=createSmallButton("<"),this._previousButton.onClickAndTouch=()=>{this._page+=this._acknowledgements.length-1,this._page%=this._acknowledgements.length,this._setAsset()},this._previousButtonParent.add(this._previousButton),this._nextButtonParent=new Div,this._nextButton=createSmallButton(">"),this._nextButton.onClickAndTouch=()=>{this._page+=1,this._page%=this._acknowledgements.length,this._setAsset()},this._nextButtonParent.add(this._nextButton)}_refreshAssets(){if(this._acknowledgements=Wo.getAcknowledgements(),this._acknowledgements.length>1)this._page>=this._acknowledgements.length&&(this._page=0),this._previousButtonParent.add(this._previousButton),this._nextButtonParent.add(this._nextButton);else if(this._previousButtonParent.remove(this._previousButton),this._nextButtonParent.remove(this._nextButton),0==this._acknowledgements.length)return this.remove(this._acknowledgementsContainer),void this.add(this._noAcknowledgements);this._setAsset()}_setAsset(){let r=this._page,A=this._acknowledgements[r];this._titleBlock.text=A.Asset,A.Author?(this._authorBlock.text="Author: "+A.Author,this._authorBlock.visible=!0):this._authorBlock.visible=!1,A.License?(this._licenseBlock.text="License: "+A.License,this._licenseBlock.visible=!0):this._licenseBlock.visible=!1,A.previewTexture?(this._textureBlock.updateTexture(A.previewTexture),this._textureBlock.visible=!0):A["Preview Image URL"]&&!A.isLoadingTexture?(this._textureBlock.visible=!1,A.isLoadingTexture=!0,(new ue).load(A["Preview Image URL"],(b=>{this._page==r&&(A.previewTexture=b,this._setAsset())}))):this._textureBlock.visible=!1,A["Source URL"]?this._sourceButtonParent.add(this._sourceButton):this._sourceButtonParent.remove(this._sourceButton)}_onAdded(){this._refreshAssets(),super._onAdded()}}const Rc=.22;class DynamicFieldsPage extends MenuPage{constructor(r){super(r,!0),this._firstItemIndex=0,this._lastItemIndex=-1,this._fields=[],this._addPageContent()}_addPageContent(){this._createPreviousAndNextButtons(),this._createTitleBlock();let r=new Span({height:Rc,justifyContent:"spaceEvenly",width:.45});this._fieldsContainer=new Div({height:Rc,justifyContent:"spaceBetween",width:.31}),r.add(this._previousButtonParent),r.add(this._fieldsContainer),r.add(this._nextButtonParent),this.add(this._titleBlock),this.add(r)}_createTitleBlock(){this._titleBlock=new TextComponent("",ro.title),this.add(this._titleBlock)}_createPreviousAndNextButtons(){this._previousButtonParent=new Div,this._previousButton=createSmallButton("<"),this._previousButton.onClickAndTouch=()=>this._loadPrevPage(),this._previousButtonParent.add(this._previousButton),this._nextButtonParent=new Div,this._nextButton=createSmallButton(">"),this._nextButton.onClickAndTouch=()=>this._loadNextPage(),this._nextButtonParent.add(this._nextButton)}_setFields(r){this._removeCurrentFields(),this._firstItemIndex=0,this._lastItemIndex=-1,this._fields=r,this._loadNextPage();for(let A of r)A.updateFromSource()}_removeField(r){let A=this._fields.indexOf(r);r.deactivate(),this._fieldsContainer.remove(r),this._fields.splice(A,1),A<=this._lastItemIndex?(A<this._firstItemIndex&&this._firstItemIndex--,this._lastItemIndex--,this._firstItemIndex==this._fields.length?this._loadPrevPage():(this._removeCurrentFields(),this._lastItemIndex=this._firstItemIndex-1,this._loadNextPage())):this._fields.length==this._lastItemIndex+1&&this._updateNavButtons()}_loadNextPage(){this._removeCurrentFields(),this._firstItemIndex=this._lastItemIndex+1;let r=Rc;for(let A=this._firstItemIndex;A<this._fields.length;A++){let b=this._fields[A];if(r-=b.computedHeight,!(r>=0||A==this._firstItemIndex))break;this._fieldsContainer.add(b),this._lastItemIndex=A}this._updateNavButtons()}_loadPrevPage(){this._removeCurrentFields();let r=Rc;this._lastItemIndex=this._firstItemIndex-1;let A=[];for(let b=this._lastItemIndex;b>=0;b--){let C=this._fields[b];if(r-=C.computedHeight,!(r>=0||b==this._lastItemIndex))break;A.push(C),this._firstItemIndex=b}for(let r=A.length-1;r>=0;r--)this._fieldsContainer.add(A[r]);this._updateNavButtons()}_updateNavButtons(){0==this._firstItemIndex?this._previousButtonParent.remove(this._previousButton):this._previousButton.parentComponent||this._previousButtonParent.add(this._previousButton),this._lastItemIndex+1==this._fields.length?this._nextButtonParent.remove(this._nextButton):this._nextButton.parentComponent||this._nextButtonParent.add(this._nextButton)}_removeCurrentFields(){for(let r=this._firstItemIndex;r<=this._lastItemIndex;r++){let A=this._fields[r];A.deactivate(),this._fieldsContainer.remove(A)}}_unfocusFields(){for(let r=this._firstItemIndex;r<=this._lastItemIndex;r++)this._fields[r].deactivate()}}class AssetPage extends DynamicFieldsPage{constructor(r,A){super(r,!0),this._assetType=A,this._assetStack=[]}_createTitleBlock(){this._titleBlock=new Span({height:.04,justifyContent:"spaceBetween",margin:.01,width:.39}),this._titleField=createTextInput({borderRadius:.02,fontSize:Ja,height:.04,width:.29}),this._titleField.onBlur=()=>{Mt.keyboardLock=!1,this._asset.editorHelper.updateName(this._titleField.value)},this._titleField.onEnter=()=>this._titleField.blur(),this._titleField.onFocus=()=>{Mt.keyboardLock=!0};let r=createSmallButton(Ya.componentIcon,.7),A=createSmallButton(Ya.trashIcon,.7);this._titleBlock.add(r),this._titleBlock.add(this._titleField),this._titleBlock.add(A),r.onClickAndTouch=()=>{this._controller.getPage(Vh.LIST_COMPONENTS).setContent(this._asset),this._controller.pushPage(Vh.LIST_COMPONENTS)},A.onClickAndTouch=()=>il.deleteAsset(this._asset)}setAsset(r,A){this._asset=r;let b=r.name;this._titleField.value=b,this._setFields(r.editorHelper.getMenuFields()),A||this._assetStack.push(r)}_addSubscriptions(){Qt.subscribe(this._id,this._assetType+"_DELETED",(r=>{for(;this._assetStack.includes(r.asset);)this._controller.popPagesPast(this._assetType)})),Qt.subscribe(this._id,this._assetType+"_UPDATED",(r=>{r.asset==this._asset&&(this._titleField.value=r.asset.name)})),Qt.subscribe(this._id,Rt.PROJECT_LOADING,(r=>{r&&(this._removeSubscriptions(),this._controller.setPage(Vh.NAVIGATION),this._assetStack=[])}))}_removeSubscriptions(){Qt.unsubscribe(this._id,this._assetType+"_DELETED"),Qt.unsubscribe(this._id,this._assetType+"_UPDATED"),Qt.unsubscribe(this._id,Rt.PROJECT_LOADING)}back(){this._removeCurrentFields(),this._assetStack.pop(),this._assetStack.length?this.setAsset(this._assetStack[this._assetStack.length-1],!0):this._removeSubscriptions(),super.back()}_onAdded(){this._addSubscriptions(),super._onAdded()}}class PaginatedPage extends MenuPage{constructor(r,A){super(r,A),this._page=0}_createPreviousAndNextButtons(){this._previousButtonParent=new Div,this._previousButton=createSmallButton("<"),this._previousButton.onClickAndTouch=()=>{this._page-=1,this._updateItemsGUI()},this._previousButtonParent.add(this._previousButton),this._nextButtonParent=new Div,this._nextButton=createSmallButton(">"),this._nextButton.onClickAndTouch=()=>{this._page+=1,this._updateItemsGUI()},this._nextButtonParent.add(this._nextButton)}_updatePreviousAndNextButtons(r){0==this._page?this._previousButton.parentComponent&&this._previousButtonParent.remove(this._previousButton):this._previousButton.parentComponent||this._previousButtonParent.add(this._previousButton),this._items.length>r?this._nextButton.parentComponent||this._nextButtonParent.add(this._nextButton):this._nextButton.parentComponent&&this._nextButtonParent.remove(this._nextButton)}_updateItemsGUI(){console.error("PaginatedPage._updateItemsGUI() should be overridden")}}class PaginatedButtonsPage extends PaginatedPage{constructor(r,A){super(r,A),this._paginatedListButtons=[]}_addList(){this._createPreviousAndNextButtons(),this._optionsContainer=new Span({height:.215,justifyContent:"spaceEvenly",width:.45}),this._optionsBlock=new Div({height:.215});for(let r=0;r<5;r++){let A=createWideButton();A.marginTop=.004,A.marginBottom=.004,A.onClickAndTouch=()=>{let A=5*this._page+r;this._items.length>A?this._handleItemInteraction(this._items[A]):console.error("PaginatedButtonsPage displaying non existant option")},this._optionsBlock.add(A),this._paginatedListButtons.push(A)}this._optionsContainer.add(this._previousButtonParent),this._optionsContainer.add(this._optionsBlock),this._optionsContainer.add(this._nextButtonParent),this.add(this._optionsContainer)}_updateItemsGUI(){let r=5*this._page;for(let A=0;A<5;A++){let b=this._paginatedListButtons[A];if(r+A<this._items.length){let C=this._items[r+A];b.textComponent.text=this._getItemName(C),b.parentComponent||this._optionsBlock.add(b)}else b.parentComponent&&b.parentComponent.remove(b)}this._updatePreviousAndNextButtons(r+5)}_getItemName(){return console.error("PaginatedButtonsPage._getItemName() should be overridden"),""}_handleItemInteraction(){console.error("PaginatedButtonsPage._handleItemInteraction() should be overridden")}_refreshItems(){console.error("PaginatedButtonsPage._refreshItems() should be overridden")}_onAdded(){super._onAdded(),this._refreshItems(),this._updateItemsGUI()}}class AssetsPage extends PaginatedButtonsPage{constructor(r,A){super(r,!0),this._assetType=A,this._assets={},this._items=[],this._addPageContent(),this._createAddButton()}_addPageContent(){let r="CUSTOM_ASSET"==this._assetType?"Other Assets":this._assetType[0]+this._assetType.slice(1).toLowerCase(),A=new TextComponent(r,ro.title);this.add(A),this._addList()}_createAddButton(){let r=createSmallButton("+");r.bypassContentPositioning=!0,r.position.fromArray([.175,.12,.001]),r.onClickAndTouch=()=>{this._controller.getPage("NEW_ASSET").setContent(this._assetType,(r=>{r.constructor.assetType==this._assetType&&this._handleItemInteraction(r.id)})),this._controller.pushPage("NEW_ASSET")},r._updateMaterialOffset(100),this.add(r)}_getItemName(r){let A=this._assets[r].name;return A.length>25&&(A="..."+A.substring(A.length-25)),A}_handleItemInteraction(r){this._controller.getPage(this._assetType).setAsset(this._assets[r]),this._controller.pushPage(this._assetType)}_refreshItems(){this._assets=il.getAssetsForType(this._assetType),this._items=[];for(let r in this._assets)this._assets[r].isPrivate||this._items.push(r)}_addSubscriptions(){Qt.subscribe(this._id,this._assetType+"_ADDED",(()=>{this._refreshItems(),this._updateItemsGUI()})),Qt.subscribe(this._id,this._assetType+"_UPDATED",(()=>{this._refreshItems(),this._updateItemsGUI()})),Qt.subscribe(this._id,this._assetType+"_DELETED",(()=>{this._refreshItems(),this._updateItemsGUI()})),Qt.subscribe(this._id,Rt.PROJECT_LOADING,(r=>{r&&(this._refreshItems(),this._updateItemsGUI())}))}_removeSubscriptions(){Qt.unsubscribe(this._id,this._assetType+"_ADDED"),Qt.unsubscribe(this._id,this._assetType+"_UPDATED"),Qt.unsubscribe(this._id,this._assetType+"_DELETED"),Qt.unsubscribe(this._id,Rt.PROJECT_LOADING)}_onAdded(){this._addSubscriptions(),super._onAdded()}_onRemoved(){this._removeSubscriptions(),super._onRemoved()}}class AssetSelectPage extends PaginatedButtonsPage{constructor(r){super(r,!0),this._assets={},this._items=Object.keys(this._assets),this._addPageContent(),this._createAddButton()}_addPageContent(){this._searchInput=createTextInput({borderRadius:.02,fontSize:Ja,height:.04,marginBottom:.004,marginTop:.01,width:.29}),this._searchInput.onBlur=()=>{Mt.keyboardLock=!1,this._searchUpdated()},this._searchInput.onChange=()=>this._searchUpdated(),this._searchInput.onEnter=()=>this._searchInput.blur(),this._searchInput.onFocus=()=>{Mt.keyboardLock=!0},this.add(this._searchInput),this._addList()}_createAddButton(){this._addButton=createSmallButton("+"),this._addButton.bypassContentPositioning=!0,this._addButton.position.fromArray([.175,.12,.001]),this._addButton.onClickAndTouch=()=>{this._addAction&&this._addAction()},this._addButton._updateMaterialOffset(100),this.add(this._addButton)}_searchUpdated(){this._refreshItems(),this._updateItemsGUI()}_getItemName(r){let A=this._assets[r].Name;return A.length>25&&(A="..."+A.substring(A.length-25)),A}_handleItemInteraction(r){this._action&&this._action(r)}_refreshItems(){this._items=this._getFilteredItems()}_getFilteredItems(){let r=[],A=this._searchInput.value.toLowerCase();for(let b in this._assets)this._assets[b].Name.toLowerCase().includes(A)&&r.push(b);return r}setContent(r,A,b,C){this._assets=r,this._action=A,this._addAction=b,this._backAction=C,this._addAction?this._addButton.parent||this.add(this._addButton):this._addButton.parent&&this.remove(this._addButton)}back(){this._action=null,this._searchInput.blur(),this._backAction&&this._backAction(),super.back()}}class PaginatedListPage extends PaginatedPage{constructor(r,A){super(r,A),this._paginatedListRows=[]}_addList(){this._createPreviousAndNextButtons(),this._optionsContainer=new Span({height:.215,justifyContent:"spaceEvenly",width:.45}),this._optionsBlock=new Div({height:.215});for(let r=0;r<5;r++){let A=new Span({height:.035,justifyContent:"spaceBetween",margin:.004,width:.3}),b=new TextComponent("",ro.bodyText,{height:.035,width:.21}),C=createSmallButton(Ya.pencilIcon,.7),I=createSmallButton("X");A.title=b,A.add(b),A.add(C),A.add(I),this._optionsBlock.add(A),this._paginatedListRows.push(A),C.onClickAndTouch=()=>{let A=5*this._page+r;this._items.length>A?this._handleEditItemInteraction(this._items[A]):console.error("PaginatedListPage displaying non existant option")},I.onClickAndTouch=()=>{let A=5*this._page+r;this._items.length>A?this._handleDeleteItemInteraction(this._items[A]):console.error("PaginatedListPage displaying non existant option")}}this._optionsContainer.add(this._previousButtonParent),this._optionsContainer.add(this._optionsBlock),this._optionsContainer.add(this._nextButtonParent),this.add(this._optionsContainer)}_updateItemsGUI(){let r=5*this._page;for(let A=0;A<5;A++){let b=this._paginatedListRows[A];if(r+A<this._items.length){let C=this._items[r+A];b.title.text=this._getItemName(C),b.parentComponent||this._optionsBlock.add(b)}else b.parentComponent&&b.parentComponent.remove(b)}this._updatePreviousAndNextButtons(r+5)}_getItemName(){return console.error("PaginatedListPage._getItemName() should be overridden"),""}_handleEditItemInteraction(){console.error("PaginatedListPage._handleEditItemInteraction() should be overridden")}_handleDeleteItemInteraction(){console.error("PaginatedListPage._handleDeleteItemInteraction() should be overridden")}_refreshItems(){console.error("PaginatedListPage._refreshItems() should be overridden")}_onAdded(){super._onAdded(),this._refreshItems(),this._updateItemsGUI()}}class AssetSetPage extends PaginatedListPage{constructor(r){super(r,!0),this._asset,this._items=[],this._addPageContent(),this._createAddButton()}_addPageContent(){this._titleBlock=new TextComponent("",ro.title),this.add(this._titleBlock),this._addList()}_createAddButton(){let r=createSmallButton("+");r.bypassContentPositioning=!0,r.position.fromArray([.175,.12,.001]),r.onClickAndTouch=()=>{let r={},A=!1;if(this._options)for(let b of this._options){let C=il.getAsset(b);C&&(A=!0,r[b]={Name:C.name})}if(A){this._controller.getPage(Vh.ASSET_SELECT).setContent(r,(r=>{this._onAdd&&this._onAdd(r),this._controller.back()}),(()=>{this._selectNewAsset()})),this._controller.pushPage(Vh.ASSET_SELECT)}else this._selectNewAsset()},r._updateMaterialOffset(100),this.add(r)}_selectNewAsset(){if(!this._newOptions)return;let r=this._controller.getCurrentPage();this._controller.getPage(Vh.NEW_ASSET).setContent(null,(A=>{if(this._onAdd&&this._onAdd(A.id),r!=this._controller.getCurrentPage())return;let b=A.constructor.assetType,C=this._controller.getPage(b);C&&(C.setAsset(A),this._controller.pushPage(b))}),this._newOptions),this._controller.pushPage(Vh.NEW_ASSET)}_getItemName(r){let A=r.name;return A.length>25&&(A="..."+A.substring(A.length-25)),A}_handleEditItemInteraction(r){let A=r.constructor.assetType;this._controller.getPage(A).setAsset(r),this._controller.pushPage(A)}_handleDeleteItemInteraction(r){this._onRemove&&this._onRemove(r.id)}_refreshItems(){this._items=this._getAssets(this._getAssetSet())}setContent(r,A,b,C,I,x){this._titleBlock.text=r,this._getAssetSet=A?()=>Array.from(A()):()=>[],this._options=b,this._newOptions=C,this._onAdd=I,this._onRemove=x,this._items=this._getAssets(this._getAssetSet()),this._page=0}_getAssets(r){let A=[];for(let b of r){let r=il.getAsset(b);r&&A.push(r)}return A}_addSubscriptions(){Qt.subscribe(this._id,Rt.PROJECT_LOADING,(r=>{r&&this._controller.setPage(Vh.NAVIGATION)}))}_removeSubscriptions(){Qt.unsubscribe(this._id,Rt.PROJECT_LOADING)}_onAdded(){this._addSubscriptions(),super._onAdded()}_onRemoved(){this._removeSubscriptions(),super._onRemoved()}}const Fc={};class ColorWheelPage extends MenuPage{constructor(r){super(r,!0),this._addPageContent()}_addPageContent(){let r=new TextComponent("Color Picker",ro.title);this.add(r);let A=new Span({height:.2,justifyContent:"spaceBetween",width:.1*3});this._hslColor=new HSLColor(.1),configureOrbitDisabling(this._hslColor.hueSaturationWheel),configureOrbitDisabling(this._hslColor.lightnessBar),A.add(this._hslColor.hueSaturationWheel),A.add(this._hslColor.lightnessBar),this.add(A),this._hslColor.onBlur=()=>{this._onEnter&&this._onEnter()},this._hslColor.onChange=r=>{this._onUpdate&&this._onUpdate(r)}}setContent(A,b,C,I){this._hslColor.setFromHSL(b.getHSL(Fc,r.SRGBColorSpace)),this._requesterId=A,this._onUpdate=C,this._onEnter=I}updateColor(A,b){this.parent&&this._requesterId==A&&this._hslColor.setFromHSL(b.getHSL(Fc,r.SRGBColorSpace))}isDragging(){return this._hslColor.isDragging()}back(){this._onUpdate=null,super.back()}}class EditAcknowledgementsPage extends MenuPage{constructor(r){super(r,!0),this._page=0,this._acknowledgements=[],this._addPageContent()}_addPageContent(){this._createPreviousAndNextButtons(),this._noAcknowledgements=new Div({height:.035,width:.3}),this._addFirstAcknowledgement=createWideButton("Add Acknowledgement"),this._addFirstAcknowledgement.onClickAndTouch=()=>this._addAcknowledgement(),this._noAcknowledgements.add(this._addFirstAcknowledgement),this._acknowledgementsContainer=new Span({height:.3,justifyContent:"spaceEvenly",width:.45});let r=new Div({height:.3,justifyContent:"center",width:.31});this._fields=[];for(let A of["Asset","Author","License","Source URL"]){let b=new nd({title:A,singleLine:!0,onBlur:(r,b)=>{this._acknowledgements[this._page][A]=b},getFromSource:()=>this._acknowledgements[this._page][A]||""});r.add(b),this._fields.push(b)}this._createAddAndDeleteButtons(r),this.add(this._acknowledgementsContainer),this._acknowledgementsContainer.add(this._previousButtonParent),this._acknowledgementsContainer.add(r),this._acknowledgementsContainer.add(this._nextButtonParent)}_createPreviousAndNextButtons(){this._previousButtonParent=new Div,this._previousButton=createSmallButton("<"),this._previousButton.onClickAndTouch=()=>{this._page+=this._acknowledgements.length-1,this._page%=this._acknowledgements.length,this._setAsset()},this._previousButtonParent.add(this._previousButton),this._nextButtonParent=new Div,this._nextButton=createSmallButton(">"),this._nextButton.onClickAndTouch=()=>{this._page+=1,this._page%=this._acknowledgements.length,this._setAsset()},this._nextButtonParent.add(this._nextButton)}_createAddAndDeleteButtons(r){let A=new Span({height:.035,justifyContent:"spaceBetween",width:.088}),b=createSmallButton("+"),C=createSmallButton(Ya.trashIcon,.7);A.add(b),A.add(C),r.add(A),b.onClickAndTouch=()=>this._addAcknowledgement(),C.onClickAndTouch=()=>this._deleteAcknowledgement()}_addAcknowledgement(){this._acknowledgements.push({Asset:"",Author:"",License:"","Source URL":""}),this._page=this._acknowledgements.length-1,this._refreshAssets()}_deleteAcknowledgement(){this._acknowledgements.splice(this._page,1),this._page=Math.min(this._page,this._acknowledgements.length),this._refreshAssets()}_refreshAssets(){if(this._acknowledgements=Wo.getAcknowledgements(),!(this._acknowledgements.length>0))return this.remove(this._acknowledgementsContainer),void this.add(this._noAcknowledgements);this._page>=this._acknowledgements.length&&(this._page=0),this._acknowledgements.length>1?(this._previousButtonParent.add(this._previousButton),this._nextButtonParent.add(this._nextButton)):(this._previousButtonParent.remove(this._previousButton),this._nextButtonParent.remove(this._nextButton)),this.add(this._acknowledgementsContainer),this.remove(this._noAcknowledgements),this._setAsset()}_setAsset(){for(let r of this._fields)r.updateFromSource()}_onAdded(){this._refreshAssets(),super._onAdded()}}class EditorSettingsPage extends DynamicFieldsPage{constructor(r){super(r,!0),this._createFields()}_createTitleBlock(){this._titleBlock=new TextComponent("Editor Settings",ro.title),this.add(this._titleBlock)}_createFields(){let r=[];r.push(new id({title:"Movement Speed",minValue:0,maxValue:1e3,initialValue:4,onBlur:(r,A)=>{Wo.setEditorSetting("Movement Speed",A)},getFromSource:()=>Wo.getEditorSettings()["Movement Speed"]})),r.push(new id({title:"User Scale",minValue:.001,maxValue:1e3,initialValue:1,onBlur:(r,A)=>{Mt.userController.scale=[A,A,A],Wo.setEditorSetting("User Scale",A)},getFromSource:()=>Wo.getEditorSettings()["User Scale"]})),r.push(new Xh({title:"Enable Flying",initialValue:!0,onUpdate:r=>{Wo.setEditorSetting("Enable Flying",r)},getFromSource:()=>Wo.getEditorSettings()["Enable Flying"]})),"XR"==Mt.deviceType&&r.push(new Xh({title:"Swap Joysticks",initialValue:!1,onUpdate:r=>{Wo.setEditorSetting("Swap Joysticks",r)},getFromSource:()=>Wo.getEditorSettings()["Swap Joysticks"]})),this._setFields(r)}_onAdded(){for(let r of this._fields)r.updateFromSource();super._onAdded()}}const Lc=[{title:"Edit",type:ah},{title:"Copy / Paste",type:nh},{title:"Delete",type:rh},{title:"Place",type:oh},{title:"Translate",type:dh},{title:"Rotate",type:lh},{title:"Scale",type:hh}];class HandsPage extends PaginatedButtonsPage{constructor(r){super(r,!0),this._items=Lc,this._addPageContent()}_addPageContent(){let r=new TextComponent("Hand Tools",ro.title);this.add(r),this._addList()}_getItemName(r){return r.title}_handleItemInteraction(r){sn.getTool()!=r.type&&sn.setTool(r.type)}_refreshItems(){}}class HostPartyPage extends MenuPage{constructor(r){super(r,!0),this._addPageContent()}_addPageContent(){let r=new TextComponent("Host Party",ro.title);this.add(r),this._contentBlock=new Div,this._textInput=createTextInput({borderRadius:.02,fontSize:Ja,height:.04,marginBottom:.008,marginTop:.01,width:.4}),this._textInput.onBlur=()=>{Mt.keyboardLock=!1},this._textInput.onEnter=()=>{this._textInput.blur(),this._hostParty()},this._textInput.onFocus=()=>{Mt.keyboardLock=!0};let A=createWideButton("Host");A.width=.2,A.onClickAndTouch=()=>this._hostParty(),this._contentBlock.add(this._textInput),this._contentBlock.add(A),this.add(this._contentBlock),this._connectingBlock=new Div({height:.1,justifyContent:"center",width:.4});let b=new TextComponent("Connecting...",ro.bodyText);this._connectingBlock.add(b)}_hostParty(){let r=this._textInput.value;0!=r.length?(this.remove(this._contentBlock),this.add(this._connectingBlock),this._isConnecting=!0,Bl.host(r,(()=>{this._successCallback()}),(r=>{this._errorCallback(r)}))):Qt.publish(this._id,Rt.MENU_NOTIFICATION,{text:"Missing Party Name"})}_successCallback(){this._isConnecting&&(this._isConnecting=!1,this.remove(this._connectingBlock),this.add(this._contentBlock),this._controller.getCurrentPage()==this&&this._controller.back(),Qt.publish(this._id,Rt.MENU_NOTIFICATION,{text:"Party Started"}))}_errorCallback(r){this._isConnecting=!1;let A=r.topic;"409-room"==A?Qt.publish(this._id,Rt.MENU_NOTIFICATION,{text:"Party Name Already Taken"}):"rtc-timeout"==A?Qt.publish(this._id,Rt.MENU_NOTIFICATION,{text:"Could not connect to all other users, please try again"}):"bad-auth"==A?Qt.publish(this._id,Rt.MENU_NOTIFICATION,{text:"Could not authenticate with Server"}):("error"==A||console.error("Unexpected error message topic: "+A),Qt.publish(this._id,Rt.MENU_NOTIFICATION,{text:"Unexpected Error"})),this.remove(this._connectingBlock),this.add(this._contentBlock)}_onAdded(){this._isConnecting&&!Bl.isPartyActive()&&(this.remove(this._connectingBlock),this.add(this._contentBlock)),super._onAdded()}}class JoinPartyPage extends MenuPage{constructor(r){super(r,!0),this._addPageContent()}_addPageContent(){let r=new TextComponent("Join Party",ro.title);this.add(r),this._contentBlock=new Div,this._textInput=createTextInput({borderRadius:.02,fontSize:Ja,height:.04,marginBottom:.008,marginTop:.01,width:.4}),this._textInput.onBlur=()=>{Mt.keyboardLock=!1},this._textInput.onEnter=()=>{this._textInput.blur(),this._joinParty()},this._textInput.onFocus=()=>{Mt.keyboardLock=!0};let A=createWideButton("Join");A.width=.2,A.onClickAndTouch=()=>this._joinParty(),this._contentBlock.add(this._textInput),this._contentBlock.add(A),this.add(this._contentBlock),this._connectingBlock=new Div({height:.1,justifyContent:"center",width:.4});let b=new TextComponent("Connecting...",ro.bodyText);this._connectingBlock.add(b)}_joinParty(){let r=this._textInput.value;0!=r.length?(this.remove(this._contentBlock),this.add(this._connectingBlock),this._isConnecting=!0,Bl.join(r,(()=>{this._successCallback()}),(r=>{this._errorCallback(r)}))):Qt.publish(this._id,Rt.MENU_NOTIFICATION,{text:"Missing Party Name"})}_successCallback(){this._isConnecting&&(this._isConnecting=!1,this.remove(this._connectingBlock),this.add(this._contentBlock),this._controller.getCurrentPage()==this&&this._controller.back(),Qt.publish(this._id,Rt.MENU_NOTIFICATION,{text:"Party Joined"}))}_errorCallback(r){this._isConnecting=!1;let A=r.topic;"404-room"==A?Qt.publish(this._id,Rt.MENU_NOTIFICATION,{text:"Party Name Not Found"}):"rtc-timeout"==A?Qt.publish(this._id,Rt.MENU_NOTIFICATION,{text:"Could not connect to all other users in time, please try again"}):"could-not-connect"==A?Qt.publish(this._id,Rt.MENU_NOTIFICATION,{text:"Could not connect to all other users, please try again"}):"bad-auth"==A?Qt.publish(this._id,Rt.MENU_NOTIFICATION,{text:"Could not authenticate with Server"}):("error"==A||console.error("Unexpected error message topic: "+A),Qt.publish(this._id,Rt.MENU_NOTIFICATION,{text:"Unexpected Error"})),this.remove(this._connectingBlock),this.add(this._contentBlock)}_onAdded(){this._isConnecting&&!Bl.isPartyActive()&&(this.remove(this._connectingBlock),this.add(this._contentBlock)),super._onAdded()}}const Oc=["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"];let Uc=new class GoogleDrive{init(){this._files,this._fileId,this._folderId,this._gapiInitialized=!1,this._gisInitialized=!1,window.gapi&&gapi.load("client",(()=>{this._initClient()}))}_initClient(){this._tokenClient=google.accounts.oauth2.initTokenClient({client_id:"791471431939-q3fifjtaq8mhlhce0l5h96k38m8fchn2.apps.googleusercontent.com",scope:"https://www.googleapis.com/auth/drive.file",callback:r=>{this._accessToken=r.access_token,this._gisInitialized=!0,this._initialize(),this._authCallback&&this._authCallback(),this._authCallback=null}}),gapi.client.init({apiKey:"AIzaSyBdadP7BFyNpPCRAlCfV-ikXklXkdJ188s",discoveryDocs:Oc}).then((()=>{this._gapiInitialized=!0,this._initialize()}),(function(r){"idpiframe_initialization_failed"==r.error&&r.details.includes("Cookies")&&console.log("TODO: Let user know cookies must be enabled for Google Drive to work"),console.error(JSON.stringify(r,null,2))}))}_initialize(){this._gisInitialized&&this._gapiInitialized&&!this._folderId&&(this._fetchFolder(),this.fetchFiles())}handleAuthButton(r){this._authCallback=r,this._tokenClient.requestAccessToken()}handleSignoutButton(r){gapi.client.setToken(),this._gisInitialized=!1,this._folderId=null,r&&r()}_fetchFolder(){gapi.client.drive.files.list({q:"mimeType = 'application/vnd.google-apps.folder'",spaces:"drive"}).execute((r=>{0==r.files.length?this._createFolder():this._folderId=r.files[0].id}))}_createFolder(){gapi.client.drive.files.create({resource:{name:"Digital Bacon",mimeType:"application/vnd.google-apps.folder"}}).then((r=>{200!=r.status?console.log("TODO: Let user know there was a problem"):this._folderId=r.result.id}))}isSignedIn(){return null!=window.gapi?.client?.getToken()}hasActiveFile(){return null!=this._fileId}clearActiveFile(){this._fileId=null}getCurrentFileName(){for(let r of this._files)if(r.id==this._fileId)return r.name;return""}fetchFiles(r){return gapi.client.drive.files.list({q:"mimeType='application/zip'"}).execute((A=>{this._files=A.files,r&&r(this._files)})),this._files}loadFile(r,A,b){gapi.client.drive.files.get({fileId:r,alt:"media"}).then((b=>{JSZip.loadAsync(b.body).then((b=>{this._fileId=r,A&&A(b)}))}),(function(r){console.error("Failed to get file: "+r),b&&b()}))}save(r,A,b){if(!this.isSignedIn())throw"Not signed into google drive";r.generateAsync({type:"blob"}).then((r=>{this._retried=!1,this._update(r,A,b)}))}saveAs(r,A,b,C){if(!this.isSignedIn())throw"Not signed into google drive";A.generateAsync({type:"blob"}).then((A=>{this._retried=!1,this._upload(r,A,b,C)}))}_upload(r,A,b,C){let I={name:r+".zip",mimeType:"application/zip",parents:[this._folderId]},x=JSON.stringify(I),S=this._accessToken;fetch("https://www.googleapis.com/upload/drive/v3/files?uploadType=resumable&supportsAllDrives=true",{method:"POST",headers:new Headers({Authorization:"Bearer "+S,"Content-Type":"application/json; charset=UTF-8","Content-Length":x.length}),body:x}).then((I=>{if(401==I.status)this._retried=!0,this.handleAuthButton((()=>{this._upload(r,A,b,C)}));else if(200!=I.status)console.error(I),C();else{let r=I.headers.get("location");this._resumableUpload(r,A,b,C,!1)}}))}_update(r,A,b){let C=this._accessToken;fetch("https://www.googleapis.com/upload/drive/v3/files/{fileId}?uploadType=resumable".replace("{fileId}",this._fileId),{method:"PUT",headers:new Headers({Authorization:"Bearer "+C,"X-HTTP-Method-Override":"PATCH"})}).then((C=>{if(401==C.status)this._retried=!0,this.handleAuthButton((()=>{this._update(r,A,b)}));else if(200!=C.status)console.error(C),b();else{let I=C.headers.get("location");this._resumableUpload(I,r,A,b,!0)}}))}_resumableUpload(r,A,b,C,I){let x={Authorization:"Bearer "+this._accessToken};I&&(x["X-HTTP-Method-Override"]="PATCH"),fetch(r,{method:"PUT",headers:new Headers(x),body:A}).then((r=>{200==r.status?(b(),r.json().then((r=>{this._fileId=r.id}))):(console.error("Error during _resumableUpload"),console.error(r),C())}))}};class LoadFromGDrivePage extends PaginatedButtonsPage{constructor(r){super(r,!0),this._instances={},this._items=Object.keys(this._instances),this._addPageContent(),this._filesLoaded=!1,this._isLoadingSaving=!1,this._addSubscriptions()}_addPageContent(){let r=new TextComponent("Load From Google Drive",ro.title);this.add(r),this._loadingSavingBlock=new TextComponent("Loading...",ro.bodyText,{height:.2}),this.add(this._loadingSavingBlock),this._addList()}_getItemName(r){return this._instances[r].name}_handleItemInteraction(r){this._loadingSavingBlock.text="Project Loading...",this._updateLoadingSaving(!1),Uc.loadFile(this._instances[r].id,(r=>{this._loadSuccessCallback(r)}),(()=>{this._loadErrorCallback()}))}_loadSuccessCallback(r){il.loadZip(r,(()=>{Qt.publish(this._id,Rt.MENU_NOTIFICATION,{text:"Project Loaded"}),Bl.isPartyActive()&&Bl.isHost()&&Bl.sendProject()}),(()=>{this._loadErrorCallback()}))}_loadErrorCallback(){this._updateLoadingSaving(!0),Qt.publish(this._id,Rt.MENU_NOTIFICATION,{text:"Error Loading Project",sustainTime:5})}_refreshItems(){this._items=Object.keys(this._instances)}loadProjects(){let r=Uc.fetchFiles((r=>{this._filesLoaded||(this._filesLoaded=!0,this._isLoadingSaving||(this.remove(this._loadingSavingBlock),this.add(this._optionsContainer))),this._instances=r,this._refreshItems(),this._updateItemsGUI()}));r&&(this._instances=r,this._filesLoaded||(this._filesLoaded=!0,this._isLoadingSaving||(this.remove(this._loadingSavingBlock),this.add(this._optionsContainer))))}_addSubscriptions(){Qt.subscribe(this._id,Rt.PROJECT_LOADING,(r=>{this._loadingSavingBlock.text="Project Loading...",this._updateLoadingSaving(r)})),Qt.subscribe(this._id,Rt.PROJECT_SAVING,(r=>{this._loadingSavingBlock.text="Project Saving...",this._updateLoadingSaving(r)}))}_updateLoadingSaving(r){if(this._isLoadingSaving=!r,r){if(!this._filesLoaded)return void(this._loadingSavingBlock.text="Loading...");this.remove(this._loadingSavingBlock),this.add(this._optionsContainer)}else this.remove(this._optionsContainer),this.add(this._loadingSavingBlock)}}class PaginatedIconsPage extends PaginatedPage{constructor(r,A){super(r,A),this._paginatedListButtons=[]}_addList(){this._createPreviousAndNextButtons(),this._optionsContainer=new Span({height:.2,justifyContent:"spaceEvenly",width:.45}),this._optionsBlock=new Div({height:.178,justifyContent:"spaceBetween"});let r={height:.085,width:.316,justifyContent:"spaceBetween"};this._rows=[],this._rows.push(new Span(r)),this._rows.push(new Span(r));for(let r=0;r<2;r++){let A=this._rows[r];for(let b=0;b<3;b++){let C=new Div({backgroundVisible:!0,borderRadius:.01,height:.085,justifyContent:"spaceEvenly",materialColor:qa.defaultIdle,width:.1});C.pointerInteractable=new OrbitDisablingPointerInteractable(C),addHoveredButtonCallback(C);let I=new ia(null,{height:.04,width:.04}),x=new TextComponent(" ",{color:qa.white,fontSize:this._labelSizeOverride||Ja});C.add(I),C.add(x),A.add(C),this._paginatedListButtons.push(C),C.onClickAndTouch=()=>{let A=2*this._page*3+3*r+b;this._items.length>A?this._handleItemInteraction(this._items[A]):console.error("PaginatedIconsPage displaying non existant option")},C.imageComponent=I,C.textComponent=x}}this._optionsBlock.add(this._rows[0]),this._optionsBlock.add(this._rows[1]),this._optionsContainer.add(this._previousButtonParent),this._optionsContainer.add(this._optionsBlock),this._optionsContainer.add(this._nextButtonParent),this.add(this._optionsContainer)}_updateItemsGUI(){let r=2*this._page*3;for(let A=0;A<6;A++){let b=this._paginatedListButtons[A];if(r+A<this._items.length){let C=this._items[r+A];b.textComponent.text=this._getItemName(C),b.imageComponent.updateTexture(this._getItemIcon(C)),b.parentComponent||this._rows[Math.floor(A/3)].add(b)}else b.parentComponent&&b.parentComponent.remove(b)}this._updatePreviousAndNextButtons(r+6)}_getItemName(){return console.error("PaginatedIconsPage._getItemName() should be overridden"),""}_getItemIcon(){return console.error("PaginatedIconsPage._getItemIcon() should be overridden"),""}_handleItemInteraction(){console.error("PaginatedIconsPage._handleItemInteraction() should be overridden")}_refreshItems(){console.error("PaginatedIconsPage._refreshItems() should be overridden")}_onAdded(){super._onAdded(),this._refreshItems(),this._updateItemsGUI()}}const Nc=[{text:"Models",icon:Ya.objectIcon,assetType:kt.MODEL},{text:"Images",icon:Ya.imageIcon,assetType:kt.IMAGE},{text:"Shapes",icon:Ya.shapesIcon,assetType:kt.SHAPE},{text:"Lights",icon:Ya.lightbulbIcon,assetType:kt.LIGHT},{text:"Materials",icon:Ya.materialIcon,assetType:kt.MATERIAL},{text:"Textures",icon:Ya.textureIcon,assetType:kt.TEXTURE},{text:"Text",icon:Ya.textIcon,assetType:kt.TEXT},{text:"Audio",icon:Ya.audioIcon,assetType:kt.AUDIO},{text:"Video",icon:Ya.videoIcon,assetType:kt.VIDEO},{text:"Components",icon:Ya.componentIcon,assetType:kt.COMPONENT},{text:"Systems",icon:Ya.systemIcon,assetType:kt.SYSTEM},{text:"Other Assets",icon:Ya.ellipsisIcon,assetType:kt.CUSTOM_ASSET}];class LibraryPage extends PaginatedIconsPage{constructor(r){super(r,!0),this._items=Object.keys(Nc),this._labelSizeOverride=.015,this._addPageContent(),this._createSearchButton()}_addPageContent(){let r=new TextComponent("Assets",ro.title);this.add(r),this._addList()}_createSearchButton(){let r=createSmallButton(Ya.searchIcon,.8);r.bypassContentPositioning=!0,r.position.fromArray([-.175,.12,.001]),r.onClickAndTouch=()=>{this._controller.pushPage(Vh.LIBRARY_SEARCH)},r._updateMaterialOffset(100),this.add(r)}_getItemName(r){return Nc[r].text}_getItemIcon(r){return Nc[r].icon}_handleItemInteraction(r){this._controller.pushPage(Nc[r].assetType+"S")}_refreshItems(){}}class LibrarySearchPage extends PaginatedButtonsPage{constructor(r){super(r,!0),this._assets=il.getAssets(),this._items=Object.keys(this._assets),this._addPageContent()}_addPageContent(){this._searchInput=createTextInput({borderRadius:.02,fontSize:Ja,height:.04,marginBottom:.004,marginTop:.01,width:.375}),this._searchInput.onBlur=()=>{Mt.keyboardLock=!1,this._searchUpdated()},this._searchInput.onChange=()=>this._searchUpdated(),this._searchInput.onEnter=()=>this._searchInput.blur(),this._searchInput.onFocus=()=>{Mt.keyboardLock=!0},this.add(this._searchInput),this._addList()}_searchUpdated(){this._refreshItems(),this._updateItemsGUI()}_getItemName(r){let A=this._assets[r].name;return A.length>25&&(A="..."+A.substring(A.length-25)),A}_handleItemInteraction(r){let A=this._assets[r],b=Qo.getType(A.assetId);this._controller.getPage(b).setAsset(A),this._controller.pushPage(b)}_refreshItems(){this._assets=il.getAssets(),this._items=this._getFilteredItems()}_getFilteredItems(){let r=[],A=this._searchInput.value.toLowerCase();for(let b in this._assets){let C=this._assets[b];if(!(C instanceof InternalAssetEntity))if(C.name.toLowerCase().includes(A))r.push(b);else{let I=C.assetId;Qo.getAssetName(I).toLowerCase().includes(A)&&r.push(b)}}return r}back(){this._searchInput.blur(),super.back()}}class ListComponentsPage extends PaginatedListPage{constructor(r){super(r,!0),this._asset,this._items=[],this._addPageContent(),this._createAddButton()}_addPageContent(){let r=new TextComponent("Components",ro.title);this.add(r),this._addList()}_createAddButton(){let r=createSmallButton("+");r.bypassContentPositioning=!0,r.position.fromArray([.175,.12,.001]),r.onClickAndTouch=()=>{let r=this._asset._components,A=rl.getAssets(),b={};for(let C in A){let I=A[C];!r.has(I)&&I.supports(this._asset)&&(b[C]={Name:I.name})}this._controller.getPage(Vh.ASSET_SELECT).setContent(b,(r=>{this._addComponent(r)}),(()=>{this._selectNewComponent()})),this._controller.pushPage(Vh.ASSET_SELECT)},r._updateMaterialOffset(100),this.add(r)}_addComponent(r){this._asset.editorHelper.addComponent(r),this._controller.back()}_selectNewComponent(){let r=this._controller.getCurrentPage();this._controller.getPage(Vh.NEW_ASSET).setContent(kt.COMPONENT,(A=>{if(!A.supports(this._asset))return void Qt.publish(this._id,Rt.MENU_NOTIFICATION,{text:"Component is not supported for this type of asset"});if(this._asset.editorHelper.addComponent(A.id),r!=this._controller.getCurrentPage())return;this._controller.back(),this._controller.getPage(Vh.COMPONENT).setAsset(A),this._controller.pushPage(Vh.COMPONENT)})),this._controller.pushPage(Vh.NEW_ASSET)}_getItemName(r){let A=r.name;return A.length>25&&(A="..."+A.substring(A.length-25)),A}_handleEditItemInteraction(r){this._controller.getPage(Vh.COMPONENT).setAsset(r),this._controller.pushPage(Vh.COMPONENT)}_handleDeleteItemInteraction(r){this._asset.editorHelper.removeComponent(r.id)}_refreshItems(){this._items=Array.from(this._asset._components)}setContent(r){this._asset=r,this._items=Array.from(r._components),this._page=0}_addSubscriptions(){Qt.subscribe(this._id,Rt.COMPONENT_ATTACHED,(r=>{r.id==this._asset.id&&(this._refreshItems(),this._updateItemsGUI())})),Qt.subscribe(this._id,Rt.COMPONENT_DETACHED,(r=>{r.id==this._asset.id&&(this._refreshItems(),this._updateItemsGUI())})),Qt.subscribe(this._id,Rt.COMPONENT_ADDED,(r=>{this._asset._components.has(r)&&(this._refreshItems(),this._updateItemsGUI())})),Qt.subscribe(this._id,Rt.COMPONENT_DELETED,(r=>{this._items.includes(r.asset)&&(this._refreshItems(),this._updateItemsGUI())})),Qt.subscribe(this._id,Rt.COMPONENT_UPDATED,(r=>{for(let A of r.fields)if("name"==A){this._refreshItems(),this._updateItemsGUI();break}})),Qt.subscribe(this._id,Rt.PROJECT_LOADING,(r=>{r&&this._controller.setPage(Vh.NAVIGATION)}))}_removeSubscriptions(){Qt.unsubscribe(this._id,Rt.COMPONENT_ATTACHED),Qt.unsubscribe(this._id,Rt.COMPONENT_DETACHED),Qt.unsubscribe(this._id,Rt.COMPONENT_ADDED),Qt.unsubscribe(this._id,Rt.COMPONENT_DELETED),Qt.unsubscribe(this._id,Rt.COMPONENT_UPDATED),Qt.unsubscribe(this._id,Rt.PROJECT_LOADING)}_onAdded(){this._addSubscriptions(),super._onAdded()}_onRemoved(){this._removeSubscriptions(),super._onRemoved()}}const Qc=[{title:"Hand Tools",menuPage:Vh.HANDS},{title:"Library",menuPage:Vh.LIBRARY},{title:"Settings",menuPage:Vh.SETTINGS},{title:"Project File",menuPage:Vh.PROJECT},{title:"Connect with Peers",menuPage:Vh.PARTY}];class NavigationPage extends MenuPage{constructor(r){super(r,!1),this._addPageContent()}_addPageContent(){let r=new TextComponent("Menu",ro.title);this.add(r);let A=new Div({height:.2,width:.45}),b=Mt.authUrl&&Mt.socketUrl;for(let r of Qc){if("XR"!=Mt.deviceType&&r.menuPage==Vh.HANDS)continue;if(r.menuPage==Vh.PARTY&&!b)continue;let C=createWideButton(r.title);C.margin=.004,A.add(C),C.onClickAndTouch=()=>this._controller.pushPage(r.menuPage)}this.add(A)}}const Hc="DigitalBacon:Sketchfab:authToken",Gc="DigitalBacon:Sketchfab:authExpiry",jc="https://digitalbacon.io";let Vc=new class Sketchfab{constructor(){this._authToken=localStorage.getItem(Hc),this._authExpiry=localStorage.getItem(Gc),this._listenForMessages()}_listenForMessages(){window.addEventListener("message",(r=>{r.origin==jc&&"sketchfab_auth_token"==r.data.topic&&(clearInterval(this._intervalId),this._tab.postMessage("close_tab",jc),this._authToken=r.data.authToken,this._authExpiry=r.data.authExpiry,this._staySignedIn&&(localStorage.setItem(Hc,this._authToken),localStorage.setItem(Gc,this._authExpiry)),this._callback&&this._callback())}))}isSignedIn(){return this._authToken&&this._authExpiry&&this._authExpiry>Date.now()}signIn(r,A){this._staySignedIn=r,this._callback=A,this._intervalId&&(clearInterval(this._intervalId),this._intervalId=null),this._tab=window.open("https://sketchfab.com/oauth2/authorize/?state=123456789&response_type=token&client_id=WXFMTux03Lde8DFpnZWlzwR4afwtSrpumZToMy62","_blank"),this._tab?(this._tab.focus(),this._intervalId=setInterval((()=>{this._tab.postMessage("fetch_auth_token",jc)}),1e3)):Qt.publish(this._id,Rt.MENU_NOTIFICATION,{text:"Please check your popup blocker settings"})}search(r,A,b){let C="https://api.sketchfab.com/v3/search?type=models&downloadable=true&archives_flavours=false&q="+encodeURIComponent(r);this.fetch(C,A,b)}fetch(r,A,b){fetch(r,{headers:{Authorization:"Bearer "+this._authToken}}).then((r=>r.json())).then((r=>{A&&A(r)})).catch((r=>{console.error(r),b&&b()}))}_download(r,A,b,C){fetch(r).then((r=>r.blob())).then((r=>{Qo.addNewAsset(r,A.name,kt.MODEL,(r=>{let C=A.user?.username?"Sketchfab User "+A.user.username:null;Wo.addAcknowledgement({Asset:A.name,Author:C,License:A.license?.label,"Source URL":A.viewerUrl,"Preview Image URL":A.previewUrl}),Qo.registerSketchfabAsset(r,A),b&&b(r)}))})).catch((r=>{console.error(r),C&&C()}))}download(r,A,b){this.fetch("https://api.sketchfab.com/v3/models/{uid}/download".replace("{uid}",r.uid),(C=>{C.glb?this._download(C.glb.url,r,A,b):b&&b()}),b)}};const zc=/^http[s]{0,1}:\/\//i,Wc={assetName:"Load from CDN",handler:"_loadFromCDN"},Xc={assetName:"Select from Device",handler:"_uploadFromDevice"},Yc={assetName:"Select from Sketchfab",handler:"_selectFromSketchfab"};class NewAssetPage extends PaginatedButtonsPage{constructor(r){super(r,!0),this._items=[],this._addPageContent()}_addPageContent(){let r=new TextComponent("Add New Asset",ro.title);this.add(r),this._addList()}_getItemName(r){return r.assetName}_handleItemInteraction(r){if(r.handler)return void this[r.handler]();let A;this._assetType in uh&&(A=this._getNewEntityParams(),A.assetId=r.assetId);let b=il.addNewAsset(r.assetId,A);this.back(),this._additionalAction&&this._additionalAction(b)}_loadFromCDN(){this._controller.getPage(Vh.TEXT_INPUT).setContent("Load from CDN","URL","Load",(r=>{if(!this._isUrlValid(r))return;this._controller.back();let A=this._controller.getPage(Vh.MESSAGE);A.setContent("Load from CDN","Loading..."),this._controller.pushPage(Vh.MESSAGE),Qo.loadExternalAsset(r,(r=>{this._handleExternalAsset(r)}),(()=>{Qt.publish(this._id,Rt.MENU_NOTIFICATION,{text:"Sorry, something went wrong while loading the file"}),this._controller.getCurrentPage()==A&&this._controller.back()}))})),this._controller.pushPage(Vh.TEXT_INPUT)}_isUrlValid(r){if(!zc.test(r))return Qt.publish(this._id,Rt.MENU_NOTIFICATION,{text:"URL must begin with https://"}),!1;let A=r.split(".").pop().toLowerCase();if(this._assetType==kt.MODEL){if(!(A in Ut))return Qt.publish(this._id,Rt.MENU_NOTIFICATION,{text:"File type not supported for Model"}),!1}else if(this._assetType==kt.IMAGE){if(!(A in Ot))return Qt.publish(this._id,Rt.MENU_NOTIFICATION,{text:"File type not supported for Image"}),!1}else if(this._assetType==kt.AUDIO){if(!(A in Lt))return Qt.publish(this._id,Rt.MENU_NOTIFICATION,{text:"File type not supported for Audio"}),!1}else if(this._assetType==kt.VIDEO){if(!(A in Nt))return Qt.publish(this._id,Rt.MENU_NOTIFICATION,{text:"File type not supported for Video"}),!1}else if("js"!=A)return Qt.publish(this._id,Rt.MENU_NOTIFICATION,{text:"File type not supported for script"}),!1;return!0}_handleExternalAsset(r){let A,b=Qo.getType(r);b in uh&&(A=this._getNewEntityParams(),A.assetId=r);let C=il.addNewAsset(r,A);this._controller.getPage(Vh.MESSAGE).parent&&this._controller.back(),b==this._assetType&&(this.parent&&this._controller.back(),this._additionalAction&&this._additionalAction(C))}_uploadFromDevice(){Ah.triggerAssetsUpload((r=>{this._uploadCallback(r)}),!0)}_uploadCallback(r){let A=[],b=this._getNewEntityParams();for(let C of r){b.assetId=C;let r=Qo.getType(C),I=r in uh?il.addNewAsset(C,b):il.addNewAsset(C);r==this._assetType&&A.push(I)}A.length>0&&this._additionalAction&&(this.back(),this._additionalAction(A[0]))}_getNewEntityParams(){this._controller.getPosition(ao[0]),this._controller.getDirection(ao[1]).normalize().divideScalar(4),ao[0].sub(ao[1]).roundWithPrecision(5);let r=ao[0].toArray();return ao[0].set(0,0,1),ao[1].setY(0).normalize(),ho.setFromUnitVectors(ao[0],ao[1]),lo.setFromQuaternion(ho).roundWithPrecision(5),{position:r,rotation:lo.toArray(),visualEdit:!0}}_selectFromSketchfab(){Vc.isSignedIn()?this._controller.pushPage(Vh.SKETCHFAB_SEARCH):this._controller.pushPage(Vh.SKETCHFAB_LOGIN)}_refreshItems(){if(this._customAssets){this._items=[];for(let r of this._customAssets)this._items.push({assetId:r,assetName:Qo.getAssetName(r)})}else if(this._assetType in Ft){if(this._items=il.getAssetClassesForType(this._assetType),this._assetType==kt.TEXTURE)return;this._items.unshift(Wc),this._items.unshift(Xc)}else{this._items=[],this._assetType==uh.MODEL&&this._items.push(Yc),this._items.push(Xc),this._items.push(Wc);for(let r in Qo.library){let A=Qo.library[r];A.Type==this._assetType&&this._items.push({assetId:r,assetName:A.Name})}}}setContent(r,A,b){this._assetType=r,this._additionalAction=A,this._customAssets=b}}const Kc=[{title:"Host Party",menuPage:Vh.HOST_PARTY},{title:"Join Party",menuPage:Vh.JOIN_PARTY}],qc=[{title:"Display Usernames",handler:"_handleDisplayUsernames"},{title:"Update Username",handler:"_handleUpdateUsername"},{title:"Mute Myself",handler:"_handleMuteMyself"},{title:"Mute Friends",handler:"_handleMuteFriends"},{title:"Disconnect",handler:"_handleDisconnect"},{title:"Users",type:"label"}];class PartyPage extends DynamicFieldsPage{constructor(r){super(r),this._connected=!1,this._displayingUsernames=!1,this._mutedMyself=!1,this._mutedPeers=!1,this._fieldsContainer.justifyContent="start",this._peerFields={},this._addFields()}_addFields(){this._connectedFields=[],this._disconnectedFields=[];for(let r of Kc){let A=new ButtonEntity(r.title,(()=>{this._controller.pushPage(r.menuPage)}));this._disconnectedFields.push(A)}for(let r of qc){let A;r.handler?A=new ButtonEntity(r.title,(()=>{this[r.handler]()})):"label"==r.type&&(A=new TextEntity(r.title)),this._connectedFields.push(A)}this._setFields(this._disconnectedFields)}_handleDisplayUsernames(){this._displayingUsernames=!this._displayingUsernames;let r=this._connectedFields[0];this._displayingUsernames?r.textComponent.text="Hide Usernames":r.textComponent.text="Display Usernames",Bl.setDisplayingUsernames(this._displayingUsernames)}_handleUpdateUsername(){let r=this._controller.getPage(Vh.TEXT_INPUT),A=Mt.userController.username;r.setContentWithInitialValue("Update Username",A,"Update",(r=>{(r=r.trim())?(Mt.userController.username=r,this._controller.back()):Qt.publish(this._id,Rt.MENU_NOTIFICATION,{text:"Username can't be blank"})})),this._controller.pushPage(Vh.TEXT_INPUT)}_handleDisconnect(){bl.disconnect(),this._updateFields()}_handleMuteMyself(){this._mutedMyself=!this._mutedMyself;let r=this._connectedFields[2];this._mutedMyself?r.textComponent.text="Unmute Myself":r.textComponent.text="Mute Myself";for(let r in this._peerFields)this._peerFields[r].toggleMyselfMuted(this._mutedMyself)}_handleMuteFriends(){this._mutedPeers=!this._mutedPeers;let r=this._connectedFields[3];this._mutedPeers?r.textComponent.text="Unmute Friends":r.textComponent.text="Mute Friends";for(let r in this._peerFields)this._peerFields[r].togglePeerMuted(this._mutedPeers)}_updateFields(){if(Bl.isPartyActive()){if(!this._checkPeers()&&this._connected)return;this._setFields(this._connectedFields.concat(Object.values(this._peerFields))),this._connected=!0}else{for(let r in this._peerFields)delete this._peerFields[r];this._setFields(this._disconnectedFields),this._connected=!1}}_checkPeers(){let r=!1,A=Bl.getPeers();for(let b in A)if(!(b in this._peerFields)&&A[b].rtc){let C=A[b];this._peerFields[b]=new PeerEntity(C,C.username,this._controller,(r=>this._abdicateHost(r))),this._mutedMyself&&this._peerFields[b].toggleMyselfMuted(!0),this._mutedPeers&&this._peerFields[b].togglePeerMuted(!0),r=!0}for(let b in this._peerFields)b in A?this._peerFields[b].setUsername(A[b].username):(this._fieldsContainer.remove(this._peerFields[b]),delete this._peerFields[b],r=!0);return r}_abdicateHost(){for(let r in this._peerFields)this._peerFields[r].toggleHost(!1)}_handlePeerConnected(r){if(!this._connected)return;let A=r.peer,b=new PeerEntity(A,A.username,this._controller,(r=>this._abdicateHost(r)));this._mutedMyself&&b.toggleMyselfMuted(!0),this._mutedPeers&&b.togglePeerMuted(!0),this._peerFields[A.id]=b,this._fields.push(b),this._fields.length==this._lastItemIndex+2&&(this._removeCurrentFields(),this._lastItemIndex=this._firstItemIndex-1,this._loadNextPage())}_addSubscriptions(){Qt.subscribe(this._id,Rt.BECOME_PARTY_HOST,(()=>{for(let r in this._peerFields)this._peerFields[r].toggleHost(!0)})),Qt.subscribe(this._id,Rt.PARTY_STARTED,(()=>{this._connected||this._updateFields()})),Qt.subscribe(this._id,Rt.PARTY_ENDED,(()=>{this._connected&&this._updateFields()})),Qt.subscribe(this._id,Rt.PEER_CONNECTED,(r=>{this._handlePeerConnected(r)})),Qt.subscribe(this._id,Rt.PEER_DISCONNECTED,(r=>{if(!this._connected)return;let A=r.peer,b=this._peerFields[A.id];b&&(this._removeField(b),delete this._peerFields[A.id])})),Qt.subscribe(this._id,Rt.PEER_USERNAME_UPDATED,(r=>{if(!this._connected)return;let A=r.peer;this._peerFields[A.id].setUsername(A.username)}))}_removeSubscriptions(){Qt.unsubscribe(this._id,Rt.PARTY_STARTED),Qt.unsubscribe(this._id,Rt.PARTY_ENDED),Qt.unsubscribe(this._id,Rt.PEER_CONNECTED),Qt.unsubscribe(this._id,Rt.PEER_DISCONNECTED),Qt.unsubscribe(this._id,Rt.PEER_USERNAME_UPDATED)}_onAdded(){this._updateFields(),this._addSubscriptions(),super._onAdded()}_onRemoved(){this._removeSubscriptions(),super._onRemoved()}}class ButtonEntity extends MenuField{constructor(r,A){super(),this.minHeight=0,this.height=.043;let b=createWideButton(r);b.onClickAndTouch=A,this.add(b),this.textComponent=b.textComponent}}class TextEntity extends MenuField{constructor(r){super(),this.minHeight=0,this.height=.043,this.add(new TextComponent(r,ro.bodyText,{height:.035,width:.3}))}}class PeerEntity extends MenuField{constructor(r,A,b,C){super(),this.minHeight=0,this.height=.043,this._peer=r,this._controller=b,this._designateHostCallback=C,this._mutedMyself=!1,this._mutedPeer=!1,this._addContent(A)}_addContent(r){r=stringWithMaxLength(r||"...",12),this._usernameBlock=createWideButton(r||"..."),this._usernameBlock.width=.228,this._muteMyselfButton=createSmallButton(Ya.microphoneIcon,.75),this._muteMyselfButton.height=.035,this._muteMyselfButton.width=.035,this._mutePeerButton=createSmallButton(Ya.headphonesIcon,.75),this._mutePeerButton.height=.035,this._mutePeerButton.width=.035,this._muteMyselfButton.material.color.set(qa.green),this._mutePeerButton.material.color.set(qa.green),Bl.isHost()||(this._usernameBlock.backgroundVisible=!1),this.add(this._usernameBlock),this.add(this._muteMyselfButton),this.add(this._mutePeerButton),this._addInteractableEventListeners()}_addInteractableEventListeners(){this._usernameClickCallback=()=>{this._controller.getPage(Vh.PEER).setContent(this._peer,this._designateHostCallback),this._controller.pushPage(Vh.PEER)},Bl.isHost()&&(this._usernameBlock.onClickAndTouch=this._usernameClickCallback),this._muteMyselfButton.onClickAndTouch=()=>this.toggleMyselfMuted(),this._mutePeerButton.onClickAndTouch=()=>this.togglePeerMuted()}toggleHost(r){r?(this._usernameBlock.onClickAndTouch=this._usernameClickCallback,this._usernameBlock.backgroundVisible=!0):(this._usernameBlock.onClickAndTouch=null,this._usernameBlock.backgroundVisible=!1)}toggleMyselfMuted(r){if(r==this._mutedMyself)return;let A;this._mutedMyself=!this._mutedMyself,A=this._mutedMyself?qa.red:qa.green,this._peer.rtc.toggleMyselfMuted(this._mutedMyself),this._muteMyselfButton.material.color.set(A)}togglePeerMuted(r){if(r==this._mutedPeer)return;let A;this._mutedPeer=!this._mutedPeer,A=this._mutedPeer?qa.red:qa.green,this._peer.rtc.togglePeerMuted(this._mutedPeer),this._mutePeerButton.material.color.set(A)}setUsername(r){r=stringWithMaxLength(r||"...",12),this._usernameBlock.textComponent.text!=r&&(this._usernameBlock.textComponent.text=r)}_onAdded(){this.setUsername(this._peer.username),super._onAdded()}}const Zc=[{title:"Make Host",handler:"_handleMakeHost"},{title:"Kick Out",handler:"_handleKickOut"}];class PeerPage extends MenuPage{constructor(r){super(r,!0),this._addPageContent()}_addPageContent(){this._titleBlock=new TextComponent("",ro.title),this.add(this._titleBlock);let r=new Div({height:.2,width:.45});for(let A of Zc){let b=createWideButton(A.title);b.margin=.004,b.onClickAndTouch=()=>this[A.handler](),r.add(b)}this.add(r)}_handleMakeHost(){this._designateHostCallback&&this._designateHostCallback(this._peer.id),Bl.setIsHost(!1),bl.designateHost(this._peer.id),this._controller.back()}_handleKickOut(){bl.bootPeer(this._peer.id),this._controller.back()}setContent(r,A){let b=stringWithMaxLength(r.username||"...",12);this._titleBlock.text=b,this._peer=r,this._designateHostCallback=A}_addSubscriptions(){Qt.subscribe(this._id,Rt.PARTY_ENDED,(()=>{this._controller.back()})),Qt.subscribe(this._id,Rt.PEER_DISCONNECTED,(r=>{this._peer==r.peer&&this._controller.back()})),Qt.subscribe(this._id,Rt.PEER_USERNAME_UPDATED,(r=>{this._peer==r.peer&&this.setContent(this._peer)}))}_removeSubscriptions(){Qt.unsubscribe(this._id,Rt.PARTY_ENDED),Qt.unsubscribe(this._id,Rt.PEER_DISCONNECTED),Qt.unsubscribe(this._id,Rt.PEER_USERNAME_UPDATED)}back(){this._removeSubscriptions(),super.back()}_onAdded(){this._addSubscriptions(),super._onAdded()}}const Jc="https://mydigitalbacon.com",$c=Jc+"/login?referrer=digitalbacon",eu="https://digitalbacon.io",tu=eu+"/preview",su={"New Project":"_newProject","Host Online":"_hostOnMyDigitalBacon","Preview Live":"_previewLive","Save to Device":"_localSave","Load from Device":"_localLoad","Save to Google Drive":"_googleDriveSave","Load from Google Drive":"_googleDriveLoad","Sign out of Google Drive":"_googleDriveSignout"};class ProjectPage extends PaginatedButtonsPage{constructor(r){super(r,!0),this._items=Object.keys(su).slice(0,-1),this._addPageContent(),this._addSubscriptions()}_addPageContent(){let r=new TextComponent("Project File",ro.title);this.add(r),this._loadingSavingBlock=new TextComponent("Project Loading...",ro.bodyText,{height:.2}),this._addList()}_getItemName(r){return r}_handleItemInteraction(r){this[su[r]]()}_refreshItems(){let r=Uc.isSignedIn();this._items=Object.keys(su).filter(((A,b)=>!(this._isHosting&&1==b||!r&&7==b||this._isLoadingPreview&&2==b)))}_newProject(){if(Bl.isPartyActive()&&!Bl.isHost())return void Qt.publish(this._id,Rt.MENU_NOTIFICATION,{text:"Only Host Can Load Projects"});this._controller.getPage(Vh.TWO_BUTTON).setContent("You will lose any unsaved progress when starting a new project","Confirm New Project","Cancel",(()=>{this._newProjectConfirm()}),(()=>{this._controller.popPage()})),this._controller.pushPage(Vh.TWO_BUTTON)}_localSave(){this._updateSaving(!1),Qt.publish(this._id,Rt.PROJECT_SAVING,!1),il.exportProject().generateAsync({type:"blob"}).then((r=>{this._updateSaving(!0),Qt.publish(this._id,Rt.PROJECT_SAVING,!0),saveAs(r,"Digital Bacon Project.zip")}),(r=>{console.error(r),this._updateSaving(!0),Qt.publish(this._id,Rt.PROJECT_SAVING,!0),Qt.publish(this._id,Rt.MENU_NOTIFICATION,{text:"Error Saving Project"})}))}_localLoad(){!Bl.isPartyActive()||Bl.isHost()?Ah.triggerProjectFileUpload((r=>{this._handleLocalFile(r)})):Qt.publish(this._id,Rt.MENU_NOTIFICATION,{text:"Only Host Can Load Projects"})}_googleDriveSave(){if(Uc.isSignedIn())if(Uc.hasActiveFile()){let r=this._controller.getPage(Vh.TWO_BUTTON),A=Uc.getCurrentFileName();r.setContent("Would you like to overwrite "+A+" or save the project as a new one?","Overwrite existing project","Save as new",(()=>{this._controller.popPage(),this._googleDriveOverwrite()}),(()=>{this._controller.popPage(),this._googleDriveSaveAs()})),this._controller.pushPage(Vh.TWO_BUTTON)}else this._googleDriveSaveAs();else this._googleDriveSignin((()=>this._googleDriveSave()))}_googleDriveOverwrite(){this._updateSaving(!1),Qt.publish(this._id,Rt.PROJECT_SAVING,!1),Uc.save(il.exportProject(),(()=>{this._saveSuccessCallback()}),(()=>{this._saveErrorCallback()}))}_googleDriveSaveAs(){this._controller.getPage(Vh.TEXT_INPUT).setContent("Save Project As","Filename","Save",(r=>{r&&0!=r.length?(this._updateSaving(!1),Qt.publish(this._id,Rt.PROJECT_SAVING,!1),Uc.saveAs(r,il.exportProject(),(()=>{this._saveSuccessCallback()}),(()=>{this._saveErrorCallback()})),this._controller.back()):Qt.publish(this._id,Rt.MENU_NOTIFICATION,{text:"Please add a filename"})})),this._controller.pushPage(Vh.TEXT_INPUT)}_googleDriveLoad(){if(!Bl.isPartyActive()||Bl.isHost())if(Uc.isSignedIn()){this._controller.getPage(Vh.LOAD_GDRIVE).loadProjects(),this._controller.pushPage(Vh.LOAD_GDRIVE)}else this._googleDriveSignin((()=>this._googleDriveLoad()));else Qt.publish(this._id,Rt.MENU_NOTIFICATION,{text:"Only Host Can Load Projects"})}_googleDriveSignin(r){this._googleSigninCallback=r,"XR"==Mt.deviceType?(el.exitXRSession(),Uc.handleAuthButton((()=>{this._handleGoogleAuthResponse()}))):ba.trigger((()=>{try{Uc.handleAuthButton((()=>{this._handleGoogleAuthResponse()}))}catch(r){Qt.publish(this._id,Rt.MENU_NOTIFICATION,{text:"Google could not be reached. Please check your internet connection and then try refreshing the page"})}}))}_handleGoogleAuthResponse(){this._refreshItems(),this._updateItemsGUI(),this._googleSigninCallback&&this._googleSigninCallback()}_googleDriveSignout(){Uc.isSignedIn()&&Uc.handleSignoutButton(),this._page=0,this._refreshItems(),this._updateItemsGUI()}_hostOnMyDigitalBacon(){this._stopHostingAttempt(),this._isHosting=!0,this._refreshItems(),this._updateItemsGUI(),ba.trigger((()=>{this._hostingTab=window.open($c,"_blank"),this._hostingTab||Qt.publish(this._id,Rt.MENU_NOTIFICATION,{text:"Please check your popup blocker settings"})})),il.exportProject().generateAsync({type:"blob"}).then((r=>{let A=new FileReader;A.onloadend=()=>{this._hostingBlob=A.result,this._hostingTab.focus(),this._hostingIntervalId=setInterval((()=>{this._hostingTab.postMessage("HOST_PROJECT",Jc)}),1e3)},A.readAsDataURL(r)}))}_previewLive(){this._stopPreviewAttempt(),this._isLoadingPreview=!0,this._refreshItems(),this._updateItemsGUI(),il.exportProject().generateAsync({type:"blob"}).then((r=>{let A=new FileReader;A.onloadend=()=>{if(this._previewBlob=A.result,this._previewTab=window.open(tu,"_blank"),!this._previewTab)return this._stopPreviewAttempt(),void Qt.publish(this._id,Rt.MENU_NOTIFICATION,{text:"Please check your popup blocker settings"});"XR"==Mt.deviceType&&el.exitXRSession(),this._previewTab.focus(),this._previewIntervalCount=0,this._previewIntervalId=setInterval((()=>{this._previewTab.postMessage({topic:"PREVIEW"},eu),this._previewIntervalCount++,this._previewIntervalCount>10&&this._stopPreviewAttempt()}),1e3)},A.readAsDataURL(r)}))}_stopHostingAttempt(){this._hostingIntervalId&&(clearInterval(this._hostingIntervalId),this._hostingIntervalId=null),this._hostingTab&&(this._hostingTab.close(),this._hostingTab=null),this._hostingBlob=null,this._isHosting=!1,this._refreshItems(),this._updateItemsGUI()}_stopPreviewAttempt(){this._previewIntervalId&&(clearInterval(this._previewIntervalId),this._previewIntervalId=null),this._previewTab&&(this._previewTab.close(),this._previewTab=null),this._previewBlob=null,this._isLoadingPreview=!1,this._refreshItems(),this._updateItemsGUI()}_handleLocalFile(r){this._updateLoading(!1),JSZip.loadAsync(r).then((r=>{il.loadZip(r,(()=>{Qt.publish(this._id,Rt.MENU_NOTIFICATION,{text:"Project Loaded"}),Bl.isPartyActive()&&Bl.isHost()&&Bl.sendProject()}),(()=>{this._loadErrorCallback()}))}))}_newProjectConfirm(){if(Bl.isPartyActive()&&!Bl.isHost())return void Qt.publish(this._id,Rt.MENU_NOTIFICATION,{text:"Only Host Can Load Projects"});il.reset(),eh.position=[0,0,0];let r=new AmbientLight({visualEdit:!1});il.addAsset(r,!1,!0),Uc.clearActiveFile(),Bl.isPartyActive()&&Bl.isHost()&&Bl.sendProject(),this._controller.popPage()}_loadErrorCallback(){Qt.publish(this._id,Rt.MENU_NOTIFICATION,{text:"Error Loading Project",sustainTime:5})}_saveSuccessCallback(){this._updateSaving(!0),Qt.publish(this._id,Rt.PROJECT_SAVING,!0),Qt.publish(this._id,Rt.MENU_NOTIFICATION,{text:"Project Saved"})}_saveErrorCallback(){this._updateSaving(!0),Qt.publish(this._id,Rt.PROJECT_SAVING,!0),Qt.publish(this._id,Rt.MENU_NOTIFICATION,{text:"Error Saving Project"})}_addSubscriptions(){Qt.subscribe(this._id,Rt.PROJECT_LOADING,(r=>{this._updateLoading(r)})),Qt.subscribe(this._id,Rt.PROJECT_SAVING,(r=>{this._updateSaving(r)})),window.addEventListener("message",(r=>{if("READY_FOR_PREVIEW_PROJECT"==r.data){if(r.origin!=eu)return;if(clearInterval(this._previewIntervalId),!this._previewBlob||!this._previewTab)return;this._previewTab.postMessage({topic:"PREVIEW_PROJECT",blob:this._previewBlob},eu),this._isLoadingPreview=!1,this._refreshItems(),this._updateItemsGUI()}else if("HOST_PROJECT"==r.data){if(r.origin!=Jc)return;if(clearInterval(this._hostingIntervalId),this._isHosting=!1,this._refreshItems(),this._updateItemsGUI(),!this._hostingBlob||!this._hostingTab)return;this._hostingTab.postMessage({topic:"HOST_PROJECT",blob:this._hostingBlob},Jc)}}))}_updateLoading(r){this._loadingSavingBlock.text="Project Loading...",this._updateLoadingSaving(r)}_updateSaving(r){this._loadingSavingBlock.text="Project Saving...",this._updateLoadingSaving(r)}_updateLoadingSaving(r){r?(this.remove(this._loadingSavingBlock),this.add(this._optionsContainer)):(this.remove(this._optionsContainer),this.add(this._loadingSavingBlock))}}let iu=new class ReadyPlayerMe{init(r){this._setupIframe(r),this._addEventListeners()}_setupIframe(r){this._iframe=document.createElement("iframe"),this._iframe.id="digital-bacon-rpm-iframe",this._iframe.allow="camera *; microphone *; clipboard-write",this._iframe.src="https://digital-bacon.readyplayer.me/avatar?frameApi&clearCache",this._iframe.hidden=!0,this._closeButton=document.createElement("button"),this._closeButton.innerHTML="Close Ready Player Me",this._closeButton.id="ready-player-me-close-button",this._closeButton.classList.add("hidden"),r.append(this._iframe),r.append(this._closeButton)}_addEventListeners(){window.addEventListener("message",(r=>{this._handleMessage(r)})),this._closeButton.addEventListener("click",(()=>{this._close()}))}_handleMessage(r){const A=function parse(r){try{return JSON.parse(r.data)}catch(r){return null}}(r);A&&"readyplayerme"===A.source&&("v1.frame.ready"===A.eventName&&this._iframe.contentWindow.postMessage(JSON.stringify({target:"readyplayerme",type:"subscribe",eventName:"v1.**"}),"*"),"v1.avatar.exported"===A.eventName&&(eh.avatarUrl=A.data.url+"?useHands=false",this._close()))}_close(){this._closeButton.classList.add("hidden"),this._iframe.hidden=!0}selectAvatar(){this._closeButton.classList.remove("hidden"),this._iframe.hidden=!1,"XR"==Mt.deviceType&&el.exitXRSession()}};const nu=[{title:"Backdrop",menuPage:Vh.SKYBOX,isEditorOnly:!0},{title:"Visitor Settings",menuPage:Vh.USER_SETTINGS},{title:"Editor Settings",menuPage:Vh.EDITOR_SETTINGS,isEditorOnly:!0},{title:"Update Avatar"},{title:"Acknowledgements",menuPage:Vh.EDIT_ACKNOWLEDGEMENTS,isEditorOnly:!0}];class SettingsPage extends MenuPage{constructor(r){super(r,!0),this._addPageContent()}_addPageContent(){let r=new TextComponent("Settings",ro.title);this.add(r);let A=new Div({height:.2,width:.45});for(let r of nu){if(!Mt.isEditor&&r.isEditorOnly)continue;let b=createWideButton(r.title);b.margin=.004,A.add(b),b.onClickAndTouch=()=>{r.menuPage?this._controller.pushPage(r.menuPage):iu.selectAvatar()}}this.add(A)}}let ru=class SketchfabLoginPage extends MenuPage{constructor(r){super(r,!0),this._staySignedIn=!1,this._addPageContent()}_addPageContent(){this._titleBlock=new TextComponent("",ro.title),this.add(this._titleBlock);let r=new Div({height:.21,justifyContent:"spaceBetween",marginTop:.004,width:.45});this._textureBlock=new ia(Ya.ellipsisIcon,{height:.085,textureFit:"cover",width:.1}),r.add(this._textureBlock),this._authorBlock=new TextComponent("Author: ",ro.bodyText),r.add(this._authorBlock),this._downloadButton=createWideButton("Download"),this._downloadButtonParent=new Div({height:.035}),this._downloadButtonParent.add(this._downloadButton),r.add(this._downloadButtonParent),this._downloadButton.onClickAndTouch=()=>{this._assetId?this._handleDownloadSuccess(this._assetId):(this._downloadButtonParent.remove(this._downloadButton),Vc.download(this._sketchfabAsset,(r=>{this._handleDownloadSuccess(r)}),(()=>{this._handleDownloadError()})))};let A=createWideButton("View on Sketchfab");r.add(A),A.onClickAndTouch=()=>{"XR"==Mt.deviceType&&el.exitXRSession(),window.open(this._sketchfabAsset.viewerUrl,"_blank")},this.add(r)}_handleDownloadSuccess(r){this._controller.getPosition(ao[0]),this._controller.getDirection(ao[1]).normalize().divideScalar(4);let A=ao[0].sub(ao[1]).toArray();ao[0].set(0,0,1),ao[1].setY(0).normalize(),ho.setFromUnitVectors(ao[0],ao[1]),lo.setFromQuaternion(ho);let b=lo.toArray();il.addNewAsset(r,{assetId:r,position:A,rotation:b,visualEdit:!0}),this._downloadButtonParent.add(this._downloadButton),this._assetId=Qo.getAssetIdFromSketchfabId(this._sketchfabAsset.uid),r==this._assetId&&(this._downloadButton.textComponent.text="Add")}_handleDownloadError(){Qt.publish(this._id,Rt.MENU_NOTIFICATION,{text:"Could not download model, please try again later"}),this._downloadButtonParent.add(this._downloadButton)}setContent(r){this._titleBlock.text=r.name,this._authorBlock.text="Author: "+r.user.username,r.previewTexture?this._textureBlock.updateTexture(r.previewTexture):this._textureBlock.updateTexture(Ya.ellipsisIcon),this._assetId=Qo.getAssetIdFromSketchfabId(r.uid),this._downloadButton.textComponent.text=this._assetId?"Add":"Download",this._sketchfabAsset=r}};class SketchfabLoginPage extends MenuPage{constructor(r){super(r,!0),this._staySignedIn=!1,this._addPageContent()}_addPageContent(){let r=new TextComponent("Login to Sketchfab",ro.title);this.add(r);let A=new Xh({title:"Stay signed in on this device",titleWidth:.27,initialValue:!1,swapOrder:!0,onUpdate:r=>{this._staySignedIn=r},getFromSource:()=>this._staySignedIn});this.add(A);let b=createWideButton("Login");b.height=.04,b.margin=.004,b.width=.25,this.add(b),b.onClickAndTouch=()=>{"XR"==Mt.deviceType?(el.exitXRSession(),this._handleLogin()):ba.trigger((()=>this._handleLogin()))}}_handleLogin(){Vc.signIn(this._staySignedIn,(()=>{this._handleLoginCallback()}))}_handleLoginCallback(){this._controller.popPage(),this._controller.pushPage(Vh.SKETCHFAB_SEARCH)}}class PaginatedImagesPage extends MenuPage{constructor(r,A){super(r,A),this._paginatedListButtons=[],this._page=0}_addList(){this._createPreviousAndNextButtons(),this._optionsContainer=new Span({height:.2,justifyContent:"spaceEvenly",width:.45}),this._optionsBlock=new Div({height:.178,justifyContent:"spaceBetween"});let r={height:.085,width:.316,justifyContent:"spaceBetween"};this._rows=[],this._rows.push(new Span(r)),this._rows.push(new Span(r));for(let r=0;r<2;r++){let A=this._rows[r];for(let b=0;b<3;b++){let C=new ia(Ya.ellipsisIcon,{borderRadius:.01,height:.085,justifyContent:"spaceEvenly",textureFit:"cover",width:.1});C.pointerInteractable=new OrbitDisablingPointerInteractable(C),A.add(C),this._paginatedListButtons.push(C),C.onClickAndTouch=()=>{let A=2*this._page*3+3*r+b;this._items.length>A?this._handleItemInteraction(this._items[A]):console.error("PaginatedImagesPage displaying non existant option")}}}this._optionsBlock.add(this._rows[0]),this._optionsBlock.add(this._rows[1]),this._optionsContainer.add(this._previousButtonParent),this._optionsContainer.add(this._optionsBlock),this._optionsContainer.add(this._nextButtonParent),this.add(this._optionsContainer)}_createPreviousAndNextButtons(){this._previousButtonParent=new Div,this._previousButton=createSmallButton("<"),this._previousButton.onClickAndTouch=()=>{this._page-=1,this._updateItemsGUI()},this._previousButtonParent.add(this._previousButton),this._nextButtonParent=new Div,this._nextButton=createSmallButton(">"),this._nextButton.onClickAndTouch=()=>{this._page+=1,this._fetchNext&&this._fetchNextItems(),this._updateItemsGUI()},this._nextButtonParent.add(this._nextButton)}_updateItemsGUI(){let r=2*this._page*3;for(let A=0;A<6;A++){let b=this._paginatedListButtons[A];if(r+A<this._items.length){let C=this._items[r+A],I=this._getItemImage(C);b.updateTexture(I),b.parentComponent||this._rows[Math.floor(A/3)].add(b)}else b.parentComponent&&b.parentComponent.remove(b)}0==this._page?this._previousButton.parentComponent&&this._previousButtonParent.remove(this._previousButton):this._previousButton.parentComponent||this._previousButtonParent.add(this._previousButton),this._items.length>r+6?(this._nextButton.parentComponent||this._nextButtonParent.add(this._nextButton),this._fetchNext=!1):this._items.length==r+6&&this._canFetchMore?this._fetchNext=!0:(this._nextButton.parentComponent&&this._nextButtonParent.remove(this._nextButton),this._fetchNext=!1)}_fetchNextItems(){return console.error("PaginatedImagesPage._fetchNextItems() should be overridden"),""}_getItemImage(){return console.error("PaginatedImagesPage._getItemImage() should be overridden"),""}_handleItemInteraction(){console.error("PaginatedImagesPage._handleItemInteraction() should be overridden")}_refreshItems(){console.error("PaginatedImagesPage._refreshItems() should be overridden")}_onAdded(){super._onAdded(),this._refreshItems(),this._updateItemsGUI()}}class SketchfabSearchPage extends PaginatedImagesPage{constructor(r){super(r,!0),this._items=[],this._addPageContent()}_addPageContent(){this._searchInput=createTextInput({borderRadius:.02,fontSize:Ja,height:.04,marginBottom:.004,marginTop:.01,width:.375}),this._searchInput.onBlur=()=>this._searchUpdated(),this._searchInput.onEnter=()=>this._searchInput.blur(),this._searchInput.onFocus=()=>{Mt.keyboardLock=!0},this.add(this._searchInput),this._loadingBlock=new TextComponent("Loading...",ro.bodyText,{height:.2}),this._addList()}_searchUpdated(){Mt.keyboardLock=!1;for(let r of this._items)r.isDeleted=!0,r.previewTexture&&r.previewTexture.dispose();if(this._page=0,this._items=[],this._updateItemsGUI(),0==this._searchInput.value.length)return;this.remove(this._optionsContainer),this.add(this._loadingBlock);let r=Math.random();this._idempotentKey=r,Vc.search(this._searchInput.value,(A=>{this._handleSearchResponse(A,r)}),(()=>{this._handleSearchError()}))}_handleSearchResponse(r,A){if(this._idempotentKey==A){this.remove(this._loadingBlock),this.add(this._optionsContainer);for(let A of r.results)this._items.push(A);this._canFetchMore=r.next,this._updateItemsGUI()}}_handleSearchError(){this.remove(this._loadingBlock),Qt.publish(this._id,Rt.MENU_NOTIFICATION,{text:"An unexpected error occurred, please try again later"})}_handleFetchMoreError(){this._page--,this._updateItemsGUI(),Qt.publish(this._id,Rt.MENU_NOTIFICATION,{text:"An unexpected error occurred, please try again later"})}_fetchNextItems(){this.remove(this._optionsContainer),this.add(this._loadingBlock);let r=Math.random();this._idempotentKey=r,Vc.fetch(this._canFetchMore,(A=>{this._handleSearchResponse(A,r)}),(()=>{this._handleFetchMoreError()}))}_getItemImage(r){if(r.previewTexture)return r.previewTexture;if(!r.isLoadingTexture){let A=this._getSmallestImage(r.thumbnails.images);r.previewUrl=A.url,r.isLoadingTexture=!0,(new ue).load(r.previewUrl,(A=>{r.isDeleted?A.dispose():(r.previewTexture=A,this._updateItemsGUI())}))}return Ya.ellipsisIcon}_getSmallestImage(r){let A=null;for(let b of r)b.width<256||(null==A||b.size<A.size)&&(A=b);return A}_handleItemInteraction(r){this._controller.getPage(Vh.SKETCHFAB_ASSET).setContent(r),this._controller.pushPage(Vh.SKETCHFAB_ASSET)}_refreshItems(){}}const au=[Go.TOP,Go.LEFT,Go.FRONT,Go.RIGHT,Go.BACK,Go.BOTTOM];class SkyboxPage extends MenuPage{constructor(r){super(r,!0),this._buttons=[],this._addPageContent()}_addPageContent(){let r=new TextComponent("Backdrop",ro.title);this.add(r);let A=new Div({height:.196,justifyContent:"spaceBetween",width:.45}),b=new Span({height:.06,justifyContent:"spaceBetween",width:.264});for(let r=0;r<au.length;r++){let C=new ia(Ya.searchIcon,{height:.06,width:.06});C.pointerInteractable=new OrbitDisablingPointerInteractable(C),C.onClickAndTouch=()=>{let A=Qo.getLibrary(),b={"null\n":{Name:"Blank"}};for(let r in A){let C=A[r];C.Type==kt.IMAGE&&(b[r]=C)}this._controller.getPage(Vh.ASSET_SELECT).setContent(b,(A=>{"null\n"==A&&(A=null),Wo.setSkyboxSide(au[r],A),this._controller.back()}),(()=>{this._fileUploadSide=au[r],Ah.triggerAssetsUpload((r=>{r.length>0&&(Wo.setSkyboxSide(this._fileUploadSide,r[0]),this._controller.back())}),!1,kt.IMAGE)})),this._controller.pushPage(Vh.ASSET_SELECT)},0==r?(C.marginRight=.068,A.add(C),A.add(b)):r<5?b.add(C):(C.marginRight=.068,A.add(C)),this._buttons.push(C)}this.add(A)}_setTextures(){let r=Wo.getSkyboxTextures();for(let A=0;A<au.length;A++)this._buttons[A].material.map!=r[au[A]]&&this._buttons[A].updateTexture(r[au[A]])}_addSubscriptions(){Qt.subscribe(this._id,Rt.SETTINGS_UPDATED,(()=>{this._setTextures()}))}_removeSubscriptions(){Qt.unsubscribe(this._id,Rt.SETTINGS_UPDATED)}_onAdded(){super._onAdded(),this._setTextures(),this._addSubscriptions()}_onRemoved(){super._onRemoved(),this._removeSubscriptions()}}class MessagePage extends MenuPage{constructor(r){super(r,!0),this._addPageContent()}_addPageContent(){this._titleBlock=new TextComponent("",ro.title),this.add(this._titleBlock),this._textBlock=new TextComponent("",ro.bodyText,{maxWidth:.4}),this.add(this._textBlock)}setContent(r,A){this._titleBlock.text=r,this._textBlock.text=A}}class TextInputPage extends MenuPage{constructor(r){super(r,!0),this._addPageContent()}_addPageContent(){this._titleBlock=new TextComponent(" ",ro.bodyText,{marginTop:.01,maxWidth:.375}),this.add(this._titleBlock);let r=new Div({height:.2,justifyContent:"center",width:.45});this._textInput=createTextInput({borderRadius:.02,fontSize:Ja,height:.04,marginBottom:.004,marginTop:.01,width:.375}),this._textInput.onBlur=()=>{Mt.keyboardLock=!1},this._textInput.onEnter=()=>this._inputConfirmed(),this._textInput.onFocus=()=>{Mt.keyboardLock=!0},this._button=createWideButton("."),this._button.height=.04,this._button.margin=.004,this._button.width=.25,this._button.onClickAndTouch=()=>this._inputConfirmed(),r.add(this._textInput),r.add(this._button),this.add(r)}_inputConfirmed(){this._textInput.blur(),this._action&&this._action(this._textInput.value)}setContent(r,A,b,C){this._titleBlock.text=r,this._button.textComponent.text=b,this._action=C,this._textInput.placeholder=A,this._textInput.value=""}setContentWithInitialValue(r,A,b,C){this._titleBlock.text=r,this._button.textComponent.text=b,this._action=C,this._textInput.placeholder="",this._textInput.value=A}back(){this._textInput.blur(),super.back()}}class TwoButtonPage extends MenuPage{constructor(r){super(r,!0),this._addPageContent()}_addPageContent(){this._titleBlock=new TextComponent(" ",ro.bodyText,{marginTop:.01,maxWidth:.375}),this.add(this._titleBlock);let r=new Div({height:.2,justifyContent:"center",width:.45});this._button1=createWideButton("."),this._button2=createWideButton(" "),this._button1.height=this._button2.height=.04,this._button1.margin=this._button2.margin=.004,this._button1.width=this._button2.width=.25,this._button1.onClickAndTouch=()=>{this._action1&&this._action1()},this._button2.onClickAndTouch=()=>{this._action2&&this._action2()},r.add(this._button1),r.add(this._button2),this.add(r)}setContent(r,A,b,C,I){this._titleBlock.text=r,this._button1.textComponent.text=A,this._button2.textComponent.text=b,this._action1=C,this._action2=I}}class UserSettingsPage extends DynamicFieldsPage{constructor(r){super(r,!0),this._createFields()}_createTitleBlock(){this._titleBlock=new TextComponent("User Settings",ro.title),this.add(this._titleBlock)}_createFields(){let r=[];r.push(new id({title:"Movement Speed",minValue:0,maxValue:1e3,initialValue:4,onBlur:(r,A)=>{Wo.setUserSetting("Movement Speed",A)},getFromSource:()=>Wo.getUserSettings()["Movement Speed"]})),r.push(new id({title:"User Scale",minValue:.001,maxValue:1e3,initialValue:1,onBlur:(r,A)=>{Mt.isEditor||(Mt.userController.scale=[A,A,A]),Wo.setUserSetting("User Scale",A)},getFromSource:()=>Wo.getUserSettings()["User Scale"]})),r.push(new Xh({title:"Enable Flying",initialValue:!0,onUpdate:r=>{Wo.setUserSetting("Enable Flying",r)},getFromSource:()=>Wo.getUserSettings()["Enable Flying"]})),"XR"!=Mt.deviceType||Mt.isEditor||r.push(new Xh({title:"Swap Joysticks",initialValue:!1,onUpdate:r=>{Wo.setUserSetting("Swap Joysticks",r)},getFromSource:()=>Wo.getUserSettings()["Swap Joysticks"]})),this._setFields(r)}_addSubscriptions(){Qt.subscribe(this._id,Rt.SETTINGS_UPDATED,(()=>{for(let r of this._fields)r.updateFromSource()}))}_removeSubscriptions(){Qt.unsubscribe(this._id,Rt.SETTINGS_UPDATED)}_onAdded(){this._addSubscriptions();for(let r of this._fields)r.updateFromSource();super._onAdded()}_onRemoved(){this._removeSubscriptions(),super._onRemoved()}}class EditorMenuController extends MenuController{constructor(){super(),this._pages[Vh.ACKNOWLEDGEMENTS]=new AcknowledgementsPage(this),this._pages[Vh.ASSET_SELECT]=new AssetSelectPage(this),this._pages[Vh.ASSET_SET]=new AssetSetPage(this),this._pages[Vh.COLOR_WHEEL]=new ColorWheelPage(this),this._pages[Vh.EDIT_ACKNOWLEDGEMENTS]=new EditAcknowledgementsPage(this),this._pages[Vh.EDITOR_SETTINGS]=new EditorSettingsPage(this),this._pages[Vh.HOST_PARTY]=new HostPartyPage(this),this._pages[Vh.JOIN_PARTY]=new JoinPartyPage(this),this._pages[Vh.LIBRARY]=new LibraryPage(this),this._pages[Vh.LIBRARY_SEARCH]=new LibrarySearchPage(this),this._pages[Vh.LIST_COMPONENTS]=new ListComponentsPage(this),this._pages[Vh.LOAD_GDRIVE]=new LoadFromGDrivePage(this),this._pages[Vh.MESSAGE]=new MessagePage(this),this._pages[Vh.NAVIGATION]=new NavigationPage(this),this._pages[Vh.NEW_ASSET]=new NewAssetPage(this),this._pages[Vh.PARTY]=new PartyPage(this),this._pages[Vh.PEER]=new PeerPage(this),this._pages[Vh.PROJECT]=new ProjectPage(this),this._pages[Vh.SETTINGS]=new SettingsPage(this),this._pages[Vh.SKETCHFAB_ASSET]=new ru(this),this._pages[Vh.SKETCHFAB_LOGIN]=new SketchfabLoginPage(this),this._pages[Vh.SKETCHFAB_SEARCH]=new SketchfabSearchPage(this),this._pages[Vh.SKYBOX]=new SkyboxPage(this),this._pages[Vh.TEXT_INPUT]=new TextInputPage(this),this._pages[Vh.TWO_BUTTON]=new TwoButtonPage(this),this._pages[Vh.USER_SETTINGS]=new UserSettingsPage(this);for(let r in kt)r!=kt.INTERNAL&&(this._pages[r+"S"]=new AssetsPage(this,r),this._pages[r]=new AssetPage(this,r));this._pageCalls.push(Vh.NAVIGATION),"XR"==Mt.deviceType&&(this._pages[Vh.HANDS]=new HandsPage(this)),this._object.add(this.getCurrentPage())}_createInteractables(){super._createInteractables(),sl.addButtons(this._object)}}const ou=[{title:"Settings",menuPage:Vh.SETTINGS},{title:"Connect with Peers",menuPage:Vh.PARTY},{title:"Acknowledgements",menuPage:Vh.ACKNOWLEDGEMENTS},{title:"Build Your Own 3D Website"}];class HomePage extends MenuPage{constructor(r){super(r,!1),this._addPageContent()}_addPageContent(){let r=new TextComponent("Home",ro.title);this.add(r);let A=new Div({height:.2,width:.45}),b=Mt.authUrl&&Mt.socketUrl,C=Wo.getAcknowledgements();for(let r of ou){if(r.menuPage==Vh.PARTY&&!b)continue;if(r.menuPage==Vh.ACKNOWLEDGEMENTS&&0==C.length)continue;let I=createWideButton(r.title);I.margin=.004,A.add(I),r.menuPage?I.onClickAndTouch=()=>this._controller.pushPage(r.menuPage):I.onClickAndTouch=()=>top.window.location.href="https://digitalbacon.io"}this.add(A)}}class LiveMenuController extends MenuController{constructor(){super(),this._pages[Vh.ACKNOWLEDGEMENTS]=new AcknowledgementsPage(this),this._pages[Vh.HOME]=new HomePage(this),this._pages[Vh.HOST_PARTY]=new HostPartyPage(this),this._pages[Vh.JOIN_PARTY]=new JoinPartyPage(this),this._pages[Vh.PARTY]=new PartyPage(this),this._pages[Vh.PEER]=new PeerPage(this),this._pages[Vh.SETTINGS]=new SettingsPage(this),this._pages[Vh.TEXT_INPUT]=new TextInputPage(this),this._pages[Vh.USER_SETTINGS]=new UserSettingsPage(this),this._pageCalls.push(Vh.HOME),this._object.add(this.getCurrentPage())}}const lu="DIGITAL_BACON_METRICS:"+window.location.origin+":HAS_VISITED";var detectIncognito=function(){return new Promise((function(r,A){var b="Unknown";function __callback(A){r({isPrivate:A,browserName:b})}function assertEvalToString(r){return r===eval.toString().length}function safariPrivateTest(){void 0!==navigator.maxTouchPoints?function newSafariTest(){var r=String(Math.random());try{window.indexedDB.open(r,1).onupgradeneeded=function(A){var b,C,I=null===(b=A.target)||void 0===b?void 0:b.result;try{I.createObjectStore("test",{autoIncrement:!0}).put(new Blob),__callback(!1)}catch(r){var x=r;return r instanceof Error&&(x=null!==(C=r.message)&&void 0!==C?C:r),__callback("string"==typeof x&&/BlobURLs are not yet supported/.test(x))}finally{I.close(),window.indexedDB.deleteDatabase(r)}}}catch(r){return __callback(!1)}}():function oldSafariTest(){var r=window.openDatabase,A=window.localStorage;try{r(null,null,null,null)}catch(r){return __callback(!0)}try{A.setItem("test","1"),A.removeItem("test")}catch(r){return __callback(!0)}return __callback(!1)}()}function storageQuotaChromePrivateTest(){navigator.webkitTemporaryStorage.queryUsageAndQuota((function(r,A){__callback(Math.round(A/1048576)<2*Math.round(function getQuotaLimit(){var r=window;return void 0!==r.performance&&void 0!==r.performance.memory&&void 0!==r.performance.memory.jsHeapSizeLimit?performance.memory.jsHeapSizeLimit:1073741824}()/1048576))}),(function(r){A(new Error("detectIncognito somehow failed to query storage quota: "+r.message))}))}function chromePrivateTest(){void 0!==self.Promise&&void 0!==self.Promise.allSettled?storageQuotaChromePrivateTest():function oldChromePrivateTest(){(0,window.webkitRequestFileSystem)(0,1,(function(){__callback(!1)}),(function(){__callback(!0)}))}()}!function main(){!function isSafari(){var r=navigator.vendor;return void 0!==r&&0===r.indexOf("Apple")&&assertEvalToString(37)}()?!function isChrome(){var r=navigator.vendor;return void 0!==r&&0===r.indexOf("Google")&&assertEvalToString(33)}()?!function isFirefox(){return void 0!==document.documentElement&&void 0!==document.documentElement.style.MozAppearance&&assertEvalToString(37)}()?!function isMSIE(){return void 0!==navigator.msSaveBlob&&assertEvalToString(39)}()?A(new Error("detectIncognito cannot determine the browser")):(b="Internet Explorer",function msiePrivateTest(){__callback(void 0===window.indexedDB)}()):(b="Firefox",function firefoxPrivateTest(){__callback(void 0===navigator.serviceWorker)}()):(b=function identifyChromium(){var r=navigator.userAgent;return r.match(/Chrome/)?void 0!==navigator.brave?"Brave":r.match(/Edg/)?"Edge":r.match(/OPR/)?"Opera":"Chrome":"Chromium"}(),chromePrivateTest()):(b="Safari",safariPrivateTest())}()}))};let hu=new class Metrics{constructor(){localStorage.getItem(lu)?this._userType="RETURN":detectIncognito().then((r=>{this._userType=r.isPrivate?"PRIVATE":"UNIQUE"}))}post(){let r=1==Mt.immersionDisabled,A={userType:this._userType||"PRIVATE",deviceType:Mt.deviceType,immersionDisabled:r,isEditor:Mt.isEditor};fetch("https://api.digitalbacon.io/app-stats",{method:"POST",body:JSON.stringify(A),headers:{"Content-type":"application/json"},referrerPolicy:"no-referrer-when-downgrade"}).then((r=>r.json())).then((A=>{"RETURN"!=this._userType&&localStorage.setItem(lu,!0),A.data&&A.data.timestamp&&(this._timestamp=A.data.timestamp,r||window.addEventListener("beforeunload",(()=>{this.put({pageClosed:!0})})))})).catch((r=>{console.error("Could not POST to app-stats endpoint"),console.error(r)}))}put(r){this._timestamp&&(r.timestamp=this._timestamp,fetch("https://api.digitalbacon.io/app-stats",{method:"PUT",body:JSON.stringify(r),headers:{"Content-type":"application/json"},referrerPolicy:"no-referrer-when-downgrade",keepalive:!0}).catch((r=>{console.error("Could not PUT to app-stats endpoint"),console.error(r)})))}};var Stats=function(){var r=0,A=document.createElement("div");function addPanel(r){return A.appendChild(r.dom),r}function showPanel(b){for(var C=0;C<A.children.length;C++)A.children[C].style.display=C===b?"block":"none";r=b}A.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",A.addEventListener("click",(function(b){b.preventDefault(),showPanel(++r%A.children.length)}),!1);var b=(performance||Date).now(),C=b,I=0,x=addPanel(new Stats.Panel("FPS","#0ff","#002")),S=addPanel(new Stats.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var B=addPanel(new Stats.Panel("MB","#f08","#201"));return showPanel(0),{REVISION:16,dom:A,addPanel:addPanel,showPanel:showPanel,begin:function(){b=(performance||Date).now()},end:function(){I++;var r=(performance||Date).now();if(S.update(r-b,200),r>=C+1e3&&(x.update(1e3*I/(r-C),100),C=r,I=0,B)){var A=performance.memory;B.update(A.usedJSHeapSize/1048576,A.jsHeapSizeLimit/1048576)}return r},update:function(){b=this.end()},domElement:A,setMode:showPanel}};Stats.Panel=function(r,A,b){var C=Infinity,I=0,x=Math.round,S=x(window.devicePixelRatio||1),B=80*S,D=48*S,R=3*S,F=2*S,N=3*S,Q=15*S,H=74*S,G=30*S,j=document.createElement("canvas");j.width=B,j.height=D,j.style.cssText="width:80px;height:48px";var V=j.getContext("2d");return V.font="bold "+9*S+"px Helvetica,Arial,sans-serif",V.textBaseline="top",V.fillStyle=b,V.fillRect(0,0,B,D),V.fillStyle=A,V.fillText(r,R,F),V.fillRect(N,Q,H,G),V.fillStyle=b,V.globalAlpha=.9,V.fillRect(N,Q,H,G),{dom:j,update:function(D,W){C=Math.min(C,D),I=Math.max(I,D),V.fillStyle=b,V.globalAlpha=1,V.fillRect(0,0,B,Q),V.fillStyle=A,V.fillText(x(D)+" "+r+" ("+x(C)+"-"+x(I)+")",R,F),V.drawImage(j,N+S,Q,H-S,G,N,Q,H-S,G),V.fillRect(N+H-S,Q,S,G),V.fillStyle=b,V.globalAlpha=.9,V.fillRect(N+H-S,Q,S,x((1-D/W)*G))}}};class Main{constructor(A,b,C){this._renderer,this._camera,this._scene=Ho.object,this._clock=new r.Clock,this._container=document.getElementById(b),this._loadingMessage=document.querySelector("#digital-bacon-loading"),this._errorMessage=document.querySelector("#digital-bacon-error"),this._callback=A,this._createRenderer(),this._createCamera(),this._createUser(),this._setupDigitalBaconUI(),this._createHandlers(C.onStart),this._createClients(),this._createAssets(C.projectFilePath),this._addEventListeners(),this._onResize(),this._enableStats(),this._renderer.setAnimationLoop((()=>{this._loading()}))}_createRenderer(){this._renderer=new r.WebGLRenderer({antialias:!0}),this._renderer.setPixelRatio(window.devicePixelRatio),this._container.appendChild(this._renderer.domElement),"XR"==Mt.deviceType&&(this._renderer.xr.enabled=!0),Mt.renderer=this._renderer}_createCamera(){let A=this._container.clientWidth/this._container.clientHeight;this._camera=new r.PerspectiveCamera(45,A,.1,1e3),Mt.camera=this._camera,this._scene.add(this._camera)}_createUser(){Mt.immersionDisabled||(this._cameraFocus=new r.Object3D,"XR"!=Mt.deviceType&&(this._cameraFocus.position.setY(1.7),this._camera.position.setY(.5),this._camera.position.setZ(1.9)),this._cameraFocus.add(this._camera),Mt.cameraFocus=this._cameraFocus,Mt.userController=eh)}_setupDigitalBaconUI(){let r=Mt.immersionDisabled&&"XR"==Mt.deviceType?"TOUCH_SCREEN":Mt.deviceType;_a.scale.set(.4,.4,.4),$n.enableXRControllerManagement(eh.object),init(this._container,this._renderer,this._scene,this._camera,r,this._cameraFocus)}_createHandlers(r){Yo.init(),Mt.immersionDisabled?tr.addInteractable(Ho.pointerInteractable):(el.init(this._container,(()=>{Qa.addInteractable(Ho.gripInteractable),tr.addInteractable(Ho.pointerInteractable),ir.addInteractable(Ho.touchInteractable),r&&r(),hu.post()})),sn.setTool(ah),Nh.init(this._renderer.domElement,this._camera,this._scene))}_createClients(){Mt.immersionDisabled||(Mt.isEditor&&Uc.init(),iu.init(this._container))}_createAssets(r){if(r){let A=uuidv4();Mt.loadingLocks.add(A),il.load(r,(()=>{Mt.immersionDisabled||this._setupForImmersion(),Mt.loadingLocks.delete(A)}),(r=>{if(this._loadingMessage.classList.remove("loading"),this._errorMessage.classList.add("error"),r)throw r}))}else{let r=new AmbientLight({visualEdit:!1});il.addAsset(r,!0,!0),Mt.immersionDisabled||this._setupForImmersion()}}_setupForImmersion(){sl.init(),this._menuController=Mt.isEditor?new EditorMenuController:new LiveMenuController,Mt.menuController=this._menuController,il.addAsset(eh,!0,!0),eh.init(),eh.object.add(this._cameraFocus)}_addEventListeners(){window.addEventListener("resize",(()=>{this._onResize()})),Mt.immersionDisabled||this._container.addEventListener("wheel",(function(r){r.preventDefault()}),{passive:!1,capture:!0})}_onResize(){this._renderer.setSize(this._container.clientWidth,this._container.clientHeight),this._camera.aspect=this._container.clientWidth/this._container.clientHeight,this._camera.updateProjectionMatrix()}_enableStats(){this._stats=new Stats,this._stats.showPanel(0),this._stats.dom.style.top="",this._stats.dom.style.left="",Mt.isEditor&&this._container.insertBefore(this._stats.dom,this._container.firstChild)}_loading(){if(0==Mt.loadingLocks.size){if(setTimeout((()=>{this._loadingMessage.children[0].innerHTML="&nbsp;",this._loadingMessage.classList.add("ending"),setTimeout((()=>{this._loadingMessage.classList.remove("loading"),Mt.immersionDisabled?hu.post():el.displayButton()}),1e3)}),50),Mt.immersionDisabled)return this._renderer.setAnimationLoop((()=>{this._update()})),Mt.dynamicAssets.add(tr),void(this._callback&&this._callback(this));"XR"==Mt.deviceType?this._renderer.setAnimationLoop(((r,A)=>{Mt.frame=A,$n.update(A),this._update()})):("POINTER"==Mt.deviceType||"TOUCH_SCREEN"==Mt.deviceType)&&this._renderer.setAnimationLoop((()=>{this._update()})),Mt.dynamicAssets.add(this._menuController),Mt.dynamicAssets.add(eh),Mt.dynamicAssets.add(Bl),Mt.isEditor&&(Mt.dynamicAssets.add(jh),Mt.dynamicAssets.add(Hh),Mt.dynamicAssets.add(Gh)),Mt.dynamicAssets.add(tr),"XR"==Mt.deviceType&&(Mt.dynamicAssets.add(Qa),Mt.dynamicAssets.add(ir)),Mt.dynamicAssets.add(Ji),this._callback&&this._callback(this)}else this._loadingMessage.children[0].innerHTML="Loading "+Mt.loadingLocks.size+" more asset(s)"}_update(){this._stats.begin();let r=this._clock.getDelta();for(let A of Mt.dynamicAssets)A.update(r);Qt.update(r),this._renderer.render(this._scene,this._camera),this._stats.end()}getRenderer(){return this._renderer}getScene(){return this._scene}}let du=new Date;function start(r,A,b){Mt.immersionDisabled=b.disableImmersion,function setupContainer(r){let A=document.createElement("style");A.type="text/css",A.innerHTML="\n#digital-bacon-loading.loading, #digital-bacon-error.error {\n    position: absolute;\n    height: 100%;\n    width: 100%;\n    z-index: 100;\n    color: #4723D9;\n    display: block;\n    justify-content: center;\n    align-items: center;\n}\n\n#digital-bacon-loading, #digital-bacon-error {\n    display: none;\n}\n\n@keyframes animatedOpacity {\n    from { opacity: 1; }\n    to { opacity: 0; }\n}\n\n#digital-bacon-loading.loading.ending {\n    animation: animatedOpacity 1s linear 1 forwards;\n}\n\n@keyframes animatedScale {\n    0% { transform: scale(1.0); }\n    100% { transform: scale(1.1); }\n}\n\n#digital-bacon-loading.loading > img {\n    width: 25%;\n    animation: animatedScale 1s ease-in-out alternate infinite;\n}\n\n#mobile-menu-open-button {\n    border-width: 1px;\n    border-style: solid;\n    border-color: #fff;\n    border-radius: 4px;\n    background: rgba(0,0,0,0.5);\n    color: #fff;\n    font: normal 13px sans-serif;\n    margin-left: 5px;\n    opacity: 0.75;\n    padding: 12px;\n    position: absolute;\n    right: 10px;\n    top: 10px;\n}\n\n#container button:hover {\n    opacity: 1;\n}\n\n#digital-bacon-transform-controls {\n    position: absolute;\n    top: 50px;\n}\n\n#digital-bacon-transform-controls > button, #ready-player-me-close-button {\n    border-width: 1px;\n    border-style: solid;\n    border-color: #fff;\n    border-radius: 4px;\n    background: rgba(0,0,0,0.5);\n    padding: 12px;\n    color: #fff;\n    font: normal 13px sans-serif;\n    opacity: 0.7;\n    width: 95px;\n    margin: 2px;\n    display: block;\n    text-align: left;\n}\n\n#digital-bacon-transform-controls > button:hover, #digital-bacon-transform-controls > button.selected {\n    opacity: 1;\n    font-weight: bold;\n    background-color: black;\n}\n\n#digital-bacon-transform-controls > button > i {\n    font-size: 18px;\n    width: 25px;\n}\n\n#ready-player-me-close-button {\n    position: absolute;\n    top: 10%;\n    z-index: 1001;\n    transform: translateX(-50%);\n    width: fit-content;\n    display: inline;\n}\n\n#digital-bacon-rpm-iframe {\n    position: absolute;\n    top: 10%;\n    left: 0;\n    width: 100%;\n    height: 80%;\n    z-index: 1000;\n    border: none;\n}\n\n#container .hidden {\n    display: none;\n}\n\n#container > canvas {\n    outline: none;\n}\n    ".replaceAll("container",r),Mt.deviceType==an.TOUCH_SCREEN&&(A.innerHTML+="\n@media screen and (max-height: 500px) {\n    #digital-bacon-transform-controls {\n        max-height: calc(100% - 169px);\n        overflow: scroll;\n    }\n}\n        ");document.getElementsByTagName("head")[0].appendChild(A);let b=document.createElement("link");b.rel="stylesheet",b.href="https://maxst.icons8.com/vue-static/landings/line-awesome/line-awesome/1.3.0/css/line-awesome.min.css",document.getElementsByTagName("head")[0].appendChild(b);let C=document.getElementById(r);C.innerHTML='\n      <div id="digital-bacon-loading" class="loading">\n        <h1>Loading...</h1>\n        <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABAAAAAQACAMAAABIw9uxAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAL6UExURQAAAG0bVQAAAAAAAEASMW4bVmYaT0dwTG4cVj4ANAAAAAAAAAAAAG0bVQAAAAYBBW4cVgAAAG4cVgAAAEQRNW4cViIIGg4DDG8cVUkSOSoKIXAdVz0PMAAAAAAAAGMYTW4cVhcFEmgaUWobUzUNKkcVN24cVm4bVW4bVl0XSU8TPW4cVm4cVm4cVm4cVm4cVm4cVlUVQm4cVm4bVm4cVgAAAAAAAG8dVmYaUAAAAG4cVm8cVmAYS24cVgAAAG4cVlsXRwAAAG8eVgAAAFkWRWQZTm4bVm4cVW4cVm4cVm8cVW8cVv2W624cVv3LzNKWqP7q6/9pgv///9NSdf+ltG8dV/zKy3IgWXMiWnAeWNOXqf3Oz/7p6vnGydGVp3UkW9aaq3coXv7o6f7n6PvJy+Kqtoc7a9ecrOy2voQ5auCotH4wZPXBxo1Bb/S/xPG7wtuhsP3S04o+bf3Q0fbDx8+Tpt2jsZtRevjEyPK+w4M2aOixutmfrv7U1e+5wHkpX/rIyt+ls8GBmn4zZ3wtYuqzvOauueSst5dOeLFtjcOEnJBFcv7a29idrZJIdIEzZv7d3aJbgcmLobt6lXkrYJ1VfbNwj6pliHssYf7X2J9Yfq5qi7Zzkf7i46Rdgr18l8iJoOu1vcuNotCUp6hjhv7k5XYlXf7g4NSZqqZghL9+mIZAcM6Rpfvm6O24v7h2k/Tc4ZRKdsyPo5JQfJxgiKxnicmftrKBoOJZecaascaHnubH0opEc/zo6cSGnfrk57iForB7m+pde/jg5I9LeLp4lPNifs2QpKFli6dvk4YoXdpVd86kufHW3dOsv5dYgfz6+6Y6Z6Rqj9exwruNqKx1lsGUreLCzu3R2f2istGpvH4kW/pmgMZLcd27yZkzY9rF1LZCbP5ogs9PdOC+zPGXq/Lq8I8tYP+NoP9yif9/leHQ3P9thrhhhv+brNq2xvTt8semvYxHds6RpNqCnMdwkOnc5ffy9e7l7OSLo9O5y9GWqQAaAP8AAMG9VswAAAD+dFJOU1TzUQoE+woA/QEQTkT3SlfrGds9j7hqXByYcRKGITfUQ2Ll7X0WpSWBxKJey8I7m+Su1EppMi4z3ymSb8yMJa6+Hisrt9p6dlVZT1L///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9UYRtC9wAAanxJREFUeNrs3c3PFIUdwHFJHh55DiSEhORJuHApkABqqomJpDHhgGgzM3t5eH0MWmxtINZS0KhUg2IUGyLY+kYb+mJjMUVbUg2N2hYabOQgJSmtJRw8eSfpX9DngQDPzM7szuzO7s7sfj7Hpg+7O+vvu/M+t9wKjKxbLAIQAEAAAAEABAAQAEAAAAEABAAQAEAAAAEABAAQAEAAAAEABAAQAEAAAAEABAAQAEAAAAEABAAQAEAAAAEABAAQAEAAAAEABAAQAEAAAAEABAAEABAAQAAAAQAEABAAQAAAAQAEABAAQAAAAQAEABAAQAAAAQAEABAAQAAAAQAEABAAQAAAAQAEABAAQAAAAQAEABAAQAAAAQAEABAAQAAAAQAEAAQAEABAAAABAAQAEABAAAABAAQAEABAAAABAAQAEABAAAABAAQAEABAAAABAAQAEABAAAABAAQAEABAAAABAAQAEABAAAABAAQAEABAAAABAAQABAAQAEAAAAEABAAQAEAAAAEABAAQAEAAAAEABAAQAEAAAAEABAAQAEAAAAEABAAQAEAAAAEABAAQAEAAAAEABAAQAEAAAAEABAAQAEAAAAEABAAEABAAQAAAAQAEABAAQAAAAQAEABAAQAAAAQAEABAAQAAAAQAEABAAQAAAAQAEABAAQAAAAQAEABAArplcuXphcN2iJeu/YZEgAKPhrsVBmjvWWjQIwJBbHrSy2gJCAIbW+LygrSUWEwIwjO5cEOQyb6llhQAM269/zvGftWCd5YUADJP5QTHWAhCAofFAUNy4xYYADIVFQSfmWXAIQP2NBZ2638JDAGpuadC5+ROWHwJQZ5NBVzZYgghAfY0HXVpsGSIAtZU11ye+PN+47tMzB1olYMxSRABqsLG/dk38aP+ie1elj/THjWZfZBdgmWWL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">\n      </div>\n      <div id="digital-bacon-error">\n        <h1>Error Loading Default Environment</h1>\n      </div>\n      <div id="digital-bacon-transform-controls" class="hidden">\n        <button id="place-button"><i class="las la-map-pin"></i>Place</button>\n        <button id="translate-button" class="selected"><i class="las la-arrows-alt"></i>Move</button>\n        <button id="rotate-button"><i class="las la-sync"></i>Rotate</button>\n        <button id="scale-button"><i class="las la-expand"></i>Scale</button>\n        <button id="clone-button"><i class="las la-copy"></i>Clone</button>\n        <button id="delete-button"><i class="las la-trash"></i>Delete</button>\n        <button id="close-button"><i class="las la-times-circle"></i>Close</button>\n      </div>\n      <button id="mobile-menu-open-button" class="hidden">OPEN MENU</button>',C.style.position="relative"}(A),window.main=new Main(r,A,b)}function checkIfPointer(){(function hasPointerLock(){return"pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document})()&&!function detectMobile(){return[/Android/i,/webOS/i,/iPhone/i,/iPad/i,/iPod/i,/BlackBerry/i,/Windows Phone/i].some((r=>navigator.userAgent.match(r)))}()&&(Mt.deviceType=an.POINTER)}function setupEditor(r,A){return Mt.isEditor=!0,setup(r,A)}function setup(r,A){return A=A||{},Mt.authUrl=A.authUrl,Mt.socketUrl=A.socketUrl,new Promise((b=>{if(!localStorage.getItem("DigitalBacon:MobileOverride"))return localStorage.getItem("DigitalBacon:PointerOverride")?(Mt.deviceType=an.POINTER,void start(b,r,A)):void("xr"in navigator?function isVRSupported(){return navigator.xr.isSessionSupported("immersive-vr").then((function(r){return r&&(Mt.vrSessionSupported=!0),r})).catch((function(){return!1}))}().then((C=>{(function isARSupported(){return navigator.xr.isSessionSupported("immersive-ar").then((function(r){return r&&(Mt.arSessionSupported=!0),r})).catch((function(){return!1}))})().then((r=>{C||r?Mt.deviceType=an.XR:checkIfPointer()})).finally((function(){start(b,r,A)}))})):(checkIfPointer(),start(b,r,A)));start(b,r,A)}))}JSZip.defaults.date=new Date(du.getTime()-6e4*du.getTimezoneOffset()),Mt.deviceType=an.TOUCH_SCREEN,Mt.isChrome=-1!==navigator.userAgent.indexOf("Chrome");class CustomAssetEntity extends AssetEntity{constructor(r={}){super(r)}static assetType=kt.CUSTOM_ASSET}var cu=Object.freeze({__proto__:null,AmbientLight:AmbientLight,Asset:Asset,AssetEntity:AssetEntity,AudioAsset:AudioAsset,BasicMaterial:BasicMaterial,BasicTexture:BasicTexture,BoxShape:BoxShape,CircleShape:CircleShape,Component:Component,ConeShape:ConeShape,CubeTexture:CubeTexture,CustomAsset:CustomAsset,CustomAssetEntity:CustomAssetEntity,CylinderShape:CylinderShape,ImageAsset:ImageAsset,Light:Light,Material:Material,ModelAsset:ModelAsset,PlainText:PlainText,PlaneShape:PlaneShape,PointLight:PointLight,PublishComponent:PublishComponent,PublishSystem:PublishSystem,RingShape:RingShape,Shape:Shape,SphereShape:SphereShape,StandardMaterial:StandardMaterial,System:System,TextAsset:TextAsset,TextOverlay:TextOverlay,Texture:Texture,ToonMaterial:ToonMaterial,TorusShape:TorusShape});class CustomAssetEntityHelper extends AssetEntityHelper{constructor(r){super(r,Rt.CUSTOM_ASSET_UPDATED)}}nl.registerEditorHelper(CustomAssetEntityHelper,CustomAssetEntity);var uu=Object.freeze({__proto__:null,AssetEntityHelper:AssetEntityHelper,ComponentHelper:ComponentHelper,CustomAssetEntityHelper:CustomAssetEntityHelper,CustomAssetHelper:CustomAssetHelper,EditorHelper:EditorHelper,EditorHelperFactory:nl,LightHelper:LightHelper,MaterialHelper:MaterialHelper,ShapeHelper:ShapeHelper,SystemHelper:SystemHelper,TextAssetHelper:TextAssetHelper,TextureHelper:TextureHelper});
/*!
 * This Source Code Form is subject to the terms of the Mozilla Public
 * License, v. 2.0. If a copy of the MPL was not distributed with this
 * file, You can obtain one at https://mozilla.org/MPL/2.0/.
 */const pu="0.3.6";function getCamera(){return Mt.camera}function getDeviceType(){return Mt.deviceType}function getRenderer(){return Mt.renderer}function isEditor(){return Mt.isEditor}function isImmersionDisabled(){return Mt.immersionDisabled}function setKeyboardLock(r){Mt.keyboardLock=r}Mt.version=pu,null!=window&&(window.DigitalBacon={Assets:cu,AudioHandler:Yo,DigitalBaconUI:Va,EditorHelpers:uu,LibraryHandler:Qo,OrbitDisablingPointerInteractable:OrbitDisablingPointerInteractable,PartyHandler:Bl,ProjectHandler:il,PubSub:Qt,Scene:Ho,SettingsHandler:Wo,UserController:eh,getCamera:getCamera,getDeviceType:getDeviceType,getRenderer:getRenderer,isEditor:isEditor,isImmersionDisabled:isImmersionDisabled,setKeyboardLock:setKeyboardLock,setup:setup,setupEditor:setupEditor,utils:Ht,version:pu});export{cu as Assets,Yo as AudioHandler,Va as DigitalBaconUI,uu as EditorHelpers,Qo as LibraryHandler,OrbitDisablingPointerInteractable,Bl as PartyHandler,il as ProjectHandler,Qt as PubSub,Ho as Scene,Wo as SettingsHandler,eh as UserController,getCamera,getDeviceType,getRenderer,isEditor,isImmersionDisabled,setKeyboardLock,setup,setupEditor,Ht as utils,pu as version};
